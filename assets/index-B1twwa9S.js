(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var og={exports:{}},sd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aC;function Q5(){if(aC)return sd;aC=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,s,i){var c=null;if(i!==void 0&&(c=""+i),s.key!==void 0&&(c=""+s.key),"key"in s){i={};for(var f in s)f!=="key"&&(i[f]=s[f])}else i=s;return s=i.ref,{$$typeof:t,type:r,key:c,ref:s!==void 0?s:null,props:i}}return sd.Fragment=e,sd.jsx=n,sd.jsxs=n,sd}var oC;function e8(){return oC||(oC=1,og.exports=Q5()),og.exports}var b=e8(),lg={exports:{}},Bt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lC;function t8(){if(lC)return Bt;lC=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),A=Symbol.iterator;function T(V){return V===null||typeof V!="object"?null:(V=A&&V[A]||V["@@iterator"],typeof V=="function"?V:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,R={};function j(V,te,fe){this.props=V,this.context=te,this.refs=R,this.updater=fe||_}j.prototype.isReactComponent={},j.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},j.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function H(){}H.prototype=j.prototype;function G(V,te,fe){this.props=V,this.context=te,this.refs=R,this.updater=fe||_}var Z=G.prototype=new H;Z.constructor=G,M(Z,j.prototype),Z.isPureReactComponent=!0;var J=Array.isArray;function oe(){}var U={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function X(V,te,fe){var ge=fe.ref;return{$$typeof:t,type:V,key:te,ref:ge!==void 0?ge:null,props:fe}}function Qe(V,te){return X(V.type,te,V.props)}function je(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function ue(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(fe){return te[fe]})}var Ie=/\/+/g;function Ze(V,te){return typeof V=="object"&&V!==null&&V.key!=null?ue(""+V.key):te.toString(36)}function ne(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(oe,oe):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ie(V,te,fe,ge,We){var se=typeof V;(se==="undefined"||se==="boolean")&&(V=null);var Be=!1;if(V===null)Be=!0;else switch(se){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(V.$$typeof){case t:case e:Be=!0;break;case C:return Be=V._init,ie(Be(V._payload),te,fe,ge,We)}}if(Be)return We=We(V),Be=ge===""?"."+Ze(V,0):ge,J(We)?(fe="",Be!=null&&(fe=Be.replace(Ie,"$&/")+"/"),ie(We,te,fe,"",function(Ae){return Ae})):We!=null&&(je(We)&&(We=Qe(We,fe+(We.key==null||V&&V.key===We.key?"":(""+We.key).replace(Ie,"$&/")+"/")+Be)),te.push(We)),1;Be=0;var K=ge===""?".":ge+":";if(J(V))for(var Ce=0;Ce<V.length;Ce++)ge=V[Ce],se=K+Ze(ge,Ce),Be+=ie(ge,te,fe,se,We);else if(Ce=T(V),typeof Ce=="function")for(V=Ce.call(V),Ce=0;!(ge=V.next()).done;)ge=ge.value,se=K+Ze(ge,Ce++),Be+=ie(ge,te,fe,se,We);else if(se==="object"){if(typeof V.then=="function")return ie(ne(V),te,fe,ge,We);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Be}function pe(V,te,fe){if(V==null)return V;var ge=[],We=0;return ie(V,ge,"","",function(se){return te.call(fe,se,We++)}),ge}function me(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(fe){(V._status===0||V._status===-1)&&(V._status=1,V._result=fe)},function(fe){(V._status===0||V._status===-1)&&(V._status=2,V._result=fe)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var Y=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},le={map:pe,forEach:function(V,te,fe){pe(V,function(){te.apply(this,arguments)},fe)},count:function(V){var te=0;return pe(V,function(){te++}),te},toArray:function(V){return pe(V,function(te){return te})||[]},only:function(V){if(!je(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Bt.Activity=v,Bt.Children=le,Bt.Component=j,Bt.Fragment=n,Bt.Profiler=s,Bt.PureComponent=G,Bt.StrictMode=r,Bt.Suspense=p,Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Bt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return U.H.useMemoCache(V)}},Bt.cache=function(V){return function(){return V.apply(null,arguments)}},Bt.cacheSignal=function(){return null},Bt.cloneElement=function(V,te,fe){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ge=M({},V.props),We=V.key;if(te!=null)for(se in te.key!==void 0&&(We=""+te.key),te)!ee.call(te,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&te.ref===void 0||(ge[se]=te[se]);var se=arguments.length-2;if(se===1)ge.children=fe;else if(1<se){for(var Be=Array(se),K=0;K<se;K++)Be[K]=arguments[K+2];ge.children=Be}return X(V.type,We,ge)},Bt.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:i,_context:V},V},Bt.createElement=function(V,te,fe){var ge,We={},se=null;if(te!=null)for(ge in te.key!==void 0&&(se=""+te.key),te)ee.call(te,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(We[ge]=te[ge]);var Be=arguments.length-2;if(Be===1)We.children=fe;else if(1<Be){for(var K=Array(Be),Ce=0;Ce<Be;Ce++)K[Ce]=arguments[Ce+2];We.children=K}if(V&&V.defaultProps)for(ge in Be=V.defaultProps,Be)We[ge]===void 0&&(We[ge]=Be[ge]);return X(V,se,We)},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function(V){return{$$typeof:f,render:V}},Bt.isValidElement=je,Bt.lazy=function(V){return{$$typeof:C,_payload:{_status:-1,_result:V},_init:me}},Bt.memo=function(V,te){return{$$typeof:g,type:V,compare:te===void 0?null:te}},Bt.startTransition=function(V){var te=U.T,fe={};U.T=fe;try{var ge=V(),We=U.S;We!==null&&We(fe,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(oe,Y)}catch(se){Y(se)}finally{te!==null&&fe.types!==null&&(te.types=fe.types),U.T=te}},Bt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Bt.use=function(V){return U.H.use(V)},Bt.useActionState=function(V,te,fe){return U.H.useActionState(V,te,fe)},Bt.useCallback=function(V,te){return U.H.useCallback(V,te)},Bt.useContext=function(V){return U.H.useContext(V)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function(V,te){return U.H.useDeferredValue(V,te)},Bt.useEffect=function(V,te){return U.H.useEffect(V,te)},Bt.useEffectEvent=function(V){return U.H.useEffectEvent(V)},Bt.useId=function(){return U.H.useId()},Bt.useImperativeHandle=function(V,te,fe){return U.H.useImperativeHandle(V,te,fe)},Bt.useInsertionEffect=function(V,te){return U.H.useInsertionEffect(V,te)},Bt.useLayoutEffect=function(V,te){return U.H.useLayoutEffect(V,te)},Bt.useMemo=function(V,te){return U.H.useMemo(V,te)},Bt.useOptimistic=function(V,te){return U.H.useOptimistic(V,te)},Bt.useReducer=function(V,te,fe){return U.H.useReducer(V,te,fe)},Bt.useRef=function(V){return U.H.useRef(V)},Bt.useState=function(V){return U.H.useState(V)},Bt.useSyncExternalStore=function(V,te,fe){return U.H.useSyncExternalStore(V,te,fe)},Bt.useTransition=function(){return U.H.useTransition()},Bt.version="19.2.0",Bt}var cC;function tf(){return cC||(cC=1,lg.exports=t8()),lg.exports}var L=tf();const It=M2(L);var cg={exports:{}},id={},ug={exports:{}},dg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uC;function n8(){return uC||(uC=1,(function(t){function e(ie,pe){var me=ie.length;ie.push(pe);e:for(;0<me;){var Y=me-1>>>1,le=ie[Y];if(0<s(le,pe))ie[Y]=pe,ie[me]=le,me=Y;else break e}}function n(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var pe=ie[0],me=ie.pop();if(me!==pe){ie[0]=me;e:for(var Y=0,le=ie.length,V=le>>>1;Y<V;){var te=2*(Y+1)-1,fe=ie[te],ge=te+1,We=ie[ge];if(0>s(fe,me))ge<le&&0>s(We,fe)?(ie[Y]=We,ie[ge]=me,Y=ge):(ie[Y]=fe,ie[te]=me,Y=te);else if(ge<le&&0>s(We,me))ie[Y]=We,ie[ge]=me,Y=ge;else break e}}return pe}function s(ie,pe){var me=ie.sortIndex-pe.sortIndex;return me!==0?me:ie.id-pe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var c=Date,f=c.now();t.unstable_now=function(){return c.now()-f}}var p=[],g=[],C=1,v=null,A=3,T=!1,_=!1,M=!1,R=!1,j=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function Z(ie){for(var pe=n(g);pe!==null;){if(pe.callback===null)r(g);else if(pe.startTime<=ie)r(g),pe.sortIndex=pe.expirationTime,e(p,pe);else break;pe=n(g)}}function J(ie){if(M=!1,Z(ie),!_)if(n(p)!==null)_=!0,oe||(oe=!0,ue());else{var pe=n(g);pe!==null&&ne(J,pe.startTime-ie)}}var oe=!1,U=-1,ee=5,X=-1;function Qe(){return R?!0:!(t.unstable_now()-X<ee)}function je(){if(R=!1,oe){var ie=t.unstable_now();X=ie;var pe=!0;try{e:{_=!1,M&&(M=!1,H(U),U=-1),T=!0;var me=A;try{t:{for(Z(ie),v=n(p);v!==null&&!(v.expirationTime>ie&&Qe());){var Y=v.callback;if(typeof Y=="function"){v.callback=null,A=v.priorityLevel;var le=Y(v.expirationTime<=ie);if(ie=t.unstable_now(),typeof le=="function"){v.callback=le,Z(ie),pe=!0;break t}v===n(p)&&r(p),Z(ie)}else r(p);v=n(p)}if(v!==null)pe=!0;else{var V=n(g);V!==null&&ne(J,V.startTime-ie),pe=!1}}break e}finally{v=null,A=me,T=!1}pe=void 0}}finally{pe?ue():oe=!1}}}var ue;if(typeof G=="function")ue=function(){G(je)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,Ze=Ie.port2;Ie.port1.onmessage=je,ue=function(){Ze.postMessage(null)}}else ue=function(){j(je,0)};function ne(ie,pe){U=j(function(){ie(t.unstable_now())},pe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_next=function(ie){switch(A){case 1:case 2:case 3:var pe=3;break;default:pe=A}var me=A;A=pe;try{return ie()}finally{A=me}},t.unstable_requestPaint=function(){R=!0},t.unstable_runWithPriority=function(ie,pe){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var me=A;A=ie;try{return pe()}finally{A=me}},t.unstable_scheduleCallback=function(ie,pe,me){var Y=t.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Y+me:Y):me=Y,ie){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=me+le,ie={id:C++,callback:pe,priorityLevel:ie,startTime:me,expirationTime:le,sortIndex:-1},me>Y?(ie.sortIndex=me,e(g,ie),n(p)===null&&ie===n(g)&&(M?(H(U),U=-1):M=!0,ne(J,me-Y))):(ie.sortIndex=le,e(p,ie),_||T||(_=!0,oe||(oe=!0,ue()))),ie},t.unstable_shouldYield=Qe,t.unstable_wrapCallback=function(ie){var pe=A;return function(){var me=A;A=pe;try{return ie.apply(this,arguments)}finally{A=me}}}})(dg)),dg}var dC;function r8(){return dC||(dC=1,ug.exports=n8()),ug.exports}var fg={exports:{}},Qr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fC;function s8(){if(fC)return Qr;fC=1;var t=tf();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)g+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(p,g,C){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:p,containerInfo:g,implementation:C}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Qr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Qr.createPortal=function(p,g){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return i(p,g,null,C)},Qr.flushSync=function(p){var g=c.T,C=r.p;try{if(c.T=null,r.p=2,p)return p()}finally{c.T=g,r.p=C,r.d.f()}},Qr.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,r.d.C(p,g))},Qr.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Qr.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var C=g.as,v=f(C,g.crossOrigin),A=typeof g.integrity=="string"?g.integrity:void 0,T=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;C==="style"?r.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:A,fetchPriority:T}):C==="script"&&r.d.X(p,{crossOrigin:v,integrity:A,fetchPriority:T,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Qr.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var C=f(g.as,g.crossOrigin);r.d.M(p,{crossOrigin:C,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&r.d.M(p)},Qr.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var C=g.as,v=f(C,g.crossOrigin);r.d.L(p,C,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Qr.preloadModule=function(p,g){if(typeof p=="string")if(g){var C=f(g.as,g.crossOrigin);r.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:C,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else r.d.m(p)},Qr.requestFormReset=function(p){r.d.r(p)},Qr.unstable_batchedUpdates=function(p,g){return p(g)},Qr.useFormState=function(p,g,C){return c.H.useFormState(p,g,C)},Qr.useFormStatus=function(){return c.H.useHostTransitionStatus()},Qr.version="19.2.0",Qr}var hC;function cA(){if(hC)return fg.exports;hC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),fg.exports=s8(),fg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pC;function i8(){if(pC)return id;pC=1;var t=r8(),e=tf(),n=cA();function r(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function i(a){var l=a,h=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(h=l.return),a=l.return;while(a)}return l.tag===3?h:null}function c(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function f(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function p(a){if(i(a)!==a)throw Error(r(188))}function g(a){var l=a.alternate;if(!l){if(l=i(a),l===null)throw Error(r(188));return l!==a?null:a}for(var h=a,y=l;;){var S=h.return;if(S===null)break;var k=S.alternate;if(k===null){if(y=S.return,y!==null){h=y;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===h)return p(S),a;if(k===y)return p(S),l;k=k.sibling}throw Error(r(188))}if(h.return!==y.return)h=S,y=k;else{for(var D=!1,z=S.child;z;){if(z===h){D=!0,h=S,y=k;break}if(z===y){D=!0,y=S,h=k;break}z=z.sibling}if(!D){for(z=k.child;z;){if(z===h){D=!0,h=k,y=S;break}if(z===y){D=!0,y=k,h=S;break}z=z.sibling}if(!D)throw Error(r(189))}}if(h.alternate!==y)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:l}function C(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=C(a),l!==null)return l;a=a.sibling}return null}var v=Object.assign,A=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),G=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),Qe=Symbol.for("react.memo_cache_sentinel"),je=Symbol.iterator;function ue(a){return a===null||typeof a!="object"?null:(a=je&&a[je]||a["@@iterator"],typeof a=="function"?a:null)}var Ie=Symbol.for("react.client.reference");function Ze(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===Ie?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case M:return"Fragment";case j:return"Profiler";case R:return"StrictMode";case J:return"Suspense";case oe:return"SuspenseList";case X:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case _:return"Portal";case G:return a.displayName||"Context";case H:return(a._context.displayName||"Context")+".Consumer";case Z:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case U:return l=a.displayName||null,l!==null?l:Ze(a.type)||"Memo";case ee:l=a._payload,a=a._init;try{return Ze(a(l))}catch{}}return null}var ne=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Y=[],le=-1;function V(a){return{current:a}}function te(a){0>le||(a.current=Y[le],Y[le]=null,le--)}function fe(a,l){le++,Y[le]=a.current,a.current=l}var ge=V(null),We=V(null),se=V(null),Be=V(null);function K(a,l){switch(fe(se,l),fe(We,a),fe(ge,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?Ov(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=Ov(l),a=_v(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}te(ge),fe(ge,a)}function Ce(){te(ge),te(We),te(se)}function Ae(a){a.memoizedState!==null&&fe(Be,a);var l=ge.current,h=_v(l,a.type);l!==h&&(fe(We,a),fe(ge,h))}function ze(a){We.current===a&&(te(ge),te(We)),Be.current===a&&(te(Be),ed._currentValue=me)}var rt,ot;function gt(a){if(rt===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);rt=l&&l[1]||"",ot=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rt+a+ot}var jt=!1;function Pt(a,l){if(!a||jt)return"";jt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(l){var Le=function(){throw Error()};if(Object.defineProperty(Le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Le,[])}catch(Te){var Se=Te}Reflect.construct(a,[],Le)}else{try{Le.call()}catch(Te){Se=Te}a.call(Le.prototype)}}else{try{throw Error()}catch(Te){Se=Te}(Le=a())&&typeof Le.catch=="function"&&Le.catch(function(){})}}catch(Te){if(Te&&Se&&typeof Te.stack=="string")return[Te.stack,Se.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=y.DetermineComponentFrameRoot(),D=k[0],z=k[1];if(D&&z){var Q=D.split(`
`),Ee=z.split(`
`);for(S=y=0;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;for(;S<Ee.length&&!Ee[S].includes("DetermineComponentFrameRoot");)S++;if(y===Q.length||S===Ee.length)for(y=Q.length-1,S=Ee.length-1;1<=y&&0<=S&&Q[y]!==Ee[S];)S--;for(;1<=y&&0<=S;y--,S--)if(Q[y]!==Ee[S]){if(y!==1||S!==1)do if(y--,S--,0>S||Q[y]!==Ee[S]){var _e=`
`+Q[y].replace(" at new "," at ");return a.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",a.displayName)),_e}while(1<=y&&0<=S);break}}}finally{jt=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?gt(h):""}function et(a,l){switch(a.tag){case 26:case 27:case 5:return gt(a.type);case 16:return gt("Lazy");case 13:return a.child!==l&&l!==null?gt("Suspense Fallback"):gt("Suspense");case 19:return gt("SuspenseList");case 0:case 15:return Pt(a.type,!1);case 11:return Pt(a.type.render,!1);case 1:return Pt(a.type,!0);case 31:return gt("Activity");default:return""}}function ft(a){try{var l="",h=null;do l+=et(a,h),h=a,a=a.return;while(a);return l}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var Ve=Object.prototype.hasOwnProperty,lt=t.unstable_scheduleCallback,tt=t.unstable_cancelCallback,Xn=t.unstable_shouldYield,Lr=t.unstable_requestPaint,on=t.unstable_now,_s=t.unstable_getCurrentPriorityLevel,tr=t.unstable_ImmediatePriority,jr=t.unstable_UserBlockingPriority,On=t.unstable_NormalPriority,xn=t.unstable_LowPriority,is=t.unstable_IdlePriority,nr=t.log,ms=t.unstable_setDisableYieldValue,ln=null,He=null;function Zt(a){if(typeof nr=="function"&&ms(a),He&&typeof He.setStrictMode=="function")try{He.setStrictMode(ln,a)}catch{}}var At=Math.clz32?Math.clz32:gs,cn=Math.log,bn=Math.LN2;function gs(a){return a>>>=0,a===0?32:31-(cn(a)/bn|0)|0}var Br=256,Dt=262144,Gt=4194304;function pn(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Bn(a,l,h){var y=a.pendingLanes;if(y===0)return 0;var S=0,k=a.suspendedLanes,D=a.pingedLanes;a=a.warmLanes;var z=y&134217727;return z!==0?(y=z&~k,y!==0?S=pn(y):(D&=z,D!==0?S=pn(D):h||(h=z&~a,h!==0&&(S=pn(h))))):(z=y&~k,z!==0?S=pn(z):D!==0?S=pn(D):h||(h=y&~a,h!==0&&(S=pn(h)))),S===0?0:l!==0&&l!==S&&(l&k)===0&&(k=S&-S,h=l&-l,k>=h||k===32&&(h&4194048)!==0)?l:S}function Jt(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function dn(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function de(){var a=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),a}function we(a){for(var l=[],h=0;31>h;h++)l.push(a);return l}function Oe(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Fe(a,l,h,y,S,k){var D=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var z=a.entanglements,Q=a.expirationTimes,Ee=a.hiddenUpdates;for(h=D&~h;0<h;){var _e=31-At(h),Le=1<<_e;z[_e]=0,Q[_e]=-1;var Se=Ee[_e];if(Se!==null)for(Ee[_e]=null,_e=0;_e<Se.length;_e++){var Te=Se[_e];Te!==null&&(Te.lane&=-536870913)}h&=~Le}y!==0&&it(a,y,0),k!==0&&S===0&&a.tag!==0&&(a.suspendedLanes|=k&~(D&~l))}function it(a,l,h){a.pendingLanes|=l,a.suspendedLanes&=~l;var y=31-At(l);a.entangledLanes|=l,a.entanglements[y]=a.entanglements[y]|1073741824|h&261930}function nt(a,l){var h=a.entangledLanes|=l;for(a=a.entanglements;h;){var y=31-At(h),S=1<<y;S&l|a[y]&l&&(a[y]|=l),h&=~S}}function Xe(a,l){var h=l&-l;return h=(h&42)!==0?1:ct(h),(h&(a.suspendedLanes|l))!==0?0:h}function ct(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ut(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function yt(){var a=pe.p;return a!==0?a:(a=window.event,a===void 0?32:Qv(a.type))}function De(a,l){var h=pe.p;try{return pe.p=a,l()}finally{pe.p=h}}var Tt=Math.random().toString(36).slice(2),qt="__reactFiber$"+Tt,_t="__reactProps$"+Tt,Pr="__reactContainer$"+Tt,Si="__reactEvents$"+Tt,ja="__reactListeners$"+Tt,xs="__reactHandles$"+Tt,$o="__reactResources$"+Tt,Ai="__reactMarker$"+Tt;function Zr(a){delete a[qt],delete a[_t],delete a[Si],delete a[ja],delete a[xs]}function Yn(a){var l=a[qt];if(l)return l;for(var h=a.parentNode;h;){if(l=h[Pr]||h[qt]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(a=Bv(a);a!==null;){if(h=a[qt])return h;a=Bv(a)}return l}a=h,h=a.parentNode}return null}function un(a){if(a=a[qt]||a[Pr]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function Ni(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(r(33))}function Fr(a){var l=a[$o];return l||(l=a[$o]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Kn(a){a[Ai]=!0}var Re=new Set,$l={};function sn(a,l){Jr(a,l),Jr(a+"Capture",l)}function Jr(a,l){for($l[a]=l,a=0;a<l.length;a++)Re.add(l[a])}var Xo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},$t={};function Wt(a){return Ve.call($t,a)?!0:Ve.call(Qt,a)?!1:Xo.test(a)?$t[a]=!0:(Qt[a]=!0,!1)}function qi(a,l,h){if(Wt(l))if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var y=l.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+h)}}function ki(a,l,h){if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+h)}}function ye(a,l,h,y){if(y===null)a.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(l,h,""+y)}}function $(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ye(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function qe(a,l,h){var y=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var S=y.get,k=y.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return S.call(this)},set:function(D){h=""+D,k.call(this,D)}}),Object.defineProperty(a,l,{enumerable:y.enumerable}),{getValue:function(){return h},setValue:function(D){h=""+D},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function mt(a){if(!a._valueTracker){var l=Ye(a)?"checked":"value";a._valueTracker=qe(a,l,""+a[l])}}function en(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var h=l.getValue(),y="";return a&&(y=Ye(a)?a.checked?"true":"false":a.value),a=y,a!==h?(l.setValue(a),!0):!1}function zn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var zr=/[\n"\\]/g;function kt(a){return a.replace(zr,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function yn(a,l,h,y,S,k,D,z){a.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.type=D:a.removeAttribute("type"),l!=null?D==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+$(l)):a.value!==""+$(l)&&(a.value=""+$(l)):D!=="submit"&&D!=="reset"||a.removeAttribute("value"),l!=null?W(a,D,$(l)):h!=null?W(a,D,$(h)):y!=null&&a.removeAttribute("value"),S==null&&k!=null&&(a.defaultChecked=!!k),S!=null&&(a.checked=S&&typeof S!="function"&&typeof S!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?a.name=""+$(z):a.removeAttribute("name")}function xe(a,l,h,y,S,k,D,z){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(a.type=k),l!=null||h!=null){if(!(k!=="submit"&&k!=="reset"||l!=null)){mt(a);return}h=h!=null?""+$(h):"",l=l!=null?""+$(l):h,z||l===a.value||(a.value=l),a.defaultValue=l}y=y??S,y=typeof y!="function"&&typeof y!="symbol"&&!!y,a.checked=z?a.checked:!!y,a.defaultChecked=!!y,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(a.name=D),mt(a)}function W(a,l,h){l==="number"&&zn(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function ht(a,l,h,y){if(a=a.options,l){l={};for(var S=0;S<h.length;S++)l["$"+h[S]]=!0;for(h=0;h<a.length;h++)S=l.hasOwnProperty("$"+a[h].value),a[h].selected!==S&&(a[h].selected=S),S&&y&&(a[h].defaultSelected=!0)}else{for(h=""+$(h),l=null,S=0;S<a.length;S++){if(a[S].value===h){a[S].selected=!0,y&&(a[S].defaultSelected=!0);return}l!==null||a[S].disabled||(l=a[S])}l!==null&&(l.selected=!0)}}function dr(a,l,h){if(l!=null&&(l=""+$(l),l!==a.value&&(a.value=l),h==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=h!=null?""+$(h):""}function as(a,l,h,y){if(l==null){if(y!=null){if(h!=null)throw Error(r(92));if(ne(y)){if(1<y.length)throw Error(r(93));y=y[0]}h=y}h==null&&(h=""),l=h}h=$(l),a.defaultValue=h,y=a.textContent,y===h&&y!==""&&y!==null&&(a.value=y),mt(a)}function Ba(a,l){if(l){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=l;return}}a.textContent=l}var gu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ls(a,l,h){var y=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?y?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":y?a.setProperty(l,h):typeof h!="number"||h===0||gu.has(l)?l==="float"?a.cssFloat=h:a[l]=(""+h).trim():a[l]=h+"px"}function bt(a,l,h){if(l!=null&&typeof l!="object")throw Error(r(62));if(a=a.style,h!=null){for(var y in h)!h.hasOwnProperty(y)||l!=null&&l.hasOwnProperty(y)||(y.indexOf("--")===0?a.setProperty(y,""):y==="float"?a.cssFloat="":a[y]="");for(var S in l)y=l[S],l.hasOwnProperty(S)&&h[S]!==y&&ls(a,S,y)}else for(var k in l)l.hasOwnProperty(k)&&ls(a,k,l[k])}function _n(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),m1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pa(a){return m1.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function bs(){}var Yo=null;function xu(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Un=null,Gs=null;function li(a){var l=un(a);if(l&&(a=l.stateNode)){var h=a[_t]||null;e:switch(a=l.stateNode,l.type){case"input":if(yn(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+kt(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var y=h[l];if(y!==a&&y.form===a.form){var S=y[_t]||null;if(!S)throw Error(r(90));yn(y,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(l=0;l<h.length;l++)y=h[l],y.form===a.form&&en(y)}break e;case"textarea":dr(a,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&ht(a,!!h.multiple,l,!1)}}}var Et=!1;function Ef(a,l,h){if(Et)return a(l,h);Et=!0;try{var y=a(l);return y}finally{if(Et=!1,(Un!==null||Gs!==null)&&(ph(),Un&&(l=Un,a=Gs,Gs=Un=null,li(l),a)))for(l=0;l<a.length;l++)li(a[l])}}function Mt(a,l){var h=a.stateNode;if(h===null)return null;var y=h[_t]||null;if(y===null)return null;h=y[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,l,typeof h));return h}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bu=!1;if(Rn)try{var $i={};Object.defineProperty($i,"passive",{get:function(){bu=!0}}),window.addEventListener("test",$i,$i),window.removeEventListener("test",$i,$i)}catch{bu=!1}var ci=null,ui=null,Xl=null;function Fa(){if(Xl)return Xl;var a,l=ui,h=l.length,y,S="value"in ci?ci.value:ci.textContent,k=S.length;for(a=0;a<h&&l[a]===S[a];a++);var D=h-a;for(y=1;y<=D&&l[h-y]===S[k-y];y++);return Xl=S.slice(a,1<y?1-y:void 0)}function Ti(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Oi(){return!0}function yu(){return!1}function gr(a){function l(h,y,S,k,D){this._reactName=h,this._targetInst=S,this.type=y,this.nativeEvent=k,this.target=D,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(h=a[z],this[z]=h?h(k):k[z]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Oi:yu,this.isPropagationStopped=yu,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Oi)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Oi)},persist:function(){},isPersistent:Oi}),l}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Er=gr(Rs),za=v({},Rs,{view:0,detail:0}),Sf=gr(za),Yl,wu,Ko,Kl=v({},za,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ko&&(Ko&&a.type==="mousemove"?(Yl=a.screenX-Ko.screenX,wu=a.screenY-Ko.screenY):wu=Yl=0,Ko=a),Yl)},movementY:function(a){return"movementY"in a?a.movementY:wu}}),mn=gr(Kl),Af=v({},Kl,{dataTransfer:0}),Zl=gr(Af),_i=v({},za,{relatedTarget:0}),vu=gr(_i),ke=v({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),zt=gr(ke),Sr=v({},Rs,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Jl=gr(Sr),Nf=v({},Rs,{data:0}),kf=gr(Nf),g1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fr(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=Cu[a])?!!l[a]:!1}function Zo(){return fr}var Zn=v({},za,{key:function(a){if(a.key){var l=g1[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Ti(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?x1[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zo,charCode:function(a){return a.type==="keypress"?Ti(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ti(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ql=gr(Zn),Xi=v({},Kl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wn=gr(Xi),St=v({},za,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zo}),b1=gr(St),Mn=v({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yi=gr(Mn),Ua=v({},Kl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),y1=gr(Ua),Ws=v({},Rs,{newState:0,oldState:0}),Eu=gr(Ws),Tf=[9,13,27,32],Jo=Rn&&"CompositionEvent"in window,Ha=null;Rn&&"documentMode"in document&&(Ha=document.documentMode);var Of=Rn&&"TextEvent"in window&&!Ha,_f=Rn&&(!Jo||Ha&&8<Ha&&11>=Ha),Ki=" ",ec=!1;function Rf(a,l){switch(a){case"keyup":return Tf.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Va(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ga=!1;function Ri(a,l){switch(a){case"compositionend":return Va(l);case"keypress":return l.which!==32?null:(ec=!0,Ki);case"textInput":return a=l.data,a===Ki&&ec?null:a;default:return null}}function tc(a,l){if(Ga)return a==="compositionend"||!Jo&&Rf(a,l)?(a=Fa(),Xl=ui=ci=null,Ga=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return _f&&l.locale!=="ko"?null:l.data;default:return null}}var ys={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Su(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!ys[a.type]:l==="textarea"}function Ms(a,l,h,y){Un?Gs?Gs.push(y):Gs=[y]:Un=y,l=vh(l,"onChange"),0<l.length&&(h=new Er("onChange","change",null,h,y),a.push({event:h,listeners:l}))}var Qo=null,Zi=null;function w1(a){Ev(a,0)}function el(a){var l=Ni(a);if(en(l))return a}function Is(a,l){if(a==="change")return l}var Mf=!1;if(Rn){var tl;if(Rn){var Ji="oninput"in document;if(!Ji){var tn=document.createElement("div");tn.setAttribute("oninput","return;"),Ji=typeof tn.oninput=="function"}tl=Ji}else tl=!1;Mf=tl&&(!document.documentMode||9<document.documentMode)}function nl(){Qo&&(Qo.detachEvent("onpropertychange",B),Zi=Qo=null)}function B(a){if(a.propertyName==="value"&&el(Zi)){var l=[];Ms(l,Zi,a,xu(a)),Ef(w1,l)}}function o(a,l,h){a==="focusin"?(nl(),Qo=l,Zi=h,Qo.attachEvent("onpropertychange",B)):a==="focusout"&&nl()}function u(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return el(Zi)}function d(a,l){if(a==="click")return el(l)}function m(a,l){if(a==="input"||a==="change")return el(l)}function x(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var w=typeof Object.is=="function"?Object.is:x;function E(a,l){if(w(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var h=Object.keys(a),y=Object.keys(l);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var S=h[y];if(!Ve.call(l,S)||!w(a[S],l[S]))return!1}return!0}function N(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function O(a,l){var h=N(a);a=0;for(var y;h;){if(h.nodeType===3){if(y=a+h.textContent.length,a<=l&&y>=l)return{node:h,offset:l-a};a=y}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=N(h)}}function I(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?I(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function P(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=zn(a.document);l instanceof a.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)a=l.contentWindow;else break;l=zn(a.document)}return l}function F(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var q=Rn&&"documentMode"in document&&11>=document.documentMode,re=null,ae=null,be=null,Ne=!1;function $e(a,l,h){var y=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ne||re==null||re!==zn(y)||(y=re,"selectionStart"in y&&F(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),be&&E(be,y)||(be=y,y=vh(ae,"onSelect"),0<y.length&&(l=new Er("onSelect","select",null,l,h),a.push({event:l,listeners:y}),l.target=re)))}function Ge(a,l){var h={};return h[a.toLowerCase()]=l.toLowerCase(),h["Webkit"+a]="webkit"+l,h["Moz"+a]="moz"+l,h}var Ue={animationend:Ge("Animation","AnimationEnd"),animationiteration:Ge("Animation","AnimationIteration"),animationstart:Ge("Animation","AnimationStart"),transitionrun:Ge("Transition","TransitionRun"),transitionstart:Ge("Transition","TransitionStart"),transitioncancel:Ge("Transition","TransitionCancel"),transitionend:Ge("Transition","TransitionEnd")},Ht={},Lt={};Rn&&(Lt=document.createElement("div").style,"AnimationEvent"in window||(delete Ue.animationend.animation,delete Ue.animationiteration.animation,delete Ue.animationstart.animation),"TransitionEvent"in window||delete Ue.transitionend.transition);function rr(a){if(Ht[a])return Ht[a];if(!Ue[a])return a;var l=Ue[a],h;for(h in l)if(l.hasOwnProperty(h)&&h in Lt)return Ht[a]=l[h];return a}var ws=rr("animationend"),Ur=rr("animationiteration"),vn=rr("animationstart"),Ar=rr("transitionrun"),cs=rr("transitionstart"),Wa=rr("transitioncancel"),Qi=rr("transitionend"),If=new Map,Au="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Au.push("scrollEnd");function di(a,l){If.set(a,l),sn(l,[a])}var Df=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},qs=[],nc=0,v1=0;function Lf(){for(var a=nc,l=v1=nc=0;l<a;){var h=qs[l];qs[l++]=null;var y=qs[l];qs[l++]=null;var S=qs[l];qs[l++]=null;var k=qs[l];if(qs[l++]=null,y!==null&&S!==null){var D=y.pending;D===null?S.next=S:(S.next=D.next,D.next=S),y.pending=S}k!==0&&sy(h,S,k)}}function jf(a,l,h,y){qs[nc++]=a,qs[nc++]=l,qs[nc++]=h,qs[nc++]=y,v1|=y,a.lanes|=y,a=a.alternate,a!==null&&(a.lanes|=y)}function C1(a,l,h,y){return jf(a,l,h,y),Bf(a)}function rl(a,l){return jf(a,null,null,l),Bf(a)}function sy(a,l,h){a.lanes|=h;var y=a.alternate;y!==null&&(y.lanes|=h);for(var S=!1,k=a.return;k!==null;)k.childLanes|=h,y=k.alternate,y!==null&&(y.childLanes|=h),k.tag===22&&(a=k.stateNode,a===null||a._visibility&1||(S=!0)),a=k,k=k.return;return a.tag===3?(k=a.stateNode,S&&l!==null&&(S=31-At(h),a=k.hiddenUpdates,y=a[S],y===null?a[S]=[l]:y.push(l),l.lane=h|536870912),k):null}function Bf(a){if(50<$u)throw $u=0,Rm=null,Error(r(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var rc={};function j6(a,l,h,y){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ds(a,l,h,y){return new j6(a,l,h,y)}function E1(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ea(a,l){var h=a.alternate;return h===null?(h=Ds(a.tag,l,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=l,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,l=a.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function iy(a,l){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,l=h.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Pf(a,l,h,y,S,k){var D=0;if(y=a,typeof a=="function")E1(a)&&(D=1);else if(typeof a=="string")D=U5(a,h,ge.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case X:return a=Ds(31,h,l,S),a.elementType=X,a.lanes=k,a;case M:return sl(h.children,S,k,l);case R:D=8,S|=24;break;case j:return a=Ds(12,h,l,S|2),a.elementType=j,a.lanes=k,a;case J:return a=Ds(13,h,l,S),a.elementType=J,a.lanes=k,a;case oe:return a=Ds(19,h,l,S),a.elementType=oe,a.lanes=k,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case G:D=10;break e;case H:D=9;break e;case Z:D=11;break e;case U:D=14;break e;case ee:D=16,y=null;break e}D=29,h=Error(r(130,a===null?"null":typeof a,"")),y=null}return l=Ds(D,h,l,S),l.elementType=a,l.type=y,l.lanes=k,l}function sl(a,l,h,y){return a=Ds(7,a,y,l),a.lanes=h,a}function S1(a,l,h){return a=Ds(6,a,null,l),a.lanes=h,a}function ay(a){var l=Ds(18,null,null,0);return l.stateNode=a,l}function A1(a,l,h){return l=Ds(4,a.children!==null?a.children:[],a.key,l),l.lanes=h,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var oy=new WeakMap;function $s(a,l){if(typeof a=="object"&&a!==null){var h=oy.get(a);return h!==void 0?h:(l={value:a,source:l,stack:ft(l)},oy.set(a,l),l)}return{value:a,source:l,stack:ft(l)}}var sc=[],ic=0,Ff=null,Nu=0,Xs=[],Ys=0,qa=null,Mi=1,Ii="";function ta(a,l){sc[ic++]=Nu,sc[ic++]=Ff,Ff=a,Nu=l}function ly(a,l,h){Xs[Ys++]=Mi,Xs[Ys++]=Ii,Xs[Ys++]=qa,qa=a;var y=Mi;a=Ii;var S=32-At(y)-1;y&=~(1<<S),h+=1;var k=32-At(l)+S;if(30<k){var D=S-S%5;k=(y&(1<<D)-1).toString(32),y>>=D,S-=D,Mi=1<<32-At(l)+S|h<<S|y,Ii=k+a}else Mi=1<<k|h<<S|y,Ii=a}function N1(a){a.return!==null&&(ta(a,1),ly(a,1,0))}function k1(a){for(;a===Ff;)Ff=sc[--ic],sc[ic]=null,Nu=sc[--ic],sc[ic]=null;for(;a===qa;)qa=Xs[--Ys],Xs[Ys]=null,Ii=Xs[--Ys],Xs[Ys]=null,Mi=Xs[--Ys],Xs[Ys]=null}function cy(a,l){Xs[Ys++]=Mi,Xs[Ys++]=Ii,Xs[Ys++]=qa,Mi=l.id,Ii=l.overflow,qa=a}var Hr=null,Hn=null,an=!1,$a=null,Ks=!1,T1=Error(r(519));function Xa(a){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ku($s(l,a)),T1}function uy(a){var l=a.stateNode,h=a.type,y=a.memoizedProps;switch(l[qt]=a,l[_t]=y,h){case"dialog":Yt("cancel",l),Yt("close",l);break;case"iframe":case"object":case"embed":Yt("load",l);break;case"video":case"audio":for(h=0;h<Yu.length;h++)Yt(Yu[h],l);break;case"source":Yt("error",l);break;case"img":case"image":case"link":Yt("error",l),Yt("load",l);break;case"details":Yt("toggle",l);break;case"input":Yt("invalid",l),xe(l,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":Yt("invalid",l);break;case"textarea":Yt("invalid",l),as(l,y.value,y.defaultValue,y.children)}h=y.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||y.suppressHydrationWarning===!0||kv(l.textContent,h)?(y.popover!=null&&(Yt("beforetoggle",l),Yt("toggle",l)),y.onScroll!=null&&Yt("scroll",l),y.onScrollEnd!=null&&Yt("scrollend",l),y.onClick!=null&&(l.onclick=bs),l=!0):l=!1,l||Xa(a,!0)}function dy(a){for(Hr=a.return;Hr;)switch(Hr.tag){case 5:case 31:case 13:Ks=!1;return;case 27:case 3:Ks=!0;return;default:Hr=Hr.return}}function ac(a){if(a!==Hr)return!1;if(!an)return dy(a),an=!0,!1;var l=a.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||qm(a.type,a.memoizedProps)),h=!h),h&&Hn&&Xa(a),dy(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Hn=jv(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Hn=jv(a)}else l===27?(l=Hn,lo(a.type)?(a=Zm,Zm=null,Hn=a):Hn=l):Hn=Hr?Js(a.stateNode.nextSibling):null;return!0}function il(){Hn=Hr=null,an=!1}function O1(){var a=$a;return a!==null&&(Ss===null?Ss=a:Ss.push.apply(Ss,a),$a=null),a}function ku(a){$a===null?$a=[a]:$a.push(a)}var _1=V(null),al=null,na=null;function Ya(a,l,h){fe(_1,l._currentValue),l._currentValue=h}function ra(a){a._currentValue=_1.current,te(_1)}function R1(a,l,h){for(;a!==null;){var y=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,y!==null&&(y.childLanes|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),a===h)break;a=a.return}}function M1(a,l,h,y){var S=a.child;for(S!==null&&(S.return=a);S!==null;){var k=S.dependencies;if(k!==null){var D=S.child;k=k.firstContext;e:for(;k!==null;){var z=k;k=S;for(var Q=0;Q<l.length;Q++)if(z.context===l[Q]){k.lanes|=h,z=k.alternate,z!==null&&(z.lanes|=h),R1(k.return,h,a),y||(D=null);break e}k=z.next}}else if(S.tag===18){if(D=S.return,D===null)throw Error(r(341));D.lanes|=h,k=D.alternate,k!==null&&(k.lanes|=h),R1(D,h,a),D=null}else D=S.child;if(D!==null)D.return=S;else for(D=S;D!==null;){if(D===a){D=null;break}if(S=D.sibling,S!==null){S.return=D.return,D=S;break}D=D.return}S=D}}function oc(a,l,h,y){a=null;for(var S=l,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var D=S.alternate;if(D===null)throw Error(r(387));if(D=D.memoizedProps,D!==null){var z=S.type;w(S.pendingProps.value,D.value)||(a!==null?a.push(z):a=[z])}}else if(S===Be.current){if(D=S.alternate,D===null)throw Error(r(387));D.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(a!==null?a.push(ed):a=[ed])}S=S.return}a!==null&&M1(l,a,h,y),l.flags|=262144}function zf(a){for(a=a.firstContext;a!==null;){if(!w(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function ol(a){al=a,na=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Vr(a){return fy(al,a)}function Uf(a,l){return al===null&&ol(a),fy(a,l)}function fy(a,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},na===null){if(a===null)throw Error(r(308));na=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else na=na.next=l;return h}var B6=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(h,y){a.push(y)}};this.abort=function(){l.aborted=!0,a.forEach(function(h){return h()})}},P6=t.unstable_scheduleCallback,F6=t.unstable_NormalPriority,xr={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function I1(){return{controller:new B6,data:new Map,refCount:0}}function Tu(a){a.refCount--,a.refCount===0&&P6(F6,function(){a.controller.abort()})}var Ou=null,D1=0,lc=0,cc=null;function z6(a,l){if(Ou===null){var h=Ou=[];D1=0,lc=Bm(),cc={status:"pending",value:void 0,then:function(y){h.push(y)}}}return D1++,l.then(hy,hy),l}function hy(){if(--D1===0&&Ou!==null){cc!==null&&(cc.status="fulfilled");var a=Ou;Ou=null,lc=0,cc=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function U6(a,l){var h=[],y={status:"pending",value:null,reason:null,then:function(S){h.push(S)}};return a.then(function(){y.status="fulfilled",y.value=l;for(var S=0;S<h.length;S++)(0,h[S])(l)},function(S){for(y.status="rejected",y.reason=S,S=0;S<h.length;S++)(0,h[S])(void 0)}),y}var py=ie.S;ie.S=function(a,l){Zw=on(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&z6(a,l),py!==null&&py(a,l)};var ll=V(null);function L1(){var a=ll.current;return a!==null?a:In.pooledCache}function Hf(a,l){l===null?fe(ll,ll.current):fe(ll,l.pool)}function my(){var a=L1();return a===null?null:{parent:xr._currentValue,pool:a}}var uc=Error(r(460)),j1=Error(r(474)),Vf=Error(r(542)),Gf={then:function(){}};function gy(a){return a=a.status,a==="fulfilled"||a==="rejected"}function xy(a,l,h){switch(h=a[h],h===void 0?a.push(l):h!==l&&(l.then(bs,bs),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,yy(a),a;default:if(typeof l.status=="string")l.then(bs,bs);else{if(a=In,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=l,a.status="pending",a.then(function(y){if(l.status==="pending"){var S=l;S.status="fulfilled",S.value=y}},function(y){if(l.status==="pending"){var S=l;S.status="rejected",S.reason=y}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,yy(a),a}throw ul=l,uc}}function cl(a){try{var l=a._init;return l(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(ul=h,uc):h}}var ul=null;function by(){if(ul===null)throw Error(r(459));var a=ul;return ul=null,a}function yy(a){if(a===uc||a===Vf)throw Error(r(483))}var dc=null,_u=0;function Wf(a){var l=_u;return _u+=1,dc===null&&(dc=[]),xy(dc,a,l)}function Ru(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function qf(a,l){throw l.$$typeof===A?Error(r(525)):(a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function wy(a){function l(he,ce){if(a){var ve=he.deletions;ve===null?(he.deletions=[ce],he.flags|=16):ve.push(ce)}}function h(he,ce){if(!a)return null;for(;ce!==null;)l(he,ce),ce=ce.sibling;return null}function y(he){for(var ce=new Map;he!==null;)he.key!==null?ce.set(he.key,he):ce.set(he.index,he),he=he.sibling;return ce}function S(he,ce){return he=ea(he,ce),he.index=0,he.sibling=null,he}function k(he,ce,ve){return he.index=ve,a?(ve=he.alternate,ve!==null?(ve=ve.index,ve<ce?(he.flags|=67108866,ce):ve):(he.flags|=67108866,ce)):(he.flags|=1048576,ce)}function D(he){return a&&he.alternate===null&&(he.flags|=67108866),he}function z(he,ce,ve,Me){return ce===null||ce.tag!==6?(ce=S1(ve,he.mode,Me),ce.return=he,ce):(ce=S(ce,ve),ce.return=he,ce)}function Q(he,ce,ve,Me){var wt=ve.type;return wt===M?_e(he,ce,ve.props.children,Me,ve.key):ce!==null&&(ce.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===ee&&cl(wt)===ce.type)?(ce=S(ce,ve.props),Ru(ce,ve),ce.return=he,ce):(ce=Pf(ve.type,ve.key,ve.props,null,he.mode,Me),Ru(ce,ve),ce.return=he,ce)}function Ee(he,ce,ve,Me){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ve.containerInfo||ce.stateNode.implementation!==ve.implementation?(ce=A1(ve,he.mode,Me),ce.return=he,ce):(ce=S(ce,ve.children||[]),ce.return=he,ce)}function _e(he,ce,ve,Me,wt){return ce===null||ce.tag!==7?(ce=sl(ve,he.mode,Me,wt),ce.return=he,ce):(ce=S(ce,ve),ce.return=he,ce)}function Le(he,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=S1(""+ce,he.mode,ve),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case T:return ve=Pf(ce.type,ce.key,ce.props,null,he.mode,ve),Ru(ve,ce),ve.return=he,ve;case _:return ce=A1(ce,he.mode,ve),ce.return=he,ce;case ee:return ce=cl(ce),Le(he,ce,ve)}if(ne(ce)||ue(ce))return ce=sl(ce,he.mode,ve,null),ce.return=he,ce;if(typeof ce.then=="function")return Le(he,Wf(ce),ve);if(ce.$$typeof===G)return Le(he,Uf(he,ce),ve);qf(he,ce)}return null}function Se(he,ce,ve,Me){var wt=ce!==null?ce.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return wt!==null?null:z(he,ce,""+ve,Me);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case T:return ve.key===wt?Q(he,ce,ve,Me):null;case _:return ve.key===wt?Ee(he,ce,ve,Me):null;case ee:return ve=cl(ve),Se(he,ce,ve,Me)}if(ne(ve)||ue(ve))return wt!==null?null:_e(he,ce,ve,Me,null);if(typeof ve.then=="function")return Se(he,ce,Wf(ve),Me);if(ve.$$typeof===G)return Se(he,ce,Uf(he,ve),Me);qf(he,ve)}return null}function Te(he,ce,ve,Me,wt){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return he=he.get(ve)||null,z(ce,he,""+Me,wt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case T:return he=he.get(Me.key===null?ve:Me.key)||null,Q(ce,he,Me,wt);case _:return he=he.get(Me.key===null?ve:Me.key)||null,Ee(ce,he,Me,wt);case ee:return Me=cl(Me),Te(he,ce,ve,Me,wt)}if(ne(Me)||ue(Me))return he=he.get(ve)||null,_e(ce,he,Me,wt,null);if(typeof Me.then=="function")return Te(he,ce,ve,Wf(Me),wt);if(Me.$$typeof===G)return Te(he,ce,ve,Uf(ce,Me),wt);qf(ce,Me)}return null}function dt(he,ce,ve,Me){for(var wt=null,fn=null,pt=ce,Ut=ce=0,rn=null;pt!==null&&Ut<ve.length;Ut++){pt.index>Ut?(rn=pt,pt=null):rn=pt.sibling;var hn=Se(he,pt,ve[Ut],Me);if(hn===null){pt===null&&(pt=rn);break}a&&pt&&hn.alternate===null&&l(he,pt),ce=k(hn,ce,Ut),fn===null?wt=hn:fn.sibling=hn,fn=hn,pt=rn}if(Ut===ve.length)return h(he,pt),an&&ta(he,Ut),wt;if(pt===null){for(;Ut<ve.length;Ut++)pt=Le(he,ve[Ut],Me),pt!==null&&(ce=k(pt,ce,Ut),fn===null?wt=pt:fn.sibling=pt,fn=pt);return an&&ta(he,Ut),wt}for(pt=y(pt);Ut<ve.length;Ut++)rn=Te(pt,he,Ut,ve[Ut],Me),rn!==null&&(a&&rn.alternate!==null&&pt.delete(rn.key===null?Ut:rn.key),ce=k(rn,ce,Ut),fn===null?wt=rn:fn.sibling=rn,fn=rn);return a&&pt.forEach(function(po){return l(he,po)}),an&&ta(he,Ut),wt}function Nt(he,ce,ve,Me){if(ve==null)throw Error(r(151));for(var wt=null,fn=null,pt=ce,Ut=ce=0,rn=null,hn=ve.next();pt!==null&&!hn.done;Ut++,hn=ve.next()){pt.index>Ut?(rn=pt,pt=null):rn=pt.sibling;var po=Se(he,pt,hn.value,Me);if(po===null){pt===null&&(pt=rn);break}a&&pt&&po.alternate===null&&l(he,pt),ce=k(po,ce,Ut),fn===null?wt=po:fn.sibling=po,fn=po,pt=rn}if(hn.done)return h(he,pt),an&&ta(he,Ut),wt;if(pt===null){for(;!hn.done;Ut++,hn=ve.next())hn=Le(he,hn.value,Me),hn!==null&&(ce=k(hn,ce,Ut),fn===null?wt=hn:fn.sibling=hn,fn=hn);return an&&ta(he,Ut),wt}for(pt=y(pt);!hn.done;Ut++,hn=ve.next())hn=Te(pt,he,Ut,hn.value,Me),hn!==null&&(a&&hn.alternate!==null&&pt.delete(hn.key===null?Ut:hn.key),ce=k(hn,ce,Ut),fn===null?wt=hn:fn.sibling=hn,fn=hn);return a&&pt.forEach(function(J5){return l(he,J5)}),an&&ta(he,Ut),wt}function kn(he,ce,ve,Me){if(typeof ve=="object"&&ve!==null&&ve.type===M&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case T:e:{for(var wt=ve.key;ce!==null;){if(ce.key===wt){if(wt=ve.type,wt===M){if(ce.tag===7){h(he,ce.sibling),Me=S(ce,ve.props.children),Me.return=he,he=Me;break e}}else if(ce.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===ee&&cl(wt)===ce.type){h(he,ce.sibling),Me=S(ce,ve.props),Ru(Me,ve),Me.return=he,he=Me;break e}h(he,ce);break}else l(he,ce);ce=ce.sibling}ve.type===M?(Me=sl(ve.props.children,he.mode,Me,ve.key),Me.return=he,he=Me):(Me=Pf(ve.type,ve.key,ve.props,null,he.mode,Me),Ru(Me,ve),Me.return=he,he=Me)}return D(he);case _:e:{for(wt=ve.key;ce!==null;){if(ce.key===wt)if(ce.tag===4&&ce.stateNode.containerInfo===ve.containerInfo&&ce.stateNode.implementation===ve.implementation){h(he,ce.sibling),Me=S(ce,ve.children||[]),Me.return=he,he=Me;break e}else{h(he,ce);break}else l(he,ce);ce=ce.sibling}Me=A1(ve,he.mode,Me),Me.return=he,he=Me}return D(he);case ee:return ve=cl(ve),kn(he,ce,ve,Me)}if(ne(ve))return dt(he,ce,ve,Me);if(ue(ve)){if(wt=ue(ve),typeof wt!="function")throw Error(r(150));return ve=wt.call(ve),Nt(he,ce,ve,Me)}if(typeof ve.then=="function")return kn(he,ce,Wf(ve),Me);if(ve.$$typeof===G)return kn(he,ce,Uf(he,ve),Me);qf(he,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ce!==null&&ce.tag===6?(h(he,ce.sibling),Me=S(ce,ve),Me.return=he,he=Me):(h(he,ce),Me=S1(ve,he.mode,Me),Me.return=he,he=Me),D(he)):h(he,ce)}return function(he,ce,ve,Me){try{_u=0;var wt=kn(he,ce,ve,Me);return dc=null,wt}catch(pt){if(pt===uc||pt===Vf)throw pt;var fn=Ds(29,pt,null,he.mode);return fn.lanes=Me,fn.return=he,fn}finally{}}}var dl=wy(!0),vy=wy(!1),Ka=!1;function B1(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function P1(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Za(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ja(a,l,h){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(gn&2)!==0){var S=y.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),y.pending=l,l=Bf(a),sy(a,null,h),l}return jf(a,y,l,h),Bf(a)}function Mu(a,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var y=l.lanes;y&=a.pendingLanes,h|=y,l.lanes=h,nt(a,h)}}function F1(a,l){var h=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var S=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var D={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};k===null?S=k=D:k=k.next=D,h=h.next}while(h!==null);k===null?S=k=l:k=k.next=l}else S=k=l;h={baseState:y.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:y.shared,callbacks:y.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=l:a.next=l,h.lastBaseUpdate=l}var z1=!1;function Iu(){if(z1){var a=cc;if(a!==null)throw a}}function Du(a,l,h,y){z1=!1;var S=a.updateQueue;Ka=!1;var k=S.firstBaseUpdate,D=S.lastBaseUpdate,z=S.shared.pending;if(z!==null){S.shared.pending=null;var Q=z,Ee=Q.next;Q.next=null,D===null?k=Ee:D.next=Ee,D=Q;var _e=a.alternate;_e!==null&&(_e=_e.updateQueue,z=_e.lastBaseUpdate,z!==D&&(z===null?_e.firstBaseUpdate=Ee:z.next=Ee,_e.lastBaseUpdate=Q))}if(k!==null){var Le=S.baseState;D=0,_e=Ee=Q=null,z=k;do{var Se=z.lane&-536870913,Te=Se!==z.lane;if(Te?(nn&Se)===Se:(y&Se)===Se){Se!==0&&Se===lc&&(z1=!0),_e!==null&&(_e=_e.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var dt=a,Nt=z;Se=l;var kn=h;switch(Nt.tag){case 1:if(dt=Nt.payload,typeof dt=="function"){Le=dt.call(kn,Le,Se);break e}Le=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=Nt.payload,Se=typeof dt=="function"?dt.call(kn,Le,Se):dt,Se==null)break e;Le=v({},Le,Se);break e;case 2:Ka=!0}}Se=z.callback,Se!==null&&(a.flags|=64,Te&&(a.flags|=8192),Te=S.callbacks,Te===null?S.callbacks=[Se]:Te.push(Se))}else Te={lane:Se,tag:z.tag,payload:z.payload,callback:z.callback,next:null},_e===null?(Ee=_e=Te,Q=Le):_e=_e.next=Te,D|=Se;if(z=z.next,z===null){if(z=S.shared.pending,z===null)break;Te=z,z=Te.next,Te.next=null,S.lastBaseUpdate=Te,S.shared.pending=null}}while(!0);_e===null&&(Q=Le),S.baseState=Q,S.firstBaseUpdate=Ee,S.lastBaseUpdate=_e,k===null&&(S.shared.lanes=0),ro|=D,a.lanes=D,a.memoizedState=Le}}function Cy(a,l){if(typeof a!="function")throw Error(r(191,a));a.call(l)}function Ey(a,l){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)Cy(h[a],l)}var fc=V(null),$f=V(0);function Sy(a,l){a=fa,fe($f,a),fe(fc,l),fa=a|l.baseLanes}function U1(){fe($f,fa),fe(fc,fc.current)}function H1(){fa=$f.current,te(fc),te($f)}var Ls=V(null),Zs=null;function Qa(a){var l=a.alternate;fe(hr,hr.current&1),fe(Ls,a),Zs===null&&(l===null||fc.current!==null||l.memoizedState!==null)&&(Zs=a)}function V1(a){fe(hr,hr.current),fe(Ls,a),Zs===null&&(Zs=a)}function Ay(a){a.tag===22?(fe(hr,hr.current),fe(Ls,a),Zs===null&&(Zs=a)):eo()}function eo(){fe(hr,hr.current),fe(Ls,Ls.current)}function js(a){te(Ls),Zs===a&&(Zs=null),te(hr)}var hr=V(0);function Xf(a){for(var l=a;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Ym(h)||Km(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var sa=0,Ft=null,An=null,br=null,Yf=!1,hc=!1,fl=!1,Kf=0,Lu=0,pc=null,H6=0;function sr(){throw Error(r(321))}function G1(a,l){if(l===null)return!1;for(var h=0;h<l.length&&h<a.length;h++)if(!w(a[h],l[h]))return!1;return!0}function W1(a,l,h,y,S,k){return sa=k,Ft=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ie.H=a===null||a.memoizedState===null?lw:am,fl=!1,k=h(y,S),fl=!1,hc&&(k=ky(l,h,y,S)),Ny(a),k}function Ny(a){ie.H=Pu;var l=An!==null&&An.next!==null;if(sa=0,br=An=Ft=null,Yf=!1,Lu=0,pc=null,l)throw Error(r(300));a===null||yr||(a=a.dependencies,a!==null&&zf(a)&&(yr=!0))}function ky(a,l,h,y){Ft=a;var S=0;do{if(hc&&(pc=null),Lu=0,hc=!1,25<=S)throw Error(r(301));if(S+=1,br=An=null,a.updateQueue!=null){var k=a.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}ie.H=cw,k=l(h,y)}while(hc);return k}function V6(){var a=ie.H,l=a.useState()[0];return l=typeof l.then=="function"?ju(l):l,a=a.useState()[0],(An!==null?An.memoizedState:null)!==a&&(Ft.flags|=1024),l}function q1(){var a=Kf!==0;return Kf=0,a}function $1(a,l,h){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~h}function X1(a){if(Yf){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Yf=!1}sa=0,br=An=Ft=null,hc=!1,Lu=Kf=0,pc=null}function us(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?Ft.memoizedState=br=a:br=br.next=a,br}function pr(){if(An===null){var a=Ft.alternate;a=a!==null?a.memoizedState:null}else a=An.next;var l=br===null?Ft.memoizedState:br.next;if(l!==null)br=l,An=a;else{if(a===null)throw Ft.alternate===null?Error(r(467)):Error(r(310));An=a,a={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},br===null?Ft.memoizedState=br=a:br=br.next=a}return br}function Zf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ju(a){var l=Lu;return Lu+=1,pc===null&&(pc=[]),a=xy(pc,a,l),l=Ft,(br===null?l.memoizedState:br.next)===null&&(l=l.alternate,ie.H=l===null||l.memoizedState===null?lw:am),a}function Jf(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return ju(a);if(a.$$typeof===G)return Vr(a)}throw Error(r(438,String(a)))}function Y1(a){var l=null,h=Ft.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var y=Ft.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(l={data:y.data.map(function(S){return S.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Zf(),Ft.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(a),y=0;y<a;y++)h[y]=Qe;return l.index++,h}function ia(a,l){return typeof l=="function"?l(a):l}function Qf(a){var l=pr();return K1(l,An,a)}function K1(a,l,h){var y=a.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=h;var S=a.baseQueue,k=y.pending;if(k!==null){if(S!==null){var D=S.next;S.next=k.next,k.next=D}l.baseQueue=S=k,y.pending=null}if(k=a.baseState,S===null)a.memoizedState=k;else{l=S.next;var z=D=null,Q=null,Ee=l,_e=!1;do{var Le=Ee.lane&-536870913;if(Le!==Ee.lane?(nn&Le)===Le:(sa&Le)===Le){var Se=Ee.revertLane;if(Se===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),Le===lc&&(_e=!0);else if((sa&Se)===Se){Ee=Ee.next,Se===lc&&(_e=!0);continue}else Le={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},Q===null?(z=Q=Le,D=k):Q=Q.next=Le,Ft.lanes|=Se,ro|=Se;Le=Ee.action,fl&&h(k,Le),k=Ee.hasEagerState?Ee.eagerState:h(k,Le)}else Se={lane:Le,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},Q===null?(z=Q=Se,D=k):Q=Q.next=Se,Ft.lanes|=Le,ro|=Le;Ee=Ee.next}while(Ee!==null&&Ee!==l);if(Q===null?D=k:Q.next=z,!w(k,a.memoizedState)&&(yr=!0,_e&&(h=cc,h!==null)))throw h;a.memoizedState=k,a.baseState=D,a.baseQueue=Q,y.lastRenderedState=k}return S===null&&(y.lanes=0),[a.memoizedState,y.dispatch]}function Z1(a){var l=pr(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var y=h.dispatch,S=h.pending,k=l.memoizedState;if(S!==null){h.pending=null;var D=S=S.next;do k=a(k,D.action),D=D.next;while(D!==S);w(k,l.memoizedState)||(yr=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),h.lastRenderedState=k}return[k,y]}function Ty(a,l,h){var y=Ft,S=pr(),k=an;if(k){if(h===void 0)throw Error(r(407));h=h()}else h=l();var D=!w((An||S).memoizedState,h);if(D&&(S.memoizedState=h,yr=!0),S=S.queue,em(Ry.bind(null,y,S,a),[a]),S.getSnapshot!==l||D||br!==null&&br.memoizedState.tag&1){if(y.flags|=2048,mc(9,{destroy:void 0},_y.bind(null,y,S,h,l),null),In===null)throw Error(r(349));k||(sa&127)!==0||Oy(y,l,h)}return h}function Oy(a,l,h){a.flags|=16384,a={getSnapshot:l,value:h},l=Ft.updateQueue,l===null?(l=Zf(),Ft.updateQueue=l,l.stores=[a]):(h=l.stores,h===null?l.stores=[a]:h.push(a))}function _y(a,l,h,y){l.value=h,l.getSnapshot=y,My(l)&&Iy(a)}function Ry(a,l,h){return h(function(){My(l)&&Iy(a)})}function My(a){var l=a.getSnapshot;a=a.value;try{var h=l();return!w(a,h)}catch{return!0}}function Iy(a){var l=rl(a,2);l!==null&&As(l,a,2)}function J1(a){var l=us();if(typeof a=="function"){var h=a;if(a=h(),fl){Zt(!0);try{h()}finally{Zt(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:a},l}function Dy(a,l,h,y){return a.baseState=h,K1(a,An,typeof y=="function"?y:ia)}function G6(a,l,h,y,S){if(nh(a))throw Error(r(485));if(a=l.action,a!==null){var k={payload:S,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){k.listeners.push(D)}};ie.T!==null?h(!0):k.isTransition=!1,y(k),h=l.pending,h===null?(k.next=l.pending=k,Ly(l,k)):(k.next=h.next,l.pending=h.next=k)}}function Ly(a,l){var h=l.action,y=l.payload,S=a.state;if(l.isTransition){var k=ie.T,D={};ie.T=D;try{var z=h(S,y),Q=ie.S;Q!==null&&Q(D,z),jy(a,l,z)}catch(Ee){Q1(a,l,Ee)}finally{k!==null&&D.types!==null&&(k.types=D.types),ie.T=k}}else try{k=h(S,y),jy(a,l,k)}catch(Ee){Q1(a,l,Ee)}}function jy(a,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(y){By(a,l,y)},function(y){return Q1(a,l,y)}):By(a,l,h)}function By(a,l,h){l.status="fulfilled",l.value=h,Py(l),a.state=h,l=a.pending,l!==null&&(h=l.next,h===l?a.pending=null:(h=h.next,l.next=h,Ly(a,h)))}function Q1(a,l,h){var y=a.pending;if(a.pending=null,y!==null){y=y.next;do l.status="rejected",l.reason=h,Py(l),l=l.next;while(l!==y)}a.action=null}function Py(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function Fy(a,l){return l}function zy(a,l){if(an){var h=In.formState;if(h!==null){e:{var y=Ft;if(an){if(Hn){t:{for(var S=Hn,k=Ks;S.nodeType!==8;){if(!k){S=null;break t}if(S=Js(S.nextSibling),S===null){S=null;break t}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){Hn=Js(S.nextSibling),y=S.data==="F!";break e}}Xa(y)}y=!1}y&&(l=h[0])}}return h=us(),h.memoizedState=h.baseState=l,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fy,lastRenderedState:l},h.queue=y,h=iw.bind(null,Ft,y),y.dispatch=h,y=J1(!1),k=im.bind(null,Ft,!1,y.queue),y=us(),S={state:l,dispatch:null,action:a,pending:null},y.queue=S,h=G6.bind(null,Ft,S,k,h),S.dispatch=h,y.memoizedState=a,[l,h,!1]}function Uy(a){var l=pr();return Hy(l,An,a)}function Hy(a,l,h){if(l=K1(a,l,Fy)[0],a=Qf(ia)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var y=ju(l)}catch(D){throw D===uc?Vf:D}else y=l;l=pr();var S=l.queue,k=S.dispatch;return h!==l.memoizedState&&(Ft.flags|=2048,mc(9,{destroy:void 0},W6.bind(null,S,h),null)),[y,k,a]}function W6(a,l){a.action=l}function Vy(a){var l=pr(),h=An;if(h!==null)return Hy(l,h,a);pr(),l=l.memoizedState,h=pr();var y=h.queue.dispatch;return h.memoizedState=a,[l,y,!1]}function mc(a,l,h,y){return a={tag:a,create:h,deps:y,inst:l,next:null},l=Ft.updateQueue,l===null&&(l=Zf(),Ft.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=a.next=a:(y=h.next,h.next=a,a.next=y,l.lastEffect=a),a}function Gy(){return pr().memoizedState}function eh(a,l,h,y){var S=us();Ft.flags|=a,S.memoizedState=mc(1|l,{destroy:void 0},h,y===void 0?null:y)}function th(a,l,h,y){var S=pr();y=y===void 0?null:y;var k=S.memoizedState.inst;An!==null&&y!==null&&G1(y,An.memoizedState.deps)?S.memoizedState=mc(l,k,h,y):(Ft.flags|=a,S.memoizedState=mc(1|l,k,h,y))}function Wy(a,l){eh(8390656,8,a,l)}function em(a,l){th(2048,8,a,l)}function q6(a){Ft.flags|=4;var l=Ft.updateQueue;if(l===null)l=Zf(),Ft.updateQueue=l,l.events=[a];else{var h=l.events;h===null?l.events=[a]:h.push(a)}}function qy(a){var l=pr().memoizedState;return q6({ref:l,nextImpl:a}),function(){if((gn&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function $y(a,l){return th(4,2,a,l)}function Xy(a,l){return th(4,4,a,l)}function Yy(a,l){if(typeof l=="function"){a=a();var h=l(a);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Ky(a,l,h){h=h!=null?h.concat([a]):null,th(4,4,Yy.bind(null,l,a),h)}function tm(){}function Zy(a,l){var h=pr();l=l===void 0?null:l;var y=h.memoizedState;return l!==null&&G1(l,y[1])?y[0]:(h.memoizedState=[a,l],a)}function Jy(a,l){var h=pr();l=l===void 0?null:l;var y=h.memoizedState;if(l!==null&&G1(l,y[1]))return y[0];if(y=a(),fl){Zt(!0);try{a()}finally{Zt(!1)}}return h.memoizedState=[y,l],y}function nm(a,l,h){return h===void 0||(sa&1073741824)!==0&&(nn&261930)===0?a.memoizedState=l:(a.memoizedState=h,a=Qw(),Ft.lanes|=a,ro|=a,h)}function Qy(a,l,h,y){return w(h,l)?h:fc.current!==null?(a=nm(a,h,y),w(a,l)||(yr=!0),a):(sa&42)===0||(sa&1073741824)!==0&&(nn&261930)===0?(yr=!0,a.memoizedState=h):(a=Qw(),Ft.lanes|=a,ro|=a,l)}function ew(a,l,h,y,S){var k=pe.p;pe.p=k!==0&&8>k?k:8;var D=ie.T,z={};ie.T=z,im(a,!1,l,h);try{var Q=S(),Ee=ie.S;if(Ee!==null&&Ee(z,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var _e=U6(Q,y);Bu(a,l,_e,Fs(a))}else Bu(a,l,y,Fs(a))}catch(Le){Bu(a,l,{then:function(){},status:"rejected",reason:Le},Fs())}finally{pe.p=k,D!==null&&z.types!==null&&(D.types=z.types),ie.T=D}}function $6(){}function rm(a,l,h,y){if(a.tag!==5)throw Error(r(476));var S=tw(a).queue;ew(a,S,l,me,h===null?$6:function(){return nw(a),h(y)})}function tw(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:me},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:h},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function nw(a){var l=tw(a);l.next===null&&(l=a.alternate.memoizedState),Bu(a,l.next.queue,{},Fs())}function sm(){return Vr(ed)}function rw(){return pr().memoizedState}function sw(){return pr().memoizedState}function X6(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var h=Fs();a=Za(h);var y=Ja(l,a,h);y!==null&&(As(y,l,h),Mu(y,l,h)),l={cache:I1()},a.payload=l;return}l=l.return}}function Y6(a,l,h){var y=Fs();h={lane:y,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},nh(a)?aw(l,h):(h=C1(a,l,h,y),h!==null&&(As(h,a,y),ow(h,l,y)))}function iw(a,l,h){var y=Fs();Bu(a,l,h,y)}function Bu(a,l,h,y){var S={lane:y,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(nh(a))aw(l,S);else{var k=a.alternate;if(a.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var D=l.lastRenderedState,z=k(D,h);if(S.hasEagerState=!0,S.eagerState=z,w(z,D))return jf(a,l,S,0),In===null&&Lf(),!1}catch{}finally{}if(h=C1(a,l,S,y),h!==null)return As(h,a,y),ow(h,l,y),!0}return!1}function im(a,l,h,y){if(y={lane:2,revertLane:Bm(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},nh(a)){if(l)throw Error(r(479))}else l=C1(a,h,y,2),l!==null&&As(l,a,2)}function nh(a){var l=a.alternate;return a===Ft||l!==null&&l===Ft}function aw(a,l){hc=Yf=!0;var h=a.pending;h===null?l.next=l:(l.next=h.next,h.next=l),a.pending=l}function ow(a,l,h){if((h&4194048)!==0){var y=l.lanes;y&=a.pendingLanes,h|=y,l.lanes=h,nt(a,h)}}var Pu={readContext:Vr,use:Jf,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useLayoutEffect:sr,useInsertionEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useSyncExternalStore:sr,useId:sr,useHostTransitionStatus:sr,useFormState:sr,useActionState:sr,useOptimistic:sr,useMemoCache:sr,useCacheRefresh:sr};Pu.useEffectEvent=sr;var lw={readContext:Vr,use:Jf,useCallback:function(a,l){return us().memoizedState=[a,l===void 0?null:l],a},useContext:Vr,useEffect:Wy,useImperativeHandle:function(a,l,h){h=h!=null?h.concat([a]):null,eh(4194308,4,Yy.bind(null,l,a),h)},useLayoutEffect:function(a,l){return eh(4194308,4,a,l)},useInsertionEffect:function(a,l){eh(4,2,a,l)},useMemo:function(a,l){var h=us();l=l===void 0?null:l;var y=a();if(fl){Zt(!0);try{a()}finally{Zt(!1)}}return h.memoizedState=[y,l],y},useReducer:function(a,l,h){var y=us();if(h!==void 0){var S=h(l);if(fl){Zt(!0);try{h(l)}finally{Zt(!1)}}}else S=l;return y.memoizedState=y.baseState=S,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:S},y.queue=a,a=a.dispatch=Y6.bind(null,Ft,a),[y.memoizedState,a]},useRef:function(a){var l=us();return a={current:a},l.memoizedState=a},useState:function(a){a=J1(a);var l=a.queue,h=iw.bind(null,Ft,l);return l.dispatch=h,[a.memoizedState,h]},useDebugValue:tm,useDeferredValue:function(a,l){var h=us();return nm(h,a,l)},useTransition:function(){var a=J1(!1);return a=ew.bind(null,Ft,a.queue,!0,!1),us().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,h){var y=Ft,S=us();if(an){if(h===void 0)throw Error(r(407));h=h()}else{if(h=l(),In===null)throw Error(r(349));(nn&127)!==0||Oy(y,l,h)}S.memoizedState=h;var k={value:h,getSnapshot:l};return S.queue=k,Wy(Ry.bind(null,y,k,a),[a]),y.flags|=2048,mc(9,{destroy:void 0},_y.bind(null,y,k,h,l),null),h},useId:function(){var a=us(),l=In.identifierPrefix;if(an){var h=Ii,y=Mi;h=(y&~(1<<32-At(y)-1)).toString(32)+h,l="_"+l+"R_"+h,h=Kf++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=H6++,l="_"+l+"r_"+h.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:sm,useFormState:zy,useActionState:zy,useOptimistic:function(a){var l=us();l.memoizedState=l.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=im.bind(null,Ft,!0,h),h.dispatch=l,[a,l]},useMemoCache:Y1,useCacheRefresh:function(){return us().memoizedState=X6.bind(null,Ft)},useEffectEvent:function(a){var l=us(),h={impl:a};return l.memoizedState=h,function(){if((gn&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},am={readContext:Vr,use:Jf,useCallback:Zy,useContext:Vr,useEffect:em,useImperativeHandle:Ky,useInsertionEffect:$y,useLayoutEffect:Xy,useMemo:Jy,useReducer:Qf,useRef:Gy,useState:function(){return Qf(ia)},useDebugValue:tm,useDeferredValue:function(a,l){var h=pr();return Qy(h,An.memoizedState,a,l)},useTransition:function(){var a=Qf(ia)[0],l=pr().memoizedState;return[typeof a=="boolean"?a:ju(a),l]},useSyncExternalStore:Ty,useId:rw,useHostTransitionStatus:sm,useFormState:Uy,useActionState:Uy,useOptimistic:function(a,l){var h=pr();return Dy(h,An,a,l)},useMemoCache:Y1,useCacheRefresh:sw};am.useEffectEvent=qy;var cw={readContext:Vr,use:Jf,useCallback:Zy,useContext:Vr,useEffect:em,useImperativeHandle:Ky,useInsertionEffect:$y,useLayoutEffect:Xy,useMemo:Jy,useReducer:Z1,useRef:Gy,useState:function(){return Z1(ia)},useDebugValue:tm,useDeferredValue:function(a,l){var h=pr();return An===null?nm(h,a,l):Qy(h,An.memoizedState,a,l)},useTransition:function(){var a=Z1(ia)[0],l=pr().memoizedState;return[typeof a=="boolean"?a:ju(a),l]},useSyncExternalStore:Ty,useId:rw,useHostTransitionStatus:sm,useFormState:Vy,useActionState:Vy,useOptimistic:function(a,l){var h=pr();return An!==null?Dy(h,An,a,l):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:Y1,useCacheRefresh:sw};cw.useEffectEvent=qy;function om(a,l,h,y){l=a.memoizedState,h=h(y,l),h=h==null?l:v({},l,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var lm={enqueueSetState:function(a,l,h){a=a._reactInternals;var y=Fs(),S=Za(y);S.payload=l,h!=null&&(S.callback=h),l=Ja(a,S,y),l!==null&&(As(l,a,y),Mu(l,a,y))},enqueueReplaceState:function(a,l,h){a=a._reactInternals;var y=Fs(),S=Za(y);S.tag=1,S.payload=l,h!=null&&(S.callback=h),l=Ja(a,S,y),l!==null&&(As(l,a,y),Mu(l,a,y))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var h=Fs(),y=Za(h);y.tag=2,l!=null&&(y.callback=l),l=Ja(a,y,h),l!==null&&(As(l,a,h),Mu(l,a,h))}};function uw(a,l,h,y,S,k,D){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,k,D):l.prototype&&l.prototype.isPureReactComponent?!E(h,y)||!E(S,k):!0}function dw(a,l,h,y){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,y),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,y),l.state!==a&&lm.enqueueReplaceState(l,l.state,null)}function hl(a,l){var h=l;if("ref"in l){h={};for(var y in l)y!=="ref"&&(h[y]=l[y])}if(a=a.defaultProps){h===l&&(h=v({},h));for(var S in a)h[S]===void 0&&(h[S]=a[S])}return h}function fw(a){Df(a)}function hw(a){console.error(a)}function pw(a){Df(a)}function rh(a,l){try{var h=a.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(y){setTimeout(function(){throw y})}}function mw(a,l,h){try{var y=a.onCaughtError;y(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function cm(a,l,h){return h=Za(h),h.tag=3,h.payload={element:null},h.callback=function(){rh(a,l)},h}function gw(a){return a=Za(a),a.tag=3,a}function xw(a,l,h,y){var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var k=y.value;a.payload=function(){return S(k)},a.callback=function(){mw(l,h,y)}}var D=h.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(a.callback=function(){mw(l,h,y),typeof S!="function"&&(so===null?so=new Set([this]):so.add(this));var z=y.stack;this.componentDidCatch(y.value,{componentStack:z!==null?z:""})})}function K6(a,l,h,y,S){if(h.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(l=h.alternate,l!==null&&oc(l,h,S,!0),h=Ls.current,h!==null){switch(h.tag){case 31:case 13:return Zs===null?mh():h.alternate===null&&ir===0&&(ir=3),h.flags&=-257,h.flags|=65536,h.lanes=S,y===Gf?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([y]):l.add(y),Dm(a,y,S)),!1;case 22:return h.flags|=65536,y===Gf?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([y])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([y]):h.add(y)),Dm(a,y,S)),!1}throw Error(r(435,h.tag))}return Dm(a,y,S),mh(),!1}if(an)return l=Ls.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=S,y!==T1&&(a=Error(r(422),{cause:y}),ku($s(a,h)))):(y!==T1&&(l=Error(r(423),{cause:y}),ku($s(l,h))),a=a.current.alternate,a.flags|=65536,S&=-S,a.lanes|=S,y=$s(y,h),S=cm(a.stateNode,y,S),F1(a,S),ir!==4&&(ir=2)),!1;var k=Error(r(520),{cause:y});if(k=$s(k,h),qu===null?qu=[k]:qu.push(k),ir!==4&&(ir=2),l===null)return!0;y=$s(y,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,a=S&-S,h.lanes|=a,a=cm(h.stateNode,y,a),F1(h,a),!1;case 1:if(l=h.type,k=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(so===null||!so.has(k))))return h.flags|=65536,S&=-S,h.lanes|=S,S=gw(S),xw(S,a,h,y),F1(h,S),!1}h=h.return}while(h!==null);return!1}var um=Error(r(461)),yr=!1;function Gr(a,l,h,y){l.child=a===null?vy(l,null,h,y):dl(l,a.child,h,y)}function bw(a,l,h,y,S){h=h.render;var k=l.ref;if("ref"in y){var D={};for(var z in y)z!=="ref"&&(D[z]=y[z])}else D=y;return ol(l),y=W1(a,l,h,D,k,S),z=q1(),a!==null&&!yr?($1(a,l,S),aa(a,l,S)):(an&&z&&N1(l),l.flags|=1,Gr(a,l,y,S),l.child)}function yw(a,l,h,y,S){if(a===null){var k=h.type;return typeof k=="function"&&!E1(k)&&k.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=k,ww(a,l,k,y,S)):(a=Pf(h.type,null,y,l,l.mode,S),a.ref=l.ref,a.return=l,l.child=a)}if(k=a.child,!bm(a,S)){var D=k.memoizedProps;if(h=h.compare,h=h!==null?h:E,h(D,y)&&a.ref===l.ref)return aa(a,l,S)}return l.flags|=1,a=ea(k,y),a.ref=l.ref,a.return=l,l.child=a}function ww(a,l,h,y,S){if(a!==null){var k=a.memoizedProps;if(E(k,y)&&a.ref===l.ref)if(yr=!1,l.pendingProps=y=k,bm(a,S))(a.flags&131072)!==0&&(yr=!0);else return l.lanes=a.lanes,aa(a,l,S)}return dm(a,l,h,y,S)}function vw(a,l,h,y){var S=y.children,k=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((l.flags&128)!==0){if(k=k!==null?k.baseLanes|h:h,a!==null){for(y=l.child=a.child,S=0;y!==null;)S=S|y.lanes|y.childLanes,y=y.sibling;y=S&~k}else y=0,l.child=null;return Cw(a,l,k,h,y)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Hf(l,k!==null?k.cachePool:null),k!==null?Sy(l,k):U1(),Ay(l);else return y=l.lanes=536870912,Cw(a,l,k!==null?k.baseLanes|h:h,h,y)}else k!==null?(Hf(l,k.cachePool),Sy(l,k),eo(),l.memoizedState=null):(a!==null&&Hf(l,null),U1(),eo());return Gr(a,l,S,h),l.child}function Fu(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function Cw(a,l,h,y,S){var k=L1();return k=k===null?null:{parent:xr._currentValue,pool:k},l.memoizedState={baseLanes:h,cachePool:k},a!==null&&Hf(l,null),U1(),Ay(l),a!==null&&oc(a,l,y,!0),l.childLanes=S,null}function sh(a,l){return l=ah({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function Ew(a,l,h){return dl(l,a.child,null,h),a=sh(l,l.pendingProps),a.flags|=2,js(l),l.memoizedState=null,a}function Z6(a,l,h){var y=l.pendingProps,S=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(an){if(y.mode==="hidden")return a=sh(l,y),l.lanes=536870912,Fu(null,a);if(V1(l),(a=Hn)?(a=Lv(a,Ks),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:qa!==null?{id:Mi,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},h=ay(a),h.return=l,l.child=h,Hr=l,Hn=null)):a=null,a===null)throw Xa(l);return l.lanes=536870912,null}return sh(l,y)}var k=a.memoizedState;if(k!==null){var D=k.dehydrated;if(V1(l),S)if(l.flags&256)l.flags&=-257,l=Ew(a,l,h);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(r(558));else if(yr||oc(a,l,h,!1),S=(h&a.childLanes)!==0,yr||S){if(y=In,y!==null&&(D=Xe(y,h),D!==0&&D!==k.retryLane))throw k.retryLane=D,rl(a,D),As(y,a,D),um;mh(),l=Ew(a,l,h)}else a=k.treeContext,Hn=Js(D.nextSibling),Hr=l,an=!0,$a=null,Ks=!1,a!==null&&cy(l,a),l=sh(l,y),l.flags|=4096;return l}return a=ea(a.child,{mode:y.mode,children:y.children}),a.ref=l.ref,l.child=a,a.return=l,a}function ih(a,l){var h=l.ref;if(h===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(l.flags|=4194816)}}function dm(a,l,h,y,S){return ol(l),h=W1(a,l,h,y,void 0,S),y=q1(),a!==null&&!yr?($1(a,l,S),aa(a,l,S)):(an&&y&&N1(l),l.flags|=1,Gr(a,l,h,S),l.child)}function Sw(a,l,h,y,S,k){return ol(l),l.updateQueue=null,h=ky(l,y,h,S),Ny(a),y=q1(),a!==null&&!yr?($1(a,l,k),aa(a,l,k)):(an&&y&&N1(l),l.flags|=1,Gr(a,l,h,k),l.child)}function Aw(a,l,h,y,S){if(ol(l),l.stateNode===null){var k=rc,D=h.contextType;typeof D=="object"&&D!==null&&(k=Vr(D)),k=new h(y,k),l.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=lm,l.stateNode=k,k._reactInternals=l,k=l.stateNode,k.props=y,k.state=l.memoizedState,k.refs={},B1(l),D=h.contextType,k.context=typeof D=="object"&&D!==null?Vr(D):rc,k.state=l.memoizedState,D=h.getDerivedStateFromProps,typeof D=="function"&&(om(l,h,D,y),k.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(D=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),D!==k.state&&lm.enqueueReplaceState(k,k.state,null),Du(l,y,k,S),Iu(),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308),y=!0}else if(a===null){k=l.stateNode;var z=l.memoizedProps,Q=hl(h,z);k.props=Q;var Ee=k.context,_e=h.contextType;D=rc,typeof _e=="object"&&_e!==null&&(D=Vr(_e));var Le=h.getDerivedStateFromProps;_e=typeof Le=="function"||typeof k.getSnapshotBeforeUpdate=="function",z=l.pendingProps!==z,_e||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(z||Ee!==D)&&dw(l,k,y,D),Ka=!1;var Se=l.memoizedState;k.state=Se,Du(l,y,k,S),Iu(),Ee=l.memoizedState,z||Se!==Ee||Ka?(typeof Le=="function"&&(om(l,h,Le,y),Ee=l.memoizedState),(Q=Ka||uw(l,h,Q,y,Se,Ee,D))?(_e||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(l.flags|=4194308)):(typeof k.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=y,l.memoizedState=Ee),k.props=y,k.state=Ee,k.context=D,y=Q):(typeof k.componentDidMount=="function"&&(l.flags|=4194308),y=!1)}else{k=l.stateNode,P1(a,l),D=l.memoizedProps,_e=hl(h,D),k.props=_e,Le=l.pendingProps,Se=k.context,Ee=h.contextType,Q=rc,typeof Ee=="object"&&Ee!==null&&(Q=Vr(Ee)),z=h.getDerivedStateFromProps,(Ee=typeof z=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(D!==Le||Se!==Q)&&dw(l,k,y,Q),Ka=!1,Se=l.memoizedState,k.state=Se,Du(l,y,k,S),Iu();var Te=l.memoizedState;D!==Le||Se!==Te||Ka||a!==null&&a.dependencies!==null&&zf(a.dependencies)?(typeof z=="function"&&(om(l,h,z,y),Te=l.memoizedState),(_e=Ka||uw(l,h,_e,y,Se,Te,Q)||a!==null&&a.dependencies!==null&&zf(a.dependencies))?(Ee||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(y,Te,Q),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(y,Te,Q)),typeof k.componentDidUpdate=="function"&&(l.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof k.componentDidUpdate!="function"||D===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||D===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),l.memoizedProps=y,l.memoizedState=Te),k.props=y,k.state=Te,k.context=Q,y=_e):(typeof k.componentDidUpdate!="function"||D===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||D===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),y=!1)}return k=y,ih(a,l),y=(l.flags&128)!==0,k||y?(k=l.stateNode,h=y&&typeof h.getDerivedStateFromError!="function"?null:k.render(),l.flags|=1,a!==null&&y?(l.child=dl(l,a.child,null,S),l.child=dl(l,null,h,S)):Gr(a,l,h,S),l.memoizedState=k.state,a=l.child):a=aa(a,l,S),a}function Nw(a,l,h,y){return il(),l.flags|=256,Gr(a,l,h,y),l.child}var fm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hm(a){return{baseLanes:a,cachePool:my()}}function pm(a,l,h){return a=a!==null?a.childLanes&~h:0,l&&(a|=Ps),a}function kw(a,l,h){var y=l.pendingProps,S=!1,k=(l.flags&128)!==0,D;if((D=k)||(D=a!==null&&a.memoizedState===null?!1:(hr.current&2)!==0),D&&(S=!0,l.flags&=-129),D=(l.flags&32)!==0,l.flags&=-33,a===null){if(an){if(S?Qa(l):eo(),(a=Hn)?(a=Lv(a,Ks),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:qa!==null?{id:Mi,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},h=ay(a),h.return=l,l.child=h,Hr=l,Hn=null)):a=null,a===null)throw Xa(l);return Km(a)?l.lanes=32:l.lanes=536870912,null}var z=y.children;return y=y.fallback,S?(eo(),S=l.mode,z=ah({mode:"hidden",children:z},S),y=sl(y,S,h,null),z.return=l,y.return=l,z.sibling=y,l.child=z,y=l.child,y.memoizedState=hm(h),y.childLanes=pm(a,D,h),l.memoizedState=fm,Fu(null,y)):(Qa(l),mm(l,z))}var Q=a.memoizedState;if(Q!==null&&(z=Q.dehydrated,z!==null)){if(k)l.flags&256?(Qa(l),l.flags&=-257,l=gm(a,l,h)):l.memoizedState!==null?(eo(),l.child=a.child,l.flags|=128,l=null):(eo(),z=y.fallback,S=l.mode,y=ah({mode:"visible",children:y.children},S),z=sl(z,S,h,null),z.flags|=2,y.return=l,z.return=l,y.sibling=z,l.child=y,dl(l,a.child,null,h),y=l.child,y.memoizedState=hm(h),y.childLanes=pm(a,D,h),l.memoizedState=fm,l=Fu(null,y));else if(Qa(l),Km(z)){if(D=z.nextSibling&&z.nextSibling.dataset,D)var Ee=D.dgst;D=Ee,y=Error(r(419)),y.stack="",y.digest=D,ku({value:y,source:null,stack:null}),l=gm(a,l,h)}else if(yr||oc(a,l,h,!1),D=(h&a.childLanes)!==0,yr||D){if(D=In,D!==null&&(y=Xe(D,h),y!==0&&y!==Q.retryLane))throw Q.retryLane=y,rl(a,y),As(D,a,y),um;Ym(z)||mh(),l=gm(a,l,h)}else Ym(z)?(l.flags|=192,l.child=a.child,l=null):(a=Q.treeContext,Hn=Js(z.nextSibling),Hr=l,an=!0,$a=null,Ks=!1,a!==null&&cy(l,a),l=mm(l,y.children),l.flags|=4096);return l}return S?(eo(),z=y.fallback,S=l.mode,Q=a.child,Ee=Q.sibling,y=ea(Q,{mode:"hidden",children:y.children}),y.subtreeFlags=Q.subtreeFlags&65011712,Ee!==null?z=ea(Ee,z):(z=sl(z,S,h,null),z.flags|=2),z.return=l,y.return=l,y.sibling=z,l.child=y,Fu(null,y),y=l.child,z=a.child.memoizedState,z===null?z=hm(h):(S=z.cachePool,S!==null?(Q=xr._currentValue,S=S.parent!==Q?{parent:Q,pool:Q}:S):S=my(),z={baseLanes:z.baseLanes|h,cachePool:S}),y.memoizedState=z,y.childLanes=pm(a,D,h),l.memoizedState=fm,Fu(a.child,y)):(Qa(l),h=a.child,a=h.sibling,h=ea(h,{mode:"visible",children:y.children}),h.return=l,h.sibling=null,a!==null&&(D=l.deletions,D===null?(l.deletions=[a],l.flags|=16):D.push(a)),l.child=h,l.memoizedState=null,h)}function mm(a,l){return l=ah({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function ah(a,l){return a=Ds(22,a,null,l),a.lanes=0,a}function gm(a,l,h){return dl(l,a.child,null,h),a=mm(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function Tw(a,l,h){a.lanes|=l;var y=a.alternate;y!==null&&(y.lanes|=l),R1(a.return,l,h)}function xm(a,l,h,y,S,k){var D=a.memoizedState;D===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:S,treeForkCount:k}:(D.isBackwards=l,D.rendering=null,D.renderingStartTime=0,D.last=y,D.tail=h,D.tailMode=S,D.treeForkCount=k)}function Ow(a,l,h){var y=l.pendingProps,S=y.revealOrder,k=y.tail;y=y.children;var D=hr.current,z=(D&2)!==0;if(z?(D=D&1|2,l.flags|=128):D&=1,fe(hr,D),Gr(a,l,y,h),y=an?Nu:0,!z&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Tw(a,h,l);else if(a.tag===19)Tw(a,h,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(S){case"forwards":for(h=l.child,S=null;h!==null;)a=h.alternate,a!==null&&Xf(a)===null&&(S=h),h=h.sibling;h=S,h===null?(S=l.child,l.child=null):(S=h.sibling,h.sibling=null),xm(l,!1,S,h,k,y);break;case"backwards":case"unstable_legacy-backwards":for(h=null,S=l.child,l.child=null;S!==null;){if(a=S.alternate,a!==null&&Xf(a)===null){l.child=S;break}a=S.sibling,S.sibling=h,h=S,S=a}xm(l,!0,h,null,k,y);break;case"together":xm(l,!1,null,null,void 0,y);break;default:l.memoizedState=null}return l.child}function aa(a,l,h){if(a!==null&&(l.dependencies=a.dependencies),ro|=l.lanes,(h&l.childLanes)===0)if(a!==null){if(oc(a,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,h=ea(a,a.pendingProps),l.child=h,h.return=l;a.sibling!==null;)a=a.sibling,h=h.sibling=ea(a,a.pendingProps),h.return=l;h.sibling=null}return l.child}function bm(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&zf(a)))}function J6(a,l,h){switch(l.tag){case 3:K(l,l.stateNode.containerInfo),Ya(l,xr,a.memoizedState.cache),il();break;case 27:case 5:Ae(l);break;case 4:K(l,l.stateNode.containerInfo);break;case 10:Ya(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,V1(l),null;break;case 13:var y=l.memoizedState;if(y!==null)return y.dehydrated!==null?(Qa(l),l.flags|=128,null):(h&l.child.childLanes)!==0?kw(a,l,h):(Qa(l),a=aa(a,l,h),a!==null?a.sibling:null);Qa(l);break;case 19:var S=(a.flags&128)!==0;if(y=(h&l.childLanes)!==0,y||(oc(a,l,h,!1),y=(h&l.childLanes)!==0),S){if(y)return Ow(a,l,h);l.flags|=128}if(S=l.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),fe(hr,hr.current),y)break;return null;case 22:return l.lanes=0,vw(a,l,h,l.pendingProps);case 24:Ya(l,xr,a.memoizedState.cache)}return aa(a,l,h)}function _w(a,l,h){if(a!==null)if(a.memoizedProps!==l.pendingProps)yr=!0;else{if(!bm(a,h)&&(l.flags&128)===0)return yr=!1,J6(a,l,h);yr=(a.flags&131072)!==0}else yr=!1,an&&(l.flags&1048576)!==0&&ly(l,Nu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var y=l.pendingProps;if(a=cl(l.elementType),l.type=a,typeof a=="function")E1(a)?(y=hl(a,y),l.tag=1,l=Aw(null,l,a,y,h)):(l.tag=0,l=dm(null,l,a,y,h));else{if(a!=null){var S=a.$$typeof;if(S===Z){l.tag=11,l=bw(null,l,a,y,h);break e}else if(S===U){l.tag=14,l=yw(null,l,a,y,h);break e}}throw l=Ze(a)||a,Error(r(306,l,""))}}return l;case 0:return dm(a,l,l.type,l.pendingProps,h);case 1:return y=l.type,S=hl(y,l.pendingProps),Aw(a,l,y,S,h);case 3:e:{if(K(l,l.stateNode.containerInfo),a===null)throw Error(r(387));y=l.pendingProps;var k=l.memoizedState;S=k.element,P1(a,l),Du(l,y,null,h);var D=l.memoizedState;if(y=D.cache,Ya(l,xr,y),y!==k.cache&&M1(l,[xr],h,!0),Iu(),y=D.element,k.isDehydrated)if(k={element:y,isDehydrated:!1,cache:D.cache},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){l=Nw(a,l,y,h);break e}else if(y!==S){S=$s(Error(r(424)),l),ku(S),l=Nw(a,l,y,h);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Hn=Js(a.firstChild),Hr=l,an=!0,$a=null,Ks=!0,h=vy(l,null,y,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(il(),y===S){l=aa(a,l,h);break e}Gr(a,l,y,h)}l=l.child}return l;case 26:return ih(a,l),a===null?(h=Uv(l.type,null,l.pendingProps,null))?l.memoizedState=h:an||(h=l.type,a=l.pendingProps,y=Ch(se.current).createElement(h),y[qt]=l,y[_t]=a,Wr(y,h,a),Kn(y),l.stateNode=y):l.memoizedState=Uv(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return Ae(l),a===null&&an&&(y=l.stateNode=Pv(l.type,l.pendingProps,se.current),Hr=l,Ks=!0,S=Hn,lo(l.type)?(Zm=S,Hn=Js(y.firstChild)):Hn=S),Gr(a,l,l.pendingProps.children,h),ih(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&an&&((S=y=Hn)&&(y=T5(y,l.type,l.pendingProps,Ks),y!==null?(l.stateNode=y,Hr=l,Hn=Js(y.firstChild),Ks=!1,S=!0):S=!1),S||Xa(l)),Ae(l),S=l.type,k=l.pendingProps,D=a!==null?a.memoizedProps:null,y=k.children,qm(S,k)?y=null:D!==null&&qm(S,D)&&(l.flags|=32),l.memoizedState!==null&&(S=W1(a,l,V6,null,null,h),ed._currentValue=S),ih(a,l),Gr(a,l,y,h),l.child;case 6:return a===null&&an&&((a=h=Hn)&&(h=O5(h,l.pendingProps,Ks),h!==null?(l.stateNode=h,Hr=l,Hn=null,a=!0):a=!1),a||Xa(l)),null;case 13:return kw(a,l,h);case 4:return K(l,l.stateNode.containerInfo),y=l.pendingProps,a===null?l.child=dl(l,null,y,h):Gr(a,l,y,h),l.child;case 11:return bw(a,l,l.type,l.pendingProps,h);case 7:return Gr(a,l,l.pendingProps,h),l.child;case 8:return Gr(a,l,l.pendingProps.children,h),l.child;case 12:return Gr(a,l,l.pendingProps.children,h),l.child;case 10:return y=l.pendingProps,Ya(l,l.type,y.value),Gr(a,l,y.children,h),l.child;case 9:return S=l.type._context,y=l.pendingProps.children,ol(l),S=Vr(S),y=y(S),l.flags|=1,Gr(a,l,y,h),l.child;case 14:return yw(a,l,l.type,l.pendingProps,h);case 15:return ww(a,l,l.type,l.pendingProps,h);case 19:return Ow(a,l,h);case 31:return Z6(a,l,h);case 22:return vw(a,l,h,l.pendingProps);case 24:return ol(l),y=Vr(xr),a===null?(S=L1(),S===null&&(S=In,k=I1(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=h),S=k),l.memoizedState={parent:y,cache:S},B1(l),Ya(l,xr,S)):((a.lanes&h)!==0&&(P1(a,l),Du(l,null,null,h),Iu()),S=a.memoizedState,k=l.memoizedState,S.parent!==y?(S={parent:y,cache:y},l.memoizedState=S,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=S),Ya(l,xr,y)):(y=k.cache,Ya(l,xr,y),y!==S.cache&&M1(l,[xr],h,!0))),Gr(a,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function oa(a){a.flags|=4}function ym(a,l,h,y,S){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(S&335544128)===S)if(a.stateNode.complete)a.flags|=8192;else if(rv())a.flags|=8192;else throw ul=Gf,j1}else a.flags&=-16777217}function Rw(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!qv(l))if(rv())a.flags|=8192;else throw ul=Gf,j1}function oh(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?de():536870912,a.lanes|=l,yc|=l)}function zu(a,l){if(!an)switch(a.tailMode){case"hidden":l=a.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Vn(a){var l=a.alternate!==null&&a.alternate.child===a.child,h=0,y=0;if(l)for(var S=a.child;S!==null;)h|=S.lanes|S.childLanes,y|=S.subtreeFlags&65011712,y|=S.flags&65011712,S.return=a,S=S.sibling;else for(S=a.child;S!==null;)h|=S.lanes|S.childLanes,y|=S.subtreeFlags,y|=S.flags,S.return=a,S=S.sibling;return a.subtreeFlags|=y,a.childLanes=h,l}function Q6(a,l,h){var y=l.pendingProps;switch(k1(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(l),null;case 1:return Vn(l),null;case 3:return h=l.stateNode,y=null,a!==null&&(y=a.memoizedState.cache),l.memoizedState.cache!==y&&(l.flags|=2048),ra(xr),Ce(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(ac(l)?oa(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,O1())),Vn(l),null;case 26:var S=l.type,k=l.memoizedState;return a===null?(oa(l),k!==null?(Vn(l),Rw(l,k)):(Vn(l),ym(l,S,null,y,h))):k?k!==a.memoizedState?(oa(l),Vn(l),Rw(l,k)):(Vn(l),l.flags&=-16777217):(a=a.memoizedProps,a!==y&&oa(l),Vn(l),ym(l,S,a,y,h)),null;case 27:if(ze(l),h=se.current,S=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==y&&oa(l);else{if(!y){if(l.stateNode===null)throw Error(r(166));return Vn(l),null}a=ge.current,ac(l)?uy(l):(a=Pv(S,y,h),l.stateNode=a,oa(l))}return Vn(l),null;case 5:if(ze(l),S=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==y&&oa(l);else{if(!y){if(l.stateNode===null)throw Error(r(166));return Vn(l),null}if(k=ge.current,ac(l))uy(l);else{var D=Ch(se.current);switch(k){case 1:k=D.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:k=D.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":k=D.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":k=D.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":k=D.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof y.is=="string"?D.createElement("select",{is:y.is}):D.createElement("select"),y.multiple?k.multiple=!0:y.size&&(k.size=y.size);break;default:k=typeof y.is=="string"?D.createElement(S,{is:y.is}):D.createElement(S)}}k[qt]=l,k[_t]=y;e:for(D=l.child;D!==null;){if(D.tag===5||D.tag===6)k.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===l)break e;for(;D.sibling===null;){if(D.return===null||D.return===l)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}l.stateNode=k;e:switch(Wr(k,S,y),S){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&oa(l)}}return Vn(l),ym(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,h),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==y&&oa(l);else{if(typeof y!="string"&&l.stateNode===null)throw Error(r(166));if(a=se.current,ac(l)){if(a=l.stateNode,h=l.memoizedProps,y=null,S=Hr,S!==null)switch(S.tag){case 27:case 5:y=S.memoizedProps}a[qt]=l,a=!!(a.nodeValue===h||y!==null&&y.suppressHydrationWarning===!0||kv(a.nodeValue,h)),a||Xa(l,!0)}else a=Ch(a).createTextNode(y),a[qt]=l,l.stateNode=a}return Vn(l),null;case 31:if(h=l.memoizedState,a===null||a.memoizedState!==null){if(y=ac(l),h!==null){if(a===null){if(!y)throw Error(r(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[qt]=l}else il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Vn(l),a=!1}else h=O1(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return l.flags&256?(js(l),l):(js(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Vn(l),null;case 13:if(y=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(S=ac(l),y!==null&&y.dehydrated!==null){if(a===null){if(!S)throw Error(r(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[qt]=l}else il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Vn(l),S=!1}else S=O1(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=S),S=!0;if(!S)return l.flags&256?(js(l),l):(js(l),null)}return js(l),(l.flags&128)!==0?(l.lanes=h,l):(h=y!==null,a=a!==null&&a.memoizedState!==null,h&&(y=l.child,S=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(S=y.alternate.memoizedState.cachePool.pool),k=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(k=y.memoizedState.cachePool.pool),k!==S&&(y.flags|=2048)),h!==a&&h&&(l.child.flags|=8192),oh(l,l.updateQueue),Vn(l),null);case 4:return Ce(),a===null&&Um(l.stateNode.containerInfo),Vn(l),null;case 10:return ra(l.type),Vn(l),null;case 19:if(te(hr),y=l.memoizedState,y===null)return Vn(l),null;if(S=(l.flags&128)!==0,k=y.rendering,k===null)if(S)zu(y,!1);else{if(ir!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(k=Xf(a),k!==null){for(l.flags|=128,zu(y,!1),a=k.updateQueue,l.updateQueue=a,oh(l,a),l.subtreeFlags=0,a=h,h=l.child;h!==null;)iy(h,a),h=h.sibling;return fe(hr,hr.current&1|2),an&&ta(l,y.treeForkCount),l.child}a=a.sibling}y.tail!==null&&on()>fh&&(l.flags|=128,S=!0,zu(y,!1),l.lanes=4194304)}else{if(!S)if(a=Xf(k),a!==null){if(l.flags|=128,S=!0,a=a.updateQueue,l.updateQueue=a,oh(l,a),zu(y,!0),y.tail===null&&y.tailMode==="hidden"&&!k.alternate&&!an)return Vn(l),null}else 2*on()-y.renderingStartTime>fh&&h!==536870912&&(l.flags|=128,S=!0,zu(y,!1),l.lanes=4194304);y.isBackwards?(k.sibling=l.child,l.child=k):(a=y.last,a!==null?a.sibling=k:l.child=k,y.last=k)}return y.tail!==null?(a=y.tail,y.rendering=a,y.tail=a.sibling,y.renderingStartTime=on(),a.sibling=null,h=hr.current,fe(hr,S?h&1|2:h&1),an&&ta(l,y.treeForkCount),a):(Vn(l),null);case 22:case 23:return js(l),H1(),y=l.memoizedState!==null,a!==null?a.memoizedState!==null!==y&&(l.flags|=8192):y&&(l.flags|=8192),y?(h&536870912)!==0&&(l.flags&128)===0&&(Vn(l),l.subtreeFlags&6&&(l.flags|=8192)):Vn(l),h=l.updateQueue,h!==null&&oh(l,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),y=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(y=l.memoizedState.cachePool.pool),y!==h&&(l.flags|=2048),a!==null&&te(ll),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),ra(xr),Vn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function e5(a,l){switch(k1(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return ra(xr),Ce(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return ze(l),null;case 31:if(l.memoizedState!==null){if(js(l),l.alternate===null)throw Error(r(340));il()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(js(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));il()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return te(hr),null;case 4:return Ce(),null;case 10:return ra(l.type),null;case 22:case 23:return js(l),H1(),a!==null&&te(ll),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return ra(xr),null;case 25:return null;default:return null}}function Mw(a,l){switch(k1(l),l.tag){case 3:ra(xr),Ce();break;case 26:case 27:case 5:ze(l);break;case 4:Ce();break;case 31:l.memoizedState!==null&&js(l);break;case 13:js(l);break;case 19:te(hr);break;case 10:ra(l.type);break;case 22:case 23:js(l),H1(),a!==null&&te(ll);break;case 24:ra(xr)}}function Uu(a,l){try{var h=l.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var S=y.next;h=S;do{if((h.tag&a)===a){y=void 0;var k=h.create,D=h.inst;y=k(),D.destroy=y}h=h.next}while(h!==S)}}catch(z){Sn(l,l.return,z)}}function to(a,l,h){try{var y=l.updateQueue,S=y!==null?y.lastEffect:null;if(S!==null){var k=S.next;y=k;do{if((y.tag&a)===a){var D=y.inst,z=D.destroy;if(z!==void 0){D.destroy=void 0,S=l;var Q=h,Ee=z;try{Ee()}catch(_e){Sn(S,Q,_e)}}}y=y.next}while(y!==k)}}catch(_e){Sn(l,l.return,_e)}}function Iw(a){var l=a.updateQueue;if(l!==null){var h=a.stateNode;try{Ey(l,h)}catch(y){Sn(a,a.return,y)}}}function Dw(a,l,h){h.props=hl(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(y){Sn(a,l,y)}}function Hu(a,l){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var y=a.stateNode;break;case 30:y=a.stateNode;break;default:y=a.stateNode}typeof h=="function"?a.refCleanup=h(y):h.current=y}}catch(S){Sn(a,l,S)}}function Di(a,l){var h=a.ref,y=a.refCleanup;if(h!==null)if(typeof y=="function")try{y()}catch(S){Sn(a,l,S)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(S){Sn(a,l,S)}else h.current=null}function Lw(a){var l=a.type,h=a.memoizedProps,y=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&y.focus();break e;case"img":h.src?y.src=h.src:h.srcSet&&(y.srcset=h.srcSet)}}catch(S){Sn(a,a.return,S)}}function wm(a,l,h){try{var y=a.stateNode;C5(y,a.type,h,l),y[_t]=l}catch(S){Sn(a,a.return,S)}}function jw(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&lo(a.type)||a.tag===4}function vm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||jw(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&lo(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Cm(a,l,h){var y=a.tag;if(y===5||y===6)a=a.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(a),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=bs));else if(y!==4&&(y===27&&lo(a.type)&&(h=a.stateNode,l=null),a=a.child,a!==null))for(Cm(a,l,h),a=a.sibling;a!==null;)Cm(a,l,h),a=a.sibling}function lh(a,l,h){var y=a.tag;if(y===5||y===6)a=a.stateNode,l?h.insertBefore(a,l):h.appendChild(a);else if(y!==4&&(y===27&&lo(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(lh(a,l,h),a=a.sibling;a!==null;)lh(a,l,h),a=a.sibling}function Bw(a){var l=a.stateNode,h=a.memoizedProps;try{for(var y=a.type,S=l.attributes;S.length;)l.removeAttributeNode(S[0]);Wr(l,y,h),l[qt]=a,l[_t]=h}catch(k){Sn(a,a.return,k)}}var la=!1,wr=!1,Em=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,Or=null;function t5(a,l){if(a=a.containerInfo,Gm=Oh,a=P(a),F(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var y=h.getSelection&&h.getSelection();if(y&&y.rangeCount!==0){h=y.anchorNode;var S=y.anchorOffset,k=y.focusNode;y=y.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var D=0,z=-1,Q=-1,Ee=0,_e=0,Le=a,Se=null;t:for(;;){for(var Te;Le!==h||S!==0&&Le.nodeType!==3||(z=D+S),Le!==k||y!==0&&Le.nodeType!==3||(Q=D+y),Le.nodeType===3&&(D+=Le.nodeValue.length),(Te=Le.firstChild)!==null;)Se=Le,Le=Te;for(;;){if(Le===a)break t;if(Se===h&&++Ee===S&&(z=D),Se===k&&++_e===y&&(Q=D),(Te=Le.nextSibling)!==null)break;Le=Se,Se=Le.parentNode}Le=Te}h=z===-1||Q===-1?null:{start:z,end:Q}}else h=null}h=h||{start:0,end:0}}else h=null;for(Wm={focusedElem:a,selectionRange:h},Oh=!1,Or=l;Or!==null;)if(l=Or,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Or=a;else for(;Or!==null;){switch(l=Or,k=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)S=a[h],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&k!==null){a=void 0,h=l,S=k.memoizedProps,k=k.memoizedState,y=h.stateNode;try{var dt=hl(h.type,S);a=y.getSnapshotBeforeUpdate(dt,k),y.__reactInternalSnapshotBeforeUpdate=a}catch(Nt){Sn(h,h.return,Nt)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,h=a.nodeType,h===9)Xm(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Xm(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=l.sibling,a!==null){a.return=l.return,Or=a;break}Or=l.return}}function Fw(a,l,h){var y=h.flags;switch(h.tag){case 0:case 11:case 15:ua(a,h),y&4&&Uu(5,h);break;case 1:if(ua(a,h),y&4)if(a=h.stateNode,l===null)try{a.componentDidMount()}catch(D){Sn(h,h.return,D)}else{var S=hl(h.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(S,l,a.__reactInternalSnapshotBeforeUpdate)}catch(D){Sn(h,h.return,D)}}y&64&&Iw(h),y&512&&Hu(h,h.return);break;case 3:if(ua(a,h),y&64&&(a=h.updateQueue,a!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{Ey(a,l)}catch(D){Sn(h,h.return,D)}}break;case 27:l===null&&y&4&&Bw(h);case 26:case 5:ua(a,h),l===null&&y&4&&Lw(h),y&512&&Hu(h,h.return);break;case 12:ua(a,h);break;case 31:ua(a,h),y&4&&Hw(a,h);break;case 13:ua(a,h),y&4&&Vw(a,h),y&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=u5.bind(null,h),_5(a,h))));break;case 22:if(y=h.memoizedState!==null||la,!y){l=l!==null&&l.memoizedState!==null||wr,S=la;var k=wr;la=y,(wr=l)&&!k?da(a,h,(h.subtreeFlags&8772)!==0):ua(a,h),la=S,wr=k}break;case 30:break;default:ua(a,h)}}function zw(a){var l=a.alternate;l!==null&&(a.alternate=null,zw(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&Zr(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Jn=null,vs=!1;function ca(a,l,h){for(h=h.child;h!==null;)Uw(a,l,h),h=h.sibling}function Uw(a,l,h){if(He&&typeof He.onCommitFiberUnmount=="function")try{He.onCommitFiberUnmount(ln,h)}catch{}switch(h.tag){case 26:wr||Di(h,l),ca(a,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:wr||Di(h,l);var y=Jn,S=vs;lo(h.type)&&(Jn=h.stateNode,vs=!1),ca(a,l,h),Zu(h.stateNode),Jn=y,vs=S;break;case 5:wr||Di(h,l);case 6:if(y=Jn,S=vs,Jn=null,ca(a,l,h),Jn=y,vs=S,Jn!==null)if(vs)try{(Jn.nodeType===9?Jn.body:Jn.nodeName==="HTML"?Jn.ownerDocument.body:Jn).removeChild(h.stateNode)}catch(k){Sn(h,l,k)}else try{Jn.removeChild(h.stateNode)}catch(k){Sn(h,l,k)}break;case 18:Jn!==null&&(vs?(a=Jn,Iv(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),kc(a)):Iv(Jn,h.stateNode));break;case 4:y=Jn,S=vs,Jn=h.stateNode.containerInfo,vs=!0,ca(a,l,h),Jn=y,vs=S;break;case 0:case 11:case 14:case 15:to(2,h,l),wr||to(4,h,l),ca(a,l,h);break;case 1:wr||(Di(h,l),y=h.stateNode,typeof y.componentWillUnmount=="function"&&Dw(h,l,y)),ca(a,l,h);break;case 21:ca(a,l,h);break;case 22:wr=(y=wr)||h.memoizedState!==null,ca(a,l,h),wr=y;break;default:ca(a,l,h)}}function Hw(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{kc(a)}catch(h){Sn(l,l.return,h)}}}function Vw(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{kc(a)}catch(h){Sn(l,l.return,h)}}function n5(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new Pw),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new Pw),l;default:throw Error(r(435,a.tag))}}function ch(a,l){var h=n5(a);l.forEach(function(y){if(!h.has(y)){h.add(y);var S=d5.bind(null,a,y);y.then(S,S)}})}function Cs(a,l){var h=l.deletions;if(h!==null)for(var y=0;y<h.length;y++){var S=h[y],k=a,D=l,z=D;e:for(;z!==null;){switch(z.tag){case 27:if(lo(z.type)){Jn=z.stateNode,vs=!1;break e}break;case 5:Jn=z.stateNode,vs=!1;break e;case 3:case 4:Jn=z.stateNode.containerInfo,vs=!0;break e}z=z.return}if(Jn===null)throw Error(r(160));Uw(k,D,S),Jn=null,vs=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Gw(l,a),l=l.sibling}var fi=null;function Gw(a,l){var h=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Cs(l,a),Es(a),y&4&&(to(3,a,a.return),Uu(3,a),to(5,a,a.return));break;case 1:Cs(l,a),Es(a),y&512&&(wr||h===null||Di(h,h.return)),y&64&&la&&(a=a.updateQueue,a!==null&&(y=a.callbacks,y!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?y:h.concat(y))));break;case 26:var S=fi;if(Cs(l,a),Es(a),y&512&&(wr||h===null||Di(h,h.return)),y&4){var k=h!==null?h.memoizedState:null;if(y=a.memoizedState,h===null)if(y===null)if(a.stateNode===null){e:{y=a.type,h=a.memoizedProps,S=S.ownerDocument||S;t:switch(y){case"title":k=S.getElementsByTagName("title")[0],(!k||k[Ai]||k[qt]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(y),S.head.insertBefore(k,S.querySelector("head > title"))),Wr(k,y,h),k[qt]=a,Kn(k),y=k;break e;case"link":var D=Gv("link","href",S).get(y+(h.href||""));if(D){for(var z=0;z<D.length;z++)if(k=D[z],k.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&k.getAttribute("rel")===(h.rel==null?null:h.rel)&&k.getAttribute("title")===(h.title==null?null:h.title)&&k.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){D.splice(z,1);break t}}k=S.createElement(y),Wr(k,y,h),S.head.appendChild(k);break;case"meta":if(D=Gv("meta","content",S).get(y+(h.content||""))){for(z=0;z<D.length;z++)if(k=D[z],k.getAttribute("content")===(h.content==null?null:""+h.content)&&k.getAttribute("name")===(h.name==null?null:h.name)&&k.getAttribute("property")===(h.property==null?null:h.property)&&k.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&k.getAttribute("charset")===(h.charSet==null?null:h.charSet)){D.splice(z,1);break t}}k=S.createElement(y),Wr(k,y,h),S.head.appendChild(k);break;default:throw Error(r(468,y))}k[qt]=a,Kn(k),y=k}a.stateNode=y}else Wv(S,a.type,a.stateNode);else a.stateNode=Vv(S,y,a.memoizedProps);else k!==y?(k===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):k.count--,y===null?Wv(S,a.type,a.stateNode):Vv(S,y,a.memoizedProps)):y===null&&a.stateNode!==null&&wm(a,a.memoizedProps,h.memoizedProps)}break;case 27:Cs(l,a),Es(a),y&512&&(wr||h===null||Di(h,h.return)),h!==null&&y&4&&wm(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Cs(l,a),Es(a),y&512&&(wr||h===null||Di(h,h.return)),a.flags&32){S=a.stateNode;try{Ba(S,"")}catch(dt){Sn(a,a.return,dt)}}y&4&&a.stateNode!=null&&(S=a.memoizedProps,wm(a,S,h!==null?h.memoizedProps:S)),y&1024&&(Em=!0);break;case 6:if(Cs(l,a),Es(a),y&4){if(a.stateNode===null)throw Error(r(162));y=a.memoizedProps,h=a.stateNode;try{h.nodeValue=y}catch(dt){Sn(a,a.return,dt)}}break;case 3:if(Ah=null,S=fi,fi=Eh(l.containerInfo),Cs(l,a),fi=S,Es(a),y&4&&h!==null&&h.memoizedState.isDehydrated)try{kc(l.containerInfo)}catch(dt){Sn(a,a.return,dt)}Em&&(Em=!1,Ww(a));break;case 4:y=fi,fi=Eh(a.stateNode.containerInfo),Cs(l,a),Es(a),fi=y;break;case 12:Cs(l,a),Es(a);break;case 31:Cs(l,a),Es(a),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,ch(a,y)));break;case 13:Cs(l,a),Es(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(dh=on()),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,ch(a,y)));break;case 22:S=a.memoizedState!==null;var Q=h!==null&&h.memoizedState!==null,Ee=la,_e=wr;if(la=Ee||S,wr=_e||Q,Cs(l,a),wr=_e,la=Ee,Es(a),y&8192)e:for(l=a.stateNode,l._visibility=S?l._visibility&-2:l._visibility|1,S&&(h===null||Q||la||wr||pl(a)),h=null,l=a;;){if(l.tag===5||l.tag===26){if(h===null){Q=h=l;try{if(k=Q.stateNode,S)D=k.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{z=Q.stateNode;var Le=Q.memoizedProps.style,Se=Le!=null&&Le.hasOwnProperty("display")?Le.display:null;z.style.display=Se==null||typeof Se=="boolean"?"":(""+Se).trim()}}catch(dt){Sn(Q,Q.return,dt)}}}else if(l.tag===6){if(h===null){Q=l;try{Q.stateNode.nodeValue=S?"":Q.memoizedProps}catch(dt){Sn(Q,Q.return,dt)}}}else if(l.tag===18){if(h===null){Q=l;try{var Te=Q.stateNode;S?Dv(Te,!0):Dv(Q.stateNode,!1)}catch(dt){Sn(Q,Q.return,dt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}y&4&&(y=a.updateQueue,y!==null&&(h=y.retryQueue,h!==null&&(y.retryQueue=null,ch(a,h))));break;case 19:Cs(l,a),Es(a),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,ch(a,y)));break;case 30:break;case 21:break;default:Cs(l,a),Es(a)}}function Es(a){var l=a.flags;if(l&2){try{for(var h,y=a.return;y!==null;){if(jw(y)){h=y;break}y=y.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var S=h.stateNode,k=vm(a);lh(a,k,S);break;case 5:var D=h.stateNode;h.flags&32&&(Ba(D,""),h.flags&=-33);var z=vm(a);lh(a,z,D);break;case 3:case 4:var Q=h.stateNode.containerInfo,Ee=vm(a);Cm(a,Ee,Q);break;default:throw Error(r(161))}}catch(_e){Sn(a,a.return,_e)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function Ww(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;Ww(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function ua(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Fw(a,l.alternate,l),l=l.sibling}function pl(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:to(4,l,l.return),pl(l);break;case 1:Di(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&Dw(l,l.return,h),pl(l);break;case 27:Zu(l.stateNode);case 26:case 5:Di(l,l.return),pl(l);break;case 22:l.memoizedState===null&&pl(l);break;case 30:pl(l);break;default:pl(l)}a=a.sibling}}function da(a,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var y=l.alternate,S=a,k=l,D=k.flags;switch(k.tag){case 0:case 11:case 15:da(S,k,h),Uu(4,k);break;case 1:if(da(S,k,h),y=k,S=y.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ee){Sn(y,y.return,Ee)}if(y=k,S=y.updateQueue,S!==null){var z=y.stateNode;try{var Q=S.shared.hiddenCallbacks;if(Q!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Q.length;S++)Cy(Q[S],z)}catch(Ee){Sn(y,y.return,Ee)}}h&&D&64&&Iw(k),Hu(k,k.return);break;case 27:Bw(k);case 26:case 5:da(S,k,h),h&&y===null&&D&4&&Lw(k),Hu(k,k.return);break;case 12:da(S,k,h);break;case 31:da(S,k,h),h&&D&4&&Hw(S,k);break;case 13:da(S,k,h),h&&D&4&&Vw(S,k);break;case 22:k.memoizedState===null&&da(S,k,h),Hu(k,k.return);break;case 30:break;default:da(S,k,h)}l=l.sibling}}function Sm(a,l){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&Tu(h))}function Am(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Tu(a))}function hi(a,l,h,y){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)qw(a,l,h,y),l=l.sibling}function qw(a,l,h,y){var S=l.flags;switch(l.tag){case 0:case 11:case 15:hi(a,l,h,y),S&2048&&Uu(9,l);break;case 1:hi(a,l,h,y);break;case 3:hi(a,l,h,y),S&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Tu(a)));break;case 12:if(S&2048){hi(a,l,h,y),a=l.stateNode;try{var k=l.memoizedProps,D=k.id,z=k.onPostCommit;typeof z=="function"&&z(D,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Q){Sn(l,l.return,Q)}}else hi(a,l,h,y);break;case 31:hi(a,l,h,y);break;case 13:hi(a,l,h,y);break;case 23:break;case 22:k=l.stateNode,D=l.alternate,l.memoizedState!==null?k._visibility&2?hi(a,l,h,y):Vu(a,l):k._visibility&2?hi(a,l,h,y):(k._visibility|=2,gc(a,l,h,y,(l.subtreeFlags&10256)!==0||!1)),S&2048&&Sm(D,l);break;case 24:hi(a,l,h,y),S&2048&&Am(l.alternate,l);break;default:hi(a,l,h,y)}}function gc(a,l,h,y,S){for(S=S&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var k=a,D=l,z=h,Q=y,Ee=D.flags;switch(D.tag){case 0:case 11:case 15:gc(k,D,z,Q,S),Uu(8,D);break;case 23:break;case 22:var _e=D.stateNode;D.memoizedState!==null?_e._visibility&2?gc(k,D,z,Q,S):Vu(k,D):(_e._visibility|=2,gc(k,D,z,Q,S)),S&&Ee&2048&&Sm(D.alternate,D);break;case 24:gc(k,D,z,Q,S),S&&Ee&2048&&Am(D.alternate,D);break;default:gc(k,D,z,Q,S)}l=l.sibling}}function Vu(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=a,y=l,S=y.flags;switch(y.tag){case 22:Vu(h,y),S&2048&&Sm(y.alternate,y);break;case 24:Vu(h,y),S&2048&&Am(y.alternate,y);break;default:Vu(h,y)}l=l.sibling}}var Gu=8192;function xc(a,l,h){if(a.subtreeFlags&Gu)for(a=a.child;a!==null;)$w(a,l,h),a=a.sibling}function $w(a,l,h){switch(a.tag){case 26:xc(a,l,h),a.flags&Gu&&a.memoizedState!==null&&H5(h,fi,a.memoizedState,a.memoizedProps);break;case 5:xc(a,l,h);break;case 3:case 4:var y=fi;fi=Eh(a.stateNode.containerInfo),xc(a,l,h),fi=y;break;case 22:a.memoizedState===null&&(y=a.alternate,y!==null&&y.memoizedState!==null?(y=Gu,Gu=16777216,xc(a,l,h),Gu=y):xc(a,l,h));break;default:xc(a,l,h)}}function Xw(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function Wu(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var y=l[h];Or=y,Kw(y,a)}Xw(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Yw(a),a=a.sibling}function Yw(a){switch(a.tag){case 0:case 11:case 15:Wu(a),a.flags&2048&&to(9,a,a.return);break;case 3:Wu(a);break;case 12:Wu(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,uh(a)):Wu(a);break;default:Wu(a)}}function uh(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var y=l[h];Or=y,Kw(y,a)}Xw(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:to(8,l,l.return),uh(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,uh(l));break;default:uh(l)}a=a.sibling}}function Kw(a,l){for(;Or!==null;){var h=Or;switch(h.tag){case 0:case 11:case 15:to(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var y=h.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:Tu(h.memoizedState.cache)}if(y=h.child,y!==null)y.return=h,Or=y;else e:for(h=a;Or!==null;){y=Or;var S=y.sibling,k=y.return;if(zw(y),y===h){Or=null;break e}if(S!==null){S.return=k,Or=S;break e}Or=k}}}var r5={getCacheForType:function(a){var l=Vr(xr),h=l.data.get(a);return h===void 0&&(h=a(),l.data.set(a,h)),h},cacheSignal:function(){return Vr(xr).controller.signal}},s5=typeof WeakMap=="function"?WeakMap:Map,gn=0,In=null,Xt=null,nn=0,En=0,Bs=null,no=!1,bc=!1,Nm=!1,fa=0,ir=0,ro=0,ml=0,km=0,Ps=0,yc=0,qu=null,Ss=null,Tm=!1,dh=0,Zw=0,fh=1/0,hh=null,so=null,Nr=0,io=null,wc=null,ha=0,Om=0,_m=null,Jw=null,$u=0,Rm=null;function Fs(){return(gn&2)!==0&&nn!==0?nn&-nn:ie.T!==null?Bm():yt()}function Qw(){if(Ps===0)if((nn&536870912)===0||an){var a=Dt;Dt<<=1,(Dt&3932160)===0&&(Dt=262144),Ps=a}else Ps=536870912;return a=Ls.current,a!==null&&(a.flags|=32),Ps}function As(a,l,h){(a===In&&(En===2||En===9)||a.cancelPendingCommit!==null)&&(vc(a,0),ao(a,nn,Ps,!1)),Oe(a,h),((gn&2)===0||a!==In)&&(a===In&&((gn&2)===0&&(ml|=h),ir===4&&ao(a,nn,Ps,!1)),Li(a))}function ev(a,l,h){if((gn&6)!==0)throw Error(r(327));var y=!h&&(l&127)===0&&(l&a.expiredLanes)===0||Jt(a,l),S=y?o5(a,l):Im(a,l,!0),k=y;do{if(S===0){bc&&!y&&ao(a,l,0,!1);break}else{if(h=a.current.alternate,k&&!i5(h)){S=Im(a,l,!1),k=!1;continue}if(S===2){if(k=l,a.errorRecoveryDisabledLanes&k)var D=0;else D=a.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){l=D;e:{var z=a;S=qu;var Q=z.current.memoizedState.isDehydrated;if(Q&&(vc(z,D).flags|=256),D=Im(z,D,!1),D!==2){if(Nm&&!Q){z.errorRecoveryDisabledLanes|=k,ml|=k,S=4;break e}k=Ss,Ss=S,k!==null&&(Ss===null?Ss=k:Ss.push.apply(Ss,k))}S=D}if(k=!1,S!==2)continue}}if(S===1){vc(a,0),ao(a,l,0,!0);break}e:{switch(y=a,k=S,k){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:ao(y,l,Ps,!no);break e;case 2:Ss=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(S=dh+300-on(),10<S)){if(ao(y,l,Ps,!no),Bn(y,0,!0)!==0)break e;ha=l,y.timeoutHandle=Rv(tv.bind(null,y,h,Ss,hh,Tm,l,Ps,ml,yc,no,k,"Throttled",-0,0),S);break e}tv(y,h,Ss,hh,Tm,l,Ps,ml,yc,no,k,null,-0,0)}}break}while(!0);Li(a)}function tv(a,l,h,y,S,k,D,z,Q,Ee,_e,Le,Se,Te){if(a.timeoutHandle=-1,Le=l.subtreeFlags,Le&8192||(Le&16785408)===16785408){Le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:bs},$w(l,k,Le);var dt=(k&62914560)===k?dh-on():(k&4194048)===k?Zw-on():0;if(dt=V5(Le,dt),dt!==null){ha=k,a.cancelPendingCommit=dt(cv.bind(null,a,l,k,h,y,S,D,z,Q,_e,Le,null,Se,Te)),ao(a,k,D,!Ee);return}}cv(a,l,k,h,y,S,D,z,Q)}function i5(a){for(var l=a;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var y=0;y<h.length;y++){var S=h[y],k=S.getSnapshot;S=S.value;try{if(!w(k(),S))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ao(a,l,h,y){l&=~km,l&=~ml,a.suspendedLanes|=l,a.pingedLanes&=~l,y&&(a.warmLanes|=l),y=a.expirationTimes;for(var S=l;0<S;){var k=31-At(S),D=1<<k;y[k]=-1,S&=~D}h!==0&&it(a,h,l)}function ph(){return(gn&6)===0?(Xu(0),!1):!0}function Mm(){if(Xt!==null){if(En===0)var a=Xt.return;else a=Xt,na=al=null,X1(a),dc=null,_u=0,a=Xt;for(;a!==null;)Mw(a.alternate,a),a=a.return;Xt=null}}function vc(a,l){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,A5(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),ha=0,Mm(),In=a,Xt=h=ea(a.current,null),nn=l,En=0,Bs=null,no=!1,bc=Jt(a,l),Nm=!1,yc=Ps=km=ml=ro=ir=0,Ss=qu=null,Tm=!1,(l&8)!==0&&(l|=l&32);var y=a.entangledLanes;if(y!==0)for(a=a.entanglements,y&=l;0<y;){var S=31-At(y),k=1<<S;l|=a[S],y&=~k}return fa=l,Lf(),h}function nv(a,l){Ft=null,ie.H=Pu,l===uc||l===Vf?(l=by(),En=3):l===j1?(l=by(),En=4):En=l===um?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Bs=l,Xt===null&&(ir=1,rh(a,$s(l,a.current)))}function rv(){var a=Ls.current;return a===null?!0:(nn&4194048)===nn?Zs===null:(nn&62914560)===nn||(nn&536870912)!==0?a===Zs:!1}function sv(){var a=ie.H;return ie.H=Pu,a===null?Pu:a}function iv(){var a=ie.A;return ie.A=r5,a}function mh(){ir=4,no||(nn&4194048)!==nn&&Ls.current!==null||(bc=!0),(ro&134217727)===0&&(ml&134217727)===0||In===null||ao(In,nn,Ps,!1)}function Im(a,l,h){var y=gn;gn|=2;var S=sv(),k=iv();(In!==a||nn!==l)&&(hh=null,vc(a,l)),l=!1;var D=ir;e:do try{if(En!==0&&Xt!==null){var z=Xt,Q=Bs;switch(En){case 8:Mm(),D=6;break e;case 3:case 2:case 9:case 6:Ls.current===null&&(l=!0);var Ee=En;if(En=0,Bs=null,Cc(a,z,Q,Ee),h&&bc){D=0;break e}break;default:Ee=En,En=0,Bs=null,Cc(a,z,Q,Ee)}}a5(),D=ir;break}catch(_e){nv(a,_e)}while(!0);return l&&a.shellSuspendCounter++,na=al=null,gn=y,ie.H=S,ie.A=k,Xt===null&&(In=null,nn=0,Lf()),D}function a5(){for(;Xt!==null;)av(Xt)}function o5(a,l){var h=gn;gn|=2;var y=sv(),S=iv();In!==a||nn!==l?(hh=null,fh=on()+500,vc(a,l)):bc=Jt(a,l);e:do try{if(En!==0&&Xt!==null){l=Xt;var k=Bs;t:switch(En){case 1:En=0,Bs=null,Cc(a,l,k,1);break;case 2:case 9:if(gy(k)){En=0,Bs=null,ov(l);break}l=function(){En!==2&&En!==9||In!==a||(En=7),Li(a)},k.then(l,l);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:gy(k)?(En=0,Bs=null,ov(l)):(En=0,Bs=null,Cc(a,l,k,7));break;case 5:var D=null;switch(Xt.tag){case 26:D=Xt.memoizedState;case 5:case 27:var z=Xt;if(D?qv(D):z.stateNode.complete){En=0,Bs=null;var Q=z.sibling;if(Q!==null)Xt=Q;else{var Ee=z.return;Ee!==null?(Xt=Ee,gh(Ee)):Xt=null}break t}}En=0,Bs=null,Cc(a,l,k,5);break;case 6:En=0,Bs=null,Cc(a,l,k,6);break;case 8:Mm(),ir=6;break e;default:throw Error(r(462))}}l5();break}catch(_e){nv(a,_e)}while(!0);return na=al=null,ie.H=y,ie.A=S,gn=h,Xt!==null?0:(In=null,nn=0,Lf(),ir)}function l5(){for(;Xt!==null&&!Xn();)av(Xt)}function av(a){var l=_w(a.alternate,a,fa);a.memoizedProps=a.pendingProps,l===null?gh(a):Xt=l}function ov(a){var l=a,h=l.alternate;switch(l.tag){case 15:case 0:l=Sw(h,l,l.pendingProps,l.type,void 0,nn);break;case 11:l=Sw(h,l,l.pendingProps,l.type.render,l.ref,nn);break;case 5:X1(l);default:Mw(h,l),l=Xt=iy(l,fa),l=_w(h,l,fa)}a.memoizedProps=a.pendingProps,l===null?gh(a):Xt=l}function Cc(a,l,h,y){na=al=null,X1(l),dc=null,_u=0;var S=l.return;try{if(K6(a,S,l,h,nn)){ir=1,rh(a,$s(h,a.current)),Xt=null;return}}catch(k){if(S!==null)throw Xt=S,k;ir=1,rh(a,$s(h,a.current)),Xt=null;return}l.flags&32768?(an||y===1?a=!0:bc||(nn&536870912)!==0?a=!1:(no=a=!0,(y===2||y===9||y===3||y===6)&&(y=Ls.current,y!==null&&y.tag===13&&(y.flags|=16384))),lv(l,a)):gh(l)}function gh(a){var l=a;do{if((l.flags&32768)!==0){lv(l,no);return}a=l.return;var h=Q6(l.alternate,l,fa);if(h!==null){Xt=h;return}if(l=l.sibling,l!==null){Xt=l;return}Xt=l=a}while(l!==null);ir===0&&(ir=5)}function lv(a,l){do{var h=e5(a.alternate,a);if(h!==null){h.flags&=32767,Xt=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(a=a.sibling,a!==null)){Xt=a;return}Xt=a=h}while(a!==null);ir=6,Xt=null}function cv(a,l,h,y,S,k,D,z,Q){a.cancelPendingCommit=null;do xh();while(Nr!==0);if((gn&6)!==0)throw Error(r(327));if(l!==null){if(l===a.current)throw Error(r(177));if(k=l.lanes|l.childLanes,k|=v1,Fe(a,h,k,D,z,Q),a===In&&(Xt=In=null,nn=0),wc=l,io=a,ha=h,Om=k,_m=S,Jw=y,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,f5(On,function(){return pv(),null})):(a.callbackNode=null,a.callbackPriority=0),y=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||y){y=ie.T,ie.T=null,S=pe.p,pe.p=2,D=gn,gn|=4;try{t5(a,l,h)}finally{gn=D,pe.p=S,ie.T=y}}Nr=1,uv(),dv(),fv()}}function uv(){if(Nr===1){Nr=0;var a=io,l=wc,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=ie.T,ie.T=null;var y=pe.p;pe.p=2;var S=gn;gn|=4;try{Gw(l,a);var k=Wm,D=P(a.containerInfo),z=k.focusedElem,Q=k.selectionRange;if(D!==z&&z&&z.ownerDocument&&I(z.ownerDocument.documentElement,z)){if(Q!==null&&F(z)){var Ee=Q.start,_e=Q.end;if(_e===void 0&&(_e=Ee),"selectionStart"in z)z.selectionStart=Ee,z.selectionEnd=Math.min(_e,z.value.length);else{var Le=z.ownerDocument||document,Se=Le&&Le.defaultView||window;if(Se.getSelection){var Te=Se.getSelection(),dt=z.textContent.length,Nt=Math.min(Q.start,dt),kn=Q.end===void 0?Nt:Math.min(Q.end,dt);!Te.extend&&Nt>kn&&(D=kn,kn=Nt,Nt=D);var he=O(z,Nt),ce=O(z,kn);if(he&&ce&&(Te.rangeCount!==1||Te.anchorNode!==he.node||Te.anchorOffset!==he.offset||Te.focusNode!==ce.node||Te.focusOffset!==ce.offset)){var ve=Le.createRange();ve.setStart(he.node,he.offset),Te.removeAllRanges(),Nt>kn?(Te.addRange(ve),Te.extend(ce.node,ce.offset)):(ve.setEnd(ce.node,ce.offset),Te.addRange(ve))}}}}for(Le=[],Te=z;Te=Te.parentNode;)Te.nodeType===1&&Le.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<Le.length;z++){var Me=Le[z];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}Oh=!!Gm,Wm=Gm=null}finally{gn=S,pe.p=y,ie.T=h}}a.current=l,Nr=2}}function dv(){if(Nr===2){Nr=0;var a=io,l=wc,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=ie.T,ie.T=null;var y=pe.p;pe.p=2;var S=gn;gn|=4;try{Fw(a,l.alternate,l)}finally{gn=S,pe.p=y,ie.T=h}}Nr=3}}function fv(){if(Nr===4||Nr===3){Nr=0,Lr();var a=io,l=wc,h=ha,y=Jw;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Nr=5:(Nr=0,wc=io=null,hv(a,a.pendingLanes));var S=a.pendingLanes;if(S===0&&(so=null),ut(h),l=l.stateNode,He&&typeof He.onCommitFiberRoot=="function")try{He.onCommitFiberRoot(ln,l,void 0,(l.current.flags&128)===128)}catch{}if(y!==null){l=ie.T,S=pe.p,pe.p=2,ie.T=null;try{for(var k=a.onRecoverableError,D=0;D<y.length;D++){var z=y[D];k(z.value,{componentStack:z.stack})}}finally{ie.T=l,pe.p=S}}(ha&3)!==0&&xh(),Li(a),S=a.pendingLanes,(h&261930)!==0&&(S&42)!==0?a===Rm?$u++:($u=0,Rm=a):$u=0,Xu(0)}}function hv(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,Tu(l)))}function xh(){return uv(),dv(),fv(),pv()}function pv(){if(Nr!==5)return!1;var a=io,l=Om;Om=0;var h=ut(ha),y=ie.T,S=pe.p;try{pe.p=32>h?32:h,ie.T=null,h=_m,_m=null;var k=io,D=ha;if(Nr=0,wc=io=null,ha=0,(gn&6)!==0)throw Error(r(331));var z=gn;if(gn|=4,Yw(k.current),qw(k,k.current,D,h),gn=z,Xu(0,!1),He&&typeof He.onPostCommitFiberRoot=="function")try{He.onPostCommitFiberRoot(ln,k)}catch{}return!0}finally{pe.p=S,ie.T=y,hv(a,l)}}function mv(a,l,h){l=$s(h,l),l=cm(a.stateNode,l,2),a=Ja(a,l,2),a!==null&&(Oe(a,2),Li(a))}function Sn(a,l,h){if(a.tag===3)mv(a,a,h);else for(;l!==null;){if(l.tag===3){mv(l,a,h);break}else if(l.tag===1){var y=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(so===null||!so.has(y))){a=$s(h,a),h=gw(2),y=Ja(l,h,2),y!==null&&(xw(h,y,l,a),Oe(y,2),Li(y));break}}l=l.return}}function Dm(a,l,h){var y=a.pingCache;if(y===null){y=a.pingCache=new s5;var S=new Set;y.set(l,S)}else S=y.get(l),S===void 0&&(S=new Set,y.set(l,S));S.has(h)||(Nm=!0,S.add(h),a=c5.bind(null,a,l,h),l.then(a,a))}function c5(a,l,h){var y=a.pingCache;y!==null&&y.delete(l),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,In===a&&(nn&h)===h&&(ir===4||ir===3&&(nn&62914560)===nn&&300>on()-dh?(gn&2)===0&&vc(a,0):km|=h,yc===nn&&(yc=0)),Li(a)}function gv(a,l){l===0&&(l=de()),a=rl(a,l),a!==null&&(Oe(a,l),Li(a))}function u5(a){var l=a.memoizedState,h=0;l!==null&&(h=l.retryLane),gv(a,h)}function d5(a,l){var h=0;switch(a.tag){case 31:case 13:var y=a.stateNode,S=a.memoizedState;S!==null&&(h=S.retryLane);break;case 19:y=a.stateNode;break;case 22:y=a.stateNode._retryCache;break;default:throw Error(r(314))}y!==null&&y.delete(l),gv(a,h)}function f5(a,l){return lt(a,l)}var bh=null,Ec=null,Lm=!1,yh=!1,jm=!1,oo=0;function Li(a){a!==Ec&&a.next===null&&(Ec===null?bh=Ec=a:Ec=Ec.next=a),yh=!0,Lm||(Lm=!0,p5())}function Xu(a,l){if(!jm&&yh){jm=!0;do for(var h=!1,y=bh;y!==null;){if(a!==0){var S=y.pendingLanes;if(S===0)var k=0;else{var D=y.suspendedLanes,z=y.pingedLanes;k=(1<<31-At(42|a)+1)-1,k&=S&~(D&~z),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(h=!0,wv(y,k))}else k=nn,k=Bn(y,y===In?k:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(k&3)===0||Jt(y,k)||(h=!0,wv(y,k));y=y.next}while(h);jm=!1}}function h5(){xv()}function xv(){yh=Lm=!1;var a=0;oo!==0&&S5()&&(a=oo);for(var l=on(),h=null,y=bh;y!==null;){var S=y.next,k=bv(y,l);k===0?(y.next=null,h===null?bh=S:h.next=S,S===null&&(Ec=h)):(h=y,(a!==0||(k&3)!==0)&&(yh=!0)),y=S}Nr!==0&&Nr!==5||Xu(a),oo!==0&&(oo=0)}function bv(a,l){for(var h=a.suspendedLanes,y=a.pingedLanes,S=a.expirationTimes,k=a.pendingLanes&-62914561;0<k;){var D=31-At(k),z=1<<D,Q=S[D];Q===-1?((z&h)===0||(z&y)!==0)&&(S[D]=dn(z,l)):Q<=l&&(a.expiredLanes|=z),k&=~z}if(l=In,h=nn,h=Bn(a,a===l?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),y=a.callbackNode,h===0||a===l&&(En===2||En===9)||a.cancelPendingCommit!==null)return y!==null&&y!==null&&tt(y),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Jt(a,h)){if(l=h&-h,l===a.callbackPriority)return l;switch(y!==null&&tt(y),ut(h)){case 2:case 8:h=jr;break;case 32:h=On;break;case 268435456:h=is;break;default:h=On}return y=yv.bind(null,a),h=lt(h,y),a.callbackPriority=l,a.callbackNode=h,l}return y!==null&&y!==null&&tt(y),a.callbackPriority=2,a.callbackNode=null,2}function yv(a,l){if(Nr!==0&&Nr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(xh()&&a.callbackNode!==h)return null;var y=nn;return y=Bn(a,a===In?y:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),y===0?null:(ev(a,y,l),bv(a,on()),a.callbackNode!=null&&a.callbackNode===h?yv.bind(null,a):null)}function wv(a,l){if(xh())return null;ev(a,l,!0)}function p5(){N5(function(){(gn&6)!==0?lt(tr,h5):xv()})}function Bm(){if(oo===0){var a=lc;a===0&&(a=Br,Br<<=1,(Br&261888)===0&&(Br=256)),oo=a}return oo}function vv(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Pa(""+a)}function Cv(a,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,a.id&&h.setAttribute("form",a.id),l.parentNode.insertBefore(h,l),a=new FormData(a),h.parentNode.removeChild(h),a}function m5(a,l,h,y,S){if(l==="submit"&&h&&h.stateNode===S){var k=vv((S[_t]||null).action),D=y.submitter;D&&(l=(l=D[_t]||null)?vv(l.formAction):D.getAttribute("formAction"),l!==null&&(k=l,D=null));var z=new Er("action","action",null,y,S);a.push({event:z,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(oo!==0){var Q=D?Cv(S,D):new FormData(S);rm(h,{pending:!0,data:Q,method:S.method,action:k},null,Q)}}else typeof k=="function"&&(z.preventDefault(),Q=D?Cv(S,D):new FormData(S),rm(h,{pending:!0,data:Q,method:S.method,action:k},k,Q))},currentTarget:S}]})}}for(var Pm=0;Pm<Au.length;Pm++){var Fm=Au[Pm],g5=Fm.toLowerCase(),x5=Fm[0].toUpperCase()+Fm.slice(1);di(g5,"on"+x5)}di(ws,"onAnimationEnd"),di(Ur,"onAnimationIteration"),di(vn,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(Ar,"onTransitionRun"),di(cs,"onTransitionStart"),di(Wa,"onTransitionCancel"),di(Qi,"onTransitionEnd"),Jr("onMouseEnter",["mouseout","mouseover"]),Jr("onMouseLeave",["mouseout","mouseover"]),Jr("onPointerEnter",["pointerout","pointerover"]),Jr("onPointerLeave",["pointerout","pointerover"]),sn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),sn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),sn("onBeforeInput",["compositionend","keypress","textInput","paste"]),sn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),sn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),sn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),b5=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yu));function Ev(a,l){l=(l&4)!==0;for(var h=0;h<a.length;h++){var y=a[h],S=y.event;y=y.listeners;e:{var k=void 0;if(l)for(var D=y.length-1;0<=D;D--){var z=y[D],Q=z.instance,Ee=z.currentTarget;if(z=z.listener,Q!==k&&S.isPropagationStopped())break e;k=z,S.currentTarget=Ee;try{k(S)}catch(_e){Df(_e)}S.currentTarget=null,k=Q}else for(D=0;D<y.length;D++){if(z=y[D],Q=z.instance,Ee=z.currentTarget,z=z.listener,Q!==k&&S.isPropagationStopped())break e;k=z,S.currentTarget=Ee;try{k(S)}catch(_e){Df(_e)}S.currentTarget=null,k=Q}}}}function Yt(a,l){var h=l[Si];h===void 0&&(h=l[Si]=new Set);var y=a+"__bubble";h.has(y)||(Sv(l,a,2,!1),h.add(y))}function zm(a,l,h){var y=0;l&&(y|=4),Sv(h,a,y,l)}var wh="_reactListening"+Math.random().toString(36).slice(2);function Um(a){if(!a[wh]){a[wh]=!0,Re.forEach(function(h){h!=="selectionchange"&&(b5.has(h)||zm(h,!1,a),zm(h,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[wh]||(l[wh]=!0,zm("selectionchange",!1,l))}}function Sv(a,l,h,y){switch(Qv(l)){case 2:var S=q5;break;case 8:S=$5;break;default:S=ng}h=S.bind(null,l,h,a),S=void 0,!bu||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(S=!0),y?S!==void 0?a.addEventListener(l,h,{capture:!0,passive:S}):a.addEventListener(l,h,!0):S!==void 0?a.addEventListener(l,h,{passive:S}):a.addEventListener(l,h,!1)}function Hm(a,l,h,y,S){var k=y;if((l&1)===0&&(l&2)===0&&y!==null)e:for(;;){if(y===null)return;var D=y.tag;if(D===3||D===4){var z=y.stateNode.containerInfo;if(z===S)break;if(D===4)for(D=y.return;D!==null;){var Q=D.tag;if((Q===3||Q===4)&&D.stateNode.containerInfo===S)return;D=D.return}for(;z!==null;){if(D=Yn(z),D===null)return;if(Q=D.tag,Q===5||Q===6||Q===26||Q===27){y=k=D;continue e}z=z.parentNode}}y=y.return}Ef(function(){var Ee=k,_e=xu(h),Le=[];e:{var Se=If.get(a);if(Se!==void 0){var Te=Er,dt=a;switch(a){case"keypress":if(Ti(h)===0)break e;case"keydown":case"keyup":Te=Ql;break;case"focusin":dt="focus",Te=vu;break;case"focusout":dt="blur",Te=vu;break;case"beforeblur":case"afterblur":Te=vu;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=Zl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=b1;break;case ws:case Ur:case vn:Te=zt;break;case Qi:Te=Yi;break;case"scroll":case"scrollend":Te=Sf;break;case"wheel":Te=y1;break;case"copy":case"cut":case"paste":Te=Jl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=wn;break;case"toggle":case"beforetoggle":Te=Eu}var Nt=(l&4)!==0,kn=!Nt&&(a==="scroll"||a==="scrollend"),he=Nt?Se!==null?Se+"Capture":null:Se;Nt=[];for(var ce=Ee,ve;ce!==null;){var Me=ce;if(ve=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||ve===null||he===null||(Me=Mt(ce,he),Me!=null&&Nt.push(Ku(ce,Me,ve))),kn)break;ce=ce.return}0<Nt.length&&(Se=new Te(Se,dt,null,h,_e),Le.push({event:Se,listeners:Nt}))}}if((l&7)===0){e:{if(Se=a==="mouseover"||a==="pointerover",Te=a==="mouseout"||a==="pointerout",Se&&h!==Yo&&(dt=h.relatedTarget||h.fromElement)&&(Yn(dt)||dt[Pr]))break e;if((Te||Se)&&(Se=_e.window===_e?_e:(Se=_e.ownerDocument)?Se.defaultView||Se.parentWindow:window,Te?(dt=h.relatedTarget||h.toElement,Te=Ee,dt=dt?Yn(dt):null,dt!==null&&(kn=i(dt),Nt=dt.tag,dt!==kn||Nt!==5&&Nt!==27&&Nt!==6)&&(dt=null)):(Te=null,dt=Ee),Te!==dt)){if(Nt=mn,Me="onMouseLeave",he="onMouseEnter",ce="mouse",(a==="pointerout"||a==="pointerover")&&(Nt=wn,Me="onPointerLeave",he="onPointerEnter",ce="pointer"),kn=Te==null?Se:Ni(Te),ve=dt==null?Se:Ni(dt),Se=new Nt(Me,ce+"leave",Te,h,_e),Se.target=kn,Se.relatedTarget=ve,Me=null,Yn(_e)===Ee&&(Nt=new Nt(he,ce+"enter",dt,h,_e),Nt.target=ve,Nt.relatedTarget=kn,Me=Nt),kn=Me,Te&&dt)t:{for(Nt=y5,he=Te,ce=dt,ve=0,Me=he;Me;Me=Nt(Me))ve++;Me=0;for(var wt=ce;wt;wt=Nt(wt))Me++;for(;0<ve-Me;)he=Nt(he),ve--;for(;0<Me-ve;)ce=Nt(ce),Me--;for(;ve--;){if(he===ce||ce!==null&&he===ce.alternate){Nt=he;break t}he=Nt(he),ce=Nt(ce)}Nt=null}else Nt=null;Te!==null&&Av(Le,Se,Te,Nt,!1),dt!==null&&kn!==null&&Av(Le,kn,dt,Nt,!0)}}e:{if(Se=Ee?Ni(Ee):window,Te=Se.nodeName&&Se.nodeName.toLowerCase(),Te==="select"||Te==="input"&&Se.type==="file")var fn=Is;else if(Su(Se))if(Mf)fn=m;else{fn=u;var pt=o}else Te=Se.nodeName,!Te||Te.toLowerCase()!=="input"||Se.type!=="checkbox"&&Se.type!=="radio"?Ee&&_n(Ee.elementType)&&(fn=Is):fn=d;if(fn&&(fn=fn(a,Ee))){Ms(Le,fn,h,_e);break e}pt&&pt(a,Se,Ee),a==="focusout"&&Ee&&Se.type==="number"&&Ee.memoizedProps.value!=null&&W(Se,"number",Se.value)}switch(pt=Ee?Ni(Ee):window,a){case"focusin":(Su(pt)||pt.contentEditable==="true")&&(re=pt,ae=Ee,be=null);break;case"focusout":be=ae=re=null;break;case"mousedown":Ne=!0;break;case"contextmenu":case"mouseup":case"dragend":Ne=!1,$e(Le,h,_e);break;case"selectionchange":if(q)break;case"keydown":case"keyup":$e(Le,h,_e)}var Ut;if(Jo)e:{switch(a){case"compositionstart":var rn="onCompositionStart";break e;case"compositionend":rn="onCompositionEnd";break e;case"compositionupdate":rn="onCompositionUpdate";break e}rn=void 0}else Ga?Rf(a,h)&&(rn="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(rn="onCompositionStart");rn&&(_f&&h.locale!=="ko"&&(Ga||rn!=="onCompositionStart"?rn==="onCompositionEnd"&&Ga&&(Ut=Fa()):(ci=_e,ui="value"in ci?ci.value:ci.textContent,Ga=!0)),pt=vh(Ee,rn),0<pt.length&&(rn=new kf(rn,a,null,h,_e),Le.push({event:rn,listeners:pt}),Ut?rn.data=Ut:(Ut=Va(h),Ut!==null&&(rn.data=Ut)))),(Ut=Of?Ri(a,h):tc(a,h))&&(rn=vh(Ee,"onBeforeInput"),0<rn.length&&(pt=new kf("onBeforeInput","beforeinput",null,h,_e),Le.push({event:pt,listeners:rn}),pt.data=Ut)),m5(Le,a,Ee,h,_e)}Ev(Le,l)})}function Ku(a,l,h){return{instance:a,listener:l,currentTarget:h}}function vh(a,l){for(var h=l+"Capture",y=[];a!==null;){var S=a,k=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=Mt(a,h),S!=null&&y.unshift(Ku(a,S,k)),S=Mt(a,l),S!=null&&y.push(Ku(a,S,k))),a.tag===3)return y;a=a.return}return[]}function y5(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Av(a,l,h,y,S){for(var k=l._reactName,D=[];h!==null&&h!==y;){var z=h,Q=z.alternate,Ee=z.stateNode;if(z=z.tag,Q!==null&&Q===y)break;z!==5&&z!==26&&z!==27||Ee===null||(Q=Ee,S?(Ee=Mt(h,k),Ee!=null&&D.unshift(Ku(h,Ee,Q))):S||(Ee=Mt(h,k),Ee!=null&&D.push(Ku(h,Ee,Q)))),h=h.return}D.length!==0&&a.push({event:l,listeners:D})}var w5=/\r\n?/g,v5=/\u0000|\uFFFD/g;function Nv(a){return(typeof a=="string"?a:""+a).replace(w5,`
`).replace(v5,"")}function kv(a,l){return l=Nv(l),Nv(a)===l}function Nn(a,l,h,y,S,k){switch(h){case"children":typeof y=="string"?l==="body"||l==="textarea"&&y===""||Ba(a,y):(typeof y=="number"||typeof y=="bigint")&&l!=="body"&&Ba(a,""+y);break;case"className":ki(a,"class",y);break;case"tabIndex":ki(a,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":ki(a,h,y);break;case"style":bt(a,y,k);break;case"data":if(l!=="object"){ki(a,"data",y);break}case"src":case"href":if(y===""&&(l!=="a"||h!=="href")){a.removeAttribute(h);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(h);break}y=Pa(""+y),a.setAttribute(h,y);break;case"action":case"formAction":if(typeof y=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(h==="formAction"?(l!=="input"&&Nn(a,l,"name",S.name,S,null),Nn(a,l,"formEncType",S.formEncType,S,null),Nn(a,l,"formMethod",S.formMethod,S,null),Nn(a,l,"formTarget",S.formTarget,S,null)):(Nn(a,l,"encType",S.encType,S,null),Nn(a,l,"method",S.method,S,null),Nn(a,l,"target",S.target,S,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(h);break}y=Pa(""+y),a.setAttribute(h,y);break;case"onClick":y!=null&&(a.onclick=bs);break;case"onScroll":y!=null&&Yt("scroll",a);break;case"onScrollEnd":y!=null&&Yt("scrollend",a);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(h=y.__html,h!=null){if(S.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":a.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){a.removeAttribute("xlink:href");break}h=Pa(""+y),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,""+y):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":y===!0?a.setAttribute(h,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,y):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?a.setAttribute(h,y):a.removeAttribute(h);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?a.removeAttribute(h):a.setAttribute(h,y);break;case"popover":Yt("beforetoggle",a),Yt("toggle",a),qi(a,"popover",y);break;case"xlinkActuate":ye(a,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":ye(a,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":ye(a,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":ye(a,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":ye(a,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":ye(a,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":ye(a,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":ye(a,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":ye(a,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":qi(a,"is",y);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Cf.get(h)||h,qi(a,h,y))}}function Vm(a,l,h,y,S,k){switch(h){case"style":bt(a,y,k);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(h=y.__html,h!=null){if(S.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof y=="string"?Ba(a,y):(typeof y=="number"||typeof y=="bigint")&&Ba(a,""+y);break;case"onScroll":y!=null&&Yt("scroll",a);break;case"onScrollEnd":y!=null&&Yt("scrollend",a);break;case"onClick":y!=null&&(a.onclick=bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$l.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(S=h.endsWith("Capture"),l=h.slice(2,S?h.length-7:void 0),k=a[_t]||null,k=k!=null?k[h]:null,typeof k=="function"&&a.removeEventListener(l,k,S),typeof y=="function")){typeof k!="function"&&k!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(l,y,S);break e}h in a?a[h]=y:y===!0?a.setAttribute(h,""):qi(a,h,y)}}}function Wr(a,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yt("error",a),Yt("load",a);var y=!1,S=!1,k;for(k in h)if(h.hasOwnProperty(k)){var D=h[k];if(D!=null)switch(k){case"src":y=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Nn(a,l,k,D,h,null)}}S&&Nn(a,l,"srcSet",h.srcSet,h,null),y&&Nn(a,l,"src",h.src,h,null);return;case"input":Yt("invalid",a);var z=k=D=S=null,Q=null,Ee=null;for(y in h)if(h.hasOwnProperty(y)){var _e=h[y];if(_e!=null)switch(y){case"name":S=_e;break;case"type":D=_e;break;case"checked":Q=_e;break;case"defaultChecked":Ee=_e;break;case"value":k=_e;break;case"defaultValue":z=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(r(137,l));break;default:Nn(a,l,y,_e,h,null)}}xe(a,k,z,Q,Ee,D,S,!1);return;case"select":Yt("invalid",a),y=D=k=null;for(S in h)if(h.hasOwnProperty(S)&&(z=h[S],z!=null))switch(S){case"value":k=z;break;case"defaultValue":D=z;break;case"multiple":y=z;default:Nn(a,l,S,z,h,null)}l=k,h=D,a.multiple=!!y,l!=null?ht(a,!!y,l,!1):h!=null&&ht(a,!!y,h,!0);return;case"textarea":Yt("invalid",a),k=S=y=null;for(D in h)if(h.hasOwnProperty(D)&&(z=h[D],z!=null))switch(D){case"value":y=z;break;case"defaultValue":S=z;break;case"children":k=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(91));break;default:Nn(a,l,D,z,h,null)}as(a,y,S,k);return;case"option":for(Q in h)if(h.hasOwnProperty(Q)&&(y=h[Q],y!=null))switch(Q){case"selected":a.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:Nn(a,l,Q,y,h,null)}return;case"dialog":Yt("beforetoggle",a),Yt("toggle",a),Yt("cancel",a),Yt("close",a);break;case"iframe":case"object":Yt("load",a);break;case"video":case"audio":for(y=0;y<Yu.length;y++)Yt(Yu[y],a);break;case"image":Yt("error",a),Yt("load",a);break;case"details":Yt("toggle",a);break;case"embed":case"source":case"link":Yt("error",a),Yt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in h)if(h.hasOwnProperty(Ee)&&(y=h[Ee],y!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Nn(a,l,Ee,y,h,null)}return;default:if(_n(l)){for(_e in h)h.hasOwnProperty(_e)&&(y=h[_e],y!==void 0&&Vm(a,l,_e,y,h,void 0));return}}for(z in h)h.hasOwnProperty(z)&&(y=h[z],y!=null&&Nn(a,l,z,y,h,null))}function C5(a,l,h,y){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,D=null,z=null,Q=null,Ee=null,_e=null;for(Te in h){var Le=h[Te];if(h.hasOwnProperty(Te)&&Le!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":Q=Le;default:y.hasOwnProperty(Te)||Nn(a,l,Te,null,y,Le)}}for(var Se in y){var Te=y[Se];if(Le=h[Se],y.hasOwnProperty(Se)&&(Te!=null||Le!=null))switch(Se){case"type":k=Te;break;case"name":S=Te;break;case"checked":Ee=Te;break;case"defaultChecked":_e=Te;break;case"value":D=Te;break;case"defaultValue":z=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(r(137,l));break;default:Te!==Le&&Nn(a,l,Se,Te,y,Le)}}yn(a,D,z,Q,Ee,_e,k,S);return;case"select":Te=D=z=Se=null;for(k in h)if(Q=h[k],h.hasOwnProperty(k)&&Q!=null)switch(k){case"value":break;case"multiple":Te=Q;default:y.hasOwnProperty(k)||Nn(a,l,k,null,y,Q)}for(S in y)if(k=y[S],Q=h[S],y.hasOwnProperty(S)&&(k!=null||Q!=null))switch(S){case"value":Se=k;break;case"defaultValue":z=k;break;case"multiple":D=k;default:k!==Q&&Nn(a,l,S,k,y,Q)}l=z,h=D,y=Te,Se!=null?ht(a,!!h,Se,!1):!!y!=!!h&&(l!=null?ht(a,!!h,l,!0):ht(a,!!h,h?[]:"",!1));return;case"textarea":Te=Se=null;for(z in h)if(S=h[z],h.hasOwnProperty(z)&&S!=null&&!y.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Nn(a,l,z,null,y,S)}for(D in y)if(S=y[D],k=h[D],y.hasOwnProperty(D)&&(S!=null||k!=null))switch(D){case"value":Se=S;break;case"defaultValue":Te=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:S!==k&&Nn(a,l,D,S,y,k)}dr(a,Se,Te);return;case"option":for(var dt in h)if(Se=h[dt],h.hasOwnProperty(dt)&&Se!=null&&!y.hasOwnProperty(dt))switch(dt){case"selected":a.selected=!1;break;default:Nn(a,l,dt,null,y,Se)}for(Q in y)if(Se=y[Q],Te=h[Q],y.hasOwnProperty(Q)&&Se!==Te&&(Se!=null||Te!=null))switch(Q){case"selected":a.selected=Se&&typeof Se!="function"&&typeof Se!="symbol";break;default:Nn(a,l,Q,Se,y,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Nt in h)Se=h[Nt],h.hasOwnProperty(Nt)&&Se!=null&&!y.hasOwnProperty(Nt)&&Nn(a,l,Nt,null,y,Se);for(Ee in y)if(Se=y[Ee],Te=h[Ee],y.hasOwnProperty(Ee)&&Se!==Te&&(Se!=null||Te!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(137,l));break;default:Nn(a,l,Ee,Se,y,Te)}return;default:if(_n(l)){for(var kn in h)Se=h[kn],h.hasOwnProperty(kn)&&Se!==void 0&&!y.hasOwnProperty(kn)&&Vm(a,l,kn,void 0,y,Se);for(_e in y)Se=y[_e],Te=h[_e],!y.hasOwnProperty(_e)||Se===Te||Se===void 0&&Te===void 0||Vm(a,l,_e,Se,y,Te);return}}for(var he in h)Se=h[he],h.hasOwnProperty(he)&&Se!=null&&!y.hasOwnProperty(he)&&Nn(a,l,he,null,y,Se);for(Le in y)Se=y[Le],Te=h[Le],!y.hasOwnProperty(Le)||Se===Te||Se==null&&Te==null||Nn(a,l,Le,Se,y,Te)}function Tv(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function E5(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,h=performance.getEntriesByType("resource"),y=0;y<h.length;y++){var S=h[y],k=S.transferSize,D=S.initiatorType,z=S.duration;if(k&&z&&Tv(D)){for(D=0,z=S.responseEnd,y+=1;y<h.length;y++){var Q=h[y],Ee=Q.startTime;if(Ee>z)break;var _e=Q.transferSize,Le=Q.initiatorType;_e&&Tv(Le)&&(Q=Q.responseEnd,D+=_e*(Q<z?1:(z-Ee)/(Q-Ee)))}if(--y,l+=8*(k+D)/(S.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Gm=null,Wm=null;function Ch(a){return a.nodeType===9?a:a.ownerDocument}function Ov(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _v(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function qm(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var $m=null;function S5(){var a=window.event;return a&&a.type==="popstate"?a===$m?!1:($m=a,!0):($m=null,!1)}var Rv=typeof setTimeout=="function"?setTimeout:void 0,A5=typeof clearTimeout=="function"?clearTimeout:void 0,Mv=typeof Promise=="function"?Promise:void 0,N5=typeof queueMicrotask=="function"?queueMicrotask:typeof Mv<"u"?function(a){return Mv.resolve(null).then(a).catch(k5)}:Rv;function k5(a){setTimeout(function(){throw a})}function lo(a){return a==="head"}function Iv(a,l){var h=l,y=0;do{var S=h.nextSibling;if(a.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"||h==="/&"){if(y===0){a.removeChild(S),kc(l);return}y--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")y++;else if(h==="html")Zu(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,Zu(h);for(var k=h.firstChild;k;){var D=k.nextSibling,z=k.nodeName;k[Ai]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&k.rel.toLowerCase()==="stylesheet"||h.removeChild(k),k=D}}else h==="body"&&Zu(a.ownerDocument.body);h=S}while(h);kc(l)}function Dv(a,l){var h=a;a=0;do{var y=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),y&&y.nodeType===8)if(h=y.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=y}while(h)}function Xm(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Xm(h),Zr(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function T5(a,l,h,y){for(;a.nodeType===1;){var S=h;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!y&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(y){if(!a[Ai])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(k=a.getAttribute("rel"),k==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(k!==S.rel||a.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||a.getAttribute("title")!==(S.title==null?null:S.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(k=a.getAttribute("src"),(k!==(S.src==null?null:S.src)||a.getAttribute("type")!==(S.type==null?null:S.type)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&a.getAttribute("name")===k)return a}else return a;if(a=Js(a.nextSibling),a===null)break}return null}function O5(a,l,h){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Js(a.nextSibling),a===null))return null;return a}function Lv(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Js(a.nextSibling),a===null))return null;return a}function Ym(a){return a.data==="$?"||a.data==="$~"}function Km(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function _5(a,l){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||h.readyState!=="loading")l();else{var y=function(){l(),h.removeEventListener("DOMContentLoaded",y)};h.addEventListener("DOMContentLoaded",y),a._reactRetry=y}}function Js(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var Zm=null;function jv(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(l===0)return Js(a.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}a=a.nextSibling}return null}function Bv(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return a;l--}else h!=="/$"&&h!=="/&"||l++}a=a.previousSibling}return null}function Pv(a,l,h){switch(l=Ch(h),a){case"html":if(a=l.documentElement,!a)throw Error(r(452));return a;case"head":if(a=l.head,!a)throw Error(r(453));return a;case"body":if(a=l.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Zu(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);Zr(a)}var Qs=new Map,Fv=new Set;function Eh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var pa=pe.d;pe.d={f:R5,r:M5,D:I5,C:D5,L:L5,m:j5,X:P5,S:B5,M:F5};function R5(){var a=pa.f(),l=ph();return a||l}function M5(a){var l=un(a);l!==null&&l.tag===5&&l.type==="form"?nw(l):pa.r(a)}var Sc=typeof document>"u"?null:document;function zv(a,l,h){var y=Sc;if(y&&typeof l=="string"&&l){var S=kt(l);S='link[rel="'+a+'"][href="'+S+'"]',typeof h=="string"&&(S+='[crossorigin="'+h+'"]'),Fv.has(S)||(Fv.add(S),a={rel:a,crossOrigin:h,href:l},y.querySelector(S)===null&&(l=y.createElement("link"),Wr(l,"link",a),Kn(l),y.head.appendChild(l)))}}function I5(a){pa.D(a),zv("dns-prefetch",a,null)}function D5(a,l){pa.C(a,l),zv("preconnect",a,l)}function L5(a,l,h){pa.L(a,l,h);var y=Sc;if(y&&a&&l){var S='link[rel="preload"][as="'+kt(l)+'"]';l==="image"&&h&&h.imageSrcSet?(S+='[imagesrcset="'+kt(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(S+='[imagesizes="'+kt(h.imageSizes)+'"]')):S+='[href="'+kt(a)+'"]';var k=S;switch(l){case"style":k=Ac(a);break;case"script":k=Nc(a)}Qs.has(k)||(a=v({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:a,as:l},h),Qs.set(k,a),y.querySelector(S)!==null||l==="style"&&y.querySelector(Ju(k))||l==="script"&&y.querySelector(Qu(k))||(l=y.createElement("link"),Wr(l,"link",a),Kn(l),y.head.appendChild(l)))}}function j5(a,l){pa.m(a,l);var h=Sc;if(h&&a){var y=l&&typeof l.as=="string"?l.as:"script",S='link[rel="modulepreload"][as="'+kt(y)+'"][href="'+kt(a)+'"]',k=S;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Nc(a)}if(!Qs.has(k)&&(a=v({rel:"modulepreload",href:a},l),Qs.set(k,a),h.querySelector(S)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Qu(k)))return}y=h.createElement("link"),Wr(y,"link",a),Kn(y),h.head.appendChild(y)}}}function B5(a,l,h){pa.S(a,l,h);var y=Sc;if(y&&a){var S=Fr(y).hoistableStyles,k=Ac(a);l=l||"default";var D=S.get(k);if(!D){var z={loading:0,preload:null};if(D=y.querySelector(Ju(k)))z.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":l},h),(h=Qs.get(k))&&Jm(a,h);var Q=D=y.createElement("link");Kn(Q),Wr(Q,"link",a),Q._p=new Promise(function(Ee,_e){Q.onload=Ee,Q.onerror=_e}),Q.addEventListener("load",function(){z.loading|=1}),Q.addEventListener("error",function(){z.loading|=2}),z.loading|=4,Sh(D,l,y)}D={type:"stylesheet",instance:D,count:1,state:z},S.set(k,D)}}}function P5(a,l){pa.X(a,l);var h=Sc;if(h&&a){var y=Fr(h).hoistableScripts,S=Nc(a),k=y.get(S);k||(k=h.querySelector(Qu(S)),k||(a=v({src:a,async:!0},l),(l=Qs.get(S))&&Qm(a,l),k=h.createElement("script"),Kn(k),Wr(k,"link",a),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},y.set(S,k))}}function F5(a,l){pa.M(a,l);var h=Sc;if(h&&a){var y=Fr(h).hoistableScripts,S=Nc(a),k=y.get(S);k||(k=h.querySelector(Qu(S)),k||(a=v({src:a,async:!0,type:"module"},l),(l=Qs.get(S))&&Qm(a,l),k=h.createElement("script"),Kn(k),Wr(k,"link",a),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},y.set(S,k))}}function Uv(a,l,h,y){var S=(S=se.current)?Eh(S):null;if(!S)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=Ac(h.href),h=Fr(S).hoistableStyles,y=h.get(l),y||(y={type:"style",instance:null,count:0,state:null},h.set(l,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=Ac(h.href);var k=Fr(S).hoistableStyles,D=k.get(a);if(D||(S=S.ownerDocument||S,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(a,D),(k=S.querySelector(Ju(a)))&&!k._p&&(D.instance=k,D.state.loading=5),Qs.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Qs.set(a,h),k||z5(S,a,h,D.state))),l&&y===null)throw Error(r(528,""));return D}if(l&&y!==null)throw Error(r(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Nc(h),h=Fr(S).hoistableScripts,y=h.get(l),y||(y={type:"script",instance:null,count:0,state:null},h.set(l,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Ac(a){return'href="'+kt(a)+'"'}function Ju(a){return'link[rel="stylesheet"]['+a+"]"}function Hv(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function z5(a,l,h,y){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?y.loading=1:(l=a.createElement("link"),y.preload=l,l.addEventListener("load",function(){return y.loading|=1}),l.addEventListener("error",function(){return y.loading|=2}),Wr(l,"link",h),Kn(l),a.head.appendChild(l))}function Nc(a){return'[src="'+kt(a)+'"]'}function Qu(a){return"script[async]"+a}function Vv(a,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var y=a.querySelector('style[data-href~="'+kt(h.href)+'"]');if(y)return l.instance=y,Kn(y),y;var S=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return y=(a.ownerDocument||a).createElement("style"),Kn(y),Wr(y,"style",S),Sh(y,h.precedence,a),l.instance=y;case"stylesheet":S=Ac(h.href);var k=a.querySelector(Ju(S));if(k)return l.state.loading|=4,l.instance=k,Kn(k),k;y=Hv(h),(S=Qs.get(S))&&Jm(y,S),k=(a.ownerDocument||a).createElement("link"),Kn(k);var D=k;return D._p=new Promise(function(z,Q){D.onload=z,D.onerror=Q}),Wr(k,"link",y),l.state.loading|=4,Sh(k,h.precedence,a),l.instance=k;case"script":return k=Nc(h.src),(S=a.querySelector(Qu(k)))?(l.instance=S,Kn(S),S):(y=h,(S=Qs.get(k))&&(y=v({},h),Qm(y,S)),a=a.ownerDocument||a,S=a.createElement("script"),Kn(S),Wr(S,"link",y),a.head.appendChild(S),l.instance=S);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(y=l.instance,l.state.loading|=4,Sh(y,h.precedence,a));return l.instance}function Sh(a,l,h){for(var y=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=y.length?y[y.length-1]:null,k=S,D=0;D<y.length;D++){var z=y[D];if(z.dataset.precedence===l)k=z;else if(k!==S)break}k?k.parentNode.insertBefore(a,k.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(a,l.firstChild))}function Jm(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function Qm(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var Ah=null;function Gv(a,l,h){if(Ah===null){var y=new Map,S=Ah=new Map;S.set(h,y)}else S=Ah,y=S.get(h),y||(y=new Map,S.set(h,y));if(y.has(a))return y;for(y.set(a,null),h=h.getElementsByTagName(a),S=0;S<h.length;S++){var k=h[S];if(!(k[Ai]||k[qt]||a==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var D=k.getAttribute(l)||"";D=a+D;var z=y.get(D);z?z.push(k):y.set(D,[k])}}return y}function Wv(a,l,h){a=a.ownerDocument||a,a.head.insertBefore(h,l==="title"?a.querySelector("head > title"):null)}function U5(a,l,h){if(h===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function qv(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function H5(a,l,h,y){if(h.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Ac(y.href),k=l.querySelector(Ju(S));if(k){l=k._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=Nh.bind(a),l.then(a,a)),h.state.loading|=4,h.instance=k,Kn(k);return}k=l.ownerDocument||l,y=Hv(y),(S=Qs.get(S))&&Jm(y,S),k=k.createElement("link"),Kn(k);var D=k;D._p=new Promise(function(z,Q){D.onload=z,D.onerror=Q}),Wr(k,"link",y),h.instance=k}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=Nh.bind(a),l.addEventListener("load",h),l.addEventListener("error",h))}}var eg=0;function V5(a,l){return a.stylesheets&&a.count===0&&Th(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var y=setTimeout(function(){if(a.stylesheets&&Th(a,a.stylesheets),a.unsuspend){var k=a.unsuspend;a.unsuspend=null,k()}},6e4+l);0<a.imgBytes&&eg===0&&(eg=62500*E5());var S=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Th(a,a.stylesheets),a.unsuspend)){var k=a.unsuspend;a.unsuspend=null,k()}},(a.imgBytes>eg?50:800)+l);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(y),clearTimeout(S)}}:null}function Nh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Th(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var kh=null;function Th(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,kh=new Map,l.forEach(G5,a),kh=null,Nh.call(a))}function G5(a,l){if(!(l.state.loading&4)){var h=kh.get(a);if(h)var y=h.get(null);else{h=new Map,kh.set(a,h);for(var S=a.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var D=S[k];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(h.set(D.dataset.precedence,D),y=D)}y&&h.set(null,y)}S=l.instance,D=S.getAttribute("data-precedence"),k=h.get(D)||y,k===y&&h.set(null,S),h.set(D,S),this.count++,y=Nh.bind(this),S.addEventListener("load",y),S.addEventListener("error",y),k?k.parentNode.insertBefore(S,k.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(S,a.firstChild)),l.state.loading|=4}}var ed={$$typeof:G,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function W5(a,l,h,y,S,k,D,z,Q){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=we(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=we(0),this.hiddenUpdates=we(null),this.identifierPrefix=y,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function $v(a,l,h,y,S,k,D,z,Q,Ee,_e,Le){return a=new W5(a,l,h,D,Q,Ee,_e,Le,z),l=1,k===!0&&(l|=24),k=Ds(3,null,null,l),a.current=k,k.stateNode=a,l=I1(),l.refCount++,a.pooledCache=l,l.refCount++,k.memoizedState={element:y,isDehydrated:h,cache:l},B1(k),a}function Xv(a){return a?(a=rc,a):rc}function Yv(a,l,h,y,S,k){S=Xv(S),y.context===null?y.context=S:y.pendingContext=S,y=Za(l),y.payload={element:h},k=k===void 0?null:k,k!==null&&(y.callback=k),h=Ja(a,y,l),h!==null&&(As(h,a,l),Mu(h,a,l))}function Kv(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<l?h:l}}function tg(a,l){Kv(a,l),(a=a.alternate)&&Kv(a,l)}function Zv(a){if(a.tag===13||a.tag===31){var l=rl(a,67108864);l!==null&&As(l,a,67108864),tg(a,67108864)}}function Jv(a){if(a.tag===13||a.tag===31){var l=Fs();l=ct(l);var h=rl(a,l);h!==null&&As(h,a,l),tg(a,l)}}var Oh=!0;function q5(a,l,h,y){var S=ie.T;ie.T=null;var k=pe.p;try{pe.p=2,ng(a,l,h,y)}finally{pe.p=k,ie.T=S}}function $5(a,l,h,y){var S=ie.T;ie.T=null;var k=pe.p;try{pe.p=8,ng(a,l,h,y)}finally{pe.p=k,ie.T=S}}function ng(a,l,h,y){if(Oh){var S=rg(y);if(S===null)Hm(a,l,y,_h,h),eC(a,y);else if(Y5(S,a,l,h,y))y.stopPropagation();else if(eC(a,y),l&4&&-1<X5.indexOf(a)){for(;S!==null;){var k=un(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var D=pn(k.pendingLanes);if(D!==0){var z=k;for(z.pendingLanes|=2,z.entangledLanes|=2;D;){var Q=1<<31-At(D);z.entanglements[1]|=Q,D&=~Q}Li(k),(gn&6)===0&&(fh=on()+500,Xu(0))}}break;case 31:case 13:z=rl(k,2),z!==null&&As(z,k,2),ph(),tg(k,2)}if(k=rg(y),k===null&&Hm(a,l,y,_h,h),k===S)break;S=k}S!==null&&y.stopPropagation()}else Hm(a,l,y,null,h)}}function rg(a){return a=xu(a),sg(a)}var _h=null;function sg(a){if(_h=null,a=Yn(a),a!==null){var l=i(a);if(l===null)a=null;else{var h=l.tag;if(h===13){if(a=c(l),a!==null)return a;a=null}else if(h===31){if(a=f(l),a!==null)return a;a=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return _h=a,null}function Qv(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_s()){case tr:return 2;case jr:return 8;case On:case xn:return 32;case is:return 268435456;default:return 32}default:return 32}}var ig=!1,co=null,uo=null,fo=null,td=new Map,nd=new Map,ho=[],X5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eC(a,l){switch(a){case"focusin":case"focusout":co=null;break;case"dragenter":case"dragleave":uo=null;break;case"mouseover":case"mouseout":fo=null;break;case"pointerover":case"pointerout":td.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(l.pointerId)}}function rd(a,l,h,y,S,k){return a===null||a.nativeEvent!==k?(a={blockedOn:l,domEventName:h,eventSystemFlags:y,nativeEvent:k,targetContainers:[S]},l!==null&&(l=un(l),l!==null&&Zv(l)),a):(a.eventSystemFlags|=y,l=a.targetContainers,S!==null&&l.indexOf(S)===-1&&l.push(S),a)}function Y5(a,l,h,y,S){switch(l){case"focusin":return co=rd(co,a,l,h,y,S),!0;case"dragenter":return uo=rd(uo,a,l,h,y,S),!0;case"mouseover":return fo=rd(fo,a,l,h,y,S),!0;case"pointerover":var k=S.pointerId;return td.set(k,rd(td.get(k)||null,a,l,h,y,S)),!0;case"gotpointercapture":return k=S.pointerId,nd.set(k,rd(nd.get(k)||null,a,l,h,y,S)),!0}return!1}function tC(a){var l=Yn(a.target);if(l!==null){var h=i(l);if(h!==null){if(l=h.tag,l===13){if(l=c(h),l!==null){a.blockedOn=l,De(a.priority,function(){Jv(h)});return}}else if(l===31){if(l=f(h),l!==null){a.blockedOn=l,De(a.priority,function(){Jv(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Rh(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var h=rg(a.nativeEvent);if(h===null){h=a.nativeEvent;var y=new h.constructor(h.type,h);Yo=y,h.target.dispatchEvent(y),Yo=null}else return l=un(h),l!==null&&Zv(l),a.blockedOn=h,!1;l.shift()}return!0}function nC(a,l,h){Rh(a)&&h.delete(l)}function K5(){ig=!1,co!==null&&Rh(co)&&(co=null),uo!==null&&Rh(uo)&&(uo=null),fo!==null&&Rh(fo)&&(fo=null),td.forEach(nC),nd.forEach(nC)}function Mh(a,l){a.blockedOn===l&&(a.blockedOn=null,ig||(ig=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,K5)))}var Ih=null;function rC(a){Ih!==a&&(Ih=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ih===a&&(Ih=null);for(var l=0;l<a.length;l+=3){var h=a[l],y=a[l+1],S=a[l+2];if(typeof y!="function"){if(sg(y||h)===null)continue;break}var k=un(h);k!==null&&(a.splice(l,3),l-=3,rm(k,{pending:!0,data:S,method:h.method,action:y},y,S))}}))}function kc(a){function l(Q){return Mh(Q,a)}co!==null&&Mh(co,a),uo!==null&&Mh(uo,a),fo!==null&&Mh(fo,a),td.forEach(l),nd.forEach(l);for(var h=0;h<ho.length;h++){var y=ho[h];y.blockedOn===a&&(y.blockedOn=null)}for(;0<ho.length&&(h=ho[0],h.blockedOn===null);)tC(h),h.blockedOn===null&&ho.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(y=0;y<h.length;y+=3){var S=h[y],k=h[y+1],D=S[_t]||null;if(typeof k=="function")D||rC(h);else if(D){var z=null;if(k&&k.hasAttribute("formAction")){if(S=k,D=k[_t]||null)z=D.formAction;else if(sg(S)!==null)continue}else z=D.action;typeof z=="function"?h[y+1]=z:(h.splice(y,3),y-=3),rC(h)}}}function sC(){function a(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(D){return S=D})},focusReset:"manual",scroll:"manual"})}function l(){S!==null&&(S(),S=null),y||setTimeout(h,20)}function h(){if(!y&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,S=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){y=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),S!==null&&(S(),S=null)}}}function ag(a){this._internalRoot=a}Dh.prototype.render=ag.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));var h=l.current,y=Fs();Yv(h,y,a,l,null,null)},Dh.prototype.unmount=ag.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Yv(a.current,2,null,a,null,null),ph(),l[Pr]=null}};function Dh(a){this._internalRoot=a}Dh.prototype.unstable_scheduleHydration=function(a){if(a){var l=yt();a={blockedOn:null,target:a,priority:l};for(var h=0;h<ho.length&&l!==0&&l<ho[h].priority;h++);ho.splice(h,0,a),h===0&&tC(a)}};var iC=e.version;if(iC!=="19.2.0")throw Error(r(527,iC,"19.2.0"));pe.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=g(l),a=a!==null?C(a):null,a=a===null?null:a.stateNode,a};var Z5={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lh.isDisabled&&Lh.supportsFiber)try{ln=Lh.inject(Z5),He=Lh}catch{}}return id.createRoot=function(a,l){if(!s(a))throw Error(r(299));var h=!1,y="",S=fw,k=hw,D=pw;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onUncaughtError!==void 0&&(S=l.onUncaughtError),l.onCaughtError!==void 0&&(k=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError)),l=$v(a,1,!1,null,null,h,y,null,S,k,D,sC),a[Pr]=l.current,Um(a),new ag(l)},id.hydrateRoot=function(a,l,h){if(!s(a))throw Error(r(299));var y=!1,S="",k=fw,D=hw,z=pw,Q=null;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(k=h.onUncaughtError),h.onCaughtError!==void 0&&(D=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError),h.formState!==void 0&&(Q=h.formState)),l=$v(a,1,!0,l,h??null,y,S,Q,k,D,z,sC),l.context=Xv(null),h=l.current,y=Fs(),y=ct(y),S=Za(y),S.callback=null,Ja(h,S,y),h=y,l.current.lanes=h,Oe(l,h),Li(l),a[Pr]=l.current,Um(a),new Dh(l)},id.version="19.2.0",id}var mC;function a8(){if(mC)return cg.exports;mC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),cg.exports=i8(),cg.exports}var o8=a8();const l8=M2(o8);/**
 * react-router v7.13.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var gC="popstate";function xC(t){return typeof t=="object"&&t!=null&&"pathname"in t&&"search"in t&&"hash"in t&&"state"in t&&"key"in t}function c8(t={}){function e(s,i){let{pathname:c="/",search:f="",hash:p=""}=cu(s.location.hash.substring(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),Rx("",{pathname:c,search:f,hash:p},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let c=s.document.querySelector("base"),f="";if(c&&c.getAttribute("href")){let p=s.location.href,g=p.indexOf("#");f=g===-1?p:p.slice(0,g)}return f+"#"+(typeof i=="string"?i:Ld(i))}function r(s,i){yi(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return d8(e,n,r,t)}function Tr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function u8(){return Math.random().toString(36).substring(2,10)}function bC(t,e){return{usr:t.state,key:t.key,idx:e,masked:t.unstable_mask?{pathname:t.pathname,search:t.search,hash:t.hash}:void 0}}function Rx(t,e,n=null,r,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?cu(e):e,state:n,key:e&&e.key||r||u8(),unstable_mask:s}}function Ld({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function cu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function d8(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,c=s.history,f="POP",p=null,g=C();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function C(){return(c.state||{idx:null}).idx}function v(){f="POP";let R=C(),j=R==null?null:R-g;g=R,p&&p({action:f,location:M.location,delta:j})}function A(R,j){f="PUSH";let H=xC(R)?R:Rx(M.location,R,j);n&&n(H,R),g=C()+1;let G=bC(H,g),Z=M.createHref(H.unstable_mask||H);try{c.pushState(G,"",Z)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;s.location.assign(Z)}i&&p&&p({action:f,location:M.location,delta:1})}function T(R,j){f="REPLACE";let H=xC(R)?R:Rx(M.location,R,j);n&&n(H,R),g=C();let G=bC(H,g),Z=M.createHref(H.unstable_mask||H);c.replaceState(G,"",Z),i&&p&&p({action:f,location:M.location,delta:0})}function _(R){return f8(R)}let M={get action(){return f},get location(){return t(s,c)},listen(R){if(p)throw new Error("A history only accepts one active listener");return s.addEventListener(gC,v),p=R,()=>{s.removeEventListener(gC,v),p=null}},createHref(R){return e(s,R)},createURL:_,encodeLocation(R){let j=_(R);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:A,replace:T,go(R){return c.go(R)}};return M}function f8(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Tr(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Ld(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function uA(t,e,n="/"){return h8(t,e,n,!1)}function h8(t,e,n,r){let s=typeof e=="string"?cu(e):e,i=_a(s.pathname||"/",n);if(i==null)return null;let c=dA(t);p8(c);let f=null;for(let p=0;f==null&&p<c.length;++p){let g=A8(i);f=E8(c[p],g,r)}return f}function dA(t,e=[],n=[],r="",s=!1){let i=(c,f,p=s,g)=>{let C={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};if(C.relativePath.startsWith("/")){if(!C.relativePath.startsWith(r)&&p)return;Tr(C.relativePath.startsWith(r),`Absolute route path "${C.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),C.relativePath=C.relativePath.slice(r.length)}let v=zi([r,C.relativePath]),A=n.concat(C);c.children&&c.children.length>0&&(Tr(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),dA(c.children,e,A,v,p)),!(c.path==null&&!c.index)&&e.push({path:v,score:v8(v,c.index),routesMeta:A})};return t.forEach((c,f)=>{var p;if(c.path===""||!((p=c.path)!=null&&p.includes("?")))i(c,f);else for(let g of fA(c.path))i(c,f,!0,g)}),e}function fA(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let c=fA(r.join("/")),f=[];return f.push(...c.map(p=>p===""?i:[i,p].join("/"))),s&&f.push(...c),f.map(p=>t.startsWith("/")&&p===""?"/":p)}function p8(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:C8(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var m8=/^:[\w-]+$/,g8=3,x8=2,b8=1,y8=10,w8=-2,yC=t=>t==="*";function v8(t,e){let n=t.split("/"),r=n.length;return n.some(yC)&&(r+=w8),e&&(r+=x8),n.filter(s=>!yC(s)).reduce((s,i)=>s+(m8.test(i)?g8:i===""?b8:y8),r)}function C8(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function E8(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",c=[];for(let f=0;f<r.length;++f){let p=r[f],g=f===r.length-1,C=i==="/"?e:e.slice(i.length)||"/",v=y0({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},C),A=p.route;if(!v&&g&&n&&!r[r.length-1].route.index&&(v=y0({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},C)),!v)return null;Object.assign(s,v.params),c.push({params:s,pathname:zi([i,v.pathname]),pathnameBase:O8(zi([i,v.pathnameBase])),route:A}),v.pathnameBase!=="/"&&(i=zi([i,v.pathnameBase]))}return c}function y0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=S8(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],c=i.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:r.reduce((g,{paramName:C,isOptional:v},A)=>{if(C==="*"){let _=f[A]||"";c=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const T=f[A];return v&&!T?g[C]=void 0:g[C]=(T||"").replace(/%2F/g,"/"),g},{}),pathname:i,pathnameBase:c,pattern:t}}function S8(t,e=!1,n=!0){yi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,p,g,C)=>{if(r.push({paramName:f,isOptional:p!=null}),p){let v=C.charAt(g+c.length);return v&&v!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function A8(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function _a(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var N8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function k8(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?cu(t):t,i;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?i=wC(n.substring(1),"/"):i=wC(n,e)):i=e,{pathname:i,search:_8(r),hash:R8(s)}}function wC(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function hg(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function T8(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function hA(t){let e=T8(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function I2(t,e,n,r=!1){let s;typeof t=="string"?s=cu(t):(s={...t},Tr(!s.pathname||!s.pathname.includes("?"),hg("?","pathname","search",s)),Tr(!s.pathname||!s.pathname.includes("#"),hg("#","pathname","hash",s)),Tr(!s.search||!s.search.includes("#"),hg("#","search","hash",s)));let i=t===""||s.pathname==="",c=i?"/":s.pathname,f;if(c==null)f=n;else{let v=e.length-1;if(!r&&c.startsWith("..")){let A=c.split("/");for(;A[0]==="..";)A.shift(),v-=1;s.pathname=A.join("/")}f=v>=0?e[v]:"/"}let p=k8(s,f),g=c&&c!=="/"&&c.endsWith("/"),C=(i||c===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(g||C)&&(p.pathname+="/"),p}var zi=t=>t.join("/").replace(/\/\/+/g,"/"),O8=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_8=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,R8=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,M8=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function I8(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function D8(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var pA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function mA(t,e){let n=t;if(typeof n!="string"||!N8.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,s=!1;if(pA)try{let i=new URL(window.location.href),c=n.startsWith("//")?new URL(i.protocol+n):new URL(n),f=_a(c.pathname,e);c.origin===i.origin&&f!=null?n=f+c.search+c.hash:s=!0}catch{yi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gA=["POST","PUT","PATCH","DELETE"];new Set(gA);var L8=["GET",...gA];new Set(L8);var uu=L.createContext(null);uu.displayName="DataRouter";var Lp=L.createContext(null);Lp.displayName="DataRouterState";var j8=L.createContext(!1),xA=L.createContext({isTransitioning:!1});xA.displayName="ViewTransition";var B8=L.createContext(new Map);B8.displayName="Fetchers";var P8=L.createContext(null);P8.displayName="Await";var oi=L.createContext(null);oi.displayName="Navigation";var jp=L.createContext(null);jp.displayName="Location";var Da=L.createContext({outlet:null,matches:[],isDataRoute:!1});Da.displayName="Route";var D2=L.createContext(null);D2.displayName="RouteError";var bA="REACT_ROUTER_ERROR",F8="REDIRECT",z8="ROUTE_ERROR_RESPONSE";function U8(t){if(t.startsWith(`${bA}:${F8}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function H8(t){if(t.startsWith(`${bA}:${z8}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new M8(e.status,e.statusText,e.data)}catch{}}function V8(t,{relative:e}={}){Tr(nf(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=L.useContext(oi),{hash:s,pathname:i,search:c}=rf(t,{relative:e}),f=i;return n!=="/"&&(f=i==="/"?n:zi([n,i])),r.createHref({pathname:f,search:c,hash:s})}function nf(){return L.useContext(jp)!=null}function zo(){return Tr(nf(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(jp).location}var yA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function wA(t){L.useContext(oi).static||L.useLayoutEffect(t)}function G8(){let{isDataRoute:t}=L.useContext(Da);return t?rO():W8()}function W8(){Tr(nf(),"useNavigate() may be used only in the context of a <Router> component.");let t=L.useContext(uu),{basename:e,navigator:n}=L.useContext(oi),{matches:r}=L.useContext(Da),{pathname:s}=zo(),i=JSON.stringify(hA(r)),c=L.useRef(!1);return wA(()=>{c.current=!0}),L.useCallback((p,g={})=>{if(yi(c.current,yA),!c.current)return;if(typeof p=="number"){n.go(p);return}let C=I2(p,JSON.parse(i),s,g.relative==="path");t==null&&e!=="/"&&(C.pathname=C.pathname==="/"?e:zi([e,C.pathname])),(g.replace?n.replace:n.push)(C,g.state,g)},[e,n,i,s,t])}L.createContext(null);function rf(t,{relative:e}={}){let{matches:n}=L.useContext(Da),{pathname:r}=zo(),s=JSON.stringify(hA(n));return L.useMemo(()=>I2(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function q8(t,e,n){Tr(nf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=L.useContext(oi),{matches:s}=L.useContext(Da),i=s[s.length-1],c=i?i.params:{},f=i?i.pathname:"/",p=i?i.pathnameBase:"/",g=i&&i.route;{let R=g&&g.path||"";CA(f,!g||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let C=zo(),v;v=C;let A=v.pathname||"/",T=A;if(p!=="/"){let R=p.replace(/^\//,"").split("/");T="/"+A.replace(/^\//,"").split("/").slice(R.length).join("/")}let _=uA(t,{pathname:T});return yi(g||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),yi(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Z8(_&&_.map(R=>Object.assign({},R,{params:Object.assign({},c,R.params),pathname:zi([p,r.encodeLocation?r.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:zi([p,r.encodeLocation?r.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),s,n)}function $8(){let t=nO(),e=I8(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=L.createElement(L.Fragment,null,L.createElement("p",null," Hey developer "),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:i},"ErrorBoundary")," or"," ",L.createElement("code",{style:i},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),n?L.createElement("pre",{style:s},n):null,c)}var X8=L.createElement($8,null),vA=class extends L.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=H8(t.digest);n&&(t=n)}let e=t!==void 0?L.createElement(Da.Provider,{value:this.props.routeContext},L.createElement(D2.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?L.createElement(Y8,{error:t},e):e}};vA.contextType=j8;var pg=new WeakMap;function Y8({children:t,error:e}){let{basename:n}=L.useContext(oi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=U8(e.digest);if(r){let s=pg.get(e);if(s)throw s;let i=mA(r.location,n);if(pA&&!pg.get(e))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw pg.set(e,c),c}return L.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return t}function K8({routeContext:t,match:e,children:n}){let r=L.useContext(uu);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),L.createElement(Da.Provider,{value:t},n)}function Z8(t,e=[],n){let r=n==null?void 0:n.state;if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,i=r==null?void 0:r.errors;if(i!=null){let C=s.findIndex(v=>v.route.id&&(i==null?void 0:i[v.route.id])!==void 0);Tr(C>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,C+1))}let c=!1,f=-1;if(n&&r){c=r.renderFallback;for(let C=0;C<s.length;C++){let v=s[C];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=C),v.route.id){let{loaderData:A,errors:T}=r,_=v.route.loader&&!A.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||_){n.isStatic&&(c=!0),f>=0?s=s.slice(0,f+1):s=[s[0]];break}}}}let p=n==null?void 0:n.onError,g=r&&p?(C,v)=>{var A,T;p(C,{location:r.location,params:((T=(A=r.matches)==null?void 0:A[0])==null?void 0:T.params)??{},unstable_pattern:D8(r.matches),errorInfo:v})}:void 0;return s.reduceRight((C,v,A)=>{let T,_=!1,M=null,R=null;r&&(T=i&&v.route.id?i[v.route.id]:void 0,M=v.route.errorElement||X8,c&&(f<0&&A===0?(CA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,R=null):f===A&&(_=!0,R=v.route.hydrateFallbackElement||null)));let j=e.concat(s.slice(0,A+1)),H=()=>{let G;return T?G=M:_?G=R:v.route.Component?G=L.createElement(v.route.Component,null):v.route.element?G=v.route.element:G=C,L.createElement(K8,{match:v,routeContext:{outlet:C,matches:j,isDataRoute:r!=null},children:G})};return r&&(v.route.ErrorBoundary||v.route.errorElement||A===0)?L.createElement(vA,{location:r.location,revalidation:r.revalidation,component:M,error:T,children:H(),routeContext:{outlet:null,matches:j,isDataRoute:!0},onError:g}):H()},null)}function L2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function J8(t){let e=L.useContext(uu);return Tr(e,L2(t)),e}function Q8(t){let e=L.useContext(Lp);return Tr(e,L2(t)),e}function eO(t){let e=L.useContext(Da);return Tr(e,L2(t)),e}function j2(t){let e=eO(t),n=e.matches[e.matches.length-1];return Tr(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function tO(){return j2("useRouteId")}function nO(){var r;let t=L.useContext(D2),e=Q8("useRouteError"),n=j2("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function rO(){let{router:t}=J8("useNavigate"),e=j2("useNavigate"),n=L.useRef(!1);return wA(()=>{n.current=!0}),L.useCallback(async(s,i={})=>{yi(n.current,yA),n.current&&(typeof s=="number"?await t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var vC={};function CA(t,e,n){!e&&!vC[t]&&(vC[t]=!0,yi(!1,n))}L.memo(sO);function sO({routes:t,future:e,state:n,isStatic:r,onError:s}){return q8(t,void 0,{state:n,isStatic:r,onError:s})}function iO({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:c}){Tr(!nf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=t.replace(/^\/*/,"/"),p=L.useMemo(()=>({basename:f,navigator:s,static:i,unstable_useTransitions:c,future:{}}),[f,s,i,c]);typeof n=="string"&&(n=cu(n));let{pathname:g="/",search:C="",hash:v="",state:A=null,key:T="default",unstable_mask:_}=n,M=L.useMemo(()=>{let R=_a(g,f);return R==null?null:{location:{pathname:R,search:C,hash:v,state:A,key:T,unstable_mask:_},navigationType:r}},[f,g,C,v,A,T,r,_]);return yi(M!=null,`<Router basename="${f}"> is not able to match the URL "${g}${C}${v}" because it does not start with the basename, so the <Router> won't render anything.`),M==null?null:L.createElement(oi.Provider,{value:p},L.createElement(jp.Provider,{children:e,value:M}))}var r0="get",s0="application/x-www-form-urlencoded";function Bp(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function aO(t){return Bp(t)&&t.tagName.toLowerCase()==="button"}function oO(t){return Bp(t)&&t.tagName.toLowerCase()==="form"}function lO(t){return Bp(t)&&t.tagName.toLowerCase()==="input"}function cO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uO(t,e){return t.button===0&&(!e||e==="_self")&&!cO(t)}var Bh=null;function dO(){if(Bh===null)try{new FormData(document.createElement("form"),0),Bh=!1}catch{Bh=!0}return Bh}var fO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mg(t){return t!=null&&!fO.has(t)?(yi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${s0}"`),null):t}function hO(t,e){let n,r,s,i,c;if(oO(t)){let f=t.getAttribute("action");r=f?_a(f,e):null,n=t.getAttribute("method")||r0,s=mg(t.getAttribute("enctype"))||s0,i=new FormData(t)}else if(aO(t)||lO(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||f.getAttribute("action");if(r=p?_a(p,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||r0,s=mg(t.getAttribute("formenctype"))||mg(f.getAttribute("enctype"))||s0,i=new FormData(f,t),!dO()){let{name:g,type:C,value:v}=t;if(C==="image"){let A=g?`${g}.`:"";i.append(`${A}x`,"0"),i.append(`${A}y`,"0")}else g&&i.append(g,v)}}else{if(Bp(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=r0,r=null,s=s0,c=t}return i&&s==="text/plain"&&(c=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function B2(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function pO(t,e,n,r){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${r}`:s.pathname=`${s.pathname}.${r}`:s.pathname==="/"?s.pathname=`_root.${r}`:e&&_a(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}async function mO(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gO(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function xO(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let c=await mO(i,n);return c.links?c.links():[]}return[]}));return vO(r.flat(1).filter(gO).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function CC(t,e,n,r,s,i){let c=(p,g)=>n[g]?p.route.id!==n[g].route.id:!0,f=(p,g)=>{var C;return n[g].pathname!==p.pathname||((C=n[g].route.path)==null?void 0:C.endsWith("*"))&&n[g].params["*"]!==p.params["*"]};return i==="assets"?e.filter((p,g)=>c(p,g)||f(p,g)):i==="data"?e.filter((p,g)=>{var v;let C=r.routes[p.route.id];if(!C||!C.hasLoader)return!1;if(c(p,g)||f(p,g))return!0;if(p.route.shouldRevalidate){let A=p.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function bO(t,e,{includeHydrateFallback:n}={}){return yO(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function yO(t){return[...new Set(t)]}function wO(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function vO(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(wO(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function EA(){let t=L.useContext(uu);return B2(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function CO(){let t=L.useContext(Lp);return B2(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var P2=L.createContext(void 0);P2.displayName="FrameworkContext";function SA(){let t=L.useContext(P2);return B2(t,"You must render this element inside a <HydratedRouter> element"),t}function EO(t,e){let n=L.useContext(P2),[r,s]=L.useState(!1),[i,c]=L.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:g,onMouseLeave:C,onTouchStart:v}=e,A=L.useRef(null);L.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let M=j=>{j.forEach(H=>{c(H.isIntersecting)})},R=new IntersectionObserver(M,{threshold:.5});return A.current&&R.observe(A.current),()=>{R.disconnect()}}},[t]),L.useEffect(()=>{if(r){let M=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(M)}}},[r]);let T=()=>{s(!0)},_=()=>{s(!1),c(!1)};return n?t!=="intent"?[i,A,{}]:[i,A,{onFocus:ad(f,T),onBlur:ad(p,_),onMouseEnter:ad(g,T),onMouseLeave:ad(C,_),onTouchStart:ad(v,T)}]:[!1,A,{}]}function ad(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function SO({page:t,...e}){let{router:n}=EA(),r=L.useMemo(()=>uA(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?L.createElement(NO,{page:t,matches:r,...e}):null}function AO(t){let{manifest:e,routeModules:n}=SA(),[r,s]=L.useState([]);return L.useEffect(()=>{let i=!1;return xO(t,e,n).then(c=>{i||s(c)}),()=>{i=!0}},[t,e,n]),r}function NO({page:t,matches:e,...n}){let r=zo(),{future:s,manifest:i,routeModules:c}=SA(),{basename:f}=EA(),{loaderData:p,matches:g}=CO(),C=L.useMemo(()=>CC(t,e,g,i,r,"data"),[t,e,g,i,r]),v=L.useMemo(()=>CC(t,e,g,i,r,"assets"),[t,e,g,i,r]),A=L.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let M=new Set,R=!1;if(e.forEach(H=>{var Z;let G=i.routes[H.route.id];!G||!G.hasLoader||(!C.some(J=>J.route.id===H.route.id)&&H.route.id in p&&((Z=c[H.route.id])!=null&&Z.shouldRevalidate)||G.hasClientLoader?R=!0:M.add(H.route.id))}),M.size===0)return[];let j=pO(t,f,s.unstable_trailingSlashAwareDataRequests,"data");return R&&M.size>0&&j.searchParams.set("_routes",e.filter(H=>M.has(H.route.id)).map(H=>H.route.id).join(",")),[j.pathname+j.search]},[f,s.unstable_trailingSlashAwareDataRequests,p,r,i,C,e,t,c]),T=L.useMemo(()=>bO(v,i),[v,i]),_=AO(v);return L.createElement(L.Fragment,null,A.map(M=>L.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...n})),T.map(M=>L.createElement("link",{key:M,rel:"modulepreload",href:M,...n})),_.map(({key:M,link:R})=>L.createElement("link",{key:M,nonce:n.nonce,...R,crossOrigin:R.crossOrigin??n.crossOrigin})))}function kO(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var TO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{TO&&(window.__reactRouterVersion="7.13.1")}catch{}function OO({basename:t,children:e,unstable_useTransitions:n,window:r}){let s=L.useRef();s.current==null&&(s.current=c8({window:r,v5Compat:!0}));let i=s.current,[c,f]=L.useState({action:i.action,location:i.location}),p=L.useCallback(g=>{n===!1?f(g):L.startTransition(()=>f(g))},[n]);return L.useLayoutEffect(()=>i.listen(p),[i,p]),L.createElement(iO,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:i,unstable_useTransitions:n})}var AA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NA=L.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:c,unstable_mask:f,state:p,target:g,to:C,preventScrollReset:v,viewTransition:A,unstable_defaultShouldRevalidate:T,..._},M){let{basename:R,navigator:j,unstable_useTransitions:H}=L.useContext(oi),G=typeof C=="string"&&AA.test(C),Z=mA(C,R);C=Z.to;let J=V8(C,{relative:s}),oe=zo(),U=null;if(f){let ne=I2(f,[],oe.unstable_mask?oe.unstable_mask.pathname:"/",!0);R!=="/"&&(ne.pathname=ne.pathname==="/"?R:zi([R,ne.pathname])),U=j.createHref(ne)}let[ee,X,Qe]=EO(r,_),je=IO(C,{replace:c,unstable_mask:f,state:p,target:g,preventScrollReset:v,relative:s,viewTransition:A,unstable_defaultShouldRevalidate:T,unstable_useTransitions:H});function ue(ne){e&&e(ne),ne.defaultPrevented||je(ne)}let Ie=!(Z.isExternal||i),Ze=L.createElement("a",{..._,...Qe,href:(Ie?U:void 0)||Z.absoluteURL||J,onClick:Ie?ue:e,ref:kO(M,X),target:g,"data-discover":!G&&n==="render"?"true":void 0});return ee&&!G?L.createElement(L.Fragment,null,Ze,L.createElement(SO,{page:J})):Ze});NA.displayName="Link";var _O=L.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:c,viewTransition:f,children:p,...g},C){let v=rf(c,{relative:g.relative}),A=zo(),T=L.useContext(Lp),{navigator:_,basename:M}=L.useContext(oi),R=T!=null&&PO(v)&&f===!0,j=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,H=A.pathname,G=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(H=H.toLowerCase(),G=G?G.toLowerCase():null,j=j.toLowerCase()),G&&M&&(G=_a(G,M)||G);const Z=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let J=H===j||!s&&H.startsWith(j)&&H.charAt(Z)==="/",oe=G!=null&&(G===j||!s&&G.startsWith(j)&&G.charAt(j.length)==="/"),U={isActive:J,isPending:oe,isTransitioning:R},ee=J?e:void 0,X;typeof r=="function"?X=r(U):X=[r,J?"active":null,oe?"pending":null,R?"transitioning":null].filter(Boolean).join(" ");let Qe=typeof i=="function"?i(U):i;return L.createElement(NA,{...g,"aria-current":ee,className:X,ref:C,style:Qe,to:c,viewTransition:f},typeof p=="function"?p(U):p)});_O.displayName="NavLink";var RO=L.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:c=r0,action:f,onSubmit:p,relative:g,preventScrollReset:C,viewTransition:v,unstable_defaultShouldRevalidate:A,...T},_)=>{let{unstable_useTransitions:M}=L.useContext(oi),R=jO(),j=BO(f,{relative:g}),H=c.toLowerCase()==="get"?"get":"post",G=typeof f=="string"&&AA.test(f),Z=J=>{if(p&&p(J),J.defaultPrevented)return;J.preventDefault();let oe=J.nativeEvent.submitter,U=(oe==null?void 0:oe.getAttribute("formmethod"))||c,ee=()=>R(oe||J.currentTarget,{fetcherKey:e,method:U,navigate:n,replace:s,state:i,relative:g,preventScrollReset:C,viewTransition:v,unstable_defaultShouldRevalidate:A});M&&n!==!1?L.startTransition(()=>ee()):ee()};return L.createElement("form",{ref:_,method:H,action:j,onSubmit:r?p:Z,...T,"data-discover":!G&&t==="render"?"true":void 0})});RO.displayName="Form";function MO(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kA(t){let e=L.useContext(uu);return Tr(e,MO(t)),e}function IO(t,{target:e,replace:n,unstable_mask:r,state:s,preventScrollReset:i,relative:c,viewTransition:f,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let C=G8(),v=zo(),A=rf(t,{relative:c});return L.useCallback(T=>{if(uO(T,e)){T.preventDefault();let _=n!==void 0?n:Ld(v)===Ld(A),M=()=>C(t,{replace:_,unstable_mask:r,state:s,preventScrollReset:i,relative:c,viewTransition:f,unstable_defaultShouldRevalidate:p});g?L.startTransition(()=>M()):M()}},[v,C,A,n,r,s,e,t,i,c,f,p,g])}var DO=0,LO=()=>`__${String(++DO)}__`;function jO(){let{router:t}=kA("useSubmit"),{basename:e}=L.useContext(oi),n=tO(),r=t.fetch,s=t.navigate;return L.useCallback(async(i,c={})=>{let{action:f,method:p,encType:g,formData:C,body:v}=hO(i,e);if(c.navigate===!1){let A=c.fetcherKey||LO();await r(A,n,c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:C,body:v,formMethod:c.method||p,formEncType:c.encType||g,flushSync:c.flushSync})}else await s(c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:C,body:v,formMethod:c.method||p,formEncType:c.encType||g,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[r,s,e,n])}function BO(t,{relative:e}={}){let{basename:n}=L.useContext(oi),r=L.useContext(Da);Tr(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...rf(t||".",{relative:e})},c=zo();if(t==null){i.search=c.search;let f=new URLSearchParams(i.search),p=f.getAll("index");if(p.some(C=>C==="")){f.delete("index"),p.filter(v=>v).forEach(v=>f.append("index",v));let C=f.toString();i.search=C?`?${C}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:zi([n,i.pathname])),Ld(i)}function PO(t,{relative:e}={}){let n=L.useContext(xA);Tr(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=kA("useViewTransitionState"),s=rf(t,{relative:e});if(!n.isTransitioning)return!1;let i=_a(n.currentLocation.pathname,r)||n.currentLocation.pathname,c=_a(n.nextLocation.pathname,r)||n.nextLocation.pathname;return y0(s.pathname,c)!=null||y0(s.pathname,i)!=null}var Lc=cA();const FO=M2(Lc),zO="modulepreload",UO=function(t){return"/"+t},EC={},$c=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let c=function(g){return Promise.all(g.map(C=>Promise.resolve(C).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));s=c(n.map(g=>{if(g=UO(g),g in EC)return;EC[g]=!0;const C=g.endsWith(".css"),v=C?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${v}`))return;const A=document.createElement("link");if(A.rel=C?"stylesheet":zO,C||(A.as="script"),A.crossOrigin="",A.href=g,p&&A.setAttribute("nonce",p),document.head.appendChild(A),C)return new Promise((T,_)=>{A.addEventListener("load",T),A.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${g}`)))})}))}function i(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return s.then(c=>{for(const f of c||[])f.status==="rejected"&&i(f.reason);return e().catch(i)})};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VO=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),SC=t=>{const e=VO(t);return e.charAt(0).toUpperCase()+e.slice(1)},TA=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),GO=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=L.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:c,...f},p)=>L.createElement("svg",{ref:p,...WO,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:TA("lucide",s),...!i&&!GO(f)&&{"aria-hidden":"true"},...f},[...c.map(([g,C])=>L.createElement(g,C)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=(t,e)=>{const n=L.forwardRef(({className:r,...s},i)=>L.createElement(qO,{ref:i,iconNode:e,className:TA(`lucide-${HO(SC(t))}`,`lucide-${t}`,r),...s}));return n.displayName=SC(t),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],OA=Je("arrow-left",$O);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],YO=Je("arrow-up-down",XO);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],ZO=Je("bold",KO);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Tl=Je("book-open",JO);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],F2=Je("book",QO);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],AC=Je("bot",e_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],n_=Je("brain",t_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Xc=Je("calendar",r_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],jl=Je("camera",s_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],z2=Je("check",i_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Cl=Je("chevron-down",a_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Mo=Je("chevron-left",o_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_A=Je("chevron-right",l_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],RA=Je("chevron-up",c_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Yc=Je("circle-alert",u_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jd=Je("circle-check-big",d_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],h_=Je("circle-question-mark",f_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],m_=Je("clock-3",p_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],x_=Je("clock",g_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],y_=Je("columns-3",b_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],MA=Je("compass",w_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],C_=Je("database",v_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],S_=Je("download",E_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],N_=Je("eraser",A_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Pp=Je("external-link",k_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],NC=Je("eye",T_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],IA=Je("file-braces",O_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],R_=Je("file-search",__);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],sf=Je("file-text",M_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],D_=Je("folder-plus",I_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],kC=Je("folder",L_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],B_=Je("funnel",j_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],F_=Je("gauge",P_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Fp=Je("globe",z_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],TC=Je("grip-vertical",U_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],w0=Je("hash",H_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],G_=Je("heading-1",V_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],q_=Je("heading-2",W_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],OC=Je("image",$_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Y_=Je("info",X_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Z_=Je("italic",K_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Q_=Je("layers",J_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],DA=Je("layout-panel-left",eR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],LA=Je("library",tR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],_C=Je("link",nR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],RC=Je("list-filter",rR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],iR=Je("list-ordered",sR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],oR=Je("list",aR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mr=Je("loader-circle",lR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],uR=Je("log-out",cR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],fR=Je("map-pin",dR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],pR=Je("menu",hR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Mx=Je("message-circle",mR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],xR=Je("moon",gR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],yR=Je("palette",bR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],v0=Je("pen-tool",wR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],C0=Je("pen",vR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],MC=Je("pencil-line",CR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],SR=Je("pencil",ER);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],jA=Je("play",AR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ix=Je("plus",NR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],Bd=Je("quote",kR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],BA=Je("rotate-ccw",TR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],_R=Je("rows-3",OR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],MR=Je("save",RR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],DR=Je("scan-line",IR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ea=Je("search",LR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],BR=Je("send",jR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],gg=Je("settings-2",PR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],zR=Je("skip-forward",FR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],HR=Je("sliders-horizontal",UR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],ka=Je("sparkles",VR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],WR=Je("square-check-big",GR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],$R=Je("square",qR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Tc=Je("star",XR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],Kc=Je("sticky-note",YR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ZR=Je("sun",KR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],QR=Je("table-2",JR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],tM=Je("thumbs-down",eM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],rM=Je("thumbs-up",nM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ol=Je("trash-2",sM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],To=Je("triangle-alert",iM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],oM=Je("type",aM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],cM=Je("underline",lM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],E0=Je("upload",uM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],U2=Je("user",dM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],hM=Je("wand-sparkles",fM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wi=Je("x",pM),zp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function du(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function H2(t){return"nodeType"in t}function ps(t){var e,n;return t?du(t)?t:H2(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function V2(t){const{Document:e}=ps(t);return t instanceof e}function af(t){return du(t)?!1:t instanceof ps(t).HTMLElement}function PA(t){return t instanceof ps(t).SVGElement}function fu(t){return t?du(t)?t.document:H2(t)?V2(t)?t:af(t)||PA(t)?t.ownerDocument:document:document:document}const Ra=zp?L.useLayoutEffect:L.useEffect;function Up(t){const e=L.useRef(t);return Ra(()=>{e.current=t}),L.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function mM(){const t=L.useRef(null),e=L.useCallback((r,s)=>{t.current=setInterval(r,s)},[]),n=L.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Pd(t,e){e===void 0&&(e=[t]);const n=L.useRef(t);return Ra(()=>{n.current!==t&&(n.current=t)},e),n}function of(t,e){const n=L.useRef();return L.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function S0(t){const e=Up(t),n=L.useRef(null),r=L.useCallback(s=>{s!==n.current&&(e==null||e(s,n.current)),n.current=s},[]);return[n,r]}function A0(t){const e=L.useRef();return L.useEffect(()=>{e.current=t},[t]),e.current}let xg={};function Hp(t,e){return L.useMemo(()=>{if(e)return e;const n=xg[t]==null?0:xg[t]+1;return xg[t]=n,t+"-"+n},[t,e])}function FA(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,c)=>{const f=Object.entries(c);for(const[p,g]of f){const C=i[p];C!=null&&(i[p]=C+t*g)}return i},{...e})}}const zc=FA(1),N0=FA(-1);function gM(t){return"clientX"in t&&"clientY"in t}function G2(t){if(!t)return!1;const{KeyboardEvent:e}=ps(t.target);return e&&t instanceof e}function xM(t){if(!t)return!1;const{TouchEvent:e}=ps(t.target);return e&&t instanceof e}function k0(t){if(xM(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return gM(t)?{x:t.clientX,y:t.clientY}:null}const Zc=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[Zc.Translate.toString(t),Zc.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),IC="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function bM(t){return t.matches(IC)?t:t.querySelector(IC)}const yM={display:"none"};function wM(t){let{id:e,value:n}=t;return It.createElement("div",{id:e,style:yM},n)}function vM(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return It.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function CM(){const[t,e]=L.useState("");return{announce:L.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const zA=L.createContext(null);function EM(t){const e=L.useContext(zA);L.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function SM(){const[t]=L.useState(()=>new Set),e=L.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[L.useCallback(r=>{let{type:s,event:i}=r;t.forEach(c=>{var f;return(f=c[s])==null?void 0:f.call(c,i)})},[t]),e]}const AM={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},NM={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function kM(t){let{announcements:e=NM,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=AM}=t;const{announce:i,announcement:c}=CM(),f=Hp("DndLiveRegion"),[p,g]=L.useState(!1);if(L.useEffect(()=>{g(!0)},[]),EM(L.useMemo(()=>({onDragStart(v){let{active:A}=v;i(e.onDragStart({active:A}))},onDragMove(v){let{active:A,over:T}=v;e.onDragMove&&i(e.onDragMove({active:A,over:T}))},onDragOver(v){let{active:A,over:T}=v;i(e.onDragOver({active:A,over:T}))},onDragEnd(v){let{active:A,over:T}=v;i(e.onDragEnd({active:A,over:T}))},onDragCancel(v){let{active:A,over:T}=v;i(e.onDragCancel({active:A,over:T}))}}),[i,e])),!p)return null;const C=It.createElement(It.Fragment,null,It.createElement(wM,{id:r,value:s.draggable}),It.createElement(vM,{id:f,announcement:c}));return n?Lc.createPortal(C,n):C}var kr;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(kr||(kr={}));function T0(){}function DC(t,e){return L.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function TM(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return L.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const vi=Object.freeze({x:0,y:0});function OM(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function _M(t,e){const n=k0(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function RM(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function MM(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function IM(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function LC(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const DM=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=LC(e,e.left,e.top),i=[];for(const c of r){const{id:f}=c,p=n.get(f);if(p){const g=OM(LC(p),s);i.push({id:f,data:{droppableContainer:c,value:g}})}}return i.sort(RM)};function LM(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),i=Math.min(e.top+e.height,t.top+t.height),c=s-r,f=i-n;if(r<s&&n<i){const p=e.width*e.height,g=t.width*t.height,C=c*f,v=C/(p+g-C);return Number(v.toFixed(4))}return 0}const jM=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=[];for(const i of r){const{id:c}=i,f=n.get(c);if(f){const p=LM(f,e);p>0&&s.push({id:c,data:{droppableContainer:i,value:p}})}}return s.sort(MM)};function BM(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function UA(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:vi}function PM(t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((c,f)=>({...c,top:c.top+t*f.y,bottom:c.bottom+t*f.y,left:c.left+t*f.x,right:c.right+t*f.x}),{...n})}}const FM=PM(1);function HA(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function zM(t,e,n){const r=HA(e);if(!r)return t;const{scaleX:s,scaleY:i,x:c,y:f}=r,p=t.left-c-(1-s)*parseFloat(n),g=t.top-f-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),C=s?t.width/s:t.width,v=i?t.height/i:t.height;return{width:C,height:v,top:g,right:p+C,bottom:g+v,left:p}}const UM={ignoreTransform:!1};function lf(t,e){e===void 0&&(e=UM);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:g,transformOrigin:C}=ps(t).getComputedStyle(t);g&&(n=zM(n,g,C))}const{top:r,left:s,width:i,height:c,bottom:f,right:p}=n;return{top:r,left:s,width:i,height:c,bottom:f,right:p}}function jC(t){return lf(t,{ignoreTransform:!0})}function HM(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function VM(t,e){return e===void 0&&(e=ps(t).getComputedStyle(t)),e.position==="fixed"}function GM(t,e){e===void 0&&(e=ps(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=e[s];return typeof i=="string"?n.test(i):!1})}function W2(t,e){const n=[];function r(s){if(e!=null&&n.length>=e||!s)return n;if(V2(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!af(s)||PA(s)||n.includes(s))return n;const i=ps(t).getComputedStyle(s);return s!==t&&GM(s,i)&&n.push(s),VM(s,i)?n:r(s.parentNode)}return t?r(t):n}function VA(t){const[e]=W2(t,1);return e??null}function bg(t){return!zp||!t?null:du(t)?t:H2(t)?V2(t)||t===fu(t).scrollingElement?window:af(t)?t:null:null}function GA(t){return du(t)?t.scrollX:t.scrollLeft}function WA(t){return du(t)?t.scrollY:t.scrollTop}function Dx(t){return{x:GA(t),y:WA(t)}}var _r;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(_r||(_r={}));function qA(t){return!zp||!t?!1:t===document.scrollingElement}function $A(t){const e={x:0,y:0},n=qA(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},s=t.scrollTop<=e.y,i=t.scrollLeft<=e.x,c=t.scrollTop>=r.y,f=t.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:c,isRight:f,maxScroll:r,minScroll:e}}const WM={x:.2,y:.2};function qM(t,e,n,r,s){let{top:i,left:c,right:f,bottom:p}=n;r===void 0&&(r=10),s===void 0&&(s=WM);const{isTop:g,isBottom:C,isLeft:v,isRight:A}=$A(t),T={x:0,y:0},_={x:0,y:0},M={height:e.height*s.y,width:e.width*s.x};return!g&&i<=e.top+M.height?(T.y=_r.Backward,_.y=r*Math.abs((e.top+M.height-i)/M.height)):!C&&p>=e.bottom-M.height&&(T.y=_r.Forward,_.y=r*Math.abs((e.bottom-M.height-p)/M.height)),!A&&f>=e.right-M.width?(T.x=_r.Forward,_.x=r*Math.abs((e.right-M.width-f)/M.width)):!v&&c<=e.left+M.width&&(T.x=_r.Backward,_.x=r*Math.abs((e.left+M.width-c)/M.width)),{direction:T,speed:_}}function $M(t){if(t===document.scrollingElement){const{innerWidth:i,innerHeight:c}=window;return{top:0,left:0,right:i,bottom:c,width:i,height:c}}const{top:e,left:n,right:r,bottom:s}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:s,width:t.clientWidth,height:t.clientHeight}}function XA(t){return t.reduce((e,n)=>zc(e,Dx(n)),vi)}function XM(t){return t.reduce((e,n)=>e+GA(n),0)}function YM(t){return t.reduce((e,n)=>e+WA(n),0)}function YA(t,e){if(e===void 0&&(e=lf),!t)return;const{top:n,left:r,bottom:s,right:i}=e(t);VA(t)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const KM=[["x",["left","right"],XM],["y",["top","bottom"],YM]];class q2{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=W2(n),s=XA(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,c,f]of KM)for(const p of c)Object.defineProperty(this,p,{get:()=>{const g=f(r),C=s[i]-g;return this.rect[p]+C},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class bd{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var s;(s=this.target)==null||s.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function ZM(t){const{EventTarget:e}=ps(t);return t instanceof e?t:fu(t)}function yg(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var ni;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(ni||(ni={}));function BC(t){t.preventDefault()}function JM(t){t.stopPropagation()}var Dn;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Dn||(Dn={}));const KA={start:[Dn.Space,Dn.Enter],cancel:[Dn.Esc],end:[Dn.Space,Dn.Enter,Dn.Tab]},QM=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Dn.Right:return{...n,x:n.x+25};case Dn.Left:return{...n,x:n.x-25};case Dn.Down:return{...n,y:n.y+25};case Dn.Up:return{...n,y:n.y-25}}};class ZA{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new bd(fu(n)),this.windowListeners=new bd(ps(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ni.Resize,this.handleCancel),this.windowListeners.add(ni.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ni.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&YA(r),n(vi)}handleKeyDown(e){if(G2(e)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=KA,coordinateGetter:c=QM,scrollBehavior:f="smooth"}=s,{code:p}=e;if(i.end.includes(p)){this.handleEnd(e);return}if(i.cancel.includes(p)){this.handleCancel(e);return}const{collisionRect:g}=r.current,C=g?{x:g.left,y:g.top}:vi;this.referenceCoordinates||(this.referenceCoordinates=C);const v=c(e,{active:n,context:r.current,currentCoordinates:C});if(v){const A=N0(v,C),T={x:0,y:0},{scrollableAncestors:_}=r.current;for(const M of _){const R=e.code,{isTop:j,isRight:H,isLeft:G,isBottom:Z,maxScroll:J,minScroll:oe}=$A(M),U=$M(M),ee={x:Math.min(R===Dn.Right?U.right-U.width/2:U.right,Math.max(R===Dn.Right?U.left:U.left+U.width/2,v.x)),y:Math.min(R===Dn.Down?U.bottom-U.height/2:U.bottom,Math.max(R===Dn.Down?U.top:U.top+U.height/2,v.y))},X=R===Dn.Right&&!H||R===Dn.Left&&!G,Qe=R===Dn.Down&&!Z||R===Dn.Up&&!j;if(X&&ee.x!==v.x){const je=M.scrollLeft+A.x,ue=R===Dn.Right&&je<=J.x||R===Dn.Left&&je>=oe.x;if(ue&&!A.y){M.scrollTo({left:je,behavior:f});return}ue?T.x=M.scrollLeft-je:T.x=R===Dn.Right?M.scrollLeft-J.x:M.scrollLeft-oe.x,T.x&&M.scrollBy({left:-T.x,behavior:f});break}else if(Qe&&ee.y!==v.y){const je=M.scrollTop+A.y,ue=R===Dn.Down&&je<=J.y||R===Dn.Up&&je>=oe.y;if(ue&&!A.x){M.scrollTo({top:je,behavior:f});return}ue?T.y=M.scrollTop-je:T.y=R===Dn.Down?M.scrollTop-J.y:M.scrollTop-oe.y,T.y&&M.scrollBy({top:-T.y,behavior:f});break}}this.handleMove(e,zc(N0(v,this.referenceCoordinates),T))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ZA.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=KA,onActivation:s}=e,{active:i}=n;const{code:c}=t.nativeEvent;if(r.start.includes(c)){const f=i.activatorNode.current;return f&&t.target!==f?!1:(t.preventDefault(),s==null||s({event:t.nativeEvent}),!0)}return!1}}];function PC(t){return!!(t&&"distance"in t)}function FC(t){return!!(t&&"delay"in t)}class $2{constructor(e,n,r){var s;r===void 0&&(r=ZM(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:i}=e,{target:c}=i;this.props=e,this.events=n,this.document=fu(c),this.documentListeners=new bd(this.document),this.listeners=new bd(r),this.windowListeners=new bd(ps(c)),this.initialCoordinates=(s=k0(i))!=null?s:vi,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ni.Resize,this.handleCancel),this.windowListeners.add(ni.DragStart,BC),this.windowListeners.add(ni.VisibilityChange,this.handleCancel),this.windowListeners.add(ni.ContextMenu,BC),this.documentListeners.add(ni.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(FC(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(PC(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(ni.Click,JM,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ni.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:c,options:{activationConstraint:f}}=i;if(!s)return;const p=(n=k0(e))!=null?n:vi,g=N0(s,p);if(!r&&f){if(PC(f)){if(f.tolerance!=null&&yg(g,f.tolerance))return this.handleCancel();if(yg(g,f.distance))return this.handleStart()}if(FC(f)&&yg(g,f.tolerance))return this.handleCancel();this.handlePending(f,g);return}e.cancelable&&e.preventDefault(),c(p)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Dn.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const eI={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class X2 extends $2{constructor(e){const{event:n}=e,r=fu(n.target);super(e,eI,r)}}X2.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const tI={move:{name:"mousemove"},end:{name:"mouseup"}};var Lx;(function(t){t[t.RightClick=2]="RightClick"})(Lx||(Lx={}));class nI extends $2{constructor(e){super(e,tI,fu(e.event.target))}}nI.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Lx.RightClick?!1:(r==null||r({event:n}),!0)}}];const wg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class JA extends $2{constructor(e){super(e,wg)}static setup(){return window.addEventListener(wg.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(wg.move.name,e)};function e(){}}}JA.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var yd;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(yd||(yd={}));var O0;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(O0||(O0={}));function rI(t){let{acceleration:e,activator:n=yd.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:c=5,order:f=O0.TreeOrder,pointerCoordinates:p,scrollableAncestors:g,scrollableAncestorRects:C,delta:v,threshold:A}=t;const T=iI({delta:v,disabled:!i}),[_,M]=mM(),R=L.useRef({x:0,y:0}),j=L.useRef({x:0,y:0}),H=L.useMemo(()=>{switch(n){case yd.Pointer:return p?{top:p.y,bottom:p.y,left:p.x,right:p.x}:null;case yd.DraggableRect:return s}},[n,s,p]),G=L.useRef(null),Z=L.useCallback(()=>{const oe=G.current;if(!oe)return;const U=R.current.x*j.current.x,ee=R.current.y*j.current.y;oe.scrollBy(U,ee)},[]),J=L.useMemo(()=>f===O0.TreeOrder?[...g].reverse():g,[f,g]);L.useEffect(()=>{if(!i||!g.length||!H){M();return}for(const oe of J){if((r==null?void 0:r(oe))===!1)continue;const U=g.indexOf(oe),ee=C[U];if(!ee)continue;const{direction:X,speed:Qe}=qM(oe,ee,H,e,A);for(const je of["x","y"])T[je][X[je]]||(Qe[je]=0,X[je]=0);if(Qe.x>0||Qe.y>0){M(),G.current=oe,_(Z,c),R.current=Qe,j.current=X;return}}R.current={x:0,y:0},j.current={x:0,y:0},M()},[e,Z,r,M,i,c,JSON.stringify(H),JSON.stringify(T),_,g,J,C,JSON.stringify(A)])}const sI={x:{[_r.Backward]:!1,[_r.Forward]:!1},y:{[_r.Backward]:!1,[_r.Forward]:!1}};function iI(t){let{delta:e,disabled:n}=t;const r=A0(e);return of(s=>{if(n||!r||!s)return sI;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[_r.Backward]:s.x[_r.Backward]||i.x===-1,[_r.Forward]:s.x[_r.Forward]||i.x===1},y:{[_r.Backward]:s.y[_r.Backward]||i.y===-1,[_r.Forward]:s.y[_r.Forward]||i.y===1}}},[n,e,r])}function aI(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return of(s=>{var i;return e==null?null:(i=r??s)!=null?i:null},[r,e])}function oI(t,e){return L.useMemo(()=>t.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(c=>({eventName:c.eventName,handler:e(c.handler,r)}));return[...n,...i]},[]),[t,e])}var Fd;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Fd||(Fd={}));var jx;(function(t){t.Optimized="optimized"})(jx||(jx={}));const zC=new Map;function lI(t,e){let{dragging:n,dependencies:r,config:s}=e;const[i,c]=L.useState(null),{frequency:f,measure:p,strategy:g}=s,C=L.useRef(t),v=R(),A=Pd(v),T=L.useCallback(function(j){j===void 0&&(j=[]),!A.current&&c(H=>H===null?j:H.concat(j.filter(G=>!H.includes(G))))},[A]),_=L.useRef(null),M=of(j=>{if(v&&!n)return zC;if(!j||j===zC||C.current!==t||i!=null){const H=new Map;for(let G of t){if(!G)continue;if(i&&i.length>0&&!i.includes(G.id)&&G.rect.current){H.set(G.id,G.rect.current);continue}const Z=G.node.current,J=Z?new q2(p(Z),Z):null;G.rect.current=J,J&&H.set(G.id,J)}return H}return j},[t,i,n,v,p]);return L.useEffect(()=>{C.current=t},[t]),L.useEffect(()=>{v||T()},[n,v]),L.useEffect(()=>{i&&i.length>0&&c(null)},[JSON.stringify(i)]),L.useEffect(()=>{v||typeof f!="number"||_.current!==null||(_.current=setTimeout(()=>{T(),_.current=null},f))},[f,v,T,...r]),{droppableRects:M,measureDroppableContainers:T,measuringScheduled:i!=null};function R(){switch(g){case Fd.Always:return!1;case Fd.BeforeDragging:return n;default:return!n}}}function Y2(t,e){return of(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function cI(t,e){return Y2(t,e)}function uI(t){let{callback:e,disabled:n}=t;const r=Up(e),s=L.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return L.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Vp(t){let{callback:e,disabled:n}=t;const r=Up(e),s=L.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return L.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function dI(t){return new q2(lf(t),t)}function UC(t,e,n){e===void 0&&(e=dI);const[r,s]=L.useState(null);function i(){s(p=>{if(!t)return null;if(t.isConnected===!1){var g;return(g=p??n)!=null?g:null}const C=e(t);return JSON.stringify(p)===JSON.stringify(C)?p:C})}const c=uI({callback(p){if(t)for(const g of p){const{type:C,target:v}=g;if(C==="childList"&&v instanceof HTMLElement&&v.contains(t)){i();break}}}}),f=Vp({callback:i});return Ra(()=>{i(),t?(f==null||f.observe(t),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(f==null||f.disconnect(),c==null||c.disconnect())},[t]),r}function fI(t){const e=Y2(t);return UA(t,e)}const HC=[];function hI(t){const e=L.useRef(t),n=of(r=>t?r&&r!==HC&&t&&e.current&&t.parentNode===e.current.parentNode?r:W2(t):HC,[t]);return L.useEffect(()=>{e.current=t},[t]),n}function pI(t){const[e,n]=L.useState(null),r=L.useRef(t),s=L.useCallback(i=>{const c=bg(i.target);c&&n(f=>f?(f.set(c,Dx(c)),new Map(f)):null)},[]);return L.useEffect(()=>{const i=r.current;if(t!==i){c(i);const f=t.map(p=>{const g=bg(p);return g?(g.addEventListener("scroll",s,{passive:!0}),[g,Dx(g)]):null}).filter(p=>p!=null);n(f.length?new Map(f):null),r.current=t}return()=>{c(t),c(i)};function c(f){f.forEach(p=>{const g=bg(p);g==null||g.removeEventListener("scroll",s)})}},[s,t]),L.useMemo(()=>t.length?e?Array.from(e.values()).reduce((i,c)=>zc(i,c),vi):XA(t):vi,[t,e])}function VC(t,e){e===void 0&&(e=[]);const n=L.useRef(null);return L.useEffect(()=>{n.current=null},e),L.useEffect(()=>{const r=t!==vi;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?N0(t,n.current):vi}function mI(t){L.useEffect(()=>{if(!zp)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function gI(t,e){return L.useMemo(()=>t.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=c=>{i(c,e)},n},{}),[t,e])}function QA(t){return L.useMemo(()=>t?HM(t):null,[t])}const GC=[];function xI(t,e){e===void 0&&(e=lf);const[n]=t,r=QA(n?ps(n):null),[s,i]=L.useState(GC);function c(){i(()=>t.length?t.map(p=>qA(p)?r:new q2(e(p),p)):GC)}const f=Vp({callback:c});return Ra(()=>{f==null||f.disconnect(),c(),t.forEach(p=>f==null?void 0:f.observe(p))},[t]),s}function eN(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return af(e)?e:t}function bI(t){let{measure:e}=t;const[n,r]=L.useState(null),s=L.useCallback(g=>{for(const{target:C}of g)if(af(C)){r(v=>{const A=e(C);return v?{...v,width:A.width,height:A.height}:A});break}},[e]),i=Vp({callback:s}),c=L.useCallback(g=>{const C=eN(g);i==null||i.disconnect(),C&&(i==null||i.observe(C)),r(C?e(C):null)},[e,i]),[f,p]=S0(c);return L.useMemo(()=>({nodeRef:f,rect:n,setRef:p}),[n,f,p])}const yI=[{sensor:X2,options:{}},{sensor:ZA,options:{}}],wI={current:{}},i0={draggable:{measure:jC},droppable:{measure:jC,strategy:Fd.WhileDragging,frequency:jx.Optimized},dragOverlay:{measure:lf}};class wd extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const vI={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new wd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:T0},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:i0,measureDroppableContainers:T0,windowRect:null,measuringScheduled:!1},tN={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:T0,draggableNodes:new Map,over:null,measureDroppableContainers:T0},cf=L.createContext(tN),nN=L.createContext(vI);function CI(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new wd}}}function EI(t,e){switch(e.type){case kr.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case kr.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case kr.DragEnd:case kr.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case kr.RegisterDroppable:{const{element:n}=e,{id:r}=n,s=new wd(t.droppable.containers);return s.set(r,n),{...t,droppable:{...t.droppable,containers:s}}}case kr.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const c=new wd(t.droppable.containers);return c.set(n,{...i,disabled:s}),{...t,droppable:{...t.droppable,containers:c}}}case kr.UnregisterDroppable:{const{id:n,key:r}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const i=new wd(t.droppable.containers);return i.delete(n),{...t,droppable:{...t.droppable,containers:i}}}default:return t}}function SI(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:s}=L.useContext(cf),i=A0(r),c=A0(n==null?void 0:n.id);return L.useEffect(()=>{if(!e&&!r&&i&&c!=null){if(!G2(i)||document.activeElement===i.target)return;const f=s.get(c);if(!f)return;const{activatorNode:p,node:g}=f;if(!p.current&&!g.current)return;requestAnimationFrame(()=>{for(const C of[p.current,g.current]){if(!C)continue;const v=bM(C);if(v){v.focus();break}}})}},[r,e,s,c,i]),null}function rN(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((s,i)=>i({transform:s,...r}),n):n}function AI(t){return L.useMemo(()=>({draggable:{...i0.draggable,...t==null?void 0:t.draggable},droppable:{...i0.droppable,...t==null?void 0:t.droppable},dragOverlay:{...i0.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function NI(t){let{activeNode:e,measure:n,initialRect:r,config:s=!0}=t;const i=L.useRef(!1),{x:c,y:f}=typeof s=="boolean"?{x:s,y:s}:s;Ra(()=>{if(!c&&!f||!e){i.current=!1;return}if(i.current||!r)return;const g=e==null?void 0:e.node.current;if(!g||g.isConnected===!1)return;const C=n(g),v=UA(C,r);if(c||(v.x=0),f||(v.y=0),i.current=!0,Math.abs(v.x)>0||Math.abs(v.y)>0){const A=VA(g);A&&A.scrollBy({top:v.y,left:v.x})}},[e,c,f,r,n])}const Gp=L.createContext({...vi,scaleX:1,scaleY:1});var bo;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(bo||(bo={}));const kI=L.memo(function(e){var n,r,s,i;let{id:c,accessibility:f,autoScroll:p=!0,children:g,sensors:C=yI,collisionDetection:v=jM,measuring:A,modifiers:T,..._}=e;const M=L.useReducer(EI,void 0,CI),[R,j]=M,[H,G]=SM(),[Z,J]=L.useState(bo.Uninitialized),oe=Z===bo.Initialized,{draggable:{active:U,nodes:ee,translate:X},droppable:{containers:Qe}}=R,je=U!=null?ee.get(U):null,ue=L.useRef({initial:null,translated:null}),Ie=L.useMemo(()=>{var Gt;return U!=null?{id:U,data:(Gt=je==null?void 0:je.data)!=null?Gt:wI,rect:ue}:null},[U,je]),Ze=L.useRef(null),[ne,ie]=L.useState(null),[pe,me]=L.useState(null),Y=Pd(_,Object.values(_)),le=Hp("DndDescribedBy",c),V=L.useMemo(()=>Qe.getEnabled(),[Qe]),te=AI(A),{droppableRects:fe,measureDroppableContainers:ge,measuringScheduled:We}=lI(V,{dragging:oe,dependencies:[X.x,X.y],config:te.droppable}),se=aI(ee,U),Be=L.useMemo(()=>pe?k0(pe):null,[pe]),K=Dt(),Ce=cI(se,te.draggable.measure);NI({activeNode:U!=null?ee.get(U):null,config:K.layoutShiftCompensation,initialRect:Ce,measure:te.draggable.measure});const Ae=UC(se,te.draggable.measure,Ce),ze=UC(se?se.parentElement:null),rt=L.useRef({activatorEvent:null,active:null,activeNode:se,collisionRect:null,collisions:null,droppableRects:fe,draggableNodes:ee,draggingNode:null,draggingNodeRect:null,droppableContainers:Qe,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ot=Qe.getNodeFor((n=rt.current.over)==null?void 0:n.id),gt=bI({measure:te.dragOverlay.measure}),jt=(r=gt.nodeRef.current)!=null?r:se,Pt=oe?(s=gt.rect)!=null?s:Ae:null,et=!!(gt.nodeRef.current&&gt.rect),ft=fI(et?null:Ae),Ve=QA(jt?ps(jt):null),lt=hI(oe?ot??se:null),tt=xI(lt),Xn=rN(T,{transform:{x:X.x-ft.x,y:X.y-ft.y,scaleX:1,scaleY:1},activatorEvent:pe,active:Ie,activeNodeRect:Ae,containerNodeRect:ze,draggingNodeRect:Pt,over:rt.current.over,overlayNodeRect:gt.rect,scrollableAncestors:lt,scrollableAncestorRects:tt,windowRect:Ve}),Lr=Be?zc(Be,X):null,on=pI(lt),_s=VC(on),tr=VC(on,[Ae]),jr=zc(Xn,_s),On=Pt?FM(Pt,Xn):null,xn=Ie&&On?v({active:Ie,collisionRect:On,droppableRects:fe,droppableContainers:V,pointerCoordinates:Lr}):null,is=IM(xn,"id"),[nr,ms]=L.useState(null),ln=et?Xn:zc(Xn,tr),He=BM(ln,(i=nr==null?void 0:nr.rect)!=null?i:null,Ae),Zt=L.useRef(null),At=L.useCallback((Gt,pn)=>{let{sensor:Bn,options:Jt}=pn;if(Ze.current==null)return;const dn=ee.get(Ze.current);if(!dn)return;const de=Gt.nativeEvent,we=new Bn({active:Ze.current,activeNode:dn,event:de,options:Jt,context:rt,onAbort(Fe){if(!ee.get(Fe))return;const{onDragAbort:nt}=Y.current,Xe={id:Fe};nt==null||nt(Xe),H({type:"onDragAbort",event:Xe})},onPending(Fe,it,nt,Xe){if(!ee.get(Fe))return;const{onDragPending:ut}=Y.current,yt={id:Fe,constraint:it,initialCoordinates:nt,offset:Xe};ut==null||ut(yt),H({type:"onDragPending",event:yt})},onStart(Fe){const it=Ze.current;if(it==null)return;const nt=ee.get(it);if(!nt)return;const{onDragStart:Xe}=Y.current,ct={activatorEvent:de,active:{id:it,data:nt.data,rect:ue}};Lc.unstable_batchedUpdates(()=>{Xe==null||Xe(ct),J(bo.Initializing),j({type:kr.DragStart,initialCoordinates:Fe,active:it}),H({type:"onDragStart",event:ct}),ie(Zt.current),me(de)})},onMove(Fe){j({type:kr.DragMove,coordinates:Fe})},onEnd:Oe(kr.DragEnd),onCancel:Oe(kr.DragCancel)});Zt.current=we;function Oe(Fe){return async function(){const{active:nt,collisions:Xe,over:ct,scrollAdjustedTranslate:ut}=rt.current;let yt=null;if(nt&&ut){const{cancelDrop:De}=Y.current;yt={activatorEvent:de,active:nt,collisions:Xe,delta:ut,over:ct},Fe===kr.DragEnd&&typeof De=="function"&&await Promise.resolve(De(yt))&&(Fe=kr.DragCancel)}Ze.current=null,Lc.unstable_batchedUpdates(()=>{j({type:Fe}),J(bo.Uninitialized),ms(null),ie(null),me(null),Zt.current=null;const De=Fe===kr.DragEnd?"onDragEnd":"onDragCancel";if(yt){const Tt=Y.current[De];Tt==null||Tt(yt),H({type:De,event:yt})}})}}},[ee]),cn=L.useCallback((Gt,pn)=>(Bn,Jt)=>{const dn=Bn.nativeEvent,de=ee.get(Jt);if(Ze.current!==null||!de||dn.dndKit||dn.defaultPrevented)return;const we={active:de};Gt(Bn,pn.options,we)===!0&&(dn.dndKit={capturedBy:pn.sensor},Ze.current=Jt,At(Bn,pn))},[ee,At]),bn=oI(C,cn);mI(C),Ra(()=>{Ae&&Z===bo.Initializing&&J(bo.Initialized)},[Ae,Z]),L.useEffect(()=>{const{onDragMove:Gt}=Y.current,{active:pn,activatorEvent:Bn,collisions:Jt,over:dn}=rt.current;if(!pn||!Bn)return;const de={active:pn,activatorEvent:Bn,collisions:Jt,delta:{x:jr.x,y:jr.y},over:dn};Lc.unstable_batchedUpdates(()=>{Gt==null||Gt(de),H({type:"onDragMove",event:de})})},[jr.x,jr.y]),L.useEffect(()=>{const{active:Gt,activatorEvent:pn,collisions:Bn,droppableContainers:Jt,scrollAdjustedTranslate:dn}=rt.current;if(!Gt||Ze.current==null||!pn||!dn)return;const{onDragOver:de}=Y.current,we=Jt.get(is),Oe=we&&we.rect.current?{id:we.id,rect:we.rect.current,data:we.data,disabled:we.disabled}:null,Fe={active:Gt,activatorEvent:pn,collisions:Bn,delta:{x:dn.x,y:dn.y},over:Oe};Lc.unstable_batchedUpdates(()=>{ms(Oe),de==null||de(Fe),H({type:"onDragOver",event:Fe})})},[is]),Ra(()=>{rt.current={activatorEvent:pe,active:Ie,activeNode:se,collisionRect:On,collisions:xn,droppableRects:fe,draggableNodes:ee,draggingNode:jt,draggingNodeRect:Pt,droppableContainers:Qe,over:nr,scrollableAncestors:lt,scrollAdjustedTranslate:jr},ue.current={initial:Pt,translated:On}},[Ie,se,xn,On,ee,jt,Pt,fe,Qe,nr,lt,jr]),rI({...K,delta:X,draggingRect:On,pointerCoordinates:Lr,scrollableAncestors:lt,scrollableAncestorRects:tt});const gs=L.useMemo(()=>({active:Ie,activeNode:se,activeNodeRect:Ae,activatorEvent:pe,collisions:xn,containerNodeRect:ze,dragOverlay:gt,draggableNodes:ee,droppableContainers:Qe,droppableRects:fe,over:nr,measureDroppableContainers:ge,scrollableAncestors:lt,scrollableAncestorRects:tt,measuringConfiguration:te,measuringScheduled:We,windowRect:Ve}),[Ie,se,Ae,pe,xn,ze,gt,ee,Qe,fe,nr,ge,lt,tt,te,We,Ve]),Br=L.useMemo(()=>({activatorEvent:pe,activators:bn,active:Ie,activeNodeRect:Ae,ariaDescribedById:{draggable:le},dispatch:j,draggableNodes:ee,over:nr,measureDroppableContainers:ge}),[pe,bn,Ie,Ae,j,le,ee,nr,ge]);return It.createElement(zA.Provider,{value:G},It.createElement(cf.Provider,{value:Br},It.createElement(nN.Provider,{value:gs},It.createElement(Gp.Provider,{value:He},g)),It.createElement(SI,{disabled:(f==null?void 0:f.restoreFocus)===!1})),It.createElement(kM,{...f,hiddenTextDescribedById:le}));function Dt(){const Gt=(ne==null?void 0:ne.autoScrollEnabled)===!1,pn=typeof p=="object"?p.enabled===!1:p===!1,Bn=oe&&!Gt&&!pn;return typeof p=="object"?{...p,enabled:Bn}:{enabled:Bn}}}),TI=L.createContext(null),WC="button",OI="Draggable";function _I(t){let{id:e,data:n,disabled:r=!1,attributes:s}=t;const i=Hp(OI),{activators:c,activatorEvent:f,active:p,activeNodeRect:g,ariaDescribedById:C,draggableNodes:v,over:A}=L.useContext(cf),{role:T=WC,roleDescription:_="draggable",tabIndex:M=0}=s??{},R=(p==null?void 0:p.id)===e,j=L.useContext(R?Gp:TI),[H,G]=S0(),[Z,J]=S0(),oe=gI(c,e),U=Pd(n);Ra(()=>(v.set(e,{id:e,key:i,node:H,activatorNode:Z,data:U}),()=>{const X=v.get(e);X&&X.key===i&&v.delete(e)}),[v,e]);const ee=L.useMemo(()=>({role:T,tabIndex:M,"aria-disabled":r,"aria-pressed":R&&T===WC?!0:void 0,"aria-roledescription":_,"aria-describedby":C.draggable}),[r,T,M,R,_,C.draggable]);return{active:p,activatorEvent:f,activeNodeRect:g,attributes:ee,isDragging:R,listeners:r?void 0:oe,node:H,over:A,setNodeRef:G,setActivatorNodeRef:J,transform:j}}function RI(){return L.useContext(nN)}const MI="Droppable",II={timeout:25};function DI(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:s}=t;const i=Hp(MI),{active:c,dispatch:f,over:p,measureDroppableContainers:g}=L.useContext(cf),C=L.useRef({disabled:n}),v=L.useRef(!1),A=L.useRef(null),T=L.useRef(null),{disabled:_,updateMeasurementsFor:M,timeout:R}={...II,...s},j=Pd(M??r),H=L.useCallback(()=>{if(!v.current){v.current=!0;return}T.current!=null&&clearTimeout(T.current),T.current=setTimeout(()=>{g(Array.isArray(j.current)?j.current:[j.current]),T.current=null},R)},[R]),G=Vp({callback:H,disabled:_||!c}),Z=L.useCallback((ee,X)=>{G&&(X&&(G.unobserve(X),v.current=!1),ee&&G.observe(ee))},[G]),[J,oe]=S0(Z),U=Pd(e);return L.useEffect(()=>{!G||!J.current||(G.disconnect(),v.current=!1,G.observe(J.current))},[J,G]),L.useEffect(()=>(f({type:kr.RegisterDroppable,element:{id:r,key:i,disabled:n,node:J,rect:A,data:U}}),()=>f({type:kr.UnregisterDroppable,key:i,id:r})),[r]),L.useEffect(()=>{n!==C.current.disabled&&(f({type:kr.SetDroppableDisabled,id:r,key:i,disabled:n}),C.current.disabled=n)},[r,i,n,f]),{active:c,rect:A,isOver:(p==null?void 0:p.id)===r,node:J,over:p,setNodeRef:oe}}function LI(t){let{animation:e,children:n}=t;const[r,s]=L.useState(null),[i,c]=L.useState(null),f=A0(n);return!n&&!r&&f&&s(f),Ra(()=>{if(!i)return;const p=r==null?void 0:r.key,g=r==null?void 0:r.props.id;if(p==null||g==null){s(null);return}Promise.resolve(e(g,i)).then(()=>{s(null)})},[e,r,i]),It.createElement(It.Fragment,null,n,r?L.cloneElement(r,{ref:c}):null)}const jI={x:0,y:0,scaleX:1,scaleY:1};function BI(t){let{children:e}=t;return It.createElement(cf.Provider,{value:tN},It.createElement(Gp.Provider,{value:jI},e))}const PI={position:"fixed",touchAction:"none"},FI=t=>G2(t)?"transform 250ms ease":void 0,zI=L.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:s,children:i,className:c,rect:f,style:p,transform:g,transition:C=FI}=t;if(!f)return null;const v=s?g:{...g,scaleX:1,scaleY:1},A={...PI,width:f.width,height:f.height,top:f.top,left:f.left,transform:Zc.Transform.toString(v),transformOrigin:s&&r?_M(r,f):void 0,transition:typeof C=="function"?C(r):C,...p};return It.createElement(n,{className:c,style:A,ref:e},i)}),UI=t=>e=>{let{active:n,dragOverlay:r}=e;const s={},{styles:i,className:c}=t;if(i!=null&&i.active)for(const[f,p]of Object.entries(i.active))p!==void 0&&(s[f]=n.node.style.getPropertyValue(f),n.node.style.setProperty(f,p));if(i!=null&&i.dragOverlay)for(const[f,p]of Object.entries(i.dragOverlay))p!==void 0&&r.node.style.setProperty(f,p);return c!=null&&c.active&&n.node.classList.add(c.active),c!=null&&c.dragOverlay&&r.node.classList.add(c.dragOverlay),function(){for(const[p,g]of Object.entries(s))n.node.style.setProperty(p,g);c!=null&&c.active&&n.node.classList.remove(c.active)}},HI=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:Zc.Transform.toString(e)},{transform:Zc.Transform.toString(n)}]},VI={duration:250,easing:"ease",keyframes:HI,sideEffects:UI({styles:{active:{opacity:"0"}}})};function GI(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=t;return Up((i,c)=>{if(e===null)return;const f=n.get(i);if(!f)return;const p=f.node.current;if(!p)return;const g=eN(c);if(!g)return;const{transform:C}=ps(c).getComputedStyle(c),v=HA(C);if(!v)return;const A=typeof e=="function"?e:WI(e);return YA(p,s.draggable.measure),A({active:{id:i,data:f.data,node:p,rect:s.draggable.measure(p)},draggableNodes:n,dragOverlay:{node:c,rect:s.dragOverlay.measure(g)},droppableContainers:r,measuringConfiguration:s,transform:v})})}function WI(t){const{duration:e,easing:n,sideEffects:r,keyframes:s}={...VI,...t};return i=>{let{active:c,dragOverlay:f,transform:p,...g}=i;if(!e)return;const C={x:f.rect.left-c.rect.left,y:f.rect.top-c.rect.top},v={scaleX:p.scaleX!==1?c.rect.width*p.scaleX/f.rect.width:1,scaleY:p.scaleY!==1?c.rect.height*p.scaleY/f.rect.height:1},A={x:p.x-C.x,y:p.y-C.y,...v},T=s({...g,active:c,dragOverlay:f,transform:{initial:p,final:A}}),[_]=T,M=T[T.length-1];if(JSON.stringify(_)===JSON.stringify(M))return;const R=r==null?void 0:r({active:c,dragOverlay:f,...g}),j=f.node.animate(T,{duration:e,easing:n,fill:"forwards"});return new Promise(H=>{j.onfinish=()=>{R==null||R(),H()}})}}let qC=0;function qI(t){return L.useMemo(()=>{if(t!=null)return qC++,qC},[t])}const $I=It.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:s,transition:i,modifiers:c,wrapperElement:f="div",className:p,zIndex:g=999}=t;const{activatorEvent:C,active:v,activeNodeRect:A,containerNodeRect:T,draggableNodes:_,droppableContainers:M,dragOverlay:R,over:j,measuringConfiguration:H,scrollableAncestors:G,scrollableAncestorRects:Z,windowRect:J}=RI(),oe=L.useContext(Gp),U=qI(v==null?void 0:v.id),ee=rN(c,{activatorEvent:C,active:v,activeNodeRect:A,containerNodeRect:T,draggingNodeRect:R.rect,over:j,overlayNodeRect:R.rect,scrollableAncestors:G,scrollableAncestorRects:Z,transform:oe,windowRect:J}),X=Y2(A),Qe=GI({config:r,draggableNodes:_,droppableContainers:M,measuringConfiguration:H}),je=X?R.setRef:void 0;return It.createElement(BI,null,It.createElement(LI,{animation:Qe},v&&U?It.createElement(zI,{key:U,id:v.id,ref:je,as:f,activatorEvent:C,adjustScale:e,className:p,transition:i,rect:X,style:{zIndex:g,...s},transform:ee},n):null))});function XI(t,e,n){const r={...t};return e.top+t.y<=n.top?r.y=n.top-e.top:e.bottom+t.y>=n.top+n.height&&(r.y=n.top+n.height-e.bottom),e.left+t.x<=n.left?r.x=n.left-e.left:e.right+t.x>=n.left+n.width&&(r.x=n.left+n.width-e.right),r}const $C=t=>{let{transform:e,draggingNodeRect:n,windowRect:r}=t;return!n||!r?e:XI(e,n,r)},YI=4,_0=["Felsefe","Sosyoloji","Psikoloji","Bilim ve Teknoloji","Din ve nan","Tarih","nceleme ve Aratrma","Ekonomi ve Hukuk","Trk Edebiyat","Dnya Edebiyat","Sanat ve Kltr","Dier"],XC=({activeCategory:t,onCategoryChange:e,categories:n=_0})=>b.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[b.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[b.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Discovery Areas"]}),b.jsxs("div",{className:"space-y-1",children:[b.jsxs("button",{onClick:()=>e(null),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===null?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[b.jsx("span",{className:t===null?"text-card-foreground":"text-card-foreground/80",children:"All Categories"}),t===null&&b.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]}),n.map(r=>b.jsxs("button",{onClick:()=>e(r),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===r?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[b.jsx("span",{className:t===r?"text-card-foreground":"text-card-foreground/80",children:r}),t===r&&b.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r))]})]}),sN=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("defs",{children:b.jsxs("linearGradient",{id:"kb-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[b.jsx("stop",{offset:"0%",stopColor:"#CC561E"}),b.jsx("stop",{offset:"100%",stopColor:"#A44319"})]})}),b.jsx("rect",{x:"2",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"}),b.jsx("rect",{x:"9",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),b.jsx("rect",{x:"16",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),b.jsx("rect",{x:"2",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),b.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)"}),b.jsx("rect",{x:"16",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),b.jsx("rect",{x:"2",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),b.jsx("rect",{x:"9",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),b.jsx("rect",{x:"16",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"})]}),iN=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("path",{d:"M12 20H21",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M16.5 3.5C17.3284 2.67157 18.6716 2.67157 19.5 3.5C20.3284 4.32843 20.3284 5.67157 19.5 6.5L7 19L3 20L4 16L16.5 3.5Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),b.jsx("path",{d:"M15 5L19 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),Bx=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("rect",{x:"3",y:"6",width:"4",height:"12",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("path",{d:"M4 9H6",stroke:"#CC561E",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.4"}),b.jsx("rect",{x:"8",y:"4",width:"4",height:"14",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.3"}),b.jsx("path",{d:"M9 7H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),b.jsx("path",{d:"M9 15H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),b.jsx("rect",{x:"13",y:"7",width:"4",height:"11",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("rect",{x:"18",y:"5",width:"4",height:"13",rx:"0.5",transform:"rotate(12 18 5)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.8"}),b.jsx("path",{d:"M2 19H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.3"})]}),a0=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("path",{d:"M4 4H14L20 10V20H4V4Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),b.jsx("path",{d:"M14 4V10H20",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),b.jsx("path",{d:"M8 14H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M8 17H12",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),o0=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("circle",{cx:"11",cy:"11",r:"9",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),b.jsx("ellipse",{cx:"11",cy:"11",rx:"3.5",ry:"9",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),b.jsx("path",{d:"M2 11H20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),b.jsx("path",{d:"M11 2V20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),b.jsx("path",{d:"M16 14L22 17L19 18L21 21L19 22L17 19L14 22V14Z",fill:"#CC561E",stroke:"#000",strokeWidth:"0.5"})]}),aN=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("rect",{x:"5",y:"5",width:"14",height:"15",rx:"1.5",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.3",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("path",{d:"M3 4C3 3.44772 3.44772 3 4 3H19C19.5523 3 20 3.44772 20 4V20C20 20.5523 19.5523 21 19 21H4C3.44772 21 3 20.5523 3 20V4Z",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.15"}),b.jsx("path",{d:"M5 1V5M9 1V5M13 1V5M17 1V5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M7 9H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),b.jsx("path",{d:"M7 12H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),b.jsx("path",{d:"M7 15H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),b.jsx("path",{d:"M16 21L20 17",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),s$=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("path",{d:"M6 20V14",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),b.jsx("path",{d:"M12 20V10",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),b.jsx("path",{d:"M18 20V5",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),b.jsx("path",{d:"M4 14L10 8L15 13L21 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),b.jsx("path",{d:"M21 4H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M21 4V9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),i$=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("rect",{x:"5",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("rect",{x:"13",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("rect",{x:"5",y:"13",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("rect",{x:"16",y:"13",width:"6",height:"6",rx:"2",transform:"rotate(45 16 16)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"})]}),a$=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.8"}),b.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.5"}),b.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"#CC561E",fillOpacity:"0.8"}),b.jsx("path",{d:"M19 5L13.5 10.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M19 5L20 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M19 5L15 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),o$=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("path",{d:"M21 8V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.05"}),b.jsx("path",{d:"M23 3H1V8H23V3Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("rect",{x:"10",y:"12",width:"4",height:"2",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("path",{d:"M7 16H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"}),b.jsx("path",{d:"M7 19H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"})]}),R0=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"#CC561E",strokeWidth:"2.5",fill:"#CC561E",fillOpacity:"0.05"}),b.jsx("path",{d:"M14.5 7.5C14.5 7.5 13.5 6.5 11 6.5",stroke:"#fff",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.7"}),b.jsx("circle",{cx:"11",cy:"11",r:"4",stroke:"#CC561E",strokeWidth:"1",strokeOpacity:"0.3"}),b.jsx("path",{d:"M16 16L20 20",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),b.jsx("path",{d:"M17 17L19 19",stroke:"#fff",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.5"}),b.jsx("circle",{cx:"18",cy:"6",r:"1.5",fill:"#CC561E",fillOpacity:"0.8"}),b.jsx("circle",{cx:"21",cy:"9",r:"1",fill:"#CC561E",fillOpacity:"0.4"})]}),oN=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("rect",{x:"4",y:"6",width:"16",height:"15",rx:"4",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),b.jsx("path",{d:"M12 6V3",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),b.jsx("circle",{cx:"12",cy:"3",r:"2",stroke:"#CC561E",strokeWidth:"1.5"}),b.jsx("circle",{cx:"12",cy:"3",r:"0.5",fill:"#CC561E"}),b.jsx("rect",{x:"7",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),b.jsx("rect",{x:"14",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),b.jsx("path",{d:"M9 16C9 16 10 17 12 17C14 17 15 16 15 16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:"0.6"}),b.jsx("path",{d:"M2 13H4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"}),b.jsx("path",{d:"M20 13H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),KI=({className:t,size:e=24})=>b.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[b.jsx("path",{d:"M2 6C6 6 6 10 10 10C14 10 14 6 18 6C20 6 21 7 22 8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.05"}),b.jsx("path",{d:"M2 12C6 12 6 16 10 16C14 16 14 12 18 12C20 12 21 13 22 14",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.1"}),b.jsx("path",{d:"M2 18C6 18 6 22 10 22C14 22 14 18 18 18C20 18 21 19 22 20",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.2"}),b.jsx("path",{d:"M10 4V20",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"2 4",strokeOpacity:"0.5"})]});function Wp(t){const e=typeof t=="string"?t.trim().toLowerCase():"";return e==="insight"||e==="note"?"insight":"highlight"}function lN(t){return Wp(t)==="insight"}const cN="PRIVATE";function qp(t){const e=typeof t=="string"?t.trim().toUpperCase():"";return e==="DAILY"?"DAILY":e==="IDEAS"?"IDEAS":cN}function er(t){return t.type==="PERSONAL_NOTE"}function es(t){return er(t)?qp(t.personalNoteCategory):cN}function uN(t){return er(t)&&es(t)==="IDEAS"}function dN(t){return uN(t)?"INSIGHT":"PERSONAL_NOTE"}function fN(t){return typeof t!="string"?void 0:t.trim().replace(/\s+/g," ")||void 0}function hN(t){return typeof t!="string"?void 0:t.trim()||void 0}const ZI=/<\/?[a-z][\s\S]*>/i,pN=t=>ZI.test(t),gl=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),xl=t=>t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(.+?)__/g,"<u>$1</u>").replace(/_(.+?)_/g,"<em>$1</em>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,'<code class="px-1 py-0.5 rounded bg-slate-100 text-slate-700">$1</code>'),JI=t=>{if(typeof window>"u")return t;const n=new DOMParser().parseFromString(t,"text/html");return n.querySelectorAll("script,style,iframe,object,embed").forEach(r=>r.remove()),n.body.querySelectorAll("*").forEach(r=>{[...r.attributes].forEach(s=>{const i=s.name.toLowerCase(),c=s.value.toLowerCase();i.startsWith("on")&&r.removeAttribute(s.name),(i==="href"||i==="src")&&c.startsWith("javascript:")&&r.removeAttribute(s.name)})}),n.body.innerHTML},Jc=t=>{if(!t)return"";if(pN(t)){const e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/(p|div|li|h1|h2|h3|h4|h5|h6|blockquote|pre|tr|td|th|ul|ol)>/gi,`
`);return typeof window<"u"?(new DOMParser().parseFromString(e,"text/html").body.textContent||"").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).trim():e.replace(/<[^>]*>/g," ").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]{2,}/g," ").trim()}return t.replace(/^#{1,6}\s+/gm,"").replace(/^\s*-\s\[(?: |x|X)\]\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/^\s*>\s?/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\s+\n/g,`
`).trim()},M0=t=>Jc(t).trim().length>0,K2=t=>{if(!M0(t))return'<p class="text-slate-400 italic">No content added.</p>';if(pN(t))return JI(t);const e=t.split(`
`);let n="",r=null;const s=()=>{r&&(n+=`</${r}>`,r=null)};for(const i of e){if(!i.trim()){s(),n+='<div class="h-2"></div>';continue}const c=i.match(/^\s*#\s+(.+)/),f=i.match(/^\s*##\s+(.+)/),p=i.match(/^\s*-\s\[( |x|X)\]\s+(.+)/),g=i.match(/^\s*-\s+(.+)/),C=i.match(/^\s*\d+\.\s+(.+)/),v=i.match(/^\s*>\s+(.+)/);if(c){s(),n+=`<h1 class="text-xl font-bold mt-3 mb-1.5">${xl(gl(c[1]))}</h1>`;continue}if(f){s(),n+=`<h2 class="text-lg font-semibold mt-3 mb-1.5">${xl(gl(f[1]))}</h2>`;continue}if(v){s(),n+=`<blockquote class="border-l-2 border-[#CC561E]/40 pl-3 italic text-slate-600 my-1">${xl(gl(v[1]))}</blockquote>`;continue}if(p){r!=="ul"&&(s(),r="ul",n+='<ul class="space-y-1 my-1">');const A=p[1].toLowerCase()==="x";n+=`<li class="text-sm flex items-start gap-2"><span class="mt-0.5">${A?"&#9745;":"&#9744;"}</span><span>${xl(gl(p[2]))}</span></li>`;continue}if(g){r!=="ul"&&(s(),r="ul",n+='<ul class="list-disc pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${xl(gl(g[1]))}</li>`;continue}if(C){r!=="ol"&&(s(),r="ol",n+='<ol class="list-decimal pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${xl(gl(C[1]))}</li>`;continue}s(),n+=`<p class="text-sm leading-relaxed my-1">${xl(gl(i.trim()))}</p>`}return s(),n};var vg={exports:{}},Cg={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YC;function QI(){if(YC)return Cg;YC=1;var t=tf();function e(v,A){return v===A&&(v!==0||1/v===1/A)||v!==v&&A!==A}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,c=t.useDebugValue;function f(v,A){var T=A(),_=r({inst:{value:T,getSnapshot:A}}),M=_[0].inst,R=_[1];return i(function(){M.value=T,M.getSnapshot=A,p(M)&&R({inst:M})},[v,T,A]),s(function(){return p(M)&&R({inst:M}),v(function(){p(M)&&R({inst:M})})},[v]),c(T),T}function p(v){var A=v.getSnapshot;v=v.value;try{var T=A();return!n(v,T)}catch{return!0}}function g(v,A){return A()}var C=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?g:f;return Cg.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:C,Cg}var KC;function mN(){return KC||(KC=1,vg.exports=QI()),vg.exports}var gN=mN();function qr(t){this.content=t}qr.prototype={constructor:qr,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),i=r.content.slice();return s==-1?i.push(n||t,e):(i[s+1]=e,n&&(i[s]=n)),new qr(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new qr(n)},addToStart:function(t,e){return new qr([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new qr(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),i=r.find(t);return s.splice(i==-1?s.length:i,0,e,n),new qr(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=qr.from(t),t.size?new qr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=qr.from(t),t.size?new qr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=qr.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};qr.from=function(t){if(t instanceof qr)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new qr(e)};function xN(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),i=e.child(r);if(s==i){n+=s.nodeSize;continue}if(!s.sameMarkup(i))return n;if(s.isText&&s.text!=i.text){for(let c=0;s.text[c]==i.text[c];c++)n++;return n}if(s.content.size||i.content.size){let c=xN(s.content,i.content,n+1);if(c!=null)return c}n+=s.nodeSize}}function bN(t,e,n,r){for(let s=t.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:n,b:r};let c=t.child(--s),f=e.child(--i),p=c.nodeSize;if(c==f){n-=p,r-=p;continue}if(!c.sameMarkup(f))return{a:n,b:r};if(c.isText&&c.text!=f.text){let g=0,C=Math.min(c.text.length,f.text.length);for(;g<C&&c.text[c.text.length-g-1]==f.text[f.text.length-g-1];)g++,n--,r--;return{a:n,b:r}}if(c.content.size||f.content.size){let g=bN(c.content,f.content,n-1,r-1);if(g)return g}n-=p,r-=p}}class Pe{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,i){for(let c=0,f=0;f<n;c++){let p=this.content[c],g=f+p.nodeSize;if(g>e&&r(p,s+f,i||null,c)!==!1&&p.content.size){let C=f+1;p.nodesBetween(Math.max(0,e-C),Math.min(p.content.size,n-C),r,s+C)}f=g}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let i="",c=!0;return this.nodesBetween(e,n,(f,p)=>{let g=f.isText?f.text.slice(Math.max(e,p)-p,n-p):f.isLeaf?s?typeof s=="function"?s(f):s:f.type.spec.leafText?f.type.spec.leafText(f):"":"";f.isBlock&&(f.isLeaf&&g||f.isTextblock)&&r&&(c?c=!1:i+=r),i+=g},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new Pe(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let i=0,c=0;c<n;i++){let f=this.content[i],p=c+f.nodeSize;p>e&&((c<e||p>n)&&(f.isText?f=f.cut(Math.max(0,e-c),Math.min(f.text.length,n-c)):f=f.cut(Math.max(0,e-c-1),Math.min(f.content.size,n-c-1))),r.push(f),s+=f.nodeSize),c=p}return new Pe(r,s)}cutByIndex(e,n){return e==n?Pe.empty:e==0&&n==this.content.length?this:new Pe(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new Pe(s,i)}addToStart(e){return new Pe([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Pe(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return xN(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return bN(this,e,n,r)}findIndex(e){if(e==0)return Ph(0,e);if(e==this.size)return Ph(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),i=r+s.nodeSize;if(i>=e)return i==e?Ph(n+1,i):Ph(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Pe.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Pe(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Pe.empty;let n,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(n||(n=e.slice(0,s)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new Pe(n||e,r)}static from(e){if(!e)return Pe.empty;if(e instanceof Pe)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Pe([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Pe.empty=new Pe([],0);const Eg={index:0,offset:0};function Ph(t,e){return Eg.index=t,Eg.offset=e,Eg}function I0(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!I0(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!I0(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let jn=class Px{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&I0(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Px.none;if(e instanceof Px)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};jn.none=[];class D0 extends Error{}class st{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=wN(this.content,e+this.openStart,n);return r&&new st(r,this.openStart,this.openEnd)}removeBetween(e,n){return new st(yN(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return st.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new st(Pe.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)s++;return new st(e,r,s)}}st.empty=new st(Pe.empty,0,0);function yN(t,e,n){let{index:r,offset:s}=t.findIndex(e),i=t.maybeChild(r),{index:c,offset:f}=t.findIndex(n);if(s==e||i.isText){if(f!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(yN(i.content,e-s-1,n-s-1)))}function wN(t,e,n,r){let{index:s,offset:i}=t.findIndex(e),c=t.maybeChild(s);if(i==e||c.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let f=wN(c.content,e-i-1,n,c);return f&&t.replaceChild(s,c.copy(f))}function eD(t,e,n){if(n.openStart>t.depth)throw new D0("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new D0("Inconsistent open depths");return vN(t,e,n,0)}function vN(t,e,n,r){let s=t.index(r),i=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let c=vN(t,e,n,r+1);return i.copy(i.content.replaceChild(s,c))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let c=t.parent,f=c.content;return Rl(c,f.cut(0,t.parentOffset).append(n.content).append(f.cut(e.parentOffset)))}else{let{start:c,end:f}=tD(n,t);return Rl(i,EN(t,c,f,e,r))}else return Rl(i,L0(t,e,r))}function CN(t,e){if(!e.type.compatibleContent(t.type))throw new D0("Cannot join "+e.type.name+" onto "+t.type.name)}function Fx(t,e,n){let r=t.node(n);return CN(r,e.node(n)),r}function _l(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function vd(t,e,n,r){let s=(e||t).node(n),i=0,c=e?e.index(n):s.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(_l(t.nodeAfter,r),i++));for(let f=i;f<c;f++)_l(s.child(f),r);e&&e.depth==n&&e.textOffset&&_l(e.nodeBefore,r)}function Rl(t,e){return t.type.checkContent(e),t.copy(e)}function EN(t,e,n,r,s){let i=t.depth>s&&Fx(t,e,s+1),c=r.depth>s&&Fx(n,r,s+1),f=[];return vd(null,t,s,f),i&&c&&e.index(s)==n.index(s)?(CN(i,c),_l(Rl(i,EN(t,e,n,r,s+1)),f)):(i&&_l(Rl(i,L0(t,e,s+1)),f),vd(e,n,s,f),c&&_l(Rl(c,L0(n,r,s+1)),f)),vd(r,null,s,f),new Pe(f)}function L0(t,e,n){let r=[];if(vd(null,t,n,r),t.depth>n){let s=Fx(t,e,n+1);_l(Rl(s,L0(t,e,n+1)),r)}return vd(e,null,n,r),new Pe(r)}function tD(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)s=e.node(i).copy(Pe.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class zd{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return jn.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let f=r;r=s,s=f}let i=r.marks;for(var c=0;c<i.length;c++)i[c].type.spec.inclusive===!1&&(!s||!i[c].isInSet(s.marks))&&(i=i[c--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new j0(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,i=n;for(let c=e;;){let{index:f,offset:p}=c.content.findIndex(i),g=i-p;if(r.push(c,f,s+p),!g||(c=c.child(f),c.isText))break;i=g-1,s+=p+1}return new zd(n,r,i)}static resolveCached(e,n){let r=ZC.get(e);if(r)for(let i=0;i<r.elts.length;i++){let c=r.elts[i];if(c.pos==n)return c}else ZC.set(e,r=new nD);let s=r.elts[r.i]=zd.resolve(e,n);return r.i=(r.i+1)%rD,s}}class nD{constructor(){this.elts=[],this.i=0}}const rD=12,ZC=new WeakMap;class j0{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const sD=Object.create(null);class xi{constructor(e,n,r,s=jn.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||Pe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&I0(this.attrs,n||e.defaultAttrs||sD)&&jn.sameSet(this.marks,r||jn.none)}copy(e=null){return e==this.content?this:new xi(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new xi(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return st.empty;let s=this.resolve(e),i=this.resolve(n),c=r?0:s.sharedDepth(n),f=s.start(c),g=s.node(c).content.cut(s.pos-f,i.pos-f);return new st(g,s.depth-c,i.depth-c)}replace(e,n,r){return eD(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return zd.resolveCached(this,e)}resolveNoCache(e){return zd.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),SN(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=Pe.empty,s=0,i=r.childCount){let c=this.contentMatchAt(e).matchFragment(r,s,i),f=c&&c.matchFragment(this.content,n);if(!f||!f.validEnd)return!1;for(let p=s;p<i;p++)if(!this.type.allowsMarks(r.child(p).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),c=i&&i.matchFragment(this.content,n);return c?c.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=jn.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!jn.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=Pe.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,s,r);return i.type.checkAttrs(i.attrs),i}}xi.prototype.text=void 0;class B0 extends xi{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):SN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new B0(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new B0(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function SN(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Bl{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new iD(e,n);if(r.next==null)return Bl.empty;let s=AN(r);r.next&&r.err("Unexpected trailing text");let i=fD(dD(s));return hD(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let i=n;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function i(c,f){let p=c.matchFragment(e,r);if(p&&(!n||p.validEnd))return Pe.from(f.map(g=>g.createAndFill()));for(let g=0;g<c.next.length;g++){let{type:C,next:v}=c.next[g];if(!(C.isText||C.hasRequiredAttrs())&&s.indexOf(v)==-1){s.push(v);let A=i(v,f.concat(C));if(A)return A}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let c=[];for(let f=s;f.type;f=f.via)c.push(f.type);return c.reverse()}for(let c=0;c<i.next.length;c++){let{type:f,next:p}=i.next[c];!f.isLeaf&&!f.hasRequiredAttrs()&&!(f.name in n)&&(!s.type||p.validEnd)&&(r.push({match:f.contentMatch,type:f,via:s}),n[f.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let c=0;c<r.next.length;c++)i+=(c?", ":"")+r.next[c].type.name+"->"+e.indexOf(r.next[c].next);return i}).join(`
`)}}Bl.empty=new Bl(!0);class iD{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function AN(t){let e=[];do e.push(aD(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function aD(t){let e=[];do e.push(oD(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function oD(t){let e=uD(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=lD(t,e);else break;return e}function JC(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function lD(t,e){let n=JC(t),r=n;return t.eat(",")&&(t.next!="}"?r=JC(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function cD(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let i in n){let c=n[i];c.isInGroup(e)&&s.push(c)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function uD(t){if(t.eat("(")){let e=AN(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=cD(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function dD(t){let e=[[]];return s(i(t,0),n()),e;function n(){return e.push([])-1}function r(c,f,p){let g={term:p,to:f};return e[c].push(g),g}function s(c,f){c.forEach(p=>p.to=f)}function i(c,f){if(c.type=="choice")return c.exprs.reduce((p,g)=>p.concat(i(g,f)),[]);if(c.type=="seq")for(let p=0;;p++){let g=i(c.exprs[p],f);if(p==c.exprs.length-1)return g;s(g,f=n())}else if(c.type=="star"){let p=n();return r(f,p),s(i(c.expr,p),p),[r(p)]}else if(c.type=="plus"){let p=n();return s(i(c.expr,f),p),s(i(c.expr,p),p),[r(p)]}else{if(c.type=="opt")return[r(f)].concat(i(c.expr,f));if(c.type=="range"){let p=f;for(let g=0;g<c.min;g++){let C=n();s(i(c.expr,p),C),p=C}if(c.max==-1)s(i(c.expr,p),p);else for(let g=c.min;g<c.max;g++){let C=n();r(p,C),s(i(c.expr,p),C),p=C}return[r(p)]}else{if(c.type=="name")return[r(f,void 0,c.value)];throw new Error("Unknown expr type")}}}}function NN(t,e){return e-t}function QC(t,e){let n=[];return r(e),n.sort(NN);function r(s){let i=t[s];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(s);for(let c=0;c<i.length;c++){let{term:f,to:p}=i[c];!f&&n.indexOf(p)==-1&&r(p)}}}function fD(t){let e=Object.create(null);return n(QC(t,0));function n(r){let s=[];r.forEach(c=>{t[c].forEach(({term:f,to:p})=>{if(!f)return;let g;for(let C=0;C<s.length;C++)s[C][0]==f&&(g=s[C][1]);QC(t,p).forEach(C=>{g||s.push([f,g=[]]),g.indexOf(C)==-1&&g.push(C)})})});let i=e[r.join(",")]=new Bl(r.indexOf(t.length-1)>-1);for(let c=0;c<s.length;c++){let f=s[c][1].sort(NN);i.next.push({type:s[c][0],next:e[f.join(",")]||n(f)})}return i}}function hD(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],i=!s.validEnd,c=[];for(let f=0;f<s.next.length;f++){let{type:p,next:g}=s.next[f];c.push(p.name),i&&!(p.isText||p.hasRequiredAttrs())&&(i=!1),r.indexOf(g)==-1&&r.push(g)}i&&e.err("Only non-generatable nodes ("+c.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function kN(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function TN(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let i=t[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function ON(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let i=t[s];i.validate&&i.validate(e[s])}}function _N(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new mD(t,r,e[r]);return n}let eE=class RN{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=_N(e,r.attrs),this.defaultAttrs=kN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Bl.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:TN(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new xi(this,this.computeAttrs(e),Pe.from(n),jn.setFrom(r))}createChecked(e=null,n,r){return n=Pe.from(n),this.checkContent(n),new xi(this,this.computeAttrs(e),n,jn.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=Pe.from(n),n.size){let c=this.contentMatch.fillBefore(n);if(!c)return null;n=c.append(n)}let s=this.contentMatch.matchFragment(n),i=s&&s.fillBefore(Pe.empty,!0);return i?new xi(this,e,n.append(i),jn.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){ON(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:jn.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,c)=>r[i]=new RN(i,n,c));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function pD(t,e,n){let r=n.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class mD{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?pD(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class $p{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=_N(e,s.attrs),this.excluded=null;let i=kN(this.attrs);this.instance=i?new jn(this,i):null}create(e=null){return!e&&this.instance?this.instance:new jn(this,TN(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((i,c)=>r[i]=new $p(i,s++,n,c)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){ON(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class MN{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=qr.from(e.nodes),n.marks=qr.from(e.marks||{}),this.nodes=eE.compile(this.spec.nodes,this),this.marks=$p.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],c=i.spec.content||"",f=i.spec.marks;if(i.contentMatch=r[c]||(r[c]=Bl.parse(c,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=f=="_"?null:f?tE(this,f.split(" ")):f==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],c=i.spec.excludes;i.excluded=c==null?[i]:c==""?[]:tE(this,c.split(" "))}this.nodeFromJSON=s=>xi.fromJSON(this,s),this.markFromJSON=s=>jn.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof eE){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new B0(r,r.defaultAttrs,e,jn.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function tE(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=t.marks[s],c=i;if(i)n.push(i);else for(let f in t.marks){let p=t.marks[f];(s=="_"||p.spec.group&&p.spec.group.split(" ").indexOf(s)>-1)&&n.push(c=p)}if(!c)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function gD(t){return t.tag!=null}function xD(t){return t.style!=null}let Cd=class zx{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(gD(s))this.tags.push(s);else if(xD(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new rE(this,n,!1);return r.addAll(e,jn.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new rE(this,n,!0);return r.addAll(e,jn.none,n.from,n.to),st.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(wD(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let c=i.getAttrs(e);if(c===!1)continue;i.attrs=c||void 0}return i}}}matchStyle(e,n,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let c=this.styles[i],f=c.style;if(!(f.indexOf(e)!=0||c.context&&!r.matchesContext(c.context)||f.length>e.length&&(f.charCodeAt(e.length)!=61||f.slice(e.length+1)!=n))){if(c.getAttrs){let p=c.getAttrs(n);if(p===!1)continue;c.attrs=p||void 0}return c}}}static schemaRules(e){let n=[];function r(s){let i=s.priority==null?50:s.priority,c=0;for(;c<n.length;c++){let f=n[c];if((f.priority==null?50:f.priority)<i)break}n.splice(c,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(c=>{r(c=sE(c)),c.mark||c.ignore||c.clearMark||(c.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(c=>{r(c=sE(c)),c.node||c.ignore||c.mark||(c.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new zx(e,zx.schemaRules(e)))}};const IN={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},bD={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},DN={ol:!0,ul:!0},Ud=1,Ux=2,Ed=4;function nE(t,e,n){return e!=null?(e?Ud:0)|(e==="full"?Ux:0):t&&t.whitespace=="pre"?Ud|Ux:n&~Ed}class Fh{constructor(e,n,r,s,i,c){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=c,this.content=[],this.activeMarks=jn.none,this.match=i||(c&Ed?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Pe.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ud)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let n=Pe.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Pe.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!IN.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class rE{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,i,c=nE(null,n.preserveWhitespace,0)|(r?Ed:0);s?i=new Fh(s.type,s.attrs,jn.none,!0,n.topMatch||s.type.contentMatch,c):r?i=new Fh(null,null,jn.none,!0,null,c):i=new Fh(e.schema.topNodeType,null,jn.none,!0,null,c),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,i=s.options&Ux?"full":this.localPreserveWS||(s.options&Ud)>0,{schema:c}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(c.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(c.linebreakReplacement.create())){let f=r.split(/\r?\n|\r/);for(let p=0;p<f.length;p++)p&&this.insertNode(c.linebreakReplacement.create(),n,!0),f[p]&&this.insertNode(c.text(f[p]),n,!/\S/.test(f[p]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let f=s.content[s.content.length-1],p=e.previousSibling;(!f||p&&p.nodeName=="BR"||f.isText&&/[ \t\r\n\u000c]$/.test(f.text))&&(r=r.slice(1))}r&&this.insertNode(c.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let c=e.nodeName.toLowerCase(),f;DN.hasOwnProperty(c)&&this.parser.normalizeLists&&yD(e);let p=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(f=this.parser.matchTag(e,this,r));e:if(p?p.ignore:bD.hasOwnProperty(c))this.findInside(e),this.ignoreFallback(e,n);else if(!p||p.skip||p.closeParent){p&&p.closeParent?this.open=Math.max(0,this.open-1):p&&p.skip.nodeType&&(e=p.skip);let g,C=this.needsBlock;if(IN.hasOwnProperty(c))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),g=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let v=p&&p.skip?n:this.readStyles(e,n);v&&this.addAll(e,v),g&&this.sync(i),this.needsBlock=C}else{let g=this.readStyles(e,n);g&&this.addElementByRule(e,p,g,p.consuming===!1?f:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],c=r.getPropertyValue(i);if(c)for(let f=void 0;;){let p=this.parser.matchStyle(i,c,this,f);if(!p)break;if(p.ignore)return null;if(p.clearMark?n=n.filter(g=>!p.clearMark(g)):n=n.concat(this.parser.schema.marks[p.mark].create(p.attrs)),p.consuming===!1)f=p;else break}}return n}addElementByRule(e,n,r,s){let i,c;if(n.node)if(c=this.parser.schema.nodes[n.node],c.isLeaf)this.insertNode(c.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let p=this.enter(c,n.attrs||null,r,n.preserveWhitespace);p&&(i=!0,r=p)}else{let p=this.parser.schema.marks[n.mark];r=r.concat(p.create(n.attrs))}let f=this.top;if(c&&c.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(p=>this.insertNode(p,r,!1));else{let p=e;typeof n.contentElement=="string"?p=e.querySelector(n.contentElement):typeof n.contentElement=="function"?p=n.contentElement(e):n.contentElement&&(p=n.contentElement),this.findAround(e,p,!0),this.addAll(p,r),this.findAround(e,p,!1)}i&&this.sync(f)&&this.open--}addAll(e,n,r,s){let i=r||0;for(let c=r?e.childNodes[r]:e.firstChild,f=s==null?null:e.childNodes[s];c!=f;c=c.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(c,n);this.findAtPoint(e,i)}findPlace(e,n,r){let s,i;for(let c=this.open,f=0;c>=0;c--){let p=this.nodes[c],g=p.findWrapping(e);if(g&&(!s||s.length>g.length+f)&&(s=g,i=p,!g.length))break;if(p.solid){if(r)break;f+=2}}if(!s)return null;this.sync(i);for(let c=0;c<s.length;c++)n=this.enterInner(s[c],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let c=jn.none;for(let f of s.concat(e.marks))(i.type?i.type.allowsMarkType(f.type):iE(f.type,e.type))&&(c=f.addToSet(c));return i.content.push(e.mark(c)),!0}return!1}enter(e,n,r,s){let i=this.findPlace(e.create(n),r,!1);return i&&(i=this.enterInner(e,n,r,!0,s)),i}enterInner(e,n,r,s=!1,i){this.closeExtra();let c=this.top;c.match=c.match&&c.match.matchType(e);let f=nE(e,i,c.options);c.options&Ed&&c.content.length==0&&(f|=Ed);let p=jn.none;return r=r.filter(g=>(c.type?c.type.allowsMarkType(g.type):iE(g.type,e))?(p=g.addToSet(p),!1):!0),this.nodes.push(new Fh(e,n,p,s,null,f)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Ud)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),c=(f,p)=>{for(;f>=0;f--){let g=n[f];if(g==""){if(f==n.length-1||f==0)continue;for(;p>=i;p--)if(c(f-1,p))return!0;return!1}else{let C=p>0||p==0&&s?this.nodes[p].type:r&&p>=i?r.node(p-i).type:null;if(!C||C.name!=g&&!C.isInGroup(g))return!1;p--}}return!0};return c(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function yD(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&DN.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function wD(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function sE(t){let e={};for(let n in t)e[n]=t[n];return e}function iE(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let i=[],c=f=>{i.push(f);for(let p=0;p<f.edgeCount;p++){let{type:g,next:C}=f.edge(p);if(g==e||i.indexOf(C)<0&&c(C))return!0}};if(c(s.contentMatch))return!0}}class Wl{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Sg(n).createDocumentFragment());let s=r,i=[];return e.forEach(c=>{if(i.length||c.marks.length){let f=0,p=0;for(;f<i.length&&p<c.marks.length;){let g=c.marks[p];if(!this.marks[g.type.name]){p++;continue}if(!g.eq(i[f][0])||g.type.spec.spanning===!1)break;f++,p++}for(;f<i.length;)s=i.pop()[1];for(;p<c.marks.length;){let g=c.marks[p++],C=this.serializeMark(g,c.isInline,n);C&&(i.push([g,s]),s.appendChild(C.dom),s=C.contentDOM||C.dom)}}s.appendChild(this.serializeNodeInner(c,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=l0(Sg(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&l0(Sg(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return l0(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Wl(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=aE(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return aE(e.marks)}}function aE(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Sg(t){return t.document||window.document}const oE=new WeakMap;function vD(t){let e=oE.get(t);return e===void 0&&oE.set(t,e=CD(t)),e}function CD(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function l0(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=vD(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let c=s.indexOf(" ");c>0&&(n=s.slice(0,c),s=s.slice(c+1));let f,p=n?t.createElementNS(n,s):t.createElement(s),g=e[1],C=1;if(g&&typeof g=="object"&&g.nodeType==null&&!Array.isArray(g)){C=2;for(let v in g)if(g[v]!=null){let A=v.indexOf(" ");A>0?p.setAttributeNS(v.slice(0,A),v.slice(A+1),g[v]):v=="style"&&p.style?p.style.cssText=g[v]:p.setAttribute(v,g[v])}}for(let v=C;v<e.length;v++){let A=e[v];if(A===0){if(v<e.length-1||v>C)throw new RangeError("Content hole must be the only child of its parent node");return{dom:p,contentDOM:p}}else{let{dom:T,contentDOM:_}=l0(t,A,n,r);if(p.appendChild(T),_){if(f)throw new RangeError("Multiple content holes");f=_}}}return{dom:p,contentDOM:f}}const LN=65535,jN=Math.pow(2,16);function ED(t,e){return t+e*jN}function lE(t){return t&LN}function SD(t){return(t-(t&LN))/jN}const BN=1,PN=2,c0=4,FN=8;class Hx{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&FN)>0}get deletedBefore(){return(this.delInfo&(BN|c0))>0}get deletedAfter(){return(this.delInfo&(PN|c0))>0}get deletedAcross(){return(this.delInfo&c0)>0}}class Us{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Us.empty)return Us.empty}recover(e){let n=0,r=lE(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+SD(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,i=this.inverted?2:1,c=this.inverted?1:2;for(let f=0;f<this.ranges.length;f+=3){let p=this.ranges[f]-(this.inverted?s:0);if(p>e)break;let g=this.ranges[f+i],C=this.ranges[f+c],v=p+g;if(e<=v){let A=g?e==p?-1:e==v?1:n:n,T=p+s+(A<0?0:C);if(r)return T;let _=e==(n<0?p:v)?null:ED(f/3,e-p),M=e==p?PN:e==v?BN:c0;return(n<0?e!=p:e!=v)&&(M|=FN),new Hx(T,M,_)}s+=C-g}return r?e+s:new Hx(e+s,0,null)}touches(e,n){let r=0,s=lE(n),i=this.inverted?2:1,c=this.inverted?1:2;for(let f=0;f<this.ranges.length;f+=3){let p=this.ranges[f]-(this.inverted?r:0);if(p>e)break;let g=this.ranges[f+i],C=p+g;if(e<=C&&f==s*3)return!0;r+=this.ranges[f+c]-g}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let c=this.ranges[s],f=c-(this.inverted?i:0),p=c+(this.inverted?0:i),g=this.ranges[s+n],C=this.ranges[s+r];e(f,f+g,p,p+C),i+=C-g}}invert(){return new Us(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Us.empty:new Us(e<0?[0,-e,0]:[0,0,e])}}Us.empty=new Us([]);class Hd{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Hd(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new Hd;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let i=this.from;i<this.to;i++){let c=this._maps[i],f=c.mapResult(e,n);if(f.recover!=null){let p=this.getMirror(i);if(p!=null&&p>i&&p<this.to){i=p,e=this._maps[p].recover(f.recover);continue}}s|=f.delInfo,e=f.pos}return r?e:new Hx(e,s,null)}}const Ag=Object.create(null);class ss{getMap(){return Us.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ag[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Ag)throw new RangeError("Duplicate use of step JSON ID "+e);return Ag[e]=n,n.prototype.jsonID=e,n}}class vr{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new vr(e,null)}static fail(e){return new vr(null,e)}static fromReplace(e,n,r,s){try{return vr.ok(e.replace(n,r,s))}catch(i){if(i instanceof D0)return vr.fail(i.message);throw i}}}function Z2(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let i=t.child(s);i.content.size&&(i=i.copy(Z2(i.content,e,i))),i.isInline&&(i=e(i,n,s)),r.push(i)}return Pe.fromArray(r)}class Oo extends ss{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new st(Z2(n.content,(c,f)=>!c.isAtom||!f.type.allowsMarkType(this.mark.type)?c:c.mark(this.mark.addToSet(c.marks)),s),n.openStart,n.openEnd);return vr.fromReplace(e,this.from,this.to,i)}invert(){return new mi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Oo(n.pos,r.pos,this.mark)}merge(e){return e instanceof Oo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Oo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Oo(n.from,n.to,e.markFromJSON(n.mark))}}ss.jsonID("addMark",Oo);class mi extends ss{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new st(Z2(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return vr.fromReplace(e,this.from,this.to,r)}invert(){return new Oo(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new mi(n.pos,r.pos,this.mark)}merge(e){return e instanceof mi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new mi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new mi(n.from,n.to,e.markFromJSON(n.mark))}}ss.jsonID("removeMark",mi);class _o extends ss{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return vr.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return vr.fromReplace(e,this.pos,this.pos+1,new st(Pe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new _o(this.pos,n.marks[s]);return new _o(this.pos,this.mark)}}return new Pl(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new _o(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new _o(n.pos,e.markFromJSON(n.mark))}}ss.jsonID("addNodeMark",_o);class Pl extends ss{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return vr.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return vr.fromReplace(e,this.pos,this.pos+1,new st(Pe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new _o(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Pl(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Pl(n.pos,e.markFromJSON(n.mark))}}ss.jsonID("removeNodeMark",Pl);class Rr extends ss{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&Vx(e,this.from,this.to)?vr.fail("Structure replace would overwrite content"):vr.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Us([this.from,this.to-this.from,this.slice.size])}invert(e){return new Rr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Rr(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Rr)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?st.empty:new st(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Rr(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?st.empty:new st(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Rr(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Rr(n.from,n.to,st.fromJSON(e,n.slice),!!n.structure)}}ss.jsonID("replace",Rr);class Ir extends ss{constructor(e,n,r,s,i,c,f=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=c,this.structure=f}apply(e){if(this.structure&&(Vx(e,this.from,this.gapFrom)||Vx(e,this.gapTo,this.to)))return vr.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return vr.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?vr.fromReplace(e,this.from,this.to,r):vr.fail("Content does not fit in gap")}getMap(){return new Us([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Ir(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||i>r.pos?null:new Ir(n.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ir(n.from,n.to,n.gapFrom,n.gapTo,st.fromJSON(e,n.slice),n.insert,!!n.structure)}}ss.jsonID("replaceAround",Ir);function Vx(t,e,n){let r=t.resolve(e),s=n-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let c=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!c||c.isLeaf)return!0;c=c.firstChild,s--}}return!1}function AD(t,e,n,r){let s=[],i=[],c,f;t.doc.nodesBetween(e,n,(p,g,C)=>{if(!p.isInline)return;let v=p.marks;if(!r.isInSet(v)&&C.type.allowsMarkType(r.type)){let A=Math.max(g,e),T=Math.min(g+p.nodeSize,n),_=r.addToSet(v);for(let M=0;M<v.length;M++)v[M].isInSet(_)||(c&&c.to==A&&c.mark.eq(v[M])?c.to=T:s.push(c=new mi(A,T,v[M])));f&&f.to==A?f.to=T:i.push(f=new Oo(A,T,r))}}),s.forEach(p=>t.step(p)),i.forEach(p=>t.step(p))}function ND(t,e,n,r){let s=[],i=0;t.doc.nodesBetween(e,n,(c,f)=>{if(!c.isInline)return;i++;let p=null;if(r instanceof $p){let g=c.marks,C;for(;C=r.isInSet(g);)(p||(p=[])).push(C),g=C.removeFromSet(g)}else r?r.isInSet(c.marks)&&(p=[r]):p=c.marks;if(p&&p.length){let g=Math.min(f+c.nodeSize,n);for(let C=0;C<p.length;C++){let v=p[C],A;for(let T=0;T<s.length;T++){let _=s[T];_.step==i-1&&v.eq(s[T].style)&&(A=_)}A?(A.to=g,A.step=i):s.push({style:v,from:Math.max(f,e),to:g,step:i})}}}),s.forEach(c=>t.step(new mi(c.from,c.to,c.style)))}function J2(t,e,n,r=n.contentMatch,s=!0){let i=t.doc.nodeAt(e),c=[],f=e+1;for(let p=0;p<i.childCount;p++){let g=i.child(p),C=f+g.nodeSize,v=r.matchType(g.type);if(!v)c.push(new Rr(f,C,st.empty));else{r=v;for(let A=0;A<g.marks.length;A++)n.allowsMarkType(g.marks[A].type)||t.step(new mi(f,C,g.marks[A]));if(s&&g.isText&&n.whitespace!="pre"){let A,T=/\r?\n|\r/g,_;for(;A=T.exec(g.text);)_||(_=new st(Pe.from(n.schema.text(" ",n.allowedMarks(g.marks))),0,0)),c.push(new Rr(f+A.index,f+A.index+A[0].length,_))}}f=C}if(!r.validEnd){let p=r.fillBefore(Pe.empty,!0);t.replace(f,f,new st(p,0,0))}for(let p=c.length-1;p>=0;p--)t.step(c[p])}function kD(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function hu(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,i=0;;--r){let c=t.$from.node(r),f=t.$from.index(r)+s,p=t.$to.indexAfter(r)-i;if(r<t.depth&&c.canReplace(f,p,n))return r;if(r==0||c.type.spec.isolating||!kD(c,f,p))break;f&&(s=1),p<c.childCount&&(i=1)}return null}function TD(t,e,n){let{$from:r,$to:s,depth:i}=e,c=r.before(i+1),f=s.after(i+1),p=c,g=f,C=Pe.empty,v=0;for(let _=i,M=!1;_>n;_--)M||r.index(_)>0?(M=!0,C=Pe.from(r.node(_).copy(C)),v++):p--;let A=Pe.empty,T=0;for(let _=i,M=!1;_>n;_--)M||s.after(_+1)<s.end(_)?(M=!0,A=Pe.from(s.node(_).copy(A)),T++):g++;t.step(new Ir(p,g,c,f,new st(C.append(A),v,T),C.size-v,!0))}function Q2(t,e,n=null,r=t){let s=OD(t,e),i=s&&_D(r,e);return i?s.map(cE).concat({type:e,attrs:n}).concat(i.map(cE)):null}function cE(t){return{type:t,attrs:null}}function OD(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let c=i.length?i[0]:e;return n.canReplaceWith(r,s,c)?i:null}function _D(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.child(r),c=e.contentMatch.findWrapping(i.type);if(!c)return null;let p=(c.length?c[c.length-1]:e).contentMatch;for(let g=r;p&&g<s;g++)p=p.matchType(n.child(g).type);return!p||!p.validEnd?null:c}function RD(t,e,n){let r=Pe.empty;for(let c=n.length-1;c>=0;c--){if(r.size){let f=n[c].type.contentMatch.matchFragment(r);if(!f||!f.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Pe.from(n[c].type.create(n[c].attrs,r))}let s=e.start,i=e.end;t.step(new Ir(s,i,s,i,new st(r,0,0),n.length,!0))}function MD(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(c,f)=>{let p=typeof s=="function"?s(c):s;if(c.isTextblock&&!c.hasMarkup(r,p)&&ID(t.doc,t.mapping.slice(i).map(f),r)){let g=null;if(r.schema.linebreakReplacement){let T=r.whitespace=="pre",_=!!r.contentMatch.matchType(r.schema.linebreakReplacement);T&&!_?g=!1:!T&&_&&(g=!0)}g===!1&&UN(t,c,f,i),J2(t,t.mapping.slice(i).map(f,1),r,void 0,g===null);let C=t.mapping.slice(i),v=C.map(f,1),A=C.map(f+c.nodeSize,1);return t.step(new Ir(v,A,v+1,A-1,new st(Pe.from(r.create(p,null,c.marks)),0,0),1,!0)),g===!0&&zN(t,c,f,i),!1}})}function zN(t,e,n,r){e.forEach((s,i)=>{if(s.isText){let c,f=/\r?\n|\r/g;for(;c=f.exec(s.text);){let p=t.mapping.slice(r).map(n+1+i+c.index);t.replaceWith(p,p+1,e.type.schema.linebreakReplacement.create())}}})}function UN(t,e,n,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let c=t.mapping.slice(r).map(n+1+i);t.replaceWith(c,c+1,e.type.schema.text(`
`))}})}function ID(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function DD(t,e,n,r,s){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let c=n.create(r,null,s||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,c);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Ir(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new st(Pe.from(c),0,0),1,!0))}function Ta(t,e,n=1,r){let s=t.resolve(e),i=s.depth-n,c=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!c.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let g=s.depth-1,C=n-2;g>i;g--,C--){let v=s.node(g),A=s.index(g);if(v.type.spec.isolating)return!1;let T=v.content.cutByIndex(A,v.childCount),_=r&&r[C+1];_&&(T=T.replaceChild(0,_.type.create(_.attrs)));let M=r&&r[C]||v;if(!v.canReplace(A+1,v.childCount)||!M.type.validContent(T))return!1}let f=s.indexAfter(i),p=r&&r[0];return s.node(i).canReplaceWith(f,f,p?p.type:s.node(i+1).type)}function LD(t,e,n=1,r){let s=t.doc.resolve(e),i=Pe.empty,c=Pe.empty;for(let f=s.depth,p=s.depth-n,g=n-1;f>p;f--,g--){i=Pe.from(s.node(f).copy(i));let C=r&&r[g];c=Pe.from(C?C.type.create(C.attrs,c):s.node(f).copy(c))}t.step(new Rr(e,e,new st(i.append(c),n,n),!0))}function Uo(t,e){let n=t.resolve(e),r=n.index();return HN(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function jD(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),c=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(c),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function HN(t,e){return!!(t&&e&&!t.isLeaf&&jD(t,e))}function Xp(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let i,c,f=r.index(s);if(s==r.depth?(i=r.nodeBefore,c=r.nodeAfter):n>0?(i=r.node(s+1),f++,c=r.node(s).maybeChild(f)):(i=r.node(s).maybeChild(f-1),c=r.node(s+1)),i&&!i.isTextblock&&HN(i,c)&&r.node(s).canReplace(f,f+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function BD(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,i=t.doc.resolve(e-n),c=i.node().type;if(s&&c.inlineContent){let C=c.whitespace=="pre",v=!!c.contentMatch.matchType(s);C&&!v?r=!1:!C&&v&&(r=!0)}let f=t.steps.length;if(r===!1){let C=t.doc.resolve(e+n);UN(t,C.node(),C.before(),f)}c.inlineContent&&J2(t,e+n-1,c,i.node().contentMatchAt(i.index()),r==null);let p=t.mapping.slice(f),g=p.map(e-n);if(t.step(new Rr(g,p.map(e+n,-1),st.empty,!0)),r===!0){let C=t.doc.resolve(g);zN(t,C.node(),C.before(),t.steps.length)}return t}function PD(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,n))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,n))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function VN(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let i=0;i<n.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let c=r.depth;c>=0;c--){let f=c==r.depth?0:r.pos<=(r.start(c+1)+r.end(c+1))/2?-1:1,p=r.index(c)+(f>0?1:0),g=r.node(c),C=!1;if(i==1)C=g.canReplace(p,p,s);else{let v=g.contentMatchAt(p).findWrapping(s.firstChild.type);C=v&&g.canReplaceWith(p,p,v[0])}if(C)return f==0?r.pos:f<0?r.before(c+1):r.after(c+1)}return null}function Yp(t,e,n=e,r=st.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),i=t.resolve(n);return GN(s,i,r)?new Rr(e,n,r):new FD(s,i,r).fit()}function GN(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class FD{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Pe.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=Pe.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let g=this.findFittable();g?this.placeNodes(g):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,c=r.depth,f=s.depth;for(;c&&f&&i.childCount==1;)i=i.firstChild.content,c--,f--;let p=new st(i,c,f);return e>-1?new Ir(r.pos,e,this.$to.pos,this.$to.end(),p,n):p.size||r.pos!=this.$to.pos?new Rr(r.pos,s.pos,p):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Ng(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let c=s.firstChild;for(let f=this.depth;f>=0;f--){let{type:p,match:g}=this.frontier[f],C,v=null;if(n==1&&(c?g.matchType(c.type)||(v=g.fillBefore(Pe.from(c),!1)):i&&p.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:f,parent:i,inject:v};if(n==2&&c&&(C=g.findWrapping(c.type)))return{sliceDepth:r,frontierDepth:f,parent:i,wrap:C};if(i&&g.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Ng(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new st(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Ng(e,n);if(s.childCount<=1&&n>0){let i=e.size-n<=n+s.size;this.unplaced=new st(dd(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new st(dd(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let M=0;M<i.length;M++)this.openFrontierNode(i[M]);let c=this.unplaced,f=r?r.content:c.content,p=c.openStart-e,g=0,C=[],{match:v,type:A}=this.frontier[n];if(s){for(let M=0;M<s.childCount;M++)C.push(s.child(M));v=v.matchFragment(s)}let T=f.size+e-(c.content.size-c.openEnd);for(;g<f.childCount;){let M=f.child(g),R=v.matchType(M.type);if(!R)break;g++,(g>1||p==0||M.content.size)&&(v=R,C.push(WN(M.mark(A.allowedMarks(M.marks)),g==1?p:0,g==f.childCount?T:-1)))}let _=g==f.childCount;_||(T=-1),this.placed=fd(this.placed,n,Pe.from(C)),this.frontier[n].match=v,_&&T<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let M=0,R=f;M<T;M++){let j=R.lastChild;this.frontier.push({type:j.type,match:j.contentMatchAt(j.childCount)}),R=j.content}this.unplaced=_?e==0?st.empty:new st(dd(c.content,e-1,1),e-1,T<0?c.openEnd:e-1):new st(dd(c.content,e,g),c.openStart,c.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!kg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),c=kg(e,n,s,r,i);if(c){for(let f=n-1;f>=0;f--){let{match:p,type:g}=this.frontier[f],C=kg(e,f,g,p,!0);if(!C||C.childCount)continue e}return{depth:n,fit:c,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=fd(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=fd(this.placed,this.depth,Pe.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Pe.empty,!0);n.childCount&&(this.placed=fd(this.placed,this.frontier.length,n))}}function dd(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(dd(t.firstChild.content,e-1,n)))}function fd(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(fd(t.lastChild.content,e-1,n)))}function Ng(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function WN(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,WN(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Pe.empty,!0)))),t.copy(r)}function kg(t,e,n,r,s){let i=t.node(e),c=s?t.indexAfter(e):t.index(e);if(c==i.childCount&&!n.compatibleContent(i.type))return null;let f=r.fillBefore(i.content,!0,c);return f&&!zD(n,i.content,c)?f:null}function zD(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function UD(t){return t.spec.defining||t.spec.definingForContent}function HD(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),i=t.doc.resolve(n);if(GN(s,i,r))return t.step(new Rr(e,n,r));let c=$N(s,i);c[c.length-1]==0&&c.pop();let f=-(s.depth+1);c.unshift(f);for(let A=s.depth,T=s.pos-1;A>0;A--,T--){let _=s.node(A).type.spec;if(_.defining||_.definingAsContext||_.isolating)break;c.indexOf(A)>-1?f=A:s.before(A)==T&&c.splice(1,0,-A)}let p=c.indexOf(f),g=[],C=r.openStart;for(let A=r.content,T=0;;T++){let _=A.firstChild;if(g.push(_),T==r.openStart)break;A=_.content}for(let A=C-1;A>=0;A--){let T=g[A],_=UD(T.type);if(_&&!T.sameMarkup(s.node(Math.abs(f)-1)))C=A;else if(_||!T.type.isTextblock)break}for(let A=r.openStart;A>=0;A--){let T=(A+C+1)%(r.openStart+1),_=g[T];if(_)for(let M=0;M<c.length;M++){let R=c[(M+p)%c.length],j=!0;R<0&&(j=!1,R=-R);let H=s.node(R-1),G=s.index(R-1);if(H.canReplaceWith(G,G,_.type,_.marks))return t.replace(s.before(R),j?i.after(R):n,new st(qN(r.content,0,r.openStart,T),T,r.openEnd))}}let v=t.steps.length;for(let A=c.length-1;A>=0&&(t.replace(e,n,r),!(t.steps.length>v));A--){let T=c[A];T<0||(e=s.before(T),n=i.after(T))}}function qN(t,e,n,r,s){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(qN(i.content,e+1,n,r,i)))}if(e>r){let i=s.contentMatchAt(0),c=i.fillBefore(t).append(t);t=c.append(i.matchFragment(c).fillBefore(Pe.empty,!0))}return t}function VD(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=PD(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new st(Pe.from(r),0,0))}function GD(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),i=$N(r,s);for(let c=0;c<i.length;c++){let f=i[c],p=c==i.length-1;if(p&&f==0||r.node(f).type.contentMatch.validEnd)return t.delete(r.start(f),s.end(f));if(f>0&&(p||r.node(f-1).canReplace(r.index(f-1),s.indexAfter(f-1))))return t.delete(r.before(f),s.after(f))}for(let c=1;c<=r.depth&&c<=s.depth;c++)if(e-r.start(c)==r.depth-c&&n>r.end(c)&&s.end(c)-n!=s.depth-c&&r.start(c-1)==s.start(c-1)&&r.node(c-1).canReplace(r.index(c-1),s.index(c-1)))return t.delete(r.before(c),n);t.delete(e,n)}function $N(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let i=t.start(s);if(i<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&n.push(s)}return n}class Uc extends ss{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return vr.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return vr.fromReplace(e,this.pos,this.pos+1,new st(Pe.from(s),0,n.isLeaf?0:1))}getMap(){return Us.empty}invert(e){return new Uc(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Uc(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Uc(n.pos,n.attr,n.value)}}ss.jsonID("attr",Uc);class Vd extends ss{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return vr.ok(r)}getMap(){return Us.empty}invert(e){return new Vd(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Vd(n.attr,n.value)}}ss.jsonID("docAttr",Vd);let Qc=class extends Error{};Qc=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Qc.prototype=Object.create(Error.prototype);Qc.prototype.constructor=Qc;Qc.prototype.name="TransformError";class eb{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Hd}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Qc(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let s=this.mapping.maps[r];r&&(e=s.map(e,1),n=s.map(n,-1)),s.forEach((i,c,f,p)=>{e=Math.min(e,f),n=Math.max(n,p)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=st.empty){let s=Yp(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new st(Pe.from(r),0,0))}delete(e,n){return this.replace(e,n,st.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return HD(this,e,n,r),this}replaceRangeWith(e,n,r){return VD(this,e,n,r),this}deleteRange(e,n){return GD(this,e,n),this}lift(e,n){return TD(this,e,n),this}join(e,n=1){return BD(this,e,n),this}wrap(e,n){return RD(this,e,n),this}setBlockType(e,n=e,r,s=null){return MD(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return DD(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Uc(e,n,r)),this}setDocAttribute(e,n){return this.step(new Vd(e,n)),this}addNodeMark(e,n){return this.step(new _o(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof jn)n.isInSet(r.marks)&&this.step(new Pl(e,n));else{let s=r.marks,i,c=[];for(;i=n.isInSet(s);)c.push(new Pl(e,i)),s=i.removeFromSet(s);for(let f=c.length-1;f>=0;f--)this.step(c[f])}return this}split(e,n=1,r){return LD(this,e,n,r),this}addMark(e,n,r){return AD(this,e,n,r),this}removeMark(e,n,r){return ND(this,e,n,r),this}clearIncompatible(e,n,r){return J2(this,e,n,r),this}}const Tg=Object.create(null);class Ot{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new XN(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=st.empty){let r=n.content.lastChild,s=null;for(let f=0;f<n.openEnd;f++)s=r,r=r.lastChild;let i=e.steps.length,c=this.ranges;for(let f=0;f<c.length;f++){let{$from:p,$to:g}=c[f],C=e.mapping.slice(i);e.replaceRange(C.map(p.pos),C.map(g.pos),f?st.empty:n),f==0&&fE(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:c,$to:f}=s[i],p=e.mapping.slice(r),g=p.map(c.pos),C=p.map(f.pos);i?e.deleteRange(g,C):(e.replaceRangeWith(g,C,n),fE(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new Ct(e):Rc(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let c=n<0?Rc(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):Rc(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(c)return c}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Vs(e.node(0))}static atStart(e){return Rc(e,e,0,0,1)||new Vs(e)}static atEnd(e){return Rc(e,e,e.content.size,e.childCount,-1)||new Vs(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Tg[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Tg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Tg[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ct.between(this.$anchor,this.$head).getBookmark()}}Ot.prototype.visible=!0;class XN{constructor(e,n){this.$from=e,this.$to=n}}let uE=!1;function dE(t){!uE&&!t.parent.inlineContent&&(uE=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ct extends Ot{constructor(e,n=e){dE(e),dE(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ot.near(r);let s=e.resolve(n.map(this.anchor));return new Ct(s.parent.inlineContent?s:r,r)}replace(e,n=st.empty){if(super.replace(e,n),n==st.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ct&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Kp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ct(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let i=Ot.findFrom(n,r,!0)||Ot.findFrom(n,-r,!0);if(i)n=i.$head;else return Ot.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(Ot.findFrom(e,-r,!0)||Ot.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new Ct(e,n)}}Ot.jsonID("text",Ct);class Kp{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Kp(e.map(this.anchor),e.map(this.head))}resolve(e){return Ct.between(e.resolve(this.anchor),e.resolve(this.head))}}class vt extends Ot{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),i=e.resolve(s);return r?Ot.near(i):new vt(i)}content(){return new st(Pe.from(this.node),0,0)}eq(e){return e instanceof vt&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new tb(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new vt(e.resolve(n.anchor))}static create(e,n){return new vt(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}vt.prototype.visible=!1;Ot.jsonID("node",vt);class tb{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Kp(r,r):new tb(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&vt.isSelectable(r)?new vt(n):Ot.near(n)}}class Vs extends Ot{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=st.empty){if(n==st.empty){e.delete(0,e.doc.content.size);let r=Ot.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Vs(e)}map(e){return new Vs(e)}eq(e){return e instanceof Vs}getBookmark(){return WD}}Ot.jsonID("all",Vs);const WD={map(){return this},resolve(t){return new Vs(t)}};function Rc(t,e,n,r,s,i=!1){if(e.inlineContent)return Ct.create(t,n);for(let c=r-(s>0?0:1);s>0?c<e.childCount:c>=0;c+=s){let f=e.child(c);if(f.isAtom){if(!i&&vt.isSelectable(f))return vt.create(t,n-(s<0?f.nodeSize:0))}else{let p=Rc(t,f,n+s,s<0?f.childCount:0,s,i);if(p)return p}n+=f.nodeSize*s}return null}function fE(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof Rr||s instanceof Ir))return;let i=t.mapping.maps[r],c;i.forEach((f,p,g,C)=>{c==null&&(c=C)}),t.setSelection(Ot.near(t.doc.resolve(c),n))}const hE=1,zh=2,pE=4;class qD extends eb{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|hE)&~zh,this.storedMarks=null,this}get selectionSet(){return(this.updated&hE)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=zh,this}ensureMarks(e){return jn.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&zh)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~zh,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||jn.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let c=this.doc.resolve(n);i=r==n?c.marks():c.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,i)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Ot.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=pE,this}get scrolledIntoView(){return(this.updated&pE)>0}}function mE(t,e){return!e||!t?t:t.bind(e)}class hd{constructor(e,n,r){this.name=e,this.init=mE(n.init,r),this.apply=mE(n.apply,r)}}const $D=[new hd("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new hd("selection",{init(t,e){return t.selection||Ot.atStart(e.doc)},apply(t){return t.selection}}),new hd("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new hd("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Og{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=$D.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new hd(r.key,r.spec.state,r))})}}class jc{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let c=0;c<this.config.plugins.length;c++){let f=this.config.plugins[c];if(f.spec.appendTransaction){let p=s?s[c].n:0,g=s?s[c].state:this,C=p<n.length&&f.spec.appendTransaction.call(f,p?n.slice(p):n,g,r);if(C&&r.filterTransaction(C,c)){if(C.setMeta("appendedTransaction",e),!s){s=[];for(let v=0;v<this.config.plugins.length;v++)s.push(v<c?{state:r,n:n.length}:{state:this,n:0})}n.push(C),r=r.applyInner(C),i=!0}s&&(s[c]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new jc(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new qD(this)}static create(e){let n=new Og(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new jc(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new Og(this.schema,e.plugins),r=n.fields,s=new jc(n);for(let i=0;i<r.length;i++){let c=r[i].name;s[c]=this.hasOwnProperty(c)?this[c]:r[i].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Og(e.schema,e.plugins),i=new jc(s);return s.fields.forEach(c=>{if(c.name=="doc")i.doc=xi.fromJSON(e.schema,n.doc);else if(c.name=="selection")i.selection=Ot.fromJSON(i.doc,n.selection);else if(c.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let f in r){let p=r[f],g=p.spec.state;if(p.key==c.name&&g&&g.fromJSON&&Object.prototype.hasOwnProperty.call(n,f)){i[c.name]=g.fromJSON.call(p,e,n[f],i);return}}i[c.name]=c.init(e,i)}}),i}}function YN(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=YN(s,e,{})),n[r]=s}return n}class qn{constructor(e){this.spec=e,this.props={},e.props&&YN(e.props,this,this.props),this.key=e.key?e.key.key:KN("plugin")}getState(e){return e[this.key]}}const _g=Object.create(null);function KN(t){return t in _g?t+"$"+ ++_g[t]:(_g[t]=0,t+"$")}class ur{constructor(e="key"){this.key=KN(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const nb=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function ZN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const JN=(t,e,n)=>{let r=ZN(t,n);if(!r)return!1;let s=rb(r);if(!s){let c=r.blockRange(),f=c&&hu(c);return f==null?!1:(e&&e(t.tr.lift(c,f).scrollIntoView()),!0)}let i=s.nodeBefore;if(ok(t,s,e,-1))return!0;if(r.parent.content.size==0&&(eu(i,"end")||vt.isSelectable(i)))for(let c=r.depth;;c--){let f=Yp(t.doc,r.before(c),r.after(c),st.empty);if(f&&f.slice.size<f.to-f.from){if(e){let p=t.tr.step(f);p.setSelection(eu(i,"end")?Ot.findFrom(p.doc.resolve(p.mapping.map(s.pos,-1)),-1):vt.create(p.doc,s.pos-i.nodeSize)),e(p.scrollIntoView())}return!0}if(c==1||r.node(c-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},XD=(t,e,n)=>{let r=ZN(t,n);if(!r)return!1;let s=rb(r);return s?QN(t,s,e):!1},YD=(t,e,n)=>{let r=tk(t,n);if(!r)return!1;let s=sb(r);return s?QN(t,s,e):!1};function QN(t,e,n){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let C=s.lastChild;if(!C)return!1;s=C}let c=e.nodeAfter,f=c,p=e.pos+1;for(;!f.isTextblock;p++){if(f.type.spec.isolating)return!1;let C=f.firstChild;if(!C)return!1;f=C}let g=Yp(t.doc,i,p,st.empty);if(!g||g.from!=i||g instanceof Rr&&g.slice.size>=p-i)return!1;if(n){let C=t.tr.step(g);C.setSelection(Ct.create(C.doc,i)),n(C.scrollIntoView())}return!0}function eu(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const ek=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=rb(r)}let c=i&&i.nodeBefore;return!c||!vt.isSelectable(c)?!1:(e&&e(t.tr.setSelection(vt.create(t.doc,i.pos-c.nodeSize)).scrollIntoView()),!0)};function rb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function tk(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const nk=(t,e,n)=>{let r=tk(t,n);if(!r)return!1;let s=sb(r);if(!s)return!1;let i=s.nodeAfter;if(ok(t,s,e,1))return!0;if(r.parent.content.size==0&&(eu(i,"start")||vt.isSelectable(i))){let c=Yp(t.doc,r.before(),r.after(),st.empty);if(c&&c.slice.size<c.to-c.from){if(e){let f=t.tr.step(c);f.setSelection(eu(i,"start")?Ot.findFrom(f.doc.resolve(f.mapping.map(s.pos)),1):vt.create(f.doc,f.mapping.map(s.pos))),e(f.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},rk=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=sb(r)}let c=i&&i.nodeAfter;return!c||!vt.isSelectable(c)?!1:(e&&e(t.tr.setSelection(vt.create(t.doc,i.pos)).scrollIntoView()),!0)};function sb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const KD=(t,e)=>{let n=t.selection,r=n instanceof vt,s;if(r){if(n.node.isTextblock||!Uo(t.doc,n.from))return!1;s=n.from}else if(s=Xp(t.doc,n.from,-1),s==null)return!1;if(e){let i=t.tr.join(s);r&&i.setSelection(vt.create(i.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},ZD=(t,e)=>{let n=t.selection,r;if(n instanceof vt){if(n.node.isTextblock||!Uo(t.doc,n.to))return!1;r=n.to}else if(r=Xp(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},JD=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),i=s&&hu(s);return i==null?!1:(e&&e(t.tr.lift(s,i).scrollIntoView()),!0)},sk=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function ib(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const QD=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),c=ib(s.contentMatchAt(i));if(!c||!s.canReplaceWith(i,i,c))return!1;if(e){let f=n.after(),p=t.tr.replaceWith(f,f,c.createAndFill());p.setSelection(Ot.near(p.doc.resolve(f),1)),e(p.scrollIntoView())}return!0},ik=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof Vs||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=ib(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let c=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,f=t.tr.insert(c,i.createAndFill());f.setSelection(Ct.create(f.doc,c+1)),e(f.scrollIntoView())}return!0},ak=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(Ta(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),s=r&&hu(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function e7(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof vt&&e.selection.node.isBlock)return!r.parentOffset||!Ta(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],c,f,p=!1,g=!1;for(let T=r.depth;;T--)if(r.node(T).isBlock){p=r.end(T)==r.pos+(r.depth-T),g=r.start(T)==r.pos-(r.depth-T),f=ib(r.node(T-1).contentMatchAt(r.indexAfter(T-1))),i.unshift(p&&f?{type:f}:null),c=T;break}else{if(T==1)return!1;i.unshift(null)}let C=e.tr;(e.selection instanceof Ct||e.selection instanceof Vs)&&C.deleteSelection();let v=C.mapping.map(r.pos),A=Ta(C.doc,v,i.length,i);if(A||(i[0]=f?{type:f}:null,A=Ta(C.doc,v,i.length,i)),!A)return!1;if(C.split(v,i.length,i),!p&&g&&r.node(c).type!=f){let T=C.mapping.map(r.before(c)),_=C.doc.resolve(T);f&&r.node(c-1).canReplaceWith(_.index(),_.index()+1,f)&&C.setNodeMarkup(C.mapping.map(r.before(c)),f)}return n&&n(C.scrollIntoView()),!0}}const t7=e7(),n7=(t,e)=>{let{$from:n,to:r}=t.selection,s,i=n.sharedDepth(r);return i==0?!1:(s=n.before(i),e&&e(t.tr.setSelection(vt.create(t.doc,s))),!0)};function r7(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||Uo(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function ok(t,e,n,r){let s=e.nodeBefore,i=e.nodeAfter,c,f,p=s.type.spec.isolating||i.type.spec.isolating;if(!p&&r7(t,e,n))return!0;let g=!p&&e.parent.canReplace(e.index(),e.index()+1);if(g&&(c=(f=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&f.matchType(c[0]||i.type).validEnd){if(n){let T=e.pos+i.nodeSize,_=Pe.empty;for(let j=c.length-1;j>=0;j--)_=Pe.from(c[j].create(null,_));_=Pe.from(s.copy(_));let M=t.tr.step(new Ir(e.pos-1,T,e.pos,T,new st(_,1,0),c.length,!0)),R=M.doc.resolve(T+2*c.length);R.nodeAfter&&R.nodeAfter.type==s.type&&Uo(M.doc,R.pos)&&M.join(R.pos),n(M.scrollIntoView())}return!0}let C=i.type.spec.isolating||r>0&&p?null:Ot.findFrom(e,1),v=C&&C.$from.blockRange(C.$to),A=v&&hu(v);if(A!=null&&A>=e.depth)return n&&n(t.tr.lift(v,A).scrollIntoView()),!0;if(g&&eu(i,"start",!0)&&eu(s,"end")){let T=s,_=[];for(;_.push(T),!T.isTextblock;)T=T.lastChild;let M=i,R=1;for(;!M.isTextblock;M=M.firstChild)R++;if(T.canReplace(T.childCount,T.childCount,M.content)){if(n){let j=Pe.empty;for(let G=_.length-1;G>=0;G--)j=Pe.from(_[G].copy(j));let H=t.tr.step(new Ir(e.pos-_.length,e.pos+i.nodeSize,e.pos+R,e.pos+i.nodeSize-R,new st(j,_.length,0),0,!0));n(H.scrollIntoView())}return!0}}return!1}function lk(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(n&&n(e.tr.setSelection(Ct.create(e.doc,t<0?s.start(i):s.end(i)))),!0):!1}}const s7=lk(-1),i7=lk(1);function a7(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,c=s.blockRange(i),f=c&&Q2(c,t,e);return f?(r&&r(n.tr.wrap(c,f).scrollIntoView()),!0):!1}}function gE(t,e=null){return function(n,r){let s=!1;for(let i=0;i<n.selection.ranges.length&&!s;i++){let{$from:{pos:c},$to:{pos:f}}=n.selection.ranges[i];n.doc.nodesBetween(c,f,(p,g)=>{if(s)return!1;if(!(!p.isTextblock||p.hasMarkup(t,e)))if(p.type==t)s=!0;else{let C=n.doc.resolve(g),v=C.index();s=C.parent.canReplaceWith(v,v+1,t)}})}if(!s)return!1;if(r){let i=n.tr;for(let c=0;c<n.selection.ranges.length;c++){let{$from:{pos:f},$to:{pos:p}}=n.selection.ranges[c];i.setBlockType(f,p,t,e)}r(i.scrollIntoView())}return!0}}function ab(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}ab(nb,JN,ek);ab(nb,nk,rk);ab(sk,ik,ak,t7);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function o7(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,c=s.blockRange(i);if(!c)return!1;let f=r?n.tr:null;return l7(f,c,t,e)?(r&&r(f.scrollIntoView()),!0):!1}}function l7(t,e,n,r=null){let s=!1,i=e,c=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let p=c.resolve(e.start-2);i=new j0(p,p,e.depth),e.endIndex<e.parent.childCount&&(e=new j0(e.$from,c.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let f=Q2(i,n,r,e);return f?(t&&c7(t,e,f,s,n),!0):!1}function c7(t,e,n,r,s){let i=Pe.empty;for(let C=n.length-1;C>=0;C--)i=Pe.from(n[C].type.create(n[C].attrs,i));t.step(new Ir(e.start-(r?2:0),e.end,e.start,e.end,new st(i,0,0),n.length,!0));let c=0;for(let C=0;C<n.length;C++)n[C].type==s&&(c=C+1);let f=n.length-c,p=e.start+n.length-(r?2:0),g=e.parent;for(let C=e.startIndex,v=e.endIndex,A=!0;C<v;C++,A=!1)!A&&Ta(t.doc,p,f)&&(t.split(p,f),p+=2*f),p+=g.child(C).nodeSize;return t}function u7(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?d7(e,n,t,i):f7(e,n,i):!0:!1}}function d7(t,e,n,r){let s=t.tr,i=r.end,c=r.$to.end(r.depth);i<c&&(s.step(new Ir(i-1,c,i,c,new st(Pe.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new j0(s.doc.resolve(r.$from.pos),s.doc.resolve(c),r.depth));const f=hu(r);if(f==null)return!1;s.lift(r,f);let p=s.doc.resolve(s.mapping.map(i,-1)-1);return Uo(s.doc,p.pos)&&p.nodeBefore.type==p.nodeAfter.type&&s.join(p.pos),e(s.scrollIntoView()),!0}function f7(t,e,n){let r=t.tr,s=n.parent;for(let T=n.end,_=n.endIndex-1,M=n.startIndex;_>M;_--)T-=s.child(_).nodeSize,r.delete(T-1,T+1);let i=r.doc.resolve(n.start),c=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let f=n.startIndex==0,p=n.endIndex==s.childCount,g=i.node(-1),C=i.index(-1);if(!g.canReplace(C+(f?0:1),C+1,c.content.append(p?Pe.empty:Pe.from(s))))return!1;let v=i.pos,A=v+c.nodeSize;return r.step(new Ir(v-(f?1:0),A+(p?1:0),v+1,A-1,new st((f?Pe.empty:Pe.from(s.copy(Pe.empty))).append(p?Pe.empty:Pe.from(s.copy(Pe.empty))),f?0:1,p?0:1),f?0:1)),e(r.scrollIntoView()),!0}function h7(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,g=>g.childCount>0&&g.firstChild.type==t);if(!i)return!1;let c=i.startIndex;if(c==0)return!1;let f=i.parent,p=f.child(c-1);if(p.type!=t)return!1;if(n){let g=p.lastChild&&p.lastChild.type==f.type,C=Pe.from(g?t.create():null),v=new st(Pe.from(t.create(null,Pe.from(f.type.create(null,C)))),g?3:1,0),A=i.start,T=i.end;n(e.tr.step(new Ir(A-(g?3:1),T,A,T,v,1,!0)).scrollIntoView())}return!0}}const $r=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},tu=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Gx=null;const va=function(t,e,n){let r=Gx||(Gx=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},p7=function(){Gx=null},Fl=function(t,e,n,r){return n&&(xE(t,e,n,r,-1)||xE(t,e,n,r,1))},m7=/^(img|br|input|textarea|hr)$/i;function xE(t,e,n,r,s){for(var i;;){if(t==n&&e==r)return!0;if(e==(s<0?0:si(t))){let c=t.parentNode;if(!c||c.nodeType!=1||uf(t)||m7.test(t.nodeName)||t.contentEditable=="false")return!1;e=$r(t)+(s<0?0:1),t=c}else if(t.nodeType==1){let c=t.childNodes[e+(s<0?-1:0)];if(c.nodeType==1&&c.contentEditable=="false")if(!((i=c.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else t=c,e=s<0?si(t):0}else return!1}}function si(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function g7(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=si(t)}else if(t.parentNode&&!uf(t))e=$r(t),t=t.parentNode;else return null}}function x7(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!uf(t))e=$r(t)+1,t=t.parentNode;else return null}}function b7(t,e,n){for(let r=e==0,s=e==si(t);r||s;){if(t==n)return!0;let i=$r(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,s=s&&i==si(t)}}function uf(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Zp=function(t){return t.focusNode&&Fl(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function vl(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function y7(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function w7(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(si(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(si(r.startContainer),r.startOffset)}}}const Hi=typeof navigator<"u"?navigator:null,bE=typeof document<"u"?document:null,Ho=Hi&&Hi.userAgent||"",Wx=/Edge\/(\d+)/.exec(Ho),ck=/MSIE \d/.exec(Ho),qx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ho),Os=!!(ck||qx||Wx),Io=ck?document.documentMode:qx?+qx[1]:Wx?+Wx[1]:0,ii=!Os&&/gecko\/(\d+)/i.test(Ho);ii&&+(/Firefox\/(\d+)/.exec(Ho)||[0,0])[1];const $x=!Os&&/Chrome\/(\d+)/.exec(Ho),Yr=!!$x,uk=$x?+$x[1]:0,ns=!Os&&!!Hi&&/Apple Computer/.test(Hi.vendor),nu=ns&&(/Mobile\/\w+/.test(Ho)||!!Hi&&Hi.maxTouchPoints>2),ri=nu||(Hi?/Mac/.test(Hi.platform):!1),dk=Hi?/Win/.test(Hi.platform):!1,Sa=/Android \d/.test(Ho),df=!!bE&&"webkitFontSmoothing"in bE.documentElement.style,v7=df?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function C7(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ma(t,e){return typeof t=="number"?t:t[e]}function E7(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function yE(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let c=n||t.dom;c;){if(c.nodeType!=1){c=tu(c);continue}let f=c,p=f==i.body,g=p?C7(i):E7(f),C=0,v=0;if(e.top<g.top+ma(r,"top")?v=-(g.top-e.top+ma(s,"top")):e.bottom>g.bottom-ma(r,"bottom")&&(v=e.bottom-e.top>g.bottom-g.top?e.top+ma(s,"top")-g.top:e.bottom-g.bottom+ma(s,"bottom")),e.left<g.left+ma(r,"left")?C=-(g.left-e.left+ma(s,"left")):e.right>g.right-ma(r,"right")&&(C=e.right-g.right+ma(s,"right")),C||v)if(p)i.defaultView.scrollBy(C,v);else{let T=f.scrollLeft,_=f.scrollTop;v&&(f.scrollTop+=v),C&&(f.scrollLeft+=C);let M=f.scrollLeft-T,R=f.scrollTop-_;e={left:e.left-M,top:e.top-R,right:e.right-M,bottom:e.bottom-R}}let A=p?"fixed":getComputedStyle(c).position;if(/^(fixed|sticky)$/.test(A))break;c=A=="absolute"?c.offsetParent:tu(c)}}function S7(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,c=n+1;c<Math.min(innerHeight,e.bottom);c+=5){let f=t.root.elementFromPoint(i,c);if(!f||f==t.dom||!t.dom.contains(f))continue;let p=f.getBoundingClientRect();if(p.top>=n-20){r=f,s=p.top;break}}return{refDOM:r,refTop:s,stack:fk(t.dom)}}function fk(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=tu(r));return e}function A7({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;hk(n,r==0?0:r-e)}function hk(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:i}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Oc=null;function N7(t){if(t.setActive)return t.setActive();if(Oc)return t.focus(Oc);let e=fk(t);t.focus(Oc==null?{get preventScroll(){return Oc={preventScroll:!0},!0}}:void 0),Oc||(Oc=!1,hk(e,0))}function pk(t,e){let n,r=2e8,s,i=0,c=e.top,f=e.top,p,g;for(let C=t.firstChild,v=0;C;C=C.nextSibling,v++){let A;if(C.nodeType==1)A=C.getClientRects();else if(C.nodeType==3)A=va(C).getClientRects();else continue;for(let T=0;T<A.length;T++){let _=A[T];if(_.top<=c&&_.bottom>=f){c=Math.max(_.bottom,c),f=Math.min(_.top,f);let M=_.left>e.left?_.left-e.left:_.right<e.left?e.left-_.right:0;if(M<r){n=C,r=M,s=M&&n.nodeType==3?{left:_.right<e.left?_.right:_.left,top:e.top}:e,C.nodeType==1&&M&&(i=v+(e.left>=(_.left+_.right)/2?1:0));continue}}else _.top>e.top&&!p&&_.left<=e.left&&_.right>=e.left&&(p=C,g={left:Math.max(_.left,Math.min(_.right,e.left)),top:_.top});!n&&(e.left>=_.right&&e.top>=_.top||e.left>=_.left&&e.top>=_.bottom)&&(i=v+1)}}return!n&&p&&(n=p,s=g,r=0),n&&n.nodeType==3?k7(n,s):!n||r&&n.nodeType==1?{node:t,offset:i}:pk(n,s)}function k7(t,e){let n=t.nodeValue.length,r=document.createRange(),s;for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let c=xo(r,1);if(c.top!=c.bottom&&ob(e,c)){s={node:t,offset:i+(e.left>=(c.left+c.right)/2?1:0)};break}}return r.detach(),s||{node:t,offset:0}}function ob(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function T7(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function O7(t,e,n){let{node:r,offset:s}=pk(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let c=r.getBoundingClientRect();i=c.left!=c.right&&n.left>(c.left+c.right)/2?1:-1}return t.docView.posFromDOM(r,s,i)}function _7(t,e,n,r){let s=-1;for(let i=e,c=!1;i!=t.dom;){let f=t.docView.nearestDesc(i,!0),p;if(!f)return null;if(f.dom.nodeType==1&&(f.node.isBlock&&f.parent||!f.contentDOM)&&((p=f.dom.getBoundingClientRect()).width||p.height)&&(f.node.isBlock&&f.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(f.dom.nodeName)&&(!c&&p.left>r.left||p.top>r.top?s=f.posBefore:(!c&&p.right<r.left||p.bottom<r.top)&&(s=f.posAfter),c=!0),!f.contentDOM&&s<0&&!f.node.isText))return(f.node.isBlock?r.top<(p.top+p.bottom)/2:r.left<(p.left+p.right)/2)?f.posBefore:f.posAfter;i=f.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function mk(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=s;;){let c=t.childNodes[i];if(c.nodeType==1){let f=c.getClientRects();for(let p=0;p<f.length;p++){let g=f[p];if(ob(e,g))return mk(c,e,g)}}if((i=(i+1)%r)==s)break}return t}function R7(t,e){let n=t.dom.ownerDocument,r,s=0,i=w7(n,e.left,e.top);i&&({node:r,offset:s}=i);let c=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),f;if(!c||!t.dom.contains(c.nodeType!=1?c.parentNode:c)){let g=t.dom.getBoundingClientRect();if(!ob(e,g)||(c=mk(t.dom,e,g),!c))return null}if(ns)for(let g=c;r&&g;g=tu(g))g.draggable&&(r=void 0);if(c=T7(c,e),r){if(ii&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let C=r.childNodes[s],v;C.nodeName=="IMG"&&(v=C.getBoundingClientRect()).right<=e.left&&v.bottom>e.top&&s++}let g;df&&s&&r.nodeType==1&&(g=r.childNodes[s-1]).nodeType==1&&g.contentEditable=="false"&&g.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?f=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(f=_7(t,r,s,e))}f==null&&(f=O7(t,c,e));let p=t.docView.nearestDesc(c,!0);return{pos:f,inside:p?p.posAtStart-p.border:-1}}function wE(t){return t.top<t.bottom||t.left<t.right}function xo(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(wE(r))return r}return Array.prototype.find.call(n,wE)||t.getBoundingClientRect()}const M7=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function gk(t,e,n){let{node:r,offset:s,atom:i}=t.docView.domFromPos(e,n<0?-1:1),c=df||ii;if(r.nodeType==3)if(c&&(M7.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let p=xo(va(r,s,s),n);if(ii&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let g=xo(va(r,s-1,s-1),-1);if(g.top==p.top){let C=xo(va(r,s,s+1),-1);if(C.top!=p.top)return od(C,C.left<g.left)}}return p}else{let p=s,g=s,C=n<0?1:-1;return n<0&&!s?(g++,C=-1):n>=0&&s==r.nodeValue.length?(p--,C=1):n<0?p--:g++,od(xo(va(r,p,g),C),C<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(n<0||s==si(r))){let p=r.childNodes[s-1];if(p.nodeType==1)return Rg(p.getBoundingClientRect(),!1)}if(i==null&&s<si(r)){let p=r.childNodes[s];if(p.nodeType==1)return Rg(p.getBoundingClientRect(),!0)}return Rg(r.getBoundingClientRect(),n>=0)}if(i==null&&s&&(n<0||s==si(r))){let p=r.childNodes[s-1],g=p.nodeType==3?va(p,si(p)-(c?0:1)):p.nodeType==1&&(p.nodeName!="BR"||!p.nextSibling)?p:null;if(g)return od(xo(g,1),!1)}if(i==null&&s<si(r)){let p=r.childNodes[s];for(;p.pmViewDesc&&p.pmViewDesc.ignoreForCoords;)p=p.nextSibling;let g=p?p.nodeType==3?va(p,0,c?0:1):p.nodeType==1?p:null:null;if(g)return od(xo(g,-1),!0)}return od(xo(r.nodeType==3?va(r):r,-n),n>=0)}function od(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Rg(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function xk(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function I7(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return xk(t,e,()=>{let{node:i}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let f=t.docView.nearestDesc(i,!0);if(!f)break;if(f.node.isBlock){i=f.contentDOM||f.dom;break}i=f.dom.parentNode}let c=gk(t,s.pos,1);for(let f=i.firstChild;f;f=f.nextSibling){let p;if(f.nodeType==1)p=f.getClientRects();else if(f.nodeType==3)p=va(f,0,f.nodeValue.length).getClientRects();else continue;for(let g=0;g<p.length;g++){let C=p[g];if(C.bottom>C.top+1&&(n=="up"?c.top-C.top>(C.bottom-c.top)*2:C.bottom-c.bottom>(c.bottom-C.top)*2))return!1}}return!0})}const D7=/[\u0590-\u08ac]/;function L7(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,c=s==r.parent.content.size,f=t.domSelection();return f?!D7.test(r.parent.textContent)||!f.modify?n=="left"||n=="backward"?i:c:xk(t,e,()=>{let{focusNode:p,focusOffset:g,anchorNode:C,anchorOffset:v}=t.domSelectionRange(),A=f.caretBidiLevel;f.modify("move",n,"character");let T=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:_,focusOffset:M}=t.domSelectionRange(),R=_&&!T.contains(_.nodeType==1?_:_.parentNode)||p==_&&g==M;try{f.collapse(C,v),p&&(p!=C||g!=v)&&f.extend&&f.extend(p,g)}catch{}return A!=null&&(f.caretBidiLevel=A),R}):r.pos==r.start()||r.pos==r.end()}let vE=null,CE=null,EE=!1;function j7(t,e,n){return vE==e&&CE==n?EE:(vE=e,CE=n,EE=n=="up"||n=="down"?I7(t,e,n):L7(t,e,n))}const ai=0,SE=1,El=2,Vi=3;class ff{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=ai,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,c;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((c=i.pmViewDesc)&&c.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(c)+c.size:this.posAtStart}else{let i,c;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((c=i.pmViewDesc)&&c.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(c):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>$r(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),c;if(i&&(!n||i.node))if(r&&(c=i.nodeDOM)&&!(c.nodeType==1?c.contains(e.nodeType==1?e:e.parentNode):c==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let c=0;c<s.children.length;c++){let f=s.children[c];if(f.size){s=f;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let c=this.children[r],f=i+c.size;if(f>e||c instanceof yk){s=e-i;break}i=f}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof bk&&i.side>=0;r--);if(n<=0){let i,c=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,c=!1);return i&&n&&c&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?$r(i.dom)+1:0}}else{let i,c=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,c=!1);return i&&c&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?$r(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let c=r,f=0;;f++){let p=this.children[f],g=c+p.size;if(s==-1&&e<=g){let C=c+p.border;if(e>=C&&n<=g-p.border&&p.node&&p.contentDOM&&this.contentDOM.contains(p.contentDOM))return p.parseRange(e,n,C);e=c;for(let v=f;v>0;v--){let A=this.children[v-1];if(A.size&&A.dom.parentNode==this.contentDOM&&!A.emptyChildAt(1)){s=$r(A.dom)+1;break}e-=A.size}s==-1&&(s=0)}if(s>-1&&(g>n||f==this.children.length-1)){n=g;for(let C=f+1;C<this.children.length;C++){let v=this.children[C];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(-1)){i=$r(v.dom);break}n+=v.size}i==-1&&(i=this.contentDOM.childNodes.length);break}c=g}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let i=Math.min(e,n),c=Math.max(e,n);for(let T=0,_=0;T<this.children.length;T++){let M=this.children[T],R=_+M.size;if(i>_&&c<R)return M.setSelection(e-_-M.border,n-_-M.border,r,s);_=R}let f=this.domFromPos(e,e?-1:1),p=n==e?f:this.domFromPos(n,n?-1:1),g=r.root.getSelection(),C=r.domSelectionRange(),v=!1;if((ii||ns)&&e==n){let{node:T,offset:_}=f;if(T.nodeType==3){if(v=!!(_&&T.nodeValue[_-1]==`
`),v&&_==T.nodeValue.length)for(let M=T,R;M;M=M.parentNode){if(R=M.nextSibling){R.nodeName=="BR"&&(f=p={node:R.parentNode,offset:$r(R)+1});break}let j=M.pmViewDesc;if(j&&j.node&&j.node.isBlock)break}}else{let M=T.childNodes[_-1];v=M&&(M.nodeName=="BR"||M.contentEditable=="false")}}if(ii&&C.focusNode&&C.focusNode!=p.node&&C.focusNode.nodeType==1){let T=C.focusNode.childNodes[C.focusOffset];T&&T.contentEditable=="false"&&(s=!0)}if(!(s||v&&ns)&&Fl(f.node,f.offset,C.anchorNode,C.anchorOffset)&&Fl(p.node,p.offset,C.focusNode,C.focusOffset))return;let A=!1;if((g.extend||e==n)&&!(v&&ii)){g.collapse(f.node,f.offset);try{e!=n&&g.extend(p.node,p.offset),A=!0}catch{}}if(!A){if(e>n){let _=f;f=p,p=_}let T=document.createRange();T.setEnd(p.node,p.offset),T.setStart(f.node,f.offset),g.removeAllRanges(),g.addRange(T)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],c=r+i.size;if(r==c?e<=c&&n>=r:e<c&&n>r){let f=r+i.border,p=c-i.border;if(e>=f&&n<=p){this.dirty=e==r||n==c?El:SE,e==f&&n==p&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Vi:i.markDirty(e-f,n-f);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?El:Vi}r=c}this.dirty=El}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?El:SE;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class bk extends ff{constructor(e,n,r,s){let i,c=n.type.toDOM;if(typeof c=="function"&&(c=c(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(c.nodeType!=1){let f=document.createElement("span");f.appendChild(c),c=f}c.contentEditable="false",c.classList.add("ProseMirror-widget")}super(e,[],c,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==ai&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class B7 extends ff{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class zl extends ff{constructor(e,n,r,s,i){super(e,[],r,s),this.mark=n,this.spec=i}static create(e,n,r,s){let i=s.nodeViews[n.type.name],c=i&&i(n,s,r);return(!c||!c.dom)&&(c=Wl.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new zl(e,n,c.dom,c.contentDOM||c.dom,c)}parseRule(){return this.dirty&Vi||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Vi&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=ai){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ai}}slice(e,n,r){let s=zl.create(this.parent,this.mark,!0,r),i=this.children,c=this.size;n<c&&(i=Yx(i,n,c,r)),e>0&&(i=Yx(i,0,e,r));for(let f=0;f<i.length;f++)i[f].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Do extends ff{constructor(e,n,r,s,i,c,f,p,g){super(e,[],i,c),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=f}static create(e,n,r,s,i,c){let f=i.nodeViews[n.type.name],p,g=f&&f(n,i,()=>{if(!p)return c;if(p.parent)return p.parent.posBeforeChild(p)},r,s),C=g&&g.dom,v=g&&g.contentDOM;if(n.isText){if(!C)C=document.createTextNode(n.text);else if(C.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else C||({dom:C,contentDOM:v}=Wl.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!v&&!n.isText&&C.nodeName!="BR"&&(C.hasAttribute("contenteditable")||(C.contentEditable="false"),n.type.spec.draggable&&(C.draggable=!0));let A=C;return C=Ck(C,r,n),g?p=new P7(e,n,r,s,C,v||null,A,g,i,c+1):n.isText?new Jp(e,n,r,s,C,A,i):new Do(e,n,r,s,C,v||null,A,i,c+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Pe.empty)}return e}matchesNode(e,n,r){return this.dirty==ai&&e.eq(this.node)&&P0(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,i=e.composing?this.localCompositionInfo(e,n):null,c=i&&i.pos>-1?i:null,f=i&&i.pos<0,p=new z7(this,c&&c.node,e);V7(this.node,this.innerDeco,(g,C,v)=>{g.spec.marks?p.syncToMarks(g.spec.marks,r,e,C):g.type.side>=0&&!v&&p.syncToMarks(C==this.node.childCount?jn.none:this.node.child(C).marks,r,e,C),p.placeWidget(g,e,s)},(g,C,v,A)=>{p.syncToMarks(g.marks,r,e,A);let T;p.findNodeMatch(g,C,v,A)||f&&e.state.selection.from>s&&e.state.selection.to<s+g.nodeSize&&(T=p.findIndexWithChild(i.node))>-1&&p.updateNodeAt(g,C,v,T,e)||p.updateNextNode(g,C,v,e,A,s)||p.addNode(g,C,v,e,s),s+=g.nodeSize}),p.syncToMarks([],r,e,0),this.node.isTextblock&&p.addTextblockHacks(),p.destroyRest(),(p.changed||this.dirty==El)&&(c&&this.protectLocalComposition(e,c),wk(this.contentDOM,this.children,e),nu&&G7(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof Ct)||r<n||s>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let c=i.nodeValue,f=W7(this.node.content,c,r-n,s-n);return f<0?null:{node:i,pos:f,text:c}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let c=new B7(this,i,n,s);e.input.compositionNodes.push(c),this.children=Yx(this.children,r,r+s.length,e,c)}update(e,n,r,s){return this.dirty==Vi||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=ai}updateOuterDeco(e){if(P0(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=vk(this.dom,this.nodeDOM,Xx(this.outerDeco,this.node,n),Xx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function AE(t,e,n,r,s){Ck(r,e,t);let i=new Do(void 0,t,e,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Jp extends Do{constructor(e,n,r,s,i,c,f){super(e,n,r,s,i,null,c,f,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==Vi||this.dirty!=ai&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=ai||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=ai,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),i=document.createTextNode(s.text);return new Jp(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Vi)}get domAtom(){return!1}isText(e){return this.node.text==e}}class yk extends ff{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ai&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class P7 extends Do{constructor(e,n,r,s,i,c,f,p,g,C){super(e,n,r,s,i,c,f,g,C),this.spec=p}update(e,n,r,s){if(this.dirty==Vi)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function wk(t,e,n){let r=t.firstChild,s=!1;for(let i=0;i<e.length;i++){let c=e[i],f=c.dom;if(f.parentNode==t){for(;f!=r;)r=NE(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(f,r);if(c instanceof zl){let p=r?r.previousSibling:t.lastChild;wk(c.contentDOM,c.children,n),r=p?p.nextSibling:t.firstChild}}for(;r;)r=NE(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const Sd=function(t){t&&(this.nodeName=t)};Sd.prototype=Object.create(null);const Sl=[new Sd];function Xx(t,e,n){if(t.length==0)return Sl;let r=n?Sl[0]:new Sd,s=[r];for(let i=0;i<t.length;i++){let c=t[i].type.attrs;if(c){c.nodeName&&s.push(r=new Sd(c.nodeName));for(let f in c){let p=c[f];p!=null&&(n&&s.length==1&&s.push(r=new Sd(e.isInline?"span":"div")),f=="class"?r.class=(r.class?r.class+" ":"")+p:f=="style"?r.style=(r.style?r.style+";":"")+p:f!="nodeName"&&(r[f]=p))}}}return s}function vk(t,e,n,r){if(n==Sl&&r==Sl)return e;let s=e;for(let i=0;i<r.length;i++){let c=r[i],f=n[i];if(i){let p;f&&f.nodeName==c.nodeName&&s!=t&&(p=s.parentNode)&&p.nodeName.toLowerCase()==c.nodeName||(p=document.createElement(c.nodeName),p.pmIsDeco=!0,p.appendChild(s),f=Sl[0]),s=p}F7(s,f||Sl[0],c)}return s}function F7(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&t.classList.add(s[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function Ck(t,e,n){return vk(t,t,Sl,Xx(e,n,t.nodeType!=1))}function P0(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function NE(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class z7{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=U7(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,s){let i=0,c=this.stack.length>>1,f=Math.min(c,e.length);for(;i<f&&(i==c-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<c;)this.destroyRest(),this.top.dirty=ai,this.index=this.stack.pop(),this.top=this.stack.pop(),c--;for(;c<e.length;){this.stack.push(this.top,this.index+1);let p=-1,g=this.top.children.length;s<this.preMatch.index&&(g=Math.min(this.index+3,g));for(let C=this.index;C<g;C++){let v=this.top.children[C];if(v.matchesMark(e[c])&&!this.isLocked(v.dom)){p=C;break}}if(p>-1)p>this.index&&(this.changed=!0,this.destroyBetween(this.index,p)),this.top=this.top.children[this.index];else{let C=zl.create(this.top,e[c],n,r);this.top.children.splice(this.index,0,C),this.top=C,this.changed=!0}this.index=0,c++}}findNodeMatch(e,n,r,s){let i=-1,c;if(s>=this.preMatch.index&&(c=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&c.matchesNode(e,n,r))i=this.top.children.indexOf(c,this.index);else for(let f=this.index,p=Math.min(this.top.children.length,f+5);f<p;f++){let g=this.top.children[f];if(g.matchesNode(e,n,r)&&!this.preMatch.matched.has(g)){i=f;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,s,i){let c=this.top.children[s];return c.dirty==Vi&&c.dom==c.contentDOM&&(c.dirty=El),c.update(e,n,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,i,c){for(let f=this.index;f<this.top.children.length;f++){let p=this.top.children[f];if(p instanceof Do){let g=this.preMatch.matched.get(p);if(g!=null&&g!=i)return!1;let C=p.dom,v,A=this.isLocked(C)&&!(e.isText&&p.node&&p.node.isText&&p.nodeDOM.nodeValue==e.text&&p.dirty!=Vi&&P0(n,p.outerDeco));if(!A&&p.update(e,n,r,s))return this.destroyBetween(this.index,f),p.dom!=C&&(this.changed=!0),this.index++,!0;if(!A&&(v=this.recreateWrapper(p,e,n,r,s,c)))return this.destroyBetween(this.index,f),this.top.children[this.index]=v,v.contentDOM&&(v.dirty=El,v.updateChildren(s,c+1),v.dirty=ai),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,i,c){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!P0(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let f=Do.create(this.top,n,r,s,i,c);if(f.contentDOM){f.children=e.children,e.children=[];for(let p of f.children)p.parent=f}return e.destroy(),f}addNode(e,n,r,s,i){let c=Do.create(this.top,e,n,r,s,i);c.contentDOM&&c.updateChildren(s,i+1),this.top.children.splice(this.index++,0,c),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new bk(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof zl;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Jp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ns||Yr)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new yk(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function U7(t,e){let n=e,r=n.children.length,s=t.childCount,i=new Map,c=[];e:for(;s>0;){let f;for(;;)if(r){let g=n.children[r-1];if(g instanceof zl)n=g,r=g.children.length;else{f=g,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let p=f.node;if(p){if(p!=t.child(s-1))break;--s,i.set(f,s),c.push(f)}}return{index:s,matched:i,matches:c.reverse()}}function H7(t,e){return t.type.side-e.type.side}function V7(t,e,n,r){let s=e.locals(t),i=0;if(s.length==0){for(let g=0;g<t.childCount;g++){let C=t.child(g);r(C,s,e.forChild(i,C),g),i+=C.nodeSize}return}let c=0,f=[],p=null;for(let g=0;;){let C,v;for(;c<s.length&&s[c].to==i;){let R=s[c++];R.widget&&(C?(v||(v=[C])).push(R):C=R)}if(C)if(v){v.sort(H7);for(let R=0;R<v.length;R++)n(v[R],g,!!p)}else n(C,g,!!p);let A,T;if(p)T=-1,A=p,p=null;else if(g<t.childCount)T=g,A=t.child(g++);else break;for(let R=0;R<f.length;R++)f[R].to<=i&&f.splice(R--,1);for(;c<s.length&&s[c].from<=i&&s[c].to>i;)f.push(s[c++]);let _=i+A.nodeSize;if(A.isText){let R=_;c<s.length&&s[c].from<R&&(R=s[c].from);for(let j=0;j<f.length;j++)f[j].to<R&&(R=f[j].to);R<_&&(p=A.cut(R-i),A=A.cut(0,R-i),_=R,T=-1)}else for(;c<s.length&&s[c].to<_;)c++;let M=A.isInline&&!A.isLeaf?f.filter(R=>!R.inline):f.slice();r(A,M,e.forChild(i,A),T),i=_}}function G7(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function W7(t,e,n,r){for(let s=0,i=0;s<t.childCount&&i<=r;){let c=t.child(s++),f=i;if(i+=c.nodeSize,!c.isText)continue;let p=c.text;for(;s<t.childCount;){let g=t.child(s++);if(i+=g.nodeSize,!g.isText)break;p+=g.text}if(i>=n){if(i>=r&&p.slice(r-e.length-f,r-f)==e)return r-e.length;let g=f<r?p.lastIndexOf(e,r-f-1):-1;if(g>=0&&g+e.length+f>=n)return f+g;if(n==r&&p.length>=r+e.length-f&&p.slice(r-f,r-f+e.length)==e)return r}}return-1}function Yx(t,e,n,r,s){let i=[];for(let c=0,f=0;c<t.length;c++){let p=t[c],g=f,C=f+=p.size;g>=n||C<=e?i.push(p):(g<e&&i.push(p.slice(0,e-g,r)),s&&(i.push(s),s=void 0),C>n&&i.push(p.slice(n-g,p.size,r)))}return i}function lb(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),i=s&&s.size==0,c=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(c<0)return null;let f=r.resolve(c),p,g;if(Zp(n)){for(p=c;s&&!s.node;)s=s.parent;let v=s.node;if(s&&v.isAtom&&vt.isSelectable(v)&&s.parent&&!(v.isInline&&b7(n.focusNode,n.focusOffset,s.dom))){let A=s.posBefore;g=new vt(c==A?f:r.resolve(A))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let v=c,A=c;for(let T=0;T<n.rangeCount;T++){let _=n.getRangeAt(T);v=Math.min(v,t.docView.posFromDOM(_.startContainer,_.startOffset,1)),A=Math.max(A,t.docView.posFromDOM(_.endContainer,_.endOffset,-1))}if(v<0)return null;[p,c]=A==t.state.selection.anchor?[A,v]:[v,A],f=r.resolve(c)}else p=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(p<0)return null}let C=r.resolve(p);if(!g){let v=e=="pointer"||t.state.selection.head<f.pos&&!i?1:-1;g=cb(t,C,f,v)}return g}function Ek(t){return t.editable?t.hasFocus():Ak(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Oa(t,e=!1){let n=t.state.selection;if(Sk(t,n),!!Ek(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Yr){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Fl(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)$7(t);else{let{anchor:r,head:s}=n,i,c;kE&&!(n instanceof Ct)&&(n.$from.parent.inlineContent||(i=TE(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(c=TE(t,n.to))),t.docView.setSelection(r,s,t,e),kE&&(i&&OE(i),c&&OE(c)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&q7(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const kE=ns||Yr&&uk<63;function TE(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(ns&&s&&s.contentEditable=="false")return Mg(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Mg(s);if(i)return Mg(i)}}function Mg(t){return t.contentEditable="true",ns&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function OE(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function q7(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Ek(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function $7(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,$r(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&Os&&Io<=11&&(n.disabled=!0,n.disabled=!1)}function Sk(t,e){if(e instanceof vt){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(_E(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else _E(t)}function _E(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function cb(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||Ct.between(e,n,r)}function RE(t){return t.editable&&!t.hasFocus()?!1:Ak(t)}function Ak(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function X7(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Fl(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Kx(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Ot.findFrom(i,e)}function yo(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ME(t,e,n){let r=t.state.selection;if(r instanceof Ct)if(n.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let c=t.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return yo(t,new Ct(r.$anchor,c))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=Kx(t.state,e);return s&&s instanceof vt?yo(t,s):!1}else if(!(ri&&n.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,c;if(!i||i.isText)return!1;let f=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(c=t.docView.descAt(f))&&!c.contentDOM?vt.isSelectable(i)?yo(t,new vt(e<0?t.state.doc.resolve(s.pos-i.nodeSize):s)):df?yo(t,new Ct(t.state.doc.resolve(e<0?f:f+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof vt&&r.node.isInline)return yo(t,new Ct(e>0?r.$to:r.$from));{let s=Kx(t.state,e);return s?yo(t,s):!1}}}function F0(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Ad(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function _c(t,e){return e<0?Y7(t):K7(t)}function Y7(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,i,c=!1;for(ii&&n.nodeType==1&&r<F0(n)&&Ad(n.childNodes[r],-1)&&(c=!0);;)if(r>0){if(n.nodeType!=1)break;{let f=n.childNodes[r-1];if(Ad(f,-1))s=n,i=--r;else if(f.nodeType==3)n=f,r=n.nodeValue.length;else break}}else{if(Nk(n))break;{let f=n.previousSibling;for(;f&&Ad(f,-1);)s=n.parentNode,i=$r(f),f=f.previousSibling;if(f)n=f,r=F0(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}c?Zx(t,n,r):s&&Zx(t,s,i)}function K7(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=F0(n),i,c;for(;;)if(r<s){if(n.nodeType!=1)break;let f=n.childNodes[r];if(Ad(f,1))i=n,c=++r;else break}else{if(Nk(n))break;{let f=n.nextSibling;for(;f&&Ad(f,1);)i=f.parentNode,c=$r(f)+1,f=f.nextSibling;if(f)n=f,r=0,s=F0(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}i&&Zx(t,i,c)}function Nk(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Z7(t,e){for(;t&&e==t.childNodes.length&&!uf(t);)e=$r(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function J7(t,e){for(;t&&!e&&!uf(t);)e=$r(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Zx(t,e,n){if(e.nodeType!=3){let i,c;(c=Z7(e,n))?(e=c,n=0):(i=J7(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Zp(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&Oa(t)},50)}function IE(t,e){let n=t.state.doc.resolve(e);if(!(Yr||dk)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),c=(i.top+i.bottom)/2;if(c>s.top&&c<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),c=(i.top+i.bottom)/2;if(c>s.top&&c<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function DE(t,e,n){let r=t.state.selection;if(r instanceof Ct&&!r.empty||n.indexOf("s")>-1||ri&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let c=Kx(t.state,e);if(c&&c instanceof vt)return yo(t,c)}if(!s.parent.inlineContent){let c=e<0?s:i,f=r instanceof Vs?Ot.near(c,e):Ot.findFrom(c,e);return f?yo(t,f):!1}return!1}function LE(t,e){if(!(t.state.selection instanceof Ct))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let c=t.state.tr;return e<0?c.delete(n.pos-i.nodeSize,n.pos):c.delete(n.pos,n.pos+i.nodeSize),t.dispatch(c),!0}return!1}function jE(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Q7(t){if(!ns||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;jE(t,r,"true"),setTimeout(()=>jE(t,r,"false"),20)}return!1}function eL(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function tL(t,e){let n=e.keyCode,r=eL(e);if(n==8||ri&&n==72&&r=="c")return LE(t,-1)||_c(t,-1);if(n==46&&!e.shiftKey||ri&&n==68&&r=="c")return LE(t,1)||_c(t,1);if(n==13||n==27)return!0;if(n==37||ri&&n==66&&r=="c"){let s=n==37?IE(t,t.state.selection.from)=="ltr"?-1:1:-1;return ME(t,s,r)||_c(t,s)}else if(n==39||ri&&n==70&&r=="c"){let s=n==39?IE(t,t.state.selection.from)=="ltr"?1:-1:1;return ME(t,s,r)||_c(t,s)}else{if(n==38||ri&&n==80&&r=="c")return DE(t,-1,r)||_c(t,-1);if(n==40||ri&&n==78&&r=="c")return Q7(t)||DE(t,1,r)||_c(t,1);if(r==(ri?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function ub(t,e){t.someProp("transformCopied",T=>{e=T(e,t)});let n=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let T=r.firstChild;n.push(T.type.name,T.attrs!=T.type.defaultAttrs?T.attrs:null),r=T.content}let c=t.someProp("clipboardSerializer")||Wl.fromSchema(t.state.schema),f=Mk(),p=f.createElement("div");p.appendChild(c.serializeFragment(r,{document:f}));let g=p.firstChild,C,v=0;for(;g&&g.nodeType==1&&(C=Rk[g.nodeName.toLowerCase()]);){for(let T=C.length-1;T>=0;T--){let _=f.createElement(C[T]);for(;p.firstChild;)_.appendChild(p.firstChild);p.appendChild(_),v++}g=p.firstChild}g&&g.nodeType==1&&g.setAttribute("data-pm-slice",`${s} ${i}${v?` -${v}`:""} ${JSON.stringify(n)}`);let A=t.someProp("clipboardTextSerializer",T=>T(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:p,text:A,slice:e}}function kk(t,e,n,r,s){let i=s.parent.type.spec.code,c,f;if(!n&&!e)return null;let p=!!e&&(r||i||!n);if(p){if(t.someProp("transformPastedText",A=>{e=A(e,i||r,t)}),i)return f=new st(Pe.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",A=>{f=A(f,t,!0)}),f;let v=t.someProp("clipboardTextParser",A=>A(e,s,r,t));if(v)f=v;else{let A=s.marks(),{schema:T}=t.state,_=Wl.fromSchema(T);c=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(M=>{let R=c.appendChild(document.createElement("p"));M&&R.appendChild(_.serializeNode(T.text(M,A)))})}}else t.someProp("transformPastedHTML",v=>{n=v(n,t)}),c=iL(n),df&&aL(c);let g=c&&c.querySelector("[data-pm-slice]"),C=g&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(g.getAttribute("data-pm-slice")||"");if(C&&C[3])for(let v=+C[3];v>0;v--){let A=c.firstChild;for(;A&&A.nodeType!=1;)A=A.nextSibling;if(!A)break;c=A}if(f||(f=(t.someProp("clipboardParser")||t.someProp("domParser")||Cd.fromSchema(t.state.schema)).parseSlice(c,{preserveWhitespace:!!(p||C),context:s,ruleFromNode(A){return A.nodeName=="BR"&&!A.nextSibling&&A.parentNode&&!nL.test(A.parentNode.nodeName)?{ignore:!0}:null}})),C)f=oL(BE(f,+C[1],+C[2]),C[4]);else if(f=st.maxOpen(rL(f.content,s),!0),f.openStart||f.openEnd){let v=0,A=0;for(let T=f.content.firstChild;v<f.openStart&&!T.type.spec.isolating;v++,T=T.firstChild);for(let T=f.content.lastChild;A<f.openEnd&&!T.type.spec.isolating;A++,T=T.lastChild);f=BE(f,v,A)}return t.someProp("transformPasted",v=>{f=v(f,t,p)}),f}const nL=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function rL(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),i,c=[];if(t.forEach(f=>{if(!c)return;let p=s.findWrapping(f.type),g;if(!p)return c=null;if(g=c.length&&i.length&&Ok(p,i,f,c[c.length-1],0))c[c.length-1]=g;else{c.length&&(c[c.length-1]=_k(c[c.length-1],i.length));let C=Tk(f,p);c.push(C),s=s.matchType(C.type),i=p}}),c)return Pe.from(c)}return t}function Tk(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,Pe.from(t));return t}function Ok(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let i=Ok(t,e,n,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(Pe.from(Tk(n,t,s+1))))}}function _k(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,_k(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Pe.empty,!0);return t.copy(n.append(r))}function Jx(t,e,n,r,s,i){let c=e<0?t.firstChild:t.lastChild,f=c.content;return t.childCount>1&&(i=0),s<r-1&&(f=Jx(f,e,n,r,s+1,i)),s>=n&&(f=e<0?c.contentMatchAt(0).fillBefore(f,i<=s).append(f):f.append(c.contentMatchAt(c.childCount).fillBefore(Pe.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,c.copy(f))}function BE(t,e,n){return e<t.openStart&&(t=new st(Jx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new st(Jx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const Rk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let PE=null;function Mk(){return PE||(PE=document.implementation.createHTMLDocument("title"))}let Ig=null;function sL(t){let e=window.trustedTypes;return e?(Ig||(Ig=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Ig.createHTML(t)):t}function iL(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=Mk().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&Rk[r[1].toLowerCase()])&&(t=s.map(i=>"<"+i+">").join("")+t+s.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=sL(t),s)for(let i=0;i<s.length;i++)n=n.querySelector(s[i])||n;return n}function aL(t){let e=t.querySelectorAll(Yr?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function oL(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:i,openEnd:c}=t;for(let f=r.length-2;f>=0;f-=2){let p=n.nodes[r[f]];if(!p||p.hasRequiredAttrs())break;s=Pe.from(p.create(r[f+1],s)),i++,c++}return new st(s,i,c)}const ds={},fs={},lL={touchstart:!0,touchmove:!0};class cL{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function uL(t){for(let e in ds){let n=ds[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{fL(t,r)&&!db(t,r)&&(t.editable||!(r.type in fs))&&n(t,r)},lL[e]?{passive:!0}:void 0)}ns&&t.dom.addEventListener("input",()=>null),Qx(t)}function Ro(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function dL(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Qx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>db(t,r))})}function db(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function fL(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function hL(t,e){!db(t,e)&&ds[e.type]&&(t.editable||!(e.type in fs))&&ds[e.type](t,e)}fs.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Dk(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Sa&&Yr&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),nu&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,vl(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||tL(t,n)?n.preventDefault():Ro(t,"key")};fs.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};fs.keypress=(t,e)=>{let n=e;if(Dk(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ri&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Ct)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),i=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",c=>c(t,r.$from.pos,r.$to.pos,s,i))&&t.dispatch(i()),n.preventDefault()}};function Qp(t){return{left:t.clientX,top:t.clientY}}function pL(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function fb(t,e,n,r,s){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let c=i.depth+1;c>0;c--)if(t.someProp(e,f=>c>i.depth?f(t,n,i.nodeAfter,i.before(c),s,!0):f(t,n,i.node(c),i.before(c),s,!1)))return!0;return!1}function Hc(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function mL(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&vt.isSelectable(r)?(Hc(t,new vt(n)),!0):!1}function gL(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof vt&&(r=n.node);let i=t.state.doc.resolve(e);for(let c=i.depth+1;c>0;c--){let f=c>i.depth?i.nodeAfter:i.node(c);if(vt.isSelectable(f)){r&&n.$from.depth>0&&c>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?s=i.before(n.$from.depth):s=i.before(c);break}}return s!=null?(Hc(t,vt.create(t.state.doc,s)),!0):!1}function xL(t,e,n,r,s){return fb(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(s?gL(t,n):mL(t,n))}function bL(t,e,n,r){return fb(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function yL(t,e,n,r){return fb(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||wL(t,n,r)}function wL(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Hc(t,Ct.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let c=i>s.depth?s.nodeAfter:s.node(i),f=s.before(i);if(c.inlineContent)Hc(t,Ct.create(r,f+1,f+1+c.content.size));else if(vt.isSelectable(c))Hc(t,vt.create(r,f));else continue;return!0}}function hb(t){return z0(t)}const Ik=ri?"metaKey":"ctrlKey";ds.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=hb(t),s=Date.now(),i="singleClick";s-t.input.lastClick.time<500&&pL(n,t.input.lastClick)&&!n[Ik]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:i,button:n.button};let c=t.posAtCoords(Qp(n));c&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new vL(t,c,n,!!r)):(i=="doubleClick"?bL:yL)(t,c.pos,c.inside,n)?n.preventDefault():Ro(t,"pointer"))};class vL{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Ik],this.allowDefault=r.shiftKey;let i,c;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),c=n.inside;else{let C=e.state.doc.resolve(n.pos);i=C.parent,c=C.depth?C.before():0}const f=s?null:r.target,p=f?e.docView.nearestDesc(f,!0):null;this.target=p&&p.nodeDOM.nodeType==1?p.nodeDOM:null;let{selection:g}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||g instanceof vt&&g.from<=c&&g.to>c)&&(this.mightDrag={node:i,pos:c,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ii&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ro(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Oa(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Qp(e))),this.updateAllowDefault(e),this.allowDefault||!n?Ro(this.view,"pointer"):xL(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ns&&this.mightDrag&&!this.mightDrag.node.isAtom||Yr&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Hc(this.view,Ot.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Ro(this.view,"pointer")}move(e){this.updateAllowDefault(e),Ro(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ds.touchstart=t=>{t.input.lastTouch=Date.now(),hb(t),Ro(t,"pointer")};ds.touchmove=t=>{t.input.lastTouch=Date.now(),Ro(t,"pointer")};ds.contextmenu=t=>hb(t);function Dk(t,e){return t.composing?!0:ns&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const CL=Sa?5e3:-1;fs.compositionstart=fs.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Ct&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Yr&&dk&&EL(t)))t.markCursor=t.state.storedMarks||n.marks(),z0(t,!0),t.markCursor=null;else if(z0(t,!e.selection.empty),ii&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let c=i<0?s.lastChild:s.childNodes[i-1];if(!c)break;if(c.nodeType==3){let f=t.domSelection();f&&f.collapse(c,c.nodeValue.length);break}else s=c,i=-1}}t.input.composing=!0}Lk(t,CL)};function EL(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}fs.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Lk(t,20))};function Lk(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>z0(t),e))}function jk(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=AL());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function SL(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=g7(e.focusNode,e.focusOffset),r=x7(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let c=n.pmViewDesc;if(!(!c||!c.isText(n.nodeValue)))return r}}return n||r}function AL(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function z0(t,e=!1){if(!(Sa&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),jk(t),e||t.docView&&t.docView.dirty){let n=lb(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function NL(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Gd=Os&&Io<15||nu&&v7<604;ds.copy=fs.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let i=Gd?null:n.clipboardData,c=r.content(),{dom:f,text:p}=ub(t,c);i?(n.preventDefault(),i.clearData(),i.setData("text/html",f.innerHTML),i.setData("text/plain",p)):NL(t,f),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function kL(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function TL(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Wd(t,r.value,null,s,e):Wd(t,r.textContent,r.innerHTML,s,e)},50)}function Wd(t,e,n,r,s){let i=kk(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",p=>p(t,s,i||st.empty)))return!0;if(!i)return!1;let c=kL(i),f=c?t.state.tr.replaceSelectionWith(c,r):t.state.tr.replaceSelection(i);return t.dispatch(f.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Bk(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}fs.paste=(t,e)=>{let n=e;if(t.composing&&!Sa)return;let r=Gd?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Wd(t,Bk(r),r.getData("text/html"),s,n)?n.preventDefault():TL(t,n)};class Pk{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const OL=ri?"altKey":"ctrlKey";function Fk(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[OL]}ds.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,i=s.empty?null:t.posAtCoords(Qp(n)),c;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof vt?s.to-1:s.to))){if(r&&r.mightDrag)c=vt.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let v=t.docView.nearestDesc(n.target,!0);v&&v.node.type.spec.draggable&&v!=t.docView&&(c=vt.create(t.state.doc,v.posBefore))}}let f=(c||t.state.selection).content(),{dom:p,text:g,slice:C}=ub(t,f);(!n.dataTransfer.files.length||!Yr||uk>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Gd?"Text":"text/html",p.innerHTML),n.dataTransfer.effectAllowed="copyMove",Gd||n.dataTransfer.setData("text/plain",g),t.dragging=new Pk(C,Fk(t,n),c)};ds.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};fs.dragover=fs.dragenter=(t,e)=>e.preventDefault();fs.drop=(t,e)=>{try{_L(t,e,t.dragging)}finally{t.dragging=null}};function _L(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Qp(e));if(!r)return;let s=t.state.doc.resolve(r.pos),i=n&&n.slice;i?t.someProp("transformPasted",T=>{i=T(i,t,!1)}):i=kk(t,Bk(e.dataTransfer),Gd?null:e.dataTransfer.getData("text/html"),!1,s);let c=!!(n&&Fk(t,e));if(t.someProp("handleDrop",T=>T(t,e,i||st.empty,c))){e.preventDefault();return}if(!i)return;e.preventDefault();let f=i?VN(t.state.doc,s.pos,i):s.pos;f==null&&(f=s.pos);let p=t.state.tr;if(c){let{node:T}=n;T?T.replace(p):p.deleteSelection()}let g=p.mapping.map(f),C=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,v=p.doc;if(C?p.replaceRangeWith(g,g,i.content.firstChild):p.replaceRange(g,g,i),p.doc.eq(v))return;let A=p.doc.resolve(g);if(C&&vt.isSelectable(i.content.firstChild)&&A.nodeAfter&&A.nodeAfter.sameMarkup(i.content.firstChild))p.setSelection(new vt(A));else{let T=p.mapping.map(f);p.mapping.maps[p.mapping.maps.length-1].forEach((_,M,R,j)=>T=j),p.setSelection(cb(t,A,p.doc.resolve(T)))}t.focus(),t.dispatch(p.setMeta("uiEvent","drop"))}ds.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Oa(t)},20))};ds.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};ds.beforeinput=(t,e)=>{if(Yr&&Sa&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,vl(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in fs)ds[t]=fs[t];function qd(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class U0{constructor(e,n){this.toDOM=e,this.spec=n||Ml,this.side=this.spec.side||0}map(e,n,r,s){let{pos:i,deleted:c}=e.mapResult(n.from+s,this.side<0?-1:1);return c?null:new Mr(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof U0&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&qd(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Lo{constructor(e,n){this.attrs=e,this.spec=n||Ml}map(e,n,r,s){let i=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,c=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=c?null:new Mr(i,c,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Lo&&qd(this.attrs,e.attrs)&&qd(this.spec,e.spec)}static is(e){return e.type instanceof Lo}destroy(){}}class pb{constructor(e,n){this.attrs=e,this.spec=n||Ml}map(e,n,r,s){let i=e.mapResult(n.from+s,1);if(i.deleted)return null;let c=e.mapResult(n.to+s,-1);return c.deleted||c.pos<=i.pos?null:new Mr(i.pos-r,c.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),i;return s==n.from&&!(i=e.child(r)).isText&&s+i.nodeSize==n.to}eq(e){return this==e||e instanceof pb&&qd(this.attrs,e.attrs)&&qd(this.spec,e.spec)}destroy(){}}class Mr{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Mr(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Mr(e,e,new U0(n,r))}static inline(e,n,r,s){return new Mr(e,n,new Lo(r,s))}static node(e,n,r,s){return new Mr(e,n,new pb(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Lo}get widget(){return this.type instanceof U0}}const Mc=[],Ml={};class Pn{constructor(e,n){this.local=e.length?e:Mc,this.children=n.length?n:Mc}static create(e,n){return n.length?H0(n,e,0,Ml):ts}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,i){for(let c=0;c<this.local.length;c++){let f=this.local[c];f.from<=n&&f.to>=e&&(!i||i(f.spec))&&r.push(f.copy(f.from+s,f.to+s))}for(let c=0;c<this.children.length;c+=3)if(this.children[c]<n&&this.children[c+1]>e){let f=this.children[c]+1;this.children[c+2].findInner(e-f,n-f,r,s+f,i)}}map(e,n,r){return this==ts||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Ml)}mapInner(e,n,r,s,i){let c;for(let f=0;f<this.local.length;f++){let p=this.local[f].map(e,r,s);p&&p.type.valid(n,p)?(c||(c=[])).push(p):i.onRemove&&i.onRemove(this.local[f].spec)}return this.children.length?RL(this.children,c||[],e,n,r,s,i):c?new Pn(c.sort(Il),Mc):ts}add(e,n){return n.length?this==ts?Pn.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,i=0;e.forEach((f,p)=>{let g=p+r,C;if(C=Uk(n,f,g)){for(s||(s=this.children.slice());i<s.length&&s[i]<p;)i+=3;s[i]==p?s[i+2]=s[i+2].addInner(f,C,g+1):s.splice(i,0,p,p+f.nodeSize,H0(C,f,g+1,Ml)),i+=3}});let c=zk(i?Hk(n):n,-r);for(let f=0;f<c.length;f++)c[f].type.valid(e,c[f])||c.splice(f--,1);return new Pn(c.length?this.local.concat(c).sort(Il):this.local,s||this.children)}remove(e){return e.length==0||this==ts?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let c,f=r[i]+n,p=r[i+1]+n;for(let C=0,v;C<e.length;C++)(v=e[C])&&v.from>f&&v.to<p&&(e[C]=null,(c||(c=[])).push(v));if(!c)continue;r==this.children&&(r=this.children.slice());let g=r[i+2].removeInner(c,f+1);g!=ts?r[i+2]=g:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,c;i<e.length;i++)if(c=e[i])for(let f=0;f<s.length;f++)s[f].eq(c,n)&&(s==this.local&&(s=this.local.slice()),s.splice(f--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Pn(s,r):ts}forChild(e,n){if(this==ts)return this;if(n.isLeaf)return Pn.empty;let r,s;for(let f=0;f<this.children.length;f+=3)if(this.children[f]>=e){this.children[f]==e&&(r=this.children[f+2]);break}let i=e+1,c=i+n.content.size;for(let f=0;f<this.local.length;f++){let p=this.local[f];if(p.from<c&&p.to>i&&p.type instanceof Lo){let g=Math.max(i,p.from)-i,C=Math.min(c,p.to)-i;g<C&&(s||(s=[])).push(p.copy(g,C))}}if(s){let f=new Pn(s.sort(Il),Mc);return r?new Co([f,r]):f}return r||ts}eq(e){if(this==e)return!0;if(!(e instanceof Pn)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return mb(this.localsInner(e))}localsInner(e){if(this==ts)return Mc;if(e.inlineContent||!this.local.some(Lo.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Lo||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Pn.empty=new Pn([],[]);Pn.removeOverlap=mb;const ts=Pn.empty;class Co{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Ml));return Co.from(r)}forChild(e,n){if(n.isLeaf)return Pn.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,n);i!=ts&&(i instanceof Co?r=r.concat(i.members):r.push(i))}return Co.from(r)}eq(e){if(!(e instanceof Co)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let c=0;c<i.length;c++)n.push(i[c])}}return n?mb(r?n:n.sort(Il)):Mc}static from(e){switch(e.length){case 0:return ts;case 1:return e[0];default:return new Co(e.every(n=>n instanceof Pn)?e:e.reduce((n,r)=>n.concat(r instanceof Pn?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function RL(t,e,n,r,s,i,c){let f=t.slice();for(let g=0,C=i;g<n.maps.length;g++){let v=0;n.maps[g].forEach((A,T,_,M)=>{let R=M-_-(T-A);for(let j=0;j<f.length;j+=3){let H=f[j+1];if(H<0||A>H+C-v)continue;let G=f[j]+C-v;T>=G?f[j+1]=A<=G?-2:-1:A>=C&&R&&(f[j]+=R,f[j+1]+=R)}v+=R}),C=n.maps[g].map(C,-1)}let p=!1;for(let g=0;g<f.length;g+=3)if(f[g+1]<0){if(f[g+1]==-2){p=!0,f[g+1]=-1;continue}let C=n.map(t[g]+i),v=C-s;if(v<0||v>=r.content.size){p=!0;continue}let A=n.map(t[g+1]+i,-1),T=A-s,{index:_,offset:M}=r.content.findIndex(v),R=r.maybeChild(_);if(R&&M==v&&M+R.nodeSize==T){let j=f[g+2].mapInner(n,R,C+1,t[g]+i+1,c);j!=ts?(f[g]=v,f[g+1]=T,f[g+2]=j):(f[g+1]=-2,p=!0)}else p=!0}if(p){let g=ML(f,t,e,n,s,i,c),C=H0(g,r,0,c);e=C.local;for(let v=0;v<f.length;v+=3)f[v+1]<0&&(f.splice(v,3),v-=3);for(let v=0,A=0;v<C.children.length;v+=3){let T=C.children[v];for(;A<f.length&&f[A]<T;)A+=3;f.splice(A,0,C.children[v],C.children[v+1],C.children[v+2])}}return new Pn(e.sort(Il),f)}function zk(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new Mr(s.from+e,s.to+e,s.type))}return n}function ML(t,e,n,r,s,i,c){function f(p,g){for(let C=0;C<p.local.length;C++){let v=p.local[C].map(r,s,g);v?n.push(v):c.onRemove&&c.onRemove(p.local[C].spec)}for(let C=0;C<p.children.length;C+=3)f(p.children[C+2],p.children[C]+g+1)}for(let p=0;p<t.length;p+=3)t[p+1]==-1&&f(t[p+2],e[p]+i+1);return n}function Uk(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let i=0,c;i<t.length;i++)(c=t[i])&&c.from>n&&c.to<r&&((s||(s=[])).push(c),t[i]=null);return s}function Hk(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function H0(t,e,n,r){let s=[],i=!1;e.forEach((f,p)=>{let g=Uk(t,f,p+n);if(g){i=!0;let C=H0(g,f,n+p+1,r);C!=ts&&s.push(p,p+f.nodeSize,C)}});let c=zk(i?Hk(t):t,-n).sort(Il);for(let f=0;f<c.length;f++)c[f].type.valid(e,c[f])||(r.onRemove&&r.onRemove(c[f].spec),c.splice(f--,1));return c.length||s.length?new Pn(c,s):ts}function Il(t,e){return t.from-e.from||t.to-e.to}function mb(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[s]=i.copy(i.from,r.to),FE(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),FE(e,s,r.copy(i.from,r.to)));break}}}return e}function FE(t,e,n){for(;e<t.length&&Il(n,t[e])>0;)e++;t.splice(e,0,n)}function Dg(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=ts&&e.push(r)}),t.cursorWrapper&&e.push(Pn.create(t.state.doc,[t.cursorWrapper.deco])),Co.from(e)}const IL={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},DL=Os&&Io<=11;class LL{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class jL{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new LL,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Os&&Io<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():ns&&e.composing&&r.some(s=>s.type=="childList"&&s.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),DL&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,IL)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(RE(this.view)){if(this.suppressingSelectionUpdates)return Oa(this.view);if(Os&&Io<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Fl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=tu(i))n.add(i);for(let i=e.anchorNode;i;i=tu(i))if(n.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&RE(e)&&!this.ignoreSelectionChange(r),i=-1,c=-1,f=!1,p=[];if(e.editable)for(let C=0;C<n.length;C++){let v=this.registerMutation(n[C],p);v&&(i=i<0?v.from:Math.min(v.from,i),c=c<0?v.to:Math.max(v.to,c),v.typeOver&&(f=!0))}if(p.some(C=>C.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let C of p)if(C.nodeName=="BR"&&C.parentNode){let v=C.nextSibling;v&&v.nodeType==1&&v.contentEditable=="false"&&C.parentNode.removeChild(C)}}else if(ii&&p.length){let C=p.filter(v=>v.nodeName=="BR");if(C.length==2){let[v,A]=C;v.parentNode&&v.parentNode.parentNode==A.parentNode?A.remove():v.remove()}else{let{focusNode:v}=this.currentSelection;for(let A of C){let T=A.parentNode;T&&T.nodeName=="LI"&&(!v||FL(e,v)!=T)&&A.remove()}}}let g=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Zp(r)&&(g=lb(e))&&g.eq(Ot.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Oa(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,c),BL(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,zL(e,p)),this.handleDOMChange(i,c,f,p),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Oa(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let C=0;C<e.addedNodes.length;C++){let v=e.addedNodes[C];n.push(v),v.nodeType==3&&(this.lastChangedTextNode=v)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Os&&Io<=11&&e.addedNodes.length)for(let C=0;C<e.addedNodes.length;C++){let{previousSibling:v,nextSibling:A}=e.addedNodes[C];(!v||Array.prototype.indexOf.call(e.addedNodes,v)<0)&&(s=v),(!A||Array.prototype.indexOf.call(e.addedNodes,A)<0)&&(i=A)}let c=s&&s.parentNode==e.target?$r(s)+1:0,f=r.localPosFromDOM(e.target,c,-1),p=i&&i.parentNode==e.target?$r(i):e.target.childNodes.length,g=r.localPosFromDOM(e.target,p,1);return{from:f,to:g}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let zE=new WeakMap,UE=!1;function BL(t){if(!zE.has(t)&&(zE.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=ii,UE)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),UE=!0}}function HE(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,c=t.domAtPos(t.state.selection.anchor);return Fl(c.node,c.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function PL(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return HE(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?HE(t,n):null}function FL(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function zL(t,e){var n;let{focusNode:r,focusOffset:s}=t.domSelectionRange();for(let i of e)if(((n=i.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let c=i.nextSibling;for(;c&&c.nodeName!="TD"&&c.nodeName!="TH";)c=c.nextSibling;if(c){let f=c;for(;;){let p=f.firstChild;if(!p||p.nodeType!=1||p.contentEditable=="false"||/^(BR|IMG)$/.test(p.nodeName))break;f=p}f.insertBefore(i,f.firstChild),r==i&&t.domSelection().collapse(i,s)}else i.parentNode.removeChild(i)}}function UL(t,e,n){let{node:r,fromOffset:s,toOffset:i,from:c,to:f}=t.docView.parseRange(e,n),p=t.domSelectionRange(),g,C=p.anchorNode;if(C&&t.dom.contains(C.nodeType==1?C:C.parentNode)&&(g=[{node:C,offset:p.anchorOffset}],Zp(p)||g.push({node:p.focusNode,offset:p.focusOffset})),Yr&&t.input.lastKeyCode===8)for(let R=i;R>s;R--){let j=r.childNodes[R-1],H=j.pmViewDesc;if(j.nodeName=="BR"&&!H){i=R;break}if(!H||H.size)break}let v=t.state.doc,A=t.someProp("domParser")||Cd.fromSchema(t.state.schema),T=v.resolve(c),_=null,M=A.parse(r,{topNode:T.parent,topMatch:T.parent.contentMatchAt(T.index()),topOpen:!0,from:s,to:i,preserveWhitespace:T.parent.type.whitespace=="pre"?"full":!0,findPositions:g,ruleFromNode:HL,context:T});if(g&&g[0].pos!=null){let R=g[0].pos,j=g[1]&&g[1].pos;j==null&&(j=R),_={anchor:R+c,head:j+c}}return{doc:M,sel:_,from:c,to:f}}function HL(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(ns&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||ns&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const VL=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function GL(t,e,n,r,s){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let U=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,ee=lb(t,U);if(ee&&!t.state.selection.eq(ee)){if(Yr&&Sa&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",Qe=>Qe(t,vl(13,"Enter"))))return;let X=t.state.tr.setSelection(ee);U=="pointer"?X.setMeta("pointer",!0):U=="key"&&X.scrollIntoView(),i&&X.setMeta("composition",i),t.dispatch(X)}return}let c=t.state.doc.resolve(e),f=c.sharedDepth(n);e=c.before(f+1),n=t.state.doc.resolve(n).after(f+1);let p=t.state.selection,g=UL(t,e,n),C=t.state.doc,v=C.slice(g.from,g.to),A,T;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(A=t.state.selection.to,T="end"):(A=t.state.selection.from,T="start"),t.input.lastKeyCode=null;let _=$L(v.content,g.doc.content,g.from,A,T);if(_&&t.input.domChangeCount++,(nu&&t.input.lastIOSEnter>Date.now()-225||Sa)&&s.some(U=>U.nodeType==1&&!VL.test(U.nodeName))&&(!_||_.endA>=_.endB)&&t.someProp("handleKeyDown",U=>U(t,vl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!_)if(r&&p instanceof Ct&&!p.empty&&p.$head.sameParent(p.$anchor)&&!t.composing&&!(g.sel&&g.sel.anchor!=g.sel.head))_={start:p.from,endA:p.to,endB:p.to};else{if(g.sel){let U=VE(t,t.state.doc,g.sel);if(U&&!U.eq(t.state.selection)){let ee=t.state.tr.setSelection(U);i&&ee.setMeta("composition",i),t.dispatch(ee)}}return}t.state.selection.from<t.state.selection.to&&_.start==_.endB&&t.state.selection instanceof Ct&&(_.start>t.state.selection.from&&_.start<=t.state.selection.from+2&&t.state.selection.from>=g.from?_.start=t.state.selection.from:_.endA<t.state.selection.to&&_.endA>=t.state.selection.to-2&&t.state.selection.to<=g.to&&(_.endB+=t.state.selection.to-_.endA,_.endA=t.state.selection.to)),Os&&Io<=11&&_.endB==_.start+1&&_.endA==_.start&&_.start>g.from&&g.doc.textBetween(_.start-g.from-1,_.start-g.from+1)==" "&&(_.start--,_.endA--,_.endB--);let M=g.doc.resolveNoCache(_.start-g.from),R=g.doc.resolveNoCache(_.endB-g.from),j=C.resolve(_.start),H=M.sameParent(R)&&M.parent.inlineContent&&j.end()>=_.endA;if((nu&&t.input.lastIOSEnter>Date.now()-225&&(!H||s.some(U=>U.nodeName=="DIV"||U.nodeName=="P"))||!H&&M.pos<g.doc.content.size&&(!M.sameParent(R)||!M.parent.inlineContent)&&M.pos<R.pos&&!/\S/.test(g.doc.textBetween(M.pos,R.pos,"","")))&&t.someProp("handleKeyDown",U=>U(t,vl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>_.start&&qL(C,_.start,_.endA,M,R)&&t.someProp("handleKeyDown",U=>U(t,vl(8,"Backspace")))){Sa&&Yr&&t.domObserver.suppressSelectionUpdates();return}Yr&&_.endB==_.start&&(t.input.lastChromeDelete=Date.now()),Sa&&!H&&M.start()!=R.start()&&R.parentOffset==0&&M.depth==R.depth&&g.sel&&g.sel.anchor==g.sel.head&&g.sel.head==_.endA&&(_.endB-=2,R=g.doc.resolveNoCache(_.endB-g.from),setTimeout(()=>{t.someProp("handleKeyDown",function(U){return U(t,vl(13,"Enter"))})},20));let G=_.start,Z=_.endA,J=U=>{let ee=U||t.state.tr.replace(G,Z,g.doc.slice(_.start-g.from,_.endB-g.from));if(g.sel){let X=VE(t,ee.doc,g.sel);X&&!(Yr&&t.composing&&X.empty&&(_.start!=_.endB||t.input.lastChromeDelete<Date.now()-100)&&(X.head==G||X.head==ee.mapping.map(Z)-1)||Os&&X.empty&&X.head==G)&&ee.setSelection(X)}return i&&ee.setMeta("composition",i),ee.scrollIntoView()},oe;if(H)if(M.pos==R.pos){Os&&Io<=11&&M.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Oa(t),20));let U=J(t.state.tr.delete(G,Z)),ee=C.resolve(_.start).marksAcross(C.resolve(_.endA));ee&&U.ensureMarks(ee),t.dispatch(U)}else if(_.endA==_.endB&&(oe=WL(M.parent.content.cut(M.parentOffset,R.parentOffset),j.parent.content.cut(j.parentOffset,_.endA-j.start())))){let U=J(t.state.tr);oe.type=="add"?U.addMark(G,Z,oe.mark):U.removeMark(G,Z,oe.mark),t.dispatch(U)}else if(M.parent.child(M.index()).isText&&M.index()==R.index()-(R.textOffset?0:1)){let U=M.parent.textBetween(M.parentOffset,R.parentOffset),ee=()=>J(t.state.tr.insertText(U,G,Z));t.someProp("handleTextInput",X=>X(t,G,Z,U,ee))||t.dispatch(ee())}else t.dispatch(J());else t.dispatch(J())}function VE(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:cb(t,e.resolve(n.anchor),e.resolve(n.head))}function WL(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,i=r,c,f,p;for(let C=0;C<r.length;C++)s=r[C].removeFromSet(s);for(let C=0;C<n.length;C++)i=n[C].removeFromSet(i);if(s.length==1&&i.length==0)f=s[0],c="add",p=C=>C.mark(f.addToSet(C.marks));else if(s.length==0&&i.length==1)f=i[0],c="remove",p=C=>C.mark(f.removeFromSet(C.marks));else return null;let g=[];for(let C=0;C<e.childCount;C++)g.push(p(e.child(C)));if(Pe.from(g).eq(t))return{mark:f,type:c}}function qL(t,e,n,r,s){if(n-e<=s.pos-r.pos||Lg(r,!0,!1)<s.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let f=i.nodeAfter;return f!=null&&n==e+f.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let c=t.resolve(Lg(i,!0,!0));return!c.parent.isTextblock||c.pos>n||Lg(c,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(c.parent.content)}function Lg(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function $L(t,e,n,r,s){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:c,b:f}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let p=Math.max(0,i-Math.min(c,f));r-=c+p-i}if(c<i&&t.size<e.size){let p=r<=i&&r>=c?i-r:0;i-=p,i&&i<e.size&&GE(e.textBetween(i-1,i+1))&&(i+=p?1:-1),f=i+(f-c),c=i}else if(f<i){let p=r<=i&&r>=f?i-r:0;i-=p,i&&i<t.size&&GE(t.textBetween(i-1,i+1))&&(i+=p?1:-1),c=i+(c-f),f=i}return{start:i,endA:c,endB:f}}function GE(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Vk{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new cL,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(YE),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=$E(this),qE(this),this.nodeViews=XE(this),this.docView=AE(this.state.doc,WE(this),Dg(this),this.dom,this),this.domObserver=new jL(this,(r,s,i,c)=>GL(this,r,s,i,c)),this.domObserver.start(),uL(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Qx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(YE),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,i=!1,c=!1;e.storedMarks&&this.composing&&(jk(this),c=!0),this.state=e;let f=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(f||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let T=XE(this);YL(T,this.nodeViews)&&(this.nodeViews=T,i=!0)}(f||n.handleDOMEvents!=this._props.handleDOMEvents)&&Qx(this),this.editable=$E(this),qE(this);let p=Dg(this),g=WE(this),C=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",v=i||!this.docView.matchesNode(e.doc,g,p);(v||!e.selection.eq(s.selection))&&(c=!0);let A=C=="preserve"&&c&&this.dom.style.overflowAnchor==null&&S7(this);if(c){this.domObserver.stop();let T=v&&(Os||Yr)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&XL(s.selection,e.selection);if(v){let _=Yr?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=SL(this)),(i||!this.docView.update(e.doc,g,p,this))&&(this.docView.updateOuterDeco(g),this.docView.destroy(),this.docView=AE(e.doc,g,p,this.dom,this)),_&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(T=!0)}T||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&X7(this))?Oa(this,T):(Sk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),C=="reset"?this.dom.scrollTop=0:C=="to selection"?this.scrollToSelection():A&&A7(A)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof vt){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&yE(this,n.getBoundingClientRect(),e)}else yE(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Pk(e.slice,e.move,s<0?void 0:vt.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let c=0;c<this.directPlugins.length;c++){let f=this.directPlugins[c].props[e];if(f!=null&&(s=n?n(f):f))return s}let i=this.state.plugins;if(i)for(let c=0;c<i.length;c++){let f=i[c].props[e];if(f!=null&&(s=n?n(f):f))return s}}hasFocus(){if(Os){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&N7(this.dom),Oa(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return R7(this,e)}coordsAtPos(e,n=1){return gk(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return j7(this,n||this.state,e)}pasteHTML(e,n){return Wd(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Wd(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return ub(this,e)}destroy(){this.docView&&(dL(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Dg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,p7())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return hL(this,e)}domSelectionRange(){let e=this.domSelection();return e?ns&&this.root.nodeType===11&&y7(this.dom.ownerDocument)==this.dom&&PL(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Vk.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function WE(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Mr.node(0,t.state.doc.content.size,e)]}function qE(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Mr.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function $E(t){return!t.someProp("editable",e=>e(t.state)===!1)}function XL(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function XE(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function YL(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function YE(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Po={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},V0={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},KL=typeof navigator<"u"&&/Mac/.test(navigator.platform),ZL=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Xr=0;Xr<10;Xr++)Po[48+Xr]=Po[96+Xr]=String(Xr);for(var Xr=1;Xr<=24;Xr++)Po[Xr+111]="F"+Xr;for(var Xr=65;Xr<=90;Xr++)Po[Xr]=String.fromCharCode(Xr+32),V0[Xr]=String.fromCharCode(Xr);for(var jg in Po)V0.hasOwnProperty(jg)||(V0[jg]=Po[jg]);function JL(t){var e=KL&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||ZL&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?V0:Po)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const QL=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),e9=typeof navigator<"u"&&/Win/.test(navigator.platform);function t9(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,i,c;for(let f=0;f<e.length-1;f++){let p=e[f];if(/^(cmd|meta|m)$/i.test(p))c=!0;else if(/^a(lt)?$/i.test(p))r=!0;else if(/^(c|ctrl|control)$/i.test(p))s=!0;else if(/^s(hift)?$/i.test(p))i=!0;else if(/^mod$/i.test(p))QL?c=!0:s=!0;else throw new Error("Unrecognized modifier name: "+p)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),c&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function n9(t){let e=Object.create(null);for(let n in t)e[t9(n)]=t[n];return e}function Bg(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function r9(t){return new qn({props:{handleKeyDown:gb(t)}})}function gb(t){let e=n9(t);return function(n,r){let s=JL(r),i,c=e[Bg(s,r)];if(c&&c(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let f=e[Bg(s,r,!1)];if(f&&f(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(e9&&r.ctrlKey&&r.altKey)&&(i=Po[r.keyCode])&&i!=s){let f=e[Bg(i,r)];if(f&&f(n.state,n.dispatch,n))return!0}}return!1}}var s9=Object.defineProperty,xb=(t,e)=>{for(var n in e)s9(t,n,{get:e[n],enumerable:!0})};function e1(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}var t1=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,i=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([c,f])=>[c,(...g)=>{const C=f(...g)(i);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),C}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,c=[],f=!!t,p=t||s.tr,g=()=>(!f&&e&&!p.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(p),c.every(v=>v===!0)),C={...Object.fromEntries(Object.entries(n).map(([v,A])=>[v,(..._)=>{const M=this.buildProps(p,e),R=A(..._)(M);return c.push(R),C}])),run:g};return C}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,i=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([f,p])=>[f,(...g)=>p(...g)({...i,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:i}=r,c={tr:t,editor:r,view:i,state:e1({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([f,p])=>[f,(...g)=>p(...g)(c)]))}};return c}},Gk={};xb(Gk,{blur:()=>i9,clearContent:()=>a9,clearNodes:()=>o9,command:()=>l9,createParagraphNear:()=>c9,cut:()=>u9,deleteCurrentNode:()=>d9,deleteNode:()=>f9,deleteRange:()=>h9,deleteSelection:()=>p9,enter:()=>m9,exitCode:()=>g9,extendMarkRange:()=>x9,first:()=>b9,focus:()=>w9,forEach:()=>v9,insertContent:()=>C9,insertContentAt:()=>A9,joinBackward:()=>T9,joinDown:()=>k9,joinForward:()=>O9,joinItemBackward:()=>_9,joinItemForward:()=>R9,joinTextblockBackward:()=>M9,joinTextblockForward:()=>I9,joinUp:()=>N9,keyboardShortcut:()=>L9,lift:()=>j9,liftEmptyBlock:()=>B9,liftListItem:()=>P9,newlineInCode:()=>F9,resetAttributes:()=>z9,scrollIntoView:()=>U9,selectAll:()=>H9,selectNodeBackward:()=>V9,selectNodeForward:()=>G9,selectParentNode:()=>W9,selectTextblockEnd:()=>q9,selectTextblockStart:()=>$9,setContent:()=>X9,setMark:()=>hj,setMeta:()=>pj,setNode:()=>mj,setNodeSelection:()=>gj,setTextDirection:()=>xj,setTextSelection:()=>bj,sinkListItem:()=>yj,splitBlock:()=>wj,splitListItem:()=>vj,toggleList:()=>Cj,toggleMark:()=>Ej,toggleNode:()=>Sj,toggleWrap:()=>Aj,undoInputRule:()=>Nj,unsetAllMarks:()=>kj,unsetMark:()=>Tj,unsetTextDirection:()=>Oj,updateAttributes:()=>_j,wrapIn:()=>Rj,wrapInList:()=>Mj});var i9=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),a9=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),o9=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:i,$to:c})=>{t.doc.nodesBetween(i.pos,c.pos,(f,p)=>{if(f.type.isText)return;const{doc:g,mapping:C}=e,v=g.resolve(C.map(p)),A=g.resolve(C.map(p+f.nodeSize)),T=v.blockRange(A);if(!T)return;const _=hu(T);if(f.type.isTextblock){const{defaultType:M}=v.parent.contentMatchAt(v.index());e.setNodeMarkup(T.start,M)}(_||_===0)&&e.lift(T,_)})}),!0},l9=t=>e=>t(e),c9=()=>({state:t,dispatch:e})=>ik(t,e),u9=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const c=r.mapping.map(e);return r.insert(c,i.content),r.setSelection(new Ct(r.doc.resolve(Math.max(c-1,0)))),!0},d9=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const f=s.before(i),p=s.after(i);t.delete(f,p).scrollIntoView()}return!0}return!1};function Cr(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var f9=t=>({tr:e,state:n,dispatch:r})=>{const s=Cr(t,n.schema),i=e.selection.$anchor;for(let c=i.depth;c>0;c-=1)if(i.node(c).type===s){if(r){const p=i.before(c),g=i.after(c);e.delete(p,g).scrollIntoView()}return!0}return!1},h9=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},p9=()=>({state:t,dispatch:e})=>nb(t,e),m9=()=>({commands:t})=>t.keyboardShortcut("Enter"),g9=()=>({state:t,dispatch:e})=>QD(t,e);function bb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function G0(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:bb(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function Wk(t,e,n={}){return t.find(r=>r.type===e&&G0(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function KE(t,e,n={}){return!!Wk(t,e,n)}function yb(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(C=>C.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(C=>C.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!Wk([...s.node.marks],e,n)))return;let c=s.index,f=t.start()+s.offset,p=c+1,g=f+s.node.nodeSize;for(;c>0&&KE([...t.parent.child(c-1).marks],e,n);)c-=1,f-=t.parent.child(c).nodeSize;for(;p<t.parent.childCount&&KE([...t.parent.child(p).marks],e,n);)g+=t.parent.child(p).nodeSize,p+=1;return{from:f,to:g}}function La(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var x9=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=La(t,r.schema),{doc:c,selection:f}=n,{$from:p,from:g,to:C}=f;if(s){const v=yb(p,i,e);if(v&&v.from<=g&&v.to>=C){const A=Ct.create(c,v.from,v.to);n.setSelection(A)}}return!0},b9=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function qk(t){return t instanceof Ct}function Al(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function $k(t,e=null){if(!e)return null;const n=Ot.atStart(t),r=Ot.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,i=r.to;return e==="all"?Ct.create(t,Al(0,s,i),Al(t.content.size,s,i)):Ct.create(t,Al(e,s,i),Al(e,s,i))}function ZE(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function W0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function y9(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var w9=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const c=()=>{(W0()||ZE())&&r.dom.focus(),y9()&&!W0()&&!ZE()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};try{if(r.hasFocus()&&t===null||t===!1)return!0}catch{return!1}if(i&&t===null&&!qk(n.state.selection))return c(),!0;const f=$k(s.doc,t)||n.state.selection,p=n.state.selection.eq(f);return i&&(p||s.setSelection(f),p&&s.storedMarks&&s.setStoredMarks(s.storedMarks),c()),!0},v9=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),C9=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Xk=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Xk(r)}return t};function Uh(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Xk(n)}function $d(t,e,n){if(t instanceof xi||t instanceof Pe)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Pe.fromArray(t.map(f=>e.nodeFromJSON(f)));const c=e.nodeFromJSON(t);return n.errorOnInvalidContent&&c.check(),c}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),$d("",e,n)}if(s){if(n.errorOnInvalidContent){let c=!1,f="";const p=new MN({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:g=>(c=!0,f=typeof g=="string"?g:g.outerHTML,null)}]}})});if(n.slice?Cd.fromSchema(p).parseSlice(Uh(t),n.parseOptions):Cd.fromSchema(p).parse(Uh(t),n.parseOptions),n.errorOnInvalidContent&&c)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${f}`)})}const i=Cd.fromSchema(e);return n.slice?i.parseSlice(Uh(t),n.parseOptions).content:i.parse(Uh(t),n.parseOptions)}return $d("",e,n)}function E9(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof Rr||s instanceof Ir))return;const i=t.mapping.maps[r];let c=0;i.forEach((f,p,g,C)=>{c===0&&(c=C)}),t.setSelection(Ot.near(t.doc.resolve(c),n))}var S9=t=>!("type"in t),A9=(t,e,n)=>({tr:r,dispatch:s,editor:i})=>{var c;if(s){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let f;const p=R=>{i.emit("contentError",{editor:i,error:R,disableCollaboration:()=>{"collaboration"in i.storage&&typeof i.storage.collaboration=="object"&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},g={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{$d(e,i.schema,{parseOptions:g,errorOnInvalidContent:!0})}catch(R){p(R)}try{f=$d(e,i.schema,{parseOptions:g,errorOnInvalidContent:(c=n.errorOnInvalidContent)!=null?c:i.options.enableContentCheck})}catch(R){return p(R),!1}let{from:C,to:v}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},A=!0,T=!0;if((S9(f)?f:[f]).forEach(R=>{R.check(),A=A?R.isText&&R.marks.length===0:!1,T=T?R.isBlock:!1}),C===v&&T){const{parent:R}=r.doc.resolve(C);R.isTextblock&&!R.type.spec.code&&!R.childCount&&(C-=1,v+=1)}let M;if(A){if(Array.isArray(e))M=e.map(R=>R.text||"").join("");else if(e instanceof Pe){let R="";e.forEach(j=>{j.text&&(R+=j.text)}),M=R}else typeof e=="object"&&e&&e.text?M=e.text:M=e;r.insertText(M,C,v)}else{M=f;const R=r.doc.resolve(C),j=R.node(),H=R.parentOffset===0,G=j.isText||j.isTextblock,Z=j.content.size>0;H&&G&&Z&&(C=Math.max(0,C-1)),r.replaceWith(C,v,M)}n.updateSelection&&E9(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:C,text:M}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:C,text:M})}return!0},N9=()=>({state:t,dispatch:e})=>KD(t,e),k9=()=>({state:t,dispatch:e})=>ZD(t,e),T9=()=>({state:t,dispatch:e})=>JN(t,e),O9=()=>({state:t,dispatch:e})=>nk(t,e),_9=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Xp(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},R9=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Xp(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},M9=()=>({state:t,dispatch:e})=>XD(t,e),I9=()=>({state:t,dispatch:e})=>YD(t,e);function Yk(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function D9(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,i,c;for(let f=0;f<e.length-1;f+=1){const p=e[f];if(/^(cmd|meta|m)$/i.test(p))c=!0;else if(/^a(lt)?$/i.test(p))r=!0;else if(/^(c|ctrl|control)$/i.test(p))s=!0;else if(/^s(hift)?$/i.test(p))i=!0;else if(/^mod$/i.test(p))W0()||Yk()?c=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${p}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),c&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}var L9=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const i=D9(t).split(/-(?!$)/),c=i.find(g=>!["Alt","Ctrl","Meta","Shift"].includes(g)),f=new KeyboardEvent("keydown",{key:c==="Space"?" ":c,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),p=e.captureTransaction(()=>{n.someProp("handleKeyDown",g=>g(n,f))});return p==null||p.steps.forEach(g=>{const C=g.map(r.mapping);C&&s&&r.maybeStep(C)}),!0};function Fo(t,e,n={}){const{from:r,to:s,empty:i}=t.selection,c=e?Cr(e,t.schema):null,f=[];t.doc.nodesBetween(r,s,(v,A)=>{if(v.isText)return;const T=Math.max(r,A),_=Math.min(s,A+v.nodeSize);f.push({node:v,from:T,to:_})});const p=s-r,g=f.filter(v=>c?c.name===v.node.type.name:!0).filter(v=>G0(v.node.attrs,n,{strict:!1}));return i?!!g.length:g.reduce((v,A)=>v+A.to-A.from,0)>=p}var j9=(t,e={})=>({state:n,dispatch:r})=>{const s=Cr(t,n.schema);return Fo(n,s,e)?JD(n,r):!1},B9=()=>({state:t,dispatch:e})=>ak(t,e),P9=t=>({state:e,dispatch:n})=>{const r=Cr(t,e.schema);return u7(r)(e,n)},F9=()=>({state:t,dispatch:e})=>sk(t,e);function n1(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function JE(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var z9=(t,e)=>({tr:n,state:r,dispatch:s})=>{let i=null,c=null;const f=n1(typeof t=="string"?t:t.name,r.schema);if(!f)return!1;f==="node"&&(i=Cr(t,r.schema)),f==="mark"&&(c=La(t,r.schema));let p=!1;return n.selection.ranges.forEach(g=>{r.doc.nodesBetween(g.$from.pos,g.$to.pos,(C,v)=>{i&&i===C.type&&(p=!0,s&&n.setNodeMarkup(v,void 0,JE(C.attrs,e))),c&&C.marks.length&&C.marks.forEach(A=>{c===A.type&&(p=!0,s&&n.addMark(v,v+C.nodeSize,c.create(JE(A.attrs,e))))})})}),p},U9=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),H9=()=>({tr:t,dispatch:e})=>{if(e){const n=new Vs(t.doc);t.setSelection(n)}return!0},V9=()=>({state:t,dispatch:e})=>ek(t,e),G9=()=>({state:t,dispatch:e})=>rk(t,e),W9=()=>({state:t,dispatch:e})=>n7(t,e),q9=()=>({state:t,dispatch:e})=>i7(t,e),$9=()=>({state:t,dispatch:e})=>s7(t,e);function e2(t,e,n={},r={}){return $d(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var X9=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:i,dispatch:c,commands:f})=>{const{doc:p}=i;if(r.preserveWhitespace!=="full"){const g=e2(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return c&&i.replaceWith(0,p.content.size,g).setMeta("preventUpdate",!n),!0}return c&&i.setMeta("preventUpdate",!n),f.insertContentAt({from:0,to:p.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function Kk(t,e){const n=La(e,t.schema),{from:r,to:s,empty:i}=t.selection,c=[];i?(t.storedMarks&&c.push(...t.storedMarks),c.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,p=>{c.push(...p.marks)});const f=c.find(p=>p.type.name===n.name);return f?{...f.attrs}:{}}function Zk(t,e){const n=new eb(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function Y9(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function K9(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,i)=>{n(s)&&r.push({node:s,pos:i})}),r}function Jk(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function r1(t){return e=>Jk(e.$from,t)}function xt(t,e,n){return t.config[e]===void 0&&t.parent?xt(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?xt(t.parent,e,n):null}):t.config[e]}function wb(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=xt(e,"addExtensions",n);return r?[e,...wb(r())]:e}).flat(10)}function vb(t,e){const n=Wl.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function Qk(t){return typeof t=="function"}function Cn(t,e=void 0,...n){return Qk(t)?e?t.bind(e)(...n):t(...n):t}function Z9(t={}){return Object.keys(t).length===0&&t.constructor===Object}function ru(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function e4(t){const e=[],{nodeExtensions:n,markExtensions:r}=ru(t),s=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(c=>{const f={name:c.name,options:c.options,storage:c.storage,extensions:s},p=xt(c,"addGlobalAttributes",f);if(!p)return;p().forEach(C=>{C.types.forEach(v=>{Object.entries(C.attributes).forEach(([A,T])=>{e.push({type:v,name:A,attribute:{...i,...T}})})})})}),s.forEach(c=>{const f={name:c.name,options:c.options,storage:c.storage},p=xt(c,"addAttributes",f);if(!p)return;const g=p();Object.entries(g).forEach(([C,v])=>{const A={...i,...v};typeof(A==null?void 0:A.default)=="function"&&(A.default=A.default()),A!=null&&A.isRequired&&(A==null?void 0:A.default)===void 0&&delete A.default,e.push({type:c.name,name:C,attribute:A})})}),e}function Wn(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const f=i?String(i).split(" "):[],p=r[s]?r[s].split(" "):[],g=f.filter(C=>!p.includes(C));r[s]=[...p,...g].join(" ")}else if(s==="style"){const f=i?i.split(";").map(C=>C.trim()).filter(Boolean):[],p=r[s]?r[s].split(";").map(C=>C.trim()).filter(Boolean):[],g=new Map;p.forEach(C=>{const[v,A]=C.split(":").map(T=>T.trim());g.set(v,A)}),f.forEach(C=>{const[v,A]=C.split(":").map(T=>T.trim());g.set(v,A)}),r[s]=Array.from(g.entries()).map(([C,v])=>`${C}: ${v}`).join("; ")}else r[s]=i}),r},{})}function Xd(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Wn(n,r),{})}function J9(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function QE(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((i,c)=>{const f=c.attribute.parseHTML?c.attribute.parseHTML(n):J9(n.getAttribute(c.name));return f==null?i:{...i,[c.name]:f}},{});return{...r,...s}}}}function eS(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&Z9(n)?!1:n!=null))}function tS(t){var e,n;const r={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(r.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function Q9(t,e){var n;const r=e4(t),{nodeExtensions:s,markExtensions:i}=ru(t),c=(n=s.find(g=>xt(g,"topNode")))==null?void 0:n.name,f=Object.fromEntries(s.map(g=>{const C=r.filter(j=>j.type===g.name),v={name:g.name,options:g.options,storage:g.storage,editor:e},A=t.reduce((j,H)=>{const G=xt(H,"extendNodeSchema",v);return{...j,...G?G(g):{}}},{}),T=eS({...A,content:Cn(xt(g,"content",v)),marks:Cn(xt(g,"marks",v)),group:Cn(xt(g,"group",v)),inline:Cn(xt(g,"inline",v)),atom:Cn(xt(g,"atom",v)),selectable:Cn(xt(g,"selectable",v)),draggable:Cn(xt(g,"draggable",v)),code:Cn(xt(g,"code",v)),whitespace:Cn(xt(g,"whitespace",v)),linebreakReplacement:Cn(xt(g,"linebreakReplacement",v)),defining:Cn(xt(g,"defining",v)),isolating:Cn(xt(g,"isolating",v)),attrs:Object.fromEntries(C.map(tS))}),_=Cn(xt(g,"parseHTML",v));_&&(T.parseDOM=_.map(j=>QE(j,C)));const M=xt(g,"renderHTML",v);M&&(T.toDOM=j=>M({node:j,HTMLAttributes:Xd(j,C)}));const R=xt(g,"renderText",v);return R&&(T.toText=R),[g.name,T]})),p=Object.fromEntries(i.map(g=>{const C=r.filter(R=>R.type===g.name),v={name:g.name,options:g.options,storage:g.storage,editor:e},A=t.reduce((R,j)=>{const H=xt(j,"extendMarkSchema",v);return{...R,...H?H(g):{}}},{}),T=eS({...A,inclusive:Cn(xt(g,"inclusive",v)),excludes:Cn(xt(g,"excludes",v)),group:Cn(xt(g,"group",v)),spanning:Cn(xt(g,"spanning",v)),code:Cn(xt(g,"code",v)),attrs:Object.fromEntries(C.map(tS))}),_=Cn(xt(g,"parseHTML",v));_&&(T.parseDOM=_.map(R=>QE(R,C)));const M=xt(g,"renderHTML",v);return M&&(T.toDOM=R=>M({mark:R,HTMLAttributes:Xd(R,C)})),[g.name,T]}));return new MN({topNode:c,nodes:f,marks:p})}function ej(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function q0(t){return t.sort((n,r)=>{const s=xt(n,"priority")||100,i=xt(r,"priority")||100;return s>i?-1:s<i?1:0})}function t4(t){const e=q0(wb(t)),n=ej(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function n4(t,e,n){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:c={}}=n||{};let f="";return t.nodesBetween(r,s,(p,g,C,v)=>{var A;p.isBlock&&g>r&&(f+=i);const T=c==null?void 0:c[p.type.name];if(T)return C&&(f+=T({node:p,pos:g,parent:C,index:v,range:e})),!1;p.isText&&(f+=(A=p==null?void 0:p.text)==null?void 0:A.slice(Math.max(r,g)-g,s-g))}),f}function tj(t,e){const n={from:0,to:t.content.size};return n4(t,n,e)}function r4(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function nj(t,e){const n=Cr(e,t.schema),{from:r,to:s}=t.selection,i=[];t.doc.nodesBetween(r,s,f=>{i.push(f)});const c=i.reverse().find(f=>f.type.name===n.name);return c?{...c.attrs}:{}}function s4(t,e){const n=n1(typeof e=="string"?e:e.name,t.schema);return n==="node"?nj(t,e):n==="mark"?Kk(t,e):{}}function rj(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function sj(t){const e=rj(t);return e.length===1?e:e.filter((n,r)=>!e.filter((i,c)=>c!==r).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function i4(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,i)=>{const c=[];if(s.ranges.length)s.forEach((f,p)=>{c.push({from:f,to:p})});else{const{from:f,to:p}=n[i];if(f===void 0||p===void 0)return;c.push({from:f,to:p})}c.forEach(({from:f,to:p})=>{const g=e.slice(i).map(f,-1),C=e.slice(i).map(p),v=e.invert().map(g,-1),A=e.invert().map(C);r.push({oldRange:{from:v,to:A},newRange:{from:g,to:C}})})}),sj(r)}function Cb(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const i=n.resolve(t),c=yb(i,s.type);c&&r.push({mark:s,...c})}):n.nodesBetween(t,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(c=>({from:i,to:i+s.nodeSize,mark:c})))}),r}var ij=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let i=r,c=null;for(;i>0&&c===null;){const f=s.node(i);(f==null?void 0:f.type.name)===e?c=f:i-=1}return[c,i]};function Hh(t,e){return e.nodes[t]||e.marks[t]||null}function u0(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}var aj=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,i,c,f)=>{var p,g;const C=((g=(p=s.type.spec).toText)==null?void 0:g.call(p,{node:s,pos:i,parent:c,index:f}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?C:C.slice(0,Math.max(0,r-i))}),n};function t2(t,e,n={}){const{empty:r,ranges:s}=t.selection,i=e?La(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(v=>i?i.name===v.type.name:!0).find(v=>G0(v.attrs,n,{strict:!1}));let c=0;const f=[];if(s.forEach(({$from:v,$to:A})=>{const T=v.pos,_=A.pos;t.doc.nodesBetween(T,_,(M,R)=>{if(!M.isText&&!M.marks.length)return;const j=Math.max(T,R),H=Math.min(_,R+M.nodeSize),G=H-j;c+=G,f.push(...M.marks.map(Z=>({mark:Z,from:j,to:H})))})}),c===0)return!1;const p=f.filter(v=>i?i.name===v.mark.type.name:!0).filter(v=>G0(v.mark.attrs,n,{strict:!1})).reduce((v,A)=>v+A.to-A.from,0),g=f.filter(v=>i?v.mark.type!==i&&v.mark.type.excludes(i):!0).reduce((v,A)=>v+A.to-A.from,0);return(p>0?p+g:p)>=c}function oj(t,e,n={}){if(!e)return Fo(t,null,n)||t2(t,null,n);const r=n1(e,t.schema);return r==="node"?Fo(t,e,n):r==="mark"?t2(t,e,n):!1}var lj=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const i=r1(f=>f.type.name===e)(t.selection);if(!i)return!1;const c=t.doc.resolve(i.pos+1);return s.pos+1===c.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},cj=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function nS(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function rS(t,e){const{nodeExtensions:n}=ru(e),r=n.find(c=>c.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=Cn(xt(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function s1(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(i=>{s!==!1&&(s1(i,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function a4(t){return t instanceof vt}var o4=class l4{constructor(e){this.position=e}static fromJSON(e){return new l4(e.position)}toJSON(){return{position:this.position}}};function uj(t,e){const n=e.mapping.mapResult(t.position);return{position:new o4(n.pos),mapResult:n}}function dj(t){return new o4(t)}function fj(t,e,n){var r;const{selection:s}=e;let i=null;if(qk(s)&&(i=s.$cursor),i){const f=(r=t.storedMarks)!=null?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(f)||!f.some(g=>g.type.excludes(n)))}const{ranges:c}=s;return c.some(({$from:f,$to:p})=>{let g=f.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(f.pos,p.pos,(C,v,A)=>{if(g)return!1;if(C.isInline){const T=!A||A.type.allowsMarkType(n),_=!!n.isInSet(C.marks)||!C.marks.some(M=>M.type.excludes(n));g=T&&_}return!g}),g})}var hj=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=n,{empty:c,ranges:f}=i,p=La(t,r.schema);if(s)if(c){const g=Kk(r,p);n.addStoredMark(p.create({...g,...e}))}else f.forEach(g=>{const C=g.$from.pos,v=g.$to.pos;r.doc.nodesBetween(C,v,(A,T)=>{const _=Math.max(T,C),M=Math.min(T+A.nodeSize,v);A.marks.find(j=>j.type===p)?A.marks.forEach(j=>{p===j.type&&n.addMark(_,M,p.create({...j.attrs,...e}))}):n.addMark(_,M,p.create(e))})});return fj(r,n,p)},pj=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),mj=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=Cr(t,n.schema);let c;return n.selection.$anchor.sameParent(n.selection.$head)&&(c=n.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:f})=>gE(i,{...c,...e})(n)?!0:f.clearNodes()).command(({state:f})=>gE(i,{...c,...e})(f,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},gj=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=Al(t,0,r.content.size),i=vt.create(r,s);e.setSelection(i)}return!0},xj=(t,e)=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=r;let c,f;return typeof e=="number"?(c=e,f=e):e&&"from"in e&&"to"in e?(c=e.from,f=e.to):(c=i.from,f=i.to),s&&n.doc.nodesBetween(c,f,(p,g)=>{p.isText||n.setNodeMarkup(g,void 0,{...p.attrs,dir:t})}),!0},bj=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:i}=typeof t=="number"?{from:t,to:t}:t,c=Ct.atStart(r).from,f=Ct.atEnd(r).to,p=Al(s,c,f),g=Al(i,c,f),C=Ct.create(r,p,g);e.setSelection(C)}return!0},yj=t=>({state:e,dispatch:n})=>{const r=Cr(t,e.schema);return h7(r)(e,n)};function sS(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}var wj=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:c}=e,{$from:f,$to:p}=i,g=s.extensionManager.attributes,C=u0(g,f.node().type.name,f.node().attrs);if(i instanceof vt&&i.node.isBlock)return!f.parentOffset||!Ta(c,f.pos)?!1:(r&&(t&&sS(n,s.extensionManager.splittableMarks),e.split(f.pos).scrollIntoView()),!0);if(!f.parent.isBlock)return!1;const v=p.parentOffset===p.parent.content.size,A=f.depth===0?void 0:Y9(f.node(-1).contentMatchAt(f.indexAfter(-1)));let T=v&&A?[{type:A,attrs:C}]:void 0,_=Ta(e.doc,e.mapping.map(f.pos),1,T);if(!T&&!_&&Ta(e.doc,e.mapping.map(f.pos),1,A?[{type:A}]:void 0)&&(_=!0,T=A?[{type:A,attrs:C}]:void 0),r){if(_&&(i instanceof Ct&&e.deleteSelection(),e.split(e.mapping.map(f.pos),1,T),A&&!v&&!f.parentOffset&&f.parent.type!==A)){const M=e.mapping.map(f.before()),R=e.doc.resolve(M);f.node(-1).canReplaceWith(R.index(),R.index()+1,A)&&e.setNodeMarkup(e.mapping.map(f.before()),A)}t&&sS(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return _},vj=(t,e={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var c;const f=Cr(t,r.schema),{$from:p,$to:g}=r.selection,C=r.selection.node;if(C&&C.isBlock||p.depth<2||!p.sameParent(g))return!1;const v=p.node(-1);if(v.type!==f)return!1;const A=i.extensionManager.attributes;if(p.parent.content.size===0&&p.node(-1).childCount===p.indexAfter(-1)){if(p.depth===2||p.node(-3).type!==f||p.index(-2)!==p.node(-2).childCount-1)return!1;if(s){let j=Pe.empty;const H=p.index(-1)?1:p.index(-2)?2:3;for(let ee=p.depth-H;ee>=p.depth-3;ee-=1)j=Pe.from(p.node(ee).copy(j));const G=p.indexAfter(-1)<p.node(-2).childCount?1:p.indexAfter(-2)<p.node(-3).childCount?2:3,Z={...u0(A,p.node().type.name,p.node().attrs),...e},J=((c=f.contentMatch.defaultType)==null?void 0:c.createAndFill(Z))||void 0;j=j.append(Pe.from(f.createAndFill(null,J)||void 0));const oe=p.before(p.depth-(H-1));n.replace(oe,p.after(-G),new st(j,4-H,0));let U=-1;n.doc.nodesBetween(oe,n.doc.content.size,(ee,X)=>{if(U>-1)return!1;ee.isTextblock&&ee.content.size===0&&(U=X+1)}),U>-1&&n.setSelection(Ct.near(n.doc.resolve(U))),n.scrollIntoView()}return!0}const T=g.pos===p.end()?v.contentMatchAt(0).defaultType:null,_={...u0(A,v.type.name,v.attrs),...e},M={...u0(A,p.node().type.name,p.node().attrs),...e};n.delete(p.pos,g.pos);const R=T?[{type:f,attrs:_},{type:T,attrs:M}]:[{type:f,attrs:_}];if(!Ta(n.doc,p.pos,2))return!1;if(s){const{selection:j,storedMarks:H}=r,{splittableMarks:G}=i.extensionManager,Z=H||j.$to.parentOffset&&j.$from.marks();if(n.split(p.pos,2,R).scrollIntoView(),!Z||!s)return!0;const J=Z.filter(oe=>G.includes(oe.type.name));n.ensureMarks(J)}return!0},Pg=(t,e)=>{const n=r1(c=>c.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&Uo(t.doc,n.pos)&&t.join(n.pos),!0},Fg=(t,e)=>{const n=r1(c=>c.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&Uo(t.doc,r)&&t.join(r),!0},Cj=(t,e,n,r={})=>({editor:s,tr:i,state:c,dispatch:f,chain:p,commands:g,can:C})=>{const{extensions:v,splittableMarks:A}=s.extensionManager,T=Cr(t,c.schema),_=Cr(e,c.schema),{selection:M,storedMarks:R}=c,{$from:j,$to:H}=M,G=j.blockRange(H),Z=R||M.$to.parentOffset&&M.$from.marks();if(!G)return!1;const J=r1(oe=>rS(oe.type.name,v))(M);if(G.depth>=1&&J&&G.depth-J.depth<=1){if(J.node.type===T)return g.liftListItem(_);if(rS(J.node.type.name,v)&&T.validContent(J.node.content)&&f)return p().command(()=>(i.setNodeMarkup(J.pos,T),!0)).command(()=>Pg(i,T)).command(()=>Fg(i,T)).run()}return!n||!Z||!f?p().command(()=>C().wrapInList(T,r)?!0:g.clearNodes()).wrapInList(T,r).command(()=>Pg(i,T)).command(()=>Fg(i,T)).run():p().command(()=>{const oe=C().wrapInList(T,r),U=Z.filter(ee=>A.includes(ee.type.name));return i.ensureMarks(U),oe?!0:g.clearNodes()}).wrapInList(T,r).command(()=>Pg(i,T)).command(()=>Fg(i,T)).run()},Ej=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=n,c=La(t,r.schema);return t2(r,c,e)?s.unsetMark(c,{extendEmptyMarkRange:i}):s.setMark(c,e)},Sj=(t,e,n={})=>({state:r,commands:s})=>{const i=Cr(t,r.schema),c=Cr(e,r.schema),f=Fo(r,i,n);let p;return r.selection.$anchor.sameParent(r.selection.$head)&&(p=r.selection.$anchor.parent.attrs),f?s.setNode(c,p):s.setNode(i,{...p,...n})},Aj=(t,e={})=>({state:n,commands:r})=>{const s=Cr(t,n.schema);return Fo(n,s,e)?r.lift(s):r.wrapIn(s,e)},Nj=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let i;if(s.spec.isInputRules&&(i=s.getState(t))){if(e){const c=t.tr,f=i.transform;for(let p=f.steps.length-1;p>=0;p-=1)c.step(f.steps[p].invert(f.docs[p]));if(i.text){const p=c.doc.resolve(i.from).marks();c.replaceWith(i.from,i.to,t.schema.text(i.text,p))}else c.delete(i.from,i.to)}return!0}}return!1},kj=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(i=>{t.removeMark(i.$from.pos,i.$to.pos)}),!0},Tj=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:c=!1}=e,{selection:f}=n,p=La(t,r.schema),{$from:g,empty:C,ranges:v}=f;if(!s)return!0;if(C&&c){let{from:A,to:T}=f;const _=(i=g.marks().find(R=>R.type===p))==null?void 0:i.attrs,M=yb(g,p,_);M&&(A=M.from,T=M.to),n.removeMark(A,T,p)}else v.forEach(A=>{n.removeMark(A.$from.pos,A.$to.pos,p)});return n.removeStoredMark(p),!0},Oj=t=>({tr:e,state:n,dispatch:r})=>{const{selection:s}=n;let i,c;return typeof t=="number"?(i=t,c=t):t&&"from"in t&&"to"in t?(i=t.from,c=t.to):(i=s.from,c=s.to),r&&e.doc.nodesBetween(i,c,(f,p)=>{if(f.isText)return;const g={...f.attrs};delete g.dir,e.setNodeMarkup(p,void 0,g)}),!0},_j=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let i=null,c=null;const f=n1(typeof t=="string"?t:t.name,r.schema);if(!f)return!1;f==="node"&&(i=Cr(t,r.schema)),f==="mark"&&(c=La(t,r.schema));let p=!1;return n.selection.ranges.forEach(g=>{const C=g.$from.pos,v=g.$to.pos;let A,T,_,M;n.selection.empty?r.doc.nodesBetween(C,v,(R,j)=>{i&&i===R.type&&(p=!0,_=Math.max(j,C),M=Math.min(j+R.nodeSize,v),A=j,T=R)}):r.doc.nodesBetween(C,v,(R,j)=>{j<C&&i&&i===R.type&&(p=!0,_=Math.max(j,C),M=Math.min(j+R.nodeSize,v),A=j,T=R),j>=C&&j<=v&&(i&&i===R.type&&(p=!0,s&&n.setNodeMarkup(j,void 0,{...R.attrs,...e})),c&&R.marks.length&&R.marks.forEach(H=>{if(c===H.type&&(p=!0,s)){const G=Math.max(j,C),Z=Math.min(j+R.nodeSize,v);n.addMark(G,Z,c.create({...H.attrs,...e}))}}))}),T&&(A!==void 0&&s&&n.setNodeMarkup(A,void 0,{...T.attrs,...e}),c&&T.marks.length&&T.marks.forEach(R=>{c===R.type&&s&&n.addMark(_,M,c.create({...R.attrs,...e}))}))}),p},Rj=(t,e={})=>({state:n,dispatch:r})=>{const s=Cr(t,n.schema);return a7(s,e)(n,r)},Mj=(t,e={})=>({state:n,dispatch:r})=>{const s=Cr(t,n.schema);return o7(s,e)(n,r)},Ij=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},i1=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Dj=(t,e)=>{if(bb(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Vh(t){var e;const{editor:n,from:r,to:s,text:i,rules:c,plugin:f}=t,{view:p}=n;if(p.composing)return!1;const g=p.state.doc.resolve(r);if(g.parent.type.spec.code||(e=g.nodeBefore||g.nodeAfter)!=null&&e.marks.find(A=>A.type.spec.code))return!1;let C=!1;const v=aj(g)+i;return c.forEach(A=>{if(C)return;const T=Dj(v,A.find);if(!T)return;const _=p.state.tr,M=e1({state:p.state,transaction:_}),R={from:r-(T[0].length-i.length),to:s},{commands:j,chain:H,can:G}=new t1({editor:n,state:M});A.handler({state:M,range:R,match:T,commands:j,chain:H,can:G})===null||!_.steps.length||(A.undoable&&_.setMeta(f,{transform:_,from:r,to:s,text:i}),p.dispatch(_),C=!0)}),C}function Lj(t){const{editor:e,rules:n}=t,r=new qn({state:{init(){return null},apply(s,i,c){const f=s.getMeta(r);if(f)return f;const p=s.getMeta("applyInputRules");return!!p&&setTimeout(()=>{let{text:C}=p;typeof C=="string"?C=C:C=vb(Pe.from(C),c.schema);const{from:v}=p,A=v+C.length;Vh({editor:e,from:v,to:A,text:C,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,c,f){return Vh({editor:e,from:i,to:c,text:f,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Vh({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:c}=s.state.selection;return c?Vh({editor:e,from:c.pos,to:c.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function jj(t){return Object.prototype.toString.call(t).slice(8,-1)}function Gh(t){return jj(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function c4(t,e){const n={...t};return Gh(t)&&Gh(e)&&Object.keys(e).forEach(r=>{Gh(e[r])&&Gh(t[r])?n[r]=c4(t[r],e[r]):n[r]=e[r]}),n}var Eb=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Cn(xt(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Cn(xt(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>c4(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Vo=class u4 extends Eb{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new u4(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const c=s.marks();if(!!!c.find(g=>(g==null?void 0:g.type.name)===n.name))return!1;const p=c.find(g=>(g==null?void 0:g.type.name)===n.name);return p&&r.removeStoredMark(p),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Bj(t){return typeof t=="number"}var Pj=class{constructor(t){this.find=t.find,this.handler=t.handler}},Fj=(t,e,n)=>{if(bb(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=t,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function zj(t){const{editor:e,state:n,from:r,to:s,rule:i,pasteEvent:c,dropEvent:f}=t,{commands:p,chain:g,can:C}=new t1({editor:e,state:n}),v=[];return n.doc.nodesBetween(r,s,(T,_)=>{var M,R,j,H,G;if((R=(M=T.type)==null?void 0:M.spec)!=null&&R.code||!(T.isText||T.isTextblock||T.isInline))return;const Z=(G=(H=(j=T.content)==null?void 0:j.size)!=null?H:T.nodeSize)!=null?G:0,J=Math.max(r,_),oe=Math.min(s,_+Z);if(J>=oe)return;const U=T.isText?T.text||"":T.textBetween(J-_,oe-_,void 0,"");Fj(U,i.find,c).forEach(X=>{if(X.index===void 0)return;const Qe=J+X.index+1,je=Qe+X[0].length,ue={from:n.tr.mapping.map(Qe),to:n.tr.mapping.map(je)},Ie=i.handler({state:n,range:ue,match:X,commands:p,chain:g,can:C,pasteEvent:c,dropEvent:f});v.push(Ie)})}),v.every(T=>T!==null)}var Wh=null,Uj=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function Hj(t){const{editor:e,rules:n}=t;let r=null,s=!1,i=!1,c=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,f;try{f=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{f=null}const p=({state:C,from:v,to:A,rule:T,pasteEvt:_})=>{const M=C.tr,R=e1({state:C,transaction:M});if(!(!zj({editor:e,state:R,from:Math.max(v-1,0),to:A.b-1,rule:T,pasteEvent:_,dropEvent:f})||!M.steps.length)){try{f=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{f=null}return c=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,M}};return n.map(C=>new qn({view(v){const A=_=>{var M;r=(M=v.dom.parentElement)!=null&&M.contains(_.target)?v.dom.parentElement:null,r&&(Wh=e)},T=()=>{Wh&&(Wh=null)};return window.addEventListener("dragstart",A),window.addEventListener("dragend",T),{destroy(){window.removeEventListener("dragstart",A),window.removeEventListener("dragend",T)}}},props:{handleDOMEvents:{drop:(v,A)=>{if(i=r===v.dom.parentElement,f=A,!i){const T=Wh;T!=null&&T.isEditable&&setTimeout(()=>{const _=T.state.selection;_&&T.commands.deleteRange({from:_.from,to:_.to})},10)}return!1},paste:(v,A)=>{var T;const _=(T=A.clipboardData)==null?void 0:T.getData("text/html");return c=A,s=!!(_!=null&&_.includes("data-pm-slice")),!1}}},appendTransaction:(v,A,T)=>{const _=v[0],M=_.getMeta("uiEvent")==="paste"&&!s,R=_.getMeta("uiEvent")==="drop"&&!i,j=_.getMeta("applyPasteRules"),H=!!j;if(!M&&!R&&!H)return;if(H){let{text:J}=j;typeof J=="string"?J=J:J=vb(Pe.from(J),T.schema);const{from:oe}=j,U=oe+J.length,ee=Uj(J);return p({rule:C,state:T,from:oe,to:{b:U},pasteEvt:ee})}const G=A.doc.content.findDiffStart(T.doc.content),Z=A.doc.content.findDiffEnd(T.doc.content);if(!(!Bj(G)||!Z||G===Z.b))return p({rule:C,state:T,from:G,to:Z,pasteEvt:c})}}))}var a1=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=t4(t),this.schema=Q9(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Hh(e.name,this.schema)},r=xt(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return q0([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Hh(r.name,this.schema)},i=[],c=xt(r,"addKeyboardShortcuts",s);let f={};if(r.type==="mark"&&xt(r,"exitable",s)&&(f.ArrowRight=()=>Vo.handleExit({editor:t,mark:r})),c){const A=Object.fromEntries(Object.entries(c()).map(([T,_])=>[T,()=>_({editor:t})]));f={...f,...A}}const p=r9(f);i.push(p);const g=xt(r,"addInputRules",s);if(nS(r,t.options.enableInputRules)&&g){const A=g();if(A&&A.length){const T=Lj({editor:t,rules:A}),_=Array.isArray(T)?T:[T];i.push(..._)}}const C=xt(r,"addPasteRules",s);if(nS(r,t.options.enablePasteRules)&&C){const A=C();if(A&&A.length){const T=Hj({editor:t,rules:A});i.push(...T)}}const v=xt(r,"addProseMirrorPlugins",s);if(v){const A=v();i.push(...A)}return i})}get attributes(){return e4(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=ru(this.extensions);return Object.fromEntries(e.filter(n=>!!xt(n,"addNodeView")).map(n=>{const r=this.attributes.filter(p=>p.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Cr(n.name,this.schema)},i=xt(n,"addNodeView",s);if(!i)return[];const c=i();if(!c)return[];const f=(p,g,C,v,A)=>{const T=Xd(p,r);return c({node:p,view:g,getPos:C,decorations:v,innerDecorations:A,editor:t,extension:n,HTMLAttributes:T})};return[n.name,f]}))}dispatchTransaction(t){const{editor:e}=this;return q0([...this.extensions].reverse()).reduceRight((r,s)=>{const i={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:e,type:Hh(s.name,this.schema)},c=xt(s,"dispatchTransaction",i);return c?f=>{c.call(i,{transaction:f,next:r})}:r},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=ru(this.extensions);return Object.fromEntries(e.filter(n=>!!xt(n,"addMarkView")).map(n=>{const r=this.attributes.filter(f=>f.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:La(n.name,this.schema)},i=xt(n,"addMarkView",s);if(!i)return[];const c=(f,p,g)=>{const C=Xd(f,r);return i()({mark:f,view:p,inline:g,editor:t,extension:n,HTMLAttributes:C,updateAttributes:v=>{nB(f,t,v)}})};return[n.name,c]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Hh(e.name,this.schema)};e.type==="mark"&&((n=Cn(xt(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=xt(e,"onBeforeCreate",r),i=xt(e,"onCreate",r),c=xt(e,"onUpdate",r),f=xt(e,"onSelectionUpdate",r),p=xt(e,"onTransaction",r),g=xt(e,"onFocus",r),C=xt(e,"onBlur",r),v=xt(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),c&&this.editor.on("update",c),f&&this.editor.on("selectionUpdate",f),p&&this.editor.on("transaction",p),g&&this.editor.on("focus",g),C&&this.editor.on("blur",C),v&&this.editor.on("destroy",v)})}};a1.resolve=t4;a1.sort=q0;a1.flatten=wb;var Vj={};xb(Vj,{ClipboardTextSerializer:()=>f4,Commands:()=>h4,Delete:()=>p4,Drop:()=>m4,Editable:()=>g4,FocusEvents:()=>b4,Keymap:()=>y4,Paste:()=>w4,Tabindex:()=>v4,TextDirection:()=>C4,focusEventsPluginKey:()=>x4});var Tn=class d4 extends Eb{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new d4(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},f4=Tn.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new qn({key:new ur("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:i}=s,c=Math.min(...i.map(C=>C.$from.pos)),f=Math.max(...i.map(C=>C.$to.pos)),p=r4(n);return n4(r,{from:c,to:f},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:p})}}})]}}),h4=Tn.create({name:"commands",addCommands(){return{...Gk}}}),p4=Tn.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const i=()=>{var c,f,p,g;if((g=(p=(f=(c=this.editor.options.coreExtensionOptions)==null?void 0:c.delete)==null?void 0:f.filterTransaction)==null?void 0:p.call(f,t))!=null?g:t.getMeta("y-sync$"))return;const C=Zk(t.before,[t,...e]);i4(C).forEach(T=>{C.mapping.mapResult(T.oldRange.from).deletedAfter&&C.mapping.mapResult(T.oldRange.to).deletedBefore&&C.before.nodesBetween(T.oldRange.from,T.oldRange.to,(_,M)=>{const R=M+_.nodeSize-2,j=T.oldRange.from<=M&&R<=T.oldRange.to;this.editor.emit("delete",{type:"node",node:_,from:M,to:R,newFrom:C.mapping.map(M),newTo:C.mapping.map(R),deletedRange:T.oldRange,newRange:T.newRange,partial:!j,editor:this.editor,transaction:t,combinedTransform:C})})});const A=C.mapping;C.steps.forEach((T,_)=>{var M,R;if(T instanceof mi){const j=A.slice(_).map(T.from,-1),H=A.slice(_).map(T.to),G=A.invert().map(j,-1),Z=A.invert().map(H),J=(M=C.doc.nodeAt(j-1))==null?void 0:M.marks.some(U=>U.eq(T.mark)),oe=(R=C.doc.nodeAt(H))==null?void 0:R.marks.some(U=>U.eq(T.mark));this.editor.emit("delete",{type:"mark",mark:T.mark,from:T.from,to:T.to,deletedRange:{from:G,to:Z},newRange:{from:j,to:H},partial:!!(oe||J),editor:this.editor,transaction:t,combinedTransform:C})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(i,0):i()}}),m4=Tn.create({name:"drop",addProseMirrorPlugins(){return[new qn({key:new ur("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),g4=Tn.create({name:"editable",addProseMirrorPlugins(){return[new qn({key:new ur("editable"),props:{editable:()=>this.editor.options.editable}})]}}),x4=new ur("focusEvents"),b4=Tn.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new qn({key:x4,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),y4=Tn.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:c})=>[()=>c.undoInputRule(),()=>c.command(({tr:f})=>{const{selection:p,doc:g}=f,{empty:C,$anchor:v}=p,{pos:A,parent:T}=v,_=v.parent.isTextblock&&A>0?f.doc.resolve(A-1):v,M=_.parent.type.spec.isolating,R=v.pos-v.parentOffset,j=M&&_.parent.childCount===1?R===v.pos:Ot.atStart(g).from===A;return!C||!T.type.isTextblock||T.textContent.length||!j||j&&v.parent.type.name==="paragraph"?!1:c.clearNodes()}),()=>c.deleteSelection(),()=>c.joinBackward(),()=>c.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:c})=>[()=>c.deleteSelection(),()=>c.deleteCurrentNode(),()=>c.joinForward(),()=>c.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:c})=>[()=>c.newlineInCode(),()=>c.createParagraphNear(),()=>c.liftEmptyBlock(),()=>c.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return W0()||Yk()?i:s},addProseMirrorPlugins(){return[new qn({key:new ur("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(M=>M.getMeta("composition")))return;const r=t.some(M=>M.docChanged)&&!e.doc.eq(n.doc),s=t.some(M=>M.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:c,to:f}=e.selection,p=Ot.atStart(e.doc).from,g=Ot.atEnd(e.doc).to;if(i||!(c===p&&f===g)||!s1(n.doc))return;const A=n.tr,T=e1({state:n,transaction:A}),{commands:_}=new t1({editor:this.editor,state:T});if(_.clearNodes(),!!A.steps.length)return A}})]}}),w4=Tn.create({name:"paste",addProseMirrorPlugins(){return[new qn({key:new ur("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),v4=Tn.create({name:"tabindex",addProseMirrorPlugins(){return[new qn({key:new ur("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),C4=Tn.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=ru(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new qn({key:new ur("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),Gj=class pd{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new pd(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new pd(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new pd(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,c=n.isInline,f=this.pos+r+(i?0:1);if(f<0||f>this.resolvedPos.doc.nodeSize-2)return;const p=this.resolvedPos.doc.resolve(f);if(!s&&!c&&p.depth<=this.depth)return;const g=new pd(p,this.editor,s,s||c?n:null);s&&(g.actualDepth=this.depth+1),e.push(g)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const i=s.node.attrs,c=Object.keys(n);for(let f=0;f<c.length;f+=1){const p=c[f];if(i[p]!==n[p])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(n);return this.children.forEach(c=>{r&&s.length>0||(c.node.type.name===e&&i.every(p=>n[p]===c.node.attrs[p])&&s.push(c),!(r&&s.length>0)&&(s=s.concat(c.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},Wj=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function qj(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var $j=class extends Ij{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:uj,createMappablePosition:dj},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:i})=>this.options.onDrop(r,s,i)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=$k(e,this.options.autofocus);this.editorState=jc.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=qj(Wj,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=Qk(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const i=typeof s=="string"?`${s}$`:s.key;n=n.filter(c=>!c.key.startsWith(i))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[g4,f4.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),h4,b4,y4,v4,m4,w4,p4,C4.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new a1(r,this)}createCommandManager(){this.commandManager=new t1({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=e2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=e2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),s=n?this.extensionManager.dispatchTransaction(r):r;this.editorView=new Vk(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();const c=this.view.dom;c.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(g=>{var C;return(C=this.capturedTransaction)==null?void 0:C.step(g)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const c=n.findLast(g=>g.getMeta("focus")||g.getMeta("blur")),f=c==null?void 0:c.getMeta("focus"),p=c==null?void 0:c.getMeta("blur");f&&this.emit("focus",{editor:this,event:f.event,transaction:c}),p&&this.emit("blur",{editor:this,event:p.event,transaction:c}),!(t.getMeta("preventUpdate")||!n.some(g=>g.docChanged)||i.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return s4(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return oj(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return vb(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return tj(this.state.doc,{blockSeparator:e,textSerializers:{...r4(this.schema),...n}})}get isEmpty(){return s1(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new Gj(e,this)}get $doc(){return this.$pos(0)}};function su(t){return new i1({find:t.find,handler:({state:e,range:n,match:r})=>{const s=Cn(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,c=r[r.length-1],f=r[0];if(c){const p=f.search(/\S/),g=n.from+f.indexOf(c),C=g+c.length;if(Cb(n.from,n.to,e.doc).filter(T=>T.mark.type.excluded.find(M=>M===t.type&&M!==T.mark.type)).filter(T=>T.to>g).length)return null;C<n.to&&i.delete(C,n.to),g>n.from&&i.delete(n.from+p,g);const A=n.from+p+c.length;i.addMark(n.from+p,A,t.type.create(s||{})),i.removeStoredMark(t.type)}},undoable:t.undoable})}function Xj(t){return new i1({find:t.find,handler:({state:e,range:n,match:r})=>{const s=Cn(t.getAttributes,void 0,r)||{},{tr:i}=e,c=n.from;let f=n.to;const p=t.type.create(s);if(r[1]){const g=r[0].lastIndexOf(r[1]);let C=c+g;C>f?C=f:f=C+r[1].length;const v=r[0][r[0].length-1];i.insertText(v,c+r[0].length-1),i.replaceWith(C,f,p)}else if(r[0]){const g=t.type.isInline?c:c-1;i.insert(g,t.type.create(s)).delete(i.mapping.map(c),i.mapping.map(f))}i.scrollIntoView()},undoable:t.undoable})}function n2(t){return new i1({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),i=Cn(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)},undoable:t.undoable})}function iu(t){return new i1({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=Cn(t.getAttributes,void 0,r)||{},c=e.tr.delete(n.from,n.to),p=c.doc.resolve(n.from).blockRange(),g=p&&Q2(p,t.type,i);if(!g)return null;if(c.wrap(p,g),t.keepMarks&&t.editor){const{selection:v,storedMarks:A}=e,{splittableMarks:T}=t.editor.extensionManager,_=A||v.$to.parentOffset&&v.$from.marks();if(_){const M=_.filter(R=>T.includes(R.type.name));c.ensureMarks(M)}}if(t.keepAttributes){const v=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(v,i).run()}const C=c.doc.resolve(n.from-1).nodeBefore;C&&C.type===t.type&&Uo(c.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,C))&&c.join(n.from-1)},undoable:t.undoable})}function Yj(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof vt){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}var Kj={};xb(Kj,{createAtomBlockMarkdownSpec:()=>Zj,createBlockMarkdownSpec:()=>Jj,createInlineMarkdownSpec:()=>tB,parseAttributes:()=>Sb,parseIndentedBlocks:()=>r2,renderNestedMarkdownContent:()=>Nb,serializeAttributes:()=>Ab});function Sb(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,g=>(n.push(g),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const g=s.map(C=>C.trim().slice(1));e.class=g.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(e.id=i[1]);const c=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(c)).forEach(([,g,C])=>{var v;const A=parseInt(((v=C.match(/__QUOTED_(\d+)__/))==null?void 0:v[1])||"0",10),T=n[A];T&&(e[g]=T.slice(1,-1))});const p=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return p&&p.split(/\s+/).filter(Boolean).forEach(C=>{C.match(/^[a-zA-Z][\w-]*$/)&&(e[C]=!0)}),e}function Ab(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function Zj(t){const{nodeName:e,name:n,parseAttributes:r=Sb,serializeAttributes:s=Ab,defaultAttributes:i={},requiredAttributes:c=[],allowedAttributes:f}=t,p=n||e,g=C=>{if(!f)return C;const v={};return f.forEach(A=>{A in C&&(v[A]=C[A])}),v};return{parseMarkdown:(C,v)=>{const A={...i,...C.attributes};return v.createNode(e,A,[])},markdownTokenizer:{name:e,level:"block",start(C){var v;const A=new RegExp(`^:::${p}(?:\\s|$)`,"m"),T=(v=C.match(A))==null?void 0:v.index;return T!==void 0?T:-1},tokenize(C,v,A){const T=new RegExp(`^:::${p}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),_=C.match(T);if(!_)return;const M=_[1]||"",R=r(M);if(!c.find(H=>!(H in R)))return{type:e,raw:_[0],attributes:R}}},renderMarkdown:C=>{const v=g(C.attrs||{}),A=s(v),T=A?` {${A}}`:"";return`:::${p}${T} :::`}}}function Jj(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Sb,serializeAttributes:i=Ab,defaultAttributes:c={},content:f="block",allowedAttributes:p}=t,g=n||e,C=v=>{if(!p)return v;const A={};return p.forEach(T=>{T in v&&(A[T]=v[T])}),A};return{parseMarkdown:(v,A)=>{let T;if(r){const M=r(v);T=typeof M=="string"?[{type:"text",text:M}]:M}else f==="block"?T=A.parseChildren(v.tokens||[]):T=A.parseInline(v.tokens||[]);const _={...c,...v.attributes};return A.createNode(e,_,T)},markdownTokenizer:{name:e,level:"block",start(v){var A;const T=new RegExp(`^:::${g}`,"m"),_=(A=v.match(T))==null?void 0:A.index;return _!==void 0?_:-1},tokenize(v,A,T){var _;const M=new RegExp(`^:::${g}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),R=v.match(M);if(!R)return;const[j,H=""]=R,G=s(H);let Z=1;const J=j.length;let oe="";const U=/^:::([\w-]*)(\s.*)?/gm,ee=v.slice(J);for(U.lastIndex=0;;){const X=U.exec(ee);if(X===null)break;const Qe=X.index,je=X[1];if(!((_=X[2])!=null&&_.endsWith(":::"))){if(je)Z+=1;else if(Z-=1,Z===0){const ue=ee.slice(0,Qe);oe=ue.trim();const Ie=v.slice(0,J+Qe+X[0].length);let Ze=[];if(oe)if(f==="block")for(Ze=T.blockTokens(ue),Ze.forEach(ne=>{ne.text&&(!ne.tokens||ne.tokens.length===0)&&(ne.tokens=T.inlineTokens(ne.text))});Ze.length>0;){const ne=Ze[Ze.length-1];if(ne.type==="paragraph"&&(!ne.text||ne.text.trim()===""))Ze.pop();else break}else Ze=T.inlineTokens(oe);return{type:e,raw:Ie,attributes:G,content:oe,tokens:Ze}}}}}},renderMarkdown:(v,A)=>{const T=C(v.attrs||{}),_=i(T),M=_?` {${_}}`:"",R=A.renderChildren(v.content||[],`

`);return`:::${g}${M}

${R}

:::`}}}function Qj(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,i,c]=r;e[s]=i||c,r=n.exec(t)}return e}function eB(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function tB(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Qj,serializeAttributes:i=eB,defaultAttributes:c={},selfClosing:f=!1,allowedAttributes:p}=t,g=n||e,C=A=>{if(!p)return A;const T={};return p.forEach(_=>{const M=typeof _=="string"?_:_.name,R=typeof _=="string"?void 0:_.skipIfDefault;if(M in A){const j=A[M];if(R!==void 0&&j===R)return;T[M]=j}}),T},v=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(A,T)=>{const _={...c,...A.attributes};if(f)return T.createNode(e,_);const M=r?r(A):A.content||"";return M?T.createNode(e,_,[T.createTextNode(M)]):T.createNode(e,_,[])},markdownTokenizer:{name:e,level:"inline",start(A){const T=f?new RegExp(`\\[${v}\\s*[^\\]]*\\]`):new RegExp(`\\[${v}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${v}\\]`),_=A.match(T),M=_==null?void 0:_.index;return M!==void 0?M:-1},tokenize(A,T,_){const M=f?new RegExp(`^\\[${v}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${v}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${v}\\]`),R=A.match(M);if(!R)return;let j="",H="";if(f){const[,Z]=R;H=Z}else{const[,Z,J]=R;H=Z,j=J||""}const G=s(H.trim());return{type:e,raw:R[0],content:j.trim(),attributes:G}}},renderMarkdown:A=>{let T="";r?T=r(A):A.content&&A.content.length>0&&(T=A.content.filter(j=>j.type==="text").map(j=>j.text).join(""));const _=C(A.attrs||{}),M=i(_),R=M?` ${M}`:"";return f?`[${g}${R}]`:`[${g}${R}]${T}[/${g}]`}}}function r2(t,e,n){var r,s,i,c;const f=t.split(`
`),p=[];let g="",C=0;const v=e.baseIndentSize||2;for(;C<f.length;){const A=f[C],T=A.match(e.itemPattern);if(!T){if(p.length>0)break;if(A.trim()===""){C+=1,g=`${g}${A}
`;continue}else return}const _=e.extractItemData(T),{indentLevel:M,mainContent:R}=_;g=`${g}${A}
`;const j=[R];for(C+=1;C<f.length;){const J=f[C];if(J.trim()===""){const U=f.slice(C+1).findIndex(Qe=>Qe.trim()!=="");if(U===-1)break;if((((s=(r=f[C+1+U].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>M){j.push(J),g=`${g}${J}
`,C+=1;continue}else break}if((((c=(i=J.match(/^(\s*)/))==null?void 0:i[1])==null?void 0:c.length)||0)>M)j.push(J),g=`${g}${J}
`,C+=1;else break}let H;const G=j.slice(1);if(G.length>0){const J=G.map(oe=>oe.slice(M+v)).join(`
`);J.trim()&&(e.customNestedParser?H=e.customNestedParser(J):H=n.blockTokens(J))}const Z=e.createToken(_,H);p.push(Z)}if(p.length!==0)return{items:p,raw:g}}function Nb(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[i,...c]=t.content,f=e.renderChildren([i]),p=[`${s}${f}`];return c&&c.length>0&&c.forEach(g=>{const C=e.renderChildren([g]);if(C){const v=C.split(`
`).map(A=>A?e.indent(A):"").join(`
`);p.push(v)}}),p.join(`
`)}function nB(t,e,n={}){const{state:r}=e,{doc:s,tr:i}=r,c=t;s.descendants((f,p)=>{const g=i.mapping.map(p),C=i.mapping.map(p)+f.nodeSize;let v=null;if(f.marks.forEach(T=>{if(T!==c)return!1;v=T}),!v)return;let A=!1;if(Object.keys(n).forEach(T=>{n[T]!==v.attrs[T]&&(A=!0)}),A){const T=t.type.create({...t.attrs,...n});i.removeMark(g,C,t.type),i.addMark(g,C,T)}}),i.docChanged&&e.view.dispatch(i)}var Kr=class E4 extends Eb{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new E4(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Ul(t){return new Pj({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const i=Cn(t.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:c}=e,f=r[r.length-1],p=r[0];let g=n.to;if(f){const C=p.search(/\S/),v=n.from+p.indexOf(f),A=v+f.length;if(Cb(n.from,n.to,e.doc).filter(_=>_.mark.type.excluded.find(R=>R===t.type&&R!==_.mark.type)).filter(_=>_.to>v).length)return null;A<n.to&&c.delete(A,n.to),v>n.from&&c.delete(n.from+C,v),g=n.from+C+f.length,c.addMark(n.from+C,g,t.type.create(i||{})),c.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:rB,getOwnPropertySymbols:sB}=Object,{hasOwnProperty:iB}=Object.prototype;function zg(t,e){return function(r,s,i){return t(r,s,i)&&e(r,s,i)}}function qh(t){return function(n,r,s){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,s);const{cache:i}=s,c=i.get(n),f=i.get(r);if(c&&f)return c===r&&f===n;i.set(n,r),i.set(r,n);const p=t(n,r,s);return i.delete(n),i.delete(r),p}}function aB(t){return t!=null?t[Symbol.toStringTag]:void 0}function iS(t){return rB(t).concat(sB(t))}const oB=Object.hasOwn||((t,e)=>iB.call(t,e));function ql(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const lB="__v",cB="__o",uB="_owner",{getOwnPropertyDescriptor:aS,keys:oS}=Object;function dB(t,e){return t.byteLength===e.byteLength&&$0(new Uint8Array(t),new Uint8Array(e))}function fB(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function hB(t,e){return t.byteLength===e.byteLength&&$0(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function pB(t,e){return ql(t.getTime(),e.getTime())}function mB(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function gB(t,e){return t===e}function lS(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),i=t.entries();let c,f,p=0;for(;(c=i.next())&&!c.done;){const g=e.entries();let C=!1,v=0;for(;(f=g.next())&&!f.done;){if(s[v]){v++;continue}const A=c.value,T=f.value;if(n.equals(A[0],T[0],p,v,t,e,n)&&n.equals(A[1],T[1],A[0],T[0],t,e,n)){C=s[v]=!0;break}v++}if(!C)return!1;p++}return!0}const xB=ql;function bB(t,e,n){const r=oS(t);let s=r.length;if(oS(e).length!==s)return!1;for(;s-- >0;)if(!S4(t,e,n,r[s]))return!1;return!0}function ld(t,e,n){const r=iS(t);let s=r.length;if(iS(e).length!==s)return!1;let i,c,f;for(;s-- >0;)if(i=r[s],!S4(t,e,n,i)||(c=aS(t,i),f=aS(e,i),(c||f)&&(!c||!f||c.configurable!==f.configurable||c.enumerable!==f.enumerable||c.writable!==f.writable)))return!1;return!0}function yB(t,e){return ql(t.valueOf(),e.valueOf())}function wB(t,e){return t.source===e.source&&t.flags===e.flags}function cS(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),i=t.values();let c,f;for(;(c=i.next())&&!c.done;){const p=e.values();let g=!1,C=0;for(;(f=p.next())&&!f.done;){if(!s[C]&&n.equals(c.value,f.value,c.value,f.value,t,e,n)){g=s[C]=!0;break}C++}if(!g)return!1}return!0}function $0(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function vB(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function S4(t,e,n,r){return(r===uB||r===cB||r===lB)&&(t.$$typeof||e.$$typeof)?!0:oB(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const CB="[object ArrayBuffer]",EB="[object Arguments]",SB="[object Boolean]",AB="[object DataView]",NB="[object Date]",kB="[object Error]",TB="[object Map]",OB="[object Number]",_B="[object Object]",RB="[object RegExp]",MB="[object Set]",IB="[object String]",DB={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},LB="[object URL]",jB=Object.prototype.toString;function BB({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:s,areFunctionsEqual:i,areMapsEqual:c,areNumbersEqual:f,areObjectsEqual:p,arePrimitiveWrappersEqual:g,areRegExpsEqual:C,areSetsEqual:v,areTypedArraysEqual:A,areUrlsEqual:T,unknownTagComparators:_}){return function(R,j,H){if(R===j)return!0;if(R==null||j==null)return!1;const G=typeof R;if(G!==typeof j)return!1;if(G!=="object")return G==="number"?f(R,j,H):G==="function"?i(R,j,H):!1;const Z=R.constructor;if(Z!==j.constructor)return!1;if(Z===Object)return p(R,j,H);if(Array.isArray(R))return e(R,j,H);if(Z===Date)return r(R,j,H);if(Z===RegExp)return C(R,j,H);if(Z===Map)return c(R,j,H);if(Z===Set)return v(R,j,H);const J=jB.call(R);if(J===NB)return r(R,j,H);if(J===RB)return C(R,j,H);if(J===TB)return c(R,j,H);if(J===MB)return v(R,j,H);if(J===_B)return typeof R.then!="function"&&typeof j.then!="function"&&p(R,j,H);if(J===LB)return T(R,j,H);if(J===kB)return s(R,j,H);if(J===EB)return p(R,j,H);if(DB[J])return A(R,j,H);if(J===CB)return t(R,j,H);if(J===AB)return n(R,j,H);if(J===SB||J===OB||J===IB)return g(R,j,H);if(_){let oe=_[J];if(!oe){const U=aB(R);U&&(oe=_[U])}if(oe)return oe(R,j,H)}return!1}}function PB({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:dB,areArraysEqual:n?ld:fB,areDataViewsEqual:hB,areDatesEqual:pB,areErrorsEqual:mB,areFunctionsEqual:gB,areMapsEqual:n?zg(lS,ld):lS,areNumbersEqual:xB,areObjectsEqual:n?ld:bB,arePrimitiveWrappersEqual:yB,areRegExpsEqual:wB,areSetsEqual:n?zg(cS,ld):cS,areTypedArraysEqual:n?zg($0,ld):$0,areUrlsEqual:vB,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const s=qh(r.areArraysEqual),i=qh(r.areMapsEqual),c=qh(r.areObjectsEqual),f=qh(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:s,areMapsEqual:i,areObjectsEqual:c,areSetsEqual:f})}return r}function FB(t){return function(e,n,r,s,i,c,f){return t(e,n,f)}}function zB({circular:t,comparator:e,createState:n,equals:r,strict:s}){if(n)return function(f,p){const{cache:g=t?new WeakMap:void 0,meta:C}=n();return e(f,p,{cache:g,equals:r,meta:C,strict:s})};if(t)return function(f,p){return e(f,p,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};const i={cache:void 0,equals:r,meta:void 0,strict:s};return function(f,p){return e(f,p,i)}}const UB=Go();Go({strict:!0});Go({circular:!0});Go({circular:!0,strict:!0});Go({createInternalComparator:()=>ql});Go({strict:!0,createInternalComparator:()=>ql});Go({circular:!0,createInternalComparator:()=>ql});Go({circular:!0,createInternalComparator:()=>ql,strict:!0});function Go(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:s=!1}=t,i=PB(t),c=BB(i),f=n?n(c):FB(c);return zB({circular:e,comparator:c,createState:r,equals:f,strict:s})}var Ug={exports:{}},Hg={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uS;function HB(){if(uS)return Hg;uS=1;var t=tf(),e=mN();function n(g,C){return g===C&&(g!==0||1/g===1/C)||g!==g&&C!==C}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,i=t.useRef,c=t.useEffect,f=t.useMemo,p=t.useDebugValue;return Hg.useSyncExternalStoreWithSelector=function(g,C,v,A,T){var _=i(null);if(_.current===null){var M={hasValue:!1,value:null};_.current=M}else M=_.current;_=f(function(){function j(oe){if(!H){if(H=!0,G=oe,oe=A(oe),T!==void 0&&M.hasValue){var U=M.value;if(T(U,oe))return Z=U}return Z=oe}if(U=Z,r(G,oe))return U;var ee=A(oe);return T!==void 0&&T(U,ee)?(G=oe,U):(G=oe,Z=ee)}var H=!1,G,Z,J=v===void 0?null:v;return[function(){return j(C())},J===null?void 0:function(){return j(J())}]},[C,v,A,T]);var R=s(g,_[0],_[1]);return c(function(){M.hasValue=!0,M.value=R},[R]),p(R),R},Hg}var dS;function VB(){return dS||(dS=1,Ug.exports=HB()),Ug.exports}var GB=VB(),WB=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},qB=({contentComponent:t})=>{const e=gN.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return b.jsx(b.Fragment,{children:Object.values(e)})};function $B(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:FO.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var XB=class extends It.Component{constructor(t){var e;super(t),this.editorContentRef=It.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=$B(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return b.jsxs(b.Fragment,{children:[b.jsx("div",{ref:WB(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&b.jsx(qB,{contentComponent:t.contentComponent})]})}},YB=L.forwardRef((t,e)=>{const n=It.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return It.createElement(XB,{key:n,innerRef:e,...t})}),A4=It.memo(YB),KB=typeof window<"u"?L.useLayoutEffect:L.useEffect,ZB=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function JB(t){var e;const[n]=L.useState(()=>new ZB(t.editor)),r=GB.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:UB);return KB(()=>n.watch(t.editor),[t.editor,n]),L.useDebugValue(r),r}var QB=!1,s2=typeof window>"u",eP=s2||!!(typeof window<"u"&&window.next),tP=class N4{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?s2||eP?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)==null?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)==null?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)==null?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)==null?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)==null?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)==null?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)==null?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)==null?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)==null?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)==null?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)==null?void 0:i.call(s,...r)},onDelete:(...r)=>{var s,i;return(i=(s=this.options.current).onDelete)==null?void 0:i.call(s,...r)}};return new $j(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,i)=>{var c;return s===((c=n.extensions)==null?void 0:c[i])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?N4.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function nP(t={},e=[]){const n=L.useRef(t);n.current=t;const[r]=L.useState(()=>new tP(n)),s=gN.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return L.useDebugValue(s),L.useEffect(r.onRender(e)),JB({editor:s,selector:({transactionNumber:i})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&i===0?0:i+1}),s}var k4=L.createContext({editor:null});k4.Consumer;var rP=L.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),sP=()=>L.useContext(rP);It.forwardRef((t,e)=>{const{onDragStart:n}=sP(),r=t.as||"div";return b.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});It.createContext({markViewContentRef:()=>{}});var kb=L.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});kb.displayName="TiptapContext";var iP=()=>L.useContext(kb);function T4({editor:t,instance:e,children:n}){const r=t??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const s=L.useMemo(()=>({editor:r}),[r]),i=L.useMemo(()=>({editor:r}),[r]);return b.jsx(k4.Provider,{value:i,children:b.jsx(kb.Provider,{value:s,children:n})})}T4.displayName="Tiptap";function O4({...t}){const{editor:e}=iP();return b.jsx(A4,{editor:e,...t})}O4.displayName="Tiptap.Content";Object.assign(T4,{Content:O4});var X0=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},aP=/^\s*>\s$/,oP=Kr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return X0("blockquote",{...Wn(this.options.HTMLAttributes,t),children:X0("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(s=>{const f=e.renderChildren([s]).split(`
`).map(p=>p.trim()===""?n:`${n} ${p}`);r.push(f.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[iu({find:aP,type:this.type})]}}),lP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,cP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,uP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,dP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,fP=Vo.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return X0("strong",{...Wn(this.options.HTMLAttributes,t),children:X0("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[su({find:lP,type:this.type}),su({find:uP,type:this.type})]},addPasteRules(){return[Ul({find:cP,type:this.type}),Ul({find:dP,type:this.type})]}}),hP=/(^|[^`])`([^`]+)`(?!`)$/,pP=/(^|[^`])`([^`]+)`(?!`)/g,mP=Vo.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Wn(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[su({find:hP,type:this.type})]},addPasteRules(){return[Ul({find:pP,type:this.type})]}}),Vg=4,gP=/^```([a-z]+)?[\s\n]$/,xP=/^~~~([a-z]+)?[\s\n]$/,bP=Kr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Vg,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const i=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(c=>c.startsWith(n)).map(c=>c.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Wn(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Vg,{state:r}=t,{selection:s}=r,{$from:i,empty:c}=s;if(i.parent.type!==this.type)return!1;const f=" ".repeat(n);return c?t.commands.insertContent(f):t.commands.command(({tr:p})=>{const{from:g,to:C}=s,T=r.doc.textBetween(g,C,`
`,`
`).split(`
`).map(_=>f+_).join(`
`);return p.replaceWith(g,C,r.schema.text(T)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Vg,{state:r}=t,{selection:s}=r,{$from:i,empty:c}=s;return i.parent.type!==this.type?!1:c?t.commands.command(({tr:f})=>{var p;const{pos:g}=i,C=i.start(),v=i.end(),T=r.doc.textBetween(C,v,`
`,`
`).split(`
`);let _=0,M=0;const R=g-C;for(let oe=0;oe<T.length;oe+=1){if(M+T[oe].length>=R){_=oe;break}M+=T[oe].length+1}const H=((p=T[_].match(/^ */))==null?void 0:p[0])||"",G=Math.min(H.length,n);if(G===0)return!0;let Z=C;for(let oe=0;oe<_;oe+=1)Z+=T[oe].length+1;return f.delete(Z,Z+G),g-Z<=G&&f.setSelection(Ct.create(f.doc,Z)),!0}):t.commands.command(({tr:f})=>{const{from:p,to:g}=s,A=r.doc.textBetween(p,g,`
`,`
`).split(`
`).map(T=>{var _;const M=((_=T.match(/^ */))==null?void 0:_[0])||"",R=Math.min(M.length,n);return T.slice(R)}).join(`
`);return f.replaceWith(p,g,r.schema.text(A)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,c=r.parent.textContent.endsWith(`

`);return!i||!c?!1:t.chain().command(({tr:f})=>(f.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const f=s.after();return f===void 0?!1:r.nodeAt(f)?t.commands.command(({tr:g})=>(g.setSelection(Ot.near(r.resolve(f))),!0)):t.commands.exitCode()}}},addInputRules(){return[n2({find:gP,type:this.type,getAttributes:t=>({language:t[1]})}),n2({find:xP,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new qn({key:new ur("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!n||!i)return!1;const{tr:c,schema:f}=t.state,p=f.text(n.replace(/\r\n?/g,`
`));return c.replaceSelectionWith(this.type.create({language:i},p)),c.selection.$from.parent.type!==this.type&&c.setSelection(Ct.near(c.doc.resolve(Math.max(0,c.selection.from-2)))),c.setMeta("paste",!0),t.dispatch(c),!0}}})]}}),yP=Kr.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),wP=Kr.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Wn(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:i}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:c}=this.options,{splittableMarks:f}=r.extensionManager,p=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:g,dispatch:C})=>{if(C&&p&&c){const v=p.filter(A=>f.includes(A.type.name));g.ensureMarks(v)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),vP=Kr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Wn(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>n2({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),CP=Kr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Wn(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Yj(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return a4(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:i,tr:c,dispatch:f})=>{if(f){const{$to:p}=c.selection,g=p.end();if(p.nodeAfter)p.nodeAfter.isTextblock?c.setSelection(Ct.create(c.doc,p.pos+1)):p.nodeAfter.isBlock?c.setSelection(vt.create(c.doc,p.pos)):c.setSelection(Ct.create(c.doc,p.pos));else{const C=i.schema.nodes[this.options.nextNodeType]||p.parent.type.contentMatch.defaultType,v=C==null?void 0:C.create();v&&(c.insert(g,v),c.setSelection(Ct.create(c.doc,g+1)))}c.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Xj({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),EP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,SP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,AP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,NP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,kP=Vo.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Wn(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[su({find:EP,type:this.type}),su({find:AP,type:this.type})]},addPasteRules(){return[Ul({find:SP,type:this.type}),Ul({find:NP,type:this.type})]}});const TP="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",OP="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",i2="numeric",a2="ascii",o2="alpha",Nd="asciinumeric",md="alphanumeric",l2="domain",_4="emoji",_P="scheme",RP="slashscheme",Gg="whitespace";function MP(t,e){return t in e||(e[t]=[]),e[t]}function Nl(t,e,n){e[i2]&&(e[Nd]=!0,e[md]=!0),e[a2]&&(e[Nd]=!0,e[o2]=!0),e[Nd]&&(e[md]=!0),e[o2]&&(e[md]=!0),e[md]&&(e[l2]=!0),e[_4]&&(e[l2]=!0);for(const r in e){const s=MP(r,n);s.indexOf(t)<0&&s.push(t)}}function IP(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function Ts(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Ts.groups={};Ts.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(t))return i}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||Ts.groups;let s;return e&&e.j?s=e:(s=new Ts(e),n&&r&&Nl(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const i=t.length;if(!i)return s;for(let c=0;c<i-1;c++)s=s.tt(t[c]);return s.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||Ts.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const i=e;let c,f=s.go(t);if(f?(c=new Ts,Object.assign(c.j,f.j),c.jr.push.apply(c.jr,f.jr),c.jd=f.jd,c.t=f.t):c=new Ts,i){if(r)if(c.t&&typeof c.t=="string"){const p=Object.assign(IP(c.t,r),n);Nl(i,p,r)}else n&&Nl(i,n,r);c.t=i}return s.j[t]=c,c}};const Vt=(t,e,n,r,s)=>t.ta(e,n,r,s),ar=(t,e,n,r,s)=>t.tr(e,n,r,s),fS=(t,e,n,r,s)=>t.ts(e,n,r,s),Ke=(t,e,n,r,s)=>t.tt(e,n,r,s),ba="WORD",c2="UWORD",R4="ASCIINUMERICAL",M4="ALPHANUMERICAL",Yd="LOCALHOST",u2="TLD",d2="UTLD",d0="SCHEME",Ic="SLASH_SCHEME",Tb="NUM",f2="WS",Ob="NL",kd="OPENBRACE",Td="CLOSEBRACE",Y0="OPENBRACKET",K0="CLOSEBRACKET",Z0="OPENPAREN",J0="CLOSEPAREN",Q0="OPENANGLEBRACKET",ep="CLOSEANGLEBRACKET",tp="FULLWIDTHLEFTPAREN",np="FULLWIDTHRIGHTPAREN",rp="LEFTCORNERBRACKET",sp="RIGHTCORNERBRACKET",ip="LEFTWHITECORNERBRACKET",ap="RIGHTWHITECORNERBRACKET",op="FULLWIDTHLESSTHAN",lp="FULLWIDTHGREATERTHAN",cp="AMPERSAND",up="APOSTROPHE",dp="ASTERISK",wo="AT",fp="BACKSLASH",hp="BACKTICK",pp="CARET",Eo="COLON",_b="COMMA",mp="DOLLAR",ji="DOT",gp="EQUALS",Rb="EXCLAMATION",ti="HYPHEN",Od="PERCENT",xp="PIPE",bp="PLUS",yp="POUND",_d="QUERY",Mb="QUOTE",I4="FULLWIDTHMIDDLEDOT",Ib="SEMI",Bi="SLASH",Rd="TILDE",wp="UNDERSCORE",D4="EMOJI",vp="SYM";var L4=Object.freeze({__proto__:null,ALPHANUMERICAL:M4,AMPERSAND:cp,APOSTROPHE:up,ASCIINUMERICAL:R4,ASTERISK:dp,AT:wo,BACKSLASH:fp,BACKTICK:hp,CARET:pp,CLOSEANGLEBRACKET:ep,CLOSEBRACE:Td,CLOSEBRACKET:K0,CLOSEPAREN:J0,COLON:Eo,COMMA:_b,DOLLAR:mp,DOT:ji,EMOJI:D4,EQUALS:gp,EXCLAMATION:Rb,FULLWIDTHGREATERTHAN:lp,FULLWIDTHLEFTPAREN:tp,FULLWIDTHLESSTHAN:op,FULLWIDTHMIDDLEDOT:I4,FULLWIDTHRIGHTPAREN:np,HYPHEN:ti,LEFTCORNERBRACKET:rp,LEFTWHITECORNERBRACKET:ip,LOCALHOST:Yd,NL:Ob,NUM:Tb,OPENANGLEBRACKET:Q0,OPENBRACE:kd,OPENBRACKET:Y0,OPENPAREN:Z0,PERCENT:Od,PIPE:xp,PLUS:bp,POUND:yp,QUERY:_d,QUOTE:Mb,RIGHTCORNERBRACKET:sp,RIGHTWHITECORNERBRACKET:ap,SCHEME:d0,SEMI:Ib,SLASH:Bi,SLASH_SCHEME:Ic,SYM:vp,TILDE:Rd,TLD:u2,UNDERSCORE:wp,UTLD:d2,UWORD:c2,WORD:ba,WS:f2});const ga=/[a-z]/,cd=new RegExp("\\p{L}","u"),Wg=new RegExp("\\p{Emoji}","u"),xa=/\d/,qg=/\s/,hS="\r",$g=`
`,DP="",LP="",Xg="";let $h=null,Xh=null;function jP(t=[]){const e={};Ts.groups=e;const n=new Ts;$h==null&&($h=pS(TP)),Xh==null&&(Xh=pS(OP)),Ke(n,"'",up),Ke(n,"{",kd),Ke(n,"}",Td),Ke(n,"[",Y0),Ke(n,"]",K0),Ke(n,"(",Z0),Ke(n,")",J0),Ke(n,"<",Q0),Ke(n,">",ep),Ke(n,"",tp),Ke(n,"",np),Ke(n,"",rp),Ke(n,"",sp),Ke(n,"",ip),Ke(n,"",ap),Ke(n,"",op),Ke(n,"",lp),Ke(n,"&",cp),Ke(n,"*",dp),Ke(n,"@",wo),Ke(n,"`",hp),Ke(n,"^",pp),Ke(n,":",Eo),Ke(n,",",_b),Ke(n,"$",mp),Ke(n,".",ji),Ke(n,"=",gp),Ke(n,"!",Rb),Ke(n,"-",ti),Ke(n,"%",Od),Ke(n,"|",xp),Ke(n,"+",bp),Ke(n,"#",yp),Ke(n,"?",_d),Ke(n,'"',Mb),Ke(n,"/",Bi),Ke(n,";",Ib),Ke(n,"~",Rd),Ke(n,"_",wp),Ke(n,"\\",fp),Ke(n,"",I4);const r=ar(n,xa,Tb,{[i2]:!0});ar(r,xa,r);const s=ar(r,ga,R4,{[Nd]:!0}),i=ar(r,cd,M4,{[md]:!0}),c=ar(n,ga,ba,{[a2]:!0});ar(c,xa,s),ar(c,ga,c),ar(s,xa,s),ar(s,ga,s);const f=ar(n,cd,c2,{[o2]:!0});ar(f,ga),ar(f,xa,i),ar(f,cd,f),ar(i,xa,i),ar(i,ga),ar(i,cd,i);const p=Ke(n,$g,Ob,{[Gg]:!0}),g=Ke(n,hS,f2,{[Gg]:!0}),C=ar(n,qg,f2,{[Gg]:!0});Ke(n,Xg,C),Ke(g,$g,p),Ke(g,Xg,C),ar(g,qg,C),Ke(C,hS),Ke(C,$g),ar(C,qg,C),Ke(C,Xg,C);const v=ar(n,Wg,D4,{[_4]:!0});Ke(v,"#"),ar(v,Wg,v),Ke(v,DP,v);const A=Ke(v,LP);Ke(A,"#"),ar(A,Wg,v);const T=[[ga,c],[xa,s]],_=[[ga,null],[cd,f],[xa,i]];for(let M=0;M<$h.length;M++)mo(n,$h[M],u2,ba,T);for(let M=0;M<Xh.length;M++)mo(n,Xh[M],d2,c2,_);Nl(u2,{tld:!0,ascii:!0},e),Nl(d2,{utld:!0,alpha:!0},e),mo(n,"file",d0,ba,T),mo(n,"mailto",d0,ba,T),mo(n,"http",Ic,ba,T),mo(n,"https",Ic,ba,T),mo(n,"ftp",Ic,ba,T),mo(n,"ftps",Ic,ba,T),Nl(d0,{scheme:!0,ascii:!0},e),Nl(Ic,{slashscheme:!0,ascii:!0},e),t=t.sort((M,R)=>M[0]>R[0]?1:-1);for(let M=0;M<t.length;M++){const R=t[M][0],H=t[M][1]?{[_P]:!0}:{[RP]:!0};R.indexOf("-")>=0?H[l2]=!0:ga.test(R)?xa.test(R)?H[Nd]=!0:H[a2]=!0:H[i2]=!0,fS(n,R,R,H)}return fS(n,"localhost",Yd,{ascii:!0}),n.jd=new Ts(vp),{start:n,tokens:Object.assign({groups:e},L4)}}function j4(t,e){const n=BP(e.replace(/[A-Z]/g,f=>f.toLowerCase())),r=n.length,s=[];let i=0,c=0;for(;c<r;){let f=t,p=null,g=0,C=null,v=-1,A=-1;for(;c<r&&(p=f.go(n[c]));)f=p,f.accepts()?(v=0,A=0,C=f):v>=0&&(v+=n[c].length,A++),g+=n[c].length,i+=n[c].length,c++;i-=v,c-=A,g-=v,s.push({t:C.t,v:e.slice(i-g,i),s:i-g,e:i})}return s}function BP(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),i,c=s<55296||s>56319||r+1===n||(i=t.charCodeAt(r+1))<56320||i>57343?t[r]:t.slice(r,r+2);e.push(c),r+=c.length}return e}function mo(t,e,n,r,s){let i;const c=e.length;for(let f=0;f<c-1;f++){const p=e[f];t.j[p]?i=t.j[p]:(i=new Ts(r),i.jr=s.slice(),t.j[p]=i),t=i}return i=new Ts(n),i.jr=s.slice(),t.j[e[c-1]]=i,i}function pS(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let i=0;for(;s.indexOf(t[r+i])>=0;)i++;if(i>0){e.push(n.join(""));for(let c=parseInt(t.substring(r,r+i),10);c>0;c--)n.pop();r+=i}else n.push(t[r]),r++}return e}const Kd={defaultProtocol:"http",events:null,format:mS,formatHref:mS,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Db(t,e=null){let n=Object.assign({},Kd);t&&(n=Object.assign(n,t instanceof Db?t.o:t));const r=n.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}Db.prototype={o:Kd,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:Kd[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function mS(t){return t}function B4(t,e){this.t="token",this.v=t,this.tk=e}B4.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Kd.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),i=this.toFormattedString(t),c={},f=t.get("className",n,e),p=t.get("target",n,e),g=t.get("rel",n,e),C=t.getObj("attributes",n,e),v=t.getObj("events",n,e);return c.href=r,f&&(c.class=f),p&&(c.target=p),g&&(c.rel=g),C&&Object.assign(c,C),{tagName:s,attributes:c,content:i,eventListeners:v}}};function o1(t,e){class n extends B4{constructor(s,i){super(s,i),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const gS=o1("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),xS=o1("text"),PP=o1("nl"),Yh=o1("url",{isLink:!0,toHref(t=Kd.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Yd&&t[1].t===Eo}}),ei=t=>new Ts(t);function FP({groups:t}){const e=t.domain.concat([cp,dp,wo,fp,hp,pp,mp,gp,ti,Tb,Od,xp,bp,yp,Bi,vp,Rd,wp]),n=[up,Eo,_b,ji,Rb,Od,_d,Mb,Ib,Q0,ep,kd,Td,K0,Y0,Z0,J0,tp,np,rp,sp,ip,ap,op,lp],r=[cp,up,dp,fp,hp,pp,mp,gp,ti,kd,Td,Od,xp,bp,yp,_d,Bi,vp,Rd,wp],s=ei(),i=Ke(s,Rd);Vt(i,r,i),Vt(i,t.domain,i);const c=ei(),f=ei(),p=ei();Vt(s,t.domain,c),Vt(s,t.scheme,f),Vt(s,t.slashscheme,p),Vt(c,r,i),Vt(c,t.domain,c);const g=Ke(c,wo);Ke(i,wo,g),Ke(f,wo,g),Ke(p,wo,g);const C=Ke(i,ji);Vt(C,r,i),Vt(C,t.domain,i);const v=ei();Vt(g,t.domain,v),Vt(v,t.domain,v);const A=Ke(v,ji);Vt(A,t.domain,v);const T=ei(gS);Vt(A,t.tld,T),Vt(A,t.utld,T),Ke(g,Yd,T);const _=Ke(v,ti);Ke(_,ti,_),Vt(_,t.domain,v),Vt(T,t.domain,v),Ke(T,ji,A),Ke(T,ti,_);const M=Ke(T,Eo);Vt(M,t.numeric,gS);const R=Ke(c,ti),j=Ke(c,ji);Ke(R,ti,R),Vt(R,t.domain,c),Vt(j,r,i),Vt(j,t.domain,c);const H=ei(Yh);Vt(j,t.tld,H),Vt(j,t.utld,H),Vt(H,t.domain,c),Vt(H,r,i),Ke(H,ji,j),Ke(H,ti,R),Ke(H,wo,g);const G=Ke(H,Eo),Z=ei(Yh);Vt(G,t.numeric,Z);const J=ei(Yh),oe=ei();Vt(J,e,J),Vt(J,n,oe),Vt(oe,e,J),Vt(oe,n,oe),Ke(H,Bi,J),Ke(Z,Bi,J);const U=Ke(f,Eo),ee=Ke(p,Eo),X=Ke(ee,Bi),Qe=Ke(X,Bi);Vt(f,t.domain,c),Ke(f,ji,j),Ke(f,ti,R),Vt(p,t.domain,c),Ke(p,ji,j),Ke(p,ti,R),Vt(U,t.domain,J),Ke(U,Bi,J),Ke(U,_d,J),Vt(Qe,t.domain,J),Vt(Qe,e,J),Ke(Qe,Bi,J);const je=[[kd,Td],[Y0,K0],[Z0,J0],[Q0,ep],[tp,np],[rp,sp],[ip,ap],[op,lp]];for(let ue=0;ue<je.length;ue++){const[Ie,Ze]=je[ue],ne=Ke(J,Ie);Ke(oe,Ie,ne),Ke(ne,Ze,J);const ie=ei(Yh);Vt(ne,e,ie);const pe=ei();Vt(ne,n),Vt(ie,e,ie),Vt(ie,n,pe),Vt(pe,e,ie),Vt(pe,n,pe),Ke(ie,Ze,J),Ke(pe,Ze,J)}return Ke(s,Yd,H),Ke(s,Ob,PP),{start:s,tokens:L4}}function zP(t,e,n){let r=n.length,s=0,i=[],c=[];for(;s<r;){let f=t,p=null,g=null,C=0,v=null,A=-1;for(;s<r&&!(p=f.go(n[s].t));)c.push(n[s++]);for(;s<r&&(g=p||f.go(n[s].t));)p=null,f=g,f.accepts()?(A=0,v=f):A>=0&&A++,s++,C++;if(A<0)s-=C,s<r&&(c.push(n[s]),s++);else{c.length>0&&(i.push(Yg(xS,e,c)),c=[]),s-=A,C-=A;const T=v.t,_=n.slice(s-C,s);i.push(Yg(T,e,_))}}return c.length>0&&i.push(Yg(xS,e,c)),i}function Yg(t,e,n){const r=n[0].s,s=n[n.length-1].e,i=e.slice(r,s);return new t(i,n)}const UP=typeof console<"u"&&console&&console.warn||(()=>{}),HP="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Gn={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function VP(){return Ts.groups={},Gn.scanner=null,Gn.parser=null,Gn.tokenQueue=[],Gn.pluginQueue=[],Gn.customSchemes=[],Gn.initialized=!1,Gn}function bS(t,e=!1){if(Gn.initialized&&UP(`linkifyjs: already initialized - will not register custom scheme "${t}" ${HP}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Gn.customSchemes.push([t,e])}function GP(){Gn.scanner=jP(Gn.customSchemes);for(let t=0;t<Gn.tokenQueue.length;t++)Gn.tokenQueue[t][1]({scanner:Gn.scanner});Gn.parser=FP(Gn.scanner.tokens);for(let t=0;t<Gn.pluginQueue.length;t++)Gn.pluginQueue[t][1]({scanner:Gn.scanner,parser:Gn.parser});return Gn.initialized=!0,Gn}function Lb(t){return Gn.initialized||GP(),zP(Gn.parser.start,t,j4(Gn.scanner.start,t))}Lb.scan=j4;function P4(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Db(n),s=Lb(t),i=[];for(let c=0;c<s.length;c++){const f=s[c];f.isLink&&(!e||f.t===e)&&r.check(f)&&i.push(f.toFormattedObject(r))}return i}var jb="[\0- -\u2029]",WP=new RegExp(jb),qP=new RegExp(`${jb}$`),$P=new RegExp(jb,"g");function XP(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function YP(t){return new qn({key:new ur("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(g=>g.docChanged)&&!n.doc.eq(r.doc),i=e.some(g=>g.getMeta("preventAutolink"));if(!s||i)return;const{tr:c}=r,f=Zk(n.doc,[...e]);if(i4(f).forEach(({newRange:g})=>{const C=K9(r.doc,g,T=>T.isTextblock);let v,A;if(C.length>1)v=C[0],A=r.doc.textBetween(v.pos,v.pos+v.node.nodeSize,void 0," ");else if(C.length){const T=r.doc.textBetween(g.from,g.to," "," ");if(!qP.test(T))return;v=C[0],A=r.doc.textBetween(v.pos,g.to,void 0," ")}if(v&&A){const T=A.split(WP).filter(Boolean);if(T.length<=0)return!1;const _=T[T.length-1],M=v.pos+A.lastIndexOf(_);if(!_)return!1;const R=Lb(_).map(j=>j.toObject(t.defaultProtocol));if(!XP(R))return!1;R.filter(j=>j.isLink).map(j=>({...j,from:M+j.start+1,to:M+j.end+1})).filter(j=>r.schema.marks.code?!r.doc.rangeHasMark(j.from,j.to,r.schema.marks.code):!0).filter(j=>t.validate(j.value)).filter(j=>t.shouldAutoLink(j.value)).forEach(j=>{Cb(j.from,j.to,r.doc).some(H=>H.mark.type===t.type)||c.addMark(j.from,j.to,t.type.create({href:j.href}))})}}),!!c.steps.length)return c}})}function KP(t){return new qn({key:new ur("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let c=null;if(r.target instanceof HTMLAnchorElement)c=r.target;else{const p=r.target;if(!p)return!1;const g=t.editor.view.dom;c=p.closest("a"),c&&!g.contains(c)&&(c=null)}if(!c)return!1;let f=!1;if(t.enableClickSelection&&(f=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const p=s4(e.state,t.type.name),g=(s=c.href)!=null?s:p.href,C=(i=c.target)!=null?i:p.target;g&&(window.open(g,C),f=!0)}return f}}})}function ZP(t){return new qn({key:new ur("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:i}=e,{selection:c}=i,{empty:f}=c;if(f)return!1;let p="";r.content.forEach(C=>{p+=C.textContent});const g=P4(p,{defaultProtocol:t.defaultProtocol}).find(C=>C.isLink&&C.value===p);return!p||!g||s!==void 0&&!s(g.value)?!1:t.editor.commands.setMark(t.type,{href:g.href})}}})}function bl(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace($P,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var JP=Vo.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){bS(t);return}bS(t.scheme,t.optionalSlashes)})},onDestroy(){VP()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!bl(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const s=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!bl(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!bl(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Wn(this.options.HTMLAttributes,t),0]:["a",Wn(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n,r,s,i;const c=(r=(n=t.attrs)==null?void 0:n.href)!=null?r:"",f=(i=(s=t.attrs)==null?void 0:s.title)!=null?i:"",p=e.renderChildren(t);return f?`[${p}](${c} "${f}")`:`[${p}](${c})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!bl(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!bl(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Ul({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=P4(t).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:c=>!!bl(c,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(i=>{this.options.shouldAutoLink(i.value)&&e.push({text:i.value,data:{href:i.href},index:i.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(YP({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!bl(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(KP({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(ZP({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),QP=Object.defineProperty,eF=(t,e)=>{for(var n in e)QP(t,n,{get:e[n],enumerable:!0})},tF="listItem",yS="textStyle",wS=/^\s*([-+*])\s$/,F4=Kr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Wn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(tF,this.editor.getAttributes(yS)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=iu({find:wS,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=iu({find:wS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(yS),editor:this.editor})),[t]}}),z4=Kr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Wn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const c=t.tokens.slice(1),f=e.parseChildren(c);n.push(...f)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Nb(t,e,r=>{var s,i;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((i=(s=r.meta)==null?void 0:s.parentAttrs)==null?void 0:i.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),nF={};eF(nF,{findListItemPos:()=>hf,getNextListDepth:()=>Bb,handleBackspace:()=>h2,handleDelete:()=>p2,hasListBefore:()=>U4,hasListItemAfter:()=>rF,hasListItemBefore:()=>H4,listItemHasSubList:()=>V4,nextListIsDeeper:()=>G4,nextListIsHigher:()=>W4});var hf=(t,e)=>{const{$from:n}=e.selection,r=Cr(t,e.schema);let s=null,i=n.depth,c=n.pos,f=null;for(;i>0&&f===null;)s=n.node(i),s.type===r?f=i:(i-=1,c-=1);return f===null?null:{$pos:e.doc.resolve(c),depth:f}},Bb=(t,e)=>{const n=hf(t,e);if(!n)return!1;const[,r]=ij(e,t,n.$pos.pos+4);return r},U4=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),i=t.doc.resolve(s).node();return!(!i||!n.includes(i.type.name))},H4=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},V4=(t,e,n)=>{if(!n)return!1;const r=Cr(t,e.schema);let s=!1;return n.descendants(i=>{i.type===r&&(s=!0)}),s},h2=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Fo(t.state,e)&&U4(t.state,e,n)){const{$anchor:f}=t.state.selection,p=t.state.doc.resolve(f.before()-1),g=[];p.node().descendants((A,T)=>{A.type.name===e&&g.push({node:A,pos:T})});const C=g.at(-1);if(!C)return!1;const v=t.state.doc.resolve(p.start()+C.pos+1);return t.chain().cut({from:f.start()-1,to:f.end()+1},v.end()).joinForward().run()}if(!Fo(t.state,e)||!cj(t.state))return!1;const r=hf(e,t.state);if(!r)return!1;const i=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),c=V4(e,t.state,i);return H4(e,t.state)&&!c?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},G4=(t,e)=>{const n=Bb(t,e),r=hf(t,e);return!r||!n?!1:n>r.depth},W4=(t,e)=>{const n=Bb(t,e),r=hf(t,e);return!r||!n?!1:n<r.depth},p2=(t,e)=>{if(!Fo(t.state,e)||!lj(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:G4(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():W4(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},rF=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},q4=Tn.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&p2(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&p2(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&h2(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&h2(t,n,r)&&(e=!0)}),e}}}}),vS=/^(\s*)(\d+)\.\s+(.*)$/,sF=/^\s/;function iF(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],i=s.match(vS);if(!i)break;const[,c,f,p]=i,g=c.length;let C=p,v=n+1;const A=[s];for(;v<t.length;){const T=t[v];if(T.match(vS))break;if(T.trim()==="")A.push(T),C+=`
`,v+=1;else if(T.match(sF))A.push(T),C+=`
${T.slice(g+2)}`,v+=1;else break}e.push({indent:g,number:parseInt(f,10),content:C.trim(),raw:A.join(`
`)}),r=v,n=v}return[e,r]}function $4(t,e,n){var r;const s=[];let i=0;for(;i<t.length;){const c=t[i];if(c.indent===e){const f=c.content.split(`
`),p=((r=f[0])==null?void 0:r.trim())||"",g=[];p&&g.push({type:"paragraph",raw:p,tokens:n.inlineTokens(p)});const C=f.slice(1).join(`
`).trim();if(C){const T=n.blockTokens(C);g.push(...T)}let v=i+1;const A=[];for(;v<t.length&&t[v].indent>e;)A.push(t[v]),v+=1;if(A.length>0){const T=Math.min(...A.map(M=>M.indent)),_=$4(A,T,n);g.push({type:"list",ordered:!0,start:A[0].number,items:_,raw:A.map(M=>M.raw).join(`
`)})}s.push({type:"list_item",raw:c.raw,tokens:g}),i=v}else i+=1}return s}function aF(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const i=e.parseChildren([s]);r.push({type:"paragraph",content:i})}else{const i=e.parseChildren([s]);i.length>0&&r.push(...i)}}),{type:"listItem",content:r}})}var oF="listItem",CS="textStyle",ES=/^(\d+)\.\s$/,X4=Kr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Wn(this.options.HTMLAttributes,n),0]:["ol",Wn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?aF(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[i,c]=iF(s);if(i.length===0)return;const f=$4(i,0,n);return f.length===0?void 0:{type:"list",ordered:!0,start:((r=i[0])==null?void 0:r.number)||1,items:f,raw:s.slice(0,c).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(oF,this.editor.getAttributes(CS)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=iu({find:ES,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=iu({find:ES,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(CS)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),lF=/^\s*(\[([( |x])?\])\s$/,Y4=Kr.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Wn(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Nb(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),c=document.createElement("span"),f=document.createElement("input"),p=document.createElement("div"),g=v=>{var A,T;f.ariaLabel=((T=(A=this.options.a11y)==null?void 0:A.checkboxLabel)==null?void 0:T.call(A,v,f.checked))||`Task item checkbox for ${v.textContent||"empty task item"}`};g(t),i.contentEditable="false",f.type="checkbox",f.addEventListener("mousedown",v=>v.preventDefault()),f.addEventListener("change",v=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){f.checked=!f.checked;return}const{checked:A}=v.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:T})=>{const _=n();if(typeof _!="number")return!1;const M=T.doc.nodeAt(_);return T.setNodeMarkup(_,void 0,{...M==null?void 0:M.attrs,checked:A}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,A)||(f.checked=!f.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([v,A])=>{s.setAttribute(v,A)}),s.dataset.checked=t.attrs.checked,f.checked=t.attrs.checked,i.append(f,c),s.append(i,p),Object.entries(e).forEach(([v,A])=>{s.setAttribute(v,A)});let C=new Set(Object.keys(e));return{dom:s,contentDOM:p,update:v=>{if(v.type!==this.type)return!1;s.dataset.checked=v.attrs.checked,f.checked=v.attrs.checked,g(v);const A=r.extensionManager.attributes,T=Xd(v,A),_=new Set(Object.keys(T)),M=this.options.HTMLAttributes;return C.forEach(R=>{_.has(R)||(R in M?s.setAttribute(R,M[R]):s.removeAttribute(R))}),Object.entries(T).forEach(([R,j])=>{j==null?R in M?s.setAttribute(R,M[R]):s.removeAttribute(R):s.setAttribute(R,j)}),C=_,!0}}}},addInputRules(){return[iu({find:lF,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),K4=Kr.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Wn(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=i=>{const c=r2(i,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:f=>({indentLevel:f[1].length,mainContent:f[4],checked:f[3].toLowerCase()==="x"}),createToken:(f,p)=>({type:"taskItem",raw:"",mainContent:f.mainContent,indentLevel:f.indentLevel,checked:f.checked,text:f.mainContent,tokens:n.inlineTokens(f.mainContent),nestedTokens:p}),customNestedParser:r},n);return c?[{type:"taskList",raw:c.raw,items:c.items}]:n.blockTokens(i)},s=r2(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:i=>({indentLevel:i[1].length,mainContent:i[4],checked:i[3].toLowerCase()==="x"}),createToken:(i,c)=>({type:"taskItem",raw:"",mainContent:i.mainContent,indentLevel:i.indentLevel,checked:i.checked,text:i.mainContent,tokens:n.inlineTokens(i.mainContent),nestedTokens:c}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Tn.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(F4.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(z4.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(q4.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(X4.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(Y4.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(K4.configure(this.options.taskList)),t}});var SS="&nbsp;",cF="",uF=Kr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Wn(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];if(n.length===1&&n[0].type==="image")return e.parseChildren([n[0]]);const r=e.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===SS||r[0].text===cF)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(t,e)=>{if(!t)return"";const n=Array.isArray(t.content)?t.content:[];return n.length===0?SS:e.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),dF=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,fF=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hF=Vo.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Wn(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[su({find:dF,type:this.type})]},addPasteRules(){return[Ul({find:fF,type:this.type})]}}),pF=Kr.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),Z4=Vo.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Wn(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const i=s[2].trim();return{type:"underline",raw:s[0],text:i,tokens:n.inlineTokens(i)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),mF=Z4;function gF(t={}){return new qn({view(e){return new xF(e,t)}})}class xF{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=c=>{this[s](c)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),c=i.width/s.offsetWidth,f=i.height/s.offsetHeight;if(n){let v=e.nodeBefore,A=e.nodeAfter;if(v||A){let T=this.editorView.nodeDOM(this.cursorPos-(v?v.nodeSize:0));if(T){let _=T.getBoundingClientRect(),M=v?_.bottom:_.top;v&&A&&(M=(M+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let R=this.width/2*f;r={left:_.left,right:_.right,top:M-R,bottom:M+R}}}}if(!r){let v=this.editorView.coordsAtPos(this.cursorPos),A=this.width/2*c;r={left:v.left-A,right:v.left+A,top:v.top,bottom:v.bottom}}let p=this.editorView.dom.offsetParent;this.element||(this.element=p.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let g,C;if(!p||p==document.body&&getComputedStyle(p).position=="static")g=-pageXOffset,C=-pageYOffset;else{let v=p.getBoundingClientRect(),A=v.width/p.offsetWidth,T=v.height/p.offsetHeight;g=v.left-p.scrollLeft*A,C=v.top-p.scrollTop*T}this.element.style.left=(r.left-g)/c+"px",this.element.style.top=(r.top-C)/f+"px",this.element.style.width=(r.right-r.left)/c+"px",this.element.style.height=(r.bottom-r.top)/f+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!i){let c=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let f=VN(this.editorView.state.doc,c,this.editorView.dragging.slice);f!=null&&(c=f)}this.setCursor(c),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class lr extends Ot{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return lr.valid(r)?new lr(r):Ot.near(r)}content(){return st.empty}eq(e){return e instanceof lr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new lr(e.resolve(n.pos))}getBookmark(){return new Pb(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!bF(e)||!yF(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&lr.valid(e))return e;let s=e.pos,i=null;for(let c=e.depth;;c--){let f=e.node(c);if(n>0?e.indexAfter(c)<f.childCount:e.index(c)>0){i=f.child(n>0?e.indexAfter(c):e.index(c)-1);break}else if(c==0)return null;s+=n;let p=e.doc.resolve(s);if(lr.valid(p))return p}for(;;){let c=n>0?i.firstChild:i.lastChild;if(!c){if(i.isAtom&&!i.isText&&!vt.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*n),r=!1;continue e}break}i=c,s+=n;let f=e.doc.resolve(s);if(lr.valid(f))return f}return null}}}lr.prototype.visible=!1;lr.findFrom=lr.findGapCursorFrom;Ot.jsonID("gapcursor",lr);class Pb{constructor(e){this.pos=e}map(e){return new Pb(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return lr.valid(n)?new lr(n):Ot.near(n)}}function J4(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function bF(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||J4(s.type))return!0;if(s.inlineContent)return!1}}return!0}function yF(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||J4(s.type))return!0;if(s.inlineContent)return!1}}return!0}function wF(){return new qn({props:{decorations:SF,createSelectionBetween(t,e,n){return e.pos==n.pos&&lr.valid(n)?new lr(n):null},handleClick:CF,handleKeyDown:vF,handleDOMEvents:{beforeinput:EF}}})}const vF=gb({ArrowLeft:Kh("horiz",-1),ArrowRight:Kh("horiz",1),ArrowUp:Kh("vert",-1),ArrowDown:Kh("vert",1)});function Kh(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let c=r.selection,f=e>0?c.$to:c.$from,p=c.empty;if(c instanceof Ct){if(!i.endOfTextblock(n)||f.depth==0)return!1;p=!1,f=r.doc.resolve(e>0?f.after():f.before())}let g=lr.findGapCursorFrom(f,e,p);return g?(s&&s(r.tr.setSelection(new lr(g))),!0):!1}}function CF(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!lr.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&vt.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new lr(r))),!0)}function EF(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof lr))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=Pe.empty;for(let c=r.length-1;c>=0;c--)s=Pe.from(r[c].createAndFill(null,s));let i=t.state.tr.replace(n.pos,n.pos,new st(s,0,0));return i.setSelection(Ct.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function SF(t){if(!(t.selection instanceof lr))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Pn.create(t.doc,[Mr.widget(t.selection.head,e,{key:"gapcursor"})])}var Cp=200,Dr=function(){};Dr.prototype.append=function(e){return e.length?(e=Dr.from(e),!this.length&&e||e.length<Cp&&this.leafAppend(e)||this.length<Cp&&e.leafPrepend(this)||this.appendInner(e)):this};Dr.prototype.prepend=function(e){return e.length?Dr.from(e).append(this):this};Dr.prototype.appendInner=function(e){return new AF(this,e)};Dr.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Dr.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Dr.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Dr.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Dr.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,c){return s.push(e(i,c))},n,r),s};Dr.from=function(e){return e instanceof Dr?e:e&&e.length?new Q4(e):Dr.empty};var Q4=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,c,f){for(var p=i;p<c;p++)if(s(this.values[p],f+p)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,c,f){for(var p=i-1;p>=c;p--)if(s(this.values[p],f+p)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Cp)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Cp)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(Dr);Dr.empty=new Q4([]);var AF=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,c){var f=this.left.length;if(s<f&&this.left.forEachInner(r,s,Math.min(i,f),c)===!1||i>f&&this.right.forEachInner(r,Math.max(s-f,0),Math.min(this.length,i)-f,c+f)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,c){var f=this.left.length;if(s>f&&this.right.forEachInvertedInner(r,s-f,Math.max(i,f)-f,c+f)===!1||i<f&&this.left.forEachInvertedInner(r,Math.min(s,f),i,c)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(Dr);const NF=500;class pi{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;n&&(s=this.remapping(r,this.items.length),i=s.maps.length);let c=e.tr,f,p,g=[],C=[];return this.items.forEach((v,A)=>{if(!v.step){s||(s=this.remapping(r,A+1),i=s.maps.length),i--,C.push(v);return}if(s){C.push(new Pi(v.map));let T=v.step.map(s.slice(i)),_;T&&c.maybeStep(T).doc&&(_=c.mapping.maps[c.mapping.maps.length-1],g.push(new Pi(_,void 0,void 0,g.length+C.length))),i--,_&&s.appendMap(_,i)}else c.maybeStep(v.step);if(v.selection)return f=s?v.selection.map(s.slice(i)):v.selection,p=new pi(this.items.slice(0,r).append(C.reverse().concat(g)),this.eventCount-1),!1},this.items.length,0),{remaining:p,transform:c,selection:f}}addTransform(e,n,r,s){let i=[],c=this.eventCount,f=this.items,p=!s&&f.length?f.get(f.length-1):null;for(let C=0;C<e.steps.length;C++){let v=e.steps[C].invert(e.docs[C]),A=new Pi(e.mapping.maps[C],v,n),T;(T=p&&p.merge(A))&&(A=T,C?i.pop():f=f.slice(0,f.length-1)),i.push(A),n&&(c++,n=void 0),s||(p=A)}let g=c-r.depth;return g>TF&&(f=kF(f,g),c-=g),new pi(f.append(i),c)}remapping(e,n){let r=new Hd;return this.items.forEach((s,i)=>{let c=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,c)},e,n),r}addMaps(e){return this.eventCount==0?this:new pi(this.items.append(e.map(n=>new Pi(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),i=e.mapping,c=e.steps.length,f=this.eventCount;this.items.forEach(A=>{A.selection&&f--},s);let p=n;this.items.forEach(A=>{let T=i.getMirror(--p);if(T==null)return;c=Math.min(c,T);let _=i.maps[T];if(A.step){let M=e.steps[T].invert(e.docs[T]),R=A.selection&&A.selection.map(i.slice(p+1,T));R&&f++,r.push(new Pi(_,M,R))}else r.push(new Pi(_))},s);let g=[];for(let A=n;A<c;A++)g.push(new Pi(i.maps[A]));let C=this.items.slice(0,s).append(g).append(r),v=new pi(C,f);return v.emptyItemCount()>NF&&(v=v.compress(this.items.length-r.length)),v}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],i=0;return this.items.forEach((c,f)=>{if(f>=e)s.push(c),c.selection&&i++;else if(c.step){let p=c.step.map(n.slice(r)),g=p&&p.getMap();if(r--,g&&n.appendMap(g,r),p){let C=c.selection&&c.selection.map(n.slice(r));C&&i++;let v=new Pi(g.invert(),p,C),A,T=s.length-1;(A=s.length&&s[T].merge(v))?s[T]=A:s.push(v)}}else c.map&&r--},this.items.length,0),new pi(Dr.from(s.reverse()),i)}}pi.empty=new pi(Dr.empty,0);function kF(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class Pi{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Pi(n.getMap().invert(),n,this.selection)}}}class vo{constructor(e,n,r,s,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const TF=20;function OF(t,e,n,r){let s=n.getMeta(Dl),i;if(s)return s.historyState;n.getMeta(MF)&&(t=new vo(t.done,t.undone,null,0,-1));let c=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(c&&c.getMeta(Dl))return c.getMeta(Dl).redo?new vo(t.done.addTransform(n,void 0,r,f0(e)),t.undone,AS(n.mapping.maps),t.prevTime,t.prevComposition):new vo(t.done,t.undone.addTransform(n,void 0,r,f0(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(c&&c.getMeta("addToHistory")===!1)){let f=n.getMeta("composition"),p=t.prevTime==0||!c&&t.prevComposition!=f&&(t.prevTime<(n.time||0)-r.newGroupDelay||!_F(n,t.prevRanges)),g=c?Kg(t.prevRanges,n.mapping):AS(n.mapping.maps);return new vo(t.done.addTransform(n,p?e.selection.getBookmark():void 0,r,f0(e)),pi.empty,g,n.time,f??t.prevComposition)}else return(i=n.getMeta("rebased"))?new vo(t.done.rebased(n,i),t.undone.rebased(n,i),Kg(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new vo(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Kg(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function _F(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(n=!0)}),n}function AS(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,i,c)=>e.push(i,c));return e}function Kg(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),i=e.map(t[r+1],-1);s<=i&&n.push(s,i)}return n}function RF(t,e,n){let r=f0(e),s=Dl.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let c=i.selection.resolve(i.transform.doc),f=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),p=new vo(n?f:i.remaining,n?i.remaining:f,null,0,-1);return i.transform.setSelection(c).setMeta(Dl,{redo:n,historyState:p})}let Zg=!1,NS=null;function f0(t){let e=t.plugins;if(NS!=e){Zg=!1,NS=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Zg=!0;break}}return Zg}const Dl=new ur("history"),MF=new ur("closeHistory");function IF(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new qn({key:Dl,state:{init(){return new vo(pi.empty,pi.empty,null,0,-1)},apply(e,n,r){return OF(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?tT:r=="historyRedo"?nT:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function eT(t,e){return(n,r)=>{let s=Dl.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let i=RF(s,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const tT=eT(!1,!0),nT=eT(!0,!0);Tn.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new qn({key:new ur("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const i=this.storage.characters({node:r.doc});if(i>s){const c=i-s,f=0,p=c;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const g=r.tr.deleteRange(f,p);return t=!0,g}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),i=this.storage.characters({node:e.doc});if(i<=r||s>r&&i>r&&i<=s)return!0;if(s>r&&i>r&&i>s||!e.getMeta("paste"))return!1;const f=e.selection.$head.pos,p=i-r,g=f-p,C=f;return e.deleteRange(g,C),!(this.storage.characters({node:e.doc})>r)}})]}});var DF=Tn.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[gF(this.options)]}});Tn.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new qn({key:new ur("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,i=[];if(!n||!r)return Pn.create(t,[]);let c=0;this.options.mode==="deepest"&&t.descendants((p,g)=>{if(p.isText)return;if(!(s>=g&&s<=g+p.nodeSize-1))return!1;c+=1});let f=0;return t.descendants((p,g)=>{if(p.isText||!(s>=g&&s<=g+p.nodeSize-1))return!1;if(f+=1,this.options.mode==="deepest"&&c-f>0||this.options.mode==="shallowest"&&f>1)return this.options.mode==="deepest";i.push(Mr.node(g,g+p.nodeSize,{class:this.options.className}))}),Pn.create(t,i)}}})]}});var LF=Tn.create({name:"gapCursor",addProseMirrorPlugins(){return[wF()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Cn(xt(t,"allowGapCursor",n)))!=null?e:null}}}),kS="placeholder";function jF(t){return t.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var BF=Tn.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:kS,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const t=this.options.dataAttribute?`data-${jF(this.options.dataAttribute)}`:`data-${kS}`;return[new qn({key:new ur("placeholder"),props:{decorations:({doc:e,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=n,i=[];if(!r)return null;const c=this.editor.isEmpty;return e.descendants((f,p)=>{const g=s>=p&&s<=p+f.nodeSize,C=!f.isLeaf&&s1(f);if((g||!this.options.showOnlyCurrent)&&C){const v=[this.options.emptyNodeClass];c&&v.push(this.options.emptyEditorClass);const A=Mr.node(p,p+f.nodeSize,{class:v.join(" "),[t]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:f,pos:p,hasAnchor:g}):this.options.placeholder});i.push(A)}return this.options.includeChildren}),Pn.create(e,i)}}})]}});Tn.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new qn({key:new ur("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||a4(n.selection)||t.view.dragging?null:Pn.create(n.doc,[Mr.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function TS({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var PF=Tn.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new ur(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new qn({key:e,appendTransaction:(s,i,c)=>{const{doc:f,tr:p,schema:g}=c,C=e.getState(c),v=f.content.size,A=g.nodes[n];if(C)return p.insert(v,A.create())},state:{init:(s,i)=>{const c=i.tr.doc.lastChild;return!TS({node:c,types:r})},apply:(s,i)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return i;const c=s.doc.lastChild;return!TS({node:c,types:r})}}})]}}),FF=Tn.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>tT(t,e),redo:()=>({state:t,dispatch:e})=>nT(t,e)}},addProseMirrorPlugins(){return[IF(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),zF=Tn.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(fP.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(oP.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(F4.configure(this.options.bulletList)),this.options.code!==!1&&s.push(mP.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(bP.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(yP.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(DF.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(LF.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(wP.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(vP.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(FF.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(CP.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(kP.configure(this.options.italic)),this.options.listItem!==!1&&s.push(z4.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(q4.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(JP.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(X4.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(uF.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(hF.configure(this.options.strike)),this.options.text!==!1&&s.push(pF.configure(this.options.text)),this.options.underline!==!1&&s.push(Z4.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(PF.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),UF=zF,HF=K4,VF=Y4,GF=BF,WF=20,rT=(t,e=0)=>{const n=[];return!t.children.length||e>WF||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...rT(r,e+1))}),n},qF=t=>{if(!t.children.length)return;const e=rT(t);e&&e.forEach(n=>{var r,s;const i=n.getAttribute("style"),c=(s=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");n.setAttribute("style",`${c};${i}`)})},sT=Vo.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&qF(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",Wn(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(i=>!!i))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),$F=Tn.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const i=r[s].split(":");if(i.length>=2){const c=i[0].trim().toLowerCase(),f=i.slice(1).join(":").trim();if(c==="background-color")return f.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),iT=Tn.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const i=r[s].split(":");if(i.length>=2){const c=i[0].trim().toLowerCase(),f=i.slice(1).join(":").trim();if(c==="color")return f.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),XF=Tn.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),YF=Tn.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),KF=Tn.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});Tn.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push($F.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(iT.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(XF.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(YF.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(KF.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(sT.configure(this.options.textStyle)),t}});var ZF=iT;let m2,g2;if(typeof WeakMap<"u"){let t=new WeakMap;m2=e=>t.get(e),g2=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;m2=r=>{for(let s=0;s<t.length;s+=2)if(t[s]==r)return t[s+1]},g2=(r,s)=>(n==10&&(n=0),t[n++]=r,t[n++]=s)}var cr=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,s=e/this.width|0;let i=r+1,c=s+1;for(let f=1;i<this.width&&this.map[e+f]==n;f++)i++;for(let f=1;c<this.height&&this.map[e+this.width*f]==n;f++)c++;return{left:r,top:s,right:i,bottom:c}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:s,top:i,bottom:c}=this.findCell(t);return e=="horiz"?(n<0?r==0:s==this.width)?null:this.map[i*this.width+(n<0?r-1:s)]:(n<0?i==0:c==this.height)?null:this.map[r+this.width*(n<0?i-1:c)]}rectBetween(t,e){const{left:n,right:r,top:s,bottom:i}=this.findCell(t),{left:c,right:f,top:p,bottom:g}=this.findCell(e);return{left:Math.min(n,c),top:Math.min(s,p),right:Math.max(r,f),bottom:Math.max(i,g)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let s=t.left;s<t.right;s++){const i=r*this.width+s,c=this.map[i];n[c]||(n[c]=!0,!(s==t.left&&s&&this.map[i-1]==c||r==t.top&&r&&this.map[i-this.width]==c)&&e.push(c))}return e}positionAt(t,e,n){for(let r=0,s=0;;r++){const i=s+n.child(r).nodeSize;if(r==t){let c=e+t*this.width;const f=(t+1)*this.width;for(;c<f&&this.map[c]<s;)c++;return c==f?i-1:this.map[c]}s=i}}static get(t){return m2(t)||g2(t,JF(t))}};function JF(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=QF(t),n=t.childCount,r=[];let s=0,i=null;const c=[];for(let g=0,C=e*n;g<C;g++)r[g]=0;for(let g=0,C=0;g<n;g++){const v=t.child(g);C++;for(let _=0;;_++){for(;s<r.length&&r[s]!=0;)s++;if(_==v.childCount)break;const M=v.child(_),{colspan:R,rowspan:j,colwidth:H}=M.attrs;for(let G=0;G<j;G++){if(G+g>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:C,n:j-G});break}const Z=s+G*e;for(let J=0;J<R;J++){r[Z+J]==0?r[Z+J]=C:(i||(i=[])).push({type:"collision",row:g,pos:C,n:R-J});const oe=H&&H[J];if(oe){const U=(Z+J)%e*2,ee=c[U];ee==null||ee!=oe&&c[U+1]==1?(c[U]=oe,c[U+1]=1):ee==oe&&c[U+1]++}}}s+=R,C+=M.nodeSize}const A=(g+1)*e;let T=0;for(;s<A;)r[s++]==0&&T++;T&&(i||(i=[])).push({type:"missing",row:g,n:T}),C++}(e===0||n===0)&&(i||(i=[])).push({type:"zero_sized"});const f=new cr(e,n,r,i);let p=!1;for(let g=0;!p&&g<c.length;g+=2)c[g]!=null&&c[g+1]<n&&(p=!0);return p&&ez(f,c,t),f}function QF(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const s=t.child(r);let i=0;if(n)for(let c=0;c<r;c++){const f=t.child(c);for(let p=0;p<f.childCount;p++){const g=f.child(p);c+g.attrs.rowspan>r&&(i+=g.attrs.colspan)}}for(let c=0;c<s.childCount;c++){const f=s.child(c);i+=f.attrs.colspan,f.attrs.rowspan>1&&(n=!0)}e==-1?e=i:e!=i&&(e=Math.max(e,i))}return e}function ez(t,e,n){t.problems||(t.problems=[]);const r={};for(let s=0;s<t.map.length;s++){const i=t.map[s];if(r[i])continue;r[i]=!0;const c=n.nodeAt(i);if(!c)throw new RangeError(`No cell with offset ${i} found`);let f=null;const p=c.attrs;for(let g=0;g<p.colspan;g++){const C=e[(s+g)%t.width*2];C!=null&&(!p.colwidth||p.colwidth[g]!=C)&&((f||(f=tz(p)))[g]=C)}f&&t.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:f})}}function tz(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function rs(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],s=r.spec.tableRole;s&&(e[s]=r)}}return e}const So=new ur("selectingCells");function Hl(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function nz(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function Ci(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function l1(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=Hl(e.$head)||rz(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function rz(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function x2(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function sz(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function Fb(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function aT(t,e,n){const r=t.node(-1),s=cr.get(r),i=t.start(-1),c=s.nextCell(t.pos-i,e,n);return c==null?null:t.node(0).resolve(i+c)}function Vl(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function oT(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<n;s++)r.colwidth.splice(e,0,0)}return r}function iz(t,e,n){const r=rs(e.type.schema).header_cell;for(let s=0;s<t.height;s++)if(e.nodeAt(t.map[n+s*t.width]).type!=r)return!1;return!0}var Fn=class ya extends Ot{constructor(e,n=e){const r=e.node(-1),s=cr.get(r),i=e.start(-1),c=s.rectBetween(e.pos-i,n.pos-i),f=e.node(0),p=s.cellsInRect(c).filter(C=>C!=n.pos-i);p.unshift(n.pos-i);const g=p.map(C=>{const v=r.nodeAt(C);if(!v)throw new RangeError(`No cell with offset ${C} found`);const A=i+C+1;return new XN(f.resolve(A),f.resolve(A+v.content.size))});super(g[0].$from,g[0].$to,g),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),s=e.resolve(n.map(this.$headCell.pos));if(x2(r)&&x2(s)&&Fb(r,s)){const i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?ya.rowSelection(r,s):i&&this.isColSelection()?ya.colSelection(r,s):new ya(r,s)}return Ct.between(r,s)}content(){const e=this.$anchorCell.node(-1),n=cr.get(e),r=this.$anchorCell.start(-1),s=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),i={},c=[];for(let p=s.top;p<s.bottom;p++){const g=[];for(let C=p*n.width+s.left,v=s.left;v<s.right;v++,C++){const A=n.map[C];if(i[A])continue;i[A]=!0;const T=n.findCell(A);let _=e.nodeAt(A);if(!_)throw new RangeError(`No cell with offset ${A} found`);const M=s.left-T.left,R=T.right-s.right;if(M>0||R>0){let j=_.attrs;if(M>0&&(j=Vl(j,0,M)),R>0&&(j=Vl(j,j.colspan-R,R)),T.left<s.left){if(_=_.type.createAndFill(j),!_)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(j)}`)}else _=_.type.create(j,_.content)}if(T.top<s.top||T.bottom>s.bottom){const j={..._.attrs,rowspan:Math.min(T.bottom,s.bottom)-Math.max(T.top,s.top)};T.top<s.top?_=_.type.createAndFill(j):_=_.type.create(j,_.content)}g.push(_)}c.push(e.child(p).copy(Pe.from(g)))}const f=this.isColSelection()&&this.isRowSelection()?e:c;return new st(Pe.from(f),1,1)}replace(e,n=st.empty){const r=e.steps.length,s=this.ranges;for(let c=0;c<s.length;c++){const{$from:f,$to:p}=s[c],g=e.mapping.slice(r);e.replace(g.map(f.pos),g.map(p.pos),c?st.empty:n)}const i=Ot.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);i&&e.setSelection(i)}replaceWith(e,n){this.replace(e,new st(Pe.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=cr.get(n),s=this.$anchorCell.start(-1),i=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let c=0;c<i.length;c++)e(n.nodeAt(i[c]),s+i[c])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,s=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),s=cr.get(r),i=e.start(-1),c=s.findCell(e.pos-i),f=s.findCell(n.pos-i),p=e.node(0);return c.top<=f.top?(c.top>0&&(e=p.resolve(i+s.map[c.left])),f.bottom<s.height&&(n=p.resolve(i+s.map[s.width*(s.height-1)+f.right-1]))):(f.top>0&&(n=p.resolve(i+s.map[f.left])),c.bottom<s.height&&(e=p.resolve(i+s.map[s.width*(s.height-1)+c.right-1]))),new ya(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=cr.get(e),r=this.$anchorCell.start(-1),s=n.colCount(this.$anchorCell.pos-r),i=n.colCount(this.$headCell.pos-r);if(Math.min(s,i)>0)return!1;const c=s+this.$anchorCell.nodeAfter.attrs.colspan,f=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(c,f)==n.width}eq(e){return e instanceof ya&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),s=cr.get(r),i=e.start(-1),c=s.findCell(e.pos-i),f=s.findCell(n.pos-i),p=e.node(0);return c.left<=f.left?(c.left>0&&(e=p.resolve(i+s.map[c.top*s.width])),f.right<s.width&&(n=p.resolve(i+s.map[s.width*(f.top+1)-1]))):(f.left>0&&(n=p.resolve(i+s.map[f.top*s.width])),c.right<s.width&&(e=p.resolve(i+s.map[s.width*(c.top+1)-1]))),new ya(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new ya(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new ya(e.resolve(n),e.resolve(r))}getBookmark(){return new az(this.$anchorCell.pos,this.$headCell.pos)}};Fn.prototype.visible=!1;Ot.jsonID("cell",Fn);var az=class lT{constructor(e,n){this.anchor=e,this.head=n}map(e){return new lT(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&Fb(n,r)?new Fn(n,r):Ot.near(r,1)}};function oz(t){if(!(t.selection instanceof Fn))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(Mr.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Pn.create(t.doc,e)}function lz({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,s=t.depth;for(;s>=0&&!(t.after(s+1)<t.end(s));s--,n++);for(let i=e.depth;i>=0&&!(e.before(i+1)>e.start(i));i--,r--);return n==r&&/row|table/.test(t.node(s).type.spec.tableRole)}function cz({$from:t,$to:e}){let n,r;for(let s=t.depth;s>0;s--){const i=t.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){n=i;break}}for(let s=e.depth;s>0;s--){const i=e.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){r=i;break}}return n!==r&&e.parentOffset===0}function uz(t,e,n){const r=(e||t).selection,s=(e||t).doc;let i,c;if(r instanceof vt&&(c=r.node.type.spec.tableRole)){if(c=="cell"||c=="header_cell")i=Fn.create(s,r.from);else if(c=="row"){const f=s.resolve(r.from+1);i=Fn.rowSelection(f,f)}else if(!n){const f=cr.get(r.node),p=r.from+1,g=p+f.map[f.width*f.height-1];i=Fn.create(s,p+1,g)}}else r instanceof Ct&&lz(r)?i=Ct.create(s,r.from):r instanceof Ct&&cz(r)&&(i=Ct.create(s,r.$from.start(),r.$from.end()));return i&&(e||(e=t.tr)).setSelection(i),e}const dz=new ur("fix-tables");function cT(t,e,n,r){const s=t.childCount,i=e.childCount;e:for(let c=0,f=0;c<i;c++){const p=e.child(c);for(let g=f,C=Math.min(s,c+3);g<C;g++)if(t.child(g)==p){f=g+1,n+=p.nodeSize;continue e}r(p,n),f<s&&t.child(f).sameMarkup(p)?cT(t.child(f),p,n+1,r):p.nodesBetween(0,p.content.size,r,n+1),n+=p.nodeSize}}function uT(t,e){let n;const r=(s,i)=>{s.type.spec.tableRole=="table"&&(n=fz(t,s,i,n))};return e?e.doc!=t.doc&&cT(e.doc,t.doc,0,r):t.doc.descendants(r),n}function fz(t,e,n,r){const s=cr.get(e);if(!s.problems)return r;r||(r=t.tr);const i=[];for(let p=0;p<s.height;p++)i.push(0);for(let p=0;p<s.problems.length;p++){const g=s.problems[p];if(g.type=="collision"){const C=e.nodeAt(g.pos);if(!C)continue;const v=C.attrs;for(let A=0;A<v.rowspan;A++)i[g.row+A]+=g.n;r.setNodeMarkup(r.mapping.map(n+1+g.pos),null,Vl(v,v.colspan-g.n,g.n))}else if(g.type=="missing")i[g.row]+=g.n;else if(g.type=="overlong_rowspan"){const C=e.nodeAt(g.pos);if(!C)continue;r.setNodeMarkup(r.mapping.map(n+1+g.pos),null,{...C.attrs,rowspan:C.attrs.rowspan-g.n})}else if(g.type=="colwidth mismatch"){const C=e.nodeAt(g.pos);if(!C)continue;r.setNodeMarkup(r.mapping.map(n+1+g.pos),null,{...C.attrs,colwidth:g.colwidth})}else if(g.type=="zero_sized"){const C=r.mapping.map(n);r.delete(C,C+e.nodeSize)}}let c,f;for(let p=0;p<i.length;p++)i[p]&&(c==null&&(c=p),f=p);for(let p=0,g=n+1;p<s.height;p++){const C=e.child(p),v=g+C.nodeSize,A=i[p];if(A>0){let T="cell";C.firstChild&&(T=C.firstChild.type.spec.tableRole);const _=[];for(let R=0;R<A;R++){const j=rs(t.schema)[T].createAndFill();j&&_.push(j)}const M=(p==0||c==p-1)&&f==p?g+1:v-1;r.insert(r.mapping.map(M),_)}g=v}return r.setMeta(dz,{fixTables:!0})}function Wi(t){const e=t.selection,n=l1(t),r=n.node(-1),s=n.start(-1),i=cr.get(r);return{...e instanceof Fn?i.rectBetween(e.$anchorCell.pos-s,e.$headCell.pos-s):i.findCell(n.pos-s),tableStart:s,map:i,table:r}}function dT(t,{map:e,tableStart:n,table:r},s){let i=s>0?-1:0;iz(e,r,s+i)&&(i=s==0||s==e.width?null:0);for(let c=0;c<e.height;c++){const f=c*e.width+s;if(s>0&&s<e.width&&e.map[f-1]==e.map[f]){const p=e.map[f],g=r.nodeAt(p);t.setNodeMarkup(t.mapping.map(n+p),null,oT(g.attrs,s-e.colCount(p))),c+=g.attrs.rowspan-1}else{const p=i==null?rs(r.type.schema).cell:r.nodeAt(e.map[f+i]).type,g=e.positionAt(c,s,r);t.insert(t.mapping.map(n+g),p.createAndFill())}}return t}function hz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t);e(dT(t.tr,n,n.left))}return!0}function pz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t);e(dT(t.tr,n,n.right))}return!0}function mz(t,{map:e,table:n,tableStart:r},s){const i=t.mapping.maps.length;for(let c=0;c<e.height;){const f=c*e.width+s,p=e.map[f],g=n.nodeAt(p),C=g.attrs;if(s>0&&e.map[f-1]==p||s<e.width-1&&e.map[f+1]==p)t.setNodeMarkup(t.mapping.slice(i).map(r+p),null,Vl(C,s-e.colCount(p)));else{const v=t.mapping.slice(i).map(r+p);t.delete(v,v+g.nodeSize)}c+=C.rowspan}}function gz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let s=n.right-1;mz(r,n,s),s!=n.left;s--){const i=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!i)throw new RangeError("No table found");n.table=i,n.map=cr.get(i)}e(r)}return!0}function xz(t,e,n){var r;const s=rs(e.type.schema).header_cell;for(let i=0;i<t.width;i++)if(((r=e.nodeAt(t.map[i+n*t.width]))===null||r===void 0?void 0:r.type)!=s)return!1;return!0}function fT(t,{map:e,tableStart:n,table:r},s){let i=n;for(let g=0;g<s;g++)i+=r.child(g).nodeSize;const c=[];let f=s>0?-1:0;xz(e,r,s+f)&&(f=s==0||s==e.height?null:0);for(let g=0,C=e.width*s;g<e.width;g++,C++)if(s>0&&s<e.height&&e.map[C]==e.map[C-e.width]){const v=e.map[C],A=r.nodeAt(v).attrs;t.setNodeMarkup(n+v,null,{...A,rowspan:A.rowspan+1}),g+=A.colspan-1}else{var p;const v=f==null?rs(r.type.schema).cell:(p=r.nodeAt(e.map[C+f*e.width]))===null||p===void 0?void 0:p.type,A=v==null?void 0:v.createAndFill();A&&c.push(A)}return t.insert(i,rs(r.type.schema).row.create(null,c)),t}function bz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t);e(fT(t.tr,n,n.top))}return!0}function yz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t);e(fT(t.tr,n,n.bottom))}return!0}function wz(t,{map:e,table:n,tableStart:r},s){let i=0;for(let g=0;g<s;g++)i+=n.child(g).nodeSize;const c=i+n.child(s).nodeSize,f=t.mapping.maps.length;t.delete(i+r,c+r);const p=new Set;for(let g=0,C=s*e.width;g<e.width;g++,C++){const v=e.map[C];if(!p.has(v)){if(p.add(v),s>0&&v==e.map[C-e.width]){const A=n.nodeAt(v).attrs;t.setNodeMarkup(t.mapping.slice(f).map(v+r),null,{...A,rowspan:A.rowspan-1}),g+=A.colspan-1}else if(s<e.height&&v==e.map[C+e.width]){const A=n.nodeAt(v),T=A.attrs,_=A.type.create({...T,rowspan:A.attrs.rowspan-1},A.content),M=e.positionAt(s+1,g,n);t.insert(t.mapping.slice(f).map(r+M),_),g+=T.colspan-1}}}}function vz(t,e){if(!Ci(t))return!1;if(e){const n=Wi(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let s=n.bottom-1;wz(r,n,s),s!=n.top;s--){const i=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!i)throw new RangeError("No table found");n.table=i,n.map=cr.get(n.table)}e(r)}return!0}function OS(t){const e=t.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function Cz({width:t,height:e,map:n},r){let s=r.top*t+r.left,i=s,c=(r.bottom-1)*t+r.left,f=s+(r.right-r.left-1);for(let p=r.top;p<r.bottom;p++){if(r.left>0&&n[i]==n[i-1]||r.right<t&&n[f]==n[f+1])return!0;i+=t,f+=t}for(let p=r.left;p<r.right;p++){if(r.top>0&&n[s]==n[s-t]||r.bottom<e&&n[c]==n[c+t])return!0;s++,c++}return!1}function _S(t,e){const n=t.selection;if(!(n instanceof Fn)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=Wi(t),{map:s}=r;if(Cz(s,r))return!1;if(e){const i=t.tr,c={};let f=Pe.empty,p,g;for(let C=r.top;C<r.bottom;C++)for(let v=r.left;v<r.right;v++){const A=s.map[C*s.width+v],T=r.table.nodeAt(A);if(!(c[A]||!T))if(c[A]=!0,p==null)p=A,g=T;else{OS(T)||(f=f.append(T.content));const _=i.mapping.map(A+r.tableStart);i.delete(_,_+T.nodeSize)}}if(p==null||g==null)return!0;if(i.setNodeMarkup(p+r.tableStart,null,{...oT(g.attrs,g.attrs.colspan,r.right-r.left-g.attrs.colspan),rowspan:r.bottom-r.top}),f.size>0){const C=p+1+g.content.size,v=OS(g)?p+1:C;i.replaceWith(v+r.tableStart,C+r.tableStart,f)}i.setSelection(new Fn(i.doc.resolve(p+r.tableStart))),e(i)}return!0}function RS(t,e){const n=rs(t.schema);return Ez(({node:r})=>n[r.type.spec.tableRole])(t,e)}function Ez(t){return(e,n)=>{const r=e.selection;let s,i;if(r instanceof Fn){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;s=r.$anchorCell.nodeAfter,i=r.$anchorCell.pos}else{var c;if(s=nz(r.$from),!s)return!1;i=(c=Hl(r.$from))===null||c===void 0?void 0:c.pos}if(s==null||i==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(n){let f=s.attrs;const p=[],g=f.colwidth;f.rowspan>1&&(f={...f,rowspan:1}),f.colspan>1&&(f={...f,colspan:1});const C=Wi(e),v=e.tr;for(let T=0;T<C.right-C.left;T++)p.push(g?{...f,colwidth:g&&g[T]?[g[T]]:null}:f);let A;for(let T=C.top;T<C.bottom;T++){let _=C.map.positionAt(T,C.left,C.table);T==C.top&&(_+=s.nodeSize);for(let M=C.left,R=0;M<C.right;M++,R++)M==C.left&&T==C.top||v.insert(A=v.mapping.map(_+C.tableStart,1),t({node:s,row:T,col:M}).createAndFill(p[R]))}v.setNodeMarkup(i,t({node:s,row:C.top,col:C.left}),p[0]),r instanceof Fn&&v.setSelection(new Fn(v.doc.resolve(r.$anchorCell.pos),A?v.doc.resolve(A):void 0)),n(v)}return!0}}function Sz(t,e){return function(n,r){if(!Ci(n))return!1;const s=l1(n);if(s.nodeAfter.attrs[t]===e)return!1;if(r){const i=n.tr;n.selection instanceof Fn?n.selection.forEachCell((c,f)=>{c.attrs[t]!==e&&i.setNodeMarkup(f,null,{...c.attrs,[t]:e})}):i.setNodeMarkup(s.pos,null,{...s.nodeAfter.attrs,[t]:e}),r(i)}return!0}}function Az(t){return function(e,n){if(!Ci(e))return!1;if(n){const r=rs(e.schema),s=Wi(e),i=e.tr,c=s.map.cellsInRect(t=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:t=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),f=c.map(p=>s.table.nodeAt(p));for(let p=0;p<c.length;p++)f[p].type==r.header_cell&&i.setNodeMarkup(s.tableStart+c[p],r.cell,f[p].attrs);if(i.steps.length===0)for(let p=0;p<c.length;p++)i.setNodeMarkup(s.tableStart+c[p],r.header_cell,f[p].attrs);n(i)}return!0}}function MS(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let s=0;s<r.length;s++){const i=e.table.nodeAt(r[s]);if(i&&i.type!==n.header_cell)return!1}return!0}function Zd(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?Az(t):function(n,r){if(!Ci(n))return!1;if(r){const s=rs(n.schema),i=Wi(n),c=n.tr,f=MS("row",i,s),p=MS("column",i,s),g=(t==="column"?f:t==="row"&&p)?1:0,C=t=="column"?{left:0,top:g,right:1,bottom:i.map.height}:t=="row"?{left:g,top:0,right:i.map.width,bottom:1}:i,v=t=="column"?p?s.cell:s.header_cell:t=="row"?f?s.cell:s.header_cell:s.cell;i.map.cellsInRect(C).forEach(A=>{const T=A+i.tableStart,_=c.doc.nodeAt(T);_&&c.setNodeMarkup(T,v,_.attrs)}),r(c)}return!0}}Zd("row",{useDeprecatedLogic:!0});Zd("column",{useDeprecatedLogic:!0});const Nz=Zd("cell",{useDeprecatedLogic:!0});function kz(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,s=t.before();r>=0;r--){const i=t.node(-1).child(r),c=i.lastChild;if(c)return s-1-c.nodeSize;s-=i.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),s=t.after();r<n.childCount;r++){const i=n.child(r);if(i.childCount)return s+1;s+=i.nodeSize}}return null}function IS(t){return function(e,n){if(!Ci(e))return!1;const r=kz(l1(e),t);if(r==null)return!1;if(n){const s=e.doc.resolve(r);n(e.tr.setSelection(Ct.between(s,sz(s))).scrollIntoView())}return!0}}function Tz(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function Zh(t,e){const n=t.selection;if(!(n instanceof Fn))return!1;if(e){const r=t.tr,s=rs(t.schema).cell.createAndFill().content;n.forEachCell((i,c)=>{i.content.eq(s)||r.replace(r.mapping.map(c+1),r.mapping.map(c+i.nodeSize-1),new st(s,0,0))}),r.docChanged&&e(r)}return!0}function Oz(t){if(t.size===0)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const s=e.child(0),i=s.type.spec.tableRole,c=s.type.schema,f=[];if(i=="row")for(let p=0;p<e.childCount;p++){let g=e.child(p).content;const C=p?0:Math.max(0,n-1),v=p<e.childCount-1?0:Math.max(0,r-1);(C||v)&&(g=b2(rs(c).row,new st(g,C,v)).content),f.push(g)}else if(i=="cell"||i=="header_cell")f.push(n||r?b2(rs(c).row,new st(e,n,r)).content:e);else return null;return _z(c,f)}function _z(t,e){const n=[];for(let s=0;s<e.length;s++){const i=e[s];for(let c=i.childCount-1;c>=0;c--){const{rowspan:f,colspan:p}=i.child(c).attrs;for(let g=s;g<s+f;g++)n[g]=(n[g]||0)+p}}let r=0;for(let s=0;s<n.length;s++)r=Math.max(r,n[s]);for(let s=0;s<n.length;s++)if(s>=e.length&&e.push(Pe.empty),n[s]<r){const i=rs(t).cell.createAndFill(),c=[];for(let f=n[s];f<r;f++)c.push(i);e[s]=e[s].append(Pe.from(c))}return{height:e.length,width:r,rows:e}}function b2(t,e){const n=t.createAndFill();return new eb(n).replace(0,n.content.size,e).doc}function Rz({width:t,height:e,rows:n},r,s){if(t!=r){const i=[],c=[];for(let f=0;f<n.length;f++){const p=n[f],g=[];for(let C=i[f]||0,v=0;C<r;v++){let A=p.child(v%p.childCount);C+A.attrs.colspan>r&&(A=A.type.createChecked(Vl(A.attrs,A.attrs.colspan,C+A.attrs.colspan-r),A.content)),g.push(A),C+=A.attrs.colspan;for(let T=1;T<A.attrs.rowspan;T++)i[f+T]=(i[f+T]||0)+A.attrs.colspan}c.push(Pe.from(g))}n=c,t=r}if(e!=s){const i=[];for(let c=0,f=0;c<s;c++,f++){const p=[],g=n[f%e];for(let C=0;C<g.childCount;C++){let v=g.child(C);c+v.attrs.rowspan>s&&(v=v.type.create({...v.attrs,rowspan:Math.max(1,s-v.attrs.rowspan)},v.content)),p.push(v)}i.push(Pe.from(p))}n=i,e=s}return{width:t,height:e,rows:n}}function Mz(t,e,n,r,s,i,c){const f=t.doc.type.schema,p=rs(f);let g,C;if(s>e.width)for(let v=0,A=0;v<e.height;v++){const T=n.child(v);A+=T.nodeSize;const _=[];let M;T.lastChild==null||T.lastChild.type==p.cell?M=g||(g=p.cell.createAndFill()):M=C||(C=p.header_cell.createAndFill());for(let R=e.width;R<s;R++)_.push(M);t.insert(t.mapping.slice(c).map(A-1+r),_)}if(i>e.height){const v=[];for(let _=0,M=(e.height-1)*e.width;_<Math.max(e.width,s);_++){const R=_>=e.width?!1:n.nodeAt(e.map[M+_]).type==p.header_cell;v.push(R?C||(C=p.header_cell.createAndFill()):g||(g=p.cell.createAndFill()))}const A=p.row.create(null,Pe.from(v)),T=[];for(let _=e.height;_<i;_++)T.push(A);t.insert(t.mapping.slice(c).map(r+n.nodeSize-2),T)}return!!(g||C)}function DS(t,e,n,r,s,i,c,f){if(c==0||c==e.height)return!1;let p=!1;for(let g=s;g<i;g++){const C=c*e.width+g,v=e.map[C];if(e.map[C-e.width]==v){p=!0;const A=n.nodeAt(v),{top:T,left:_}=e.findCell(v);t.setNodeMarkup(t.mapping.slice(f).map(v+r),null,{...A.attrs,rowspan:c-T}),t.insert(t.mapping.slice(f).map(e.positionAt(c,_,n)),A.type.createAndFill({...A.attrs,rowspan:T+A.attrs.rowspan-c})),g+=A.attrs.colspan-1}}return p}function LS(t,e,n,r,s,i,c,f){if(c==0||c==e.width)return!1;let p=!1;for(let g=s;g<i;g++){const C=g*e.width+c,v=e.map[C];if(e.map[C-1]==v){p=!0;const A=n.nodeAt(v),T=e.colCount(v),_=t.mapping.slice(f).map(v+r);t.setNodeMarkup(_,null,Vl(A.attrs,c-T,A.attrs.colspan-(c-T))),t.insert(_+A.nodeSize,A.type.createAndFill(Vl(A.attrs,0,c-T))),g+=A.attrs.rowspan-1}}return p}function jS(t,e,n,r,s){let i=n?t.doc.nodeAt(n-1):t.doc;if(!i)throw new Error("No table found");let c=cr.get(i);const{top:f,left:p}=r,g=p+s.width,C=f+s.height,v=t.tr;let A=0;function T(){if(i=n?v.doc.nodeAt(n-1):v.doc,!i)throw new Error("No table found");c=cr.get(i),A=v.mapping.maps.length}Mz(v,c,i,n,g,C,A)&&T(),DS(v,c,i,n,p,g,f,A)&&T(),DS(v,c,i,n,p,g,C,A)&&T(),LS(v,c,i,n,f,C,p,A)&&T(),LS(v,c,i,n,f,C,g,A)&&T();for(let _=f;_<C;_++){const M=c.positionAt(_,p,i),R=c.positionAt(_,g,i);v.replace(v.mapping.slice(A).map(M+n),v.mapping.slice(A).map(R+n),new st(s.rows[_-f],0,0))}T(),v.setSelection(new Fn(v.doc.resolve(n+c.positionAt(f,p,i)),v.doc.resolve(n+c.positionAt(C-1,g-1,i)))),e(v)}const Iz=gb({ArrowLeft:Jh("horiz",-1),ArrowRight:Jh("horiz",1),ArrowUp:Jh("vert",-1),ArrowDown:Jh("vert",1),"Shift-ArrowLeft":Qh("horiz",-1),"Shift-ArrowRight":Qh("horiz",1),"Shift-ArrowUp":Qh("vert",-1),"Shift-ArrowDown":Qh("vert",1),Backspace:Zh,"Mod-Backspace":Zh,Delete:Zh,"Mod-Delete":Zh});function h0(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Jh(t,e){return(n,r,s)=>{if(!s)return!1;const i=n.selection;if(i instanceof Fn)return h0(n,r,Ot.near(i.$headCell,e));if(t!="horiz"&&!i.empty)return!1;const c=hT(s,t,e);if(c==null)return!1;if(t=="horiz")return h0(n,r,Ot.near(n.doc.resolve(i.head+e),e));{const f=n.doc.resolve(c),p=aT(f,t,e);let g;return p?g=Ot.near(p,1):e<0?g=Ot.near(n.doc.resolve(f.before(-1)),-1):g=Ot.near(n.doc.resolve(f.after(-1)),1),h0(n,r,g)}}}function Qh(t,e){return(n,r,s)=>{if(!s)return!1;const i=n.selection;let c;if(i instanceof Fn)c=i;else{const p=hT(s,t,e);if(p==null)return!1;c=new Fn(n.doc.resolve(p))}const f=aT(c.$headCell,t,e);return f?h0(n,r,new Fn(c.$anchorCell,f)):!1}}function Dz(t,e){const n=t.state.doc,r=Hl(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new Fn(r))),!0):!1}function Lz(t,e,n){if(!Ci(t.state))return!1;let r=Oz(n);const s=t.state.selection;if(s instanceof Fn){r||(r={width:1,height:1,rows:[Pe.from(b2(rs(t.state.schema).cell,n))]});const i=s.$anchorCell.node(-1),c=s.$anchorCell.start(-1),f=cr.get(i).rectBetween(s.$anchorCell.pos-c,s.$headCell.pos-c);return r=Rz(r,f.right-f.left,f.bottom-f.top),jS(t.state,t.dispatch,c,f,r),!0}else if(r){const i=l1(t.state),c=i.start(-1);return jS(t.state,t.dispatch,c,cr.get(i.node(-1)).findCell(i.pos-c),r),!0}else return!1}function jz(t,e){var n;if(e.button!=0||e.ctrlKey||e.metaKey)return;const r=BS(t,e.target);let s;if(e.shiftKey&&t.state.selection instanceof Fn)i(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(s=Hl(t.state.selection.$anchor))!=null&&((n=Jg(t,e))===null||n===void 0?void 0:n.pos)!=s.pos)i(s,e),e.preventDefault();else if(!r)return;function i(p,g){let C=Jg(t,g);const v=So.getState(t.state)==null;if(!C||!Fb(p,C))if(v)C=p;else return;const A=new Fn(p,C);if(v||!t.state.selection.eq(A)){const T=t.state.tr.setSelection(A);v&&T.setMeta(So,p.pos),t.dispatch(T)}}function c(){t.root.removeEventListener("mouseup",c),t.root.removeEventListener("dragstart",c),t.root.removeEventListener("mousemove",f),So.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(So,-1))}function f(p){const g=p,C=So.getState(t.state);let v;if(C!=null)v=t.state.doc.resolve(C);else if(BS(t,g.target)!=r&&(v=Jg(t,e),!v))return c();v&&i(v,g)}t.root.addEventListener("mouseup",c),t.root.addEventListener("dragstart",c),t.root.addEventListener("mousemove",f)}function hT(t,e,n){if(!(t.state.selection instanceof Ct))return null;const{$head:r}=t.state.selection;for(let s=r.depth-1;s>=0;s--){const i=r.node(s);if((n<0?r.index(s):r.indexAfter(s))!=(n<0?0:i.childCount))return null;if(i.type.spec.tableRole=="cell"||i.type.spec.tableRole=="header_cell"){const c=r.before(s),f=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(f)?c:null}}return null}function BS(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function Jg(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});if(!n)return null;let{inside:r,pos:s}=n;return r>=0&&Hl(t.state.doc.resolve(r))||Hl(t.state.doc.resolve(s))}var Bz=class{constructor(e,n){this.node=e,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),y2(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,y2(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function y2(t,e,n,r,s,i){let c=0,f=!0,p=e.firstChild;const g=t.firstChild;if(g){for(let v=0,A=0;v<g.childCount;v++){const{colspan:T,colwidth:_}=g.child(v).attrs;for(let M=0;M<T;M++,A++){const R=s==A?i:_&&_[M],j=R?R+"px":"";if(c+=R||r,R||(f=!1),p)p.style.width!=j&&(p.style.width=j),p=p.nextSibling;else{const H=document.createElement("col");H.style.width=j,e.appendChild(H)}}}for(;p;){var C;const v=p.nextSibling;(C=p.parentNode)===null||C===void 0||C.removeChild(p),p=v}f?(n.style.width=c+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=c+"px")}}const Hs=new ur("tableColumnResizing");function Pz({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=Bz,lastColumnResizable:s=!0}={}){const i=new qn({key:Hs,state:{init(c,f){var p;const g=(p=i.spec)===null||p===void 0||(p=p.props)===null||p===void 0?void 0:p.nodeViews,C=rs(f.schema).table.name;return r&&g&&(g[C]=(v,A)=>new r(v,n,A)),new Fz(-1,!1)},apply(c,f){return f.apply(c)}},props:{attributes:c=>{const f=Hs.getState(c);return f&&f.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(c,f)=>{zz(c,f,t,s)},mouseleave:c=>{Uz(c)},mousedown:(c,f)=>{Hz(c,f,e,n)}},decorations:c=>{const f=Hs.getState(c);if(f&&f.activeHandle>-1)return $z(c,f.activeHandle)},nodeViews:{}}});return i}var Fz=class p0{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(Hs);if(r&&r.setHandle!=null)return new p0(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new p0(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let s=e.mapping.map(n.activeHandle,-1);return x2(e.doc.resolve(s))||(s=-1),new p0(s,n.dragging)}return n}};function zz(t,e,n,r){if(!t.editable)return;const s=Hs.getState(t.state);if(s&&!s.dragging){const i=Gz(e.target);let c=-1;if(i){const{left:f,right:p}=i.getBoundingClientRect();e.clientX-f<=n?c=PS(t,e,"left",n):p-e.clientX<=n&&(c=PS(t,e,"right",n))}if(c!=s.activeHandle){if(!r&&c!==-1){const f=t.state.doc.resolve(c),p=f.node(-1),g=cr.get(p),C=f.start(-1);if(g.colCount(f.pos-C)+f.nodeAfter.attrs.colspan-1==g.width-1)return}pT(t,c)}}}function Uz(t){if(!t.editable)return;const e=Hs.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&pT(t,-1)}function Hz(t,e,n,r){var s;if(!t.editable)return!1;const i=(s=t.dom.ownerDocument.defaultView)!==null&&s!==void 0?s:window,c=Hs.getState(t.state);if(!c||c.activeHandle==-1||c.dragging)return!1;const f=t.state.doc.nodeAt(c.activeHandle),p=Vz(t,c.activeHandle,f.attrs);t.dispatch(t.state.tr.setMeta(Hs,{setDragging:{startX:e.clientX,startWidth:p}}));function g(v){i.removeEventListener("mouseup",g),i.removeEventListener("mousemove",C);const A=Hs.getState(t.state);A!=null&&A.dragging&&(Wz(t,A.activeHandle,FS(A.dragging,v,n)),t.dispatch(t.state.tr.setMeta(Hs,{setDragging:null})))}function C(v){if(!v.which)return g(v);const A=Hs.getState(t.state);if(A&&A.dragging){const T=FS(A.dragging,v,n);zS(t,A.activeHandle,T,r)}}return zS(t,c.activeHandle,p,r),i.addEventListener("mouseup",g),i.addEventListener("mousemove",C),e.preventDefault(),!0}function Vz(t,e,{colspan:n,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const i=t.domAtPos(e);let c=i.node.childNodes[i.offset].offsetWidth,f=n;if(r)for(let p=0;p<n;p++)r[p]&&(c-=r[p],f--);return c/f}function Gz(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function PS(t,e,n,r){const s=n=="right"?-r:r,i=t.posAtCoords({left:e.clientX+s,top:e.clientY});if(!i)return-1;const{pos:c}=i,f=Hl(t.state.doc.resolve(c));if(!f)return-1;if(n=="right")return f.pos;const p=cr.get(f.node(-1)),g=f.start(-1),C=p.map.indexOf(f.pos-g);return C%p.width==0?-1:g+p.map[C-1]}function FS(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function pT(t,e){t.dispatch(t.state.tr.setMeta(Hs,{setHandle:e}))}function Wz(t,e,n){const r=t.state.doc.resolve(e),s=r.node(-1),i=cr.get(s),c=r.start(-1),f=i.colCount(r.pos-c)+r.nodeAfter.attrs.colspan-1,p=t.state.tr;for(let g=0;g<i.height;g++){const C=g*i.width+f;if(g&&i.map[C]==i.map[C-i.width])continue;const v=i.map[C],A=s.nodeAt(v).attrs,T=A.colspan==1?0:f-i.colCount(v);if(A.colwidth&&A.colwidth[T]==n)continue;const _=A.colwidth?A.colwidth.slice():qz(A.colspan);_[T]=n,p.setNodeMarkup(c+v,null,{...A,colwidth:_})}p.docChanged&&t.dispatch(p)}function zS(t,e,n,r){const s=t.state.doc.resolve(e),i=s.node(-1),c=s.start(-1),f=cr.get(i).colCount(s.pos-c)+s.nodeAfter.attrs.colspan-1;let p=t.domAtPos(s.start(-1)).node;for(;p&&p.nodeName!="TABLE";)p=p.parentNode;p&&y2(i,p.firstChild,p,r,f,n)}function qz(t){return Array(t).fill(0)}function $z(t,e){const n=[],r=t.doc.resolve(e),s=r.node(-1);if(!s)return Pn.empty;const i=cr.get(s),c=r.start(-1),f=i.colCount(r.pos-c)+r.nodeAfter.attrs.colspan-1;for(let g=0;g<i.height;g++){const C=f+g*i.width;if((f==i.width-1||i.map[C]!=i.map[C+1])&&(g==0||i.map[C]!=i.map[C-i.width])){var p;const v=i.map[C],A=c+v+s.nodeAt(v).nodeSize-1,T=document.createElement("div");T.className="column-resize-handle",!((p=Hs.getState(t))===null||p===void 0)&&p.dragging&&n.push(Mr.node(c+v,c+v+s.nodeAt(v).nodeSize,{class:"column-resize-dragging"})),n.push(Mr.widget(A,T))}}return Pn.create(t.doc,n)}function Xz({allowTableNodeSelection:t=!1}={}){return new qn({key:So,state:{init(){return null},apply(e,n){const r=e.getMeta(So);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:s,pos:i}=e.mapping.mapResult(n);return s?null:i}},props:{decorations:oz,handleDOMEvents:{mousedown:jz},createSelectionBetween(e){return So.getState(e.state)!=null?e.state.selection:null},handleTripleClick:Dz,handleKeyDown:Iz,handlePaste:Lz},appendTransaction(e,n,r){return uz(r,uT(r,n),t)}})}var mT=Kr.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var e,n;const r=t.getAttribute("colwidth"),s=r?r.split(",").map(i=>parseInt(i,10)):null;if(!s){const i=(e=t.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),c=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(c&&c>-1&&i&&i[c]){const f=i[c].getAttribute("width");return f?[parseInt(f,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",Wn(this.options.HTMLAttributes,t),0]}}),gT=Kr.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",Wn(this.options.HTMLAttributes,t),0]}}),xT=Kr.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",Wn(this.options.HTMLAttributes,t),0]}});function w2(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function US(t,e,n,r,s,i){var c;let f=0,p=!0,g=e.firstChild;const C=t.firstChild;if(C!==null)for(let A=0,T=0;A<C.childCount;A+=1){const{colspan:_,colwidth:M}=C.child(A).attrs;for(let R=0;R<_;R+=1,T+=1){const j=s===T?i:M&&M[R],H=j?`${j}px`:"";if(f+=j||r,j||(p=!1),g){if(g.style.width!==H){const[G,Z]=w2(r,j);g.style.setProperty(G,Z)}g=g.nextSibling}else{const G=document.createElement("col"),[Z,J]=w2(r,j);G.style.setProperty(Z,J),e.appendChild(G)}}}for(;g;){const A=g.nextSibling;(c=g.parentNode)==null||c.removeChild(g),g=A}const v=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);p&&!v?(n.style.width=`${f}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${f}px`)}var Yz=class{constructor(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),US(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,US(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(n&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function Kz(t,e,n,r){let s=0,i=!0;const c=[],f=t.firstChild;if(!f)return{};for(let v=0,A=0;v<f.childCount;v+=1){const{colspan:T,colwidth:_}=f.child(v).attrs;for(let M=0;M<T;M+=1,A+=1){const R=n===A?r:_&&_[M];s+=R||e,R||(i=!1);const[j,H]=w2(e,R);c.push(["col",{style:`${j}: ${H}`}])}}const p=i?`${s}px`:"",g=i?"":`${s}px`;return{colgroup:["colgroup",{},...c],tableWidth:p,tableMinWidth:g}}function HS(t,e){return t.createAndFill()}function Zz(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function Jz(t,e,n,r,s){const i=Zz(t),c=[],f=[];for(let g=0;g<n;g+=1){const C=HS(i.cell);if(C&&f.push(C),r){const v=HS(i.header_cell);v&&c.push(v)}}const p=[];for(let g=0;g<e;g+=1)p.push(i.row.createChecked(null,r&&g===0?c:f));return i.table.createChecked(null,p)}function Qz(t){return t instanceof Fn}var e0=({editor:t})=>{const{selection:e}=t.state;if(!Qz(e))return!1;let n=0;const r=Jk(e.ranges[0].$from,i=>i.type.name==="table");return r==null||r.node.descendants(i=>{if(i.type.name==="table")return!1;["tableCell","tableHeader"].includes(i.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},eU="";function tU(t){return(t||"").replace(/\s+/g," ").trim()}function nU(t,e,n={}){var r;const s=(r=n.cellLineSeparator)!=null?r:eU;if(!t||!t.content||t.content.length===0)return"";const i=[];t.content.forEach(_=>{const M=[];_.content&&_.content.forEach(R=>{let j="";R.content&&Array.isArray(R.content)&&R.content.length>1?j=R.content.map(J=>e.renderChildren(J)).join(s):j=R.content?e.renderChildren(R.content):"";const H=tU(j),G=R.type==="tableHeader";M.push({text:H,isHeader:G})}),i.push(M)});const c=i.reduce((_,M)=>Math.max(_,M.length),0);if(c===0)return"";const f=new Array(c).fill(0);i.forEach(_=>{var M;for(let R=0;R<c;R+=1){const H=(((M=_[R])==null?void 0:M.text)||"").length;H>f[R]&&(f[R]=H),f[R]<3&&(f[R]=3)}});const p=(_,M)=>_+" ".repeat(Math.max(0,M-_.length)),g=i[0],C=g.some(_=>_.isHeader);let v=`
`;const A=new Array(c).fill(0).map((_,M)=>C&&g[M]&&g[M].text||"");return v+=`| ${A.map((_,M)=>p(_,f[M])).join(" | ")} |
`,v+=`| ${f.map(_=>"-".repeat(Math.max(3,_))).join(" | ")} |
`,(C?i.slice(1):i).forEach(_=>{v+=`| ${new Array(c).fill(0).map((M,R)=>p(_[R]&&_[R].text||"",f[R])).join(" | ")} |
`}),v}var rU=nU,bT=Kr.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:Yz,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=Kz(t,this.options.cellMinWidth),i=e.style;function c(){return i||(r?`width: ${r}`:`min-width: ${s}`)}const f=["table",Wn(this.options.HTMLAttributes,e,{style:c()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},f]:f},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(s=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(s.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const s=[];r.forEach(i=>{s.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(i.tokens)}]))}),n.push(e.createNode("tableRow",{},s))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>rU(t,e),addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:i})=>{const c=Jz(i.schema,t,e,n);if(s){const f=r.selection.from+1;r.replaceSelectionWith(c).scrollIntoView().setSelection(Ct.near(r.doc.resolve(f)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>hz(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>pz(t,e),deleteColumn:()=>({state:t,dispatch:e})=>gz(t,e),addRowBefore:()=>({state:t,dispatch:e})=>bz(t,e),addRowAfter:()=>({state:t,dispatch:e})=>yz(t,e),deleteRow:()=>({state:t,dispatch:e})=>vz(t,e),deleteTable:()=>({state:t,dispatch:e})=>Tz(t,e),mergeCells:()=>({state:t,dispatch:e})=>_S(t,e),splitCell:()=>({state:t,dispatch:e})=>RS(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>Zd("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>Zd("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>Nz(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>_S(t,e)?!0:RS(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>Sz(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>IS(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>IS(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&uT(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=Fn.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:e0,"Mod-Backspace":e0,Delete:e0,"Mod-Delete":e0}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Pz({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Xz({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:Cn(xt(t,"tableRole",e))}}});Tn.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(bT.configure(this.options.table)),this.options.tableCell!==!1&&t.push(mT.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(gT.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(xT.configure(this.options.tableRow)),t}});var sU=xT,iU=gT,aU=mT;const oU=/<\/?[a-z][\s\S]*>/i,lU=t=>oU.test(t),VS=t=>t.trim()?lU(t)?t:K2(t):"<p></p>",cU=[UF.configure({heading:{levels:[1,2]}}),mF,sT,ZF,bT.configure({resizable:!0}),sU,iU,aU,HF,VF.configure({nested:!0})],Ns=({active:t=!1,onClick:e,title:n,children:r})=>b.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:e,className:`p-1 md:p-1.5 rounded transition-colors ${t?"bg-[#CC561E]/15 text-[#CC561E]":"text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-800"}`,title:n,children:r}),yT=({value:t,onChange:e,autoFocus:n=!1,placeholder:r="Start writing... Use toolbar for lists, checklist, headings, and emphasis.",minHeight:s=220})=>{const[i,c]=L.useState("write"),[f,p]=L.useState("#0f172a"),g=L.useRef(!1),C={"--note-editor-min-height":`${s}px`},v=nP({extensions:L.useMemo(()=>[...cU,GF.configure({placeholder:r})],[r]),content:VS(t),autofocus:n?"end":!1,editorProps:{attributes:{class:"personal-note-prosemirror"}},onUpdate:({editor:T})=>{g.current||e(T.getHTML())}});L.useEffect(()=>{if(!v)return;const T=VS(t);v.getHTML()!==T&&(g.current=!0,v.commands.setContent(T,{emitUpdate:!1}),g.current=!1)},[v,t]);const A=L.useMemo(()=>K2(t),[t]);return b.jsxs("div",{className:"rounded-xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-950 overflow-hidden",children:[b.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:flex-wrap px-2 md:px-3 py-1.5 md:py-2 border-b border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900 gap-2 md:gap-3",children:[b.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap",children:[b.jsx(Ns,{active:!!(v!=null&&v.isActive("heading",{level:1})),onClick:()=>v==null?void 0:v.chain().focus().toggleHeading({level:1}).run(),title:"Heading 1",children:b.jsx(G_,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("heading",{level:2})),onClick:()=>v==null?void 0:v.chain().focus().toggleHeading({level:2}).run(),title:"Heading 2",children:b.jsx(q_,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("bold")),onClick:()=>v==null?void 0:v.chain().focus().toggleBold().run(),title:"Bold",children:b.jsx(ZO,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("italic")),onClick:()=>v==null?void 0:v.chain().focus().toggleItalic().run(),title:"Italic",children:b.jsx(Z_,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("underline")),onClick:()=>v==null?void 0:v.chain().focus().toggleUnderline().run(),title:"Underline",children:b.jsx(cM,{size:12,className:"md:w-3.5 md:h-3.5"})})]}),b.jsx("div",{className:"flex items-center justify-end md:justify-start gap-1",children:b.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 rounded-md border border-[#E6EAF2] dark:border-slate-700",children:[b.jsxs("button",{type:"button",onClick:()=>c("write"),className:`p-1 md:px-2 md:py-1 text-xs rounded-l-md transition-colors ${i==="write"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Write",children:[b.jsx("span",{className:"md:hidden",children:b.jsx(MC,{size:12})}),b.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[b.jsx(MC,{size:12})," Write"]})]}),b.jsxs("button",{type:"button",onClick:()=>c("preview"),className:`p-1 md:px-2 md:py-1 text-xs rounded-r-md transition-colors ${i==="preview"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Preview",children:[b.jsx("span",{className:"md:hidden",children:b.jsx(NC,{size:12})}),b.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[b.jsx(NC,{size:12})," Preview"]})]})]})}),b.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap md:flex-nowrap",children:[b.jsxs("div",{className:"inline-flex items-center gap-0.5 px-1 py-0.5 rounded border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-900",children:[b.jsx(yR,{size:11,className:"text-slate-500 md:w-3 md:h-3"}),b.jsx("input",{type:"color",value:f,onChange:T=>{const _=T.target.value;p(_),v==null||v.chain().focus().setColor(_).run()},className:"w-4 h-4 md:w-5 md:h-5 p-0 border-0 bg-transparent cursor-pointer",title:"Text Color"}),b.jsx(Ns,{active:!1,onClick:()=>v==null?void 0:v.chain().focus().unsetColor().run(),title:"Clear Text Color",children:b.jsx(N_,{size:10,className:"md:w-3 md:h-3"})})]}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("bulletList")),onClick:()=>v==null?void 0:v.chain().focus().toggleBulletList().run(),title:"Bullet List",children:b.jsx(oR,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("orderedList")),onClick:()=>v==null?void 0:v.chain().focus().toggleOrderedList().run(),title:"Numbered List",children:b.jsx(iR,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("taskList")),onClick:()=>v==null?void 0:v.chain().focus().toggleTaskList().run(),title:"Checklist",children:b.jsx(WR,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("blockquote")),onClick:()=>v==null?void 0:v.chain().focus().toggleBlockquote().run(),title:"Quote",children:b.jsx(Bd,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!!(v!=null&&v.isActive("table")),onClick:()=>v==null?void 0:v.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),title:"Insert Table",children:b.jsx(QR,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!1,onClick:()=>v==null?void 0:v.chain().focus().addRowAfter().run(),title:"Add Row",children:b.jsx(_R,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!1,onClick:()=>v==null?void 0:v.chain().focus().addColumnAfter().run(),title:"Add Column",children:b.jsx(y_,{size:12,className:"md:w-3.5 md:h-3.5"})}),b.jsx(Ns,{active:!1,onClick:()=>v==null?void 0:v.chain().focus().deleteTable().run(),title:"Delete Table",children:b.jsx(Ol,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]}),i==="write"?b.jsx("div",{className:"bg-white dark:bg-slate-950 text-slate-900 dark:text-white",style:C,children:b.jsx(A4,{editor:v})}):b.jsx("div",{className:"personal-note-render p-3 md:p-4 max-w-none text-slate-800 dark:text-slate-200",style:{minHeight:s},dangerouslySetInnerHTML:{__html:A}})]})},uU=It.lazy(()=>$c(()=>import("./KnowledgeDashboard-BCUx0K8P.js"),[]).then(t=>({default:t.KnowledgeDashboard}))),GS=t=>t.trim().toLowerCase(),yl=10,Dc=t=>t.toLocaleLowerCase("tr-TR").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"i").replace(/\s+/g," ").trim(),ks=(t,e)=>e?Dc(t).includes(e):!0,WS=({id:t,children:e})=>{const{attributes:n,listeners:r,setNodeRef:s,transform:i,isDragging:c}=_I({id:t}),f={transform:Zc.Transform.toString(i)};return b.jsx(b.Fragment,{children:e({setNodeRef:s,style:f,isDragging:c,attributes:n,listeners:r})})},Qg=({id:t,children:e})=>{const{setNodeRef:n,isOver:r}=DI({id:t});return b.jsx("div",{ref:n,children:e(r)})},dU=It.memo(({books:t,personalNoteFolders:e=[],onAddBook:n,onAddPersonalNote:r,onQuickCreatePersonalNote:s,onCreatePersonalFolder:i,onRenamePersonalFolder:c,onDeletePersonalFolder:f,onMovePersonalNote:p,onMovePersonalFolder:g,onSelectBook:C,onSelectBookWithTab:v,activeTab:A,onMobileMenuClick:T,onDeleteBook:_,onDeleteMultiple:M,onToggleFavorite:R,onToggleHighlightFavorite:j,userId:H,categoryFilter:G,onCategoryFilterChange:Z,onCategoryNavigate:J,onStatusNavigate:oe,currentPage:U,onPageChange:ee,searchQuery:X,onSearchChange:Qe,statusFilter:je,onStatusFilterChange:ue,sortOption:Ie,onSortOptionChange:Ze,publisherFilter:ne,onPublisherFilterChange:ie,onTabChange:pe})=>{const[me,Y]=L.useState(!1),le={"To Read":"bg-[#94A3B8]/15 text-[#94A3B8] border border-[#94A3B8]/40",Reading:"bg-[#38BDF8]/15 text-[#38BDF8] border border-[#38BDF8]/40",Finished:"bg-[#22C55E]/15 text-[#22C55E] border border-[#22C55E]/40"},V=A==="DASHBOARD",te=A==="NOTES",fe=A==="PERSONAL_NOTE",[ge,We]=L.useState("ALL"),[se,Be]=L.useState("ALL"),[K,Ce]=L.useState("NONE"),[Ae,ze]=L.useState(null),[rt,ot]=L.useState(!1),[gt,jt]=L.useState({PRIVATE:!0,DAILY:!0,IDEAS:!0}),[Pt,et]=L.useState({PRIVATE:yl,DAILY:yl,IDEAS:yl}),[ft,Ve]=L.useState(!1),[lt,tt]=L.useState(!1),[Xn,Lr]=L.useState("DAILY"),[on,_s]=L.useState(""),[tr,jr]=L.useState(""),[On,xn]=L.useState(null),[is,nr]=L.useState(null),[ms,ln]=L.useState(null),[He,Zt]=L.useState(null);L.useEffect(()=>{fe||(We("ALL"),Be("ALL"),Ce("NONE"),ze(null),ot(!1),jt({PRIVATE:!0,DAILY:!0,IDEAS:!0}),et({PRIVATE:yl,DAILY:yl,IDEAS:yl}),Lr("DAILY"),Ve(!1))},[fe]),L.useEffect(()=>{Ae&&ot(!0)},[Ae]);const At=TM(DC(X2,{activationConstraint:{distance:8}}),DC(JA,{activationConstraint:{delay:120,tolerance:8}})),cn=ye=>{const $=Date.now();window.innerWidth<768&&(He==null?void 0:He.noteId)===ye.id&&$-He.time<300?(Zt(null),v?v(ye,"info"):C(ye)):(Zt({noteId:ye.id,time:$}),C(ye))},bn=L.useMemo(()=>{const ye=new Map;return e.forEach($=>ye.set($.id,$)),ye},[e]);L.useEffect(()=>{if(se==="ALL"||se==="__ROOT__")return;const ye=bn.get(se);ye&&(Xn!==ye.category&&Lr(ye.category),jt($=>({...$,[ye.category]:!1})))},[se,bn,Xn]);const gs=L.useMemo(()=>{const ye=new Map;return e.forEach($=>{ye.set(`${$.category}::${$.name.toLowerCase()}`,$.id)}),ye},[e]),Br=ye=>{if(!er(ye))return;if(ye.personalFolderId)return ye.personalFolderId;const $=(ye.folderPath||"").trim();if($)return gs.get(`${es(ye)}::${$.toLowerCase()}`)},Dt=ye=>{var Ye;const $=Br(ye);return $?(Ye=bn.get($))==null?void 0:Ye.name:ye.folderPath||void 0},Gt=L.useMemo(()=>{switch(A){case"BOOK":return 24;case"ARTICLE":return 24;case"WEBSITE":return 24;case"PERSONAL_NOTE":return 30;case"NOTES":return 50;default:return 24}},[A]),[pn,Bn]=L.useState(X);L.useEffect(()=>{if(pn!==X){Y(!0);const ye=setTimeout(()=>{Qe(pn),ee(1),Y(!1)},300);return()=>clearTimeout(ye)}},[pn,X,Qe,ee]),L.useEffect(()=>{Bn(X)},[X]);const Jt=L.useMemo(()=>{if(te||V)return[];const ye=Dc(X),$=fe&&K==="RECENT"?new Set(t.filter(qe=>qe.type==="PERSONAL_NOTE"&&es(qe)!=="PRIVATE").sort((qe,mt)=>mt.addedAt-qe.addedAt).slice(0,20).map(qe=>qe.id)):null;return t.filter(qe=>{if(qe.type!==A)return!1;if(fe){const yn=es(qe);if(ge==="ALL"&&yn==="PRIVATE"||ge!=="ALL"&&yn!==ge)return!1;if(se!=="ALL"){const xe=Br(qe);if(se==="__ROOT__"){if(xe)return!1}else if(xe!==se)return!1}if(K==="FAVORITES"&&!qe.isFavorite||K==="RECENT"&&!($!=null&&$.has(qe.id))||Ae&&!new Set((qe.tags||[]).map(W=>GS(W))).has(Ae))return!1}if(G){const yn=Dc(G);if(!(qe.tags||[]).some(W=>Dc(W)===yn))return!1}let mt=!0;return je!=="ALL"&&(je==="HIGHLIGHTS"?mt=qe.highlights&&qe.highlights.length>0:je==="FAVORITES"?mt=qe.isFavorite===!0:["To Read","Reading","Finished"].includes(je)?mt=qe.readingStatus===je:A==="BOOK"?mt=qe.status===je:mt=!1),!mt||ne&&A!=="BOOK"&&!ks(qe.publisher||"",Dc(ne))?!1:!ye||ks(qe.title||"",ye)||ks(qe.author||"",ye)?!0:A==="BOOK"?!!(ks(qe.isbn||"",ye)||ks(qe.code||"",ye)):!!((qe.tags||[]).some(yn=>ks(yn,ye))||ks(Jc(qe.generalNotes||""),ye)||er(qe)&&(ks(es(qe),ye)||ks(Dt(qe)||"",ye)))}).sort((qe,mt)=>Ie==="title_asc"?qe.title.localeCompare(mt.title):Ie==="date_asc"?qe.addedAt-mt.addedAt:mt.addedAt-qe.addedAt)},[t,X,je,ne,Ie,A,te,V,G,fe,ge,se,K,Ae,bn,gs]),dn=L.useMemo(()=>t.filter(ye=>ye.type==="PERSONAL_NOTE"),[t]),de=L.useMemo(()=>dn.filter(ye=>es(ye)!=="PRIVATE"),[dn]),we=de.length,Oe=L.useMemo(()=>de.filter(ye=>ye.isFavorite).length,[de]),it=L.useMemo(()=>[...de].sort((ye,$)=>$.addedAt-ye.addedAt).slice(0,20).map(ye=>ye.id),[de]).length,nt=L.useMemo(()=>{const ye=new Map;return de.forEach($=>{const Ye=new Set;($.tags||[]).forEach(qe=>{const mt=qe.trim();if(!mt)return;const en=GS(mt);if(Ye.has(en))return;Ye.add(en);const zn=ye.get(en);if(!zn){ye.set(en,{label:mt,noteIds:new Set([$.id])});return}zn.noteIds.add($.id)})}),[...ye.entries()].map(([$,Ye])=>({key:$,label:Ye.label||$,count:Ye.noteIds.size})).sort(($,Ye)=>Ye.count-$.count||$.label.localeCompare(Ye.label)).slice(0,10)},[de]),Xe=L.useMemo(()=>{const ye={PRIVATE:0,DAILY:0,IDEAS:0};return dn.forEach($=>{ye[es($)]+=1}),ye},[dn]),ct=L.useMemo(()=>{const ye={PRIVATE:[],DAILY:[],IDEAS:[]};return e.forEach($=>{ye[$.category].push({id:$.id,name:$.name,order:$.order,count:dn.filter(Ye=>Br(Ye)===$.id).length})}),["PRIVATE","DAILY","IDEAS"].forEach($=>{ye[$].sort((Ye,qe)=>Ye.order-qe.order||Ye.name.localeCompare(qe.name))}),ye},[dn,e,gs]),ut=L.useMemo(()=>{const ye={PRIVATE:0,DAILY:0,IDEAS:0};return dn.forEach($=>{const Ye=es($);Br($)||(ye[Ye]+=1)}),ye},[dn,gs]);L.useEffect(()=>{if(se==="ALL"||se==="__ROOT__")return;const ye=["PRIVATE","DAILY","IDEAS"].find(Ye=>ct[Ye].some(qe=>qe.id===se));if(!ye)return;const $=ct[ye].findIndex(Ye=>Ye.id===se);$<0||et(Ye=>{const qe=$+1;return Ye[ye]>=qe?Ye:{...Ye,[ye]:qe}})},[se,ct]);const yt=L.useMemo(()=>{if(!te)return[];const ye=Dc(X);return t.flatMap($=>$.highlights.map(Ye=>({...Ye,source:$}))).filter($=>je==="FAVORITES"&&!$.isFavorite?!1:ye?ks($.text||"",ye)||ks($.comment||"",ye)||ks($.source.title||"",ye)||ks($.source.author||"",ye)||!!($.tags&&$.tags.some(Ye=>ks(Ye,ye))):!0).sort(($,Ye)=>Ye.createdAt-$.createdAt)},[t,te,X,je]),De=L.useMemo(()=>te?{total:yt.length,reading:0,toRead:0}:{total:Jt.length,reading:Jt.filter(ye=>ye.readingStatus==="Reading").length,toRead:Jt.filter(ye=>ye.readingStatus==="To Read").length},[te,yt.length,Jt]),Tt=ye=>{switch(ye){case"BOOK":return"Books";case"ARTICLE":return"Articles";case"WEBSITE":return"Websites";case"PERSONAL_NOTE":return"Personal Notes";case"NOTES":return"All Notes";case"DASHBOARD":return"Dashboard"}},qt=()=>te?"Search quotes...":A==="PERSONAL_NOTE"?"Search notes...":A==="ARTICLE"?"Search title, author...":A==="WEBSITE"?"Search site, URL...":"Search title, author, ISBN...",_t=ye=>{switch(ye){case"PRIVATE":return"Private";case"DAILY":return"Daily";case"IDEAS":return"Ideas";default:return ye}},Pr=async ye=>{const $=window.prompt(`${_t(ye)} klasor adi:`),Ye=$==null?void 0:$.trim();if(!Ye)return;const qe=await(i==null?void 0:i(ye,Ye));qe&&(Ce("NONE"),ze(null),We(ye),Be(qe.id),ee(1))},Si=async(ye,$)=>{const Ye=window.prompt("Yeni klasor adi:",$),qe=Ye==null?void 0:Ye.trim();!qe||qe===$||await(c==null?void 0:c(ye,qe))},ja=async ye=>{!window.confirm("Bu klasor silinsin mi? Icindeki notlar kategori kokune tasinacak.")||!await(f==null?void 0:f(ye))||se===ye&&(Ce("NONE"),ze(null),Be("__ROOT__"))},xs=(ye,$,Ye)=>{ms&&window.clearTimeout(ms.timeoutId);const qe=window.setTimeout(()=>{ln(null)},5e3);ln({noteId:ye,category:$,folderId:Ye,timeoutId:qe})},$o=async(ye,$,Ye,qe=!0)=>{const mt=dn.find(kt=>kt.id===ye);if(!mt)return;const en=es(mt),zn=Br(mt);await(p==null?void 0:p(ye,$,Ye))&&qe&&xs(ye,en,zn)},Ai=ye=>{var $;if(ye.startsWith("cat-root:"))return ye.replace("cat-root:","");if(ye.startsWith("cat-group:"))return ye.replace("cat-group:","");if(ye.startsWith("folder:")){const Ye=ye.replace("folder:","");return($=bn.get(Ye))==null?void 0:$.category}},Zr=async(ye,$)=>{const Ye=bn.get(ye);if(!Ye||Ye.category===$)return;await(g==null?void 0:g(ye,$))&&se===ye&&(We($),ee(1))},Yn=ye=>{const $=String(ye.active.id);if($.startsWith("note:")){xn($.replace("note:","")),nr(null);return}$.startsWith("folder-item:")&&(nr($.replace("folder-item:","")),xn(null))},un=()=>{xn(null),nr(null)},Ni=async ye=>{var qe;xn(null),nr(null);const $=String(ye.active.id||""),Ye=String(((qe=ye.over)==null?void 0:qe.id)||"");if(Ye){if($.startsWith("note:")){const mt=$.replace("note:",""),en=Ai(Ye);if(!en)return;const zn=Ye.startsWith("folder:")?Ye.replace("folder:",""):void 0;await $o(mt,en,zn,!0);return}if($.startsWith("folder-item:")){const mt=$.replace("folder-item:",""),en=Ai(Ye);if(!en)return;await Zr(mt,en)}}},Fr=()=>{var en,zn;const ye=tr;if(!M0(ye))return;const $=se==="ALL"||se==="__ROOT__"?void 0:se,qe=($?(en=bn.get($))==null?void 0:en.category:void 0)||Xn,mt=$?(zn=bn.get($))==null?void 0:zn.name:void 0;s==null||s({title:on.trim()||"Quick Note",content:ye,category:qe,folderId:$,folderPath:mt}),_s(""),jr("")},Kn=te?yt.length:Jt.length,Re=Math.ceil(Kn/Gt),$l=A==="ARTICLE"||A==="WEBSITE"?"dark:bg-slate-800":"dark:bg-slate-900",sn=L.useMemo(()=>{const ye=(U-1)*Gt;return Jt.slice(ye,ye+Gt)},[Jt,U,Gt]),Jr=L.useMemo(()=>{const ye=(U-1)*Gt;return yt.slice(ye,ye+Gt)},[yt,U,Gt]),Xo=L.useMemo(()=>On&&dn.find(ye=>ye.id===On)||null,[dn,On]),Qt=L.useMemo(()=>is&&bn.get(is)||null,[bn,is]),$t=()=>{if(Re<=1)return null;const ye=()=>{const $=[];if(Re<=5)for(let qe=1;qe<=Re;qe++)$.push(qe);else U<=3?$.push(1,2,3,4,"...",Re):U>=Re-2?$.push(1,"...",Re-3,Re-2,Re-1,Re):$.push(1,"...",U-1,U,U+1,"...",Re);return $};return b.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4 md:mt-12 select-none",children:[b.jsx("button",{onClick:()=>ee(Math.max(U-1,1)),disabled:U===1,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:b.jsx(Mo,{size:20})}),b.jsx("div",{className:"flex items-center gap-1",children:ye().map(($,Ye)=>b.jsx(It.Fragment,{children:$==="..."?b.jsx("span",{className:"px-2 text-slate-400",children:"..."}):b.jsx("button",{onClick:()=>ee($),className:`w-8 h-8 md:w-10 md:h-10 rounded-lg text-sm font-medium transition-colors ${U===$?"bg-[#262D40]/40 text-white shadow-md shadow-[#262D40]/12 dark:shadow-none":"text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82"}`,children:$})},Ye))}),b.jsx("button",{onClick:()=>ee(Math.min(U+1,Re)),disabled:U===Re,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:b.jsx(_A,{size:20})})]})},Wt=()=>{var ye;return V?b.jsx(It.Suspense,{fallback:b.jsx("div",{className:"flex justify-center items-center py-20",children:b.jsx(mr,{size:32,className:"animate-spin text-[#262D40]/90"})}),children:b.jsx(uU,{items:t,userId:H,onCategorySelect:$=>J==null?void 0:J($),onStatusSelect:$=>oe==null?void 0:oe($),onNavigateToTab:$=>pe==null?void 0:pe($),onMobileMenuClick:T})}):me?b.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400 animate-in fade-in duration-200",children:[b.jsx(mr,{size:32,className:"animate-spin text-[#262D40]/90 mb-4"}),b.jsx("p",{children:"Searching library..."})]}):te?Jr.length===0?b.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[b.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:b.jsx(Kc,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),b.jsx("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:"No highlights found"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:X?"Try a different search term.":"Highlights added to books appear here."})]}):b.jsxs("div",{className:"pb-10 md:pb-20",children:[b.jsx("div",{className:"columns-2 lg:columns-3 gap-2 md:gap-6 space-y-2 md:space-y-6",children:Jr.map(($,Ye)=>{var mt,en;const qe=lN($.type);return b.jsxs("div",{onClick:()=>{v?v($.source,"highlights",$.id):C($.source)},className:"break-inside-avoid p-2.5 md:p-6 rounded-xl border hover:shadow-md transition-all group cursor-pointer relative flex flex-col bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/12 dark:hover:border-[#262D40]/30",children:[b.jsx("button",{onClick:zn=>{zn.stopPropagation(),j&&j($.source.id,$.id)},className:`absolute top-2 right-2 p-1.5 rounded-full transition-all shadow-sm z-10 ${$.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:$.isFavorite?"Remove from Favorites":"Add to Favorites",children:b.jsx(Tc,{size:14,fill:$.isFavorite?"currentColor":"none"})}),b.jsx("div",{className:"mb-2 md:mb-3",children:qe?b.jsx(Kc,{className:"text-[#CC561E] fill-[#CC561E]/10 w-4 h-4 md:w-6 md:h-6"}):((mt=$.source)==null?void 0:mt.type)==="ARTICLE"?b.jsx(a0,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):((en=$.source)==null?void 0:en.type)==="WEBSITE"?b.jsx(o0,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):b.jsx(Bd,{className:"text-[#262D40]/82 fill-[#262D40]/85 w-4 h-4 md:w-6 md:h-6"})}),b.jsx("p",{className:`text-xs md:text-base leading-relaxed mb-2 md:mb-4 whitespace-pre-wrap line-clamp-[8] md:line-clamp-none font-lora ${qe?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-slate-200"}`,children:$.text}),$.tags&&$.tags.length>0&&b.jsx("div",{className:"flex flex-wrap gap-1 mb-2 md:mb-3",children:$.tags.map((zn,zr)=>b.jsxs("span",{className:"px-1.5 md:px-2 py-0.5 md:py-1 bg-[#F3F5FA] dark:bg-slate-700/50 border border-[#E6EAF2] dark:border-white/10 rounded text-[10px] md:text-xs text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[b.jsx(w0,{size:10,className:"md:w-3 md:h-3"})," ",zn]},zr))}),b.jsx("div",{className:`pt-2 md:pt-4 mt-auto flex items-center justify-between border-t ${qe?"border-[#E6EAF2]":"border-[#262D40]/50"}`,children:b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("h4",{className:"text-xs md:text-sm font-bold text-slate-900 dark:text-white truncate",children:$.source.title}),b.jsx("div",{className:"flex items-center gap-1 md:gap-2 text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:b.jsx("span",{className:"truncate max-w-[50%]",children:$.source.author})})]})})]},`${$.id}-${Ye}`)})}),$t()]}):sn.length===0&&!fe?b.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[b.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:A==="BOOK"?b.jsx(F2,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):A==="ARTICLE"?b.jsx(sf,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):A==="PERSONAL_NOTE"?b.jsx(v0,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):b.jsx(Fp,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),b.jsxs("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:["No ",Tt(A).toLowerCase()," found"]}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:X?"Try a different search term.":"Adjust filters or add a new item."})]}):b.jsxs("div",{className:"pb-10 md:pb-20",children:[fe?b.jsxs(kI,{sensors:At,collisionDetection:DM,modifiers:[$C],onDragStart:Yn,onDragCancel:un,onDragEnd:Ni,children:[b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_minmax(0,1fr)] gap-4 md:gap-6",children:[b.jsxs("aside",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl p-3 md:p-4 h-fit ${ft?"block":"hidden lg:block"}`,children:[b.jsxs("div",{className:"flex items-center justify-between mb-3",children:[b.jsxs("h3",{className:"text-xs font-bold uppercase tracking-[0.16em] text-slate-500 flex items-center gap-2",children:[b.jsx(RC,{size:14}),"Note Space"]}),b.jsx("button",{onClick:()=>Ve(!1),className:"lg:hidden text-slate-400 hover:text-slate-700",children:b.jsx(wi,{size:16})})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsxs("button",{onClick:()=>{Ce("NONE"),ze(null),We("ALL"),Be("ALL"),ee(1)},className:`w-full text-left px-2.5 py-2 rounded-lg text-sm transition-colors ${ge==="ALL"&&se==="ALL"&&K==="NONE"&&!Ae?"bg-[#262D40]/20 text-[#262D40] dark:text-white font-semibold":"hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300"}`,children:["All Notes (",we,")"]}),b.jsxs("div",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-800 p-2",children:[b.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 mb-1",children:"Smart Folders"}),b.jsxs("button",{onClick:()=>{Ce("FAVORITES"),ze(null),We("ALL"),Be("ALL"),ee(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${K==="FAVORITES"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[b.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[b.jsx(Tc,{size:12}),"Favorites"]}),b.jsx("span",{className:"text-[10px] opacity-70",children:Oe})]}),b.jsxs("button",{onClick:()=>{Ce("RECENT"),ze(null),We("ALL"),Be("ALL"),ee(1)},className:`mt-1 w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${K==="RECENT"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[b.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[b.jsx(m_,{size:12}),"Recent Notes"]}),b.jsx("span",{className:"text-[10px] opacity-70",children:it})]}),b.jsxs("div",{className:"mt-2 border-t border-[#E6EAF2] dark:border-slate-800 pt-2",children:[b.jsxs("div",{className:"flex items-center justify-between mb-1",children:[b.jsxs("button",{onClick:()=>ot($=>!$),className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 inline-flex items-center gap-1 hover:text-slate-700 dark:hover:text-slate-300",children:[b.jsx(Cl,{size:11,className:`transition-transform ${rt?"rotate-180":""}`}),"Top Tags"]}),Ae&&b.jsx("button",{onClick:()=>{ze(null),ee(1)},className:"text-[10px] text-[#CC561E] hover:underline",children:"Clear tag filter"})]}),rt&&(nt.length===0?b.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No tags yet"}):b.jsx("div",{className:"space-y-1",children:nt.map($=>b.jsxs("button",{onClick:()=>{ze($.key),ee(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${Ae===$.key?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[b.jsxs("span",{className:"truncate",children:["#",$.label]}),b.jsx("span",{className:"text-[10px] opacity-70",children:$.count})]},$.key))}))]})]}),["PRIVATE","DAILY","IDEAS"].map($=>b.jsx(Qg,{id:`cat-group:${$}`,children:Ye=>b.jsxs("div",{className:`rounded-lg border p-2 ${Ye?"border-[#CC561E]/40 bg-[#CC561E]/5":"border-[#E6EAF2] dark:border-slate-800"}`,children:[b.jsxs("div",{className:"flex items-center justify-between mb-1",children:[b.jsxs("button",{onClick:()=>{Ce("NONE"),ze(null),We($),Be("ALL"),ee(1)},className:`text-xs font-semibold uppercase tracking-wide ${ge===$&&se==="ALL"&&K==="NONE"&&!Ae?"text-[#CC561E]":"text-slate-600 dark:text-slate-300"}`,children:[_t($)," (",Xe[$],")"]}),b.jsxs("button",{onClick:()=>Pr($),className:"text-[11px] text-[#CC561E] hover:underline inline-flex items-center gap-1",children:[b.jsx(D_,{size:11}),"Folder"]})]}),b.jsx(Qg,{id:`cat-root:${$}`,children:qe=>b.jsxs("button",{onClick:()=>{Ce("NONE"),ze(null),We($),Be("__ROOT__"),ee(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors ${qe?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${ge===$&&se==="__ROOT__"&&K==="NONE"&&!Ae?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:["Unfiled (",ut[$],")"]})}),b.jsxs("div",{className:"mt-1",children:[b.jsxs("button",{onClick:()=>jt(qe=>({...qe,[$]:!qe[$]})),className:"w-full text-left px-2 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 inline-flex items-center gap-1",children:[b.jsx(Cl,{size:11,className:`transition-transform ${gt[$]?"":"rotate-180"}`}),"Folders (",ct[$].length,")"]}),!gt[$]&&b.jsxs("div",{className:"mt-1 space-y-1",children:[ct[$].length===0?b.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No folders yet"}):ct[$].slice(0,Pt[$]).map(qe=>b.jsx(Qg,{id:`folder:${qe.id}`,children:mt=>b.jsx(WS,{id:`folder-item:${qe.id}`,children:({setNodeRef:en,style:zn,isDragging:zr,attributes:kt,listeners:yn})=>b.jsxs("div",{ref:en,style:zr?void 0:zn,className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm flex items-center gap-2 ${mt?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${ge===$&&se===qe.id&&K==="NONE"&&!Ae?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"} ${zr?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[b.jsx("button",{...kt,...yn,onClick:xe=>xe.stopPropagation(),className:"p-1 rounded text-slate-400 hover:text-slate-700 cursor-grab active:cursor-grabbing",title:"Move folder",children:b.jsx(TC,{size:12})}),b.jsxs("button",{onClick:()=>{Ce("NONE"),ze(null),We($),Be(qe.id),ee(1)},className:"flex items-center gap-2 flex-1 min-w-0",children:[b.jsx(kC,{size:12}),b.jsx("span",{className:"truncate",children:qe.name})]}),b.jsx("span",{className:"text-[10px] opacity-70",children:qe.count}),b.jsx("button",{onClick:()=>Si(qe.id,qe.name),className:"text-slate-400 hover:text-slate-700",title:"Rename folder",children:b.jsx(SR,{size:12})}),b.jsx("button",{onClick:()=>ja(qe.id),className:"text-slate-400 hover:text-red-500",title:"Delete folder",children:b.jsx(Ol,{size:12})})]})})},qe.id)),ct[$].length>Pt[$]&&b.jsxs("button",{onClick:()=>et(qe=>({...qe,[$]:qe[$]+yl})),className:"w-full text-left px-2 py-1.5 rounded-md text-[11px] font-semibold text-[#CC561E] hover:bg-[#CC561E]/10",children:["Load more (",ct[$].length-Pt[$]," left)"]})]})]})]})},$))]})]}),b.jsxs("div",{className:"space-y-3",children:[b.jsxs("div",{className:"lg:hidden flex gap-2",children:[b.jsxs("button",{onClick:()=>Ve($=>!$),className:"flex-1 px-3 py-2.5 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider text-slate-600 dark:text-slate-400 shadow-sm active:scale-95 transition-all",children:[b.jsx(RC,{size:14}),"Navigator"]}),b.jsxs("button",{onClick:()=>tt(!lt),className:`flex-1 px-3 py-2.5 border rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider transition-all shadow-sm active:scale-95 ${lt?"bg-[#CC561E]/10 border-[#CC561E]/30 text-[#CC561E]":"bg-white dark:bg-slate-900 border-[#E6EAF2] dark:border-slate-800 text-slate-600 dark:text-slate-400"}`,children:[b.jsx(Cl,{size:14,className:`transition-transform duration-200 ${lt?"rotate-180":""}`}),"Capture"]})]}),b.jsxs("div",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-2xl overflow-hidden ${lt?"block":"hidden lg:block"}`,children:[b.jsxs("div",{className:`w-full flex items-center justify-between p-4 md:p-5 transition-colors ${lt?"":"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,onClick:()=>!lt&&tt(!0),children:[b.jsxs("h4",{className:"hidden lg:flex text-sm md:text-base font-semibold uppercase tracking-[0.12em] text-slate-500 items-center gap-2 cursor-pointer",onClick:$=>{$.stopPropagation(),tt(!lt)},children:[b.jsx(Cl,{size:16,className:`transition-transform duration-200 ${lt?"rotate-180":""}`}),"Quick Capture"]}),(lt||window.innerWidth>=1024)&&b.jsxs("div",{className:`flex items-center gap-2 flex-1 lg:flex-none justify-between lg:justify-end ${lt?"flex":"hidden lg:flex"}`,onClick:$=>$.stopPropagation(),children:[b.jsx("span",{className:"lg:hidden text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Quick Capture"}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("select",{value:Xn,onChange:$=>Lr($.target.value),className:"text-[11px] border border-[#E6EAF2] dark:border-slate-700 rounded-md px-2 py-1 bg-white dark:bg-slate-950 text-slate-500 outline-none",children:[b.jsx("option",{value:"DAILY",children:"Daily"}),b.jsx("option",{value:"PRIVATE",children:"Private"}),b.jsx("option",{value:"IDEAS",children:"Ideas"})]}),K==="NONE"&&se!=="ALL"&&se!=="__ROOT__"&&b.jsxs("span",{className:"hidden sm:inline text-[11px] text-slate-400",children:["/ ",((ye=bn.get(se))==null?void 0:ye.name)||se]})]})]})]}),lt&&b.jsxs("div",{className:"px-4 pb-4 md:px-5 md:pb-5 pt-0 animate-in slide-in-from-top-2 duration-200",children:[b.jsx("input",{value:on,onChange:$=>_s($.target.value),placeholder:"Note title (optional)",className:"w-full mb-3 border border-[#E6EAF2] dark:border-slate-700 rounded-xl px-4 py-3 text-sm md:text-base bg-white dark:bg-slate-950 block"}),b.jsx("div",{className:"w-full",children:b.jsx(yT,{value:tr,onChange:jr,autoFocus:fe,placeholder:"Start writing immediately...",minHeight:242},"quick-capture-editor")}),b.jsx("div",{className:"mt-3 flex justify-end w-full",children:b.jsx("button",{onClick:Fr,disabled:!M0(tr),className:"px-4 py-2 rounded-lg bg-[#262D40] text-white text-sm md:text-base disabled:opacity-40",children:"Save Quick Note"})})]})]}),sn.length===0?b.jsxs("div",{className:"text-center py-10 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[b.jsx(v0,{size:26,className:"mx-auto mb-2 text-slate-300"}),b.jsx("h3",{className:"text-base font-medium text-slate-900 dark:text-white",children:"No notes matched this filter"}),b.jsx("p",{className:"text-xs md:text-sm text-slate-500 mt-1",children:"Change category/folder filter or create a new note."})]}):b.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-2 md:gap-4",children:sn.map($=>{const Ye=Jc($.generalNotes||"");return b.jsx(WS,{id:`note:${$.id}`,children:({setNodeRef:qe,style:mt,isDragging:en,attributes:zn,listeners:zr})=>b.jsxs("div",{ref:qe,style:en?void 0:mt,onClick:()=>cn($),className:`bg-white dark:bg-slate-800 p-2.5 md:p-5 rounded-xl border border-[#E6EAF2] dark:border-slate-800 hover:border-[#262D40]/20 dark:hover:border-[#262D40]/30 hover:shadow-md transition-all cursor-pointer flex flex-col group relative ${en||On===$.id?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[b.jsx("div",{className:"absolute top-2 left-2 z-10",children:b.jsx("button",{...zn,...zr,onClick:kt=>kt.stopPropagation(),className:"p-1.5 rounded-full bg-white/85 dark:bg-slate-800/85 text-slate-400 hover:text-slate-700 shadow-sm",title:"Drag note",children:b.jsx(TC,{size:13})})}),b.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 z-10",children:[b.jsx("button",{onClick:kt=>{kt.stopPropagation(),R($.id)},className:`p-1.5 rounded-full transition-all shadow-sm ${$.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:$.isFavorite?"Remove from Favorites":"Add to Favorites",children:b.jsx(Tc,{size:14,fill:$.isFavorite?"currentColor":"none"})}),b.jsx("button",{onClick:kt=>{kt.stopPropagation(),_($.id)},className:"p-1.5 bg-white/80 dark:bg-slate-800/80 hover:bg-[#F3F5FA] dark:hover:bg-slate-700 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 shadow-sm",title:"Delete Note",children:b.jsx(Ol,{size:14})})]}),b.jsx("h3",{className:"font-bold text-sm md:text-base text-slate-900 dark:text-white mb-2 leading-tight pl-8 pr-8",children:$.title}),b.jsxs("div",{className:"text-slate-600 dark:text-slate-300 text-xs md:text-sm whitespace-pre-wrap leading-relaxed max-h-[180px] overflow-hidden relative font-lora mb-3",children:[Ye||b.jsx("span",{className:"italic text-slate-400 dark:text-slate-500",children:"Empty"}),Ye.length>140&&b.jsx("div",{className:"absolute bottom-0 inset-x-0 h-8 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),b.jsxs("div",{className:"mt-auto pt-2 flex flex-wrap gap-1.5 border-t border-slate-100 dark:border-slate-800 items-center",children:[b.jsx("span",{className:"px-2 py-0.5 bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs rounded border border-[#CC561E]/20 font-semibold",children:es($)}),Dt($)&&b.jsx("span",{className:"px-2 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700 truncate max-w-[150px]",children:Dt($)}),b.jsxs("span",{className:"ml-auto text-[10px] md:text-xs text-slate-400 flex items-center gap-1",children:[b.jsx(Xc,{size:10,className:"md:w-3 md:h-3"}),new Date($.addedAt).toLocaleDateString()]})]})]})},$.id)})})]})]}),b.jsx($I,{modifiers:[$C],children:Xo?b.jsxs("div",{className:"w-[320px] max-w-[80vw] bg-white dark:bg-slate-800 p-3 rounded-xl border border-[#CC561E]/35 shadow-xl cursor-grabbing",children:[b.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:Xo.title}),b.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-300 truncate",children:_t(es(Xo))})]}):Qt?b.jsxs("div",{className:"w-[220px] max-w-[70vw] bg-white dark:bg-slate-900 px-3 py-2 rounded-lg border border-[#CC561E]/35 shadow-xl cursor-grabbing flex items-center gap-2",children:[b.jsx(kC,{size:13,className:"text-slate-500"}),b.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 truncate",children:Qt.name})]}):null})]}):b.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 md:gap-6",children:sn.map($=>b.jsxs("div",{onClick:()=>C($),className:`bg-white ${$l} rounded-xl border border-[#E6EAF2] dark:border-slate-800 overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all cursor-pointer group flex flex-col h-full relative`,children:[b.jsxs("div",{className:"h-[122px] md:h-40 bg-[#F3F5FA] dark:bg-slate-800 relative flex items-end justify-between overflow-hidden group-hover:opacity-95 transition-opacity",children:[b.jsxs("div",{className:"absolute top-2 right-2 z-40 flex gap-1",children:[b.jsx("button",{onClick:Ye=>{Ye.stopPropagation(),R($.id)},className:`p-1.5 rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all ${$.isFavorite?"bg-amber-100/90 dark:bg-amber-900/80 text-amber-500 dark:text-amber-400 opacity-100":"bg-white/90 dark:bg-slate-900/90 text-slate-400 dark:text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:$.isFavorite?"Remove from Favorites":"Add to Favorites",children:b.jsx(Tc,{size:14,className:"md:w-4 md:h-4",fill:$.isFavorite?"currentColor":"none"})}),b.jsx("button",{onClick:Ye=>{Ye.stopPropagation(),_($.id)},className:"p-1.5 bg-white/90 dark:bg-slate-900/90 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:"Delete Item",children:b.jsx(Ol,{size:14,className:"md:w-4 md:h-4"})}),$.isIngested&&b.jsx("div",{className:"p-1.5 bg-[#262D40]/90 dark:bg-[#262D40]/90 text-white rounded-full shadow-sm backdrop-blur-sm border border-[#262D40]/50 dark:border-[#262D40]/50 transition-all z-40",title:"Added to AI Library",children:b.jsx(jd,{size:14,className:"md:w-4 md:h-4",fill:"currentColor"})})]}),b.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#F3F5FA] dark:bg-slate-800 transition-colors group-hover:bg-[#EDF1F8] dark:group-hover:bg-slate-700",children:b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-[#262D40]/20 blur-2xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),b.jsx("div",{className:"relative p-4 rounded-full",children:$.type==="BOOK"?b.jsx(Bx,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):$.type==="ARTICLE"?b.jsx(a0,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):b.jsx(o0,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"})})]})}),$.type==="BOOK"&&$.coverUrl&&b.jsxs(b.Fragment,{children:[b.jsx("img",{src:$.coverUrl,alt:$.title,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 z-10",onError:Ye=>{Ye.currentTarget.style.display="none";const qe=Ye.currentTarget.nextElementSibling;qe&&qe.classList.add("hidden")}}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/80 via-slate-900/20 to-transparent z-20 pointer-events-none"})]}),$.type!=="BOOK"&&b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-transparent z-20 pointer-events-none"}),b.jsxs("div",{className:"relative z-30 p-1.5 md:p-4 w-full flex justify-between items-end",children:[b.jsx("div",{className:`text-[8px] md:text-xs font-bold px-1 md:px-2 py-0.5 md:py-1 rounded shadow-sm backdrop-blur-md ${$.type==="BOOK"&&$.coverUrl||$.type!=="BOOK"?"bg-white/90 dark:bg-slate-900/90 text-slate-900 dark:text-white border border-white/50 dark:border-slate-700":le[$.readingStatus]}`,children:$.readingStatus}),b.jsxs("div",{className:"flex gap-0.5 md:gap-1",children:[$.type==="BOOK"&&$.status==="Lent Out"&&b.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F59E0B] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lent Out",children:b.jsx(To,{size:10,className:"md:w-3 md:h-3"})}),$.type==="BOOK"&&$.status==="Lost"&&b.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F43F5E] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lost",children:b.jsx(To,{size:10,className:"md:w-3 md:h-3"})})]})]})]}),b.jsxs("div",{className:"p-2.5 md:p-5 flex-1 flex flex-col",children:[b.jsx("h3",{className:"font-bold text-sm md:text-lg text-slate-900 dark:text-white leading-tight mb-0.5 md:mb-1 line-clamp-2 group-hover:text-[#262D40] dark:group-hover:text-[#262D40] transition-colors",children:$.title}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mb-2 md:mb-4 line-clamp-1",children:$.author}),b.jsxs("div",{className:"mt-auto pt-2 md:pt-4 border-t border-slate-50 dark:border-slate-800 flex justify-between items-center text-[10px] md:text-xs text-slate-400 dark:text-slate-500",children:[b.jsx("span",{className:"truncate max-w-[70%]",children:$.type==="BOOK"?$.publisher||"":$.type==="ARTICLE"?$.publisher||"Journal":(()=>{try{return $.url?new URL($.url).hostname:"Web"}catch{return"Web"}})()}),$.type==="ARTICLE"&&$.publicationYear&&b.jsx("span",{className:"bg-[#F3F5FA] dark:bg-slate-800 px-1.5 py-0.5 rounded text-slate-500 dark:text-slate-400 font-mono",children:$.publicationYear}),$.type==="WEBSITE"&&$.url&&b.jsx("a",{href:$.url,target:"_blank",rel:"noreferrer",className:"text-[#262D40]/70 hover:text-[#262D40]",onClick:Ye=>Ye.stopPropagation(),children:b.jsx(Pp,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]})]},$.id))}),$t()]})},ki=(ye=>{switch(ye){case"DASHBOARD":return sN;case"NOTES":return iN;case"BOOK":return Bx;case"ARTICLE":return a0;case"WEBSITE":return o0;case"PERSONAL_NOTE":return aN;default:return LA}})(A);return b.jsxs("div",{className:"max-w-6xl w-full mx-auto p-3 md:p-8 lg:p-10 animate-in fade-in duration-500",children:[!V&&b.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-8 gap-2",children:[b.jsxs("div",{className:"flex items-center gap-2 md:gap-4 overflow-hidden flex-1",children:[b.jsx("button",{onClick:T,className:"lg:hidden p-1 -ml-1 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 rounded-lg transition-colors shrink-0",children:b.jsx(pR,{size:18,className:"md:w-6 md:h-6"})}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"hidden md:flex p-2 bg-[#262D40] rounded-xl border border-[#262D40]/80 shadow-sm",children:b.jsx(ki,{size:24,className:"text-white"})}),b.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[b.jsx("h1",{className:"text-lg md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight leading-none truncate",children:Tt(A)}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-[10px] md:text-sm md:mt-1 font-medium truncate",children:te?`${De.total} Highlights`:fe?`${De.total} Notes`:`${De.total} Items  ${De.reading} Reading`})]})]})]}),b.jsx("div",{className:"flex gap-2",children:b.jsxs("button",{onClick:()=>{var ye;if(fe&&r){const $=ge==="ALL"?"DAILY":ge,Ye=se==="ALL"||se==="__ROOT__"?void 0:se;r({category:$,folderId:Ye,folderPath:Ye?(ye=bn.get(Ye))==null?void 0:ye.name:void 0});return}n()},className:"bg-[#262D40] text-white px-2 py-1.5 md:px-5 md:py-2.5 rounded-lg hover:bg-[#1d2333] transition-all flex items-center gap-1 shadow-md shadow-[#262D40]/20 dark:shadow-none font-medium shrink-0 active:scale-95",children:[b.jsx(Ix,{size:14,className:"md:w-5 md:h-5"}),b.jsxs("span",{className:"text-[10px] md:text-base",children:["Add ",A==="ARTICLE"?"Article":A==="WEBSITE"?"Web":A==="PERSONAL_NOTE"?"Note":"Book"]})]})})]}),!V&&b.jsxs("div",{className:"bg-white dark:bg-slate-900 p-1.5 md:p-4 rounded-xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 mb-2 md:mb-8 flex flex-col md:flex-row gap-2 md:gap-4 w-full",children:[b.jsxs("div",{className:"flex-1 relative",children:[b.jsx(Ea,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-5 md:h-5"}),b.jsx("input",{type:"text",placeholder:qt(),value:pn,onChange:ye=>Bn(ye.target.value),className:`w-full pl-7 md:pl-10 ${te||fe?"pr-10":"pr-4"} md:pr-4 py-1 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] focus:border-transparent outline-none transition-all text-[11px] md:text-base bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500`}),me&&b.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:b.jsx(mr,{size:16,className:"animate-spin text-[#CC561E]"})}),(te||fe)&&b.jsx("button",{onClick:()=>ue(je==="FAVORITES"?"ALL":"FAVORITES"),className:`md:hidden absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-lg border transition-all flex items-center justify-center shrink-0 ${je==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500"}`,title:je==="FAVORITES"?"Show All":"Show Favorites Only",children:b.jsx(Tc,{size:14,fill:je==="FAVORITES"?"currentColor":"none"})})]}),(te||fe)&&b.jsx("button",{onClick:()=>ue(je==="FAVORITES"?"ALL":"FAVORITES"),className:`hidden md:flex p-2 rounded-lg border transition-all items-center justify-center shrink-0 ${je==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-700"}`,title:je==="FAVORITES"?"Show All":"Show Favorites Only",children:b.jsx(Tc,{size:20,className:"md:w-5 md:h-5",fill:je==="FAVORITES"?"currentColor":"none"})}),!te&&!fe&&b.jsxs("div",{className:"grid grid-cols-2 md:flex gap-2 items-center",children:[b.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[b.jsx(B_,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),b.jsxs("select",{value:je,onChange:ye=>{ue(ye.target.value),ee(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[b.jsx("option",{value:"ALL",children:"All"}),b.jsx("option",{value:"FAVORITES",children:"Favorites"}),b.jsx("option",{value:"HIGHLIGHTS",children:"Highlight"}),b.jsxs("optgroup",{label:"Status",children:[b.jsx("option",{value:"To Read",children:"To Read"}),b.jsx("option",{value:"Reading",children:"Reading"}),b.jsx("option",{value:"Finished",children:"Finished"})]}),A==="BOOK"&&b.jsxs("optgroup",{label:"Inventory",children:[b.jsx("option",{value:"On Shelf",children:"On Shelf"}),b.jsx("option",{value:"Lent Out",children:"Lent Out"}),b.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),b.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[b.jsx(YO,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),b.jsxs("select",{value:Ie,onChange:ye=>{Ze(ye.target.value),ee(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[b.jsx("option",{value:"date_desc",children:"Newest"}),b.jsx("option",{value:"date_asc",children:"Oldest"}),b.jsx("option",{value:"title_asc",children:"A-Z"})]})]}),A==="BOOK"&&b.jsxs("div",{className:"relative min-w-[140px] md:min-w-[180px]",children:[b.jsx(w0,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),b.jsxs("select",{value:G||"",onChange:ye=>Z==null?void 0:Z(ye.target.value||null),className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[b.jsx("option",{value:"",children:"All categories"}),_0.map(ye=>b.jsx("option",{value:ye,children:ye},ye))]})]}),A==="ARTICLE"&&b.jsx("input",{type:"text",placeholder:"Journal...",value:ne,onChange:ye=>{ie(ye.target.value),ee(1)},className:"hidden md:block px-4 py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] text-sm min-w-[140px] bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500"})]})]}),A==="BOOK"&&!V&&G&&b.jsxs("div",{className:"flex items-center gap-2 mb-4 md:mb-6",children:[b.jsx("span",{className:"text-xs md:text-sm text-slate-500",children:"Category:"}),b.jsxs("button",{className:"flex items-center gap-2 px-3 py-1 bg-[rgba(204,86,30,0.1)] text-[#CC561E] rounded-full text-xs md:text-sm border border-[#CC561E]/20 shadow-sm",onClick:()=>Z==null?void 0:Z(null),children:[b.jsx("span",{className:"font-semibold",children:G}),b.jsx(wi,{size:14})]})]}),Wt(),fe&&ms&&b.jsxs("div",{className:"fixed bottom-5 right-5 z-50 bg-[#262D40] text-white px-4 py-3 rounded-xl shadow-xl border border-white/10 flex items-center gap-3",children:[b.jsx("span",{className:"text-sm",children:"Note moved."}),b.jsx("button",{onClick:()=>{window.clearTimeout(ms.timeoutId);const ye=ms;ln(null),$o(ye.noteId,ye.category,ye.folderId,!1)},className:"text-sm font-semibold text-[#FFB58D] hover:text-white",children:"Undo"})]})]})});var at;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(at||(at={}));var qS=new Map([[at.QR_CODE,"QR_CODE"],[at.AZTEC,"AZTEC"],[at.CODABAR,"CODABAR"],[at.CODE_39,"CODE_39"],[at.CODE_93,"CODE_93"],[at.CODE_128,"CODE_128"],[at.DATA_MATRIX,"DATA_MATRIX"],[at.MAXICODE,"MAXICODE"],[at.ITF,"ITF"],[at.EAN_13,"EAN_13"],[at.EAN_8,"EAN_8"],[at.PDF_417,"PDF_417"],[at.RSS_14,"RSS_14"],[at.RSS_EXPANDED,"RSS_EXPANDED"],[at.UPC_A,"UPC_A"],[at.UPC_E,"UPC_E"],[at.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),$S;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})($S||($S={}));function fU(t){return Object.values(at).includes(t)}var Ep;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ep||(Ep={}));var hU=(function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[Ep.SCAN_TYPE_CAMERA,Ep.SCAN_TYPE_FILE],t})(),wT=(function(){function t(e,n){this.format=e,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!qS.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,qS.get(e))},t})(),XS=(function(){function t(){}return t.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t})(),v2;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(v2||(v2={}));var pU=(function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:v2.UNKWOWN_ERROR}},t})(),mU=(function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t})();function wa(t){return typeof t>"u"||t===null}var Bc=(function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t})(),vT=(function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var r=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(s),c=Object.keys(e),f=0,p=c;f<p.length;f++){var g=p[f];if(i.has(g))return n.logError("".concat(g," is not supported videoConstaints."),!0),!1}return!0},t})(),gd={exports:{}},gU=gd.exports,YS;function xU(){return YS||(YS=1,(function(t,e){(function(n,r){r(e)})(gU,(function(n){function r(B){return B==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,o){B.__proto__=o}||function(B,o){for(var u in o)o.hasOwnProperty(u)&&(B[u]=o[u])};function i(B,o){s(B,o);function u(){this.constructor=B}B.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}function c(B,o){var u=Object.setPrototypeOf;u?u(B,o):B.__proto__=o}function f(B,o){o===void 0&&(o=B.constructor);var u=Error.captureStackTrace;u&&u(B,o)}var p=(function(B){i(o,B);function o(u){var d=this.constructor,m=B.call(this,u)||this;return Object.defineProperty(m,"name",{value:d.name,enumerable:!1}),c(m,d.prototype),f(m),m}return o})(Error);class g extends p{constructor(o=void 0){super(o),this.message=o}getKind(){return this.constructor.kind}}g.kind="Exception";class C extends g{}C.kind="ArgumentException";class v extends g{}v.kind="IllegalArgumentException";class A{constructor(o){if(this.binarizer=o,o===null)throw new v("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(o,u){return this.binarizer.getBlackRow(o,u)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(o,u,d,m){const x=this.binarizer.getLuminanceSource().crop(o,u,d,m);return new A(this.binarizer.createBinarizer(x))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new A(this.binarizer.createBinarizer(o))}rotateCounterClockwise45(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new A(this.binarizer.createBinarizer(o))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class T extends g{static getChecksumInstance(){return new T}}T.kind="ChecksumException";class _{constructor(o){this.source=o}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class M{static arraycopy(o,u,d,m,x){for(;x--;)d[m++]=o[u++]}static currentTimeMillis(){return Date.now()}}class R extends g{}R.kind="IndexOutOfBoundsException";class j extends R{constructor(o=void 0,u=void 0){super(u),this.index=o,this.message=u}}j.kind="ArrayIndexOutOfBoundsException";class H{static fill(o,u){for(let d=0,m=o.length;d<m;d++)o[d]=u}static fillWithin(o,u,d,m){H.rangeCheck(o.length,u,d);for(let x=u;x<d;x++)o[x]=m}static rangeCheck(o,u,d){if(u>d)throw new v("fromIndex("+u+") > toIndex("+d+")");if(u<0)throw new j(u);if(d>o)throw new j(d)}static asList(...o){return o}static create(o,u,d){return Array.from({length:o}).map(x=>Array.from({length:u}).fill(d))}static createInt32Array(o,u,d){return Array.from({length:o}).map(x=>Int32Array.from({length:u}).fill(d))}static equals(o,u){if(!o||!u||!o.length||!u.length||o.length!==u.length)return!1;for(let d=0,m=o.length;d<m;d++)if(o[d]!==u[d])return!1;return!0}static hashCode(o){if(o===null)return 0;let u=1;for(const d of o)u=31*u+d;return u}static fillUint8Array(o,u){for(let d=0;d!==o.length;d++)o[d]=u}static copyOf(o,u){return o.slice(0,u)}static copyOfUint8Array(o,u){if(o.length<=u){const d=new Uint8Array(u);return d.set(o),d}return o.slice(0,u)}static copyOfRange(o,u,d){const m=d-u,x=new Int32Array(m);return M.arraycopy(o,u,x,0,m),x}static binarySearch(o,u,d){d===void 0&&(d=H.numberComparator);let m=0,x=o.length-1;for(;m<=x;){const w=x+m>>1,E=d(u,o[w]);if(E>0)m=w+1;else if(E<0)x=w-1;else return w}return-m-1}static numberComparator(o,u){return o-u}}class G{static numberOfTrailingZeros(o){let u;if(o===0)return 32;let d=31;return u=o<<16,u!==0&&(d-=16,o=u),u=o<<8,u!==0&&(d-=8,o=u),u=o<<4,u!==0&&(d-=4,o=u),u=o<<2,u!==0&&(d-=2,o=u),d-(o<<1>>>31)}static numberOfLeadingZeros(o){if(o===0)return 32;let u=1;return o>>>16||(u+=16,o<<=16),o>>>24||(u+=8,o<<=8),o>>>28||(u+=4,o<<=4),o>>>30||(u+=2,o<<=2),u-=o>>>31,u}static toHexString(o){return o.toString(16)}static toBinaryString(o){return String(parseInt(String(o),2))}static bitCount(o){return o=o-(o>>>1&1431655765),o=(o&858993459)+(o>>>2&858993459),o=o+(o>>>4)&252645135,o=o+(o>>>8),o=o+(o>>>16),o&63}static truncDivision(o,u){return Math.trunc(o/u)}static parseInt(o,u=void 0){return parseInt(o,u)}}G.MIN_VALUE_32_BITS=-2147483648,G.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Z{constructor(o,u){o===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=o,u==null?this.bits=Z.makeArray(o):this.bits=u)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(o){if(o>this.bits.length*32){const u=Z.makeArray(o);M.arraycopy(this.bits,0,u,0,this.bits.length),this.bits=u}}get(o){return(this.bits[Math.floor(o/32)]&1<<(o&31))!==0}set(o){this.bits[Math.floor(o/32)]|=1<<(o&31)}flip(o){this.bits[Math.floor(o/32)]^=1<<(o&31)}getNextSet(o){const u=this.size;if(o>=u)return u;const d=this.bits;let m=Math.floor(o/32),x=d[m];x&=~((1<<(o&31))-1);const w=d.length;for(;x===0;){if(++m===w)return u;x=d[m]}const E=m*32+G.numberOfTrailingZeros(x);return E>u?u:E}getNextUnset(o){const u=this.size;if(o>=u)return u;const d=this.bits;let m=Math.floor(o/32),x=~d[m];x&=~((1<<(o&31))-1);const w=d.length;for(;x===0;){if(++m===w)return u;x=~d[m]}const E=m*32+G.numberOfTrailingZeros(x);return E>u?u:E}setBulk(o,u){this.bits[Math.floor(o/32)]=u}setRange(o,u){if(u<o||o<0||u>this.size)throw new v;if(u===o)return;u--;const d=Math.floor(o/32),m=Math.floor(u/32),x=this.bits;for(let w=d;w<=m;w++){const E=w>d?0:o&31,O=(2<<(w<m?31:u&31))-(1<<E);x[w]|=O}}clear(){const o=this.bits.length,u=this.bits;for(let d=0;d<o;d++)u[d]=0}isRange(o,u,d){if(u<o||o<0||u>this.size)throw new v;if(u===o)return!0;u--;const m=Math.floor(o/32),x=Math.floor(u/32),w=this.bits;for(let E=m;E<=x;E++){const N=E>m?0:o&31,I=(2<<(E<x?31:u&31))-(1<<N)&4294967295;if((w[E]&I)!==(d?I:0))return!1}return!0}appendBit(o){this.ensureCapacity(this.size+1),o&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(o,u){if(u<0||u>32)throw new v("Num bits must be between 0 and 32");this.ensureCapacity(this.size+u);for(let d=u;d>0;d--)this.appendBit((o>>d-1&1)===1)}appendBitArray(o){const u=o.size;this.ensureCapacity(this.size+u);for(let d=0;d<u;d++)this.appendBit(o.get(d))}xor(o){if(this.size!==o.size)throw new v("Sizes don't match");const u=this.bits;for(let d=0,m=u.length;d<m;d++)u[d]^=o.bits[d]}toBytes(o,u,d,m){for(let x=0;x<m;x++){let w=0;for(let E=0;E<8;E++)this.get(o)&&(w|=1<<7-E),o++;u[d+x]=w}}getBitArray(){return this.bits}reverse(){const o=new Int32Array(this.bits.length),u=Math.floor((this.size-1)/32),d=u+1,m=this.bits;for(let x=0;x<d;x++){let w=m[x];w=w>>1&1431655765|(w&1431655765)<<1,w=w>>2&858993459|(w&858993459)<<2,w=w>>4&252645135|(w&252645135)<<4,w=w>>8&16711935|(w&16711935)<<8,w=w>>16&65535|(w&65535)<<16,o[u-x]=w}if(this.size!==d*32){const x=d*32-this.size;let w=o[0]>>>x;for(let E=1;E<d;E++){const N=o[E];w|=N<<32-x,o[E-1]=w,w=N>>>x}o[d-1]=w}this.bits=o}static makeArray(o){return new Int32Array(Math.floor((o+31)/32))}equals(o){if(!(o instanceof Z))return!1;const u=o;return this.size===u.size&&H.equals(this.bits,u.bits)}hashCode(){return 31*this.size+H.hashCode(this.bits)}toString(){let o="";for(let u=0,d=this.size;u<d;u++)(u&7)===0&&(o+=" "),o+=this.get(u)?"X":".";return o}clone(){return new Z(this.size,this.bits.slice())}}var J;(function(B){B[B.OTHER=0]="OTHER",B[B.PURE_BARCODE=1]="PURE_BARCODE",B[B.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",B[B.TRY_HARDER=3]="TRY_HARDER",B[B.CHARACTER_SET=4]="CHARACTER_SET",B[B.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",B[B.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",B[B.ASSUME_GS1=7]="ASSUME_GS1",B[B.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",B[B.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",B[B.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(J||(J={}));var oe=J;class U extends g{static getFormatInstance(){return new U}}U.kind="FormatException";var ee;(function(B){B[B.Cp437=0]="Cp437",B[B.ISO8859_1=1]="ISO8859_1",B[B.ISO8859_2=2]="ISO8859_2",B[B.ISO8859_3=3]="ISO8859_3",B[B.ISO8859_4=4]="ISO8859_4",B[B.ISO8859_5=5]="ISO8859_5",B[B.ISO8859_6=6]="ISO8859_6",B[B.ISO8859_7=7]="ISO8859_7",B[B.ISO8859_8=8]="ISO8859_8",B[B.ISO8859_9=9]="ISO8859_9",B[B.ISO8859_10=10]="ISO8859_10",B[B.ISO8859_11=11]="ISO8859_11",B[B.ISO8859_13=12]="ISO8859_13",B[B.ISO8859_14=13]="ISO8859_14",B[B.ISO8859_15=14]="ISO8859_15",B[B.ISO8859_16=15]="ISO8859_16",B[B.SJIS=16]="SJIS",B[B.Cp1250=17]="Cp1250",B[B.Cp1251=18]="Cp1251",B[B.Cp1252=19]="Cp1252",B[B.Cp1256=20]="Cp1256",B[B.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",B[B.UTF8=22]="UTF8",B[B.ASCII=23]="ASCII",B[B.Big5=24]="Big5",B[B.GB18030=25]="GB18030",B[B.EUC_KR=26]="EUC_KR"})(ee||(ee={}));class X{constructor(o,u,d,...m){this.valueIdentifier=o,this.name=d,typeof u=="number"?this.values=Int32Array.from([u]):this.values=u,this.otherEncodingNames=m,X.VALUE_IDENTIFIER_TO_ECI.set(o,this),X.NAME_TO_ECI.set(d,this);const x=this.values;for(let w=0,E=x.length;w!==E;w++){const N=x[w];X.VALUES_TO_ECI.set(N,this)}for(const w of m)X.NAME_TO_ECI.set(w,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(o){if(o<0||o>=900)throw new U("incorect value");const u=X.VALUES_TO_ECI.get(o);if(u===void 0)throw new U("incorect value");return u}static getCharacterSetECIByName(o){const u=X.NAME_TO_ECI.get(o);if(u===void 0)throw new U("incorect value");return u}equals(o){if(!(o instanceof X))return!1;const u=o;return this.getName()===u.getName()}}X.VALUE_IDENTIFIER_TO_ECI=new Map,X.VALUES_TO_ECI=new Map,X.NAME_TO_ECI=new Map,X.Cp437=new X(ee.Cp437,Int32Array.from([0,2]),"Cp437"),X.ISO8859_1=new X(ee.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),X.ISO8859_2=new X(ee.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),X.ISO8859_3=new X(ee.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),X.ISO8859_4=new X(ee.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),X.ISO8859_5=new X(ee.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),X.ISO8859_6=new X(ee.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),X.ISO8859_7=new X(ee.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),X.ISO8859_8=new X(ee.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),X.ISO8859_9=new X(ee.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),X.ISO8859_10=new X(ee.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),X.ISO8859_11=new X(ee.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),X.ISO8859_13=new X(ee.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),X.ISO8859_14=new X(ee.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),X.ISO8859_15=new X(ee.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),X.ISO8859_16=new X(ee.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),X.SJIS=new X(ee.SJIS,20,"SJIS","Shift_JIS"),X.Cp1250=new X(ee.Cp1250,21,"Cp1250","windows-1250"),X.Cp1251=new X(ee.Cp1251,22,"Cp1251","windows-1251"),X.Cp1252=new X(ee.Cp1252,23,"Cp1252","windows-1252"),X.Cp1256=new X(ee.Cp1256,24,"Cp1256","windows-1256"),X.UnicodeBigUnmarked=new X(ee.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),X.UTF8=new X(ee.UTF8,26,"UTF8","UTF-8"),X.ASCII=new X(ee.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),X.Big5=new X(ee.Big5,28,"Big5"),X.GB18030=new X(ee.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),X.EUC_KR=new X(ee.EUC_KR,30,"EUC_KR","EUC-KR");class Qe extends g{}Qe.kind="UnsupportedOperationException";class je{static decode(o,u){const d=this.encodingName(u);return this.customDecoder?this.customDecoder(o,d):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(d)?this.decodeFallback(o,d):new TextDecoder(d).decode(o)}static shouldDecodeOnFallback(o){return!je.isBrowser()&&o==="ISO-8859-1"}static encode(o,u){const d=this.encodingName(u);return this.customEncoder?this.customEncoder(o,d):typeof TextEncoder>"u"?this.encodeFallback(o):new TextEncoder().encode(o)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(o){return typeof o=="string"?o:o.getName()}static encodingCharacterSet(o){return o instanceof X?o:X.getCharacterSetECIByName(o)}static decodeFallback(o,u){const d=this.encodingCharacterSet(u);if(je.isDecodeFallbackSupported(d)){let m="";for(let x=0,w=o.length;x<w;x++){let E=o[x].toString(16);E.length<2&&(E="0"+E),m+="%"+E}return decodeURIComponent(m)}if(d.equals(X.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(o.buffer));throw new Qe(`Encoding ${this.encodingName(u)} not supported by fallback.`)}static isDecodeFallbackSupported(o){return o.equals(X.UTF8)||o.equals(X.ISO8859_1)||o.equals(X.ASCII)}static encodeFallback(o){const d=btoa(unescape(encodeURIComponent(o))).split(""),m=[];for(let x=0;x<d.length;x++)m.push(d[x].charCodeAt(0));return new Uint8Array(m)}}class ue{static castAsNonUtf8Char(o,u=null){const d=u?u.getName():this.ISO88591;return je.decode(new Uint8Array([o]),d)}static guessEncoding(o,u){if(u!=null&&u.get(oe.CHARACTER_SET)!==void 0)return u.get(oe.CHARACTER_SET).toString();const d=o.length;let m=!0,x=!0,w=!0,E=0,N=0,O=0,I=0,P=0,F=0,q=0,re=0,ae=0,be=0,Ne=0;const $e=o.length>3&&o[0]===239&&o[1]===187&&o[2]===191;for(let Ge=0;Ge<d&&(m||x||w);Ge++){const Ue=o[Ge]&255;w&&(E>0?(Ue&128)===0?w=!1:E--:(Ue&128)!==0&&((Ue&64)===0?w=!1:(E++,(Ue&32)===0?N++:(E++,(Ue&16)===0?O++:(E++,(Ue&8)===0?I++:w=!1))))),m&&(Ue>127&&Ue<160?m=!1:Ue>159&&(Ue<192||Ue===215||Ue===247)&&Ne++),x&&(P>0?Ue<64||Ue===127||Ue>252?x=!1:P--:Ue===128||Ue===160||Ue>239?x=!1:Ue>160&&Ue<224?(F++,re=0,q++,q>ae&&(ae=q)):Ue>127?(P++,q=0,re++,re>be&&(be=re)):(q=0,re=0))}return w&&E>0&&(w=!1),x&&P>0&&(x=!1),w&&($e||N+O+I>0)?ue.UTF8:x&&(ue.ASSUME_SHIFT_JIS||ae>=3||be>=3)?ue.SHIFT_JIS:m&&x?ae===2&&F===2||Ne*10>=d?ue.SHIFT_JIS:ue.ISO88591:m?ue.ISO88591:x?ue.SHIFT_JIS:w?ue.UTF8:ue.PLATFORM_DEFAULT_ENCODING}static format(o,...u){let d=-1;function m(w,E,N,O,I,P){if(w==="%%")return"%";if(u[++d]===void 0)return;w=O?parseInt(O.substr(1)):void 0;let F=I?parseInt(I.substr(1)):void 0,q;switch(P){case"s":q=u[d];break;case"c":q=u[d][0];break;case"f":q=parseFloat(u[d]).toFixed(w);break;case"p":q=parseFloat(u[d]).toPrecision(w);break;case"e":q=parseFloat(u[d]).toExponential(w);break;case"x":q=parseInt(u[d]).toString(F||16);break;case"d":q=parseFloat(parseInt(u[d],F||10).toPrecision(w)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(F);let re=parseInt(N),ae=N&&N[0]+""=="0"?"0":" ";for(;q.length<re;)q=E!==void 0?q+ae:ae+q;return q}let x=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(x,m)}static getBytes(o,u){return je.encode(o,u)}static getCharCode(o,u=0){return o.charCodeAt(u)}static getCharAt(o){return String.fromCharCode(o)}}ue.SHIFT_JIS=X.SJIS.getName(),ue.GB2312="GB2312",ue.ISO88591=X.ISO8859_1.getName(),ue.EUC_JP="EUC_JP",ue.UTF8=X.UTF8.getName(),ue.PLATFORM_DEFAULT_ENCODING=ue.UTF8,ue.ASSUME_SHIFT_JIS=!1;class Ie{constructor(o=""){this.value=o}enableDecoding(o){return this.encoding=o,this}append(o){return typeof o=="string"?this.value+=o.toString():this.encoding?this.value+=ue.castAsNonUtf8Char(o,this.encoding):this.value+=String.fromCharCode(o),this}appendChars(o,u,d){for(let m=u;u<u+d;m++)this.append(o[m]);return this}length(){return this.value.length}charAt(o){return this.value.charAt(o)}deleteCharAt(o){this.value=this.value.substr(0,o)+this.value.substring(o+1)}setCharAt(o,u){this.value=this.value.substr(0,o)+u+this.value.substr(o+1)}substring(o,u){return this.value.substring(o,u)}setLengthToZero(){this.value=""}toString(){return this.value}insert(o,u){this.value=this.value.substr(0,o)+u+this.value.substr(o+u.length)}}class Ze{constructor(o,u,d,m){if(this.width=o,this.height=u,this.rowSize=d,this.bits=m,u==null&&(u=o),this.height=u,o<1||u<1)throw new v("Both dimensions must be greater than 0");d==null&&(d=Math.floor((o+31)/32)),this.rowSize=d,m==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(o){const u=o.length,d=o[0].length,m=new Ze(d,u);for(let x=0;x<u;x++){const w=o[x];for(let E=0;E<d;E++)w[E]&&m.set(E,x)}return m}static parseFromString(o,u,d){if(o===null)throw new v("stringRepresentation cannot be null");const m=new Array(o.length);let x=0,w=0,E=-1,N=0,O=0;for(;O<o.length;)if(o.charAt(O)===`
`||o.charAt(O)==="\r"){if(x>w){if(E===-1)E=x-w;else if(x-w!==E)throw new v("row lengths do not match");w=x,N++}O++}else if(o.substring(O,O+u.length)===u)O+=u.length,m[x]=!0,x++;else if(o.substring(O,O+d.length)===d)O+=d.length,m[x]=!1,x++;else throw new v("illegal character encountered: "+o.substring(O));if(x>w){if(E===-1)E=x-w;else if(x-w!==E)throw new v("row lengths do not match");N++}const I=new Ze(E,N);for(let P=0;P<x;P++)m[P]&&I.set(Math.floor(P%E),Math.floor(P/E));return I}get(o,u){const d=u*this.rowSize+Math.floor(o/32);return(this.bits[d]>>>(o&31)&1)!==0}set(o,u){const d=u*this.rowSize+Math.floor(o/32);this.bits[d]|=1<<(o&31)&4294967295}unset(o,u){const d=u*this.rowSize+Math.floor(o/32);this.bits[d]&=~(1<<(o&31)&4294967295)}flip(o,u){const d=u*this.rowSize+Math.floor(o/32);this.bits[d]^=1<<(o&31)&4294967295}xor(o){if(this.width!==o.getWidth()||this.height!==o.getHeight()||this.rowSize!==o.getRowSize())throw new v("input matrix dimensions do not match");const u=new Z(Math.floor(this.width/32)+1),d=this.rowSize,m=this.bits;for(let x=0,w=this.height;x<w;x++){const E=x*d,N=o.getRow(x,u).getBitArray();for(let O=0;O<d;O++)m[E+O]^=N[O]}}clear(){const o=this.bits,u=o.length;for(let d=0;d<u;d++)o[d]=0}setRegion(o,u,d,m){if(u<0||o<0)throw new v("Left and top must be nonnegative");if(m<1||d<1)throw new v("Height and width must be at least 1");const x=o+d,w=u+m;if(w>this.height||x>this.width)throw new v("The region must fit inside the matrix");const E=this.rowSize,N=this.bits;for(let O=u;O<w;O++){const I=O*E;for(let P=o;P<x;P++)N[I+Math.floor(P/32)]|=1<<(P&31)&4294967295}}getRow(o,u){u==null||u.getSize()<this.width?u=new Z(this.width):u.clear();const d=this.rowSize,m=this.bits,x=o*d;for(let w=0;w<d;w++)u.setBulk(w*32,m[x+w]);return u}setRow(o,u){M.arraycopy(u.getBitArray(),0,this.bits,o*this.rowSize,this.rowSize)}rotate180(){const o=this.getWidth(),u=this.getHeight();let d=new Z(o),m=new Z(o);for(let x=0,w=Math.floor((u+1)/2);x<w;x++)d=this.getRow(x,d),m=this.getRow(u-1-x,m),d.reverse(),m.reverse(),this.setRow(x,m),this.setRow(u-1-x,d)}getEnclosingRectangle(){const o=this.width,u=this.height,d=this.rowSize,m=this.bits;let x=o,w=u,E=-1,N=-1;for(let O=0;O<u;O++)for(let I=0;I<d;I++){const P=m[O*d+I];if(P!==0){if(O<w&&(w=O),O>N&&(N=O),I*32<x){let F=0;for(;(P<<31-F&4294967295)===0;)F++;I*32+F<x&&(x=I*32+F)}if(I*32+31>E){let F=31;for(;!(P>>>F);)F--;I*32+F>E&&(E=I*32+F)}}}return E<x||N<w?null:Int32Array.from([x,w,E-x+1,N-w+1])}getTopLeftOnBit(){const o=this.rowSize,u=this.bits;let d=0;for(;d<u.length&&u[d]===0;)d++;if(d===u.length)return null;const m=d/o;let x=d%o*32;const w=u[d];let E=0;for(;(w<<31-E&4294967295)===0;)E++;return x+=E,Int32Array.from([x,m])}getBottomRightOnBit(){const o=this.rowSize,u=this.bits;let d=u.length-1;for(;d>=0&&u[d]===0;)d--;if(d<0)return null;const m=Math.floor(d/o);let x=Math.floor(d%o)*32;const w=u[d];let E=31;for(;!(w>>>E);)E--;return x+=E,Int32Array.from([x,m])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(o){if(!(o instanceof Ze))return!1;const u=o;return this.width===u.width&&this.height===u.height&&this.rowSize===u.rowSize&&H.equals(this.bits,u.bits)}hashCode(){let o=this.width;return o=31*o+this.width,o=31*o+this.height,o=31*o+this.rowSize,o=31*o+H.hashCode(this.bits),o}toString(o="X ",u="  ",d=`
`){return this.buildToString(o,u,d)}buildToString(o,u,d){let m=new Ie;for(let x=0,w=this.height;x<w;x++){for(let E=0,N=this.width;E<N;E++)m.append(this.get(E,x)?o:u);m.append(d)}return m.toString()}clone(){return new Ze(this.width,this.height,this.rowSize,this.bits.slice())}}class ne extends g{static getNotFoundInstance(){return new ne}}ne.kind="NotFoundException";class ie extends _{constructor(o){super(o),this.luminances=ie.EMPTY,this.buckets=new Int32Array(ie.LUMINANCE_BUCKETS)}getBlackRow(o,u){const d=this.getLuminanceSource(),m=d.getWidth();u==null||u.getSize()<m?u=new Z(m):u.clear(),this.initArrays(m);const x=d.getRow(o,this.luminances),w=this.buckets;for(let N=0;N<m;N++)w[(x[N]&255)>>ie.LUMINANCE_SHIFT]++;const E=ie.estimateBlackPoint(w);if(m<3)for(let N=0;N<m;N++)(x[N]&255)<E&&u.set(N);else{let N=x[0]&255,O=x[1]&255;for(let I=1;I<m-1;I++){const P=x[I+1]&255;(O*4-N-P)/2<E&&u.set(I),N=O,O=P}}return u}getBlackMatrix(){const o=this.getLuminanceSource(),u=o.getWidth(),d=o.getHeight(),m=new Ze(u,d);this.initArrays(u);const x=this.buckets;for(let N=1;N<5;N++){const O=Math.floor(d*N/5),I=o.getRow(O,this.luminances),P=Math.floor(u*4/5);for(let F=Math.floor(u/5);F<P;F++){const q=I[F]&255;x[q>>ie.LUMINANCE_SHIFT]++}}const w=ie.estimateBlackPoint(x),E=o.getMatrix();for(let N=0;N<d;N++){const O=N*u;for(let I=0;I<u;I++)(E[O+I]&255)<w&&m.set(I,N)}return m}createBinarizer(o){return new ie(o)}initArrays(o){this.luminances.length<o&&(this.luminances=new Uint8ClampedArray(o));const u=this.buckets;for(let d=0;d<ie.LUMINANCE_BUCKETS;d++)u[d]=0}static estimateBlackPoint(o){const u=o.length;let d=0,m=0,x=0;for(let I=0;I<u;I++)o[I]>x&&(m=I,x=o[I]),o[I]>d&&(d=o[I]);let w=0,E=0;for(let I=0;I<u;I++){const P=I-m,F=o[I]*P*P;F>E&&(w=I,E=F)}if(m>w){const I=m;m=w,w=I}if(w-m<=u/16)throw new ne;let N=w-1,O=-1;for(let I=w-1;I>m;I--){const P=I-m,F=P*P*(w-I)*(d-o[I]);F>O&&(N=I,O=F)}return N<<ie.LUMINANCE_SHIFT}}ie.LUMINANCE_BITS=5,ie.LUMINANCE_SHIFT=8-ie.LUMINANCE_BITS,ie.LUMINANCE_BUCKETS=1<<ie.LUMINANCE_BITS,ie.EMPTY=Uint8ClampedArray.from([0]);class pe extends ie{constructor(o){super(o),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const o=this.getLuminanceSource(),u=o.getWidth(),d=o.getHeight();if(u>=pe.MINIMUM_DIMENSION&&d>=pe.MINIMUM_DIMENSION){const m=o.getMatrix();let x=u>>pe.BLOCK_SIZE_POWER;(u&pe.BLOCK_SIZE_MASK)!==0&&x++;let w=d>>pe.BLOCK_SIZE_POWER;(d&pe.BLOCK_SIZE_MASK)!==0&&w++;const E=pe.calculateBlackPoints(m,x,w,u,d),N=new Ze(u,d);pe.calculateThresholdForBlock(m,x,w,u,d,E,N),this.matrix=N}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(o){return new pe(o)}static calculateThresholdForBlock(o,u,d,m,x,w,E){const N=x-pe.BLOCK_SIZE,O=m-pe.BLOCK_SIZE;for(let I=0;I<d;I++){let P=I<<pe.BLOCK_SIZE_POWER;P>N&&(P=N);const F=pe.cap(I,2,d-3);for(let q=0;q<u;q++){let re=q<<pe.BLOCK_SIZE_POWER;re>O&&(re=O);const ae=pe.cap(q,2,u-3);let be=0;for(let $e=-2;$e<=2;$e++){const Ge=w[F+$e];be+=Ge[ae-2]+Ge[ae-1]+Ge[ae]+Ge[ae+1]+Ge[ae+2]}const Ne=be/25;pe.thresholdBlock(o,re,P,Ne,m,E)}}}static cap(o,u,d){return o<u?u:o>d?d:o}static thresholdBlock(o,u,d,m,x,w){for(let E=0,N=d*x+u;E<pe.BLOCK_SIZE;E++,N+=x)for(let O=0;O<pe.BLOCK_SIZE;O++)(o[N+O]&255)<=m&&w.set(u+O,d+E)}static calculateBlackPoints(o,u,d,m,x){const w=x-pe.BLOCK_SIZE,E=m-pe.BLOCK_SIZE,N=new Array(d);for(let O=0;O<d;O++){N[O]=new Int32Array(u);let I=O<<pe.BLOCK_SIZE_POWER;I>w&&(I=w);for(let P=0;P<u;P++){let F=P<<pe.BLOCK_SIZE_POWER;F>E&&(F=E);let q=0,re=255,ae=0;for(let Ne=0,$e=I*m+F;Ne<pe.BLOCK_SIZE;Ne++,$e+=m){for(let Ge=0;Ge<pe.BLOCK_SIZE;Ge++){const Ue=o[$e+Ge]&255;q+=Ue,Ue<re&&(re=Ue),Ue>ae&&(ae=Ue)}if(ae-re>pe.MIN_DYNAMIC_RANGE)for(Ne++,$e+=m;Ne<pe.BLOCK_SIZE;Ne++,$e+=m)for(let Ge=0;Ge<pe.BLOCK_SIZE;Ge++)q+=o[$e+Ge]&255}let be=q>>pe.BLOCK_SIZE_POWER*2;if(ae-re<=pe.MIN_DYNAMIC_RANGE&&(be=re/2,O>0&&P>0)){const Ne=(N[O-1][P]+2*N[O][P-1]+N[O-1][P-1])/4;re<Ne&&(be=Ne)}N[O][P]=be}}return N}}pe.BLOCK_SIZE_POWER=3,pe.BLOCK_SIZE=1<<pe.BLOCK_SIZE_POWER,pe.BLOCK_SIZE_MASK=pe.BLOCK_SIZE-1,pe.MINIMUM_DIMENSION=pe.BLOCK_SIZE*5,pe.MIN_DYNAMIC_RANGE=24;class me{constructor(o,u){this.width=o,this.height=u}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(o,u,d,m){throw new Qe("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Qe("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Qe("This luminance source does not support rotation by 45 degrees.")}toString(){const o=new Uint8ClampedArray(this.width);let u=new Ie;for(let d=0;d<this.height;d++){const m=this.getRow(d,o);for(let x=0;x<this.width;x++){const w=m[x]&255;let E;w<64?E="#":w<128?E="+":w<192?E=".":E=" ",u.append(E)}u.append(`
`)}return u.toString()}}class Y extends me{constructor(o){super(o.getWidth(),o.getHeight()),this.delegate=o}getRow(o,u){const d=this.delegate.getRow(o,u),m=this.getWidth();for(let x=0;x<m;x++)d[x]=255-(d[x]&255);return d}getMatrix(){const o=this.delegate.getMatrix(),u=this.getWidth()*this.getHeight(),d=new Uint8ClampedArray(u);for(let m=0;m<u;m++)d[m]=255-(o[m]&255);return d}isCropSupported(){return this.delegate.isCropSupported()}crop(o,u,d,m){return new Y(this.delegate.crop(o,u,d,m))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Y(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Y(this.delegate.rotateCounterClockwise45())}}class le extends me{constructor(o){super(o.width,o.height),this.canvas=o,this.tempCanvasElement=null,this.buffer=le.makeBufferFromCanvasImageData(o)}static makeBufferFromCanvasImageData(o){const u=o.getContext("2d").getImageData(0,0,o.width,o.height);return le.toGrayscaleBuffer(u.data,o.width,o.height)}static toGrayscaleBuffer(o,u,d){const m=new Uint8ClampedArray(u*d);for(let x=0,w=0,E=o.length;x<E;x+=4,w++){let N;if(o[x+3]===0)N=255;else{const I=o[x],P=o[x+1],F=o[x+2];N=306*I+601*P+117*F+512>>10}m[w]=N}return m}getRow(o,u){if(o<0||o>=this.getHeight())throw new v("Requested row is outside the image: "+o);const d=this.getWidth(),m=o*d;return u===null?u=this.buffer.slice(m,m+d):(u.length<d&&(u=new Uint8ClampedArray(d)),u.set(this.buffer.slice(m,m+d))),u}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(o,u,d,m){return super.crop(o,u,d,m),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const o=this.canvas.ownerDocument.createElement("canvas");o.width=this.canvas.width,o.height=this.canvas.height,this.tempCanvasElement=o}return this.tempCanvasElement}rotate(o){const u=this.getTempCanvasElement(),d=u.getContext("2d"),m=o*le.DEGREE_TO_RADIANS,x=this.canvas.width,w=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(m))*x+Math.abs(Math.sin(m))*w),N=Math.ceil(Math.abs(Math.sin(m))*x+Math.abs(Math.cos(m))*w);return u.width=E,u.height=N,d.translate(E/2,N/2),d.rotate(m),d.drawImage(this.canvas,x/-2,w/-2),this.buffer=le.makeBufferFromCanvasImageData(u),this}invert(){return new Y(this)}}le.DEGREE_TO_RADIANS=Math.PI/180;class V{constructor(o,u,d){this.deviceId=o,this.label=u,this.kind="videoinput",this.groupId=d||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var te=(globalThis||jh||self||window||void 0)&&(globalThis||jh||self||window||void 0).__awaiter||function(B,o,u,d){function m(x){return x instanceof u?x:new u(function(w){w(x)})}return new(u||(u=Promise))(function(x,w){function E(I){try{O(d.next(I))}catch(P){w(P)}}function N(I){try{O(d.throw(I))}catch(P){w(P)}}function O(I){I.done?x(I.value):m(I.value).then(E,N)}O((d=d.apply(B,o||[])).next())})};class fe{constructor(o,u=500,d){this.reader=o,this.timeBetweenScansMillis=u,this._hints=d,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(o){this._timeBetweenDecodingAttempts=o<0?0:o}set hints(o){this._hints=o||null}get hints(){return this._hints}listVideoInputDevices(){return te(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const o=yield navigator.mediaDevices.enumerateDevices(),u=[];for(const d of o){const m=d.kind==="video"?"videoinput":d.kind;if(m!=="videoinput")continue;const x=d.deviceId||d.id,w=d.label||`Video device ${u.length+1}`,E=d.groupId,N={deviceId:x,label:w,kind:m,groupId:E};u.push(N)}return u})}getVideoInputDevices(){return te(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(u=>new V(u.deviceId,u.label))})}findDeviceById(o){return te(this,void 0,void 0,function*(){const u=yield this.listVideoInputDevices();return u?u.find(d=>d.deviceId===o):null})}decodeFromInputVideoDevice(o,u){return te(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(o,u)})}decodeOnceFromVideoDevice(o,u){return te(this,void 0,void 0,function*(){this.reset();let d;o?d={deviceId:{exact:o}}:d={facingMode:"environment"};const m={video:d};return yield this.decodeOnceFromConstraints(m,u)})}decodeOnceFromConstraints(o,u){return te(this,void 0,void 0,function*(){const d=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeOnceFromStream(d,u)})}decodeOnceFromStream(o,u){return te(this,void 0,void 0,function*(){this.reset();const d=yield this.attachStreamToVideo(o,u);return yield this.decodeOnce(d)})}decodeFromInputVideoDeviceContinuously(o,u,d){return te(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(o,u,d)})}decodeFromVideoDevice(o,u,d){return te(this,void 0,void 0,function*(){let m;o?m={deviceId:{exact:o}}:m={facingMode:"environment"};const x={video:m};return yield this.decodeFromConstraints(x,u,d)})}decodeFromConstraints(o,u,d){return te(this,void 0,void 0,function*(){const m=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeFromStream(m,u,d)})}decodeFromStream(o,u,d){return te(this,void 0,void 0,function*(){this.reset();const m=yield this.attachStreamToVideo(o,u);return yield this.decodeContinuously(m,d)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(o,u){return te(this,void 0,void 0,function*(){const d=this.prepareVideoElement(u);return this.addVideoSource(d,o),this.videoElement=d,this.stream=o,yield this.playVideoOnLoadAsync(d),d})}playVideoOnLoadAsync(o){return new Promise((u,d)=>this.playVideoOnLoad(o,()=>u()))}playVideoOnLoad(o,u){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(o),o.addEventListener("ended",this.videoEndedListener),o.addEventListener("canplay",this.videoCanPlayListener),o.addEventListener("playing",u),this.tryPlayVideo(o)}isVideoPlaying(o){return o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2}tryPlayVideo(o){return te(this,void 0,void 0,function*(){if(this.isVideoPlaying(o)){console.warn("Trying to play video that is already playing.");return}try{yield o.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(o,u){const d=document.getElementById(o);if(!d)throw new C(`element with id '${o}' not found`);if(d.nodeName.toLowerCase()!==u.toLowerCase())throw new C(`element with id '${o}' must be an ${u} element`);return d}decodeFromImage(o,u){if(!o&&!u)throw new C("either imageElement with a src set or an url must be provided");return u&&!o?this.decodeFromImageUrl(u):this.decodeFromImageElement(o)}decodeFromVideo(o,u){if(!o&&!u)throw new C("Either an element with a src set or an URL must be provided");return u&&!o?this.decodeFromVideoUrl(u):this.decodeFromVideoElement(o)}decodeFromVideoContinuously(o,u,d){if(o===void 0&&u===void 0)throw new C("Either an element with a src set or an URL must be provided");return u&&!o?this.decodeFromVideoUrlContinuously(u,d):this.decodeFromVideoElementContinuously(o,d)}decodeFromImageElement(o){if(!o)throw new C("An image element must be provided.");this.reset();const u=this.prepareImageElement(o);this.imageElement=u;let d;return this.isImageLoaded(u)?d=this.decodeOnce(u,!1,!0):d=this._decodeOnLoadImage(u),d}decodeFromVideoElement(o){const u=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideo(u)}decodeFromVideoElementContinuously(o,u){const d=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideoContinuously(d,u)}_decodeFromVideoElementSetup(o){if(!o)throw new C("A video element must be provided.");this.reset();const u=this.prepareVideoElement(o);return this.videoElement=u,u}decodeFromImageUrl(o){if(!o)throw new C("An URL must be provided.");this.reset();const u=this.prepareImageElement();this.imageElement=u;const d=this._decodeOnLoadImage(u);return u.src=o,d}decodeFromVideoUrl(o){if(!o)throw new C("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),d=this.decodeFromVideoElement(u);return u.src=o,d}decodeFromVideoUrlContinuously(o,u){if(!o)throw new C("An URL must be provided.");this.reset();const d=this.prepareVideoElement(),m=this.decodeFromVideoElementContinuously(d,u);return d.src=o,m}_decodeOnLoadImage(o){return new Promise((u,d)=>{this.imageLoadedListener=()=>this.decodeOnce(o,!1,!0).then(u,d),o.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(o){return te(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(o),yield this.decodeOnce(o)})}_decodeOnLoadVideoContinuously(o,u){return te(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(o),this.decodeContinuously(o,u)})}isImageLoaded(o){return!(!o.complete||o.naturalWidth===0)}prepareImageElement(o){let u;return typeof o>"u"&&(u=document.createElement("img"),u.width=200,u.height=200),typeof o=="string"&&(u=this.getMediaElement(o,"img")),o instanceof HTMLImageElement&&(u=o),u}prepareVideoElement(o){let u;return!o&&typeof document<"u"&&(u=document.createElement("video"),u.width=200,u.height=200),typeof o=="string"&&(u=this.getMediaElement(o,"video")),o instanceof HTMLVideoElement&&(u=o),u.setAttribute("autoplay","true"),u.setAttribute("muted","true"),u.setAttribute("playsinline","true"),u}decodeOnce(o,u=!0,d=!0){this._stopAsyncDecode=!1;const m=(x,w)=>{if(this._stopAsyncDecode){w(new ne("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(o);x(E)}catch(E){const N=u&&E instanceof ne,I=(E instanceof T||E instanceof U)&&d;if(N||I)return setTimeout(m,this._timeBetweenDecodingAttempts,x,w);w(E)}};return new Promise((x,w)=>m(x,w))}decodeContinuously(o,u){this._stopContinuousDecode=!1;const d=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const m=this.decode(o);u(m,null),setTimeout(d,this.timeBetweenScansMillis)}catch(m){u(null,m);const x=m instanceof T||m instanceof U,w=m instanceof ne;(x||w)&&setTimeout(d,this._timeBetweenDecodingAttempts)}};d()}decode(o){const u=this.createBinaryBitmap(o);return this.decodeBitmap(u)}_isHTMLVideoElement(o){return o.videoWidth!==0}drawFrameOnCanvas(o,u,d){u||(u={sx:0,sy:0,sWidth:o.videoWidth,sHeight:o.videoHeight,dx:0,dy:0,dWidth:o.videoWidth,dHeight:o.videoHeight}),d||(d=this.captureCanvasContext),d.drawImage(o,u.sx,u.sy,u.sWidth,u.sHeight,u.dx,u.dy,u.dWidth,u.dHeight)}drawImageOnCanvas(o,u,d=this.captureCanvasContext){u||(u={sx:0,sy:0,sWidth:o.naturalWidth,sHeight:o.naturalHeight,dx:0,dy:0,dWidth:o.naturalWidth,dHeight:o.naturalHeight}),d||(d=this.captureCanvasContext),d.drawImage(o,u.sx,u.sy,u.sWidth,u.sHeight,u.dx,u.dy,u.dWidth,u.dHeight)}createBinaryBitmap(o){this.getCaptureCanvasContext(o),this._isHTMLVideoElement(o)?this.drawFrameOnCanvas(o):this.drawImageOnCanvas(o);const u=this.getCaptureCanvas(o),d=new le(u),m=new pe(d);return new A(m)}getCaptureCanvasContext(o){if(!this.captureCanvasContext){const d=this.getCaptureCanvas(o).getContext("2d");this.captureCanvasContext=d}return this.captureCanvasContext}getCaptureCanvas(o){if(!this.captureCanvas){const u=this.createCaptureCanvas(o);this.captureCanvas=u}return this.captureCanvas}decodeBitmap(o){return this.reader.decode(o,this._hints)}createCaptureCanvas(o){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const u=document.createElement("canvas");let d,m;return typeof o<"u"&&(o instanceof HTMLVideoElement?(d=o.videoWidth,m=o.videoHeight):o instanceof HTMLImageElement&&(d=o.naturalWidth||o.width,m=o.naturalHeight||o.height)),u.style.width=d+"px",u.style.height=m+"px",u.width=d,u.height=m,u}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(o=>o.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(o,u){try{o.srcObject=u}catch{o.src=URL.createObjectURL(u)}}cleanVideoSource(o){try{o.srcObject=null}catch{o.src=""}this.videoElement.removeAttribute("src")}}class ge{constructor(o,u,d=u==null?0:8*u.length,m,x,w=M.currentTimeMillis()){this.text=o,this.rawBytes=u,this.numBits=d,this.resultPoints=m,this.format=x,this.timestamp=w,this.text=o,this.rawBytes=u,d==null?this.numBits=u==null?0:8*u.length:this.numBits=d,this.resultPoints=m,this.format=x,this.resultMetadata=null,w==null?this.timestamp=M.currentTimeMillis():this.timestamp=w}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(o,u){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(o,u)}putAllMetadata(o){o!==null&&(this.resultMetadata===null?this.resultMetadata=o:this.resultMetadata=new Map(o))}addResultPoints(o){const u=this.resultPoints;if(u===null)this.resultPoints=o;else if(o!==null&&o.length>0){const d=new Array(u.length+o.length);M.arraycopy(u,0,d,0,u.length),M.arraycopy(o,0,d,u.length,o.length),this.resultPoints=d}}getTimestamp(){return this.timestamp}toString(){return this.text}}var We;(function(B){B[B.AZTEC=0]="AZTEC",B[B.CODABAR=1]="CODABAR",B[B.CODE_39=2]="CODE_39",B[B.CODE_93=3]="CODE_93",B[B.CODE_128=4]="CODE_128",B[B.DATA_MATRIX=5]="DATA_MATRIX",B[B.EAN_8=6]="EAN_8",B[B.EAN_13=7]="EAN_13",B[B.ITF=8]="ITF",B[B.MAXICODE=9]="MAXICODE",B[B.PDF_417=10]="PDF_417",B[B.QR_CODE=11]="QR_CODE",B[B.RSS_14=12]="RSS_14",B[B.RSS_EXPANDED=13]="RSS_EXPANDED",B[B.UPC_A=14]="UPC_A",B[B.UPC_E=15]="UPC_E",B[B.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(We||(We={}));var se=We,Be;(function(B){B[B.OTHER=0]="OTHER",B[B.ORIENTATION=1]="ORIENTATION",B[B.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",B[B.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",B[B.ISSUE_NUMBER=4]="ISSUE_NUMBER",B[B.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",B[B.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",B[B.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",B[B.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",B[B.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",B[B.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Be||(Be={}));var K=Be;class Ce{constructor(o,u,d,m,x=-1,w=-1){this.rawBytes=o,this.text=u,this.byteSegments=d,this.ecLevel=m,this.structuredAppendSequenceNumber=x,this.structuredAppendParity=w,this.numBits=o==null?0:8*o.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(o){this.numBits=o}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(o){this.errorsCorrected=o}getErasures(){return this.erasures}setErasures(o){this.erasures=o}getOther(){return this.other}setOther(o){this.other=o}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ae{exp(o){return this.expTable[o]}log(o){if(o===0)throw new v;return this.logTable[o]}static addOrSubtract(o,u){return o^u}}class ze{constructor(o,u){if(u.length===0)throw new v;this.field=o;const d=u.length;if(d>1&&u[0]===0){let m=1;for(;m<d&&u[m]===0;)m++;m===d?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(d-m),M.arraycopy(u,m,this.coefficients,0,this.coefficients.length))}else this.coefficients=u}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);const u=this.coefficients;let d;if(o===1){d=0;for(let w=0,E=u.length;w!==E;w++){const N=u[w];d=Ae.addOrSubtract(d,N)}return d}d=u[0];const m=u.length,x=this.field;for(let w=1;w<m;w++)d=Ae.addOrSubtract(x.multiply(o,d),u[w]);return d}addOrSubtract(o){if(!this.field.equals(o.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero())return o;if(o.isZero())return this;let u=this.coefficients,d=o.coefficients;if(u.length>d.length){const w=u;u=d,d=w}let m=new Int32Array(d.length);const x=d.length-u.length;M.arraycopy(d,0,m,0,x);for(let w=x;w<d.length;w++)m[w]=Ae.addOrSubtract(u[w-x],d[w]);return new ze(this.field,m)}multiply(o){if(!this.field.equals(o.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero()||o.isZero())return this.field.getZero();const u=this.coefficients,d=u.length,m=o.coefficients,x=m.length,w=new Int32Array(d+x-1),E=this.field;for(let N=0;N<d;N++){const O=u[N];for(let I=0;I<x;I++)w[N+I]=Ae.addOrSubtract(w[N+I],E.multiply(O,m[I]))}return new ze(E,w)}multiplyScalar(o){if(o===0)return this.field.getZero();if(o===1)return this;const u=this.coefficients.length,d=this.field,m=new Int32Array(u),x=this.coefficients;for(let w=0;w<u;w++)m[w]=d.multiply(x[w],o);return new ze(d,m)}multiplyByMonomial(o,u){if(o<0)throw new v;if(u===0)return this.field.getZero();const d=this.coefficients,m=d.length,x=new Int32Array(m+o),w=this.field;for(let E=0;E<m;E++)x[E]=w.multiply(d[E],u);return new ze(w,x)}divide(o){if(!this.field.equals(o.field))throw new v("GenericGFPolys do not have same GenericGF field");if(o.isZero())throw new v("Divide by 0");const u=this.field;let d=u.getZero(),m=this;const x=o.getCoefficient(o.getDegree()),w=u.inverse(x);for(;m.getDegree()>=o.getDegree()&&!m.isZero();){const E=m.getDegree()-o.getDegree(),N=u.multiply(m.getCoefficient(m.getDegree()),w),O=o.multiplyByMonomial(E,N),I=u.buildMonomial(E,N);d=d.addOrSubtract(I),m=m.addOrSubtract(O)}return[d,m]}toString(){let o="";for(let u=this.getDegree();u>=0;u--){let d=this.getCoefficient(u);if(d!==0){if(d<0?(o+=" - ",d=-d):o.length>0&&(o+=" + "),u===0||d!==1){const m=this.field.log(d);m===0?o+="1":m===1?o+="a":(o+="a^",o+=m)}u!==0&&(u===1?o+="x":(o+="x^",o+=u))}}return o}}class rt extends g{}rt.kind="ArithmeticException";class ot extends Ae{constructor(o,u,d){super(),this.primitive=o,this.size=u,this.generatorBase=d;const m=new Int32Array(u);let x=1;for(let E=0;E<u;E++)m[E]=x,x*=2,x>=u&&(x^=o,x&=u-1);this.expTable=m;const w=new Int32Array(u);for(let E=0;E<u-1;E++)w[m[E]]=E;this.logTable=w,this.zero=new ze(this,Int32Array.from([0])),this.one=new ze(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,u){if(o<0)throw new v;if(u===0)return this.zero;const d=new Int32Array(o+1);return d[0]=u,new ze(this,d)}inverse(o){if(o===0)throw new rt;return this.expTable[this.size-this.logTable[o]-1]}multiply(o,u){return o===0||u===0?0:this.expTable[(this.logTable[o]+this.logTable[u])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+G.toHexString(this.primitive)+","+this.size+")"}equals(o){return o===this}}ot.AZTEC_DATA_12=new ot(4201,4096,1),ot.AZTEC_DATA_10=new ot(1033,1024,1),ot.AZTEC_DATA_6=new ot(67,64,1),ot.AZTEC_PARAM=new ot(19,16,1),ot.QR_CODE_FIELD_256=new ot(285,256,0),ot.DATA_MATRIX_FIELD_256=new ot(301,256,1),ot.AZTEC_DATA_8=ot.DATA_MATRIX_FIELD_256,ot.MAXICODE_FIELD_64=ot.AZTEC_DATA_6;class gt extends g{}gt.kind="ReedSolomonException";class jt extends g{}jt.kind="IllegalStateException";class Pt{constructor(o){this.field=o}decode(o,u){const d=this.field,m=new ze(d,o),x=new Int32Array(u);let w=!0;for(let q=0;q<u;q++){const re=m.evaluateAt(d.exp(q+d.getGeneratorBase()));x[x.length-1-q]=re,re!==0&&(w=!1)}if(w)return;const E=new ze(d,x),N=this.runEuclideanAlgorithm(d.buildMonomial(u,1),E,u),O=N[0],I=N[1],P=this.findErrorLocations(O),F=this.findErrorMagnitudes(I,P);for(let q=0;q<P.length;q++){const re=o.length-1-d.log(P[q]);if(re<0)throw new gt("Bad error location");o[re]=ot.addOrSubtract(o[re],F[q])}}runEuclideanAlgorithm(o,u,d){if(o.getDegree()<u.getDegree()){const q=o;o=u,u=q}const m=this.field;let x=o,w=u,E=m.getZero(),N=m.getOne();for(;w.getDegree()>=(d/2|0);){let q=x,re=E;if(x=w,E=N,x.isZero())throw new gt("r_{i-1} was zero");w=q;let ae=m.getZero();const be=x.getCoefficient(x.getDegree()),Ne=m.inverse(be);for(;w.getDegree()>=x.getDegree()&&!w.isZero();){const $e=w.getDegree()-x.getDegree(),Ge=m.multiply(w.getCoefficient(w.getDegree()),Ne);ae=ae.addOrSubtract(m.buildMonomial($e,Ge)),w=w.addOrSubtract(x.multiplyByMonomial($e,Ge))}if(N=ae.multiply(E).addOrSubtract(re),w.getDegree()>=x.getDegree())throw new jt("Division algorithm failed to reduce polynomial?")}const O=N.getCoefficient(0);if(O===0)throw new gt("sigmaTilde(0) was zero");const I=m.inverse(O),P=N.multiplyScalar(I),F=w.multiplyScalar(I);return[P,F]}findErrorLocations(o){const u=o.getDegree();if(u===1)return Int32Array.from([o.getCoefficient(1)]);const d=new Int32Array(u);let m=0;const x=this.field;for(let w=1;w<x.getSize()&&m<u;w++)o.evaluateAt(w)===0&&(d[m]=x.inverse(w),m++);if(m!==u)throw new gt("Error locator degree does not match number of roots");return d}findErrorMagnitudes(o,u){const d=u.length,m=new Int32Array(d),x=this.field;for(let w=0;w<d;w++){const E=x.inverse(u[w]);let N=1;for(let O=0;O<d;O++)if(w!==O){const I=x.multiply(u[O],E),P=(I&1)===0?I|1:I&-2;N=x.multiply(N,P)}m[w]=x.multiply(o.evaluateAt(E),x.inverse(N)),x.getGeneratorBase()!==0&&(m[w]=x.multiply(m[w],E))}return m}}var et;(function(B){B[B.UPPER=0]="UPPER",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.DIGIT=3]="DIGIT",B[B.PUNCT=4]="PUNCT",B[B.BINARY=5]="BINARY"})(et||(et={}));class ft{decode(o){this.ddata=o;let u=o.getBits(),d=this.extractBits(u),m=this.correctBits(d),x=ft.convertBoolArrayToByteArray(m),w=ft.getEncodedData(m),E=new Ce(x,w,null,null);return E.setNumBits(m.length),E}static highLevelDecode(o){return this.getEncodedData(o)}static getEncodedData(o){let u=o.length,d=et.UPPER,m=et.UPPER,x="",w=0;for(;w<u;)if(m===et.BINARY){if(u-w<5)break;let E=ft.readCode(o,w,5);if(w+=5,E===0){if(u-w<11)break;E=ft.readCode(o,w,11)+31,w+=11}for(let N=0;N<E;N++){if(u-w<8){w=u;break}const O=ft.readCode(o,w,8);x+=ue.castAsNonUtf8Char(O),w+=8}m=d}else{let E=m===et.DIGIT?4:5;if(u-w<E)break;let N=ft.readCode(o,w,E);w+=E;let O=ft.getCharacter(m,N);O.startsWith("CTRL_")?(d=m,m=ft.getTable(O.charAt(5)),O.charAt(6)==="L"&&(d=m)):(x+=O,m=d)}return x}static getTable(o){switch(o){case"L":return et.LOWER;case"P":return et.PUNCT;case"M":return et.MIXED;case"D":return et.DIGIT;case"B":return et.BINARY;case"U":default:return et.UPPER}}static getCharacter(o,u){switch(o){case et.UPPER:return ft.UPPER_TABLE[u];case et.LOWER:return ft.LOWER_TABLE[u];case et.MIXED:return ft.MIXED_TABLE[u];case et.PUNCT:return ft.PUNCT_TABLE[u];case et.DIGIT:return ft.DIGIT_TABLE[u];default:throw new jt("Bad table")}}correctBits(o){let u,d;this.ddata.getNbLayers()<=2?(d=6,u=ot.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(d=8,u=ot.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(d=10,u=ot.AZTEC_DATA_10):(d=12,u=ot.AZTEC_DATA_12);let m=this.ddata.getNbDatablocks(),x=o.length/d;if(x<m)throw new U;let w=o.length%d,E=new Int32Array(x);for(let F=0;F<x;F++,w+=d)E[F]=ft.readCode(o,w,d);try{new Pt(u).decode(E,x-m)}catch(F){throw new U(F)}let N=(1<<d)-1,O=0;for(let F=0;F<m;F++){let q=E[F];if(q===0||q===N)throw new U;(q===1||q===N-1)&&O++}let I=new Array(m*d-O),P=0;for(let F=0;F<m;F++){let q=E[F];if(q===1||q===N-1)I.fill(q>1,P,P+d-1),P+=d-1;else for(let re=d-1;re>=0;--re)I[P++]=(q&1<<re)!==0}return I}extractBits(o){let u=this.ddata.isCompact(),d=this.ddata.getNbLayers(),m=(u?11:14)+d*4,x=new Int32Array(m),w=new Array(this.totalBitsInLayer(d,u));if(u)for(let E=0;E<x.length;E++)x[E]=E;else{let E=m+1+2*G.truncDivision(G.truncDivision(m,2)-1,15),N=m/2,O=G.truncDivision(E,2);for(let I=0;I<N;I++){let P=I+G.truncDivision(I,15);x[N-I-1]=O-P-1,x[N+I]=O+P+1}}for(let E=0,N=0;E<d;E++){let O=(d-E)*4+(u?9:12),I=E*2,P=m-1-I;for(let F=0;F<O;F++){let q=F*2;for(let re=0;re<2;re++)w[N+q+re]=o.get(x[I+re],x[I+F]),w[N+2*O+q+re]=o.get(x[I+F],x[P-re]),w[N+4*O+q+re]=o.get(x[P-re],x[P-F]),w[N+6*O+q+re]=o.get(x[P-F],x[I+re])}N+=O*8}return w}static readCode(o,u,d){let m=0;for(let x=u;x<u+d;x++)m<<=1,o[x]&&(m|=1);return m}static readByte(o,u){let d=o.length-u;return d>=8?ft.readCode(o,u,8):ft.readCode(o,u,d)<<8-d}static convertBoolArrayToByteArray(o){let u=new Uint8Array((o.length+7)/8);for(let d=0;d<u.length;d++)u[d]=ft.readByte(o,8*d);return u}totalBitsInLayer(o,u){return((u?88:112)+16*o)*o}}ft.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ft.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ft.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ft.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ft.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ve{constructor(){}static round(o){return o===NaN?0:o<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:o>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:o+(o<0?-.5:.5)|0}static distance(o,u,d,m){const x=o-d,w=u-m;return Math.sqrt(x*x+w*w)}static sum(o){let u=0;for(let d=0,m=o.length;d!==m;d++){const x=o[d];u+=x}return u}}class lt{static floatToIntBits(o){return o}}lt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class tt{constructor(o,u){this.x=o,this.y=u}getX(){return this.x}getY(){return this.y}equals(o){if(o instanceof tt){const u=o;return this.x===u.x&&this.y===u.y}return!1}hashCode(){return 31*lt.floatToIntBits(this.x)+lt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(o){const u=this.distance(o[0],o[1]),d=this.distance(o[1],o[2]),m=this.distance(o[0],o[2]);let x,w,E;if(d>=u&&d>=m?(w=o[0],x=o[1],E=o[2]):m>=d&&m>=u?(w=o[1],x=o[0],E=o[2]):(w=o[2],x=o[0],E=o[1]),this.crossProductZ(x,w,E)<0){const N=x;x=E,E=N}o[0]=x,o[1]=w,o[2]=E}static distance(o,u){return Ve.distance(o.x,o.y,u.x,u.y)}static crossProductZ(o,u,d){const m=u.x,x=u.y;return(d.x-m)*(o.y-x)-(d.y-x)*(o.x-m)}}class Xn{constructor(o,u){this.bits=o,this.points=u}getBits(){return this.bits}getPoints(){return this.points}}class Lr extends Xn{constructor(o,u,d,m,x){super(o,u),this.compact=d,this.nbDatablocks=m,this.nbLayers=x}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class on{constructor(o,u,d,m){this.image=o,this.height=o.getHeight(),this.width=o.getWidth(),u==null&&(u=on.INIT_SIZE),d==null&&(d=o.getWidth()/2|0),m==null&&(m=o.getHeight()/2|0);const x=u/2|0;if(this.leftInit=d-x,this.rightInit=d+x,this.upInit=m-x,this.downInit=m+x,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ne}detect(){let o=this.leftInit,u=this.rightInit,d=this.upInit,m=this.downInit,x=!1,w=!0,E=!1,N=!1,O=!1,I=!1,P=!1;const F=this.width,q=this.height;for(;w;){w=!1;let re=!0;for(;(re||!N)&&u<F;)re=this.containsBlackPoint(d,m,u,!1),re?(u++,w=!0,N=!0):N||u++;if(u>=F){x=!0;break}let ae=!0;for(;(ae||!O)&&m<q;)ae=this.containsBlackPoint(o,u,m,!0),ae?(m++,w=!0,O=!0):O||m++;if(m>=q){x=!0;break}let be=!0;for(;(be||!I)&&o>=0;)be=this.containsBlackPoint(d,m,o,!1),be?(o--,w=!0,I=!0):I||o--;if(o<0){x=!0;break}let Ne=!0;for(;(Ne||!P)&&d>=0;)Ne=this.containsBlackPoint(o,u,d,!0),Ne?(d--,w=!0,P=!0):P||d--;if(d<0){x=!0;break}w&&(E=!0)}if(!x&&E){const re=u-o;let ae=null;for(let Ge=1;ae===null&&Ge<re;Ge++)ae=this.getBlackPointOnSegment(o,m-Ge,o+Ge,m);if(ae==null)throw new ne;let be=null;for(let Ge=1;be===null&&Ge<re;Ge++)be=this.getBlackPointOnSegment(o,d+Ge,o+Ge,d);if(be==null)throw new ne;let Ne=null;for(let Ge=1;Ne===null&&Ge<re;Ge++)Ne=this.getBlackPointOnSegment(u,d+Ge,u-Ge,d);if(Ne==null)throw new ne;let $e=null;for(let Ge=1;$e===null&&Ge<re;Ge++)$e=this.getBlackPointOnSegment(u,m-Ge,u-Ge,m);if($e==null)throw new ne;return this.centerEdges($e,ae,Ne,be)}else throw new ne}getBlackPointOnSegment(o,u,d,m){const x=Ve.round(Ve.distance(o,u,d,m)),w=(d-o)/x,E=(m-u)/x,N=this.image;for(let O=0;O<x;O++){const I=Ve.round(o+O*w),P=Ve.round(u+O*E);if(N.get(I,P))return new tt(I,P)}return null}centerEdges(o,u,d,m){const x=o.getX(),w=o.getY(),E=u.getX(),N=u.getY(),O=d.getX(),I=d.getY(),P=m.getX(),F=m.getY(),q=on.CORR;return x<this.width/2?[new tt(P-q,F+q),new tt(E+q,N+q),new tt(O-q,I-q),new tt(x+q,w-q)]:[new tt(P+q,F+q),new tt(E+q,N-q),new tt(O-q,I+q),new tt(x-q,w-q)]}containsBlackPoint(o,u,d,m){const x=this.image;if(m){for(let w=o;w<=u;w++)if(x.get(w,d))return!0}else for(let w=o;w<=u;w++)if(x.get(d,w))return!0;return!1}}on.INIT_SIZE=10,on.CORR=1;class _s{static checkAndNudgePoints(o,u){const d=o.getWidth(),m=o.getHeight();let x=!0;for(let w=0;w<u.length&&x;w+=2){const E=Math.floor(u[w]),N=Math.floor(u[w+1]);if(E<-1||E>d||N<-1||N>m)throw new ne;x=!1,E===-1?(u[w]=0,x=!0):E===d&&(u[w]=d-1,x=!0),N===-1?(u[w+1]=0,x=!0):N===m&&(u[w+1]=m-1,x=!0)}x=!0;for(let w=u.length-2;w>=0&&x;w-=2){const E=Math.floor(u[w]),N=Math.floor(u[w+1]);if(E<-1||E>d||N<-1||N>m)throw new ne;x=!1,E===-1?(u[w]=0,x=!0):E===d&&(u[w]=d-1,x=!0),N===-1?(u[w+1]=0,x=!0):N===m&&(u[w+1]=m-1,x=!0)}}}class tr{constructor(o,u,d,m,x,w,E,N,O){this.a11=o,this.a21=u,this.a31=d,this.a12=m,this.a22=x,this.a32=w,this.a13=E,this.a23=N,this.a33=O}static quadrilateralToQuadrilateral(o,u,d,m,x,w,E,N,O,I,P,F,q,re,ae,be){const Ne=tr.quadrilateralToSquare(o,u,d,m,x,w,E,N);return tr.squareToQuadrilateral(O,I,P,F,q,re,ae,be).times(Ne)}transformPoints(o){const u=o.length,d=this.a11,m=this.a12,x=this.a13,w=this.a21,E=this.a22,N=this.a23,O=this.a31,I=this.a32,P=this.a33;for(let F=0;F<u;F+=2){const q=o[F],re=o[F+1],ae=x*q+N*re+P;o[F]=(d*q+w*re+O)/ae,o[F+1]=(m*q+E*re+I)/ae}}transformPointsWithValues(o,u){const d=this.a11,m=this.a12,x=this.a13,w=this.a21,E=this.a22,N=this.a23,O=this.a31,I=this.a32,P=this.a33,F=o.length;for(let q=0;q<F;q++){const re=o[q],ae=u[q],be=x*re+N*ae+P;o[q]=(d*re+w*ae+O)/be,u[q]=(m*re+E*ae+I)/be}}static squareToQuadrilateral(o,u,d,m,x,w,E,N){const O=o-d+x-E,I=u-m+w-N;if(O===0&&I===0)return new tr(d-o,x-d,o,m-u,w-m,u,0,0,1);{const P=d-x,F=E-x,q=m-w,re=N-w,ae=P*re-F*q,be=(O*re-F*I)/ae,Ne=(P*I-O*q)/ae;return new tr(d-o+be*d,E-o+Ne*E,o,m-u+be*m,N-u+Ne*N,u,be,Ne,1)}}static quadrilateralToSquare(o,u,d,m,x,w,E,N){return tr.squareToQuadrilateral(o,u,d,m,x,w,E,N).buildAdjoint()}buildAdjoint(){return new tr(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(o){return new tr(this.a11*o.a11+this.a21*o.a12+this.a31*o.a13,this.a11*o.a21+this.a21*o.a22+this.a31*o.a23,this.a11*o.a31+this.a21*o.a32+this.a31*o.a33,this.a12*o.a11+this.a22*o.a12+this.a32*o.a13,this.a12*o.a21+this.a22*o.a22+this.a32*o.a23,this.a12*o.a31+this.a22*o.a32+this.a32*o.a33,this.a13*o.a11+this.a23*o.a12+this.a33*o.a13,this.a13*o.a21+this.a23*o.a22+this.a33*o.a23,this.a13*o.a31+this.a23*o.a32+this.a33*o.a33)}}class jr extends _s{sampleGrid(o,u,d,m,x,w,E,N,O,I,P,F,q,re,ae,be,Ne,$e,Ge){const Ue=tr.quadrilateralToQuadrilateral(m,x,w,E,N,O,I,P,F,q,re,ae,be,Ne,$e,Ge);return this.sampleGridWithTransform(o,u,d,Ue)}sampleGridWithTransform(o,u,d,m){if(u<=0||d<=0)throw new ne;const x=new Ze(u,d),w=new Float32Array(2*u);for(let E=0;E<d;E++){const N=w.length,O=E+.5;for(let I=0;I<N;I+=2)w[I]=I/2+.5,w[I+1]=O;m.transformPoints(w),_s.checkAndNudgePoints(o,w);try{for(let I=0;I<N;I+=2)o.get(Math.floor(w[I]),Math.floor(w[I+1]))&&x.set(I/2,E)}catch{throw new ne}}return x}}class On{static setGridSampler(o){On.gridSampler=o}static getInstance(){return On.gridSampler}}On.gridSampler=new jr;class xn{constructor(o,u){this.x=o,this.y=u}toResultPoint(){return new tt(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class is{constructor(o){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=o}detect(){return this.detectMirror(!1)}detectMirror(o){let u=this.getMatrixCenter(),d=this.getBullsEyeCorners(u);if(o){let w=d[0];d[0]=d[2],d[2]=w}this.extractParameters(d);let m=this.sampleGrid(this.image,d[this.shift%4],d[(this.shift+1)%4],d[(this.shift+2)%4],d[(this.shift+3)%4]),x=this.getMatrixCornerPoints(d);return new Lr(m,x,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(o){if(!this.isValidPoint(o[0])||!this.isValidPoint(o[1])||!this.isValidPoint(o[2])||!this.isValidPoint(o[3]))throw new ne;let u=2*this.nbCenterLayers,d=new Int32Array([this.sampleLine(o[0],o[1],u),this.sampleLine(o[1],o[2],u),this.sampleLine(o[2],o[3],u),this.sampleLine(o[3],o[0],u)]);this.shift=this.getRotation(d,u);let m=0;for(let w=0;w<4;w++){let E=d[(this.shift+w)%4];this.compact?(m<<=7,m+=E>>1&127):(m<<=10,m+=(E>>2&992)+(E>>1&31))}let x=this.getCorrectedParameterData(m,this.compact);this.compact?(this.nbLayers=(x>>6)+1,this.nbDataBlocks=(x&63)+1):(this.nbLayers=(x>>11)+1,this.nbDataBlocks=(x&2047)+1)}getRotation(o,u){let d=0;o.forEach((m,x,w)=>{let E=(m>>u-2<<1)+(m&1);d=(d<<3)+E}),d=((d&1)<<11)+(d>>1);for(let m=0;m<4;m++)if(G.bitCount(d^this.EXPECTED_CORNER_BITS[m])<=2)return m;throw new ne}getCorrectedParameterData(o,u){let d,m;u?(d=7,m=2):(d=10,m=4);let x=d-m,w=new Int32Array(d);for(let N=d-1;N>=0;--N)w[N]=o&15,o>>=4;try{new Pt(ot.AZTEC_PARAM).decode(w,x)}catch{throw new ne}let E=0;for(let N=0;N<m;N++)E=(E<<4)+w[N];return E}getBullsEyeCorners(o){let u=o,d=o,m=o,x=o,w=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let P=this.getFirstDifferent(u,w,1,-1),F=this.getFirstDifferent(d,w,1,1),q=this.getFirstDifferent(m,w,-1,1),re=this.getFirstDifferent(x,w,-1,-1);if(this.nbCenterLayers>2){let ae=this.distancePoint(re,P)*this.nbCenterLayers/(this.distancePoint(x,u)*(this.nbCenterLayers+2));if(ae<.75||ae>1.25||!this.isWhiteOrBlackRectangle(P,F,q,re))break}u=P,d=F,m=q,x=re,w=!w}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ne;this.compact=this.nbCenterLayers===5;let E=new tt(u.getX()+.5,u.getY()-.5),N=new tt(d.getX()+.5,d.getY()+.5),O=new tt(m.getX()-.5,m.getY()+.5),I=new tt(x.getX()-.5,x.getY()-.5);return this.expandSquare([E,N,O,I],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let o,u,d,m;try{let E=new on(this.image).detect();o=E[0],u=E[1],d=E[2],m=E[3]}catch{let N=this.image.getWidth()/2,O=this.image.getHeight()/2;o=this.getFirstDifferent(new xn(N+7,O-7),!1,1,-1).toResultPoint(),u=this.getFirstDifferent(new xn(N+7,O+7),!1,1,1).toResultPoint(),d=this.getFirstDifferent(new xn(N-7,O+7),!1,-1,1).toResultPoint(),m=this.getFirstDifferent(new xn(N-7,O-7),!1,-1,-1).toResultPoint()}let x=Ve.round((o.getX()+m.getX()+u.getX()+d.getX())/4),w=Ve.round((o.getY()+m.getY()+u.getY()+d.getY())/4);try{let E=new on(this.image,15,x,w).detect();o=E[0],u=E[1],d=E[2],m=E[3]}catch{o=this.getFirstDifferent(new xn(x+7,w-7),!1,1,-1).toResultPoint(),u=this.getFirstDifferent(new xn(x+7,w+7),!1,1,1).toResultPoint(),d=this.getFirstDifferent(new xn(x-7,w+7),!1,-1,1).toResultPoint(),m=this.getFirstDifferent(new xn(x-7,w-7),!1,-1,-1).toResultPoint()}return x=Ve.round((o.getX()+m.getX()+u.getX()+d.getX())/4),w=Ve.round((o.getY()+m.getY()+u.getY()+d.getY())/4),new xn(x,w)}getMatrixCornerPoints(o){return this.expandSquare(o,2*this.nbCenterLayers,this.getDimension())}sampleGrid(o,u,d,m,x){let w=On.getInstance(),E=this.getDimension(),N=E/2-this.nbCenterLayers,O=E/2+this.nbCenterLayers;return w.sampleGrid(o,E,E,N,N,O,N,O,O,N,O,u.getX(),u.getY(),d.getX(),d.getY(),m.getX(),m.getY(),x.getX(),x.getY())}sampleLine(o,u,d){let m=0,x=this.distanceResultPoint(o,u),w=x/d,E=o.getX(),N=o.getY(),O=w*(u.getX()-o.getX())/x,I=w*(u.getY()-o.getY())/x;for(let P=0;P<d;P++)this.image.get(Ve.round(E+P*O),Ve.round(N+P*I))&&(m|=1<<d-P-1);return m}isWhiteOrBlackRectangle(o,u,d,m){let x=3;o=new xn(o.getX()-x,o.getY()+x),u=new xn(u.getX()-x,u.getY()-x),d=new xn(d.getX()+x,d.getY()-x),m=new xn(m.getX()+x,m.getY()+x);let w=this.getColor(m,o);if(w===0)return!1;let E=this.getColor(o,u);return E!==w||(E=this.getColor(u,d),E!==w)?!1:(E=this.getColor(d,m),E===w)}getColor(o,u){let d=this.distancePoint(o,u),m=(u.getX()-o.getX())/d,x=(u.getY()-o.getY())/d,w=0,E=o.getX(),N=o.getY(),O=this.image.get(o.getX(),o.getY()),I=Math.ceil(d);for(let F=0;F<I;F++)E+=m,N+=x,this.image.get(Ve.round(E),Ve.round(N))!==O&&w++;let P=w/d;return P>.1&&P<.9?0:P<=.1===O?1:-1}getFirstDifferent(o,u,d,m){let x=o.getX()+d,w=o.getY()+m;for(;this.isValid(x,w)&&this.image.get(x,w)===u;)x+=d,w+=m;for(x-=d,w-=m;this.isValid(x,w)&&this.image.get(x,w)===u;)x+=d;for(x-=d;this.isValid(x,w)&&this.image.get(x,w)===u;)w+=m;return w-=m,new xn(x,w)}expandSquare(o,u,d){let m=d/(2*u),x=o[0].getX()-o[2].getX(),w=o[0].getY()-o[2].getY(),E=(o[0].getX()+o[2].getX())/2,N=(o[0].getY()+o[2].getY())/2,O=new tt(E+m*x,N+m*w),I=new tt(E-m*x,N-m*w);x=o[1].getX()-o[3].getX(),w=o[1].getY()-o[3].getY(),E=(o[1].getX()+o[3].getX())/2,N=(o[1].getY()+o[3].getY())/2;let P=new tt(E+m*x,N+m*w),F=new tt(E-m*x,N-m*w);return[O,P,I,F]}isValid(o,u){return o>=0&&o<this.image.getWidth()&&u>0&&u<this.image.getHeight()}isValidPoint(o){let u=Ve.round(o.getX()),d=Ve.round(o.getY());return this.isValid(u,d)}distancePoint(o,u){return Ve.distance(o.getX(),o.getY(),u.getX(),u.getY())}distanceResultPoint(o,u){return Ve.distance(o.getX(),o.getY(),u.getX(),u.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(G.truncDivision(this.nbLayers-4,8)+1)+15}}class nr{decode(o,u=null){let d=null,m=new is(o.getBlackMatrix()),x=null,w=null;try{let I=m.detectMirror(!1);x=I.getPoints(),this.reportFoundResultPoints(u,x),w=new ft().decode(I)}catch(I){d=I}if(w==null)try{let I=m.detectMirror(!0);x=I.getPoints(),this.reportFoundResultPoints(u,x),w=new ft().decode(I)}catch(I){throw d??I}let E=new ge(w.getText(),w.getRawBytes(),w.getNumBits(),x,se.AZTEC,M.currentTimeMillis()),N=w.getByteSegments();N!=null&&E.putMetadata(K.BYTE_SEGMENTS,N);let O=w.getECLevel();return O!=null&&E.putMetadata(K.ERROR_CORRECTION_LEVEL,O),E}reportFoundResultPoints(o,u){if(o!=null){let d=o.get(oe.NEED_RESULT_POINT_CALLBACK);d!=null&&u.forEach((m,x,w)=>{d.foundPossibleResultPoint(m)})}}reset(){}}class ms extends fe{constructor(o=500){super(new nr,o)}}class ln{decode(o,u){try{return this.doDecode(o,u)}catch{if(u&&u.get(oe.TRY_HARDER)===!0&&o.isRotateSupported()){const x=o.rotateCounterClockwise(),w=this.doDecode(x,u),E=w.getResultMetadata();let N=270;E!==null&&E.get(K.ORIENTATION)===!0&&(N=N+E.get(K.ORIENTATION)%360),w.putMetadata(K.ORIENTATION,N);const O=w.getResultPoints();if(O!==null){const I=x.getHeight();for(let P=0;P<O.length;P++)O[P]=new tt(I-O[P].getY()-1,O[P].getX())}return w}else throw new ne}}reset(){}doDecode(o,u){const d=o.getWidth(),m=o.getHeight();let x=new Z(d);const w=u&&u.get(oe.TRY_HARDER)===!0,E=Math.max(1,m>>(w?8:5));let N;w?N=m:N=15;const O=Math.trunc(m/2);for(let I=0;I<N;I++){const P=Math.trunc((I+1)/2),F=(I&1)===0,q=O+E*(F?P:-P);if(q<0||q>=m)break;try{x=o.getBlackRow(q,x)}catch{continue}for(let re=0;re<2;re++){if(re===1&&(x.reverse(),u&&u.get(oe.NEED_RESULT_POINT_CALLBACK)===!0)){const ae=new Map;u.forEach((be,Ne)=>ae.set(Ne,be)),ae.delete(oe.NEED_RESULT_POINT_CALLBACK),u=ae}try{const ae=this.decodeRow(q,x,u);if(re===1){ae.putMetadata(K.ORIENTATION,180);const be=ae.getResultPoints();be!==null&&(be[0]=new tt(d-be[0].getX()-1,be[0].getY()),be[1]=new tt(d-be[1].getX()-1,be[1].getY()))}return ae}catch{}}}throw new ne}static recordPattern(o,u,d){const m=d.length;for(let O=0;O<m;O++)d[O]=0;const x=o.getSize();if(u>=x)throw new ne;let w=!o.get(u),E=0,N=u;for(;N<x;){if(o.get(N)!==w)d[E]++;else{if(++E===m)break;d[E]=1,w=!w}N++}if(!(E===m||E===m-1&&N===x))throw new ne}static recordPatternInReverse(o,u,d){let m=d.length,x=o.get(u);for(;u>0&&m>=0;)o.get(--u)!==x&&(m--,x=!x);if(m>=0)throw new ne;ln.recordPattern(o,u+1,d)}static patternMatchVariance(o,u,d){const m=o.length;let x=0,w=0;for(let O=0;O<m;O++)x+=o[O],w+=u[O];if(x<w)return Number.POSITIVE_INFINITY;const E=x/w;d*=E;let N=0;for(let O=0;O<m;O++){const I=o[O],P=u[O]*E,F=I>P?I-P:P-I;if(F>d)return Number.POSITIVE_INFINITY;N+=F}return N/x}}class He extends ln{static findStartPattern(o){const u=o.getSize(),d=o.getNextSet(0);let m=0,x=Int32Array.from([0,0,0,0,0,0]),w=d,E=!1;const N=6;for(let O=d;O<u;O++)if(o.get(O)!==E)x[m]++;else{if(m===N-1){let I=He.MAX_AVG_VARIANCE,P=-1;for(let F=He.CODE_START_A;F<=He.CODE_START_C;F++){const q=ln.patternMatchVariance(x,He.CODE_PATTERNS[F],He.MAX_INDIVIDUAL_VARIANCE);q<I&&(I=q,P=F)}if(P>=0&&o.isRange(Math.max(0,w-(O-w)/2),w,!1))return Int32Array.from([w,O,P]);w+=x[0]+x[1],x=x.slice(2,x.length-1),x[m-1]=0,x[m]=0,m--}else m++;x[m]=1,E=!E}throw new ne}static decodeCode(o,u,d){ln.recordPattern(o,d,u);let m=He.MAX_AVG_VARIANCE,x=-1;for(let w=0;w<He.CODE_PATTERNS.length;w++){const E=He.CODE_PATTERNS[w],N=this.patternMatchVariance(u,E,He.MAX_INDIVIDUAL_VARIANCE);N<m&&(m=N,x=w)}if(x>=0)return x;throw new ne}decodeRow(o,u,d){const m=d&&d.get(oe.ASSUME_GS1)===!0,x=He.findStartPattern(u),w=x[2];let E=0;const N=new Uint8Array(20);N[E++]=w;let O;switch(w){case He.CODE_START_A:O=He.CODE_CODE_A;break;case He.CODE_START_B:O=He.CODE_CODE_B;break;case He.CODE_START_C:O=He.CODE_CODE_C;break;default:throw new U}let I=!1,P=!1,F="",q=x[0],re=x[1];const ae=Int32Array.from([0,0,0,0,0,0]);let be=0,Ne=0,$e=w,Ge=0,Ue=!0,Ht=!1,Lt=!1;for(;!I;){const Qi=P;switch(P=!1,be=Ne,Ne=He.decodeCode(u,ae,re),N[E++]=Ne,Ne!==He.CODE_STOP&&(Ue=!0),Ne!==He.CODE_STOP&&(Ge++,$e+=Ge*Ne),q=re,re+=ae.reduce((If,Au)=>If+Au,0),Ne){case He.CODE_START_A:case He.CODE_START_B:case He.CODE_START_C:throw new U}switch(O){case He.CODE_CODE_A:if(Ne<64)Lt===Ht?F+=String.fromCharCode(32+Ne):F+=String.fromCharCode(32+Ne+128),Lt=!1;else if(Ne<96)Lt===Ht?F+=String.fromCharCode(Ne-64):F+=String.fromCharCode(Ne+64),Lt=!1;else switch(Ne!==He.CODE_STOP&&(Ue=!1),Ne){case He.CODE_FNC_1:m&&(F.length===0?F+="]C1":F+="");break;case He.CODE_FNC_2:case He.CODE_FNC_3:break;case He.CODE_FNC_4_A:!Ht&&Lt?(Ht=!0,Lt=!1):Ht&&Lt?(Ht=!1,Lt=!1):Lt=!0;break;case He.CODE_SHIFT:P=!0,O=He.CODE_CODE_B;break;case He.CODE_CODE_B:O=He.CODE_CODE_B;break;case He.CODE_CODE_C:O=He.CODE_CODE_C;break;case He.CODE_STOP:I=!0;break}break;case He.CODE_CODE_B:if(Ne<96)Lt===Ht?F+=String.fromCharCode(32+Ne):F+=String.fromCharCode(32+Ne+128),Lt=!1;else switch(Ne!==He.CODE_STOP&&(Ue=!1),Ne){case He.CODE_FNC_1:m&&(F.length===0?F+="]C1":F+="");break;case He.CODE_FNC_2:case He.CODE_FNC_3:break;case He.CODE_FNC_4_B:!Ht&&Lt?(Ht=!0,Lt=!1):Ht&&Lt?(Ht=!1,Lt=!1):Lt=!0;break;case He.CODE_SHIFT:P=!0,O=He.CODE_CODE_A;break;case He.CODE_CODE_A:O=He.CODE_CODE_A;break;case He.CODE_CODE_C:O=He.CODE_CODE_C;break;case He.CODE_STOP:I=!0;break}break;case He.CODE_CODE_C:if(Ne<100)Ne<10&&(F+="0"),F+=Ne;else switch(Ne!==He.CODE_STOP&&(Ue=!1),Ne){case He.CODE_FNC_1:m&&(F.length===0?F+="]C1":F+="");break;case He.CODE_CODE_A:O=He.CODE_CODE_A;break;case He.CODE_CODE_B:O=He.CODE_CODE_B;break;case He.CODE_STOP:I=!0;break}break}Qi&&(O=O===He.CODE_CODE_A?He.CODE_CODE_B:He.CODE_CODE_A)}const rr=re-q;if(re=u.getNextUnset(re),!u.isRange(re,Math.min(u.getSize(),re+(re-q)/2),!1))throw new ne;if($e-=Ge*be,$e%103!==be)throw new T;const ws=F.length;if(ws===0)throw new ne;ws>0&&Ue&&(O===He.CODE_CODE_C?F=F.substring(0,ws-2):F=F.substring(0,ws-1));const Ur=(x[1]+x[0])/2,vn=q+rr/2,Ar=N.length,cs=new Uint8Array(Ar);for(let Qi=0;Qi<Ar;Qi++)cs[Qi]=N[Qi];const Wa=[new tt(Ur,o),new tt(vn,o)];return new ge(F,cs,0,Wa,se.CODE_128,new Date().getTime())}}He.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],He.MAX_AVG_VARIANCE=.25,He.MAX_INDIVIDUAL_VARIANCE=.7,He.CODE_SHIFT=98,He.CODE_CODE_C=99,He.CODE_CODE_B=100,He.CODE_CODE_A=101,He.CODE_FNC_1=102,He.CODE_FNC_2=97,He.CODE_FNC_3=96,He.CODE_FNC_4_A=101,He.CODE_FNC_4_B=100,He.CODE_START_A=103,He.CODE_START_B=104,He.CODE_START_C=105,He.CODE_STOP=106;class Zt extends ln{constructor(o=!1,u=!1){super(),this.usingCheckDigit=o,this.extendedMode=u,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(o,u,d){let m=this.counters;m.fill(0),this.decodeRowResult="";let x=Zt.findAsteriskPattern(u,m),w=u.getNextSet(x[1]),E=u.getSize(),N,O;do{Zt.recordPattern(u,w,m);let ae=Zt.toNarrowWidePattern(m);if(ae<0)throw new ne;N=Zt.patternToChar(ae),this.decodeRowResult+=N,O=w;for(let be of m)w+=be;w=u.getNextSet(w)}while(N!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let I=0;for(let ae of m)I+=ae;let P=w-O-I;if(w!==E&&P*2<I)throw new ne;if(this.usingCheckDigit){let ae=this.decodeRowResult.length-1,be=0;for(let Ne=0;Ne<ae;Ne++)be+=Zt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ne));if(this.decodeRowResult.charAt(ae)!==Zt.ALPHABET_STRING.charAt(be%43))throw new T;this.decodeRowResult=this.decodeRowResult.substring(0,ae)}if(this.decodeRowResult.length===0)throw new ne;let F;this.extendedMode?F=Zt.decodeExtended(this.decodeRowResult):F=this.decodeRowResult;let q=(x[1]+x[0])/2,re=O+I/2;return new ge(F,null,0,[new tt(q,o),new tt(re,o)],se.CODE_39,new Date().getTime())}static findAsteriskPattern(o,u){let d=o.getSize(),m=o.getNextSet(0),x=0,w=m,E=!1,N=u.length;for(let O=m;O<d;O++)if(o.get(O)!==E)u[x]++;else{if(x===N-1){if(this.toNarrowWidePattern(u)===Zt.ASTERISK_ENCODING&&o.isRange(Math.max(0,w-Math.floor((O-w)/2)),w,!1))return[w,O];w+=u[0]+u[1],u.copyWithin(0,2,2+x-1),u[x-1]=0,u[x]=0,x--}else x++;u[x]=1,E=!E}throw new ne}static toNarrowWidePattern(o){let u=o.length,d=0,m;do{let x=2147483647;for(let N of o)N<x&&N>d&&(x=N);d=x,m=0;let w=0,E=0;for(let N=0;N<u;N++){let O=o[N];O>d&&(E|=1<<u-1-N,m++,w+=O)}if(m===3){for(let N=0;N<u&&m>0;N++){let O=o[N];if(O>d&&(m--,O*2>=w))return-1}return E}}while(m>3);return-1}static patternToChar(o){for(let u=0;u<Zt.CHARACTER_ENCODINGS.length;u++)if(Zt.CHARACTER_ENCODINGS[u]===o)return Zt.ALPHABET_STRING.charAt(u);if(o===Zt.ASTERISK_ENCODING)return"*";throw new ne}static decodeExtended(o){let u=o.length,d="";for(let m=0;m<u;m++){let x=o.charAt(m);if(x==="+"||x==="$"||x==="%"||x==="/"){let w=o.charAt(m+1),E="\0";switch(x){case"+":if(w>="A"&&w<="Z")E=String.fromCharCode(w.charCodeAt(0)+32);else throw new U;break;case"$":if(w>="A"&&w<="Z")E=String.fromCharCode(w.charCodeAt(0)-64);else throw new U;break;case"%":if(w>="A"&&w<="E")E=String.fromCharCode(w.charCodeAt(0)-38);else if(w>="F"&&w<="J")E=String.fromCharCode(w.charCodeAt(0)-11);else if(w>="K"&&w<="O")E=String.fromCharCode(w.charCodeAt(0)+16);else if(w>="P"&&w<="T")E=String.fromCharCode(w.charCodeAt(0)+43);else if(w==="U")E="\0";else if(w==="V")E="@";else if(w==="W")E="`";else if(w==="X"||w==="Y"||w==="Z")E="";else throw new U;break;case"/":if(w>="A"&&w<="O")E=String.fromCharCode(w.charCodeAt(0)-32);else if(w==="Z")E=":";else throw new U;break}d+=E,m++}else d+=x}return d}}Zt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Zt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Zt.ASTERISK_ENCODING=148;class At extends ln{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(o,u,d){let m=this.decodeStart(u),x=this.decodeEnd(u),w=new Ie;At.decodeMiddle(u,m[1],x[0],w);let E=w.toString(),N=null;d!=null&&(N=d.get(oe.ALLOWED_LENGTHS)),N==null&&(N=At.DEFAULT_ALLOWED_LENGTHS);let O=E.length,I=!1,P=0;for(let re of N){if(O===re){I=!0;break}re>P&&(P=re)}if(!I&&O>P&&(I=!0),!I)throw new U;const F=[new tt(m[1],o),new tt(x[0],o)];return new ge(E,null,0,F,se.ITF,new Date().getTime())}static decodeMiddle(o,u,d,m){let x=new Int32Array(10),w=new Int32Array(5),E=new Int32Array(5);for(x.fill(0),w.fill(0),E.fill(0);u<d;){ln.recordPattern(o,u,x);for(let O=0;O<5;O++){let I=2*O;w[O]=x[I],E[O]=x[I+1]}let N=At.decodeDigit(w);m.append(N.toString()),N=this.decodeDigit(E),m.append(N.toString()),x.forEach(function(O){u+=O})}}decodeStart(o){let u=At.skipWhiteSpace(o),d=At.findGuardPattern(o,u,At.START_PATTERN);return this.narrowLineWidth=(d[1]-d[0])/4,this.validateQuietZone(o,d[0]),d}validateQuietZone(o,u){let d=this.narrowLineWidth*10;d=d<u?d:u;for(let m=u-1;d>0&&m>=0&&!o.get(m);m--)d--;if(d!==0)throw new ne}static skipWhiteSpace(o){const u=o.getSize(),d=o.getNextSet(0);if(d===u)throw new ne;return d}decodeEnd(o){o.reverse();try{let u=At.skipWhiteSpace(o),d;try{d=At.findGuardPattern(o,u,At.END_PATTERN_REVERSED[0])}catch(x){x instanceof ne&&(d=At.findGuardPattern(o,u,At.END_PATTERN_REVERSED[1]))}this.validateQuietZone(o,d[0]);let m=d[0];return d[0]=o.getSize()-d[1],d[1]=o.getSize()-m,d}finally{o.reverse()}}static findGuardPattern(o,u,d){let m=d.length,x=new Int32Array(m),w=o.getSize(),E=!1,N=0,O=u;x.fill(0);for(let I=u;I<w;I++)if(o.get(I)!==E)x[N]++;else{if(N===m-1){if(ln.patternMatchVariance(x,d,At.MAX_INDIVIDUAL_VARIANCE)<At.MAX_AVG_VARIANCE)return[O,I];O+=x[0]+x[1],M.arraycopy(x,2,x,0,N-1),x[N-1]=0,x[N]=0,N--}else N++;x[N]=1,E=!E}throw new ne}static decodeDigit(o){let u=At.MAX_AVG_VARIANCE,d=-1,m=At.PATTERNS.length;for(let x=0;x<m;x++){let w=At.PATTERNS[x],E=ln.patternMatchVariance(o,w,At.MAX_INDIVIDUAL_VARIANCE);E<u?(u=E,d=x):E===u&&(d=-1)}if(d>=0)return d%10;throw new ne}}At.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],At.MAX_AVG_VARIANCE=.38,At.MAX_INDIVIDUAL_VARIANCE=.5,At.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],At.START_PATTERN=Int32Array.from([1,1,1,1]),At.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class cn extends ln{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(o){let u=!1,d,m=0,x=Int32Array.from([0,0,0]);for(;!u;){x=Int32Array.from([0,0,0]),d=cn.findGuardPattern(o,m,!1,this.START_END_PATTERN,x);let w=d[0];m=d[1];let E=w-(m-w);E>=0&&(u=o.isRange(E,w,!1))}return d}static checkChecksum(o){return cn.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let u=o.length;if(u===0)return!1;let d=parseInt(o.charAt(u-1),10);return cn.getStandardUPCEANChecksum(o.substring(0,u-1))===d}static getStandardUPCEANChecksum(o){let u=o.length,d=0;for(let m=u-1;m>=0;m-=2){let x=o.charAt(m).charCodeAt(0)-48;if(x<0||x>9)throw new U;d+=x}d*=3;for(let m=u-2;m>=0;m-=2){let x=o.charAt(m).charCodeAt(0)-48;if(x<0||x>9)throw new U;d+=x}return(1e3-d)%10}static decodeEnd(o,u){return cn.findGuardPattern(o,u,!1,cn.START_END_PATTERN,new Int32Array(cn.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(o,u,d,m){return this.findGuardPattern(o,u,d,m,new Int32Array(m.length))}static findGuardPattern(o,u,d,m,x){let w=o.getSize();u=d?o.getNextUnset(u):o.getNextSet(u);let E=0,N=u,O=m.length,I=d;for(let P=u;P<w;P++)if(o.get(P)!==I)x[E]++;else{if(E===O-1){if(ln.patternMatchVariance(x,m,cn.MAX_INDIVIDUAL_VARIANCE)<cn.MAX_AVG_VARIANCE)return Int32Array.from([N,P]);N+=x[0]+x[1];let F=x.slice(2,x.length-1);for(let q=0;q<E-1;q++)x[q]=F[q];x[E-1]=0,x[E]=0,E--}else E++;x[E]=1,I=!I}throw new ne}static decodeDigit(o,u,d,m){this.recordPattern(o,d,u);let x=this.MAX_AVG_VARIANCE,w=-1,E=m.length;for(let N=0;N<E;N++){let O=m[N],I=ln.patternMatchVariance(u,O,cn.MAX_INDIVIDUAL_VARIANCE);I<x&&(x=I,w=N)}if(w>=0)return w;throw new ne}}cn.MAX_AVG_VARIANCE=.48,cn.MAX_INDIVIDUAL_VARIANCE=.7,cn.START_END_PATTERN=Int32Array.from([1,1,1]),cn.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),cn.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),cn.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class bn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,u,d){let m=this.decodeRowStringBuffer,x=this.decodeMiddle(u,d,m),w=m.toString(),E=bn.parseExtensionString(w),N=[new tt((d[0]+d[1])/2,o),new tt(x,o)],O=new ge(w,null,0,N,se.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&O.putAllMetadata(E),O}decodeMiddle(o,u,d){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let x=o.getSize(),w=u[1],E=0;for(let O=0;O<5&&w<x;O++){let I=cn.decodeDigit(o,m,w,cn.L_AND_G_PATTERNS);d+=String.fromCharCode(48+I%10);for(let P of m)w+=P;I>=10&&(E|=1<<4-O),O!==4&&(w=o.getNextSet(w),w=o.getNextUnset(w))}if(d.length!==5)throw new ne;let N=this.determineCheckDigit(E);if(bn.extensionChecksum(d.toString())!==N)throw new ne;return w}static extensionChecksum(o){let u=o.length,d=0;for(let m=u-2;m>=0;m-=2)d+=o.charAt(m).charCodeAt(0)-48;d*=3;for(let m=u-1;m>=0;m-=2)d+=o.charAt(m).charCodeAt(0)-48;return d*=3,d%10}determineCheckDigit(o){for(let u=0;u<10;u++)if(o===this.CHECK_DIGIT_ENCODINGS[u])return u;throw new ne}static parseExtensionString(o){if(o.length!==5)return null;let u=bn.parseExtension5String(o);return u==null?null:new Map([[K.SUGGESTED_PRICE,u]])}static parseExtension5String(o){let u;switch(o.charAt(0)){case"0":u="";break;case"5":u="$";break;case"9":switch(o){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}u="";break;default:u="";break}let d=parseInt(o.substring(1)),m=(d/100).toString(),x=d%100,w=x<10?"0"+x:x.toString();return u+m+"."+w}}class gs{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,u,d){let m=this.decodeRowStringBuffer,x=this.decodeMiddle(u,d,m),w=m.toString(),E=gs.parseExtensionString(w),N=[new tt((d[0]+d[1])/2,o),new tt(x,o)],O=new ge(w,null,0,N,se.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&O.putAllMetadata(E),O}decodeMiddle(o,u,d){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let x=o.getSize(),w=u[1],E=0;for(let N=0;N<2&&w<x;N++){let O=cn.decodeDigit(o,m,w,cn.L_AND_G_PATTERNS);d+=String.fromCharCode(48+O%10);for(let I of m)w+=I;O>=10&&(E|=1<<1-N),N!==1&&(w=o.getNextSet(w),w=o.getNextUnset(w))}if(d.length!==2)throw new ne;if(parseInt(d.toString())%4!==E)throw new ne;return w}static parseExtensionString(o){return o.length!==2?null:new Map([[K.ISSUE_NUMBER,parseInt(o)]])}}class Br{static decodeRow(o,u,d){let m=cn.findGuardPattern(u,d,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new bn().decodeRow(o,u,m)}catch{return new gs().decodeRow(o,u,m)}}}Br.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Dt extends cn{constructor(){super(),this.decodeRowStringBuffer="",Dt.L_AND_G_PATTERNS=Dt.L_PATTERNS.map(o=>Int32Array.from(o));for(let o=10;o<20;o++){let u=Dt.L_PATTERNS[o-10],d=new Int32Array(u.length);for(let m=0;m<u.length;m++)d[m]=u[u.length-m-1];Dt.L_AND_G_PATTERNS[o]=d}}decodeRow(o,u,d){let m=Dt.findStartGuardPattern(u),x=d==null?null:d.get(oe.NEED_RESULT_POINT_CALLBACK);if(x!=null){const Ue=new tt((m[0]+m[1])/2,o);x.foundPossibleResultPoint(Ue)}let w=this.decodeMiddle(u,m,this.decodeRowStringBuffer),E=w.rowOffset,N=w.resultString;if(x!=null){const Ue=new tt(E,o);x.foundPossibleResultPoint(Ue)}let O=this.decodeEnd(u,E);if(x!=null){const Ue=new tt((O[0]+O[1])/2,o);x.foundPossibleResultPoint(Ue)}let I=O[1],P=I+(I-O[0]);if(P>=u.getSize()||!u.isRange(I,P,!1))throw new ne;let F=N.toString();if(F.length<8)throw new U;if(!Dt.checkChecksum(F))throw new T;let q=(m[1]+m[0])/2,re=(O[1]+O[0])/2,ae=this.getBarcodeFormat(),be=[new tt(q,o),new tt(re,o)],Ne=new ge(F,null,0,be,ae,new Date().getTime()),$e=0;try{let Ue=Br.decodeRow(o,u,O[1]);Ne.putMetadata(K.UPC_EAN_EXTENSION,Ue.getText()),Ne.putAllMetadata(Ue.getResultMetadata()),Ne.addResultPoints(Ue.getResultPoints()),$e=Ue.getText().length}catch{}let Ge=d==null?null:d.get(oe.ALLOWED_EAN_EXTENSIONS);if(Ge!=null){let Ue=!1;for(let Ht in Ge)if($e.toString()===Ht){Ue=!0;break}if(!Ue)throw new ne}return Ne}decodeEnd(o,u){return Dt.findGuardPattern(o,u,!1,Dt.START_END_PATTERN,new Int32Array(Dt.START_END_PATTERN.length).fill(0))}static checkChecksum(o){return Dt.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let u=o.length;if(u===0)return!1;let d=parseInt(o.charAt(u-1),10);return Dt.getStandardUPCEANChecksum(o.substring(0,u-1))===d}static getStandardUPCEANChecksum(o){let u=o.length,d=0;for(let m=u-1;m>=0;m-=2){let x=o.charAt(m).charCodeAt(0)-48;if(x<0||x>9)throw new U;d+=x}d*=3;for(let m=u-2;m>=0;m-=2){let x=o.charAt(m).charCodeAt(0)-48;if(x<0||x>9)throw new U;d+=x}return(1e3-d)%10}}class Gt extends Dt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,u,d){let m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let x=o.getSize(),w=u[1],E=0;for(let O=0;O<6&&w<x;O++){let I=Dt.decodeDigit(o,m,w,Dt.L_AND_G_PATTERNS);d+=String.fromCharCode(48+I%10);for(let P of m)w+=P;I>=10&&(E|=1<<5-O)}d=Gt.determineFirstDigit(d,E),w=Dt.findGuardPattern(o,w,!0,Dt.MIDDLE_PATTERN,new Int32Array(Dt.MIDDLE_PATTERN.length).fill(0))[1];for(let O=0;O<6&&w<x;O++){let I=Dt.decodeDigit(o,m,w,Dt.L_PATTERNS);d+=String.fromCharCode(48+I);for(let P of m)w+=P}return{rowOffset:w,resultString:d}}getBarcodeFormat(){return se.EAN_13}static determineFirstDigit(o,u){for(let d=0;d<10;d++)if(u===this.FIRST_DIGIT_ENCODINGS[d])return o=String.fromCharCode(48+d)+o,o;throw new ne}}Gt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class pn extends Dt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,u,d){const m=this.decodeMiddleCounters;m[0]=0,m[1]=0,m[2]=0,m[3]=0;let x=o.getSize(),w=u[1];for(let N=0;N<4&&w<x;N++){let O=Dt.decodeDigit(o,m,w,Dt.L_PATTERNS);d+=String.fromCharCode(48+O);for(let I of m)w+=I}w=Dt.findGuardPattern(o,w,!0,Dt.MIDDLE_PATTERN,new Int32Array(Dt.MIDDLE_PATTERN.length).fill(0))[1];for(let N=0;N<4&&w<x;N++){let O=Dt.decodeDigit(o,m,w,Dt.L_PATTERNS);d+=String.fromCharCode(48+O);for(let I of m)w+=I}return{rowOffset:w,resultString:d}}getBarcodeFormat(){return se.EAN_8}}class Bn extends Dt{constructor(){super(...arguments),this.ean13Reader=new Gt}getBarcodeFormat(){return se.UPC_A}decode(o,u){return this.maybeReturnResult(this.ean13Reader.decode(o))}decodeRow(o,u,d){return this.maybeReturnResult(this.ean13Reader.decodeRow(o,u,d))}decodeMiddle(o,u,d){return this.ean13Reader.decodeMiddle(o,u,d)}maybeReturnResult(o){let u=o.getText();if(u.charAt(0)==="0"){let d=new ge(u.substring(1),null,null,o.getResultPoints(),se.UPC_A);return o.getResultMetadata()!=null&&d.putAllMetadata(o.getResultMetadata()),d}else throw new ne}reset(){this.ean13Reader.reset()}}class Jt extends Dt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(o,u,d){const m=this.decodeMiddleCounters.map(O=>O);m[0]=0,m[1]=0,m[2]=0,m[3]=0;const x=o.getSize();let w=u[1],E=0;for(let O=0;O<6&&w<x;O++){const I=Jt.decodeDigit(o,m,w,Jt.L_AND_G_PATTERNS);d+=String.fromCharCode(48+I%10);for(let P of m)w+=P;I>=10&&(E|=1<<5-O)}let N=Jt.determineNumSysAndCheckDigit(d,E);return{rowOffset:w,resultString:N}}decodeEnd(o,u){return Jt.findGuardPatternWithoutCounters(o,u,!0,Jt.MIDDLE_END_PATTERN)}checkChecksum(o){return Dt.checkChecksum(Jt.convertUPCEtoUPCA(o))}static determineNumSysAndCheckDigit(o,u){for(let d=0;d<=1;d++)for(let m=0;m<10;m++)if(u===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[d][m]){let x=String.fromCharCode(48+d),w=String.fromCharCode(48+m);return x+o+w}throw ne.getNotFoundInstance()}getBarcodeFormat(){return se.UPC_E}static convertUPCEtoUPCA(o){const u=o.slice(1,7).split("").map(x=>x.charCodeAt(0)),d=new Ie;d.append(o.charAt(0));let m=u[5];switch(m){case 0:case 1:case 2:d.appendChars(u,0,2),d.append(m),d.append("0000"),d.appendChars(u,2,3);break;case 3:d.appendChars(u,0,3),d.append("00000"),d.appendChars(u,3,2);break;case 4:d.appendChars(u,0,4),d.append("00000"),d.append(u[4]);break;default:d.appendChars(u,0,5),d.append("0000"),d.append(m);break}return o.length>=8&&d.append(o.charAt(7)),d.toString()}}Jt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Jt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class dn extends ln{constructor(o){super();let u=o==null?null:o.get(oe.POSSIBLE_FORMATS),d=[];r(u)?(d.push(new Gt),d.push(new Bn),d.push(new pn),d.push(new Jt)):(u.indexOf(se.EAN_13)>-1&&d.push(new Gt),u.indexOf(se.UPC_A)>-1&&d.push(new Bn),u.indexOf(se.EAN_8)>-1&&d.push(new pn),u.indexOf(se.UPC_E)>-1&&d.push(new Jt)),this.readers=d}decodeRow(o,u,d){for(let m of this.readers)try{const x=m.decodeRow(o,u,d),w=x.getBarcodeFormat()===se.EAN_13&&x.getText().charAt(0)==="0",E=d==null?null:d.get(oe.POSSIBLE_FORMATS),N=E==null||E.includes(se.UPC_A);if(w&&N){const O=x.getRawBytes(),I=new ge(x.getText().substring(1),O,O?O.length:null,x.getResultPoints(),se.UPC_A);return I.putAllMetadata(x.getResultMetadata()),I}return x}catch{}throw new ne}reset(){for(let o of this.readers)o.reset()}}class de extends ln{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(o,u){for(let d=0;d<u.length;d++)if(ln.patternMatchVariance(o,u[d],de.MAX_INDIVIDUAL_VARIANCE)<de.MAX_AVG_VARIANCE)return d;throw new ne}static count(o){return Ve.sum(new Int32Array(o))}static increment(o,u){let d=0,m=u[0];for(let x=1;x<o.length;x++)u[x]>m&&(m=u[x],d=x);o[d]++}static decrement(o,u){let d=0,m=u[0];for(let x=1;x<o.length;x++)u[x]<m&&(m=u[x],d=x);o[d]--}static isFinderPattern(o){let u=o[0]+o[1],d=u+o[2]+o[3],m=u/d;if(m>=de.MIN_FINDER_PATTERN_RATIO&&m<=de.MAX_FINDER_PATTERN_RATIO){let x=Number.MAX_SAFE_INTEGER,w=Number.MIN_SAFE_INTEGER;for(let E of o)E>w&&(w=E),E<x&&(x=E);return w<10*x}return!1}}de.MAX_AVG_VARIANCE=.2,de.MAX_INDIVIDUAL_VARIANCE=.45,de.MIN_FINDER_PATTERN_RATIO=9.5/12,de.MAX_FINDER_PATTERN_RATIO=12.5/14;class we{constructor(o,u){this.value=o,this.checksumPortion=u}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(o){if(!(o instanceof we))return!1;const u=o;return this.value===u.value&&this.checksumPortion===u.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Oe{constructor(o,u,d,m,x){this.value=o,this.startEnd=u,this.value=o,this.startEnd=u,this.resultPoints=new Array,this.resultPoints.push(new tt(d,x)),this.resultPoints.push(new tt(m,x))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(o){if(!(o instanceof Oe))return!1;const u=o;return this.value===u.value}hashCode(){return this.value}}class Fe{constructor(){}static getRSSvalue(o,u,d){let m=0;for(let N of o)m+=N;let x=0,w=0,E=o.length;for(let N=0;N<E-1;N++){let O;for(O=1,w|=1<<N;O<o[N];O++,w&=~(1<<N)){let I=Fe.combins(m-O-1,E-N-2);if(d&&w===0&&m-O-(E-N-1)>=E-N-1&&(I-=Fe.combins(m-O-(E-N),E-N-2)),E-N-1>1){let P=0;for(let F=m-O-(E-N-2);F>u;F--)P+=Fe.combins(m-O-F-1,E-N-3);I-=P*(E-1-N)}else m-O>u&&I--;x+=I}m-=O}return x}static combins(o,u){let d,m;o-u>u?(m=u,d=o-u):(m=o-u,d=u);let x=1,w=1;for(let E=o;E>d;E--)x*=E,w<=m&&(x/=w,w++);for(;w<=m;)x/=w,w++;return x}}class it{static buildBitArray(o){let u=o.length*2-1;o[o.length-1].getRightChar()==null&&(u-=1);let d=12*u,m=new Z(d),x=0,E=o[0].getRightChar().getValue();for(let N=11;N>=0;--N)(E&1<<N)!=0&&m.set(x),x++;for(let N=1;N<o.length;++N){let O=o[N],I=O.getLeftChar().getValue();for(let P=11;P>=0;--P)(I&1<<P)!=0&&m.set(x),x++;if(O.getRightChar()!=null){let P=O.getRightChar().getValue();for(let F=11;F>=0;--F)(P&1<<F)!=0&&m.set(x),x++}}return m}}class nt{constructor(o,u){u?this.decodedInformation=null:(this.finished=o,this.decodedInformation=u)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Xe{constructor(o){this.newPosition=o}getNewPosition(){return this.newPosition}}class ct extends Xe{constructor(o,u){super(o),this.value=u}getValue(){return this.value}isFNC1(){return this.value===ct.FNC1}}ct.FNC1="$";class ut extends Xe{constructor(o,u,d){super(o),d?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=u}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class yt extends Xe{constructor(o,u,d){if(super(o),u<0||u>10||d<0||d>10)throw new U;this.firstDigit=u,this.secondDigit=d}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===yt.FNC1}isSecondDigitFNC1(){return this.secondDigit===yt.FNC1}isAnyFNC1(){return this.firstDigit===yt.FNC1||this.secondDigit===yt.FNC1}}yt.FNC1=10;class De{constructor(){}static parseFieldsInGeneralPurpose(o){if(!o)return null;if(o.length<2)throw new ne;let u=o.substring(0,2);for(let x of De.TWO_DIGIT_DATA_LENGTH)if(x[0]===u)return x[1]===De.VARIABLE_LENGTH?De.processVariableAI(2,x[2],o):De.processFixedAI(2,x[1],o);if(o.length<3)throw new ne;let d=o.substring(0,3);for(let x of De.THREE_DIGIT_DATA_LENGTH)if(x[0]===d)return x[1]===De.VARIABLE_LENGTH?De.processVariableAI(3,x[2],o):De.processFixedAI(3,x[1],o);for(let x of De.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(x[0]===d)return x[1]===De.VARIABLE_LENGTH?De.processVariableAI(4,x[2],o):De.processFixedAI(4,x[1],o);if(o.length<4)throw new ne;let m=o.substring(0,4);for(let x of De.FOUR_DIGIT_DATA_LENGTH)if(x[0]===m)return x[1]===De.VARIABLE_LENGTH?De.processVariableAI(4,x[2],o):De.processFixedAI(4,x[1],o);throw new ne}static processFixedAI(o,u,d){if(d.length<o)throw new ne;let m=d.substring(0,o);if(d.length<o+u)throw new ne;let x=d.substring(o,o+u),w=d.substring(o+u),E="("+m+")"+x,N=De.parseFieldsInGeneralPurpose(w);return N==null?E:E+N}static processVariableAI(o,u,d){let m=d.substring(0,o),x;d.length<o+u?x=d.length:x=o+u;let w=d.substring(o,x),E=d.substring(x),N="("+m+")"+w,O=De.parseFieldsInGeneralPurpose(E);return O==null?N:N+O}}De.VARIABLE_LENGTH=[],De.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",De.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",De.VARIABLE_LENGTH,20],["22",De.VARIABLE_LENGTH,29],["30",De.VARIABLE_LENGTH,8],["37",De.VARIABLE_LENGTH,8],["90",De.VARIABLE_LENGTH,30],["91",De.VARIABLE_LENGTH,30],["92",De.VARIABLE_LENGTH,30],["93",De.VARIABLE_LENGTH,30],["94",De.VARIABLE_LENGTH,30],["95",De.VARIABLE_LENGTH,30],["96",De.VARIABLE_LENGTH,30],["97",De.VARIABLE_LENGTH,3],["98",De.VARIABLE_LENGTH,30],["99",De.VARIABLE_LENGTH,30]],De.THREE_DIGIT_DATA_LENGTH=[["240",De.VARIABLE_LENGTH,30],["241",De.VARIABLE_LENGTH,30],["242",De.VARIABLE_LENGTH,6],["250",De.VARIABLE_LENGTH,30],["251",De.VARIABLE_LENGTH,30],["253",De.VARIABLE_LENGTH,17],["254",De.VARIABLE_LENGTH,20],["400",De.VARIABLE_LENGTH,30],["401",De.VARIABLE_LENGTH,30],["402",17],["403",De.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",De.VARIABLE_LENGTH,20],["421",De.VARIABLE_LENGTH,15],["422",3],["423",De.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],De.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",De.VARIABLE_LENGTH,15],["391",De.VARIABLE_LENGTH,18],["392",De.VARIABLE_LENGTH,15],["393",De.VARIABLE_LENGTH,18],["703",De.VARIABLE_LENGTH,30]],De.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",De.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",De.VARIABLE_LENGTH,20],["8003",De.VARIABLE_LENGTH,30],["8004",De.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",De.VARIABLE_LENGTH,30],["8008",De.VARIABLE_LENGTH,12],["8018",18],["8020",De.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",De.VARIABLE_LENGTH,70],["8200",De.VARIABLE_LENGTH,70]];class Tt{constructor(o){this.buffer=new Ie,this.information=o}decodeAllCodes(o,u){let d=u,m=null;do{let x=this.decodeGeneralPurposeField(d,m),w=De.parseFieldsInGeneralPurpose(x.getNewString());if(w!=null&&o.append(w),x.isRemaining()?m=""+x.getRemainingValue():m=null,d===x.getNewPosition())break;d=x.getNewPosition()}while(!0);return o.toString()}isStillNumeric(o){if(o+7>this.information.getSize())return o+4<=this.information.getSize();for(let u=o;u<o+3;++u)if(this.information.get(u))return!0;return this.information.get(o+3)}decodeNumeric(o){if(o+7>this.information.getSize()){let x=this.extractNumericValueFromBitArray(o,4);return x===0?new yt(this.information.getSize(),yt.FNC1,yt.FNC1):new yt(this.information.getSize(),x-1,yt.FNC1)}let u=this.extractNumericValueFromBitArray(o,7),d=(u-8)/11,m=(u-8)%11;return new yt(o+7,d,m)}extractNumericValueFromBitArray(o,u){return Tt.extractNumericValueFromBitArray(this.information,o,u)}static extractNumericValueFromBitArray(o,u,d){let m=0;for(let x=0;x<d;++x)o.get(u+x)&&(m|=1<<d-x-1);return m}decodeGeneralPurposeField(o,u){this.buffer.setLengthToZero(),u!=null&&this.buffer.append(u),this.current.setPosition(o);let d=this.parseBlocks();return d!=null&&d.isRemaining()?new ut(this.current.getPosition(),this.buffer.toString(),d.getRemainingValue()):new ut(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let o,u;do{let d=this.current.getPosition();if(this.current.isAlpha()?(u=this.parseAlphaBlock(),o=u.isFinished()):this.current.isIsoIec646()?(u=this.parseIsoIec646Block(),o=u.isFinished()):(u=this.parseNumericBlock(),o=u.isFinished()),!(d!==this.current.getPosition())&&!o)break}while(!o);return u.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let o=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFirstDigitFNC1()){let u;return o.isSecondDigitFNC1()?u=new ut(this.current.getPosition(),this.buffer.toString()):u=new ut(this.current.getPosition(),this.buffer.toString(),o.getSecondDigit()),new nt(!0,u)}if(this.buffer.append(o.getFirstDigit()),o.isSecondDigitFNC1()){let u=new ut(this.current.getPosition(),this.buffer.toString());return new nt(!0,u)}this.buffer.append(o.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new nt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let o=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let u=new ut(this.current.getPosition(),this.buffer.toString());return new nt(!0,u)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new nt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let o=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let u=new ut(this.current.getPosition(),this.buffer.toString());return new nt(!0,u)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new nt(!1)}isStillIsoIec646(o){if(o+5>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(o,5);if(u>=5&&u<16)return!0;if(o+7>this.information.getSize())return!1;let d=this.extractNumericValueFromBitArray(o,7);if(d>=64&&d<116)return!0;if(o+8>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(o,8);return m>=232&&m<253}decodeIsoIec646(o){let u=this.extractNumericValueFromBitArray(o,5);if(u===15)return new ct(o+5,ct.FNC1);if(u>=5&&u<15)return new ct(o+5,"0"+(u-5));let d=this.extractNumericValueFromBitArray(o,7);if(d>=64&&d<90)return new ct(o+7,""+(d+1));if(d>=90&&d<116)return new ct(o+7,""+(d+7));let m=this.extractNumericValueFromBitArray(o,8),x;switch(m){case 232:x="!";break;case 233:x='"';break;case 234:x="%";break;case 235:x="&";break;case 236:x="'";break;case 237:x="(";break;case 238:x=")";break;case 239:x="*";break;case 240:x="+";break;case 241:x=",";break;case 242:x="-";break;case 243:x=".";break;case 244:x="/";break;case 245:x=":";break;case 246:x=";";break;case 247:x="<";break;case 248:x="=";break;case 249:x=">";break;case 250:x="?";break;case 251:x="_";break;case 252:x=" ";break;default:throw new U}return new ct(o+8,x)}isStillAlpha(o){if(o+5>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(o,5);if(u>=5&&u<16)return!0;if(o+6>this.information.getSize())return!1;let d=this.extractNumericValueFromBitArray(o,6);return d>=16&&d<63}decodeAlphanumeric(o){let u=this.extractNumericValueFromBitArray(o,5);if(u===15)return new ct(o+5,ct.FNC1);if(u>=5&&u<15)return new ct(o+5,"0"+(u-5));let d=this.extractNumericValueFromBitArray(o,6);if(d>=32&&d<58)return new ct(o+6,""+(d+33));let m;switch(d){case 58:m="*";break;case 59:m=",";break;case 60:m="-";break;case 61:m=".";break;case 62:m="/";break;default:throw new jt("Decoding invalid alphanumeric value: "+d)}return new ct(o+6,m)}isAlphaTo646ToAlphaLatch(o){if(o+1>this.information.getSize())return!1;for(let u=0;u<5&&u+o<this.information.getSize();++u)if(u===2){if(!this.information.get(o+2))return!1}else if(this.information.get(o+u))return!1;return!0}isAlphaOr646ToNumericLatch(o){if(o+3>this.information.getSize())return!1;for(let u=o;u<o+3;++u)if(this.information.get(u))return!1;return!0}isNumericToAlphaNumericLatch(o){if(o+1>this.information.getSize())return!1;for(let u=0;u<4&&u+o<this.information.getSize();++u)if(this.information.get(o+u))return!1;return!0}}class qt{constructor(o){this.information=o,this.generalDecoder=new Tt(o)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class _t extends qt{constructor(o){super(o)}encodeCompressedGtin(o,u){o.append("(01)");let d=o.length();o.append("9"),this.encodeCompressedGtinWithoutAI(o,u,d)}encodeCompressedGtinWithoutAI(o,u,d){for(let m=0;m<4;++m){let x=this.getGeneralDecoder().extractNumericValueFromBitArray(u+10*m,10);x/100===0&&o.append("0"),x/10===0&&o.append("0"),o.append(x)}_t.appendCheckDigit(o,d)}static appendCheckDigit(o,u){let d=0;for(let m=0;m<13;m++){let x=o.charAt(m+u).charCodeAt(0)-48;d+=(m&1)===0?3*x:x}d=10-d%10,d===10&&(d=0),o.append(d)}}_t.GTIN_SIZE=40;class Pr extends _t{constructor(o){super(o)}parseInformation(){let o=new Ie;o.append("(01)");let u=o.length(),d=this.getGeneralDecoder().extractNumericValueFromBitArray(Pr.HEADER_SIZE,4);return o.append(d),this.encodeCompressedGtinWithoutAI(o,Pr.HEADER_SIZE+4,u),this.getGeneralDecoder().decodeAllCodes(o,Pr.HEADER_SIZE+44)}}Pr.HEADER_SIZE=4;class Si extends qt{constructor(o){super(o)}parseInformation(){let o=new Ie;return this.getGeneralDecoder().decodeAllCodes(o,Si.HEADER_SIZE)}}Si.HEADER_SIZE=5;class ja extends _t{constructor(o){super(o)}encodeCompressedWeight(o,u,d){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(u,d);this.addWeightCode(o,m);let x=this.checkWeight(m),w=1e5;for(let E=0;E<5;++E)x/w===0&&o.append("0"),w/=10;o.append(x)}}class xs extends ja{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()!=xs.HEADER_SIZE+ja.GTIN_SIZE+xs.WEIGHT_SIZE)throw new ne;let o=new Ie;return this.encodeCompressedGtin(o,xs.HEADER_SIZE),this.encodeCompressedWeight(o,xs.HEADER_SIZE+ja.GTIN_SIZE,xs.WEIGHT_SIZE),o.toString()}}xs.HEADER_SIZE=5,xs.WEIGHT_SIZE=15;class $o extends xs{constructor(o){super(o)}addWeightCode(o,u){o.append("(3103)")}checkWeight(o){return o}}class Ai extends xs{constructor(o){super(o)}addWeightCode(o,u){u<1e4?o.append("(3202)"):o.append("(3203)")}checkWeight(o){return o<1e4?o:o-1e4}}class Zr extends _t{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<Zr.HEADER_SIZE+_t.GTIN_SIZE)throw new ne;let o=new Ie;this.encodeCompressedGtin(o,Zr.HEADER_SIZE);let u=this.getGeneralDecoder().extractNumericValueFromBitArray(Zr.HEADER_SIZE+_t.GTIN_SIZE,Zr.LAST_DIGIT_SIZE);o.append("(392"),o.append(u),o.append(")");let d=this.getGeneralDecoder().decodeGeneralPurposeField(Zr.HEADER_SIZE+_t.GTIN_SIZE+Zr.LAST_DIGIT_SIZE,null);return o.append(d.getNewString()),o.toString()}}Zr.HEADER_SIZE=8,Zr.LAST_DIGIT_SIZE=2;class Yn extends _t{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<Yn.HEADER_SIZE+_t.GTIN_SIZE)throw new ne;let o=new Ie;this.encodeCompressedGtin(o,Yn.HEADER_SIZE);let u=this.getGeneralDecoder().extractNumericValueFromBitArray(Yn.HEADER_SIZE+_t.GTIN_SIZE,Yn.LAST_DIGIT_SIZE);o.append("(393"),o.append(u),o.append(")");let d=this.getGeneralDecoder().extractNumericValueFromBitArray(Yn.HEADER_SIZE+_t.GTIN_SIZE+Yn.LAST_DIGIT_SIZE,Yn.FIRST_THREE_DIGITS_SIZE);d/100==0&&o.append("0"),d/10==0&&o.append("0"),o.append(d);let m=this.getGeneralDecoder().decodeGeneralPurposeField(Yn.HEADER_SIZE+_t.GTIN_SIZE+Yn.LAST_DIGIT_SIZE+Yn.FIRST_THREE_DIGITS_SIZE,null);return o.append(m.getNewString()),o.toString()}}Yn.HEADER_SIZE=8,Yn.LAST_DIGIT_SIZE=2,Yn.FIRST_THREE_DIGITS_SIZE=10;class un extends ja{constructor(o,u,d){super(o),this.dateCode=d,this.firstAIdigits=u}parseInformation(){if(this.getInformation().getSize()!=un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE+un.DATE_SIZE)throw new ne;let o=new Ie;return this.encodeCompressedGtin(o,un.HEADER_SIZE),this.encodeCompressedWeight(o,un.HEADER_SIZE+un.GTIN_SIZE,un.WEIGHT_SIZE),this.encodeCompressedDate(o,un.HEADER_SIZE+un.GTIN_SIZE+un.WEIGHT_SIZE),o.toString()}encodeCompressedDate(o,u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(u,un.DATE_SIZE);if(d==38400)return;o.append("("),o.append(this.dateCode),o.append(")");let m=d%32;d/=32;let x=d%12+1;d/=12;let w=d;w/10==0&&o.append("0"),o.append(w),x/10==0&&o.append("0"),o.append(x),m/10==0&&o.append("0"),o.append(m)}addWeightCode(o,u){o.append("("),o.append(this.firstAIdigits),o.append(u/1e5),o.append(")")}checkWeight(o){return o%1e5}}un.HEADER_SIZE=8,un.WEIGHT_SIZE=20,un.DATE_SIZE=16;function Ni(B){try{if(B.get(1))return new Pr(B);if(!B.get(2))return new Si(B);switch(Tt.extractNumericValueFromBitArray(B,1,4)){case 4:return new $o(B);case 5:return new Ai(B)}switch(Tt.extractNumericValueFromBitArray(B,1,5)){case 12:return new Zr(B);case 13:return new Yn(B)}switch(Tt.extractNumericValueFromBitArray(B,1,7)){case 56:return new un(B,"310","11");case 57:return new un(B,"320","11");case 58:return new un(B,"310","13");case 59:return new un(B,"320","13");case 60:return new un(B,"310","15");case 61:return new un(B,"320","15");case 62:return new un(B,"310","17");case 63:return new un(B,"320","17")}}catch(o){throw console.log(o),new jt("unknown decoder: "+B)}}class Fr{constructor(o,u,d,m){this.leftchar=o,this.rightchar=u,this.finderpattern=d,this.maybeLast=m}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(o,u){return o instanceof Fr?Fr.equalsOrNull(o.leftchar,u.leftchar)&&Fr.equalsOrNull(o.rightchar,u.rightchar)&&Fr.equalsOrNull(o.finderpattern,u.finderpattern):!1}static equalsOrNull(o,u){return o===null?u===null:Fr.equals(o,u)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Kn{constructor(o,u,d){this.pairs=o,this.rowNumber=u,this.wasReversed=d}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(o){return this.checkEqualitity(this,o)}toString(){return"{ "+this.pairs+" }"}equals(o,u){return o instanceof Kn?this.checkEqualitity(o,u)&&o.wasReversed===u.wasReversed:!1}checkEqualitity(o,u){if(!o||!u)return;let d;return o.forEach((m,x)=>{u.forEach(w=>{m.getLeftChar().getValue()===w.getLeftChar().getValue()&&m.getRightChar().getValue()===w.getRightChar().getValue()&&m.getFinderPatter().getValue()===w.getFinderPatter().getValue()&&(d=!0)})}),d}}class Re extends de{constructor(o){super(...arguments),this.pairs=new Array(Re.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=o===!0}decodeRow(o,u,d){this.pairs.length=0,this.startFromEven=!1;try{return Re.constructResult(this.decodeRow2pairs(o,u))}catch(m){this.verbose&&console.log(m)}return this.pairs.length=0,this.startFromEven=!0,Re.constructResult(this.decodeRow2pairs(o,u))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(o,u){let d=!1;for(;!d;)try{this.pairs.push(this.retrieveNextPair(u,this.pairs,o))}catch(x){if(x instanceof ne){if(!this.pairs.length)throw new ne;d=!0}}if(this.checkChecksum())return this.pairs;let m;if(this.rows.length?m=!0:m=!1,this.storeRow(o,!1),m){let x=this.checkRowsBoolean(!1);if(x!=null||(x=this.checkRowsBoolean(!0),x!=null))return x}throw new ne}checkRowsBoolean(o){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,o&&(this.rows=this.rows.reverse());let u=null;try{u=this.checkRows(new Array,0)}catch(d){this.verbose&&console.log(d)}return o&&(this.rows=this.rows.reverse()),u}checkRows(o,u){for(let d=u;d<this.rows.length;d++){let m=this.rows[d];this.pairs.length=0;for(let w of o)this.pairs.push(w.getPairs());if(this.pairs.push(m.getPairs()),!Re.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let x=new Array(o);x.push(m);try{return this.checkRows(x,d+1)}catch(w){this.verbose&&console.log(w)}}throw new ne}static isValidSequence(o){for(let u of Re.FINDER_PATTERN_SEQUENCES){if(o.length>u.length)continue;let d=!0;for(let m=0;m<o.length;m++)if(o[m].getFinderPattern().getValue()!=u[m]){d=!1;break}if(d)return!0}return!1}storeRow(o,u){let d=0,m=!1,x=!1;for(;d<this.rows.length;){let w=this.rows[d];if(w.getRowNumber()>o){x=w.isEquivalent(this.pairs);break}m=w.isEquivalent(this.pairs),d++}x||m||Re.isPartialRow(this.pairs,this.rows)||(this.rows.push(d,new Kn(this.pairs,o,u)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(o,u){for(let d of u)if(d.getPairs().length!==o.length){for(let m of d.getPairs())for(let x of o)if(Fr.equals(m,x))break}}static isPartialRow(o,u){for(let d of u){let m=!0;for(let x of o){let w=!1;for(let E of d.getPairs())if(x.equals(E)){w=!0;break}if(!w){m=!1;break}}if(m)return!0}return!1}getRows(){return this.rows}static constructResult(o){let u=it.buildBitArray(o),m=Ni(u).parseInformation(),x=o[0].getFinderPattern().getResultPoints(),w=o[o.length-1].getFinderPattern().getResultPoints(),E=[x[0],x[1],w[0],w[1]];return new ge(m,null,null,E,se.RSS_EXPANDED,null)}checkChecksum(){let o=this.pairs.get(0),u=o.getLeftChar(),d=o.getRightChar();if(d==null)return!1;let m=d.getChecksumPortion(),x=2;for(let E=1;E<this.pairs.size();++E){let N=this.pairs.get(E);m+=N.getLeftChar().getChecksumPortion(),x++;let O=N.getRightChar();O!=null&&(m+=O.getChecksumPortion(),x++)}return m%=211,211*(x-4)+m==u.getValue()}static getNextSecondBar(o,u){let d;return o.get(u)?(d=o.getNextUnset(u),d=o.getNextSet(d)):(d=o.getNextSet(u),d=o.getNextUnset(d)),d}retrieveNextPair(o,u,d){let m=u.length%2==0;this.startFromEven&&(m=!m);let x,w=!0,E=-1;do this.findNextPair(o,u,E),x=this.parseFoundFinderPattern(o,d,m),x==null?E=Re.getNextSecondBar(o,this.startEnd[0]):w=!1;while(w);let N=this.decodeDataCharacter(o,x,m,!0);if(!this.isEmptyPair(u)&&u[u.length-1].mustBeLast())throw new ne;let O;try{O=this.decodeDataCharacter(o,x,m,!1)}catch(I){O=null,this.verbose&&console.log(I)}return new Fr(N,O,x,!0)}isEmptyPair(o){return o.length===0}findNextPair(o,u,d){let m=this.getDecodeFinderCounters();m[0]=0,m[1]=0,m[2]=0,m[3]=0;let x=o.getSize(),w;d>=0?w=d:this.isEmptyPair(u)?w=0:w=u[u.length-1].getFinderPattern().getStartEnd()[1];let E=u.length%2!=0;this.startFromEven&&(E=!E);let N=!1;for(;w<x&&(N=!o.get(w),!!N);)w++;let O=0,I=w;for(let P=w;P<x;P++)if(o.get(P)!=N)m[O]++;else{if(O==3){if(E&&Re.reverseCounters(m),Re.isFinderPattern(m)){this.startEnd[0]=I,this.startEnd[1]=P;return}E&&Re.reverseCounters(m),I+=m[0]+m[1],m[0]=m[2],m[1]=m[3],m[2]=0,m[3]=0,O--}else O++;m[O]=1,N=!N}throw new ne}static reverseCounters(o){let u=o.length;for(let d=0;d<u/2;++d){let m=o[d];o[d]=o[u-d-1],o[u-d-1]=m}}parseFoundFinderPattern(o,u,d){let m,x,w;if(d){let O=this.startEnd[0]-1;for(;O>=0&&!o.get(O);)O--;O++,m=this.startEnd[0]-O,x=O,w=this.startEnd[1]}else x=this.startEnd[0],w=o.getNextUnset(this.startEnd[1]+1),m=w-this.startEnd[1];let E=this.getDecodeFinderCounters();M.arraycopy(E,0,E,1,E.length-1),E[0]=m;let N;try{N=this.parseFinderValue(E,Re.FINDER_PATTERNS)}catch{return null}return new Oe(N,[x,w],x,w,u)}decodeDataCharacter(o,u,d,m){let x=this.getDataCharacterCounters();for(let vn=0;vn<x.length;vn++)x[vn]=0;if(m)Re.recordPatternInReverse(o,u.getStartEnd()[0],x);else{Re.recordPattern(o,u.getStartEnd()[1],x);for(let vn=0,Ar=x.length-1;vn<Ar;vn++,Ar--){let cs=x[vn];x[vn]=x[Ar],x[Ar]=cs}}let w=17,E=Ve.sum(new Int32Array(x))/w,N=(u.getStartEnd()[1]-u.getStartEnd()[0])/15;if(Math.abs(E-N)/N>.3)throw new ne;let O=this.getOddCounts(),I=this.getEvenCounts(),P=this.getOddRoundingErrors(),F=this.getEvenRoundingErrors();for(let vn=0;vn<x.length;vn++){let Ar=1*x[vn]/E,cs=Ar+.5;if(cs<1){if(Ar<.3)throw new ne;cs=1}else if(cs>8){if(Ar>8.7)throw new ne;cs=8}let Wa=vn/2;(vn&1)==0?(O[Wa]=cs,P[Wa]=Ar-cs):(I[Wa]=cs,F[Wa]=Ar-cs)}this.adjustOddEvenCounts(w);let q=4*u.getValue()+(d?0:2)+(m?0:1)-1,re=0,ae=0;for(let vn=O.length-1;vn>=0;vn--){if(Re.isNotA1left(u,d,m)){let Ar=Re.WEIGHTS[q][2*vn];ae+=O[vn]*Ar}re+=O[vn]}let be=0;for(let vn=I.length-1;vn>=0;vn--)if(Re.isNotA1left(u,d,m)){let Ar=Re.WEIGHTS[q][2*vn+1];be+=I[vn]*Ar}let Ne=ae+be;if((re&1)!=0||re>13||re<4)throw new ne;let $e=(13-re)/2,Ge=Re.SYMBOL_WIDEST[$e],Ue=9-Ge,Ht=Fe.getRSSvalue(O,Ge,!0),Lt=Fe.getRSSvalue(I,Ue,!1),rr=Re.EVEN_TOTAL_SUBSET[$e],ws=Re.GSUM[$e],Ur=Ht*rr+Lt+ws;return new we(Ur,Ne)}static isNotA1left(o,u,d){return!(o.getValue()==0&&u&&d)}adjustOddEvenCounts(o){let u=Ve.sum(new Int32Array(this.getOddCounts())),d=Ve.sum(new Int32Array(this.getEvenCounts())),m=!1,x=!1;u>13?x=!0:u<4&&(m=!0);let w=!1,E=!1;d>13?E=!0:d<4&&(w=!0);let N=u+d-o,O=(u&1)==1,I=(d&1)==0;if(N==1)if(O){if(I)throw new ne;x=!0}else{if(!I)throw new ne;E=!0}else if(N==-1)if(O){if(I)throw new ne;m=!0}else{if(!I)throw new ne;w=!0}else if(N==0){if(O){if(!I)throw new ne;u<d?(m=!0,E=!0):(x=!0,w=!0)}else if(I)throw new ne}else throw new ne;if(m){if(x)throw new ne;Re.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(x&&Re.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(E)throw new ne;Re.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&Re.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Re.SYMBOL_WIDEST=[7,5,4,3,1],Re.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Re.GSUM=[0,348,1388,2948,3988],Re.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Re.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Re.FINDER_PAT_A=0,Re.FINDER_PAT_B=1,Re.FINDER_PAT_C=2,Re.FINDER_PAT_D=3,Re.FINDER_PAT_E=4,Re.FINDER_PAT_F=5,Re.FINDER_PATTERN_SEQUENCES=[[Re.FINDER_PAT_A,Re.FINDER_PAT_A],[Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B],[Re.FINDER_PAT_A,Re.FINDER_PAT_C,Re.FINDER_PAT_B,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_C],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F]],Re.MAX_PAIRS=11;class $l extends we{constructor(o,u,d){super(o,u),this.count=0,this.finderPattern=d}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class sn extends de{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(o,u,d){const m=this.decodePair(u,!1,o,d);sn.addOrTally(this.possibleLeftPairs,m),u.reverse();let x=this.decodePair(u,!0,o,d);sn.addOrTally(this.possibleRightPairs,x),u.reverse();for(let w of this.possibleLeftPairs)if(w.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&sn.checkChecksum(w,E))return sn.constructResult(w,E)}throw new ne}static addOrTally(o,u){if(u==null)return;let d=!1;for(let m of o)if(m.getValue()===u.getValue()){m.incrementCount(),d=!0;break}d||o.push(u)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(o,u){let d=4537077*o.getValue()+u.getValue(),m=new String(d).toString(),x=new Ie;for(let O=13-m.length;O>0;O--)x.append("0");x.append(m);let w=0;for(let O=0;O<13;O++){let I=x.charAt(O).charCodeAt(0)-48;w+=(O&1)===0?3*I:I}w=10-w%10,w===10&&(w=0),x.append(w.toString());let E=o.getFinderPattern().getResultPoints(),N=u.getFinderPattern().getResultPoints();return new ge(x.toString(),null,0,[E[0],E[1],N[0],N[1]],se.RSS_14,new Date().getTime())}static checkChecksum(o,u){let d=(o.getChecksumPortion()+16*u.getChecksumPortion())%79,m=9*o.getFinderPattern().getValue()+u.getFinderPattern().getValue();return m>72&&m--,m>8&&m--,d===m}decodePair(o,u,d,m){try{let x=this.findFinderPattern(o,u),w=this.parseFoundFinderPattern(o,d,u,x),E=m==null?null:m.get(oe.NEED_RESULT_POINT_CALLBACK);if(E!=null){let I=(x[0]+x[1])/2;u&&(I=o.getSize()-1-I),E.foundPossibleResultPoint(new tt(I,d))}let N=this.decodeDataCharacter(o,w,!0),O=this.decodeDataCharacter(o,w,!1);return new $l(1597*N.getValue()+O.getValue(),N.getChecksumPortion()+4*O.getChecksumPortion(),w)}catch{return null}}decodeDataCharacter(o,u,d){let m=this.getDataCharacterCounters();for(let be=0;be<m.length;be++)m[be]=0;if(d)ln.recordPatternInReverse(o,u.getStartEnd()[0],m);else{ln.recordPattern(o,u.getStartEnd()[1]+1,m);for(let be=0,Ne=m.length-1;be<Ne;be++,Ne--){let $e=m[be];m[be]=m[Ne],m[Ne]=$e}}let x=d?16:15,w=Ve.sum(new Int32Array(m))/x,E=this.getOddCounts(),N=this.getEvenCounts(),O=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors();for(let be=0;be<m.length;be++){let Ne=m[be]/w,$e=Math.floor(Ne+.5);$e<1?$e=1:$e>8&&($e=8);let Ge=Math.floor(be/2);(be&1)===0?(E[Ge]=$e,O[Ge]=Ne-$e):(N[Ge]=$e,I[Ge]=Ne-$e)}this.adjustOddEvenCounts(d,x);let P=0,F=0;for(let be=E.length-1;be>=0;be--)F*=9,F+=E[be],P+=E[be];let q=0,re=0;for(let be=N.length-1;be>=0;be--)q*=9,q+=N[be],re+=N[be];let ae=F+3*q;if(d){if((P&1)!==0||P>12||P<4)throw new ne;let be=(12-P)/2,Ne=sn.OUTSIDE_ODD_WIDEST[be],$e=9-Ne,Ge=Fe.getRSSvalue(E,Ne,!1),Ue=Fe.getRSSvalue(N,$e,!0),Ht=sn.OUTSIDE_EVEN_TOTAL_SUBSET[be],Lt=sn.OUTSIDE_GSUM[be];return new we(Ge*Ht+Ue+Lt,ae)}else{if((re&1)!==0||re>10||re<4)throw new ne;let be=(10-re)/2,Ne=sn.INSIDE_ODD_WIDEST[be],$e=9-Ne,Ge=Fe.getRSSvalue(E,Ne,!0),Ue=Fe.getRSSvalue(N,$e,!1),Ht=sn.INSIDE_ODD_TOTAL_SUBSET[be],Lt=sn.INSIDE_GSUM[be];return new we(Ue*Ht+Ge+Lt,ae)}}findFinderPattern(o,u){let d=this.getDecodeFinderCounters();d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=o.getSize(),x=!1,w=0;for(;w<m&&(x=!o.get(w),u!==x);)w++;let E=0,N=w;for(let O=w;O<m;O++)if(o.get(O)!==x)d[E]++;else{if(E===3){if(de.isFinderPattern(d))return[N,O];N+=d[0]+d[1],d[0]=d[2],d[1]=d[3],d[2]=0,d[3]=0,E--}else E++;d[E]=1,x=!x}throw new ne}parseFoundFinderPattern(o,u,d,m){let x=o.get(m[0]),w=m[0]-1;for(;w>=0&&x!==o.get(w);)w--;w++;const E=m[0]-w,N=this.getDecodeFinderCounters(),O=new Int32Array(N.length);M.arraycopy(N,0,O,1,N.length-1),O[0]=E;const I=this.parseFinderValue(O,sn.FINDER_PATTERNS);let P=w,F=m[1];return d&&(P=o.getSize()-1-P,F=o.getSize()-1-F),new Oe(I,[w,m[1]],P,F,u)}adjustOddEvenCounts(o,u){let d=Ve.sum(new Int32Array(this.getOddCounts())),m=Ve.sum(new Int32Array(this.getEvenCounts())),x=!1,w=!1,E=!1,N=!1;o?(d>12?w=!0:d<4&&(x=!0),m>12?N=!0:m<4&&(E=!0)):(d>11?w=!0:d<5&&(x=!0),m>10?N=!0:m<4&&(E=!0));let O=d+m-u,I=(d&1)===(o?1:0),P=(m&1)===1;if(O===1)if(I){if(P)throw new ne;w=!0}else{if(!P)throw new ne;N=!0}else if(O===-1)if(I){if(P)throw new ne;x=!0}else{if(!P)throw new ne;E=!0}else if(O===0){if(I){if(!P)throw new ne;d<m?(x=!0,N=!0):(w=!0,E=!0)}else if(P)throw new ne}else throw new ne;if(x){if(w)throw new ne;de.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(w&&de.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(N)throw new ne;de.increment(this.getEvenCounts(),this.getOddRoundingErrors())}N&&de.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}sn.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],sn.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],sn.OUTSIDE_GSUM=[0,161,961,2015,2715],sn.INSIDE_GSUM=[0,336,1036,1516],sn.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],sn.INSIDE_ODD_WIDEST=[2,4,6,8],sn.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Jr extends ln{constructor(o,u){super(),this.readers=[],this.verbose=u===!0;const d=o?o.get(oe.POSSIBLE_FORMATS):null,m=o&&o.get(oe.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;d?((d.includes(se.EAN_13)||d.includes(se.UPC_A)||d.includes(se.EAN_8)||d.includes(se.UPC_E))&&this.readers.push(new dn(o)),d.includes(se.CODE_39)&&this.readers.push(new Zt(m)),d.includes(se.CODE_128)&&this.readers.push(new He),d.includes(se.ITF)&&this.readers.push(new At),d.includes(se.RSS_14)&&this.readers.push(new sn),d.includes(se.RSS_EXPANDED)&&this.readers.push(new Re(this.verbose))):(this.readers.push(new dn(o)),this.readers.push(new Zt),this.readers.push(new dn(o)),this.readers.push(new He),this.readers.push(new At),this.readers.push(new sn),this.readers.push(new Re(this.verbose)))}decodeRow(o,u,d){for(let m=0;m<this.readers.length;m++)try{return this.readers[m].decodeRow(o,u,d)}catch{}throw new ne}reset(){this.readers.forEach(o=>o.reset())}}class Xo extends fe{constructor(o=500,u){super(new Jr(u),o,u)}}class Qt{constructor(o,u,d){this.ecCodewords=o,this.ecBlocks=[u],d&&this.ecBlocks.push(d)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class $t{constructor(o,u){this.count=o,this.dataCodewords=u}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Wt{constructor(o,u,d,m,x,w){this.versionNumber=o,this.symbolSizeRows=u,this.symbolSizeColumns=d,this.dataRegionSizeRows=m,this.dataRegionSizeColumns=x,this.ecBlocks=w;let E=0;const N=w.getECCodewords(),O=w.getECBlocks();for(let I of O)E+=I.getCount()*(I.getDataCodewords()+N);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(o,u){if((o&1)!==0||(u&1)!==0)throw new U;for(let d of Wt.VERSIONS)if(d.symbolSizeRows===o&&d.symbolSizeColumns===u)return d;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new Wt(1,10,10,8,8,new Qt(5,new $t(1,3))),new Wt(2,12,12,10,10,new Qt(7,new $t(1,5))),new Wt(3,14,14,12,12,new Qt(10,new $t(1,8))),new Wt(4,16,16,14,14,new Qt(12,new $t(1,12))),new Wt(5,18,18,16,16,new Qt(14,new $t(1,18))),new Wt(6,20,20,18,18,new Qt(18,new $t(1,22))),new Wt(7,22,22,20,20,new Qt(20,new $t(1,30))),new Wt(8,24,24,22,22,new Qt(24,new $t(1,36))),new Wt(9,26,26,24,24,new Qt(28,new $t(1,44))),new Wt(10,32,32,14,14,new Qt(36,new $t(1,62))),new Wt(11,36,36,16,16,new Qt(42,new $t(1,86))),new Wt(12,40,40,18,18,new Qt(48,new $t(1,114))),new Wt(13,44,44,20,20,new Qt(56,new $t(1,144))),new Wt(14,48,48,22,22,new Qt(68,new $t(1,174))),new Wt(15,52,52,24,24,new Qt(42,new $t(2,102))),new Wt(16,64,64,14,14,new Qt(56,new $t(2,140))),new Wt(17,72,72,16,16,new Qt(36,new $t(4,92))),new Wt(18,80,80,18,18,new Qt(48,new $t(4,114))),new Wt(19,88,88,20,20,new Qt(56,new $t(4,144))),new Wt(20,96,96,22,22,new Qt(68,new $t(4,174))),new Wt(21,104,104,24,24,new Qt(56,new $t(6,136))),new Wt(22,120,120,18,18,new Qt(68,new $t(6,175))),new Wt(23,132,132,20,20,new Qt(62,new $t(8,163))),new Wt(24,144,144,22,22,new Qt(62,new $t(8,156),new $t(2,155))),new Wt(25,8,18,6,16,new Qt(7,new $t(1,5))),new Wt(26,8,32,6,14,new Qt(11,new $t(1,10))),new Wt(27,12,26,10,24,new Qt(14,new $t(1,16))),new Wt(28,12,36,10,16,new Qt(18,new $t(1,22))),new Wt(29,16,36,14,16,new Qt(24,new $t(1,32))),new Wt(30,16,48,14,22,new Qt(28,new $t(1,49)))]}}Wt.VERSIONS=Wt.buildVersions();class qi{constructor(o){const u=o.getHeight();if(u<8||u>144||(u&1)!==0)throw new U;this.version=qi.readVersion(o),this.mappingBitMatrix=this.extractDataRegion(o),this.readMappingMatrix=new Ze(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(o){const u=o.getHeight(),d=o.getWidth();return Wt.getVersionForDimensions(u,d)}readCodewords(){const o=new Int8Array(this.version.getTotalCodewords());let u=0,d=4,m=0;const x=this.mappingBitMatrix.getHeight(),w=this.mappingBitMatrix.getWidth();let E=!1,N=!1,O=!1,I=!1;do if(d===x&&m===0&&!E)o[u++]=this.readCorner1(x,w)&255,d-=2,m+=2,E=!0;else if(d===x-2&&m===0&&(w&3)!==0&&!N)o[u++]=this.readCorner2(x,w)&255,d-=2,m+=2,N=!0;else if(d===x+4&&m===2&&(w&7)===0&&!O)o[u++]=this.readCorner3(x,w)&255,d-=2,m+=2,O=!0;else if(d===x-2&&m===0&&(w&7)===4&&!I)o[u++]=this.readCorner4(x,w)&255,d-=2,m+=2,I=!0;else{do d<x&&m>=0&&!this.readMappingMatrix.get(m,d)&&(o[u++]=this.readUtah(d,m,x,w)&255),d-=2,m+=2;while(d>=0&&m<w);d+=1,m+=3;do d>=0&&m<w&&!this.readMappingMatrix.get(m,d)&&(o[u++]=this.readUtah(d,m,x,w)&255),d+=2,m-=2;while(d<x&&m>=0);d+=3,m+=1}while(d<x||m<w);if(u!==this.version.getTotalCodewords())throw new U;return o}readModule(o,u,d,m){return o<0&&(o+=d,u+=4-(d+4&7)),u<0&&(u+=m,o+=4-(m+4&7)),this.readMappingMatrix.set(u,o),this.mappingBitMatrix.get(u,o)}readUtah(o,u,d,m){let x=0;return this.readModule(o-2,u-2,d,m)&&(x|=1),x<<=1,this.readModule(o-2,u-1,d,m)&&(x|=1),x<<=1,this.readModule(o-1,u-2,d,m)&&(x|=1),x<<=1,this.readModule(o-1,u-1,d,m)&&(x|=1),x<<=1,this.readModule(o-1,u,d,m)&&(x|=1),x<<=1,this.readModule(o,u-2,d,m)&&(x|=1),x<<=1,this.readModule(o,u-1,d,m)&&(x|=1),x<<=1,this.readModule(o,u,d,m)&&(x|=1),x}readCorner1(o,u){let d=0;return this.readModule(o-1,0,o,u)&&(d|=1),d<<=1,this.readModule(o-1,1,o,u)&&(d|=1),d<<=1,this.readModule(o-1,2,o,u)&&(d|=1),d<<=1,this.readModule(0,u-2,o,u)&&(d|=1),d<<=1,this.readModule(0,u-1,o,u)&&(d|=1),d<<=1,this.readModule(1,u-1,o,u)&&(d|=1),d<<=1,this.readModule(2,u-1,o,u)&&(d|=1),d<<=1,this.readModule(3,u-1,o,u)&&(d|=1),d}readCorner2(o,u){let d=0;return this.readModule(o-3,0,o,u)&&(d|=1),d<<=1,this.readModule(o-2,0,o,u)&&(d|=1),d<<=1,this.readModule(o-1,0,o,u)&&(d|=1),d<<=1,this.readModule(0,u-4,o,u)&&(d|=1),d<<=1,this.readModule(0,u-3,o,u)&&(d|=1),d<<=1,this.readModule(0,u-2,o,u)&&(d|=1),d<<=1,this.readModule(0,u-1,o,u)&&(d|=1),d<<=1,this.readModule(1,u-1,o,u)&&(d|=1),d}readCorner3(o,u){let d=0;return this.readModule(o-1,0,o,u)&&(d|=1),d<<=1,this.readModule(o-1,u-1,o,u)&&(d|=1),d<<=1,this.readModule(0,u-3,o,u)&&(d|=1),d<<=1,this.readModule(0,u-2,o,u)&&(d|=1),d<<=1,this.readModule(0,u-1,o,u)&&(d|=1),d<<=1,this.readModule(1,u-3,o,u)&&(d|=1),d<<=1,this.readModule(1,u-2,o,u)&&(d|=1),d<<=1,this.readModule(1,u-1,o,u)&&(d|=1),d}readCorner4(o,u){let d=0;return this.readModule(o-3,0,o,u)&&(d|=1),d<<=1,this.readModule(o-2,0,o,u)&&(d|=1),d<<=1,this.readModule(o-1,0,o,u)&&(d|=1),d<<=1,this.readModule(0,u-2,o,u)&&(d|=1),d<<=1,this.readModule(0,u-1,o,u)&&(d|=1),d<<=1,this.readModule(1,u-1,o,u)&&(d|=1),d<<=1,this.readModule(2,u-1,o,u)&&(d|=1),d<<=1,this.readModule(3,u-1,o,u)&&(d|=1),d}extractDataRegion(o){const u=this.version.getSymbolSizeRows(),d=this.version.getSymbolSizeColumns();if(o.getHeight()!==u)throw new v("Dimension of bitMatrix must match the version size");const m=this.version.getDataRegionSizeRows(),x=this.version.getDataRegionSizeColumns(),w=u/m|0,E=d/x|0,N=w*m,O=E*x,I=new Ze(O,N);for(let P=0;P<w;++P){const F=P*m;for(let q=0;q<E;++q){const re=q*x;for(let ae=0;ae<m;++ae){const be=P*(m+2)+1+ae,Ne=F+ae;for(let $e=0;$e<x;++$e){const Ge=q*(x+2)+1+$e;if(o.get(Ge,be)){const Ue=re+$e;I.set(Ue,Ne)}}}}}return I}}class ki{constructor(o,u){this.numDataCodewords=o,this.codewords=u}static getDataBlocks(o,u){const d=u.getECBlocks();let m=0;const x=d.getECBlocks();for(let ae of x)m+=ae.getCount();const w=new Array(m);let E=0;for(let ae of x)for(let be=0;be<ae.getCount();be++){const Ne=ae.getDataCodewords(),$e=d.getECCodewords()+Ne;w[E++]=new ki(Ne,new Uint8Array($e))}const O=w[0].codewords.length-d.getECCodewords(),I=O-1;let P=0;for(let ae=0;ae<I;ae++)for(let be=0;be<E;be++)w[be].codewords[ae]=o[P++];const F=u.getVersionNumber()===24,q=F?8:E;for(let ae=0;ae<q;ae++)w[ae].codewords[O-1]=o[P++];const re=w[0].codewords.length;for(let ae=O;ae<re;ae++)for(let be=0;be<E;be++){const Ne=F?(be+8)%E:be,$e=F&&Ne>7?ae-1:ae;w[Ne].codewords[$e]=o[P++]}if(P!==o.length)throw new v;return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class ye{constructor(o){this.bytes=o,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(o){if(o<1||o>32||o>this.available())throw new v(""+o);let u=0,d=this.bitOffset,m=this.byteOffset;const x=this.bytes;if(d>0){const w=8-d,E=o<w?o:w,N=w-E,O=255>>8-E<<N;u=(x[m]&O)>>N,o-=E,d+=E,d===8&&(d=0,m++)}if(o>0){for(;o>=8;)u=u<<8|x[m]&255,m++,o-=8;if(o>0){const w=8-o,E=255>>w<<w;u=u<<o|(x[m]&E)>>w,d+=o}}return this.bitOffset=d,this.byteOffset=m,u}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var $;(function(B){B[B.PAD_ENCODE=0]="PAD_ENCODE",B[B.ASCII_ENCODE=1]="ASCII_ENCODE",B[B.C40_ENCODE=2]="C40_ENCODE",B[B.TEXT_ENCODE=3]="TEXT_ENCODE",B[B.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",B[B.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",B[B.BASE256_ENCODE=6]="BASE256_ENCODE"})($||($={}));class Ye{static decode(o){const u=new ye(o),d=new Ie,m=new Ie,x=new Array;let w=$.ASCII_ENCODE;do if(w===$.ASCII_ENCODE)w=this.decodeAsciiSegment(u,d,m);else{switch(w){case $.C40_ENCODE:this.decodeC40Segment(u,d);break;case $.TEXT_ENCODE:this.decodeTextSegment(u,d);break;case $.ANSIX12_ENCODE:this.decodeAnsiX12Segment(u,d);break;case $.EDIFACT_ENCODE:this.decodeEdifactSegment(u,d);break;case $.BASE256_ENCODE:this.decodeBase256Segment(u,d,x);break;default:throw new U}w=$.ASCII_ENCODE}while(w!==$.PAD_ENCODE&&u.available()>0);return m.length()>0&&d.append(m.toString()),new Ce(o,d.toString(),x.length===0?null:x,null)}static decodeAsciiSegment(o,u,d){let m=!1;do{let x=o.readBits(8);if(x===0)throw new U;if(x<=128)return m&&(x+=128),u.append(String.fromCharCode(x-1)),$.ASCII_ENCODE;if(x===129)return $.PAD_ENCODE;if(x<=229){const w=x-130;w<10&&u.append("0"),u.append(""+w)}else switch(x){case 230:return $.C40_ENCODE;case 231:return $.BASE256_ENCODE;case 232:u.append("");break;case 233:case 234:break;case 235:m=!0;break;case 236:u.append("[)>05"),d.insert(0,"");break;case 237:u.append("[)>06"),d.insert(0,"");break;case 238:return $.ANSIX12_ENCODE;case 239:return $.TEXT_ENCODE;case 240:return $.EDIFACT_ENCODE;case 241:break;default:if(x!==254||o.available()!==0)throw new U;break}}while(o.available()>0);return $.ASCII_ENCODE}static decodeC40Segment(o,u){let d=!1;const m=[];let x=0;do{if(o.available()===8)return;const w=o.readBits(8);if(w===254)return;this.parseTwoBytes(w,o.readBits(8),m);for(let E=0;E<3;E++){const N=m[E];switch(x){case 0:if(N<3)x=N+1;else if(N<this.C40_BASIC_SET_CHARS.length){const O=this.C40_BASIC_SET_CHARS[N];d?(u.append(String.fromCharCode(O.charCodeAt(0)+128)),d=!1):u.append(O)}else throw new U;break;case 1:d?(u.append(String.fromCharCode(N+128)),d=!1):u.append(String.fromCharCode(N)),x=0;break;case 2:if(N<this.C40_SHIFT2_SET_CHARS.length){const O=this.C40_SHIFT2_SET_CHARS[N];d?(u.append(String.fromCharCode(O.charCodeAt(0)+128)),d=!1):u.append(O)}else switch(N){case 27:u.append("");break;case 30:d=!0;break;default:throw new U}x=0;break;case 3:d?(u.append(String.fromCharCode(N+224)),d=!1):u.append(String.fromCharCode(N+96)),x=0;break;default:throw new U}}}while(o.available()>0)}static decodeTextSegment(o,u){let d=!1,m=[],x=0;do{if(o.available()===8)return;const w=o.readBits(8);if(w===254)return;this.parseTwoBytes(w,o.readBits(8),m);for(let E=0;E<3;E++){const N=m[E];switch(x){case 0:if(N<3)x=N+1;else if(N<this.TEXT_BASIC_SET_CHARS.length){const O=this.TEXT_BASIC_SET_CHARS[N];d?(u.append(String.fromCharCode(O.charCodeAt(0)+128)),d=!1):u.append(O)}else throw new U;break;case 1:d?(u.append(String.fromCharCode(N+128)),d=!1):u.append(String.fromCharCode(N)),x=0;break;case 2:if(N<this.TEXT_SHIFT2_SET_CHARS.length){const O=this.TEXT_SHIFT2_SET_CHARS[N];d?(u.append(String.fromCharCode(O.charCodeAt(0)+128)),d=!1):u.append(O)}else switch(N){case 27:u.append("");break;case 30:d=!0;break;default:throw new U}x=0;break;case 3:if(N<this.TEXT_SHIFT3_SET_CHARS.length){const O=this.TEXT_SHIFT3_SET_CHARS[N];d?(u.append(String.fromCharCode(O.charCodeAt(0)+128)),d=!1):u.append(O),x=0}else throw new U;break;default:throw new U}}}while(o.available()>0)}static decodeAnsiX12Segment(o,u){const d=[];do{if(o.available()===8)return;const m=o.readBits(8);if(m===254)return;this.parseTwoBytes(m,o.readBits(8),d);for(let x=0;x<3;x++){const w=d[x];switch(w){case 0:u.append("\r");break;case 1:u.append("*");break;case 2:u.append(">");break;case 3:u.append(" ");break;default:if(w<14)u.append(String.fromCharCode(w+44));else if(w<40)u.append(String.fromCharCode(w+51));else throw new U;break}}}while(o.available()>0)}static parseTwoBytes(o,u,d){let m=(o<<8)+u-1,x=Math.floor(m/1600);d[0]=x,m-=x*1600,x=Math.floor(m/40),d[1]=x,d[2]=m-x*40}static decodeEdifactSegment(o,u){do{if(o.available()<=16)return;for(let d=0;d<4;d++){let m=o.readBits(6);if(m===31){const x=8-o.getBitOffset();x!==8&&o.readBits(x);return}(m&32)===0&&(m|=64),u.append(String.fromCharCode(m))}}while(o.available()>0)}static decodeBase256Segment(o,u,d){let m=1+o.getByteOffset();const x=this.unrandomize255State(o.readBits(8),m++);let w;if(x===0?w=o.available()/8|0:x<250?w=x:w=250*(x-249)+this.unrandomize255State(o.readBits(8),m++),w<0)throw new U;const E=new Uint8Array(w);for(let N=0;N<w;N++){if(o.available()<8)throw new U;E[N]=this.unrandomize255State(o.readBits(8),m++)}d.push(E);try{u.append(je.decode(E,ue.ISO88591))}catch(N){throw new jt("Platform does not support required encoding: "+N.message)}}static unrandomize255State(o,u){const d=149*u%255+1,m=o-d;return m>=0?m:m+256}}Ye.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ye.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ye.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ye.TEXT_SHIFT2_SET_CHARS=Ye.C40_SHIFT2_SET_CHARS,Ye.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class qe{constructor(){this.rsDecoder=new Pt(ot.DATA_MATRIX_FIELD_256)}decode(o){const u=new qi(o),d=u.getVersion(),m=u.readCodewords(),x=ki.getDataBlocks(m,d);let w=0;for(let O of x)w+=O.getNumDataCodewords();const E=new Uint8Array(w),N=x.length;for(let O=0;O<N;O++){const I=x[O],P=I.getCodewords(),F=I.getNumDataCodewords();this.correctErrors(P,F);for(let q=0;q<F;q++)E[q*N+O]=P[q]}return Ye.decode(E)}correctErrors(o,u){const d=new Int32Array(o);try{this.rsDecoder.decode(d,o.length-u)}catch{throw new T}for(let m=0;m<u;m++)o[m]=d[m]}}class mt{constructor(o){this.image=o,this.rectangleDetector=new on(this.image)}detect(){const o=this.rectangleDetector.detect();let u=this.detectSolid1(o);if(u=this.detectSolid2(u),u[3]=this.correctTopRight(u),!u[3])throw new ne;u=this.shiftToModuleCenter(u);const d=u[0],m=u[1],x=u[2],w=u[3];let E=this.transitionsBetween(d,w)+1,N=this.transitionsBetween(x,w)+1;(E&1)===1&&(E+=1),(N&1)===1&&(N+=1),4*E<7*N&&4*N<7*E&&(E=N=Math.max(E,N));let O=mt.sampleGrid(this.image,d,m,x,w,E,N);return new Xn(O,[d,m,x,w])}static shiftPoint(o,u,d){let m=(u.getX()-o.getX())/(d+1),x=(u.getY()-o.getY())/(d+1);return new tt(o.getX()+m,o.getY()+x)}static moveAway(o,u,d){let m=o.getX(),x=o.getY();return m<u?m-=1:m+=1,x<d?x-=1:x+=1,new tt(m,x)}detectSolid1(o){let u=o[0],d=o[1],m=o[3],x=o[2],w=this.transitionsBetween(u,d),E=this.transitionsBetween(d,m),N=this.transitionsBetween(m,x),O=this.transitionsBetween(x,u),I=w,P=[x,u,d,m];return I>E&&(I=E,P[0]=u,P[1]=d,P[2]=m,P[3]=x),I>N&&(I=N,P[0]=d,P[1]=m,P[2]=x,P[3]=u),I>O&&(P[0]=m,P[1]=x,P[2]=u,P[3]=d),P}detectSolid2(o){let u=o[0],d=o[1],m=o[2],x=o[3],w=this.transitionsBetween(u,x),E=mt.shiftPoint(d,m,(w+1)*4),N=mt.shiftPoint(m,d,(w+1)*4),O=this.transitionsBetween(E,u),I=this.transitionsBetween(N,x);return O<I?(o[0]=u,o[1]=d,o[2]=m,o[3]=x):(o[0]=d,o[1]=m,o[2]=x,o[3]=u),o}correctTopRight(o){let u=o[0],d=o[1],m=o[2],x=o[3],w=this.transitionsBetween(u,x),E=this.transitionsBetween(d,x),N=mt.shiftPoint(u,d,(E+1)*4),O=mt.shiftPoint(m,d,(w+1)*4);w=this.transitionsBetween(N,x),E=this.transitionsBetween(O,x);let I=new tt(x.getX()+(m.getX()-d.getX())/(w+1),x.getY()+(m.getY()-d.getY())/(w+1)),P=new tt(x.getX()+(u.getX()-d.getX())/(E+1),x.getY()+(u.getY()-d.getY())/(E+1));if(!this.isValid(I))return this.isValid(P)?P:null;if(!this.isValid(P))return I;let F=this.transitionsBetween(N,I)+this.transitionsBetween(O,I),q=this.transitionsBetween(N,P)+this.transitionsBetween(O,P);return F>q?I:P}shiftToModuleCenter(o){let u=o[0],d=o[1],m=o[2],x=o[3],w=this.transitionsBetween(u,x)+1,E=this.transitionsBetween(m,x)+1,N=mt.shiftPoint(u,d,E*4),O=mt.shiftPoint(m,d,w*4);w=this.transitionsBetween(N,x)+1,E=this.transitionsBetween(O,x)+1,(w&1)===1&&(w+=1),(E&1)===1&&(E+=1);let I=(u.getX()+d.getX()+m.getX()+x.getX())/4,P=(u.getY()+d.getY()+m.getY()+x.getY())/4;u=mt.moveAway(u,I,P),d=mt.moveAway(d,I,P),m=mt.moveAway(m,I,P),x=mt.moveAway(x,I,P);let F,q;return N=mt.shiftPoint(u,d,E*4),N=mt.shiftPoint(N,x,w*4),F=mt.shiftPoint(d,u,E*4),F=mt.shiftPoint(F,m,w*4),O=mt.shiftPoint(m,x,E*4),O=mt.shiftPoint(O,d,w*4),q=mt.shiftPoint(x,m,E*4),q=mt.shiftPoint(q,u,w*4),[N,F,O,q]}isValid(o){return o.getX()>=0&&o.getX()<this.image.getWidth()&&o.getY()>0&&o.getY()<this.image.getHeight()}static sampleGrid(o,u,d,m,x,w,E){return On.getInstance().sampleGrid(o,w,E,.5,.5,w-.5,.5,w-.5,E-.5,.5,E-.5,u.getX(),u.getY(),x.getX(),x.getY(),m.getX(),m.getY(),d.getX(),d.getY())}transitionsBetween(o,u){let d=Math.trunc(o.getX()),m=Math.trunc(o.getY()),x=Math.trunc(u.getX()),w=Math.trunc(u.getY()),E=Math.abs(w-m)>Math.abs(x-d);if(E){let ae=d;d=m,m=ae,ae=x,x=w,w=ae}let N=Math.abs(x-d),O=Math.abs(w-m),I=-N/2,P=m<w?1:-1,F=d<x?1:-1,q=0,re=this.image.get(E?m:d,E?d:m);for(let ae=d,be=m;ae!==x;ae+=F){let Ne=this.image.get(E?be:ae,E?ae:be);if(Ne!==re&&(q++,re=Ne),I+=O,I>0){if(be===w)break;be+=P,I-=N}}return q}}class en{constructor(){this.decoder=new qe}decode(o,u=null){let d,m;if(u!=null&&u.has(oe.PURE_BARCODE)){const O=en.extractPureBits(o.getBlackMatrix());d=this.decoder.decode(O),m=en.NO_POINTS}else{const O=new mt(o.getBlackMatrix()).detect();d=this.decoder.decode(O.getBits()),m=O.getPoints()}const x=d.getRawBytes(),w=new ge(d.getText(),x,8*x.length,m,se.DATA_MATRIX,M.currentTimeMillis()),E=d.getByteSegments();E!=null&&w.putMetadata(K.BYTE_SEGMENTS,E);const N=d.getECLevel();return N!=null&&w.putMetadata(K.ERROR_CORRECTION_LEVEL,N),w}reset(){}static extractPureBits(o){const u=o.getTopLeftOnBit(),d=o.getBottomRightOnBit();if(u==null||d==null)throw new ne;const m=this.moduleSize(u,o);let x=u[1];const w=d[1];let E=u[0];const O=(d[0]-E+1)/m,I=(w-x+1)/m;if(O<=0||I<=0)throw new ne;const P=m/2;x+=P,E+=P;const F=new Ze(O,I);for(let q=0;q<I;q++){const re=x+q*m;for(let ae=0;ae<O;ae++)o.get(E+ae*m,re)&&F.set(ae,q)}return F}static moduleSize(o,u){const d=u.getWidth();let m=o[0];const x=o[1];for(;m<d&&u.get(m,x);)m++;if(m===d)throw new ne;const w=m-o[0];if(w===0)throw new ne;return w}}en.NO_POINTS=[];class zn extends fe{constructor(o=500){super(new en,o)}}var zr;(function(B){B[B.L=0]="L",B[B.M=1]="M",B[B.Q=2]="Q",B[B.H=3]="H"})(zr||(zr={}));class kt{constructor(o,u,d){this.value=o,this.stringValue=u,this.bits=d,kt.FOR_BITS.set(d,this),kt.FOR_VALUE.set(o,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(o){switch(o){case"L":return kt.L;case"M":return kt.M;case"Q":return kt.Q;case"H":return kt.H;default:throw new C(o+"not available")}}toString(){return this.stringValue}equals(o){if(!(o instanceof kt))return!1;const u=o;return this.value===u.value}static forBits(o){if(o<0||o>=kt.FOR_BITS.size)throw new v;return kt.FOR_BITS.get(o)}}kt.FOR_BITS=new Map,kt.FOR_VALUE=new Map,kt.L=new kt(zr.L,"L",1),kt.M=new kt(zr.M,"M",0),kt.Q=new kt(zr.Q,"Q",3),kt.H=new kt(zr.H,"H",2);class yn{constructor(o){this.errorCorrectionLevel=kt.forBits(o>>3&3),this.dataMask=o&7}static numBitsDiffering(o,u){return G.bitCount(o^u)}static decodeFormatInformation(o,u){const d=yn.doDecodeFormatInformation(o,u);return d!==null?d:yn.doDecodeFormatInformation(o^yn.FORMAT_INFO_MASK_QR,u^yn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(o,u){let d=Number.MAX_SAFE_INTEGER,m=0;for(const x of yn.FORMAT_INFO_DECODE_LOOKUP){const w=x[0];if(w===o||w===u)return new yn(x[1]);let E=yn.numBitsDiffering(o,w);E<d&&(m=x[1],d=E),o!==u&&(E=yn.numBitsDiffering(u,w),E<d&&(m=x[1],d=E))}return d<=3?new yn(m):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(o){if(!(o instanceof yn))return!1;const u=o;return this.errorCorrectionLevel===u.errorCorrectionLevel&&this.dataMask===u.dataMask}}yn.FORMAT_INFO_MASK_QR=21522,yn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class xe{constructor(o,...u){this.ecCodewordsPerBlock=o,this.ecBlocks=u}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let o=0;const u=this.ecBlocks;for(const d of u)o+=d.getCount();return o}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class W{constructor(o,u){this.count=o,this.dataCodewords=u}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ht{constructor(o,u,...d){this.versionNumber=o,this.alignmentPatternCenters=u,this.ecBlocks=d;let m=0;const x=d[0].getECCodewordsPerBlock(),w=d[0].getECBlocks();for(const E of w)m+=E.getCount()*(E.getDataCodewords()+x);this.totalCodewords=m}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(o){return this.ecBlocks[o.getValue()]}static getProvisionalVersionForDimension(o){if(o%4!==1)throw new U;try{return this.getVersionForNumber((o-17)/4)}catch{throw new U}}static getVersionForNumber(o){if(o<1||o>40)throw new v;return ht.VERSIONS[o-1]}static decodeVersionInformation(o){let u=Number.MAX_SAFE_INTEGER,d=0;for(let m=0;m<ht.VERSION_DECODE_INFO.length;m++){const x=ht.VERSION_DECODE_INFO[m];if(x===o)return ht.getVersionForNumber(m+7);const w=yn.numBitsDiffering(o,x);w<u&&(d=m+7,u=w)}return u<=3?ht.getVersionForNumber(d):null}buildFunctionPattern(){const o=this.getDimensionForVersion(),u=new Ze(o);u.setRegion(0,0,9,9),u.setRegion(o-8,0,8,9),u.setRegion(0,o-8,9,8);const d=this.alignmentPatternCenters.length;for(let m=0;m<d;m++){const x=this.alignmentPatternCenters[m]-2;for(let w=0;w<d;w++)m===0&&(w===0||w===d-1)||m===d-1&&w===0||u.setRegion(this.alignmentPatternCenters[w]-2,x,5,5)}return u.setRegion(6,9,1,o-17),u.setRegion(9,6,o-17,1),this.versionNumber>6&&(u.setRegion(o-11,0,3,6),u.setRegion(0,o-11,6,3)),u}toString(){return""+this.versionNumber}}ht.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ht.VERSIONS=[new ht(1,new Int32Array(0),new xe(7,new W(1,19)),new xe(10,new W(1,16)),new xe(13,new W(1,13)),new xe(17,new W(1,9))),new ht(2,Int32Array.from([6,18]),new xe(10,new W(1,34)),new xe(16,new W(1,28)),new xe(22,new W(1,22)),new xe(28,new W(1,16))),new ht(3,Int32Array.from([6,22]),new xe(15,new W(1,55)),new xe(26,new W(1,44)),new xe(18,new W(2,17)),new xe(22,new W(2,13))),new ht(4,Int32Array.from([6,26]),new xe(20,new W(1,80)),new xe(18,new W(2,32)),new xe(26,new W(2,24)),new xe(16,new W(4,9))),new ht(5,Int32Array.from([6,30]),new xe(26,new W(1,108)),new xe(24,new W(2,43)),new xe(18,new W(2,15),new W(2,16)),new xe(22,new W(2,11),new W(2,12))),new ht(6,Int32Array.from([6,34]),new xe(18,new W(2,68)),new xe(16,new W(4,27)),new xe(24,new W(4,19)),new xe(28,new W(4,15))),new ht(7,Int32Array.from([6,22,38]),new xe(20,new W(2,78)),new xe(18,new W(4,31)),new xe(18,new W(2,14),new W(4,15)),new xe(26,new W(4,13),new W(1,14))),new ht(8,Int32Array.from([6,24,42]),new xe(24,new W(2,97)),new xe(22,new W(2,38),new W(2,39)),new xe(22,new W(4,18),new W(2,19)),new xe(26,new W(4,14),new W(2,15))),new ht(9,Int32Array.from([6,26,46]),new xe(30,new W(2,116)),new xe(22,new W(3,36),new W(2,37)),new xe(20,new W(4,16),new W(4,17)),new xe(24,new W(4,12),new W(4,13))),new ht(10,Int32Array.from([6,28,50]),new xe(18,new W(2,68),new W(2,69)),new xe(26,new W(4,43),new W(1,44)),new xe(24,new W(6,19),new W(2,20)),new xe(28,new W(6,15),new W(2,16))),new ht(11,Int32Array.from([6,30,54]),new xe(20,new W(4,81)),new xe(30,new W(1,50),new W(4,51)),new xe(28,new W(4,22),new W(4,23)),new xe(24,new W(3,12),new W(8,13))),new ht(12,Int32Array.from([6,32,58]),new xe(24,new W(2,92),new W(2,93)),new xe(22,new W(6,36),new W(2,37)),new xe(26,new W(4,20),new W(6,21)),new xe(28,new W(7,14),new W(4,15))),new ht(13,Int32Array.from([6,34,62]),new xe(26,new W(4,107)),new xe(22,new W(8,37),new W(1,38)),new xe(24,new W(8,20),new W(4,21)),new xe(22,new W(12,11),new W(4,12))),new ht(14,Int32Array.from([6,26,46,66]),new xe(30,new W(3,115),new W(1,116)),new xe(24,new W(4,40),new W(5,41)),new xe(20,new W(11,16),new W(5,17)),new xe(24,new W(11,12),new W(5,13))),new ht(15,Int32Array.from([6,26,48,70]),new xe(22,new W(5,87),new W(1,88)),new xe(24,new W(5,41),new W(5,42)),new xe(30,new W(5,24),new W(7,25)),new xe(24,new W(11,12),new W(7,13))),new ht(16,Int32Array.from([6,26,50,74]),new xe(24,new W(5,98),new W(1,99)),new xe(28,new W(7,45),new W(3,46)),new xe(24,new W(15,19),new W(2,20)),new xe(30,new W(3,15),new W(13,16))),new ht(17,Int32Array.from([6,30,54,78]),new xe(28,new W(1,107),new W(5,108)),new xe(28,new W(10,46),new W(1,47)),new xe(28,new W(1,22),new W(15,23)),new xe(28,new W(2,14),new W(17,15))),new ht(18,Int32Array.from([6,30,56,82]),new xe(30,new W(5,120),new W(1,121)),new xe(26,new W(9,43),new W(4,44)),new xe(28,new W(17,22),new W(1,23)),new xe(28,new W(2,14),new W(19,15))),new ht(19,Int32Array.from([6,30,58,86]),new xe(28,new W(3,113),new W(4,114)),new xe(26,new W(3,44),new W(11,45)),new xe(26,new W(17,21),new W(4,22)),new xe(26,new W(9,13),new W(16,14))),new ht(20,Int32Array.from([6,34,62,90]),new xe(28,new W(3,107),new W(5,108)),new xe(26,new W(3,41),new W(13,42)),new xe(30,new W(15,24),new W(5,25)),new xe(28,new W(15,15),new W(10,16))),new ht(21,Int32Array.from([6,28,50,72,94]),new xe(28,new W(4,116),new W(4,117)),new xe(26,new W(17,42)),new xe(28,new W(17,22),new W(6,23)),new xe(30,new W(19,16),new W(6,17))),new ht(22,Int32Array.from([6,26,50,74,98]),new xe(28,new W(2,111),new W(7,112)),new xe(28,new W(17,46)),new xe(30,new W(7,24),new W(16,25)),new xe(24,new W(34,13))),new ht(23,Int32Array.from([6,30,54,78,102]),new xe(30,new W(4,121),new W(5,122)),new xe(28,new W(4,47),new W(14,48)),new xe(30,new W(11,24),new W(14,25)),new xe(30,new W(16,15),new W(14,16))),new ht(24,Int32Array.from([6,28,54,80,106]),new xe(30,new W(6,117),new W(4,118)),new xe(28,new W(6,45),new W(14,46)),new xe(30,new W(11,24),new W(16,25)),new xe(30,new W(30,16),new W(2,17))),new ht(25,Int32Array.from([6,32,58,84,110]),new xe(26,new W(8,106),new W(4,107)),new xe(28,new W(8,47),new W(13,48)),new xe(30,new W(7,24),new W(22,25)),new xe(30,new W(22,15),new W(13,16))),new ht(26,Int32Array.from([6,30,58,86,114]),new xe(28,new W(10,114),new W(2,115)),new xe(28,new W(19,46),new W(4,47)),new xe(28,new W(28,22),new W(6,23)),new xe(30,new W(33,16),new W(4,17))),new ht(27,Int32Array.from([6,34,62,90,118]),new xe(30,new W(8,122),new W(4,123)),new xe(28,new W(22,45),new W(3,46)),new xe(30,new W(8,23),new W(26,24)),new xe(30,new W(12,15),new W(28,16))),new ht(28,Int32Array.from([6,26,50,74,98,122]),new xe(30,new W(3,117),new W(10,118)),new xe(28,new W(3,45),new W(23,46)),new xe(30,new W(4,24),new W(31,25)),new xe(30,new W(11,15),new W(31,16))),new ht(29,Int32Array.from([6,30,54,78,102,126]),new xe(30,new W(7,116),new W(7,117)),new xe(28,new W(21,45),new W(7,46)),new xe(30,new W(1,23),new W(37,24)),new xe(30,new W(19,15),new W(26,16))),new ht(30,Int32Array.from([6,26,52,78,104,130]),new xe(30,new W(5,115),new W(10,116)),new xe(28,new W(19,47),new W(10,48)),new xe(30,new W(15,24),new W(25,25)),new xe(30,new W(23,15),new W(25,16))),new ht(31,Int32Array.from([6,30,56,82,108,134]),new xe(30,new W(13,115),new W(3,116)),new xe(28,new W(2,46),new W(29,47)),new xe(30,new W(42,24),new W(1,25)),new xe(30,new W(23,15),new W(28,16))),new ht(32,Int32Array.from([6,34,60,86,112,138]),new xe(30,new W(17,115)),new xe(28,new W(10,46),new W(23,47)),new xe(30,new W(10,24),new W(35,25)),new xe(30,new W(19,15),new W(35,16))),new ht(33,Int32Array.from([6,30,58,86,114,142]),new xe(30,new W(17,115),new W(1,116)),new xe(28,new W(14,46),new W(21,47)),new xe(30,new W(29,24),new W(19,25)),new xe(30,new W(11,15),new W(46,16))),new ht(34,Int32Array.from([6,34,62,90,118,146]),new xe(30,new W(13,115),new W(6,116)),new xe(28,new W(14,46),new W(23,47)),new xe(30,new W(44,24),new W(7,25)),new xe(30,new W(59,16),new W(1,17))),new ht(35,Int32Array.from([6,30,54,78,102,126,150]),new xe(30,new W(12,121),new W(7,122)),new xe(28,new W(12,47),new W(26,48)),new xe(30,new W(39,24),new W(14,25)),new xe(30,new W(22,15),new W(41,16))),new ht(36,Int32Array.from([6,24,50,76,102,128,154]),new xe(30,new W(6,121),new W(14,122)),new xe(28,new W(6,47),new W(34,48)),new xe(30,new W(46,24),new W(10,25)),new xe(30,new W(2,15),new W(64,16))),new ht(37,Int32Array.from([6,28,54,80,106,132,158]),new xe(30,new W(17,122),new W(4,123)),new xe(28,new W(29,46),new W(14,47)),new xe(30,new W(49,24),new W(10,25)),new xe(30,new W(24,15),new W(46,16))),new ht(38,Int32Array.from([6,32,58,84,110,136,162]),new xe(30,new W(4,122),new W(18,123)),new xe(28,new W(13,46),new W(32,47)),new xe(30,new W(48,24),new W(14,25)),new xe(30,new W(42,15),new W(32,16))),new ht(39,Int32Array.from([6,26,54,82,110,138,166]),new xe(30,new W(20,117),new W(4,118)),new xe(28,new W(40,47),new W(7,48)),new xe(30,new W(43,24),new W(22,25)),new xe(30,new W(10,15),new W(67,16))),new ht(40,Int32Array.from([6,30,58,86,114,142,170]),new xe(30,new W(19,118),new W(6,119)),new xe(28,new W(18,47),new W(31,48)),new xe(30,new W(34,24),new W(34,25)),new xe(30,new W(20,15),new W(61,16)))];var dr;(function(B){B[B.DATA_MASK_000=0]="DATA_MASK_000",B[B.DATA_MASK_001=1]="DATA_MASK_001",B[B.DATA_MASK_010=2]="DATA_MASK_010",B[B.DATA_MASK_011=3]="DATA_MASK_011",B[B.DATA_MASK_100=4]="DATA_MASK_100",B[B.DATA_MASK_101=5]="DATA_MASK_101",B[B.DATA_MASK_110=6]="DATA_MASK_110",B[B.DATA_MASK_111=7]="DATA_MASK_111"})(dr||(dr={}));class as{constructor(o,u){this.value=o,this.isMasked=u}unmaskBitMatrix(o,u){for(let d=0;d<u;d++)for(let m=0;m<u;m++)this.isMasked(d,m)&&o.flip(m,d)}}as.values=new Map([[dr.DATA_MASK_000,new as(dr.DATA_MASK_000,(B,o)=>(B+o&1)===0)],[dr.DATA_MASK_001,new as(dr.DATA_MASK_001,(B,o)=>(B&1)===0)],[dr.DATA_MASK_010,new as(dr.DATA_MASK_010,(B,o)=>o%3===0)],[dr.DATA_MASK_011,new as(dr.DATA_MASK_011,(B,o)=>(B+o)%3===0)],[dr.DATA_MASK_100,new as(dr.DATA_MASK_100,(B,o)=>(Math.floor(B/2)+Math.floor(o/3)&1)===0)],[dr.DATA_MASK_101,new as(dr.DATA_MASK_101,(B,o)=>B*o%6===0)],[dr.DATA_MASK_110,new as(dr.DATA_MASK_110,(B,o)=>B*o%6<3)],[dr.DATA_MASK_111,new as(dr.DATA_MASK_111,(B,o)=>(B+o+B*o%3&1)===0)]]);class Ba{constructor(o){const u=o.getHeight();if(u<21||(u&3)!==1)throw new U;this.bitMatrix=o}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let o=0;for(let x=0;x<6;x++)o=this.copyBit(x,8,o);o=this.copyBit(7,8,o),o=this.copyBit(8,8,o),o=this.copyBit(8,7,o);for(let x=5;x>=0;x--)o=this.copyBit(8,x,o);const u=this.bitMatrix.getHeight();let d=0;const m=u-7;for(let x=u-1;x>=m;x--)d=this.copyBit(8,x,d);for(let x=u-8;x<u;x++)d=this.copyBit(x,8,d);if(this.parsedFormatInfo=yn.decodeFormatInformation(o,d),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const o=this.bitMatrix.getHeight(),u=Math.floor((o-17)/4);if(u<=6)return ht.getVersionForNumber(u);let d=0;const m=o-11;for(let w=5;w>=0;w--)for(let E=o-9;E>=m;E--)d=this.copyBit(E,w,d);let x=ht.decodeVersionInformation(d);if(x!==null&&x.getDimensionForVersion()===o)return this.parsedVersion=x,x;d=0;for(let w=5;w>=0;w--)for(let E=o-9;E>=m;E--)d=this.copyBit(w,E,d);if(x=ht.decodeVersionInformation(d),x!==null&&x.getDimensionForVersion()===o)return this.parsedVersion=x,x;throw new U}copyBit(o,u,d){return(this.isMirror?this.bitMatrix.get(u,o):this.bitMatrix.get(o,u))?d<<1|1:d<<1}readCodewords(){const o=this.readFormatInformation(),u=this.readVersion(),d=as.values.get(o.getDataMask()),m=this.bitMatrix.getHeight();d.unmaskBitMatrix(this.bitMatrix,m);const x=u.buildFunctionPattern();let w=!0;const E=new Uint8Array(u.getTotalCodewords());let N=0,O=0,I=0;for(let P=m-1;P>0;P-=2){P===6&&P--;for(let F=0;F<m;F++){const q=w?m-1-F:F;for(let re=0;re<2;re++)x.get(P-re,q)||(I++,O<<=1,this.bitMatrix.get(P-re,q)&&(O|=1),I===8&&(E[N++]=O,I=0,O=0))}w=!w}if(N!==u.getTotalCodewords())throw new U;return E}remask(){if(this.parsedFormatInfo===null)return;const o=as.values[this.parsedFormatInfo.getDataMask()],u=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,u)}setMirror(o){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=o}mirror(){const o=this.bitMatrix;for(let u=0,d=o.getWidth();u<d;u++)for(let m=u+1,x=o.getHeight();m<x;m++)o.get(u,m)!==o.get(m,u)&&(o.flip(m,u),o.flip(u,m))}}class gu{constructor(o,u){this.numDataCodewords=o,this.codewords=u}static getDataBlocks(o,u,d){if(o.length!==u.getTotalCodewords())throw new v;const m=u.getECBlocksForLevel(d);let x=0;const w=m.getECBlocks();for(const re of w)x+=re.getCount();const E=new Array(x);let N=0;for(const re of w)for(let ae=0;ae<re.getCount();ae++){const be=re.getDataCodewords(),Ne=m.getECCodewordsPerBlock()+be;E[N++]=new gu(be,new Uint8Array(Ne))}const O=E[0].codewords.length;let I=E.length-1;for(;I>=0&&E[I].codewords.length!==O;)I--;I++;const P=O-m.getECCodewordsPerBlock();let F=0;for(let re=0;re<P;re++)for(let ae=0;ae<N;ae++)E[ae].codewords[re]=o[F++];for(let re=I;re<N;re++)E[re].codewords[P]=o[F++];const q=E[0].codewords.length;for(let re=P;re<q;re++)for(let ae=0;ae<N;ae++){const be=ae<I?re:re+1;E[ae].codewords[be]=o[F++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ls;(function(B){B[B.TERMINATOR=0]="TERMINATOR",B[B.NUMERIC=1]="NUMERIC",B[B.ALPHANUMERIC=2]="ALPHANUMERIC",B[B.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",B[B.BYTE=4]="BYTE",B[B.ECI=5]="ECI",B[B.KANJI=6]="KANJI",B[B.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",B[B.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",B[B.HANZI=9]="HANZI"})(ls||(ls={}));class bt{constructor(o,u,d,m){this.value=o,this.stringValue=u,this.characterCountBitsForVersions=d,this.bits=m,bt.FOR_BITS.set(m,this),bt.FOR_VALUE.set(o,this)}static forBits(o){const u=bt.FOR_BITS.get(o);if(u===void 0)throw new v;return u}getCharacterCountBits(o){const u=o.getVersionNumber();let d;return u<=9?d=0:u<=26?d=1:d=2,this.characterCountBitsForVersions[d]}getValue(){return this.value}getBits(){return this.bits}equals(o){if(!(o instanceof bt))return!1;const u=o;return this.value===u.value}toString(){return this.stringValue}}bt.FOR_BITS=new Map,bt.FOR_VALUE=new Map,bt.TERMINATOR=new bt(ls.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),bt.NUMERIC=new bt(ls.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),bt.ALPHANUMERIC=new bt(ls.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),bt.STRUCTURED_APPEND=new bt(ls.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),bt.BYTE=new bt(ls.BYTE,"BYTE",Int32Array.from([8,16,16]),4),bt.ECI=new bt(ls.ECI,"ECI",Int32Array.from([0,0,0]),7),bt.KANJI=new bt(ls.KANJI,"KANJI",Int32Array.from([8,10,12]),8),bt.FNC1_FIRST_POSITION=new bt(ls.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),bt.FNC1_SECOND_POSITION=new bt(ls.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),bt.HANZI=new bt(ls.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class _n{static decode(o,u,d,m){const x=new ye(o);let w=new Ie;const E=new Array;let N=-1,O=-1;try{let I=null,P=!1,F;do{if(x.available()<4)F=bt.TERMINATOR;else{const q=x.readBits(4);F=bt.forBits(q)}switch(F){case bt.TERMINATOR:break;case bt.FNC1_FIRST_POSITION:case bt.FNC1_SECOND_POSITION:P=!0;break;case bt.STRUCTURED_APPEND:if(x.available()<16)throw new U;N=x.readBits(8),O=x.readBits(8);break;case bt.ECI:const q=_n.parseECIValue(x);if(I=X.getCharacterSetECIByValue(q),I===null)throw new U;break;case bt.HANZI:const re=x.readBits(4),ae=x.readBits(F.getCharacterCountBits(u));re===_n.GB2312_SUBSET&&_n.decodeHanziSegment(x,w,ae);break;default:const be=x.readBits(F.getCharacterCountBits(u));switch(F){case bt.NUMERIC:_n.decodeNumericSegment(x,w,be);break;case bt.ALPHANUMERIC:_n.decodeAlphanumericSegment(x,w,be,P);break;case bt.BYTE:_n.decodeByteSegment(x,w,be,I,E,m);break;case bt.KANJI:_n.decodeKanjiSegment(x,w,be);break;default:throw new U}break}}while(F!==bt.TERMINATOR)}catch{throw new U}return new Ce(o,w.toString(),E.length===0?null:E,d===null?null:d.toString(),N,O)}static decodeHanziSegment(o,u,d){if(d*13>o.available())throw new U;const m=new Uint8Array(2*d);let x=0;for(;d>0;){const w=o.readBits(13);let E=w/96<<8&4294967295|w%96;E<959?E+=41377:E+=42657,m[x]=E>>8&255,m[x+1]=E&255,x+=2,d--}try{u.append(je.decode(m,ue.GB2312))}catch(w){throw new U(w)}}static decodeKanjiSegment(o,u,d){if(d*13>o.available())throw new U;const m=new Uint8Array(2*d);let x=0;for(;d>0;){const w=o.readBits(13);let E=w/192<<8&4294967295|w%192;E<7936?E+=33088:E+=49472,m[x]=E>>8,m[x+1]=E,x+=2,d--}try{u.append(je.decode(m,ue.SHIFT_JIS))}catch(w){throw new U(w)}}static decodeByteSegment(o,u,d,m,x,w){if(8*d>o.available())throw new U;const E=new Uint8Array(d);for(let O=0;O<d;O++)E[O]=o.readBits(8);let N;m===null?N=ue.guessEncoding(E,w):N=m.getName();try{u.append(je.decode(E,N))}catch(O){throw new U(O)}x.push(E)}static toAlphaNumericChar(o){if(o>=_n.ALPHANUMERIC_CHARS.length)throw new U;return _n.ALPHANUMERIC_CHARS[o]}static decodeAlphanumericSegment(o,u,d,m){const x=u.length();for(;d>1;){if(o.available()<11)throw new U;const w=o.readBits(11);u.append(_n.toAlphaNumericChar(Math.floor(w/45))),u.append(_n.toAlphaNumericChar(w%45)),d-=2}if(d===1){if(o.available()<6)throw new U;u.append(_n.toAlphaNumericChar(o.readBits(6)))}if(m)for(let w=x;w<u.length();w++)u.charAt(w)==="%"&&(w<u.length()-1&&u.charAt(w+1)==="%"?u.deleteCharAt(w+1):u.setCharAt(w,""))}static decodeNumericSegment(o,u,d){for(;d>=3;){if(o.available()<10)throw new U;const m=o.readBits(10);if(m>=1e3)throw new U;u.append(_n.toAlphaNumericChar(Math.floor(m/100))),u.append(_n.toAlphaNumericChar(Math.floor(m/10)%10)),u.append(_n.toAlphaNumericChar(m%10)),d-=3}if(d===2){if(o.available()<7)throw new U;const m=o.readBits(7);if(m>=100)throw new U;u.append(_n.toAlphaNumericChar(Math.floor(m/10))),u.append(_n.toAlphaNumericChar(m%10))}else if(d===1){if(o.available()<4)throw new U;const m=o.readBits(4);if(m>=10)throw new U;u.append(_n.toAlphaNumericChar(m))}}static parseECIValue(o){const u=o.readBits(8);if((u&128)===0)return u&127;if((u&192)===128){const d=o.readBits(8);return(u&63)<<8&4294967295|d}if((u&224)===192){const d=o.readBits(16);return(u&31)<<16&4294967295|d}throw new U}}_n.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",_n.GB2312_SUBSET=1;class Cf{constructor(o){this.mirrored=o}isMirrored(){return this.mirrored}applyMirroredCorrection(o){if(!this.mirrored||o===null||o.length<3)return;const u=o[0];o[0]=o[2],o[2]=u}}class m1{constructor(){this.rsDecoder=new Pt(ot.QR_CODE_FIELD_256)}decodeBooleanArray(o,u){return this.decodeBitMatrix(Ze.parseFromBooleanArray(o),u)}decodeBitMatrix(o,u){const d=new Ba(o);let m=null;try{return this.decodeBitMatrixParser(d,u)}catch(x){m=x}try{d.remask(),d.setMirror(!0),d.readVersion(),d.readFormatInformation(),d.mirror();const x=this.decodeBitMatrixParser(d,u);return x.setOther(new Cf(!0)),x}catch(x){throw m!==null?m:x}}decodeBitMatrixParser(o,u){const d=o.readVersion(),m=o.readFormatInformation().getErrorCorrectionLevel(),x=o.readCodewords(),w=gu.getDataBlocks(x,d,m);let E=0;for(const I of w)E+=I.getNumDataCodewords();const N=new Uint8Array(E);let O=0;for(const I of w){const P=I.getCodewords(),F=I.getNumDataCodewords();this.correctErrors(P,F);for(let q=0;q<F;q++)N[O++]=P[q]}return _n.decode(N,d,m,u)}correctErrors(o,u){const d=new Int32Array(o);try{this.rsDecoder.decode(d,o.length-u)}catch{throw new T}for(let m=0;m<u;m++)o[m]=d[m]}}class Pa extends tt{constructor(o,u,d){super(o,u),this.estimatedModuleSize=d}aboutEquals(o,u,d){if(Math.abs(u-this.getY())<=o&&Math.abs(d-this.getX())<=o){const m=Math.abs(o-this.estimatedModuleSize);return m<=1||m<=this.estimatedModuleSize}return!1}combineEstimate(o,u,d){const m=(this.getX()+u)/2,x=(this.getY()+o)/2,w=(this.estimatedModuleSize+d)/2;return new Pa(m,x,w)}}class bs{constructor(o,u,d,m,x,w,E){this.image=o,this.startX=u,this.startY=d,this.width=m,this.height=x,this.moduleSize=w,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const o=this.startX,u=this.height,d=this.width,m=o+d,x=this.startY+u/2,w=new Int32Array(3),E=this.image;for(let N=0;N<u;N++){const O=x+((N&1)===0?Math.floor((N+1)/2):-Math.floor((N+1)/2));w[0]=0,w[1]=0,w[2]=0;let I=o;for(;I<m&&!E.get(I,O);)I++;let P=0;for(;I<m;){if(E.get(I,O))if(P===1)w[1]++;else if(P===2){if(this.foundPatternCross(w)){const F=this.handlePossibleCenter(w,O,I);if(F!==null)return F}w[0]=w[2],w[1]=1,w[2]=0,P=1}else w[++P]++;else P===1&&P++,w[P]++;I++}if(this.foundPatternCross(w)){const F=this.handlePossibleCenter(w,O,m);if(F!==null)return F}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ne}static centerFromEnd(o,u){return u-o[2]-o[1]/2}foundPatternCross(o){const u=this.moduleSize,d=u/2;for(let m=0;m<3;m++)if(Math.abs(u-o[m])>=d)return!1;return!0}crossCheckVertical(o,u,d,m){const x=this.image,w=x.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let N=o;for(;N>=0&&x.get(u,N)&&E[1]<=d;)E[1]++,N--;if(N<0||E[1]>d)return NaN;for(;N>=0&&!x.get(u,N)&&E[0]<=d;)E[0]++,N--;if(E[0]>d)return NaN;for(N=o+1;N<w&&x.get(u,N)&&E[1]<=d;)E[1]++,N++;if(N===w||E[1]>d)return NaN;for(;N<w&&!x.get(u,N)&&E[2]<=d;)E[2]++,N++;if(E[2]>d)return NaN;const O=E[0]+E[1]+E[2];return 5*Math.abs(O-m)>=2*m?NaN:this.foundPatternCross(E)?bs.centerFromEnd(E,N):NaN}handlePossibleCenter(o,u,d){const m=o[0]+o[1]+o[2],x=bs.centerFromEnd(o,d),w=this.crossCheckVertical(u,x,2*o[1],m);if(!isNaN(w)){const E=(o[0]+o[1]+o[2])/3;for(const O of this.possibleCenters)if(O.aboutEquals(E,w,x))return O.combineEstimate(w,x,E);const N=new Pa(x,w,E);this.possibleCenters.push(N),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(N)}return null}}class Yo extends tt{constructor(o,u,d,m){super(o,u),this.estimatedModuleSize=d,this.count=m,m===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(o,u,d){if(Math.abs(u-this.getY())<=o&&Math.abs(d-this.getX())<=o){const m=Math.abs(o-this.estimatedModuleSize);return m<=1||m<=this.estimatedModuleSize}return!1}combineEstimate(o,u,d){const m=this.count+1,x=(this.count*this.getX()+u)/m,w=(this.count*this.getY()+o)/m,E=(this.count*this.estimatedModuleSize+d)/m;return new Yo(x,w,E,m)}}class xu{constructor(o){this.bottomLeft=o[0],this.topLeft=o[1],this.topRight=o[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Un{constructor(o,u){this.image=o,this.resultPointCallback=u,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=u}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(o){const u=o!=null&&o.get(oe.TRY_HARDER)!==void 0,d=o!=null&&o.get(oe.PURE_BARCODE)!==void 0,m=this.image,x=m.getHeight(),w=m.getWidth();let E=Math.floor(3*x/(4*Un.MAX_MODULES));(E<Un.MIN_SKIP||u)&&(E=Un.MIN_SKIP);let N=!1;const O=new Int32Array(5);for(let P=E-1;P<x&&!N;P+=E){O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0;let F=0;for(let q=0;q<w;q++)if(m.get(q,P))(F&1)===1&&F++,O[F]++;else if((F&1)===0)if(F===4)if(Un.foundPatternCross(O)){if(this.handlePossibleCenter(O,P,q,d)===!0)if(E=2,this.hasSkipped===!0)N=this.haveMultiplyConfirmedCenters();else{const ae=this.findRowSkip();ae>O[2]&&(P+=ae-O[2]-E,q=w-1)}else{O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,F=3;continue}F=0,O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0}else O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,F=3;else O[++F]++;else O[F]++;Un.foundPatternCross(O)&&this.handlePossibleCenter(O,P,w,d)===!0&&(E=O[0],this.hasSkipped&&(N=this.haveMultiplyConfirmedCenters()))}const I=this.selectBestPatterns();return tt.orderBestPatterns(I),new xu(I)}static centerFromEnd(o,u){return u-o[4]-o[3]-o[2]/2}static foundPatternCross(o){let u=0;for(let x=0;x<5;x++){const w=o[x];if(w===0)return!1;u+=w}if(u<7)return!1;const d=u/7,m=d/2;return Math.abs(d-o[0])<m&&Math.abs(d-o[1])<m&&Math.abs(3*d-o[2])<3*m&&Math.abs(d-o[3])<m&&Math.abs(d-o[4])<m}getCrossCheckStateCount(){const o=this.crossCheckStateCount;return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o}crossCheckDiagonal(o,u,d,m){const x=this.getCrossCheckStateCount();let w=0;const E=this.image;for(;o>=w&&u>=w&&E.get(u-w,o-w);)x[2]++,w++;if(o<w||u<w)return!1;for(;o>=w&&u>=w&&!E.get(u-w,o-w)&&x[1]<=d;)x[1]++,w++;if(o<w||u<w||x[1]>d)return!1;for(;o>=w&&u>=w&&E.get(u-w,o-w)&&x[0]<=d;)x[0]++,w++;if(x[0]>d)return!1;const N=E.getHeight(),O=E.getWidth();for(w=1;o+w<N&&u+w<O&&E.get(u+w,o+w);)x[2]++,w++;if(o+w>=N||u+w>=O)return!1;for(;o+w<N&&u+w<O&&!E.get(u+w,o+w)&&x[3]<d;)x[3]++,w++;if(o+w>=N||u+w>=O||x[3]>=d)return!1;for(;o+w<N&&u+w<O&&E.get(u+w,o+w)&&x[4]<d;)x[4]++,w++;if(x[4]>=d)return!1;const I=x[0]+x[1]+x[2]+x[3]+x[4];return Math.abs(I-m)<2*m&&Un.foundPatternCross(x)}crossCheckVertical(o,u,d,m){const x=this.image,w=x.getHeight(),E=this.getCrossCheckStateCount();let N=o;for(;N>=0&&x.get(u,N);)E[2]++,N--;if(N<0)return NaN;for(;N>=0&&!x.get(u,N)&&E[1]<=d;)E[1]++,N--;if(N<0||E[1]>d)return NaN;for(;N>=0&&x.get(u,N)&&E[0]<=d;)E[0]++,N--;if(E[0]>d)return NaN;for(N=o+1;N<w&&x.get(u,N);)E[2]++,N++;if(N===w)return NaN;for(;N<w&&!x.get(u,N)&&E[3]<d;)E[3]++,N++;if(N===w||E[3]>=d)return NaN;for(;N<w&&x.get(u,N)&&E[4]<d;)E[4]++,N++;if(E[4]>=d)return NaN;const O=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(O-m)>=2*m?NaN:Un.foundPatternCross(E)?Un.centerFromEnd(E,N):NaN}crossCheckHorizontal(o,u,d,m){const x=this.image,w=x.getWidth(),E=this.getCrossCheckStateCount();let N=o;for(;N>=0&&x.get(N,u);)E[2]++,N--;if(N<0)return NaN;for(;N>=0&&!x.get(N,u)&&E[1]<=d;)E[1]++,N--;if(N<0||E[1]>d)return NaN;for(;N>=0&&x.get(N,u)&&E[0]<=d;)E[0]++,N--;if(E[0]>d)return NaN;for(N=o+1;N<w&&x.get(N,u);)E[2]++,N++;if(N===w)return NaN;for(;N<w&&!x.get(N,u)&&E[3]<d;)E[3]++,N++;if(N===w||E[3]>=d)return NaN;for(;N<w&&x.get(N,u)&&E[4]<d;)E[4]++,N++;if(E[4]>=d)return NaN;const O=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(O-m)>=m?NaN:Un.foundPatternCross(E)?Un.centerFromEnd(E,N):NaN}handlePossibleCenter(o,u,d,m){const x=o[0]+o[1]+o[2]+o[3]+o[4];let w=Un.centerFromEnd(o,d),E=this.crossCheckVertical(u,Math.floor(w),o[2],x);if(!isNaN(E)&&(w=this.crossCheckHorizontal(Math.floor(w),Math.floor(E),o[2],x),!isNaN(w)&&(!m||this.crossCheckDiagonal(Math.floor(E),Math.floor(w),o[2],x)))){const N=x/7;let O=!1;const I=this.possibleCenters;for(let P=0,F=I.length;P<F;P++){const q=I[P];if(q.aboutEquals(N,E,w)){I[P]=q.combineEstimate(E,w,N),O=!0;break}}if(!O){const P=new Yo(w,E,N);I.push(P),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(P)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let u=null;for(const d of this.possibleCenters)if(d.getCount()>=Un.CENTER_QUORUM)if(u==null)u=d;else return this.hasSkipped=!0,Math.floor((Math.abs(u.getX()-d.getX())-Math.abs(u.getY()-d.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let o=0,u=0;const d=this.possibleCenters.length;for(const w of this.possibleCenters)w.getCount()>=Un.CENTER_QUORUM&&(o++,u+=w.getEstimatedModuleSize());if(o<3)return!1;const m=u/d;let x=0;for(const w of this.possibleCenters)x+=Math.abs(w.getEstimatedModuleSize()-m);return x<=.05*u}selectBestPatterns(){const o=this.possibleCenters.length;if(o<3)throw new ne;const u=this.possibleCenters;let d;if(o>3){let m=0,x=0;for(const N of this.possibleCenters){const O=N.getEstimatedModuleSize();m+=O,x+=O*O}d=m/o;let w=Math.sqrt(x/o-d*d);u.sort((N,O)=>{const I=Math.abs(O.getEstimatedModuleSize()-d),P=Math.abs(N.getEstimatedModuleSize()-d);return I<P?-1:I>P?1:0});const E=Math.max(.2*d,w);for(let N=0;N<u.length&&u.length>3;N++){const O=u[N];Math.abs(O.getEstimatedModuleSize()-d)>E&&(u.splice(N,1),N--)}}if(u.length>3){let m=0;for(const x of u)m+=x.getEstimatedModuleSize();d=m/u.length,u.sort((x,w)=>{if(w.getCount()===x.getCount()){const E=Math.abs(w.getEstimatedModuleSize()-d),N=Math.abs(x.getEstimatedModuleSize()-d);return E<N?1:E>N?-1:0}else return w.getCount()-x.getCount()}),u.splice(3)}return[u[0],u[1],u[2]]}}Un.CENTER_QUORUM=2,Un.MIN_SKIP=3,Un.MAX_MODULES=57;class Gs{constructor(o){this.image=o}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(o){this.resultPointCallback=o==null?null:o.get(oe.NEED_RESULT_POINT_CALLBACK);const d=new Un(this.image,this.resultPointCallback).find(o);return this.processFinderPatternInfo(d)}processFinderPatternInfo(o){const u=o.getTopLeft(),d=o.getTopRight(),m=o.getBottomLeft(),x=this.calculateModuleSize(u,d,m);if(x<1)throw new ne("No pattern found in proccess finder.");const w=Gs.computeDimension(u,d,m,x),E=ht.getProvisionalVersionForDimension(w),N=E.getDimensionForVersion()-7;let O=null;if(E.getAlignmentPatternCenters().length>0){const q=d.getX()-u.getX()+m.getX(),re=d.getY()-u.getY()+m.getY(),ae=1-3/N,be=Math.floor(u.getX()+ae*(q-u.getX())),Ne=Math.floor(u.getY()+ae*(re-u.getY()));for(let $e=4;$e<=16;$e<<=1)try{O=this.findAlignmentInRegion(x,be,Ne,$e);break}catch(Ge){if(!(Ge instanceof ne))throw Ge}}const I=Gs.createTransform(u,d,m,O,w),P=Gs.sampleGrid(this.image,I,w);let F;return O===null?F=[m,u,d]:F=[m,u,d,O],new Xn(P,F)}static createTransform(o,u,d,m,x){const w=x-3.5;let E,N,O,I;return m!==null?(E=m.getX(),N=m.getY(),O=w-3,I=O):(E=u.getX()-o.getX()+d.getX(),N=u.getY()-o.getY()+d.getY(),O=w,I=w),tr.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,O,I,3.5,w,o.getX(),o.getY(),u.getX(),u.getY(),E,N,d.getX(),d.getY())}static sampleGrid(o,u,d){return On.getInstance().sampleGridWithTransform(o,d,d,u)}static computeDimension(o,u,d,m){const x=Ve.round(tt.distance(o,u)/m),w=Ve.round(tt.distance(o,d)/m);let E=Math.floor((x+w)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new ne("Dimensions could be not found.")}return E}calculateModuleSize(o,u,d){return(this.calculateModuleSizeOneWay(o,u)+this.calculateModuleSizeOneWay(o,d))/2}calculateModuleSizeOneWay(o,u){const d=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(u.getX()),Math.floor(u.getY())),m=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(u.getX()),Math.floor(u.getY()),Math.floor(o.getX()),Math.floor(o.getY()));return isNaN(d)?m/7:isNaN(m)?d/7:(d+m)/14}sizeOfBlackWhiteBlackRunBothWays(o,u,d,m){let x=this.sizeOfBlackWhiteBlackRun(o,u,d,m),w=1,E=o-(d-o);E<0?(w=o/(o-E),E=0):E>=this.image.getWidth()&&(w=(this.image.getWidth()-1-o)/(E-o),E=this.image.getWidth()-1);let N=Math.floor(u-(m-u)*w);return w=1,N<0?(w=u/(u-N),N=0):N>=this.image.getHeight()&&(w=(this.image.getHeight()-1-u)/(N-u),N=this.image.getHeight()-1),E=Math.floor(o+(E-o)*w),x+=this.sizeOfBlackWhiteBlackRun(o,u,E,N),x-1}sizeOfBlackWhiteBlackRun(o,u,d,m){const x=Math.abs(m-u)>Math.abs(d-o);if(x){let q=o;o=u,u=q,q=d,d=m,m=q}const w=Math.abs(d-o),E=Math.abs(m-u);let N=-w/2;const O=o<d?1:-1,I=u<m?1:-1;let P=0;const F=d+O;for(let q=o,re=u;q!==F;q+=O){const ae=x?re:q,be=x?q:re;if(P===1===this.image.get(ae,be)){if(P===2)return Ve.distance(q,re,o,u);P++}if(N+=E,N>0){if(re===m)break;re+=I,N-=w}}return P===2?Ve.distance(d+O,m,o,u):NaN}findAlignmentInRegion(o,u,d,m){const x=Math.floor(m*o),w=Math.max(0,u-x),E=Math.min(this.image.getWidth()-1,u+x);if(E-w<o*3)throw new ne("Alignment top exceeds estimated module size.");const N=Math.max(0,d-x),O=Math.min(this.image.getHeight()-1,d+x);if(O-N<o*3)throw new ne("Alignment bottom exceeds estimated module size.");return new bs(this.image,w,N,E-w,O-N,o,this.resultPointCallback).find()}}class li{constructor(){this.decoder=new m1}getDecoder(){return this.decoder}decode(o,u){let d,m;if(u!=null&&u.get(oe.PURE_BARCODE)!==void 0){const N=li.extractPureBits(o.getBlackMatrix());d=this.decoder.decodeBitMatrix(N,u),m=li.NO_POINTS}else{const N=new Gs(o.getBlackMatrix()).detect(u);d=this.decoder.decodeBitMatrix(N.getBits(),u),m=N.getPoints()}d.getOther()instanceof Cf&&d.getOther().applyMirroredCorrection(m);const x=new ge(d.getText(),d.getRawBytes(),void 0,m,se.QR_CODE,void 0),w=d.getByteSegments();w!==null&&x.putMetadata(K.BYTE_SEGMENTS,w);const E=d.getECLevel();return E!==null&&x.putMetadata(K.ERROR_CORRECTION_LEVEL,E),d.hasStructuredAppend()&&(x.putMetadata(K.STRUCTURED_APPEND_SEQUENCE,d.getStructuredAppendSequenceNumber()),x.putMetadata(K.STRUCTURED_APPEND_PARITY,d.getStructuredAppendParity())),x}reset(){}static extractPureBits(o){const u=o.getTopLeftOnBit(),d=o.getBottomRightOnBit();if(u===null||d===null)throw new ne;const m=this.moduleSize(u,o);let x=u[1],w=d[1],E=u[0],N=d[0];if(E>=N||x>=w)throw new ne;if(w-x!==N-E&&(N=E+(w-x),N>=o.getWidth()))throw new ne;const O=Math.round((N-E+1)/m),I=Math.round((w-x+1)/m);if(O<=0||I<=0)throw new ne;if(I!==O)throw new ne;const P=Math.floor(m/2);x+=P,E+=P;const F=E+Math.floor((O-1)*m)-N;if(F>0){if(F>P)throw new ne;E-=F}const q=x+Math.floor((I-1)*m)-w;if(q>0){if(q>P)throw new ne;x-=q}const re=new Ze(O,I);for(let ae=0;ae<I;ae++){const be=x+Math.floor(ae*m);for(let Ne=0;Ne<O;Ne++)o.get(E+Math.floor(Ne*m),be)&&re.set(Ne,ae)}return re}static moduleSize(o,u){const d=u.getHeight(),m=u.getWidth();let x=o[0],w=o[1],E=!0,N=0;for(;x<m&&w<d;){if(E!==u.get(x,w)){if(++N===5)break;E=!E}x++,w++}if(x===m||w===d)throw new ne;return(x-o[0])/7}}li.NO_POINTS=new Array;class Et{PDF417Common(){}static getBitCountSum(o){return Ve.sum(o)}static toIntArray(o){if(o==null||!o.length)return Et.EMPTY_INT_ARRAY;const u=new Int32Array(o.length);let d=0;for(const m of o)u[d++]=m;return u}static getCodeword(o){const u=H.binarySearch(Et.SYMBOL_TABLE,o&262143);return u<0?-1:(Et.CODEWORD_TABLE[u]-1)%Et.NUMBER_OF_CODEWORDS}}Et.NUMBER_OF_CODEWORDS=929,Et.MAX_CODEWORDS_IN_BARCODE=Et.NUMBER_OF_CODEWORDS-1,Et.MIN_ROWS_IN_BARCODE=3,Et.MAX_ROWS_IN_BARCODE=90,Et.MODULES_IN_CODEWORD=17,Et.MODULES_IN_STOP_PATTERN=18,Et.BARS_IN_MODULE=8,Et.EMPTY_INT_ARRAY=new Int32Array([]),Et.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Et.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ef{constructor(o,u){this.bits=o,this.points=u}getBits(){return this.bits}getPoints(){return this.points}}class Mt{static detectMultiple(o,u,d){let m=o.getBlackMatrix(),x=Mt.detect(d,m);return x.length||(m=m.clone(),m.rotate180(),x=Mt.detect(d,m)),new Ef(m,x)}static detect(o,u){const d=new Array;let m=0,x=0,w=!1;for(;m<u.getHeight();){const E=Mt.findVertices(u,m,x);if(E[0]==null&&E[3]==null){if(!w)break;w=!1,x=0;for(const N of d)N[1]!=null&&(m=Math.trunc(Math.max(m,N[1].getY()))),N[3]!=null&&(m=Math.max(m,Math.trunc(N[3].getY())));m+=Mt.ROW_STEP;continue}if(w=!0,d.push(E),!o)break;E[2]!=null?(x=Math.trunc(E[2].getX()),m=Math.trunc(E[2].getY())):(x=Math.trunc(E[4].getX()),m=Math.trunc(E[4].getY()))}return d}static findVertices(o,u,d){const m=o.getHeight(),x=o.getWidth(),w=new Array(8);return Mt.copyToResult(w,Mt.findRowsWithPattern(o,m,x,u,d,Mt.START_PATTERN),Mt.INDEXES_START_PATTERN),w[4]!=null&&(d=Math.trunc(w[4].getX()),u=Math.trunc(w[4].getY())),Mt.copyToResult(w,Mt.findRowsWithPattern(o,m,x,u,d,Mt.STOP_PATTERN),Mt.INDEXES_STOP_PATTERN),w}static copyToResult(o,u,d){for(let m=0;m<d.length;m++)o[d[m]]=u[m]}static findRowsWithPattern(o,u,d,m,x,w){const E=new Array(4);let N=!1;const O=new Int32Array(w.length);for(;m<u;m+=Mt.ROW_STEP){let P=Mt.findGuardPattern(o,x,m,d,!1,w,O);if(P!=null){for(;m>0;){const F=Mt.findGuardPattern(o,x,--m,d,!1,w,O);if(F!=null)P=F;else{m++;break}}E[0]=new tt(P[0],m),E[1]=new tt(P[1],m),N=!0;break}}let I=m+1;if(N){let P=0,F=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;I<u;I++){const q=Mt.findGuardPattern(o,F[0],I,d,!1,w,O);if(q!=null&&Math.abs(F[0]-q[0])<Mt.MAX_PATTERN_DRIFT&&Math.abs(F[1]-q[1])<Mt.MAX_PATTERN_DRIFT)F=q,P=0;else{if(P>Mt.SKIPPED_ROW_COUNT_MAX)break;P++}}I-=P+1,E[2]=new tt(F[0],I),E[3]=new tt(F[1],I)}return I-m<Mt.BARCODE_MIN_HEIGHT&&H.fill(E,null),E}static findGuardPattern(o,u,d,m,x,w,E){H.fillWithin(E,0,E.length,0);let N=u,O=0;for(;o.get(N,d)&&N>0&&O++<Mt.MAX_PIXEL_DRIFT;)N--;let I=N,P=0,F=w.length;for(let q=x;I<m;I++)if(o.get(I,d)!==q)E[P]++;else{if(P===F-1){if(Mt.patternMatchVariance(E,w,Mt.MAX_INDIVIDUAL_VARIANCE)<Mt.MAX_AVG_VARIANCE)return new Int32Array([N,I]);N+=E[0]+E[1],M.arraycopy(E,2,E,0,P-1),E[P-1]=0,E[P]=0,P--}else P++;E[P]=1,q=!q}return P===F-1&&Mt.patternMatchVariance(E,w,Mt.MAX_INDIVIDUAL_VARIANCE)<Mt.MAX_AVG_VARIANCE?new Int32Array([N,I-1]):null}static patternMatchVariance(o,u,d){let m=o.length,x=0,w=0;for(let O=0;O<m;O++)x+=o[O],w+=u[O];if(x<w)return 1/0;let E=x/w;d*=E;let N=0;for(let O=0;O<m;O++){let I=o[O],P=u[O]*E,F=I>P?I-P:P-I;if(F>d)return 1/0;N+=F}return N/x}}Mt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Mt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Mt.MAX_AVG_VARIANCE=.42,Mt.MAX_INDIVIDUAL_VARIANCE=.8,Mt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Mt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Mt.MAX_PIXEL_DRIFT=3,Mt.MAX_PATTERN_DRIFT=5,Mt.SKIPPED_ROW_COUNT_MAX=25,Mt.ROW_STEP=5,Mt.BARCODE_MIN_HEIGHT=10;class Rn{constructor(o,u){if(u.length===0)throw new v;this.field=o;let d=u.length;if(d>1&&u[0]===0){let m=1;for(;m<d&&u[m]===0;)m++;m===d?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(d-m),M.arraycopy(u,m,this.coefficients,0,this.coefficients.length))}else this.coefficients=u}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);if(o===1){let m=0;for(let x of this.coefficients)m=this.field.add(m,x);return m}let u=this.coefficients[0],d=this.coefficients.length;for(let m=1;m<d;m++)u=this.field.add(this.field.multiply(o,u),this.coefficients[m]);return u}add(o){if(!this.field.equals(o.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero())return o;if(o.isZero())return this;let u=this.coefficients,d=o.coefficients;if(u.length>d.length){let w=u;u=d,d=w}let m=new Int32Array(d.length),x=d.length-u.length;M.arraycopy(d,0,m,0,x);for(let w=x;w<d.length;w++)m[w]=this.field.add(u[w-x],d[w]);return new Rn(this.field,m)}subtract(o){if(!this.field.equals(o.field))throw new v("ModulusPolys do not have same ModulusGF field");return o.isZero()?this:this.add(o.negative())}multiply(o){return o instanceof Rn?this.multiplyOther(o):this.multiplyScalar(o)}multiplyOther(o){if(!this.field.equals(o.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero()||o.isZero())return new Rn(this.field,new Int32Array([0]));let u=this.coefficients,d=u.length,m=o.coefficients,x=m.length,w=new Int32Array(d+x-1);for(let E=0;E<d;E++){let N=u[E];for(let O=0;O<x;O++)w[E+O]=this.field.add(w[E+O],this.field.multiply(N,m[O]))}return new Rn(this.field,w)}negative(){let o=this.coefficients.length,u=new Int32Array(o);for(let d=0;d<o;d++)u[d]=this.field.subtract(0,this.coefficients[d]);return new Rn(this.field,u)}multiplyScalar(o){if(o===0)return new Rn(this.field,new Int32Array([0]));if(o===1)return this;let u=this.coefficients.length,d=new Int32Array(u);for(let m=0;m<u;m++)d[m]=this.field.multiply(this.coefficients[m],o);return new Rn(this.field,d)}multiplyByMonomial(o,u){if(o<0)throw new v;if(u===0)return new Rn(this.field,new Int32Array([0]));let d=this.coefficients.length,m=new Int32Array(d+o);for(let x=0;x<d;x++)m[x]=this.field.multiply(this.coefficients[x],u);return new Rn(this.field,m)}toString(){let o=new Ie;for(let u=this.getDegree();u>=0;u--){let d=this.getCoefficient(u);d!==0&&(d<0?(o.append(" - "),d=-d):o.length()>0&&o.append(" + "),(u===0||d!==1)&&o.append(d),u!==0&&(u===1?o.append("x"):(o.append("x^"),o.append(u))))}return o.toString()}}class bu{add(o,u){return(o+u)%this.modulus}subtract(o,u){return(this.modulus+o-u)%this.modulus}exp(o){return this.expTable[o]}log(o){if(o===0)throw new v;return this.logTable[o]}inverse(o){if(o===0)throw new rt;return this.expTable[this.modulus-this.logTable[o]-1]}multiply(o,u){return o===0||u===0?0:this.expTable[(this.logTable[o]+this.logTable[u])%(this.modulus-1)]}getSize(){return this.modulus}equals(o){return o===this}}class $i extends bu{constructor(o,u){super(),this.modulus=o,this.expTable=new Int32Array(o),this.logTable=new Int32Array(o);let d=1;for(let m=0;m<o;m++)this.expTable[m]=d,d=d*u%o;for(let m=0;m<o-1;m++)this.logTable[this.expTable[m]]=m;this.zero=new Rn(this,new Int32Array([0])),this.one=new Rn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,u){if(o<0)throw new v;if(u===0)return this.zero;let d=new Int32Array(o+1);return d[0]=u,new Rn(this,d)}}$i.PDF417_GF=new $i(Et.NUMBER_OF_CODEWORDS,3);class ci{constructor(){this.field=$i.PDF417_GF}decode(o,u,d){let m=new Rn(this.field,o),x=new Int32Array(u),w=!1;for(let re=u;re>0;re--){let ae=m.evaluateAt(this.field.exp(re));x[u-re]=ae,ae!==0&&(w=!0)}if(!w)return 0;let E=this.field.getOne();if(d!=null)for(const re of d){let ae=this.field.exp(o.length-1-re),be=new Rn(this.field,new Int32Array([this.field.subtract(0,ae),1]));E=E.multiply(be)}let N=new Rn(this.field,x),O=this.runEuclideanAlgorithm(this.field.buildMonomial(u,1),N,u),I=O[0],P=O[1],F=this.findErrorLocations(I),q=this.findErrorMagnitudes(P,I,F);for(let re=0;re<F.length;re++){let ae=o.length-1-this.field.log(F[re]);if(ae<0)throw T.getChecksumInstance();o[ae]=this.field.subtract(o[ae],q[re])}return F.length}runEuclideanAlgorithm(o,u,d){if(o.getDegree()<u.getDegree()){let F=o;o=u,u=F}let m=o,x=u,w=this.field.getZero(),E=this.field.getOne();for(;x.getDegree()>=Math.round(d/2);){let F=m,q=w;if(m=x,w=E,m.isZero())throw T.getChecksumInstance();x=F;let re=this.field.getZero(),ae=m.getCoefficient(m.getDegree()),be=this.field.inverse(ae);for(;x.getDegree()>=m.getDegree()&&!x.isZero();){let Ne=x.getDegree()-m.getDegree(),$e=this.field.multiply(x.getCoefficient(x.getDegree()),be);re=re.add(this.field.buildMonomial(Ne,$e)),x=x.subtract(m.multiplyByMonomial(Ne,$e))}E=re.multiply(w).subtract(q).negative()}let N=E.getCoefficient(0);if(N===0)throw T.getChecksumInstance();let O=this.field.inverse(N),I=E.multiply(O),P=x.multiply(O);return[I,P]}findErrorLocations(o){let u=o.getDegree(),d=new Int32Array(u),m=0;for(let x=1;x<this.field.getSize()&&m<u;x++)o.evaluateAt(x)===0&&(d[m]=this.field.inverse(x),m++);if(m!==u)throw T.getChecksumInstance();return d}findErrorMagnitudes(o,u,d){let m=u.getDegree(),x=new Int32Array(m);for(let O=1;O<=m;O++)x[m-O]=this.field.multiply(O,u.getCoefficient(O));let w=new Rn(this.field,x),E=d.length,N=new Int32Array(E);for(let O=0;O<E;O++){let I=this.field.inverse(d[O]),P=this.field.subtract(0,o.evaluateAt(I)),F=this.field.inverse(w.evaluateAt(I));N[O]=this.field.multiply(P,F)}return N}}class ui{constructor(o,u,d,m,x){o instanceof ui?this.constructor_2(o):this.constructor_1(o,u,d,m,x)}constructor_1(o,u,d,m,x){const w=u==null||d==null,E=m==null||x==null;if(w&&E)throw new ne;w?(u=new tt(0,m.getY()),d=new tt(0,x.getY())):E&&(m=new tt(o.getWidth()-1,u.getY()),x=new tt(o.getWidth()-1,d.getY())),this.image=o,this.topLeft=u,this.bottomLeft=d,this.topRight=m,this.bottomRight=x,this.minX=Math.trunc(Math.min(u.getX(),d.getX())),this.maxX=Math.trunc(Math.max(m.getX(),x.getX())),this.minY=Math.trunc(Math.min(u.getY(),m.getY())),this.maxY=Math.trunc(Math.max(d.getY(),x.getY()))}constructor_2(o){this.image=o.image,this.topLeft=o.getTopLeft(),this.bottomLeft=o.getBottomLeft(),this.topRight=o.getTopRight(),this.bottomRight=o.getBottomRight(),this.minX=o.getMinX(),this.maxX=o.getMaxX(),this.minY=o.getMinY(),this.maxY=o.getMaxY()}static merge(o,u){return o==null?u:u==null?o:new ui(o.image,o.topLeft,o.bottomLeft,u.topRight,u.bottomRight)}addMissingRows(o,u,d){let m=this.topLeft,x=this.bottomLeft,w=this.topRight,E=this.bottomRight;if(o>0){let N=d?this.topLeft:this.topRight,O=Math.trunc(N.getY()-o);O<0&&(O=0);let I=new tt(N.getX(),O);d?m=I:w=I}if(u>0){let N=d?this.bottomLeft:this.bottomRight,O=Math.trunc(N.getY()+u);O>=this.image.getHeight()&&(O=this.image.getHeight()-1);let I=new tt(N.getX(),O);d?x=I:E=I}return new ui(this.image,m,x,w,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Xl{constructor(o,u,d,m){this.columnCount=o,this.errorCorrectionLevel=m,this.rowCountUpperPart=u,this.rowCountLowerPart=d,this.rowCount=u+d}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Fa{constructor(){this.buffer=""}static form(o,u){let d=-1;function m(w,E,N,O,I,P){if(w==="%%")return"%";if(u[++d]===void 0)return;w=O?parseInt(O.substr(1)):void 0;let F=I?parseInt(I.substr(1)):void 0,q;switch(P){case"s":q=u[d];break;case"c":q=u[d][0];break;case"f":q=parseFloat(u[d]).toFixed(w);break;case"p":q=parseFloat(u[d]).toPrecision(w);break;case"e":q=parseFloat(u[d]).toExponential(w);break;case"x":q=parseInt(u[d]).toString(F||16);break;case"d":q=parseFloat(parseInt(u[d],F||10).toPrecision(w)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(F);let re=parseInt(N),ae=N&&N[0]+""=="0"?"0":" ";for(;q.length<re;)q=E!==void 0?q+ae:ae+q;return q}let x=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(x,m)}format(o,...u){this.buffer+=Fa.form(o,u)}toString(){return this.buffer}}class Ti{constructor(o){this.boundingBox=new ui(o),this.codewords=new Array(o.getMaxY()-o.getMinY()+1)}getCodewordNearby(o){let u=this.getCodeword(o);if(u!=null)return u;for(let d=1;d<Ti.MAX_NEARBY_DISTANCE;d++){let m=this.imageRowToCodewordIndex(o)-d;if(m>=0&&(u=this.codewords[m],u!=null)||(m=this.imageRowToCodewordIndex(o)+d,m<this.codewords.length&&(u=this.codewords[m],u!=null)))return u}return null}imageRowToCodewordIndex(o){return o-this.boundingBox.getMinY()}setCodeword(o,u){this.codewords[this.imageRowToCodewordIndex(o)]=u}getCodeword(o){return this.codewords[this.imageRowToCodewordIndex(o)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const o=new Fa;let u=0;for(const d of this.codewords){if(d==null){o.format("%3d:    |   %n",u++);continue}o.format("%3d: %3d|%3d%n",u++,d.getRowNumber(),d.getValue())}return o.toString()}}Ti.MAX_NEARBY_DISTANCE=5;class Oi{constructor(){this.values=new Map}setValue(o){o=Math.trunc(o);let u=this.values.get(o);u==null&&(u=0),u++,this.values.set(o,u)}getValue(){let o=-1,u=new Array;for(const[d,m]of this.values.entries()){const x={getKey:()=>d,getValue:()=>m};x.getValue()>o?(o=x.getValue(),u=[],u.push(x.getKey())):x.getValue()===o&&u.push(x.getKey())}return Et.toIntArray(u)}getConfidence(o){return this.values.get(o)}}class yu extends Ti{constructor(o,u){super(o),this._isLeft=u}setRowNumbers(){for(let o of this.getCodewords())o!=null&&o.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(o){let u=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(u,o);let d=this.getBoundingBox(),m=this._isLeft?d.getTopLeft():d.getTopRight(),x=this._isLeft?d.getBottomLeft():d.getBottomRight(),w=this.imageRowToCodewordIndex(Math.trunc(m.getY())),E=this.imageRowToCodewordIndex(Math.trunc(x.getY())),N=-1,O=1,I=0;for(let P=w;P<E;P++){if(u[P]==null)continue;let F=u[P],q=F.getRowNumber()-N;if(q===0)I++;else if(q===1)O=Math.max(O,I),I=1,N=F.getRowNumber();else if(q<0||F.getRowNumber()>=o.getRowCount()||q>P)u[P]=null;else{let re;O>2?re=(O-2)*q:re=q;let ae=re>=P;for(let be=1;be<=re&&!ae;be++)ae=u[P-be]!=null;ae?u[P]=null:(N=F.getRowNumber(),I=1)}}}getRowHeights(){let o=this.getBarcodeMetadata();if(o==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(o);let u=new Int32Array(o.getRowCount());for(let d of this.getCodewords())if(d!=null){let m=d.getRowNumber();if(m>=u.length)continue;u[m]++}return u}adjustIncompleteIndicatorColumnRowNumbers(o){let u=this.getBoundingBox(),d=this._isLeft?u.getTopLeft():u.getTopRight(),m=this._isLeft?u.getBottomLeft():u.getBottomRight(),x=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=this.imageRowToCodewordIndex(Math.trunc(m.getY())),E=this.getCodewords(),N=-1;for(let O=x;O<w;O++){if(E[O]==null)continue;let I=E[O];I.setRowNumberAsRowIndicatorColumn();let P=I.getRowNumber()-N;P===0||(P===1?N=I.getRowNumber():I.getRowNumber()>=o.getRowCount()?E[O]=null:N=I.getRowNumber())}}getBarcodeMetadata(){let o=this.getCodewords(),u=new Oi,d=new Oi,m=new Oi,x=new Oi;for(let E of o){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let N=E.getValue()%30,O=E.getRowNumber();switch(this._isLeft||(O+=2),O%3){case 0:d.setValue(N*3+1);break;case 1:x.setValue(N/3),m.setValue(N%3);break;case 2:u.setValue(N+1);break}}if(u.getValue().length===0||d.getValue().length===0||m.getValue().length===0||x.getValue().length===0||u.getValue()[0]<1||d.getValue()[0]+m.getValue()[0]<Et.MIN_ROWS_IN_BARCODE||d.getValue()[0]+m.getValue()[0]>Et.MAX_ROWS_IN_BARCODE)return null;let w=new Xl(u.getValue()[0],d.getValue()[0],m.getValue()[0],x.getValue()[0]);return this.removeIncorrectCodewords(o,w),w}removeIncorrectCodewords(o,u){for(let d=0;d<o.length;d++){let m=o[d];if(o[d]==null)continue;let x=m.getValue()%30,w=m.getRowNumber();if(w>u.getRowCount()){o[d]=null;continue}switch(this._isLeft||(w+=2),w%3){case 0:x*3+1!==u.getRowCountUpperPart()&&(o[d]=null);break;case 1:(Math.trunc(x/3)!==u.getErrorCorrectionLevel()||x%3!==u.getRowCountLowerPart())&&(o[d]=null);break;case 2:x+1!==u.getColumnCount()&&(o[d]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class gr{constructor(o,u){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=o,this.barcodeColumnCount=o.getColumnCount(),this.boundingBox=u,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let o=Et.MAX_CODEWORDS_IN_BARCODE,u;do u=o,o=this.adjustRowNumbersAndGetCount();while(o>0&&o<u);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(o){o!=null&&o.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let o=this.adjustRowNumbersByRow();if(o===0)return 0;for(let u=1;u<this.barcodeColumnCount+1;u++){let d=this.detectionResultColumns[u].getCodewords();for(let m=0;m<d.length;m++)d[m]!=null&&(d[m].hasValidRowNumber()||this.adjustRowNumbers(u,m,d))}return o}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let o=this.detectionResultColumns[0].getCodewords(),u=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let d=0;d<o.length;d++)if(o[d]!=null&&u[d]!=null&&o[d].getRowNumber()===u[d].getRowNumber())for(let m=1;m<=this.barcodeColumnCount;m++){let x=this.detectionResultColumns[m].getCodewords()[d];x!=null&&(x.setRowNumber(o[d].getRowNumber()),x.hasValidRowNumber()||(this.detectionResultColumns[m].getCodewords()[d]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let o=0,u=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let d=0;d<u.length;d++){if(u[d]==null)continue;let m=u[d].getRowNumber(),x=0;for(let w=this.barcodeColumnCount+1;w>0&&x<this.ADJUST_ROW_NUMBER_SKIP;w--){let E=this.detectionResultColumns[w].getCodewords()[d];E!=null&&(x=gr.adjustRowNumberIfValid(m,x,E),E.hasValidRowNumber()||o++)}}return o}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let o=0,u=this.detectionResultColumns[0].getCodewords();for(let d=0;d<u.length;d++){if(u[d]==null)continue;let m=u[d].getRowNumber(),x=0;for(let w=1;w<this.barcodeColumnCount+1&&x<this.ADJUST_ROW_NUMBER_SKIP;w++){let E=this.detectionResultColumns[w].getCodewords()[d];E!=null&&(x=gr.adjustRowNumberIfValid(m,x,E),E.hasValidRowNumber()||o++)}}return o}static adjustRowNumberIfValid(o,u,d){return d==null||d.hasValidRowNumber()||(d.isValidRowNumber(o)?(d.setRowNumber(o),u=0):++u),u}adjustRowNumbers(o,u,d){if(!this.detectionResultColumns[o-1])return;let m=d[u],x=this.detectionResultColumns[o-1].getCodewords(),w=x;this.detectionResultColumns[o+1]!=null&&(w=this.detectionResultColumns[o+1].getCodewords());let E=new Array(14);E[2]=x[u],E[3]=w[u],u>0&&(E[0]=d[u-1],E[4]=x[u-1],E[5]=w[u-1]),u>1&&(E[8]=d[u-2],E[10]=x[u-2],E[11]=w[u-2]),u<d.length-1&&(E[1]=d[u+1],E[6]=x[u+1],E[7]=w[u+1]),u<d.length-2&&(E[9]=d[u+2],E[12]=x[u+2],E[13]=w[u+2]);for(let N of E)if(gr.adjustRowNumber(m,N))return}static adjustRowNumber(o,u){return u==null?!1:u.hasValidRowNumber()&&u.getBucket()===o.getBucket()?(o.setRowNumber(u.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(o){this.boundingBox=o}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(o,u){this.detectionResultColumns[o]=u}getDetectionResultColumn(o){return this.detectionResultColumns[o]}toString(){let o=this.detectionResultColumns[0];o==null&&(o=this.detectionResultColumns[this.barcodeColumnCount+1]);let u=new Fa;for(let d=0;d<o.getCodewords().length;d++){u.format("CW %3d:",d);for(let m=0;m<this.barcodeColumnCount+2;m++){if(this.detectionResultColumns[m]==null){u.format("    |   ");continue}let x=this.detectionResultColumns[m].getCodewords()[d];if(x==null){u.format("    |   ");continue}u.format(" %3d|%3d",x.getRowNumber(),x.getValue())}u.format("%n")}return u.toString()}}class Rs{constructor(o,u,d,m){this.rowNumber=Rs.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(o),this.endX=Math.trunc(u),this.bucket=Math.trunc(d),this.value=Math.trunc(m)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(o){return o!==Rs.BARCODE_ROW_UNKNOWN&&this.bucket===o%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(o){this.rowNumber=o}toString(){return this.rowNumber+"|"+this.value}}Rs.BARCODE_ROW_UNKNOWN=-1;class Er{static initialize(){for(let o=0;o<Et.SYMBOL_TABLE.length;o++){let u=Et.SYMBOL_TABLE[o],d=u&1;for(let m=0;m<Et.BARS_IN_MODULE;m++){let x=0;for(;(u&1)===d;)x+=1,u>>=1;d=u&1,Er.RATIOS_TABLE[o]||(Er.RATIOS_TABLE[o]=new Array(Et.BARS_IN_MODULE)),Er.RATIOS_TABLE[o][Et.BARS_IN_MODULE-m-1]=Math.fround(x/Et.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(o){let u=Er.getDecodedCodewordValue(Er.sampleBitCounts(o));return u!==-1?u:Er.getClosestDecodedValue(o)}static sampleBitCounts(o){let u=Ve.sum(o),d=new Int32Array(Et.BARS_IN_MODULE),m=0,x=0;for(let w=0;w<Et.MODULES_IN_CODEWORD;w++){let E=u/(2*Et.MODULES_IN_CODEWORD)+w*u/Et.MODULES_IN_CODEWORD;x+o[m]<=E&&(x+=o[m],m++),d[m]++}return d}static getDecodedCodewordValue(o){let u=Er.getBitValue(o);return Et.getCodeword(u)===-1?-1:u}static getBitValue(o){let u=0;for(let d=0;d<o.length;d++)for(let m=0;m<o[d];m++)u=u<<1|(d%2===0?1:0);return Math.trunc(u)}static getClosestDecodedValue(o){let u=Ve.sum(o),d=new Array(Et.BARS_IN_MODULE);if(u>1)for(let w=0;w<d.length;w++)d[w]=Math.fround(o[w]/u);let m=lt.MAX_VALUE,x=-1;this.bSymbolTableReady||Er.initialize();for(let w=0;w<Er.RATIOS_TABLE.length;w++){let E=0,N=Er.RATIOS_TABLE[w];for(let O=0;O<Et.BARS_IN_MODULE;O++){let I=Math.fround(N[O]-d[O]);if(E+=Math.fround(I*I),E>=m)break}E<m&&(m=E,x=Et.SYMBOL_TABLE[w])}return x}}Er.bSymbolTableReady=!1,Er.RATIOS_TABLE=new Array(Et.SYMBOL_TABLE.length).map(B=>new Array(Et.BARS_IN_MODULE));class za{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(o){this.segmentIndex=o}getFileId(){return this.fileId}setFileId(o){this.fileId=o}getOptionalData(){return this.optionalData}setOptionalData(o){this.optionalData=o}isLastSegment(){return this.lastSegment}setLastSegment(o){this.lastSegment=o}getSegmentCount(){return this.segmentCount}setSegmentCount(o){this.segmentCount=o}getSender(){return this.sender||null}setSender(o){this.sender=o}getAddressee(){return this.addressee||null}setAddressee(o){this.addressee=o}getFileName(){return this.fileName}setFileName(o){this.fileName=o}getFileSize(){return this.fileSize}setFileSize(o){this.fileSize=o}getChecksum(){return this.checksum}setChecksum(o){this.checksum=o}getTimestamp(){return this.timestamp}setTimestamp(o){this.timestamp=o}}class Sf{static parseLong(o,u=void 0){return parseInt(o,u)}}class Yl extends g{}Yl.kind="NullPointerException";class wu{writeBytes(o){this.writeBytesOffset(o,0,o.length)}writeBytesOffset(o,u,d){if(o==null)throw new Yl;if(u<0||u>o.length||d<0||u+d>o.length||u+d<0)throw new R;if(d===0)return;for(let m=0;m<d;m++)this.write(o[u+m])}flush(){}close(){}}class Ko extends g{}class Kl extends wu{constructor(o=32){if(super(),this.count=0,o<0)throw new v("Negative initial size: "+o);this.buf=new Uint8Array(o)}ensureCapacity(o){o-this.buf.length>0&&this.grow(o)}grow(o){let d=this.buf.length<<1;if(d-o<0&&(d=o),d<0){if(o<0)throw new Ko;d=G.MAX_VALUE}this.buf=H.copyOfUint8Array(this.buf,d)}write(o){this.ensureCapacity(this.count+1),this.buf[this.count]=o,this.count+=1}writeBytesOffset(o,u,d){if(u<0||u>o.length||d<0||u+d-o.length>0)throw new R;this.ensureCapacity(this.count+d),M.arraycopy(o,u,this.buf,this.count,d),this.count+=d}writeTo(o){o.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return H.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(o){return o?typeof o=="string"?this.toString_string(o):this.toString_number(o):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(o){return new String(this.buf).toString()}toString_number(o){return new String(this.buf).toString()}close(){}}var mn;(function(B){B[B.ALPHA=0]="ALPHA",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.PUNCT=3]="PUNCT",B[B.ALPHA_SHIFT=4]="ALPHA_SHIFT",B[B.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(mn||(mn={}));function Af(){if(typeof window<"u")return window.BigInt||null;if(typeof jh<"u")return jh.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Zl;function _i(B){if(typeof Zl>"u"&&(Zl=Af()),Zl===null)throw new Error("BigInt is not supported!");return Zl(B)}function vu(){let B=[];B[0]=_i(1);let o=_i(900);B[1]=o;for(let u=2;u<16;u++)B[u]=B[u-1]*o;return B}class ke{static decode(o,u){let d=new Ie(""),m=X.ISO8859_1;d.enableDecoding(m);let x=1,w=o[x++],E=new za;for(;x<o[0];){switch(w){case ke.TEXT_COMPACTION_MODE_LATCH:x=ke.textCompaction(o,x,d);break;case ke.BYTE_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH_6:x=ke.byteCompaction(w,o,m,x,d);break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[x++]);break;case ke.NUMERIC_COMPACTION_MODE_LATCH:x=ke.numericCompaction(o,x,d);break;case ke.ECI_CHARSET:X.getCharacterSetECIByValue(o[x++]);break;case ke.ECI_GENERAL_PURPOSE:x+=2;break;case ke.ECI_USER_DEFINED:x++;break;case ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK:x=ke.decodeMacroBlock(o,x,E);break;case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ke.MACRO_PDF417_TERMINATOR:throw new U;default:x--,x=ke.textCompaction(o,x,d);break}if(x<o.length)w=o[x++];else throw U.getFormatInstance()}if(d.length()===0)throw U.getFormatInstance();let N=new Ce(null,d.toString(),null,u);return N.setOther(E),N}static decodeMacroBlock(o,u,d){if(u+ke.NUMBER_OF_SEQUENCE_CODEWORDS>o[0])throw U.getFormatInstance();let m=new Int32Array(ke.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<ke.NUMBER_OF_SEQUENCE_CODEWORDS;E++,u++)m[E]=o[u];d.setSegmentIndex(G.parseInt(ke.decodeBase900toBase10(m,ke.NUMBER_OF_SEQUENCE_CODEWORDS)));let x=new Ie;u=ke.textCompaction(o,u,x),d.setFileId(x.toString());let w=-1;for(o[u]===ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(w=u+1);u<o[0];)switch(o[u]){case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(u++,o[u]){case ke.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new Ie;u=ke.textCompaction(o,u+1,E),d.setFileName(E.toString());break;case ke.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let N=new Ie;u=ke.textCompaction(o,u+1,N),d.setSender(N.toString());break;case ke.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let O=new Ie;u=ke.textCompaction(o,u+1,O),d.setAddressee(O.toString());break;case ke.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let I=new Ie;u=ke.numericCompaction(o,u+1,I),d.setSegmentCount(G.parseInt(I.toString()));break;case ke.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let P=new Ie;u=ke.numericCompaction(o,u+1,P),d.setTimestamp(Sf.parseLong(P.toString()));break;case ke.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let F=new Ie;u=ke.numericCompaction(o,u+1,F),d.setChecksum(G.parseInt(F.toString()));break;case ke.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let q=new Ie;u=ke.numericCompaction(o,u+1,q),d.setFileSize(Sf.parseLong(q.toString()));break;default:throw U.getFormatInstance()}break;case ke.MACRO_PDF417_TERMINATOR:u++,d.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(w!==-1){let E=u-w;d.isLastSegment()&&E--,d.setOptionalData(H.copyOfRange(o,w,w+E))}return u}static textCompaction(o,u,d){let m=new Int32Array((o[0]-u)*2),x=new Int32Array((o[0]-u)*2),w=0,E=!1;for(;u<o[0]&&!E;){let N=o[u++];if(N<ke.TEXT_COMPACTION_MODE_LATCH)m[w]=N/30,m[w+1]=N%30,w+=2;else switch(N){case ke.TEXT_COMPACTION_MODE_LATCH:m[w++]=ke.TEXT_COMPACTION_MODE_LATCH;break;case ke.BYTE_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH_6:case ke.NUMERIC_COMPACTION_MODE_LATCH:case ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ke.MACRO_PDF417_TERMINATOR:u--,E=!0;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m[w]=ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,N=o[u++],x[w]=N,w++;break}}return ke.decodeTextCompaction(m,x,w,d),u}static decodeTextCompaction(o,u,d,m){let x=mn.ALPHA,w=mn.ALPHA,E=0;for(;E<d;){let N=o[E],O="";switch(x){case mn.ALPHA:if(N<26)O=String.fromCharCode(65+N);else switch(N){case 26:O=" ";break;case ke.LL:x=mn.LOWER;break;case ke.ML:x=mn.MIXED;break;case ke.PS:w=x,x=mn.PUNCT_SHIFT;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(u[E]);break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break;case mn.LOWER:if(N<26)O=String.fromCharCode(97+N);else switch(N){case 26:O=" ";break;case ke.AS:w=x,x=mn.ALPHA_SHIFT;break;case ke.ML:x=mn.MIXED;break;case ke.PS:w=x,x=mn.PUNCT_SHIFT;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(u[E]);break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break;case mn.MIXED:if(N<ke.PL)O=ke.MIXED_CHARS[N];else switch(N){case ke.PL:x=mn.PUNCT;break;case 26:O=" ";break;case ke.LL:x=mn.LOWER;break;case ke.AL:x=mn.ALPHA;break;case ke.PS:w=x,x=mn.PUNCT_SHIFT;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(u[E]);break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break;case mn.PUNCT:if(N<ke.PAL)O=ke.PUNCT_CHARS[N];else switch(N){case ke.PAL:x=mn.ALPHA;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(u[E]);break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break;case mn.ALPHA_SHIFT:if(x=w,N<26)O=String.fromCharCode(65+N);else switch(N){case 26:O=" ";break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break;case mn.PUNCT_SHIFT:if(x=w,N<ke.PAL)O=ke.PUNCT_CHARS[N];else switch(N){case ke.PAL:x=mn.ALPHA;break;case ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(u[E]);break;case ke.TEXT_COMPACTION_MODE_LATCH:x=mn.ALPHA;break}break}O!==""&&m.append(O),E++}}static byteCompaction(o,u,d,m,x){let w=new Kl,E=0,N=0,O=!1;switch(o){case ke.BYTE_COMPACTION_MODE_LATCH:let I=new Int32Array(6),P=u[m++];for(;m<u[0]&&!O;)switch(I[E++]=P,N=900*N+P,P=u[m++],P){case ke.TEXT_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH:case ke.NUMERIC_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH_6:case ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ke.MACRO_PDF417_TERMINATOR:m--,O=!0;break;default:if(E%5===0&&E>0){for(let F=0;F<6;++F)w.write(Number(_i(N)>>_i(8*(5-F))));N=0,E=0}break}m===u[0]&&P<ke.TEXT_COMPACTION_MODE_LATCH&&(I[E++]=P);for(let F=0;F<E;F++)w.write(I[F]);break;case ke.BYTE_COMPACTION_MODE_LATCH_6:for(;m<u[0]&&!O;){let F=u[m++];if(F<ke.TEXT_COMPACTION_MODE_LATCH)E++,N=900*N+F;else switch(F){case ke.TEXT_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH:case ke.NUMERIC_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH_6:case ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ke.MACRO_PDF417_TERMINATOR:m--,O=!0;break}if(E%5===0&&E>0){for(let q=0;q<6;++q)w.write(Number(_i(N)>>_i(8*(5-q))));N=0,E=0}}break}return x.append(je.decode(w.toByteArray(),d)),m}static numericCompaction(o,u,d){let m=0,x=!1,w=new Int32Array(ke.MAX_NUMERIC_CODEWORDS);for(;u<o[0]&&!x;){let E=o[u++];if(u===o[0]&&(x=!0),E<ke.TEXT_COMPACTION_MODE_LATCH)w[m]=E,m++;else switch(E){case ke.TEXT_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH:case ke.BYTE_COMPACTION_MODE_LATCH_6:case ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ke.MACRO_PDF417_TERMINATOR:u--,x=!0;break}(m%ke.MAX_NUMERIC_CODEWORDS===0||E===ke.NUMERIC_COMPACTION_MODE_LATCH||x)&&m>0&&(d.append(ke.decodeBase900toBase10(w,m)),m=0)}return u}static decodeBase900toBase10(o,u){let d=_i(0);for(let x=0;x<u;x++)d+=ke.EXP900[u-x-1]*_i(o[x]);let m=d.toString();if(m.charAt(0)!=="1")throw new U;return m.substring(1)}}ke.TEXT_COMPACTION_MODE_LATCH=900,ke.BYTE_COMPACTION_MODE_LATCH=901,ke.NUMERIC_COMPACTION_MODE_LATCH=902,ke.BYTE_COMPACTION_MODE_LATCH_6=924,ke.ECI_USER_DEFINED=925,ke.ECI_GENERAL_PURPOSE=926,ke.ECI_CHARSET=927,ke.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ke.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ke.MACRO_PDF417_TERMINATOR=922,ke.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ke.MAX_NUMERIC_CODEWORDS=15,ke.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ke.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ke.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ke.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ke.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ke.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ke.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ke.PL=25,ke.LL=27,ke.AS=27,ke.ML=28,ke.AL=28,ke.PS=29,ke.PAL=29,ke.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ke.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ke.EXP900=Af()?vu():[],ke.NUMBER_OF_SEQUENCE_CODEWORDS=2;class zt{constructor(){}static decode(o,u,d,m,x,w,E){let N=new ui(o,u,d,m,x),O=null,I=null,P;for(let re=!0;;re=!1){if(u!=null&&(O=zt.getRowIndicatorColumn(o,N,u,!0,w,E)),m!=null&&(I=zt.getRowIndicatorColumn(o,N,m,!1,w,E)),P=zt.merge(O,I),P==null)throw ne.getNotFoundInstance();let ae=P.getBoundingBox();if(re&&ae!=null&&(ae.getMinY()<N.getMinY()||ae.getMaxY()>N.getMaxY()))N=ae;else break}P.setBoundingBox(N);let F=P.getBarcodeColumnCount()+1;P.setDetectionResultColumn(0,O),P.setDetectionResultColumn(F,I);let q=O!=null;for(let re=1;re<=F;re++){let ae=q?re:F-re;if(P.getDetectionResultColumn(ae)!==void 0)continue;let be;ae===0||ae===F?be=new yu(N,ae===0):be=new Ti(N),P.setDetectionResultColumn(ae,be);let Ne=-1,$e=Ne;for(let Ge=N.getMinY();Ge<=N.getMaxY();Ge++){if(Ne=zt.getStartColumn(P,ae,Ge,q),Ne<0||Ne>N.getMaxX()){if($e===-1)continue;Ne=$e}let Ue=zt.detectCodeword(o,N.getMinX(),N.getMaxX(),q,Ne,Ge,w,E);Ue!=null&&(be.setCodeword(Ge,Ue),$e=Ne,w=Math.min(w,Ue.getWidth()),E=Math.max(E,Ue.getWidth()))}}return zt.createDecoderResult(P)}static merge(o,u){if(o==null&&u==null)return null;let d=zt.getBarcodeMetadata(o,u);if(d==null)return null;let m=ui.merge(zt.adjustBoundingBox(o),zt.adjustBoundingBox(u));return new gr(d,m)}static adjustBoundingBox(o){if(o==null)return null;let u=o.getRowHeights();if(u==null)return null;let d=zt.getMax(u),m=0;for(let E of u)if(m+=d-E,E>0)break;let x=o.getCodewords();for(let E=0;m>0&&x[E]==null;E++)m--;let w=0;for(let E=u.length-1;E>=0&&(w+=d-u[E],!(u[E]>0));E--);for(let E=x.length-1;w>0&&x[E]==null;E--)w--;return o.getBoundingBox().addMissingRows(m,w,o.isLeft())}static getMax(o){let u=-1;for(let d of o)u=Math.max(u,d);return u}static getBarcodeMetadata(o,u){let d;if(o==null||(d=o.getBarcodeMetadata())==null)return u==null?null:u.getBarcodeMetadata();let m;return u==null||(m=u.getBarcodeMetadata())==null?d:d.getColumnCount()!==m.getColumnCount()&&d.getErrorCorrectionLevel()!==m.getErrorCorrectionLevel()&&d.getRowCount()!==m.getRowCount()?null:d}static getRowIndicatorColumn(o,u,d,m,x,w){let E=new yu(u,m);for(let N=0;N<2;N++){let O=N===0?1:-1,I=Math.trunc(Math.trunc(d.getX()));for(let P=Math.trunc(Math.trunc(d.getY()));P<=u.getMaxY()&&P>=u.getMinY();P+=O){let F=zt.detectCodeword(o,0,o.getWidth(),m,I,P,x,w);F!=null&&(E.setCodeword(P,F),m?I=F.getStartX():I=F.getEndX())}}return E}static adjustCodewordCount(o,u){let d=u[0][1],m=d.getValue(),x=o.getBarcodeColumnCount()*o.getBarcodeRowCount()-zt.getNumberOfECCodeWords(o.getBarcodeECLevel());if(m.length===0){if(x<1||x>Et.MAX_CODEWORDS_IN_BARCODE)throw ne.getNotFoundInstance();d.setValue(x)}else m[0]!==x&&d.setValue(x)}static createDecoderResult(o){let u=zt.createBarcodeMatrix(o);zt.adjustCodewordCount(o,u);let d=new Array,m=new Int32Array(o.getBarcodeRowCount()*o.getBarcodeColumnCount()),x=[],w=new Array;for(let N=0;N<o.getBarcodeRowCount();N++)for(let O=0;O<o.getBarcodeColumnCount();O++){let I=u[N][O+1].getValue(),P=N*o.getBarcodeColumnCount()+O;I.length===0?d.push(P):I.length===1?m[P]=I[0]:(w.push(P),x.push(I))}let E=new Array(x.length);for(let N=0;N<E.length;N++)E[N]=x[N];return zt.createDecoderResultFromAmbiguousValues(o.getBarcodeECLevel(),m,Et.toIntArray(d),Et.toIntArray(w),E)}static createDecoderResultFromAmbiguousValues(o,u,d,m,x){let w=new Int32Array(m.length),E=100;for(;E-- >0;){for(let N=0;N<w.length;N++)u[m[N]]=x[N][w[N]];try{return zt.decodeCodewords(u,o,d)}catch(N){if(!(N instanceof T))throw N}if(w.length===0)throw T.getChecksumInstance();for(let N=0;N<w.length;N++)if(w[N]<x[N].length-1){w[N]++;break}else if(w[N]=0,N===w.length-1)throw T.getChecksumInstance()}throw T.getChecksumInstance()}static createBarcodeMatrix(o){let u=Array.from({length:o.getBarcodeRowCount()},()=>new Array(o.getBarcodeColumnCount()+2));for(let m=0;m<u.length;m++)for(let x=0;x<u[m].length;x++)u[m][x]=new Oi;let d=0;for(let m of o.getDetectionResultColumns()){if(m!=null){for(let x of m.getCodewords())if(x!=null){let w=x.getRowNumber();if(w>=0){if(w>=u.length)continue;u[w][d].setValue(x.getValue())}}}d++}return u}static isValidBarcodeColumn(o,u){return u>=0&&u<=o.getBarcodeColumnCount()+1}static getStartColumn(o,u,d,m){let x=m?1:-1,w=null;if(zt.isValidBarcodeColumn(o,u-x)&&(w=o.getDetectionResultColumn(u-x).getCodeword(d)),w!=null)return m?w.getEndX():w.getStartX();if(w=o.getDetectionResultColumn(u).getCodewordNearby(d),w!=null)return m?w.getStartX():w.getEndX();if(zt.isValidBarcodeColumn(o,u-x)&&(w=o.getDetectionResultColumn(u-x).getCodewordNearby(d)),w!=null)return m?w.getEndX():w.getStartX();let E=0;for(;zt.isValidBarcodeColumn(o,u-x);){u-=x;for(let N of o.getDetectionResultColumn(u).getCodewords())if(N!=null)return(m?N.getEndX():N.getStartX())+x*E*(N.getEndX()-N.getStartX());E++}return m?o.getBoundingBox().getMinX():o.getBoundingBox().getMaxX()}static detectCodeword(o,u,d,m,x,w,E,N){x=zt.adjustCodewordStartColumn(o,u,d,m,x,w);let O=zt.getModuleBitCount(o,u,d,m,x,w);if(O==null)return null;let I,P=Ve.sum(O);if(m)I=x+P;else{for(let re=0;re<O.length/2;re++){let ae=O[re];O[re]=O[O.length-1-re],O[O.length-1-re]=ae}I=x,x=I-P}if(!zt.checkCodewordSkew(P,E,N))return null;let F=Er.getDecodedValue(O),q=Et.getCodeword(F);return q===-1?null:new Rs(x,I,zt.getCodewordBucketNumber(F),q)}static getModuleBitCount(o,u,d,m,x,w){let E=x,N=new Int32Array(8),O=0,I=m?1:-1,P=m;for(;(m?E<d:E>=u)&&O<N.length;)o.get(E,w)===P?(N[O]++,E+=I):(O++,P=!P);return O===N.length||E===(m?d:u)&&O===N.length-1?N:null}static getNumberOfECCodeWords(o){return 2<<o}static adjustCodewordStartColumn(o,u,d,m,x,w){let E=x,N=m?-1:1;for(let O=0;O<2;O++){for(;(m?E>=u:E<d)&&m===o.get(E,w);){if(Math.abs(x-E)>zt.CODEWORD_SKEW_SIZE)return x;E+=N}N=-N,m=!m}return E}static checkCodewordSkew(o,u,d){return u-zt.CODEWORD_SKEW_SIZE<=o&&o<=d+zt.CODEWORD_SKEW_SIZE}static decodeCodewords(o,u,d){if(o.length===0)throw U.getFormatInstance();let m=1<<u+1,x=zt.correctErrors(o,d,m);zt.verifyCodewordCount(o,m);let w=ke.decode(o,""+u);return w.setErrorsCorrected(x),w.setErasures(d.length),w}static correctErrors(o,u,d){if(u!=null&&u.length>d/2+zt.MAX_ERRORS||d<0||d>zt.MAX_EC_CODEWORDS)throw T.getChecksumInstance();return zt.errorCorrection.decode(o,d,u)}static verifyCodewordCount(o,u){if(o.length<4)throw U.getFormatInstance();let d=o[0];if(d>o.length)throw U.getFormatInstance();if(d===0)if(u<o.length)o[0]=o.length-u;else throw U.getFormatInstance()}static getBitCountForCodeword(o){let u=new Int32Array(8),d=0,m=u.length-1;for(;!((o&1)!==d&&(d=o&1,m--,m<0));)u[m]++,o>>=1;return u}static getCodewordBucketNumber(o){return o instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(o):this.getCodewordBucketNumber_number(o)}static getCodewordBucketNumber_number(o){return zt.getCodewordBucketNumber(zt.getBitCountForCodeword(o))}static getCodewordBucketNumber_Int32Array(o){return(o[0]-o[2]+o[4]-o[6]+9)%9}static toString(o){let u=new Fa;for(let d=0;d<o.length;d++){u.format("Row %2d: ",d);for(let m=0;m<o[d].length;m++){let x=o[d][m];x.getValue().length===0?u.format("        ",null):u.format("%4d(%2d)",x.getValue()[0],x.getConfidence(x.getValue()[0]))}u.format("%n")}return u.toString()}}zt.CODEWORD_SKEW_SIZE=2,zt.MAX_ERRORS=3,zt.MAX_EC_CODEWORDS=512,zt.errorCorrection=new ci;class Sr{decode(o,u=null){let d=Sr.decode(o,u,!1);if(d==null||d.length===0||d[0]==null)throw ne.getNotFoundInstance();return d[0]}decodeMultiple(o,u=null){try{return Sr.decode(o,u,!0)}catch(d){throw d instanceof U||d instanceof T?ne.getNotFoundInstance():d}}static decode(o,u,d){const m=new Array,x=Mt.detectMultiple(o,u,d);for(const w of x.getPoints()){const E=zt.decode(x.getBits(),w[4],w[5],w[6],w[7],Sr.getMinCodewordWidth(w),Sr.getMaxCodewordWidth(w)),N=new ge(E.getText(),E.getRawBytes(),void 0,w,se.PDF_417);N.putMetadata(K.ERROR_CORRECTION_LEVEL,E.getECLevel());const O=E.getOther();O!=null&&N.putMetadata(K.PDF417_EXTRA_METADATA,O),m.push(N)}return m.map(w=>w)}static getMaxWidth(o,u){return o==null||u==null?0:Math.trunc(Math.abs(o.getX()-u.getX()))}static getMinWidth(o,u){return o==null||u==null?G.MAX_VALUE:Math.trunc(Math.abs(o.getX()-u.getX()))}static getMaxCodewordWidth(o){return Math.floor(Math.max(Math.max(Sr.getMaxWidth(o[0],o[4]),Sr.getMaxWidth(o[6],o[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.max(Sr.getMaxWidth(o[1],o[5]),Sr.getMaxWidth(o[7],o[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(o){return Math.floor(Math.min(Math.min(Sr.getMinWidth(o[0],o[4]),Sr.getMinWidth(o[6],o[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.min(Sr.getMinWidth(o[1],o[5]),Sr.getMinWidth(o[7],o[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}reset(){}}class Jl extends g{}Jl.kind="ReaderException";class Nf{constructor(o,u){this.verbose=o===!0,u&&this.setHints(u)}decode(o,u){return u&&this.setHints(u),this.decodeInternal(o)}decodeWithState(o){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(o)}setHints(o){this.hints=o;const u=!r(o)&&o.get(oe.TRY_HARDER)===!0,d=r(o)?null:o.get(oe.POSSIBLE_FORMATS),m=new Array;if(!r(d)){const x=d.some(w=>w===se.UPC_A||w===se.UPC_E||w===se.EAN_13||w===se.EAN_8||w===se.CODABAR||w===se.CODE_39||w===se.CODE_93||w===se.CODE_128||w===se.ITF||w===se.RSS_14||w===se.RSS_EXPANDED);x&&!u&&m.push(new Jr(o,this.verbose)),d.includes(se.QR_CODE)&&m.push(new li),d.includes(se.DATA_MATRIX)&&m.push(new en),d.includes(se.AZTEC)&&m.push(new nr),d.includes(se.PDF_417)&&m.push(new Sr),x&&u&&m.push(new Jr(o,this.verbose))}m.length===0&&(u||m.push(new Jr(o,this.verbose)),m.push(new li),m.push(new en),m.push(new nr),m.push(new Sr),u&&m.push(new Jr(o,this.verbose))),this.readers=m}reset(){if(this.readers!==null)for(const o of this.readers)o.reset()}decodeInternal(o){if(this.readers===null)throw new Jl("No readers where selected, nothing can be read.");for(const u of this.readers)try{return u.decode(o,this.hints)}catch(d){if(d instanceof Jl)continue}throw new ne("No MultiFormat Readers were able to detect the code.")}}class kf extends fe{constructor(o=null,u=500){const d=new Nf;d.setHints(o),super(d,u)}decodeBitmap(o){return this.reader.decodeWithState(o)}}class g1 extends fe{constructor(o=500){super(new Sr,o)}}class x1 extends fe{constructor(o=500){super(new li,o)}}var Cu;(function(B){B[B.ERROR_CORRECTION=0]="ERROR_CORRECTION",B[B.CHARACTER_SET=1]="CHARACTER_SET",B[B.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",B[B.MIN_SIZE=3]="MIN_SIZE",B[B.MAX_SIZE=4]="MAX_SIZE",B[B.MARGIN=5]="MARGIN",B[B.PDF417_COMPACT=6]="PDF417_COMPACT",B[B.PDF417_COMPACTION=7]="PDF417_COMPACTION",B[B.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",B[B.AZTEC_LAYERS=9]="AZTEC_LAYERS",B[B.QR_VERSION=10]="QR_VERSION"})(Cu||(Cu={}));var fr=Cu;class Zo{constructor(o){this.field=o,this.cachedGenerators=[],this.cachedGenerators.push(new ze(o,Int32Array.from([1])))}buildGenerator(o){const u=this.cachedGenerators;if(o>=u.length){let d=u[u.length-1];const m=this.field;for(let x=u.length;x<=o;x++){const w=d.multiply(new ze(m,Int32Array.from([1,m.exp(x-1+m.getGeneratorBase())])));u.push(w),d=w}}return u[o]}encode(o,u){if(u===0)throw new v("No error correction bytes");const d=o.length-u;if(d<=0)throw new v("No data bytes provided");const m=this.buildGenerator(u),x=new Int32Array(d);M.arraycopy(o,0,x,0,d);let w=new ze(this.field,x);w=w.multiplyByMonomial(u,1);const N=w.divide(m)[1].getCoefficients(),O=u-N.length;for(let I=0;I<O;I++)o[d+I]=0;M.arraycopy(N,0,o,d+O,N.length)}}class Zn{constructor(){}static applyMaskPenaltyRule1(o){return Zn.applyMaskPenaltyRule1Internal(o,!0)+Zn.applyMaskPenaltyRule1Internal(o,!1)}static applyMaskPenaltyRule2(o){let u=0;const d=o.getArray(),m=o.getWidth(),x=o.getHeight();for(let w=0;w<x-1;w++){const E=d[w];for(let N=0;N<m-1;N++){const O=E[N];O===E[N+1]&&O===d[w+1][N]&&O===d[w+1][N+1]&&u++}}return Zn.N2*u}static applyMaskPenaltyRule3(o){let u=0;const d=o.getArray(),m=o.getWidth(),x=o.getHeight();for(let w=0;w<x;w++)for(let E=0;E<m;E++){const N=d[w];E+6<m&&N[E]===1&&N[E+1]===0&&N[E+2]===1&&N[E+3]===1&&N[E+4]===1&&N[E+5]===0&&N[E+6]===1&&(Zn.isWhiteHorizontal(N,E-4,E)||Zn.isWhiteHorizontal(N,E+7,E+11))&&u++,w+6<x&&d[w][E]===1&&d[w+1][E]===0&&d[w+2][E]===1&&d[w+3][E]===1&&d[w+4][E]===1&&d[w+5][E]===0&&d[w+6][E]===1&&(Zn.isWhiteVertical(d,E,w-4,w)||Zn.isWhiteVertical(d,E,w+7,w+11))&&u++}return u*Zn.N3}static isWhiteHorizontal(o,u,d){u=Math.max(u,0),d=Math.min(d,o.length);for(let m=u;m<d;m++)if(o[m]===1)return!1;return!0}static isWhiteVertical(o,u,d,m){d=Math.max(d,0),m=Math.min(m,o.length);for(let x=d;x<m;x++)if(o[x][u]===1)return!1;return!0}static applyMaskPenaltyRule4(o){let u=0;const d=o.getArray(),m=o.getWidth(),x=o.getHeight();for(let N=0;N<x;N++){const O=d[N];for(let I=0;I<m;I++)O[I]===1&&u++}const w=o.getHeight()*o.getWidth();return Math.floor(Math.abs(u*2-w)*10/w)*Zn.N4}static getDataMaskBit(o,u,d){let m,x;switch(o){case 0:m=d+u&1;break;case 1:m=d&1;break;case 2:m=u%3;break;case 3:m=(d+u)%3;break;case 4:m=Math.floor(d/2)+Math.floor(u/3)&1;break;case 5:x=d*u,m=(x&1)+x%3;break;case 6:x=d*u,m=(x&1)+x%3&1;break;case 7:x=d*u,m=x%3+(d+u&1)&1;break;default:throw new v("Invalid mask pattern: "+o)}return m===0}static applyMaskPenaltyRule1Internal(o,u){let d=0;const m=u?o.getHeight():o.getWidth(),x=u?o.getWidth():o.getHeight(),w=o.getArray();for(let E=0;E<m;E++){let N=0,O=-1;for(let I=0;I<x;I++){const P=u?w[E][I]:w[I][E];P===O?N++:(N>=5&&(d+=Zn.N1+(N-5)),N=1,O=P)}N>=5&&(d+=Zn.N1+(N-5))}return d}}Zn.N1=3,Zn.N2=3,Zn.N3=40,Zn.N4=10;class Ql{constructor(o,u){this.width=o,this.height=u;const d=new Array(u);for(let m=0;m!==u;m++)d[m]=new Uint8Array(o);this.bytes=d}getHeight(){return this.height}getWidth(){return this.width}get(o,u){return this.bytes[u][o]}getArray(){return this.bytes}setNumber(o,u,d){this.bytes[u][o]=d}setBoolean(o,u,d){this.bytes[u][o]=d?1:0}clear(o){for(const u of this.bytes)H.fill(u,o)}equals(o){if(!(o instanceof Ql))return!1;const u=o;if(this.width!==u.width||this.height!==u.height)return!1;for(let d=0,m=this.height;d<m;++d){const x=this.bytes[d],w=u.bytes[d];for(let E=0,N=this.width;E<N;++E)if(x[E]!==w[E])return!1}return!0}toString(){const o=new Ie;for(let u=0,d=this.height;u<d;++u){const m=this.bytes[u];for(let x=0,w=this.width;x<w;++x)switch(m[x]){case 0:o.append(" 0");break;case 1:o.append(" 1");break;default:o.append("  ");break}o.append(`
`)}return o.toString()}}class Xi{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const o=new Ie;return o.append(`<<
`),o.append(" mode: "),o.append(this.mode?this.mode.toString():"null"),o.append(`
 ecLevel: `),o.append(this.ecLevel?this.ecLevel.toString():"null"),o.append(`
 version: `),o.append(this.version?this.version.toString():"null"),o.append(`
 maskPattern: `),o.append(this.maskPattern.toString()),this.matrix?(o.append(`
 matrix:
`),o.append(this.matrix.toString())):o.append(`
 matrix: null
`),o.append(`>>
`),o.toString()}setMode(o){this.mode=o}setECLevel(o){this.ecLevel=o}setVersion(o){this.version=o}setMaskPattern(o){this.maskPattern=o}setMatrix(o){this.matrix=o}static isValidMaskPattern(o){return o>=0&&o<Xi.NUM_MASK_PATTERNS}}Xi.NUM_MASK_PATTERNS=8;class wn extends g{}wn.kind="WriterException";class St{constructor(){}static clearMatrix(o){o.clear(255)}static buildMatrix(o,u,d,m,x){St.clearMatrix(x),St.embedBasicPatterns(d,x),St.embedTypeInfo(u,m,x),St.maybeEmbedVersionInfo(d,x),St.embedDataBits(o,m,x)}static embedBasicPatterns(o,u){St.embedPositionDetectionPatternsAndSeparators(u),St.embedDarkDotAtLeftBottomCorner(u),St.maybeEmbedPositionAdjustmentPatterns(o,u),St.embedTimingPatterns(u)}static embedTypeInfo(o,u,d){const m=new Z;St.makeTypeInfoBits(o,u,m);for(let x=0,w=m.getSize();x<w;++x){const E=m.get(m.getSize()-1-x),N=St.TYPE_INFO_COORDINATES[x],O=N[0],I=N[1];if(d.setBoolean(O,I,E),x<8){const P=d.getWidth()-x-1;d.setBoolean(P,8,E)}else{const F=d.getHeight()-7+(x-8);d.setBoolean(8,F,E)}}}static maybeEmbedVersionInfo(o,u){if(o.getVersionNumber()<7)return;const d=new Z;St.makeVersionInfoBits(o,d);let m=17;for(let x=0;x<6;++x)for(let w=0;w<3;++w){const E=d.get(m);m--,u.setBoolean(x,u.getHeight()-11+w,E),u.setBoolean(u.getHeight()-11+w,x,E)}}static embedDataBits(o,u,d){let m=0,x=-1,w=d.getWidth()-1,E=d.getHeight()-1;for(;w>0;){for(w===6&&(w-=1);E>=0&&E<d.getHeight();){for(let N=0;N<2;++N){const O=w-N;if(!St.isEmpty(d.get(O,E)))continue;let I;m<o.getSize()?(I=o.get(m),++m):I=!1,u!==255&&Zn.getDataMaskBit(u,O,E)&&(I=!I),d.setBoolean(O,E,I)}E+=x}x=-x,E+=x,w-=2}if(m!==o.getSize())throw new wn("Not all bits consumed: "+m+"/"+o.getSize())}static findMSBSet(o){return 32-G.numberOfLeadingZeros(o)}static calculateBCHCode(o,u){if(u===0)throw new v("0 polynomial");const d=St.findMSBSet(u);for(o<<=d-1;St.findMSBSet(o)>=d;)o^=u<<St.findMSBSet(o)-d;return o}static makeTypeInfoBits(o,u,d){if(!Xi.isValidMaskPattern(u))throw new wn("Invalid mask pattern");const m=o.getBits()<<3|u;d.appendBits(m,5);const x=St.calculateBCHCode(m,St.TYPE_INFO_POLY);d.appendBits(x,10);const w=new Z;if(w.appendBits(St.TYPE_INFO_MASK_PATTERN,15),d.xor(w),d.getSize()!==15)throw new wn("should not happen but we got: "+d.getSize())}static makeVersionInfoBits(o,u){u.appendBits(o.getVersionNumber(),6);const d=St.calculateBCHCode(o.getVersionNumber(),St.VERSION_INFO_POLY);if(u.appendBits(d,12),u.getSize()!==18)throw new wn("should not happen but we got: "+u.getSize())}static isEmpty(o){return o===255}static embedTimingPatterns(o){for(let u=8;u<o.getWidth()-8;++u){const d=(u+1)%2;St.isEmpty(o.get(u,6))&&o.setNumber(u,6,d),St.isEmpty(o.get(6,u))&&o.setNumber(6,u,d)}}static embedDarkDotAtLeftBottomCorner(o){if(o.get(8,o.getHeight()-8)===0)throw new wn;o.setNumber(8,o.getHeight()-8,1)}static embedHorizontalSeparationPattern(o,u,d){for(let m=0;m<8;++m){if(!St.isEmpty(d.get(o+m,u)))throw new wn;d.setNumber(o+m,u,0)}}static embedVerticalSeparationPattern(o,u,d){for(let m=0;m<7;++m){if(!St.isEmpty(d.get(o,u+m)))throw new wn;d.setNumber(o,u+m,0)}}static embedPositionAdjustmentPattern(o,u,d){for(let m=0;m<5;++m){const x=St.POSITION_ADJUSTMENT_PATTERN[m];for(let w=0;w<5;++w)d.setNumber(o+w,u+m,x[w])}}static embedPositionDetectionPattern(o,u,d){for(let m=0;m<7;++m){const x=St.POSITION_DETECTION_PATTERN[m];for(let w=0;w<7;++w)d.setNumber(o+w,u+m,x[w])}}static embedPositionDetectionPatternsAndSeparators(o){const u=St.POSITION_DETECTION_PATTERN[0].length;St.embedPositionDetectionPattern(0,0,o),St.embedPositionDetectionPattern(o.getWidth()-u,0,o),St.embedPositionDetectionPattern(0,o.getWidth()-u,o);const d=8;St.embedHorizontalSeparationPattern(0,d-1,o),St.embedHorizontalSeparationPattern(o.getWidth()-d,d-1,o),St.embedHorizontalSeparationPattern(0,o.getWidth()-d,o);const m=7;St.embedVerticalSeparationPattern(m,0,o),St.embedVerticalSeparationPattern(o.getHeight()-m-1,0,o),St.embedVerticalSeparationPattern(m,o.getHeight()-m,o)}static maybeEmbedPositionAdjustmentPatterns(o,u){if(o.getVersionNumber()<2)return;const d=o.getVersionNumber()-1,m=St.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[d];for(let x=0,w=m.length;x!==w;x++){const E=m[x];if(E>=0)for(let N=0;N!==w;N++){const O=m[N];O>=0&&St.isEmpty(u.get(O,E))&&St.embedPositionAdjustmentPattern(O-2,E-2,u)}}}}St.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),St.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),St.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),St.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),St.VERSION_INFO_POLY=7973,St.TYPE_INFO_POLY=1335,St.TYPE_INFO_MASK_PATTERN=21522;class b1{constructor(o,u){this.dataBytes=o,this.errorCorrectionBytes=u}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Mn{constructor(){}static calculateMaskPenalty(o){return Zn.applyMaskPenaltyRule1(o)+Zn.applyMaskPenaltyRule2(o)+Zn.applyMaskPenaltyRule3(o)+Zn.applyMaskPenaltyRule4(o)}static encode(o,u,d=null){let m=Mn.DEFAULT_BYTE_MODE_ENCODING;const x=d!==null&&d.get(fr.CHARACTER_SET)!==void 0;x&&(m=d.get(fr.CHARACTER_SET).toString());const w=this.chooseMode(o,m),E=new Z;if(w===bt.BYTE&&(x||Mn.DEFAULT_BYTE_MODE_ENCODING!==m)){const Ge=X.getCharacterSetECIByName(m);Ge!==void 0&&this.appendECI(Ge,E)}this.appendModeInfo(w,E);const N=new Z;this.appendBytes(o,w,N,m);let O;if(d!==null&&d.get(fr.QR_VERSION)!==void 0){const Ge=Number.parseInt(d.get(fr.QR_VERSION).toString(),10);O=ht.getVersionForNumber(Ge);const Ue=this.calculateBitsNeeded(w,E,N,O);if(!this.willFit(Ue,O,u))throw new wn("Data too big for requested version")}else O=this.recommendVersion(u,w,E,N);const I=new Z;I.appendBitArray(E);const P=w===bt.BYTE?N.getSizeInBytes():o.length;this.appendLengthInfo(P,O,w,I),I.appendBitArray(N);const F=O.getECBlocksForLevel(u),q=O.getTotalCodewords()-F.getTotalECCodewords();this.terminateBits(q,I);const re=this.interleaveWithECBytes(I,O.getTotalCodewords(),q,F.getNumBlocks()),ae=new Xi;ae.setECLevel(u),ae.setMode(w),ae.setVersion(O);const be=O.getDimensionForVersion(),Ne=new Ql(be,be),$e=this.chooseMaskPattern(re,u,O,Ne);return ae.setMaskPattern($e),St.buildMatrix(re,u,O,$e,Ne),ae.setMatrix(Ne),ae}static recommendVersion(o,u,d,m){const x=this.calculateBitsNeeded(u,d,m,ht.getVersionForNumber(1)),w=this.chooseVersion(x,o),E=this.calculateBitsNeeded(u,d,m,w);return this.chooseVersion(E,o)}static calculateBitsNeeded(o,u,d,m){return u.getSize()+o.getCharacterCountBits(m)+d.getSize()}static getAlphanumericCode(o){return o<Mn.ALPHANUMERIC_TABLE.length?Mn.ALPHANUMERIC_TABLE[o]:-1}static chooseMode(o,u=null){if(X.SJIS.getName()===u&&this.isOnlyDoubleByteKanji(o))return bt.KANJI;let d=!1,m=!1;for(let x=0,w=o.length;x<w;++x){const E=o.charAt(x);if(Mn.isDigit(E))d=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)m=!0;else return bt.BYTE}return m?bt.ALPHANUMERIC:d?bt.NUMERIC:bt.BYTE}static isOnlyDoubleByteKanji(o){let u;try{u=je.encode(o,X.SJIS)}catch{return!1}const d=u.length;if(d%2!==0)return!1;for(let m=0;m<d;m+=2){const x=u[m]&255;if((x<129||x>159)&&(x<224||x>235))return!1}return!0}static chooseMaskPattern(o,u,d,m){let x=Number.MAX_SAFE_INTEGER,w=-1;for(let E=0;E<Xi.NUM_MASK_PATTERNS;E++){St.buildMatrix(o,u,d,E,m);let N=this.calculateMaskPenalty(m);N<x&&(x=N,w=E)}return w}static chooseVersion(o,u){for(let d=1;d<=40;d++){const m=ht.getVersionForNumber(d);if(Mn.willFit(o,m,u))return m}throw new wn("Data too big")}static willFit(o,u,d){const m=u.getTotalCodewords(),w=u.getECBlocksForLevel(d).getTotalECCodewords(),E=m-w,N=(o+7)/8;return E>=N}static terminateBits(o,u){const d=o*8;if(u.getSize()>d)throw new wn("data bits cannot fit in the QR Code"+u.getSize()+" > "+d);for(let w=0;w<4&&u.getSize()<d;++w)u.appendBit(!1);const m=u.getSize()&7;if(m>0)for(let w=m;w<8;w++)u.appendBit(!1);const x=o-u.getSizeInBytes();for(let w=0;w<x;++w)u.appendBits((w&1)===0?236:17,8);if(u.getSize()!==d)throw new wn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(o,u,d,m,x,w){if(m>=d)throw new wn("Block ID too large");const E=o%d,N=d-E,O=Math.floor(o/d),I=O+1,P=Math.floor(u/d),F=P+1,q=O-P,re=I-F;if(q!==re)throw new wn("EC bytes mismatch");if(d!==N+E)throw new wn("RS blocks mismatch");if(o!==(P+q)*N+(F+re)*E)throw new wn("Total bytes mismatch");m<N?(x[0]=P,w[0]=q):(x[0]=F,w[0]=re)}static interleaveWithECBytes(o,u,d,m){if(o.getSizeInBytes()!==d)throw new wn("Number of bits and data bytes does not match");let x=0,w=0,E=0;const N=new Array;for(let I=0;I<m;++I){const P=new Int32Array(1),F=new Int32Array(1);Mn.getNumDataBytesAndNumECBytesForBlockID(u,d,m,I,P,F);const q=P[0],re=new Uint8Array(q);o.toBytes(8*x,re,0,q);const ae=Mn.generateECBytes(re,F[0]);N.push(new b1(re,ae)),w=Math.max(w,q),E=Math.max(E,ae.length),x+=P[0]}if(d!==x)throw new wn("Data bytes does not match offset");const O=new Z;for(let I=0;I<w;++I)for(const P of N){const F=P.getDataBytes();I<F.length&&O.appendBits(F[I],8)}for(let I=0;I<E;++I)for(const P of N){const F=P.getErrorCorrectionBytes();I<F.length&&O.appendBits(F[I],8)}if(u!==O.getSizeInBytes())throw new wn("Interleaving error: "+u+" and "+O.getSizeInBytes()+" differ.");return O}static generateECBytes(o,u){const d=o.length,m=new Int32Array(d+u);for(let w=0;w<d;w++)m[w]=o[w]&255;new Zo(ot.QR_CODE_FIELD_256).encode(m,u);const x=new Uint8Array(u);for(let w=0;w<u;w++)x[w]=m[d+w];return x}static appendModeInfo(o,u){u.appendBits(o.getBits(),4)}static appendLengthInfo(o,u,d,m){const x=d.getCharacterCountBits(u);if(o>=1<<x)throw new wn(o+" is bigger than "+((1<<x)-1));m.appendBits(o,x)}static appendBytes(o,u,d,m){switch(u){case bt.NUMERIC:Mn.appendNumericBytes(o,d);break;case bt.ALPHANUMERIC:Mn.appendAlphanumericBytes(o,d);break;case bt.BYTE:Mn.append8BitBytes(o,d,m);break;case bt.KANJI:Mn.appendKanjiBytes(o,d);break;default:throw new wn("Invalid mode: "+u)}}static getDigit(o){return o.charCodeAt(0)-48}static isDigit(o){const u=Mn.getDigit(o);return u>=0&&u<=9}static appendNumericBytes(o,u){const d=o.length;let m=0;for(;m<d;){const x=Mn.getDigit(o.charAt(m));if(m+2<d){const w=Mn.getDigit(o.charAt(m+1)),E=Mn.getDigit(o.charAt(m+2));u.appendBits(x*100+w*10+E,10),m+=3}else if(m+1<d){const w=Mn.getDigit(o.charAt(m+1));u.appendBits(x*10+w,7),m+=2}else u.appendBits(x,4),m++}}static appendAlphanumericBytes(o,u){const d=o.length;let m=0;for(;m<d;){const x=Mn.getAlphanumericCode(o.charCodeAt(m));if(x===-1)throw new wn;if(m+1<d){const w=Mn.getAlphanumericCode(o.charCodeAt(m+1));if(w===-1)throw new wn;u.appendBits(x*45+w,11),m+=2}else u.appendBits(x,6),m++}}static append8BitBytes(o,u,d){let m;try{m=je.encode(o,d)}catch(x){throw new wn(x)}for(let x=0,w=m.length;x!==w;x++){const E=m[x];u.appendBits(E,8)}}static appendKanjiBytes(o,u){let d;try{d=je.encode(o,X.SJIS)}catch(x){throw new wn(x)}const m=d.length;for(let x=0;x<m;x+=2){const w=d[x]&255,E=d[x+1]&255,N=w<<8&4294967295|E;let O=-1;if(N>=33088&&N<=40956?O=N-33088:N>=57408&&N<=60351&&(O=N-49472),O===-1)throw new wn("Invalid byte sequence");const I=(O>>8)*192+(O&255);u.appendBits(I,13)}}static appendECI(o,u){u.appendBits(bt.ECI.getBits(),4),u.appendBits(o.getValue(),8)}}Mn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Mn.DEFAULT_BYTE_MODE_ENCODING=X.UTF8.getName();class Yi{write(o,u,d,m=null){if(o.length===0)throw new v("Found empty contents");if(u<0||d<0)throw new v("Requested dimensions are too small: "+u+"x"+d);let x=kt.L,w=Yi.QUIET_ZONE_SIZE;m!==null&&(m.get(fr.ERROR_CORRECTION)!==void 0&&(x=kt.fromString(m.get(fr.ERROR_CORRECTION).toString())),m.get(fr.MARGIN)!==void 0&&(w=Number.parseInt(m.get(fr.MARGIN).toString(),10)));const E=Mn.encode(o,x,m);return this.renderResult(E,u,d,w)}writeToDom(o,u,d,m,x=null){typeof o=="string"&&(o=document.querySelector(o));const w=this.write(u,d,m,x);o&&o.appendChild(w)}renderResult(o,u,d,m){const x=o.getMatrix();if(x===null)throw new jt;const w=x.getWidth(),E=x.getHeight(),N=w+m*2,O=E+m*2,I=Math.max(u,N),P=Math.max(d,O),F=Math.min(Math.floor(I/N),Math.floor(P/O)),q=Math.floor((I-w*F)/2),re=Math.floor((P-E*F)/2),ae=this.createSVGElement(I,P);for(let be=0,Ne=re;be<E;be++,Ne+=F)for(let $e=0,Ge=q;$e<w;$e++,Ge+=F)if(x.get($e,be)===1){const Ue=this.createSvgRectElement(Ge,Ne,F,F);ae.appendChild(Ue)}return ae}createSVGElement(o,u){const d=document.createElementNS(Yi.SVG_NS,"svg");return d.setAttributeNS(null,"height",o.toString()),d.setAttributeNS(null,"width",u.toString()),d}createSvgRectElement(o,u,d,m){const x=document.createElementNS(Yi.SVG_NS,"rect");return x.setAttributeNS(null,"x",o.toString()),x.setAttributeNS(null,"y",u.toString()),x.setAttributeNS(null,"height",d.toString()),x.setAttributeNS(null,"width",m.toString()),x.setAttributeNS(null,"fill","#000000"),x}}Yi.QUIET_ZONE_SIZE=4,Yi.SVG_NS="http://www.w3.org/2000/svg";class Ua{encode(o,u,d,m,x){if(o.length===0)throw new v("Found empty contents");if(u!==se.QR_CODE)throw new v("Can only encode QR_CODE, but got "+u);if(d<0||m<0)throw new v(`Requested dimensions are too small: ${d}x${m}`);let w=kt.L,E=Ua.QUIET_ZONE_SIZE;x!==null&&(x.get(fr.ERROR_CORRECTION)!==void 0&&(w=kt.fromString(x.get(fr.ERROR_CORRECTION).toString())),x.get(fr.MARGIN)!==void 0&&(E=Number.parseInt(x.get(fr.MARGIN).toString(),10)));const N=Mn.encode(o,w,x);return Ua.renderResult(N,d,m,E)}static renderResult(o,u,d,m){const x=o.getMatrix();if(x===null)throw new jt;const w=x.getWidth(),E=x.getHeight(),N=w+m*2,O=E+m*2,I=Math.max(u,N),P=Math.max(d,O),F=Math.min(Math.floor(I/N),Math.floor(P/O)),q=Math.floor((I-w*F)/2),re=Math.floor((P-E*F)/2),ae=new Ze(I,P);for(let be=0,Ne=re;be<E;be++,Ne+=F)for(let $e=0,Ge=q;$e<w;$e++,Ge+=F)x.get($e,be)===1&&ae.setRegion(Ge,Ne,F,F);return ae}}Ua.QUIET_ZONE_SIZE=4;class y1{encode(o,u,d,m,x){let w;switch(u){case se.QR_CODE:w=new Ua;break;default:throw new v("No encoder available for format "+u)}return w.encode(o,u,d,m,x)}}class Ws extends me{constructor(o,u,d,m,x,w,E,N){if(super(w,E),this.yuvData=o,this.dataWidth=u,this.dataHeight=d,this.left=m,this.top=x,m+w>u||x+E>d)throw new v("Crop rectangle does not fit within image data.");N&&this.reverseHorizontal(w,E)}getRow(o,u){if(o<0||o>=this.getHeight())throw new v("Requested row is outside the image: "+o);const d=this.getWidth();(u==null||u.length<d)&&(u=new Uint8ClampedArray(d));const m=(o+this.top)*this.dataWidth+this.left;return M.arraycopy(this.yuvData,m,u,0,d),u}getMatrix(){const o=this.getWidth(),u=this.getHeight();if(o===this.dataWidth&&u===this.dataHeight)return this.yuvData;const d=o*u,m=new Uint8ClampedArray(d);let x=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return M.arraycopy(this.yuvData,x,m,0,d),m;for(let w=0;w<u;w++){const E=w*o;M.arraycopy(this.yuvData,x,m,E,o),x+=this.dataWidth}return m}isCropSupported(){return!0}crop(o,u,d,m){return new Ws(this.yuvData,this.dataWidth,this.dataHeight,this.left+o,this.top+u,d,m,!1)}renderThumbnail(){const o=this.getWidth()/Ws.THUMBNAIL_SCALE_FACTOR,u=this.getHeight()/Ws.THUMBNAIL_SCALE_FACTOR,d=new Int32Array(o*u),m=this.yuvData;let x=this.top*this.dataWidth+this.left;for(let w=0;w<u;w++){const E=w*o;for(let N=0;N<o;N++){const O=m[x+N*Ws.THUMBNAIL_SCALE_FACTOR]&255;d[E+N]=4278190080|O*65793}x+=this.dataWidth*Ws.THUMBNAIL_SCALE_FACTOR}return d}getThumbnailWidth(){return this.getWidth()/Ws.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ws.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(o,u){const d=this.yuvData;for(let m=0,x=this.top*this.dataWidth+this.left;m<u;m++,x+=this.dataWidth){const w=x+o/2;for(let E=x,N=x+o-1;E<w;E++,N--){const O=d[E];d[E]=d[N],d[N]=O}}}invert(){return new Y(this)}}Ws.THUMBNAIL_SCALE_FACTOR=2;class Eu extends me{constructor(o,u,d,m,x,w,E){if(super(u,d),this.dataWidth=m,this.dataHeight=x,this.left=w,this.top=E,o.BYTES_PER_ELEMENT===4){const N=u*d,O=new Uint8ClampedArray(N);for(let I=0;I<N;I++){const P=o[I],F=P>>16&255,q=P>>7&510,re=P&255;O[I]=(F+q+re)/4&255}this.luminances=O}else this.luminances=o;if(m===void 0&&(this.dataWidth=u),x===void 0&&(this.dataHeight=d),w===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+u>this.dataWidth||this.top+d>this.dataHeight)throw new v("Crop rectangle does not fit within image data.")}getRow(o,u){if(o<0||o>=this.getHeight())throw new v("Requested row is outside the image: "+o);const d=this.getWidth();(u==null||u.length<d)&&(u=new Uint8ClampedArray(d));const m=(o+this.top)*this.dataWidth+this.left;return M.arraycopy(this.luminances,m,u,0,d),u}getMatrix(){const o=this.getWidth(),u=this.getHeight();if(o===this.dataWidth&&u===this.dataHeight)return this.luminances;const d=o*u,m=new Uint8ClampedArray(d);let x=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return M.arraycopy(this.luminances,x,m,0,d),m;for(let w=0;w<u;w++){const E=w*o;M.arraycopy(this.luminances,x,m,E,o),x+=this.dataWidth}return m}isCropSupported(){return!0}crop(o,u,d,m){return new Eu(this.luminances,d,m,this.dataWidth,this.dataHeight,this.left+o,this.top+u)}invert(){return new Y(this)}}class Tf extends X{static forName(o){return this.getCharacterSetECIByName(o)}}class Jo{}Jo.ISO_8859_1=X.ISO8859_1;class Ha{isCompact(){return this.compact}setCompact(o){this.compact=o}getSize(){return this.size}setSize(o){this.size=o}getLayers(){return this.layers}setLayers(o){this.layers=o}getCodeWords(){return this.codeWords}setCodeWords(o){this.codeWords=o}getMatrix(){return this.matrix}setMatrix(o){this.matrix=o}}class Of{static singletonList(o){return[o]}static min(o,u){return o.sort(u)[0]}}class _f{constructor(o){this.previous=o}getPrevious(){return this.previous}}class Ki extends _f{constructor(o,u,d){super(o),this.value=u,this.bitCount=d}appendTo(o,u){o.appendBits(this.value,this.bitCount)}add(o,u){return new Ki(this,o,u)}addBinaryShift(o,u){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Ki(this,o,u)}toString(){let o=this.value&(1<<this.bitCount)-1;return o|=1<<this.bitCount,"<"+G.toBinaryString(o|1<<this.bitCount).substring(1)+">"}}class ec extends Ki{constructor(o,u,d){super(o,0,0),this.binaryShiftStart=u,this.binaryShiftByteCount=d}appendTo(o,u){for(let d=0;d<this.binaryShiftByteCount;d++)(d===0||d===31&&this.binaryShiftByteCount<=62)&&(o.appendBits(31,5),this.binaryShiftByteCount>62?o.appendBits(this.binaryShiftByteCount-31,16):d===0?o.appendBits(Math.min(this.binaryShiftByteCount,31),5):o.appendBits(this.binaryShiftByteCount-31,5)),o.appendBits(u[this.binaryShiftStart+d],8)}addBinaryShift(o,u){return new ec(this,o,u)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Rf(B,o,u){return new ec(B,o,u)}function Va(B,o,u){return new Ki(B,o,u)}const Ga=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ri=0,tc=1,ys=2,Su=3,Ms=4,Qo=new Ki(null,0,0),Zi=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function w1(B){for(let o of B)H.fill(o,-1);return B[Ri][Ms]=0,B[tc][Ms]=0,B[tc][Ri]=28,B[Su][Ms]=0,B[ys][Ms]=0,B[ys][Ri]=15,B}const el=w1(H.createInt32Array(6,6));class Is{constructor(o,u,d,m){this.token=o,this.mode=u,this.binaryShiftByteCount=d,this.bitCount=m}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(o,u){let d=this.bitCount,m=this.token;if(o!==this.mode){let w=Zi[this.mode][o];m=Va(m,w&65535,w>>16),d+=w>>16}let x=o===ys?4:5;return m=Va(m,u,x),new Is(m,o,0,d+x)}shiftAndAppend(o,u){let d=this.token,m=this.mode===ys?4:5;return d=Va(d,el[this.mode][o],m),d=Va(d,u,5),new Is(d,this.mode,0,this.bitCount+m+5)}addBinaryShiftChar(o){let u=this.token,d=this.mode,m=this.bitCount;if(this.mode===Ms||this.mode===ys){let E=Zi[d][Ri];u=Va(u,E&65535,E>>16),m+=E>>16,d=Ri}let x=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,w=new Is(u,d,this.binaryShiftByteCount+1,m+x);return w.binaryShiftByteCount===2078&&(w=w.endBinaryShift(o+1)),w}endBinaryShift(o){if(this.binaryShiftByteCount===0)return this;let u=this.token;return u=Rf(u,o-this.binaryShiftByteCount,this.binaryShiftByteCount),new Is(u,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(o){let u=this.bitCount+(Zi[this.mode][o.mode]>>16);return this.binaryShiftByteCount<o.binaryShiftByteCount?u+=Is.calculateBinaryShiftCost(o)-Is.calculateBinaryShiftCost(this):this.binaryShiftByteCount>o.binaryShiftByteCount&&o.binaryShiftByteCount>0&&(u+=10),u<=o.bitCount}toBitArray(o){let u=[];for(let m=this.endBinaryShift(o.length).token;m!==null;m=m.getPrevious())u.unshift(m);let d=new Z;for(const m of u)m.appendTo(d,o);return d}toString(){return ue.format("%s bits=%d bytes=%d",Ga[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(o){return o.binaryShiftByteCount>62?21:o.binaryShiftByteCount>31?20:o.binaryShiftByteCount>0?10:0}}Is.INITIAL_STATE=new Is(Qo,Ri,0,0);function Mf(B){const o=ue.getCharCode(" "),u=ue.getCharCode("."),d=ue.getCharCode(",");B[Ri][o]=1;const m=ue.getCharCode("Z"),x=ue.getCharCode("A");for(let F=x;F<=m;F++)B[Ri][F]=F-x+2;B[tc][o]=1;const w=ue.getCharCode("z"),E=ue.getCharCode("a");for(let F=E;F<=w;F++)B[tc][F]=F-E+2;B[ys][o]=1;const N=ue.getCharCode("9"),O=ue.getCharCode("0");for(let F=O;F<=N;F++)B[ys][F]=F-O+2;B[ys][d]=12,B[ys][u]=13;const I=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let F=0;F<I.length;F++)B[Su][ue.getCharCode(I[F])]=F;const P=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let F=0;F<P.length;F++)ue.getCharCode(P[F])>0&&(B[Ms][ue.getCharCode(P[F])]=F);return B}const tl=Mf(H.createInt32Array(5,256));class Ji{constructor(o){this.text=o}encode(){const o=ue.getCharCode(" "),u=ue.getCharCode(`
`);let d=Of.singletonList(Is.INITIAL_STATE);for(let x=0;x<this.text.length;x++){let w,E=x+1<this.text.length?this.text[x+1]:0;switch(this.text[x]){case ue.getCharCode("\r"):w=E===u?2:0;break;case ue.getCharCode("."):w=E===o?3:0;break;case ue.getCharCode(","):w=E===o?4:0;break;case ue.getCharCode(":"):w=E===o?5:0;break;default:w=0}w>0?(d=Ji.updateStateListForPair(d,x,w),x++):d=this.updateStateListForChar(d,x)}return Of.min(d,(x,w)=>x.getBitCount()-w.getBitCount()).toBitArray(this.text)}updateStateListForChar(o,u){const d=[];for(let m of o)this.updateStateForChar(m,u,d);return Ji.simplifyStates(d)}updateStateForChar(o,u,d){let m=this.text[u]&255,x=tl[o.getMode()][m]>0,w=null;for(let E=0;E<=Ms;E++){let N=tl[E][m];if(N>0){if(w==null&&(w=o.endBinaryShift(u)),!x||E===o.getMode()||E===ys){const O=w.latchAndAppend(E,N);d.push(O)}if(!x&&el[o.getMode()][E]>=0){const O=w.shiftAndAppend(E,N);d.push(O)}}}if(o.getBinaryShiftByteCount()>0||tl[o.getMode()][m]===0){let E=o.addBinaryShiftChar(u);d.push(E)}}static updateStateListForPair(o,u,d){const m=[];for(let x of o)this.updateStateForPair(x,u,d,m);return this.simplifyStates(m)}static updateStateForPair(o,u,d,m){let x=o.endBinaryShift(u);if(m.push(x.latchAndAppend(Ms,d)),o.getMode()!==Ms&&m.push(x.shiftAndAppend(Ms,d)),d===3||d===4){let w=x.latchAndAppend(ys,16-d).latchAndAppend(ys,1);m.push(w)}if(o.getBinaryShiftByteCount()>0){let w=o.addBinaryShiftChar(u).addBinaryShiftChar(u+1);m.push(w)}}static simplifyStates(o){let u=[];for(const d of o){let m=!0;for(const x of u){if(x.isBetterThanOrEqualTo(d)){m=!1;break}d.isBetterThanOrEqualTo(x)&&(u=u.filter(w=>w!==x))}m&&u.push(d)}return u}}class tn{constructor(){}static encodeBytes(o){return tn.encode(o,tn.DEFAULT_EC_PERCENT,tn.DEFAULT_AZTEC_LAYERS)}static encode(o,u,d){let m=new Ji(o).encode(),x=G.truncDivision(m.getSize()*u,100)+11,w=m.getSize()+x,E,N,O,I,P;if(d!==tn.DEFAULT_AZTEC_LAYERS){if(E=d<0,N=Math.abs(d),N>(E?tn.MAX_NB_BITS_COMPACT:tn.MAX_NB_BITS))throw new v(ue.format("Illegal value %s for layers",d));O=tn.totalBitsInLayer(N,E),I=tn.WORD_SIZE[N];let Ue=O-O%I;if(P=tn.stuffBits(m,I),P.getSize()+x>Ue)throw new v("Data to large for user specified layer");if(E&&P.getSize()>I*64)throw new v("Data to large for user specified layer")}else{I=0,P=null;for(let Ue=0;;Ue++){if(Ue>tn.MAX_NB_BITS)throw new v("Data too large for an Aztec code");if(E=Ue<=3,N=E?Ue+1:Ue,O=tn.totalBitsInLayer(N,E),w>O)continue;(P==null||I!==tn.WORD_SIZE[N])&&(I=tn.WORD_SIZE[N],P=tn.stuffBits(m,I));let Ht=O-O%I;if(!(E&&P.getSize()>I*64)&&P.getSize()+x<=Ht)break}}let F=tn.generateCheckWords(P,O,I),q=P.getSize()/I,re=tn.generateModeMessage(E,N,q),ae=(E?11:14)+N*4,be=new Int32Array(ae),Ne;if(E){Ne=ae;for(let Ue=0;Ue<be.length;Ue++)be[Ue]=Ue}else{Ne=ae+1+2*G.truncDivision(G.truncDivision(ae,2)-1,15);let Ue=G.truncDivision(ae,2),Ht=G.truncDivision(Ne,2);for(let Lt=0;Lt<Ue;Lt++){let rr=Lt+G.truncDivision(Lt,15);be[Ue-Lt-1]=Ht-rr-1,be[Ue+Lt]=Ht+rr+1}}let $e=new Ze(Ne);for(let Ue=0,Ht=0;Ue<N;Ue++){let Lt=(N-Ue)*4+(E?9:12);for(let rr=0;rr<Lt;rr++){let ws=rr*2;for(let Ur=0;Ur<2;Ur++)F.get(Ht+ws+Ur)&&$e.set(be[Ue*2+Ur],be[Ue*2+rr]),F.get(Ht+Lt*2+ws+Ur)&&$e.set(be[Ue*2+rr],be[ae-1-Ue*2-Ur]),F.get(Ht+Lt*4+ws+Ur)&&$e.set(be[ae-1-Ue*2-Ur],be[ae-1-Ue*2-rr]),F.get(Ht+Lt*6+ws+Ur)&&$e.set(be[ae-1-Ue*2-rr],be[Ue*2+Ur])}Ht+=Lt*8}if(tn.drawModeMessage($e,E,Ne,re),E)tn.drawBullsEye($e,G.truncDivision(Ne,2),5);else{tn.drawBullsEye($e,G.truncDivision(Ne,2),7);for(let Ue=0,Ht=0;Ue<G.truncDivision(ae,2)-1;Ue+=15,Ht+=16)for(let Lt=G.truncDivision(Ne,2)&1;Lt<Ne;Lt+=2)$e.set(G.truncDivision(Ne,2)-Ht,Lt),$e.set(G.truncDivision(Ne,2)+Ht,Lt),$e.set(Lt,G.truncDivision(Ne,2)-Ht),$e.set(Lt,G.truncDivision(Ne,2)+Ht)}let Ge=new Ha;return Ge.setCompact(E),Ge.setSize(Ne),Ge.setLayers(N),Ge.setCodeWords(q),Ge.setMatrix($e),Ge}static drawBullsEye(o,u,d){for(let m=0;m<d;m+=2)for(let x=u-m;x<=u+m;x++)o.set(x,u-m),o.set(x,u+m),o.set(u-m,x),o.set(u+m,x);o.set(u-d,u-d),o.set(u-d+1,u-d),o.set(u-d,u-d+1),o.set(u+d,u-d),o.set(u+d,u-d+1),o.set(u+d,u+d-1)}static generateModeMessage(o,u,d){let m=new Z;return o?(m.appendBits(u-1,2),m.appendBits(d-1,6),m=tn.generateCheckWords(m,28,4)):(m.appendBits(u-1,5),m.appendBits(d-1,11),m=tn.generateCheckWords(m,40,4)),m}static drawModeMessage(o,u,d,m){let x=G.truncDivision(d,2);if(u)for(let w=0;w<7;w++){let E=x-3+w;m.get(w)&&o.set(E,x-5),m.get(w+7)&&o.set(x+5,E),m.get(20-w)&&o.set(E,x+5),m.get(27-w)&&o.set(x-5,E)}else for(let w=0;w<10;w++){let E=x-5+w+G.truncDivision(w,5);m.get(w)&&o.set(E,x-7),m.get(w+10)&&o.set(x+7,E),m.get(29-w)&&o.set(E,x+7),m.get(39-w)&&o.set(x-7,E)}}static generateCheckWords(o,u,d){let m=o.getSize()/d,x=new Zo(tn.getGF(d)),w=G.truncDivision(u,d),E=tn.bitsToWords(o,d,w);x.encode(E,w-m);let N=u%d,O=new Z;O.appendBits(0,N);for(const I of Array.from(E))O.appendBits(I,d);return O}static bitsToWords(o,u,d){let m=new Int32Array(d),x,w;for(x=0,w=o.getSize()/u;x<w;x++){let E=0;for(let N=0;N<u;N++)E|=o.get(x*u+N)?1<<u-N-1:0;m[x]=E}return m}static getGF(o){switch(o){case 4:return ot.AZTEC_PARAM;case 6:return ot.AZTEC_DATA_6;case 8:return ot.AZTEC_DATA_8;case 10:return ot.AZTEC_DATA_10;case 12:return ot.AZTEC_DATA_12;default:throw new v("Unsupported word size "+o)}}static stuffBits(o,u){let d=new Z,m=o.getSize(),x=(1<<u)-2;for(let w=0;w<m;w+=u){let E=0;for(let N=0;N<u;N++)(w+N>=m||o.get(w+N))&&(E|=1<<u-1-N);(E&x)===x?(d.appendBits(E&x,u),w--):(E&x)===0?(d.appendBits(E|1,u),w--):d.appendBits(E,u)}return d}static totalBitsInLayer(o,u){return((u?88:112)+16*o)*o}}tn.DEFAULT_EC_PERCENT=33,tn.DEFAULT_AZTEC_LAYERS=0,tn.MAX_NB_BITS=32,tn.MAX_NB_BITS_COMPACT=4,tn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class nl{encode(o,u,d,m){return this.encodeWithHints(o,u,d,m,null)}encodeWithHints(o,u,d,m,x){let w=Jo.ISO_8859_1,E=tn.DEFAULT_EC_PERCENT,N=tn.DEFAULT_AZTEC_LAYERS;return x!=null&&(x.has(fr.CHARACTER_SET)&&(w=Tf.forName(x.get(fr.CHARACTER_SET).toString())),x.has(fr.ERROR_CORRECTION)&&(E=G.parseInt(x.get(fr.ERROR_CORRECTION).toString())),x.has(fr.AZTEC_LAYERS)&&(N=G.parseInt(x.get(fr.AZTEC_LAYERS).toString()))),nl.encodeLayers(o,u,d,m,w,E,N)}static encodeLayers(o,u,d,m,x,w,E){if(u!==se.AZTEC)throw new v("Can only encode AZTEC, but got "+u);let N=tn.encode(ue.getBytes(o,x),w,E);return nl.renderResult(N,d,m)}static renderResult(o,u,d){let m=o.getMatrix();if(m==null)throw new jt;let x=m.getWidth(),w=m.getHeight(),E=Math.max(u,x),N=Math.max(d,w),O=Math.min(E/x,N/w),I=(E-x*O)/2,P=(N-w*O)/2,F=new Ze(E,N);for(let q=0,re=P;q<w;q++,re+=O)for(let ae=0,be=I;ae<x;ae++,be+=O)m.get(ae,q)&&F.setRegion(be,re,O,O);return F}}n.AbstractExpandedDecoder=qt,n.ArgumentException=C,n.ArithmeticException=rt,n.AztecCode=Ha,n.AztecCodeReader=nr,n.AztecCodeWriter=nl,n.AztecDecoder=ft,n.AztecDetector=is,n.AztecDetectorResult=Lr,n.AztecEncoder=tn,n.AztecHighLevelEncoder=Ji,n.AztecPoint=xn,n.BarcodeFormat=se,n.Binarizer=_,n.BinaryBitmap=A,n.BitArray=Z,n.BitMatrix=Ze,n.BitSource=ye,n.BrowserAztecCodeReader=ms,n.BrowserBarcodeReader=Xo,n.BrowserCodeReader=fe,n.BrowserDatamatrixCodeReader=zn,n.BrowserMultiFormatReader=kf,n.BrowserPDF417Reader=g1,n.BrowserQRCodeReader=x1,n.BrowserQRCodeSvgWriter=Yi,n.CharacterSetECI=X,n.ChecksumException=T,n.Code128Reader=He,n.Code39Reader=Zt,n.DataMatrixDecodedBitStreamParser=Ye,n.DataMatrixReader=en,n.DecodeHintType=oe,n.DecoderResult=Ce,n.DefaultGridSampler=jr,n.DetectorResult=Xn,n.EAN13Reader=Gt,n.EncodeHintType=fr,n.Exception=g,n.FormatException=U,n.GenericGF=ot,n.GenericGFPoly=ze,n.GlobalHistogramBinarizer=ie,n.GridSampler=_s,n.GridSamplerInstance=On,n.HTMLCanvasElementLuminanceSource=le,n.HybridBinarizer=pe,n.ITFReader=At,n.IllegalArgumentException=v,n.IllegalStateException=jt,n.InvertedLuminanceSource=Y,n.LuminanceSource=me,n.MathUtils=Ve,n.MultiFormatOneDReader=Jr,n.MultiFormatReader=Nf,n.MultiFormatWriter=y1,n.NotFoundException=ne,n.OneDReader=ln,n.PDF417DecodedBitStreamParser=ke,n.PDF417DecoderErrorCorrection=ci,n.PDF417Reader=Sr,n.PDF417ResultMetadata=za,n.PerspectiveTransform=tr,n.PlanarYUVLuminanceSource=Ws,n.QRCodeByteMatrix=Ql,n.QRCodeDataMask=as,n.QRCodeDecodedBitStreamParser=_n,n.QRCodeDecoderErrorCorrectionLevel=kt,n.QRCodeDecoderFormatInformation=yn,n.QRCodeEncoder=Mn,n.QRCodeEncoderQRCode=Xi,n.QRCodeMaskUtil=Zn,n.QRCodeMatrixUtil=St,n.QRCodeMode=bt,n.QRCodeReader=li,n.QRCodeVersion=ht,n.QRCodeWriter=Ua,n.RGBLuminanceSource=Eu,n.RSS14Reader=sn,n.RSSExpandedReader=Re,n.ReaderException=Jl,n.ReedSolomonDecoder=Pt,n.ReedSolomonEncoder=Zo,n.ReedSolomonException=gt,n.Result=ge,n.ResultMetadataType=K,n.ResultPoint=tt,n.StringUtils=ue,n.UnsupportedOperationException=Qe,n.VideoInputDevice=V,n.WhiteRectangleDetector=on,n.WriterException=wn,n.ZXingArrays=H,n.ZXingCharset=Tf,n.ZXingInteger=G,n.ZXingStandardCharsets=Jo,n.ZXingStringBuilder=Ie,n.ZXingStringEncoding=je,n.ZXingSystem=M,n.createAbstractExpandedDecoder=Ni,Object.defineProperty(n,"__esModule",{value:!0})}))})(gd,gd.exports)),gd.exports}var Qn=xU();const bU=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var KS=(function(){function t(e,n,r){if(this.formatMap=new Map([[at.QR_CODE,Qn.BarcodeFormat.QR_CODE],[at.AZTEC,Qn.BarcodeFormat.AZTEC],[at.CODABAR,Qn.BarcodeFormat.CODABAR],[at.CODE_39,Qn.BarcodeFormat.CODE_39],[at.CODE_93,Qn.BarcodeFormat.CODE_93],[at.CODE_128,Qn.BarcodeFormat.CODE_128],[at.DATA_MATRIX,Qn.BarcodeFormat.DATA_MATRIX],[at.MAXICODE,Qn.BarcodeFormat.MAXICODE],[at.ITF,Qn.BarcodeFormat.ITF],[at.EAN_13,Qn.BarcodeFormat.EAN_13],[at.EAN_8,Qn.BarcodeFormat.EAN_8],[at.PDF_417,Qn.BarcodeFormat.PDF_417],[at.RSS_14,Qn.BarcodeFormat.RSS_14],[at.RSS_EXPANDED,Qn.BarcodeFormat.RSS_EXPANDED],[at.UPC_A,Qn.BarcodeFormat.UPC_A],[at.UPC_E,Qn.BarcodeFormat.UPC_E],[at.UPC_EAN_EXTENSION,Qn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!bU)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=r;var s=this.createZXingFormats(e),i=new Map;i.set(Qn.DecodeHintType.POSSIBLE_FORMATS,s),i.set(Qn.DecodeHintType.TRY_HARDER,!1),this.hints=i}return t.prototype.decodeAsync=function(e){var n=this;return new Promise(function(r,s){try{r(n.decode(e))}catch(i){s(i)}})},t.prototype.decode=function(e){var n=new Qn.MultiFormatReader(this.verbose,this.hints),r=new Qn.HTMLCanvasElementLuminanceSource(e),s=new Qn.BinaryBitmap(new Qn.HybridBinarizer(r)),i=n.decode(s);return{text:i.text,format:wT.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,s){e.set(n,r)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var n=[],r=0,s=e;r<s.length;r++){var i=s[r];this.formatMap.has(i)?n.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t})(),yU=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function f(C){try{g(r.next(C))}catch(v){c(v)}}function p(C){try{g(r.throw(C))}catch(v){c(v)}}function g(C){C.done?i(C.value):s(C.value).then(f,p)}g((r=r.apply(t,e||[])).next())})},wU=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(C){return p([g,C])}}function p(g){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,g[0]&&(n=0)),n;)try{if(r=1,s&&(i=g[0]&2?s.return:g[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,g[1])).done)return i;switch(s=0,i&&(g=[g[0]&2,i.value]),g[0]){case 0:case 1:i=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,s=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){n.label=g[1];break}if(g[0]===6&&n.label<i[1]){n.label=i[1],i=g;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(g);break}i[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(C){g=[6,C],s=0}finally{r=i=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},ZS=(function(){function t(e,n,r){if(this.formatMap=new Map([[at.QR_CODE,"qr_code"],[at.AZTEC,"aztec"],[at.CODABAR,"codabar"],[at.CODE_39,"code_39"],[at.CODE_93,"code_93"],[at.CODE_128,"code_128"],[at.DATA_MATRIX,"data_matrix"],[at.ITF,"itf"],[at.EAN_13,"ean_13"],[at.EAN_8,"ean_8"],[at.PDF_417,"pdf417"],[at.UPC_A,"upc_a"],[at.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=r;var s=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return yU(this,void 0,void 0,function(){var n,r;return wU(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=s.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return r=this.selectLargestBarcode(n),[2,{text:r.rawValue,format:wT.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var n=null,r=0,s=0,i=e;s<i.length;s++){var c=i[s],f=c.boundingBox.width*c.boundingBox.height;f>r&&(r=f,n=c)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],r=0,s=e;r<s.length;r++){var i=s[r];this.formatMap.has(i)?n.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,s){e.set(n,r)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t})(),JS=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function f(C){try{g(r.next(C))}catch(v){c(v)}}function p(C){try{g(r.throw(C))}catch(v){c(v)}}function g(C){C.done?i(C.value):s(C.value).then(f,p)}g((r=r.apply(t,e||[])).next())})},QS=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(C){return p([g,C])}}function p(g){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,g[0]&&(n=0)),n;)try{if(r=1,s&&(i=g[0]&2?s.return:g[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,g[1])).done)return i;switch(s=0,i&&(g=[g[0]&2,i.value]),g[0]){case 0:case 1:i=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,s=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){n.label=g[1];break}if(g[0]===6&&n.label<i[1]){n.label=i[1],i=g;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(g);break}i[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(C){g=[6,C],s=0}finally{r=i=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},vU=(function(){function t(e,n,r,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,n&&ZS.isSupported()?(this.primaryDecoder=new ZS(e,r,s),this.secondaryDecoder=new KS(e,r,s)):this.primaryDecoder=new KS(e,r,s)}return t.prototype.decodeAsync=function(e){return JS(this,void 0,void 0,function(){var n;return QS(this,function(r){switch(r.label){case 0:n=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return JS(this,void 0,void 0,function(){var n,r;return QS(this,function(s){switch(s.label){case 0:n=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,s.sent()];case 3:if(r=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,r=this.executionResults;n<r.length;n++){var s=r[n];e+=s}var i=e/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t})(),zb=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Sp=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function f(C){try{g(r.next(C))}catch(v){c(v)}}function p(C){try{g(r.throw(C))}catch(v){c(v)}}function g(C){C.done?i(C.value):s(C.value).then(f,p)}g((r=r.apply(t,e||[])).next())})},Ap=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(C){return p([g,C])}}function p(g){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,g[0]&&(n=0)),n;)try{if(r=1,s&&(i=g[0]&2?s.return:g[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,g[1])).done)return i;switch(s=0,i&&(g=[g[0]&2,i.value]),g[0]){case 0:case 1:i=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,s=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){n.label=g[1];break}if(g[0]===6&&n.label<i[1]){n.label=i[1],i=g;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(g);break}i[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(C){g=[6,C],s=0}finally{r=i=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},CT=(function(){function t(e,n){this.name=e,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var n={};n[this.name]=e;var r={advanced:[n]};return this.track.applyConstraints(r)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},t})(),CU=(function(t){zb(e,t);function e(n,r){return t.call(this,n,r)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var r={};r[this.name]=n;var s={advanced:[r]};return this.track.applyConstraints(s)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),r=n[this.name];return{min:r.min,max:r.max,step:r.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(CT),EU=(function(t){zb(e,t);function e(n){return t.call(this,"zoom",n)||this}return e})(CU),SU=(function(t){zb(e,t);function e(n){return t.call(this,"torch",n)||this}return e})(CT),AU=(function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new EU(this.track)},t.prototype.torchFeature=function(){return new SU(this.track)},t})(),NU=(function(){function t(e,n,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var r=e.surface.clientWidth,s=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,s),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,n,r,s){return Sp(this,void 0,void 0,function(){var i,c;return Ap(this,function(f){switch(f.label){case 0:return i=new t(e,n,s),r.aspectRatio?(c={aspectRatio:r.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(c)]):[3,2];case 1:f.sent(),f.label=2;case 2:return i.setupSurface(),[2,i]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var n=this,r=function(){setTimeout(e,200),n.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return Sp(this,void 0,void 0,function(){return Ap(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,r){var s=e.mediaStream.getVideoTracks(),i=s.length,c=0;e.mediaStream.getVideoTracks().forEach(function(f){e.mediaStream.removeTrack(f),f.stop(),++c,c>=i&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},t.prototype.getCapabilities=function(){return new AU(this.getFirstTrackOrFail())},t})(),kU=(function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,n,r){return Sp(this,void 0,void 0,function(){return Ap(this,function(s){return[2,NU.create(e,this.mediaStream,n,r)]})})},t.create=function(e){return Sp(this,void 0,void 0,function(){var n,r;return Ap(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return r=s.sent(),[2,new t(r)]}})})},t})(),e3=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function f(C){try{g(r.next(C))}catch(v){c(v)}}function p(C){try{g(r.throw(C))}catch(v){c(v)}}function g(C){C.done?i(C.value):s(C.value).then(f,p)}g((r=r.apply(t,e||[])).next())})},t3=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(C){return p([g,C])}}function p(g){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,g[0]&&(n=0)),n;)try{if(r=1,s&&(i=g[0]&2?s.return:g[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,g[1])).done)return i;switch(s=0,i&&(g=[g[0]&2,i.value]),g[0]){case 0:case 1:i=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,s=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){n.label=g[1];break}if(g[0]===6&&n.label<i[1]){n.label=i[1],i=g;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(g);break}i[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(C){g=[6,C],s=0}finally{r=i=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},TU=(function(){function t(){}return t.failIfNotSupported=function(){return e3(this,void 0,void 0,function(){return t3(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return e3(this,void 0,void 0,function(){return t3(this,function(n){return[2,kU.create(e)]})})},t})(),OU=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(c){c(i)})}return new(n||(n=Promise))(function(i,c){function f(C){try{g(r.next(C))}catch(v){c(v)}}function p(C){try{g(r.throw(C))}catch(v){c(v)}}function g(C){C.done?i(C.value):s(C.value).then(f,p)}g((r=r.apply(t,e||[])).next())})},_U=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(C){return p([g,C])}}function p(g){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,g[0]&&(n=0)),n;)try{if(r=1,s&&(i=g[0]&2?s.return:g[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,g[1])).done)return i;switch(s=0,i&&(g=[g[0]&2,i.value]),g[0]){case 0:case 1:i=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,s=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){n.label=g[1];break}if(g[0]===6&&n.label<i[1]){n.label=i[1],i=g;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(g);break}i[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(C){g=[6,C],s=0}finally{r=i=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},RU=(function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Bc.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Bc.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return OU(this,void 0,void 0,function(){var e,n,r,s,i,c,f;return _U(this,function(p){switch(p.label){case 0:return e=function(g){for(var C=g.getVideoTracks(),v=0,A=C;v<A.length;v++){var T=A[v];T.enabled=!1,T.stop(),g.removeTrack(T)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=p.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=p.sent(),s=[],i=0,c=r;i<c.length;i++)f=c[i],f.kind==="videoinput"&&s.push({id:f.deviceId,label:f.label});return e(n),[2,s]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var r=function(i){for(var c=[],f=0,p=i;f<p.length;f++){var g=p[f];g.kind==="video"&&c.push({id:g.id,label:g.label})}e(c)},s=MediaStreamTrack;s.getSources(r)})},t})(),or;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(or||(or={}));var MU=(function(){function t(){this.state=or.NOT_STARTED,this.onGoingTransactionNewState=or.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===or.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=or.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===or.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=or.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==or.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case or.UNKNOWN:throw"Transition from unknown is not allowed";case or.NOT_STARTED:this.failIfNewStateIs(e,[or.PAUSED]);break;case or.SCANNING:break;case or.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,n){for(var r=0,s=n;r<s.length;r++){var i=s[r];if(e===i)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t})(),IU=(function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===or.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==or.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===or.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===or.PAUSED},t})(),DU=(function(){function t(){}return t.create=function(){return new IU(new MU)},t})(),LU=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),zs=(function(t){LU(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(hU),jU=(function(){function t(e,n){this.logger=n,this.fps=zs.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=zs.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?vT.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!wa(this.qrbox)},t.create=function(e,n){return new t(e,n)},t})(),BU=(function(){function t(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var r;typeof n=="boolean"?this.verbose=n===!0:n&&(r=n,this.verbose=r.verbose===!0,r.experimentalFeatures),this.logger=new mU(this.verbose),this.qrcode=new vU(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=DU.create()}return t.prototype.start=function(e,n,r,s){var i=this;if(!e)throw"cameraIdOrConfig is required";if(!r||typeof r!="function")throw"qrCodeSuccessCallback is required and should be a function.";var c;s?c=s:c=this.verbose?this.logger.log:function(){};var f=jU.create(n,this.logger);this.clearElement();var p=!1;f.videoConstraints&&(f.isMediaStreamConstraintsValid()?p=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var g=p,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:zs.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var v=this,A=this.stateManagerProxy.startTransition(or.SCANNING);return new Promise(function(T,_){var M=g?f.videoConstraints:v.createVideoConstraints(e);if(!M){A.cancel(),_("videoConstraints should be defined");return}var R={};(!g||f.aspectRatio)&&(R.aspectRatio=f.aspectRatio);var j={onRenderSurfaceReady:function(H,G){v.setupUi(H,G,f),v.isScanning=!0,v.foreverScan(f,r,c)}};TU.failIfNotSupported().then(function(H){H.create(M).then(function(G){return G.render(i.element,R,j).then(function(Z){v.renderedCamera=Z,A.execute(),T(null)}).catch(function(Z){A.cancel(),_(Z)})}).catch(function(G){A.cancel(),_(Bc.errorGettingUserMedia(G))})}).catch(function(H){A.cancel(),_(Bc.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(or.PAUSED),this.showPausedState(),(wa(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(or.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(or.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=function(){if(e.element){var i=document.getElementById(zs.SHADED_REGION_ELEMENT_ID);i&&e.element.removeChild(i)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),r(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),n.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(r){return r.decodedText})},t.prototype.scanFileV2=function(e,n){var r=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(wa(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,i){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var c=new Image;c.onload=function(){var f=c.width,p=c.height,g=document.getElementById(r.elementId),C=g.clientWidth?g.clientWidth:zs.DEFAULT_WIDTH,v=Math.max(g.clientHeight?g.clientHeight:p,zs.FILE_SCAN_MIN_HEIGHT),A=r.computeCanvasDrawConfig(f,p,C,v);if(n){var T=r.createCanvasElement(C,v,"qr-canvas-visible");T.style.display="inline-block",g.appendChild(T);var _=T.getContext("2d");if(!_)throw"Unable to get 2d context from canvas";_.canvas.width=C,_.canvas.height=v,_.drawImage(c,0,0,f,p,A.x,A.y,A.width,A.height)}var M=zs.FILE_SCAN_HIDDEN_CANVAS_PADDING,R=Math.max(c.width,A.width),j=Math.max(c.height,A.height),H=R+2*M,G=j+2*M,Z=r.createCanvasElement(H,G);g.appendChild(Z);var J=Z.getContext("2d");if(!J)throw"Unable to get 2d context from canvas";J.canvas.width=H,J.canvas.height=G,J.drawImage(c,0,0,f,p,M,M,R,j);try{r.qrcode.decodeRobustlyAsync(Z).then(function(oe){s(XS.createFromQrcodeResult(oe))}).catch(i)}catch(oe){i("QR code parse error, error = ".concat(oe))}},c.onerror=i,c.onabort=i,c.onstalled=i,c.onsuspend=i,c.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return RU.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!vT.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var n=[at.QR_CODE,at.AZTEC,at.CODABAR,at.CODE_39,at.CODE_93,at.CODE_128,at.DATA_MATRIX,at.MAXICODE,at.ITF,at.EAN_13,at.EAN_8,at.PDF_417,at.RSS_14,at.RSS_EXPANDED,at.UPC_A,at.UPC_E,at.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],s=0,i=e.formatsToSupport;s<i.length;s++){var c=i[s];fU(c)?r.push(c):this.logger.warn("Invalid format: ".concat(c," passed in config, ignoring."))}if(r.length===0)throw"None of formatsToSupport match supported values.";return r},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(wa(e))return!0;if(!wa(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(wa(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return wa(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,n,r){var s=this,i=r.qrbox;this.validateQrboxConfig(i);var c=this.toQrdimensions(e,n,i),f=function(g){if(g<zs.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(zs.MIN_QR_BOX_SIZE,"px.")},p=function(g){return g>e&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),g=e),g};f(c.width),f(c.height),c.width=p(c.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,n,r){if(typeof r=="number")return{width:r,height:r};if(typeof r=="function")try{return r(e,n)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return r},t.prototype.setupUi=function(e,n,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,r);var s=wa(r.qrbox)?{width:e,height:n}:r.qrbox;this.validateQrboxConfig(s);var i=this.toQrdimensions(e,n,s);i.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var c=r.isShadedBoxEnabled()&&i.height<=n,f={x:0,y:0,width:e,height:n},p=c?this.getShadedRegionBounds(e,n,i):f,g=this.createCanvasElement(p.width,p.height),C={willReadFrequently:!0},v=g.getContext("2d",C);v.canvas.width=p.width,v.canvas.height=p.height,this.element.append(g),c&&this.possiblyInsertShadingElement(this.element,e,n,i),this.createScannerPausedUiElement(this.element),this.qrRegion=p,this.context=v,this.canvasElement=g},t.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=Bc.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(e,n){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return e(s.text,XS.createFromQrcodeResult(s)),r.possiblyUpdateShaders(!0),!0}).catch(function(s){r.possiblyUpdateShaders(!1);var i=Bc.codeParseError(s);return n(i,pU.createFrom(i)),!1})},t.prototype.foreverScan=function(e,n,r){var s=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),c=i.videoWidth/i.clientWidth,f=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var p=this.qrRegion.width*c,g=this.qrRegion.height*f,C=this.qrRegion.x*c,v=this.qrRegion.y*f;this.context.drawImage(i,C,v,p,g,0,0,this.qrRegion.width,this.qrRegion.height);var A=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(e,n,r)},s.getTimeoutFps(e.fps))};this.scanContext(n,r).then(function(T){!T&&e.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(n,r).finally(function(){A()})):A()}).catch(function(T){s.logger.logError("Error happend while scanning context",T),A()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",r="deviceId",s={user:!0,environment:!0},i="exact",c=function(_){if(_ in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(_,"'")},f=Object.keys(e);if(f.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(f.length," keys");var p=Object.keys(e)[0];if(p!==n&&p!==r)throw"Only '".concat(n,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(p===n){var g=e.facingMode;if(typeof g=="string"){if(c(g))return{facingMode:g}}else if(typeof g=="object")if(i in g){if(c(g["".concat(i)]))return{facingMode:{exact:g["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var C=typeof g;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var v=e.deviceId;if(typeof v=="string")return{deviceId:v};if(typeof v=="object"){if(i in v)return{deviceId:{exact:v["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var A=typeof v;throw"Invalid type of 'deviceId' = ".concat(A)}}}var T=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(T)},t.prototype.computeCanvasDrawConfig=function(e,n,r,s){if(e<=r&&n<=s){var i=(r-e)/2,c=(s-n)/2;return{x:i,y:c,width:e,height:n}}else{var f=e,p=n;return e>r&&(n=r/e*n,e=r),n>s&&(e=s/n*e,n=s),this.logger.log("Image downsampled from "+"".concat(f,"X").concat(p)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,r,s)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?zs.BORDER_SHADER_MATCH_COLOR:zs.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,n,r){var s=e,i=n,c=document.createElement("canvas");return c.style.width="".concat(s,"px"),c.style.height="".concat(i,"px"),c.style.display="none",c.id=wa(r)?"qr-canvas":r,c},t.prototype.getShadedRegionBounds=function(e,n,r){if(r.width>e||r.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(n-r.height)/2,width:r.width,height:r.height}},t.prototype.possiblyInsertShadingElement=function(e,n,r,s){if(!(n-s.width<1||r-s.height<1)){var i=document.createElement("div");i.style.position="absolute";var c=(n-s.width)/2,f=(r-s.height)/2;if(i.style.borderLeft="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(zs.SHADED_REGION_ELEMENT_ID),n-s.width<11||r-s.height<11)this.hasBorderShaders=!1;else{var p=5,g=40;this.insertShaderBorders(i,g,p,-p,null,0,!0),this.insertShaderBorders(i,g,p,-p,null,0,!1),this.insertShaderBorders(i,g,p,null,-p,0,!0),this.insertShaderBorders(i,g,p,null,-p,0,!1),this.insertShaderBorders(i,p,g+p,-p,null,-p,!0),this.insertShaderBorders(i,p,g+p,null,-p,-p,!0),this.insertShaderBorders(i,p,g+p,-p,null,-p,!1),this.insertShaderBorders(i,p,g+p,null,-p,-p,!1),this.hasBorderShaders=!0}e.append(i)}},t.prototype.insertShaderBorders=function(e,n,r,s,i,c,f){var p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor=zs.BORDER_SHADER_DEFAULT_COLOR,p.style.width="".concat(n,"px"),p.style.height="".concat(r,"px"),s!==null&&(p.style.top="".concat(s,"px")),i!==null&&(p.style.bottom="".concat(i,"px")),f?p.style.left="".concat(c,"px"):p.style.right="".concat(c,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(p),e.appendChild(p)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t})(),n3;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(n3||(n3={}));const r3=t=>{var i,c;const e=t.replace(/[\s-]/g,"").trim(),n=e.replace(/[^0-9Xx]/g,"").toUpperCase();if(n.length===13||n.length===10)return n;const r=(i=n.match(/97[89]\d{10}/))==null?void 0:i[0];if(r)return r;const s=(c=n.match(/\d{9}[0-9X]/))==null?void 0:c[0];return s||e},PU=[at.EAN_13,at.EAN_8,at.UPC_A,at.UPC_E,at.CODE_128],s3=({onDetected:t,onClose:e})=>{const n=L.useRef(null),[r,s]=L.useState(null),[i,c]=L.useState(!0),[f,p]=L.useState(""),g=L.useRef(!1),C=L.useRef(t);C.current=t;const v=L.useRef(e);v.current=e;const A=L.useMemo(()=>`isbn-scanner-${Math.random().toString(36).slice(2,10)}`,[]),T=L.useCallback(async()=>{const R=n.current;if(n.current=null,!!R){try{await R.stop()}catch{}try{R.clear()}catch{}}},[]);L.useEffect(()=>{let R=!0;return(async()=>{try{const H=new BU(A,{formatsToSupport:PU,useBarCodeDetectorIfSupported:!0,verbose:!1});n.current=H;const G=async oe=>{if(!R||g.current)return;g.current=!0;const U=r3(oe);await T(),R&&C.current(U)},Z=()=>{},J={fps:12,qrbox:{width:280,height:90},aspectRatio:16/9,disableFlip:!1,videoConstraints:{facingMode:{ideal:"environment"},width:{ideal:1920},height:{ideal:1080}}};try{await H.start({facingMode:{ideal:"environment"}},J,G,Z)}catch{await H.start({facingMode:"environment"},{fps:10,qrbox:{width:260,height:80}},G,Z)}R&&c(!1)}catch(H){if(!R)return;const G=H instanceof Error?H.message:String(H);G.includes("NotAllowed")||G.includes("Permission")||G.includes("denied")?s("Camera permission denied. Please allow camera access and try again."):G.includes("NotFound")||G.includes("camera")||G.includes("Overconstrained")?s("No suitable camera found on this device."):s(`Camera error: ${G}`),c(!1)}})(),()=>{R=!1,T()}},[A,T]);const _=L.useCallback(()=>{(async()=>(await T(),v.current()))()},[T]),M=L.useCallback(()=>{const R=r3(f);R&&(async()=>(await T(),C.current(R)))()},[f,T]);return b.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[60] p-4",children:b.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[b.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[b.jsx(jl,{className:"text-[#CC561E]",size:20}),"Scan ISBN Barcode"]}),b.jsx("button",{onClick:_,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:b.jsx(wi,{size:20})})]}),b.jsx("div",{className:"p-4",children:r?b.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-3 text-center",children:[b.jsx(jl,{className:"text-red-400",size:32}),b.jsx("p",{className:"text-sm text-red-500 dark:text-red-400 max-w-xs",children:r}),b.jsx("button",{onClick:_,className:"mt-2 px-4 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium transition-colors",children:"Close"})]}):b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-black min-h-[320px]",children:[b.jsx("div",{id:A,className:"w-full h-[320px]"}),i&&b.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/50",children:[b.jsx(mr,{className:"animate-spin text-[#CC561E]",size:32}),b.jsx("p",{className:"text-sm text-slate-200",children:"Starting camera..."})]})]}),b.jsx("p",{className:"text-center text-xs text-slate-400 dark:text-slate-500 mt-3",children:"Align the barcode in the frame and keep the phone steady."}),b.jsxs("div",{className:"mt-4 flex gap-2",children:[b.jsx("input",{value:f,onChange:R=>p(R.target.value),placeholder:"Type or paste ISBN",className:"flex-1 border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 text-sm font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),b.jsx("button",{type:"button",onClick:M,disabled:!f.trim(),className:"px-3 py-2 rounded-lg text-sm font-medium bg-[#CC561E] text-white disabled:opacity-50",children:"Use ISBN"})]})]})})]})})},FU=()=>{};var i3={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},zU=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],c=t[n++],f=t[n++],p=((s&7)<<18|(i&63)<<12|(c&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(p>>10)),e[r++]=String.fromCharCode(56320+(p&1023))}else{const i=t[n++],c=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|c&63)}}return e.join("")},ST={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],c=s+1<t.length,f=c?t[s+1]:0,p=s+2<t.length,g=p?t[s+2]:0,C=i>>2,v=(i&3)<<4|f>>4;let A=(f&15)<<2|g>>6,T=g&63;p||(T=64,c||(A=64)),r.push(n[C],n[v],n[A],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ET(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],f=s<t.length?n[t.charAt(s)]:0;++s;const g=s<t.length?n[t.charAt(s)]:64;++s;const v=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||f==null||g==null||v==null)throw new UU;const A=i<<2|f>>4;if(r.push(A),g!==64){const T=f<<4&240|g>>2;if(r.push(T),v!==64){const _=g<<6&192|v;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class UU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HU=function(t){const e=ET(t);return ST.encodeByteArray(e,!0)},AT=function(t){return HU(t).replace(/\./g,"")},NT=function(t){try{return ST.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU=()=>VU().__FIREBASE_DEFAULTS__,WU=()=>{if(typeof process>"u"||typeof i3>"u")return;const t=i3.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&NT(t[1]);return e&&JSON.parse(e)},Ub=()=>{try{return FU()||GU()||WU()||qU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$U=t=>{var e,n;return(n=(e=Ub())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},kT=()=>{var t;return(t=Ub())==null?void 0:t.config},TT=t=>{var e;return(e=Ub())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function YU(t){return(await fetch(t,{credentials:"include"})).ok}const Md={};function KU(){const t={prod:[],emulator:[]};for(const e of Object.keys(Md))Md[e]?t.emulator.push(e):t.prod.push(e);return t}function ZU(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let a3=!1;function JU(t,e){if(typeof window>"u"||typeof document>"u"||!c1(window.location.host)||Md[t]===e||Md[t]||a3)return;Md[t]=e;function n(A){return`__firebase__banner__${A}`}const r="__firebase__banner",i=KU().prod.length>0;function c(){const A=document.getElementById(r);A&&A.remove()}function f(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function p(A,T){A.setAttribute("width","24"),A.setAttribute("id",T),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function g(){const A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{a3=!0,c()},A}function C(A,T){A.setAttribute("id",T),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function v(){const A=ZU(r),T=n("text"),_=document.getElementById(T)||document.createElement("span"),M=n("learnmore"),R=document.getElementById(M)||document.createElement("a"),j=n("preprendIcon"),H=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){const G=A.element;f(G),C(R,M);const Z=g();p(H,j),G.append(H,_,R,Z),document.body.appendChild(G)}i?(_.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hs())}function eH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function nH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rH(){const t=hs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function sH(){try{return typeof indexedDB=="object"}catch{return!1}}function iH(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aH="FirebaseError";class Wo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=aH,Object.setPrototypeOf(this,Wo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pf.prototype.create)}}class pf{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],c=i?oH(i,r):"Error",f=`${this.serviceName}: ${c} (${s}).`;return new Wo(s,f,r)}}function oH(t,e){return t.replace(lH,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const lH=/\{\$([^}]+)}/g;function cH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function au(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],c=e[s];if(o3(i)&&o3(c)){if(!au(i,c))return!1}else if(i!==c)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function o3(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function uH(t,e){const n=new dH(t,e);return n.subscribe.bind(n)}class dH{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");fH(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=ex),s.error===void 0&&(s.error=ex),s.complete===void 0&&(s.complete=ex);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fH(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function ex(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){return t&&t._delegate?t._delegate:t}class ou{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hH{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new XU;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mH(e))try{this.getOrInitializeService({instanceIdentifier:wl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=wl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wl){return this.instances.has(e)}getOptions(e=wl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(i);r===f&&c.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pH(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=wl){return this.component?this.component.multipleInstances?e:wl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pH(t){return t===wl?void 0:t}function mH(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hH(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ln||(Ln={}));const xH={debug:Ln.DEBUG,verbose:Ln.VERBOSE,info:Ln.INFO,warn:Ln.WARN,error:Ln.ERROR,silent:Ln.SILENT},bH=Ln.INFO,yH={[Ln.DEBUG]:"log",[Ln.VERBOSE]:"log",[Ln.INFO]:"info",[Ln.WARN]:"warn",[Ln.ERROR]:"error"},wH=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=yH[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class OT{constructor(e){this.name=e,this._logLevel=bH,this._logHandler=wH,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ln))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xH[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ln.DEBUG,...e),this._logHandler(this,Ln.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ln.VERBOSE,...e),this._logHandler(this,Ln.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ln.INFO,...e),this._logHandler(this,Ln.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ln.WARN,...e),this._logHandler(this,Ln.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ln.ERROR,...e),this._logHandler(this,Ln.ERROR,...e)}}const vH=(t,e)=>e.some(n=>t instanceof n);let l3,c3;function CH(){return l3||(l3=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EH(){return c3||(c3=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _T=new WeakMap,C2=new WeakMap,RT=new WeakMap,tx=new WeakMap,Hb=new WeakMap;function SH(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",c)},i=()=>{n(jo(t.result)),s()},c=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&_T.set(n,t)}).catch(()=>{}),Hb.set(e,t),e}function AH(t){if(C2.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",c),t.removeEventListener("abort",c)},i=()=>{n(),s()},c=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",c),t.addEventListener("abort",c)});C2.set(t,e)}let E2={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return C2.get(t);if(e==="objectStoreNames")return t.objectStoreNames||RT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return jo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NH(t){E2=t(E2)}function kH(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(nx(this),e,...n);return RT.set(r,e.sort?e.sort():[e]),jo(r)}:EH().includes(t)?function(...e){return t.apply(nx(this),e),jo(_T.get(this))}:function(...e){return jo(t.apply(nx(this),e))}}function TH(t){return typeof t=="function"?kH(t):(t instanceof IDBTransaction&&AH(t),vH(t,CH())?new Proxy(t,E2):t)}function jo(t){if(t instanceof IDBRequest)return SH(t);if(tx.has(t))return tx.get(t);const e=TH(t);return e!==t&&(tx.set(t,e),Hb.set(e,t)),e}const nx=t=>Hb.get(t);function OH(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const c=indexedDB.open(t,e),f=jo(c);return r&&c.addEventListener("upgradeneeded",p=>{r(jo(c.result),p.oldVersion,p.newVersion,jo(c.transaction),p)}),n&&c.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),f.then(p=>{i&&p.addEventListener("close",()=>i()),s&&p.addEventListener("versionchange",g=>s(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const _H=["get","getKey","getAll","getAllKeys","count"],RH=["put","add","delete","clear"],rx=new Map;function u3(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rx.get(e))return rx.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=RH.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||_H.includes(n)))return;const i=async function(c,...f){const p=this.transaction(c,s?"readwrite":"readonly");let g=p.store;return r&&(g=g.index(f.shift())),(await Promise.all([g[n](...f),s&&p.done]))[0]};return rx.set(e,i),i}NH(t=>({...t,get:(e,n,r)=>u3(e,n)||t.get(e,n,r),has:(e,n)=>!!u3(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(IH(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function IH(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const S2="@firebase/app",d3="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new OT("@firebase/app"),DH="@firebase/app-compat",LH="@firebase/analytics-compat",jH="@firebase/analytics",BH="@firebase/app-check-compat",PH="@firebase/app-check",FH="@firebase/auth",zH="@firebase/auth-compat",UH="@firebase/database",HH="@firebase/data-connect",VH="@firebase/database-compat",GH="@firebase/functions",WH="@firebase/functions-compat",qH="@firebase/installations",$H="@firebase/installations-compat",XH="@firebase/messaging",YH="@firebase/messaging-compat",KH="@firebase/performance",ZH="@firebase/performance-compat",JH="@firebase/remote-config",QH="@firebase/remote-config-compat",eV="@firebase/storage",tV="@firebase/storage-compat",nV="@firebase/firestore",rV="@firebase/ai",sV="@firebase/firestore-compat",iV="firebase",aV="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2="[DEFAULT]",oV={[S2]:"fire-core",[DH]:"fire-core-compat",[jH]:"fire-analytics",[LH]:"fire-analytics-compat",[PH]:"fire-app-check",[BH]:"fire-app-check-compat",[FH]:"fire-auth",[zH]:"fire-auth-compat",[UH]:"fire-rtdb",[HH]:"fire-data-connect",[VH]:"fire-rtdb-compat",[GH]:"fire-fn",[WH]:"fire-fn-compat",[qH]:"fire-iid",[$H]:"fire-iid-compat",[XH]:"fire-fcm",[YH]:"fire-fcm-compat",[KH]:"fire-perf",[ZH]:"fire-perf-compat",[JH]:"fire-rc",[QH]:"fire-rc-compat",[eV]:"fire-gcs",[tV]:"fire-gcs-compat",[nV]:"fire-fst",[sV]:"fire-fst-compat",[rV]:"fire-vertex","fire-js":"fire-js",[iV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=new Map,lV=new Map,N2=new Map;function f3(t,e){try{t.container.addComponent(e)}catch(n){Ma.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Jd(t){const e=t.name;if(N2.has(e))return Ma.debug(`There were multiple attempts to register component ${e}.`),!1;N2.set(e,t);for(const n of Np.values())f3(n,t);for(const n of lV.values())f3(n,t);return!0}function MT(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Fi(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bo=new pf("app","Firebase",cV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ou("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf=aV;function IT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:A2,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Bo.create("bad-app-name",{appName:String(s)});if(n||(n=kT()),!n)throw Bo.create("no-options");const i=Np.get(s);if(i){if(au(n,i.options)&&au(r,i.config))return i;throw Bo.create("duplicate-app",{appName:s})}const c=new gH(s);for(const p of N2.values())c.addComponent(p);const f=new uV(n,r,c);return Np.set(s,f),f}function dV(t=A2){const e=Np.get(t);if(!e&&t===A2&&kT())return IT();if(!e)throw Bo.create("no-app",{appName:t});return e}function Vc(t,e,n){let r=oV[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const c=[`Unable to register library "${r}" with version "${e}":`];s&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&c.push("and"),i&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ma.warn(c.join(" "));return}Jd(new ou(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV="firebase-heartbeat-database",hV=1,Qd="firebase-heartbeat-store";let sx=null;function DT(){return sx||(sx=OH(fV,hV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qd)}catch(n){console.warn(n)}}}}).catch(t=>{throw Bo.create("idb-open",{originalErrorMessage:t.message})})),sx}async function pV(t){try{const n=(await DT()).transaction(Qd),r=await n.objectStore(Qd).get(LT(t));return await n.done,r}catch(e){if(e instanceof Wo)Ma.warn(e.message);else{const n=Bo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ma.warn(n.message)}}}async function h3(t,e){try{const r=(await DT()).transaction(Qd,"readwrite");await r.objectStore(Qd).put(e,LT(t)),await r.done}catch(n){if(n instanceof Wo)Ma.warn(n.message);else{const r=Bo.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ma.warn(r.message)}}}function LT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=1024,gV=30;class xV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new yV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=p3();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(c=>c.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>gV){const c=wV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ma.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=p3(),{heartbeatsToSend:r,unsentEntries:s}=bV(this._heartbeatsCache.heartbeats),i=AT(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Ma.warn(n),""}}}function p3(){return new Date().toISOString().substring(0,10)}function bV(t,e=mV){const n=[];let r=t.slice();for(const s of t){const i=n.find(c=>c.agent===s.agent);if(i){if(i.dates.push(s.date),m3(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),m3(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class yV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sH()?iH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return h3(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return h3(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function m3(t){return AT(JSON.stringify({version:2,heartbeats:t})).length}function wV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vV(t){Jd(new ou("platform-logger",e=>new MH(e),"PRIVATE")),Jd(new ou("heartbeat",e=>new xV(e),"PRIVATE")),Vc(S2,d3,t),Vc(S2,d3,"esm2020"),Vc("fire-js","")}vV("");function jT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CV=jT,BT=new pf("auth","Firebase",jT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp=new OT("@firebase/auth");function EV(t,...e){kp.logLevel<=Ln.WARN&&kp.warn(`Auth (${gf}): ${t}`,...e)}function m0(t,...e){kp.logLevel<=Ln.ERROR&&kp.error(`Auth (${gf}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t,...e){throw Gb(t,...e)}function bi(t,...e){return Gb(t,...e)}function Vb(t,e,n){const r={...CV(),[e]:n};return new pf("auth","Firebase",r).create(e,{appName:t.name})}function Ll(t){return Vb(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SV(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Gi(t,"argument-error"),Vb(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gb(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return BT.create(t,...e)}function Rt(t,e,...n){if(!t)throw Gb(e,...n)}function Aa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw m0(e),new Error(e)}function Ia(t,e){t||Aa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function AV(){return g3()==="http:"||g3()==="https:"}function g3(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AV()||tH()||"connection"in navigator)?navigator.onLine:!0}function kV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ia(n>e,"Short delay should be less than long delay!"),this.isMobile=QU()||nH()}get(){return NV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(t,e){Ia(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Aa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Aa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Aa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_V=new xf(3e4,6e4);function qb(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function pu(t,e,n,r,s={}){return FT(t,s,async()=>{let i={},c={};r&&(e==="GET"?c=r:i={body:JSON.stringify(r)});const f=mf({key:t.config.apiKey,...c}).slice(1),p=await t._getAdditionalHeaders();p["Content-Type"]="application/json",t.languageCode&&(p["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:p,...i};return eH()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&c1(t.emulatorConfig.host)&&(g.credentials="include"),PT.fetch()(await zT(t,t.config.apiHost,n,f),g)})}async function FT(t,e,n){t._canInitEmulator=!1;const r={...TV,...e};try{const s=new MV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const c=await i.json();if("needConfirmation"in c)throw t0(t,"account-exists-with-different-credential",c);if(i.ok&&!("errorMessage"in c))return c;{const f=i.ok?c.errorMessage:c.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw t0(t,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw t0(t,"email-already-in-use",c);if(p==="USER_DISABLED")throw t0(t,"user-disabled",c);const C=r[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Vb(t,C,g);Gi(t,C)}}catch(s){if(s instanceof Wo)throw s;Gi(t,"network-request-failed",{message:String(s)})}}async function RV(t,e,n,r,s={}){const i=await pu(t,e,n,r,s);return"mfaPendingCredential"in i&&Gi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function zT(t,e,n,r){const s=`${e}${n}?${r}`,i=t,c=i.config.emulator?Wb(t.config,s):`${t.config.apiScheme}://${s}`;return OV.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(c).toString():c}class MV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(bi(this.auth,"network-request-failed")),_V.get())})}}function t0(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=bi(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IV(t,e){return pu(t,"POST","/v1/accounts:delete",e)}async function Tp(t,e){return pu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function DV(t,e=!1){const n=qo(t),r=await n.getIdToken(e),s=$b(r);Rt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,c=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Id(ix(s.auth_time)),issuedAtTime:Id(ix(s.iat)),expirationTime:Id(ix(s.exp)),signInProvider:c||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function ix(t){return Number(t)*1e3}function $b(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return m0("JWT malformed, contained fewer than 3 sections"),null;try{const s=NT(n);return s?JSON.parse(s):(m0("Failed to decode base64 JWT payload"),null)}catch(s){return m0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function x3(t){const e=$b(t);return Rt(e,"internal-error"),Rt(typeof e.exp<"u","internal-error"),Rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Wo&&LV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function LV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Id(this.lastLoginAt),this.creationTime=Id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Op(t){var v;const e=t.auth,n=await t.getIdToken(),r=await ef(t,Tp(e,{idToken:n}));Rt(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(v=s.providerUserInfo)!=null&&v.length?UT(s.providerUserInfo):[],c=PV(t.providerData,i),f=t.isAnonymous,p=!(t.email&&s.passwordHash)&&!(c!=null&&c.length),g=f?p:!1,C={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new T2(s.createdAt,s.lastLoginAt),isAnonymous:g};Object.assign(t,C)}async function BV(t){const e=qo(t);await Op(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function UT(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FV(t,e){const n=await FT(t,{},async()=>{const r=mf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,c=await zT(t,s,"/v1/token",`key=${i}`),f=await t._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:r};return t.emulatorConfig&&c1(t.emulatorConfig.host)&&(p.credentials="include"),PT.fetch()(c,p)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function zV(t,e){return pu(t,"POST","/v2/accounts:revokeToken",qb(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rt(e.idToken,"internal-error"),Rt(typeof e.idToken<"u","internal-error"),Rt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):x3(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Rt(e.length!==0,"internal-error");const n=x3(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await FV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,c=new Gc;return r&&(Rt(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),s&&(Rt(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),i&&(Rt(typeof i=="number","internal-error",{appName:e}),c.expirationTime=i),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gc,this.toJSON())}_performRefresh(){return Aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(t,e){Rt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class gi{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new jV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new T2(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ef(this,this.stsTokenManager.getToken(this.auth,e));return Rt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return DV(this,e)}reload(){return BV(this)}_assign(e){this!==e&&(Rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new gi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Op(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fi(this.auth.app))return Promise.reject(Ll(this.auth));const e=await this.getIdToken();return await ef(this,IV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,c=n.photoURL??void 0,f=n.tenantId??void 0,p=n._redirectEventId??void 0,g=n.createdAt??void 0,C=n.lastLoginAt??void 0,{uid:v,emailVerified:A,isAnonymous:T,providerData:_,stsTokenManager:M}=n;Rt(v&&M,e,"internal-error");const R=Gc.fromJSON(this.name,M);Rt(typeof v=="string",e,"internal-error"),go(r,e.name),go(s,e.name),Rt(typeof A=="boolean",e,"internal-error"),Rt(typeof T=="boolean",e,"internal-error"),go(i,e.name),go(c,e.name),go(f,e.name),go(p,e.name),go(g,e.name),go(C,e.name);const j=new gi({uid:v,auth:e,email:s,emailVerified:A,displayName:r,isAnonymous:T,photoURL:c,phoneNumber:i,tenantId:f,stsTokenManager:R,createdAt:g,lastLoginAt:C});return _&&Array.isArray(_)&&(j.providerData=_.map(H=>({...H}))),p&&(j._redirectEventId=p),j}static async _fromIdTokenResponse(e,n,r=!1){const s=new Gc;s.updateFromServerResponse(n);const i=new gi({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Op(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Rt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?UT(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),f=new Gc;f.updateFromIdToken(r);const p=new gi({uid:s.localId,auth:e,stsTokenManager:f,isAnonymous:c}),g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new T2(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=new Map;function Na(t){Ia(t instanceof Function,"Expected a class definition");let e=b3.get(t);return e?(Ia(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,b3.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}HT.type="NONE";const y3=HT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e,n){return`firebase:${t}:${e}:${n}`}class Wc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=g0(this.userKey,s.apiKey,i),this.fullPersistenceKey=g0("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Tp(this.auth,{idToken:e}).catch(()=>{});return n?gi._fromGetAccountInfoResponse(this.auth,n,e):null}return gi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Wc(Na(y3),e,r);const s=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let i=s[0]||Na(y3);const c=g0(r,e.config.apiKey,e.name);let f=null;for(const g of n)try{const C=await g._get(c);if(C){let v;if(typeof C=="string"){const A=await Tp(e,{idToken:C}).catch(()=>{});if(!A)break;v=await gi._fromGetAccountInfoResponse(e,A,C)}else v=gi._fromJSON(e,C);g!==i&&(f=v),i=g;break}}catch{}const p=s.filter(g=>g._shouldAllowMigration);return!i._shouldAllowMigration||!p.length?new Wc(i,e,r):(i=p[0],f&&await i._set(c,f.toJSON()),await Promise.all(n.map(async g=>{if(g!==i)try{await g._remove(c)}catch{}})),new Wc(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(VT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XT(e))return"Blackberry";if(YT(e))return"Webos";if(GT(e))return"Safari";if((e.includes("chrome/")||WT(e))&&!e.includes("edge/"))return"Chrome";if($T(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function VT(t=hs()){return/firefox\//i.test(t)}function GT(t=hs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function WT(t=hs()){return/crios\//i.test(t)}function qT(t=hs()){return/iemobile/i.test(t)}function $T(t=hs()){return/android/i.test(t)}function XT(t=hs()){return/blackberry/i.test(t)}function YT(t=hs()){return/webos/i.test(t)}function Xb(t=hs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function UV(t=hs()){var e;return Xb(t)&&!!((e=window.navigator)!=null&&e.standalone)}function HV(){return rH()&&document.documentMode===10}function KT(t=hs()){return Xb(t)||$T(t)||YT(t)||XT(t)||/windows phone/i.test(t)||qT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e=[]){let n;switch(t){case"Browser":n=w3(hs());break;case"Worker":n=`${w3(hs())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${gf}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((c,f)=>{try{const p=e(i);c(p)}catch(p){f(p)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GV(t,e={}){return pu(t,"GET","/v2/passwordPolicy",qb(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=6;class qV{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??WV,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new v3(this),this.idTokenSubscription=new v3(this),this.beforeStateQueue=new VV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Na(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Wc.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Tp(this,{idToken:e}),r=await gi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Fi(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(f,f))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(i=this.redirectUser)==null?void 0:i._redirectEventId,f=r==null?void 0:r._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===f)&&(p!=null&&p.user)&&(r=p.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Op(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fi(this.app))return Promise.reject(Ll(this));const n=e?qo(e):null;return n&&Rt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fi(this.app)?Promise.reject(Ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fi(this.app)?Promise.reject(Ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Na(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await GV(this),n=new qV(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new pf("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await zV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Na(e)||this._popupRedirectResolver;Rt(n,this,"argument-error"),this.redirectPersistenceManager=await Wc.create(this,[Na(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rt(f,this,"internal-error"),f.then(()=>{c||i(this.currentUser)}),typeof n=="function"){const p=e.addObserver(n,r,s);return()=>{c=!0,p()}}else{const p=e.addObserver(n);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Fi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&EV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function bf(t){return qo(t)}class v3{constructor(e){this.auth=e,this.observer=null,this.addObserver=uH(n=>this.observer=n)}get next(){return Rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XV(t){Yb=t}function YV(t){return Yb.loadJS(t)}function KV(){return Yb.gapiScript}function ZV(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JV(t,e){const n=MT(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(au(i,e??{}))return s;Gi(s,"already-initialized")}return n.initialize({options:e})}function QV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Na);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function eG(t,e,n){const r=bf(t);Rt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=JT(e),{host:c,port:f}=tG(e),p=f===null?"":`:${f}`,g={url:`${i}//${c}${p}/`},C=Object.freeze({host:c,port:f,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Rt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Rt(au(g,r.config.emulator)&&au(C,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=g,r.emulatorConfig=C,r.settings.appVerificationDisabledForTesting=!0,c1(c)?(YU(`${i}//${c}${p}`),JU("Auth",!0)):nG()}function JT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tG(t){const e=JT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:C3(r.substr(i.length+1))}}else{const[i,c]=r.split(":");return{host:i,port:C3(c)}}}function C3(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nG(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Aa("not implemented")}_getIdTokenResponse(e){return Aa("not implemented")}_linkToIdToken(e,n){return Aa("not implemented")}_getReauthenticationResolver(e){return Aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qc(t,e){return RV(t,"POST","/v1/accounts:signInWithIdp",qb(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rG="http://localhost";class Gl extends QT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Gl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Gi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const c=new Gl(r,s);return c.idToken=i.idToken||void 0,c.accessToken=i.accessToken||void 0,c.secret=i.secret,c.nonce=i.nonce,c.pendingToken=i.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return qc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,qc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,qc(e,n)}buildRequest(){const e={requestUri:rG,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=mf(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf extends Kb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends yf{constructor(){super("facebook.com")}static credential(e){return Gl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ao.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends yf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Gl._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ca.credential(n,r)}catch{return null}}}Ca.GOOGLE_SIGN_IN_METHOD="google.com";Ca.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends yf{constructor(){super("github.com")}static credential(e){return Gl._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return No.credential(e.oauthAccessToken)}catch{return null}}}No.GITHUB_SIGN_IN_METHOD="github.com";No.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends yf{constructor(){super("twitter.com")}static credential(e,n){return Gl._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ko.credential(n,r)}catch{return null}}}ko.TWITTER_SIGN_IN_METHOD="twitter.com";ko.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await gi._fromIdTokenResponse(e,r,s),c=E3(r);return new lu({user:i,providerId:c,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=E3(r);return new lu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function E3(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p extends Wo{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,_p.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new _p(e,n,r,s)}}function e6(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?_p._fromErrorAndOperation(t,i,e,r):i})}async function sG(t,e,n=!1){const r=await ef(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return lu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iG(t,e,n=!1){const{auth:r}=t;if(Fi(r.app))return Promise.reject(Ll(r));const s="reauthenticate";try{const i=await ef(t,e6(r,s,e,t),n);Rt(i.idToken,r,"internal-error");const c=$b(i.idToken);Rt(c,r,"internal-error");const{sub:f}=c;return Rt(t.uid===f,r,"user-mismatch"),lu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Gi(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aG(t,e,n=!1){if(Fi(t.app))return Promise.reject(Ll(t));const r="signIn",s=await e6(t,r,e),i=await lu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function oG(t,e,n,r){return qo(t).onIdTokenChanged(e,n,r)}function lG(t,e,n){return qo(t).beforeAuthStateChanged(e,n)}function cG(t,e,n,r){return qo(t).onAuthStateChanged(e,n,r)}function uG(t){return qo(t).signOut()}const Rp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rp,"1"),this.storage.removeItem(Rp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dG=1e3,fG=10;class n6 extends t6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=KT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,f,p)=>{this.notifyListeners(c,p)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(r);!n&&this.localCache[r]===c||this.notifyListeners(r,c)},i=this.storage.getItem(r);HV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fG):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}n6.type="LOCAL";const hG=n6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6 extends t6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}r6.type="SESSION";const s6=r6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pG(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new u1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,c=this.handlersMap[s];if(!(c!=null&&c.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const f=Array.from(c).map(async g=>g(n.origin,i)),p=await pG(f);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:p})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}u1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mG{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,c;return new Promise((f,p)=>{const g=Zb("",20);s.port1.start();const C=setTimeout(()=>{p(new Error("unsupported_event"))},r);c={messageChannel:s,onMessage(v){const A=v;if(A.data.eventId===g)switch(A.data.status){case"ack":clearTimeout(C),i=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),f(A.data.response);break;default:clearTimeout(C),clearTimeout(i),p(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(){return window}function gG(t){Ui().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i6(){return typeof Ui().WorkerGlobalScope<"u"&&typeof Ui().importScripts=="function"}async function xG(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bG(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function yG(){return i6()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a6="firebaseLocalStorageDb",wG=1,Mp="firebaseLocalStorage",o6="fbase_key";class wf{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function d1(t,e){return t.transaction([Mp],e?"readwrite":"readonly").objectStore(Mp)}function vG(){const t=indexedDB.deleteDatabase(a6);return new wf(t).toPromise()}function O2(){const t=indexedDB.open(a6,wG);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Mp,{keyPath:o6})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Mp)?e(r):(r.close(),await vG(),e(await O2()))})})}async function S3(t,e,n){const r=d1(t,!0).put({[o6]:e,value:n});return new wf(r).toPromise()}async function CG(t,e){const n=d1(t,!1).get(e),r=await new wf(n).toPromise();return r===void 0?null:r.value}function A3(t,e){const n=d1(t,!0).delete(e);return new wf(n).toPromise()}const EG=800,SG=3;class l6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await O2(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>SG)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return i6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=u1._getInstance(yG()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await xG(),!this.activeServiceWorker)return;this.sender=new mG(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await O2();return await S3(e,Rp,"1"),await A3(e,Rp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>S3(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>CG(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>A3(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=d1(s,!1).getAll();return new wf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),EG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}l6.type="LOCAL";const AG=l6;new xf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t,e){return e?Na(e):(Rt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb extends QT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return qc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return qc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function NG(t){return aG(t.auth,new Jb(t),t.bypassAuthState)}function kG(t){const{auth:e,user:n}=t;return Rt(n,e,"internal-error"),iG(n,new Jb(t),t.bypassAuthState)}async function TG(t){const{auth:e,user:n}=t;return Rt(n,e,"internal-error"),sG(n,new Jb(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:c,type:f}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NG;case"linkViaPopup":case"linkViaRedirect":return TG;case"reauthViaPopup":case"reauthViaRedirect":return kG;default:Gi(this.auth,"internal-error")}}resolve(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OG=new xf(2e3,1e4);async function _G(t,e,n){if(Fi(t.app))return Promise.reject(bi(t,"operation-not-supported-in-this-environment"));const r=bf(t);SV(t,e,Kb);const s=c6(r,n);return new kl(r,"signInViaPopup",e,s).executeNotNull()}class kl extends u6{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,kl.currentPopupAction&&kl.currentPopupAction.cancel(),kl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rt(e,this.auth,"internal-error"),e}async onExecution(){Ia(this.filter.length===1,"Popup operations only handle one event");const e=Zb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(bi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(bi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OG.get())};e()}}kl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RG="pendingRedirect",x0=new Map;class MG extends u6{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=x0.get(this.auth._key());if(!e){try{const r=await IG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}x0.set(this.auth._key(),e)}return this.bypassAuthState||x0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function IG(t,e){const n=jG(e),r=LG(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function DG(t,e){x0.set(t._key(),e)}function LG(t){return Na(t._redirectPersistence)}function jG(t){return g0(RG,t.config.apiKey,t.name)}async function BG(t,e){return await bf(t)._initializationPromise,d6(t,e,!1)}async function d6(t,e,n=!1){if(Fi(t.app))return Promise.reject(Ll(t));const r=bf(t),s=c6(r,e),c=await new MG(r,s,n).execute();return c&&!n&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PG=600*1e3;class FG{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zG(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!f6(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(bi(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PG&&this.cachedEventUids.clear(),this.cachedEventUids.has(N3(e))}saveEventToCache(e){this.cachedEventUids.add(N3(e)),this.lastProcessedEventTime=Date.now()}}function N3(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function f6({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zG(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f6(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UG(t,e={}){return pu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,VG=/^https?/;async function GG(t){if(t.config.emulator)return;const{authorizedDomains:e}=await UG(t);for(const n of e)try{if(WG(n))return}catch{}Gi(t,"unauthorized-domain")}function WG(t){const e=k2(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===r}if(!VG.test(n))return!1;if(HG.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qG=new xf(3e4,6e4);function k3(){const t=Ui().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function $G(t){return new Promise((e,n)=>{var s,i,c;function r(){k3(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{k3(),n(bi(t,"network-request-failed"))},timeout:qG.get()})}if((i=(s=Ui().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((c=Ui().gapi)!=null&&c.load)r();else{const f=ZV("iframefcb");return Ui()[f]=()=>{gapi.load?r():n(bi(t,"network-request-failed"))},YV(`${KV()}?onload=${f}`).catch(p=>n(p))}}).catch(e=>{throw b0=null,e})}let b0=null;function XG(t){return b0=b0||$G(t),b0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YG=new xf(5e3,15e3),KG="__/auth/iframe",ZG="emulator/auth/iframe",JG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eW(t){const e=t.config;Rt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Wb(e,ZG):`https://${t.config.authDomain}/${KG}`,r={apiKey:e.apiKey,appName:t.name,v:gf},s=QG.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${mf(r).slice(1)}`}async function tW(t){const e=await XG(t),n=Ui().gapi;return Rt(n,t,"internal-error"),e.open({where:document.body,url:eW(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JG,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const c=bi(t,"network-request-failed"),f=Ui().setTimeout(()=>{i(c)},YG.get());function p(){Ui().clearTimeout(f),s(r)}r.ping(p).then(p,()=>{i(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rW=500,sW=600,iW="_blank",aW="http://localhost";class T3{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oW(t,e,n,r=rW,s=sW){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const p={...nW,width:r.toString(),height:s.toString(),top:i,left:c},g=hs().toLowerCase();n&&(f=WT(g)?iW:n),VT(g)&&(e=e||aW,p.scrollbars="yes");const C=Object.entries(p).reduce((A,[T,_])=>`${A}${T}=${_},`,"");if(UV(g)&&f!=="_self")return lW(e||"",f),new T3(null);const v=window.open(e||"",f,C);Rt(v,t,"popup-blocked");try{v.focus()}catch{}return new T3(v)}function lW(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cW="__/auth/handler",uW="emulator/auth/handler",dW=encodeURIComponent("fac");async function O3(t,e,n,r,s,i){Rt(t.config.authDomain,t,"auth-domain-config-required"),Rt(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:gf,eventId:s};if(e instanceof Kb){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",cH(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[C,v]of Object.entries({}))c[C]=v}if(e instanceof yf){const C=e.getScopes().filter(v=>v!=="");C.length>0&&(c.scopes=C.join(","))}t.tenantId&&(c.tid=t.tenantId);const f=c;for(const C of Object.keys(f))f[C]===void 0&&delete f[C];const p=await t._getAppCheckToken(),g=p?`#${dW}=${encodeURIComponent(p)}`:"";return`${fW(t)}?${mf(f).slice(1)}${g}`}function fW({config:t}){return t.emulator?Wb(t,uW):`https://${t.authDomain}/${cW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax="webStorageSupport";class hW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=s6,this._completeRedirectFn=d6,this._overrideRedirectResult=DG}async _openPopup(e,n,r,s){var c;Ia((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const i=await O3(e,n,r,k2(),s);return oW(e,i,Zb())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await O3(e,n,r,k2(),s);return gG(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ia(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await tW(e),r=new FG(e);return n.register("authEvent",s=>(Rt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ax,{type:ax},s=>{var c;const i=(c=s==null?void 0:s[0])==null?void 0:c[ax];i!==void 0&&n(!!i),Gi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=GG(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return KT()||GT()||Xb()}}const pW=hW;var _3="@firebase/auth",R3="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xW(t){Jd(new ou("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=r.options;Rt(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const p={apiKey:c,authDomain:f,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZT(t)},g=new $V(r,s,i,p);return QV(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Jd(new ou("auth-internal",e=>{const n=bf(e.getProvider("auth").getImmediate());return(r=>new mW(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vc(_3,R3,gW(t)),Vc(_3,R3,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW=300,yW=TT("authIdTokenMaxAge")||bW;let M3=null;const wW=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>yW)return;const s=n==null?void 0:n.token;M3!==s&&(M3=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Qb(t=dV()){const e=MT(t,"auth");if(e.isInitialized())return e.getImmediate();const n=JV(t,{popupRedirectResolver:pW,persistence:[AG,hG,s6]}),r=TT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const c=wW(i.toString());lG(n,c,()=>c(n.currentUser)),oG(n,f=>c(f))}}const s=$U("auth");return s&&eG(n,`http://${s}`),n}function vW(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}XV({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=bi("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",vW().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xW("Browser");const h6=new Set(["localhost","127.0.0.1"]),CW="http://localhost:8000",EW="https://api.tomehub.nl",SW="https://api.tomehub.nl".trim(),AW=h6.has(window.location.hostname)?CW:EW,Kt=(SW||AW).replace(/\/+$/,""),NW="Backend baglantisi kurulamadi. `apps/backend` klasorunde `python app.py` calistirin (port 8000).";async function kW(){const{auth:t}=await $c(async()=>{const{auth:n}=await Promise.resolve().then(()=>b6);return{auth:n}},void 0),e=t.currentUser;if(!e)throw new Error("Oturum dogrulamasi bulunamadi. Lutfen tekrar giris yapin.");return e.getIdToken()}async function $n(t,e={}){var i;const n=await kW(),{auth:r}=await $c(async()=>{const{auth:c}=await Promise.resolve().then(()=>b6);return{auth:c}},void 0),s=new Headers(e.headers||{});if(s.has("Authorization")||s.set("Authorization",`Bearer ${n}`),h6.has(window.location.hostname)&&!s.has("X-Firebase-UID")){const c=(i=r.currentUser)==null?void 0:i.uid;c&&s.set("X-Firebase-UID",c)}return fetch(t,{...e,headers:s})}async function Ei(t,e){try{const n=await t.json(),r=(n==null?void 0:n.detail)||(n==null?void 0:n.details)||(n==null?void 0:n.error);if(typeof r=="string"&&r.trim())return r}catch{}return e}function Pc(t){return t instanceof TypeError&&/fetch/i.test(t.message)?`${NW} (API: ${Kt})`:t instanceof Error&&t.message?t.message:"Beklenmeyen API hatasi"}const mu=async()=>{const e=Qb().currentUser;return e?await e.getIdToken():""},Ip=t=>{const e=(t||"").toLowerCase().trim();if(e==="tr"||e==="turkish"||e==="turkce"||e==="trke")return"tr";if(e==="en"||e==="english"||e==="ingilizce")return"en"},f1=t=>({title:t.title,author:t.author,publisher:t.publisher,isbn:t.isbn,translator:t.translator,tags:t.tags,summary:t.summaryText||t.generalNotes||t.summary||"",publishedDate:t.publicationYear?String(t.publicationYear):t.publishedDate||"",url:t.url,coverUrl:t.coverUrl??null,pageCount:t.pageCount||void 0,contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved,sourceLanguageHint:Ip(t.sourceLanguageHint)}),h1=(t,e)=>{const n=(e.content_language_resolved||e.contentLanguageResolved||"").toString().toLowerCase(),r=n==="tr"||n==="en"?n:t.contentLanguageResolved,s=Number(e.language_decision_confidence??e.languageDecisionConfidence??t.languageDecisionConfidence??NaN),i=Number.isFinite(s)?s:t.languageDecisionConfidence;return{...t,summaryText:e.summary&&e.summary.trim().length>0?e.summary:t.summaryText,tags:e.tags&&e.tags.length>0?e.tags:t.tags,publisher:e.publisher||t.publisher,isbn:e.isbn||t.isbn,author:e.author||t.author,translator:e.translator||t.translator,publicationYear:e.publishedDate?String(Number(e.publishedDate)||t.publicationYear||""):t.publicationYear,coverUrl:e.coverUrl??t.coverUrl,pageCount:e.pageCount||t.pageCount||void 0,contentLanguageMode:e.contentLanguageMode||t.contentLanguageMode||"AUTO",contentLanguageResolved:r,sourceLanguageHint:Ip(e.sourceLanguageHint||t.sourceLanguageHint),languageDecisionReason:e.language_decision_reason||e.languageDecisionReason||t.languageDecisionReason,languageDecisionConfidence:i}},TW=async t=>{if(!t.trim())return[];const e=[];try{const n=`https://api.crossref.org/works?query=${encodeURIComponent(t)}&rows=5&select=title,author,publisher,published,DOI,abstract,URL`,s=await fetch(n).then(i=>i.ok?i.json():null).then(i=>{var c;return(c=i==null?void 0:i.message)!=null&&c.items?i.message.items.map(f=>{var p,g,C,v,A,T,_,M,R;return{title:Array.isArray(f.title)?f.title[0]:f.title||"",author:(g=(p=f.author)==null?void 0:p[0])!=null&&g.family?`${f.author[0].given||""} ${f.author[0].family}`.trim():((v=(C=f.author)==null?void 0:C[0])==null?void 0:v.name)||"Unknown",publisher:f.publisher||((A=f["container-title"])==null?void 0:A[0])||"",isbn:"",translator:"",tags:f.subject||[],summary:f.abstract||`DOI: ${f.DOI||""}`,publishedDate:((R=(M=(_=(T=f.published)==null?void 0:T["date-parts"])==null?void 0:_[0])==null?void 0:M[0])==null?void 0:R.toString())||"",url:f.URL||(f.DOI?`https://doi.org/${f.DOI}`:""),coverUrl:null}}):[]}).catch(()=>[]);return e.push(...s),e}catch(n){return console.error("Article search error:",n),[]}},_2=async(t,e)=>{const n=t.trim();if(!n)return[];if(e==="BOOK"){const{searchBooks:r}=await $c(async()=>{const{searchBooks:i}=await import("./bookSearchService-CDC4-bV9.js");return{searchBooks:i}},[]),s=await r(n);if(s.results.length>0)return console.log(` Results from bookSearchService (${s.source}, cached: ${s.cached})`),s.results}if(e==="ARTICLE"){const r=await TW(n);if(r.length>0)return console.log(" Results from CrossRef (fast)"),r}try{const r=await mu(),s=await fetch(`${Kt}/api/ai/search-resources`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({query:n,type:e})});if(!s.ok){const c=await s.json();throw new Error(c.detail||"Search failed")}return(await s.json()).results.map(c=>({...c,coverUrl:null,sourceLanguageHint:Ip(c.sourceLanguageHint||c.source_language_hint),contentLanguageResolved:Ip(c.contentLanguageResolved||c.content_language_resolved)}))}catch(r){return console.error("Error searching with Gemini (Backend):",r),[]}},p6=async t=>{if(t.length===0)return null;try{const e=await mu(),n=await fetch(`${Kt}/api/ai/analyze-highlights`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({highlights:t})});return n.ok&&(await n.json()).summary||null}catch(e){return console.error("Gemini error (Backend):",e),null}},ey=async t=>{if(!t)return[];try{const e=await mu(),n=await fetch(`${Kt}/api/ai/generate-tags`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({note_content:t})});return n.ok?(await n.json()).tags||[]:[]}catch(e){return console.error("Gemini tag generation error (Backend):",e),[]}},ox=async(t,e)=>{var c,f;const n=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${t}&maxResults=1`,{signal:e});if(!n.ok)throw new Error(`Google Books Error: ${n.status}`);const s=(c=(await n.json()).items)==null?void 0:c[0],i=(f=s==null?void 0:s.volumeInfo)==null?void 0:f.imageLinks;if(i!=null&&i.thumbnail||i!=null&&i.smallThumbnail){let p=i.thumbnail||i.smallThumbnail;return p=p.replace(/^http:\/\//i,"https://").replace("&edge=curl",""),p}throw new Error("No cover in Google Books result")},OW=async(t,e,n,r)=>{var f;if(n){const g=`https://covers.openlibrary.org/b/isbn/${n.replace(/[^0-9X]/gi,"")}-L.jpg`;if((await fetch(g,{method:"HEAD",signal:r})).ok)return console.log(" Cover found via OpenLibrary ISBN"),g}const s=e?`${t} ${e}`:t,i=`https://openlibrary.org/search.json?q=${encodeURIComponent(s)}&limit=1`,c=await fetch(i,{signal:r});if(c.ok){const g=(f=(await c.json()).docs)==null?void 0:f[0];if(g!=null&&g.cover_i){const C=`https://covers.openlibrary.org/b/id/${g.cover_i}-L.jpg`;return console.log(" Cover found via OpenLibrary search"),C}}throw new Error("No cover found in OpenLibrary")},_W=async(t,e,n)=>{try{const r=await mu(),s=new AbortController,i=setTimeout(()=>s.abort(),3e4),c=await fetch(`${Kt}/api/ai/verify-cover`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({title:t,author:e,isbn:n}),signal:s.signal});return clearTimeout(i),c.ok&&(await c.json()).url||null}catch(r){return r.name==="AbortError"?console.warn("AI Cover Verification timed out"):console.error("AI cover verification error (Backend):",r),null}},RW=async(t,e,n)=>{const r=n?n.replace(/[^0-9X]/gi,""):"",s=new AbortController,i=s.signal,c=[];if(r&&c.push(ox(`isbn:${r}`,i)),t&&e){const f=`intitle:${encodeURIComponent(t)}+inauthor:${encodeURIComponent(e)}`;c.push(ox(f,i))}c.push(OW(t,e,r,i)),t&&!e&&c.push(ox(`intitle:${encodeURIComponent(t)}`,i));try{const f=await Promise.any(c);return s.abort(),f}catch{console.warn("Fast cover fetch failed (all sources). Falling back to AI...");const p=await _W(t,e,n);if(p)return console.log(" Cover found via AI verification"),p}return console.log(" No verified cover found"),null},ty=async(t,e)=>{if(!((e==null?void 0:e.forceRegenerate)||m6(t)))return t;try{const r=await mu(),s={...t,content_language_mode:t.contentLanguageMode||"AUTO",source_language_hint:t.sourceLanguageHint||void 0,force_regenerate:!!(e!=null&&e.forceRegenerate)},i=await fetch(`${Kt}/api/ai/enrich-book`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(s)});if(!i.ok){const f=await i.text();return console.error(`Enrichment failed with status ${i.status}: ${f}`),t}return await i.json()}catch(r){return console.error("Enrich error (Backend):",r),t}},m6=t=>{const e=!t.summary||t.summary.trim().length<40,n=!t.tags||t.tags.length<2,r=(t.contentLanguageMode||"AUTO").toUpperCase(),s=(t.contentLanguageResolved||"").toLowerCase(),i=r==="TR"&&s!=="tr"||r==="EN"&&s!=="en"||!!t.sourceLanguageHint&&!s;return e||n||i},g6=async t=>{if(t.length===0)return[];try{const e=await mu(),n=await fetch(`${Kt}/api/ai/enrich-batch`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({books:t})});if(!n.ok||!n.body)return console.error("Batch response failed"),t;const r=n.body.getReader(),s=new TextDecoder,i=[];let c="";for(;;){const{value:f,done:p}=await r.read();if(p)break;const g=s.decode(f,{stream:!0});c+=g;const C=c.split(`
`);c=C.pop()||"";for(const v of C)if(v.trim())try{const A=JSON.parse(v);i.push(A)}catch(A){console.error("Error parsing NDJSON line:",A)}}if(c.trim())try{const f=JSON.parse(c);i.push(f)}catch(f){console.error("Error parsing final buffer:",f)}return i.length>0?i:t}catch(e){return console.error("Batch enrich error (Backend):",e),t}},I3=Object.freeze(Object.defineProperty({__proto__:null,analyzeHighlightsAI:p6,enrichBookWithAI:ty,enrichBooksBatch:g6,fetchBookCover:RW,generateTagsForNote:ey,libraryItemToDraft:f1,mergeEnrichedDraftIntoItem:h1,needsBookEnrichment:m6,searchResourcesAI:_2},Symbol.toStringTag,{value:"Module"}));var MW="firebase",IW="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vc(MW,IW,"app");const DW={apiKey:"AIzaSyDwvjdmQGhwIgAKgaVmOkOnFdMgzaJ4heA",authDomain:"tomehub.firebaseapp.com",projectId:"tomehub",storageBucket:"tomehub.firebasestorage.app",messagingSenderId:"407093539608",appId:"1:407093539608:web:dfd1e04346b49060d2246d"},LW=IT(DW),xd=Qb(LW),x6=new Ca,b6=Object.freeze(Object.defineProperty({__proto__:null,auth:xd,googleProvider:x6},Symbol.toStringTag,{value:"Module"})),y6=L.createContext(void 0),jW=({children:t})=>{const[e,n]=L.useState(null),[r,s]=L.useState(!0);L.useEffect(()=>{BG(xd).then(g=>{g&&console.log("Successfully signed in with redirect")}).catch(g=>{console.error("Redirect login error:",g)});const p=cG(xd,g=>{n(g),s(!1)});return()=>p()},[]);const f={user:e,loading:r,loginWithGoogle:async()=>{try{await _G(xd,x6)}catch(p){console.error("Login with Google failed:",p),p.code==="auth/popup-blocked"?alert("Giri penceresi engellendi. Ltfen Safari veya Chrome gibi bir taraycda an veya pop-uplara izin verin."):p.code==="auth/cancelled-popup-request"||alert("Giri hatas: "+(p.message||"Bilinmeyen bir hata olutu."))}},logout:async()=>{await uG(xd)}};return b.jsx(y6.Provider,{value:f,children:t})},p1=()=>{const t=L.useContext(y6);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},w6=t=>{const e=(t||"").trim().toUpperCase();return e==="NOTE"||e==="PERSONAL"?"PERSONAL_NOTE":e==="NOTES"?"HIGHLIGHT":e==="INSIGHTS"?"INSIGHT":e||"PERSONAL_NOTE"};async function BW(t,e,n="STANDARD",r,s="AUTO",i){if(!e)throw new Error("User must be authenticated to search");const c=await $n(`${Kt}/api/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,firebase_uid:e,mode:n,book_id:r,context_book_id:i,scope_mode:s})});if(!c.ok){const f=await c.json();throw new Error(f.details||f.error||"Search failed")}return c.json()}async function PW(t,e,n=null,r="EXPLORER",s=null,i=20,c="AUTO",f=null,p=null){if(!e)throw new Error("User must be authenticated to chat");const g=await $n(`${Kt}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,firebase_uid:e,session_id:n,mode:r,resource_type:s,scope_mode:c,book_id:f,context_book_id:p,limit:i})});if(!g.ok){const C=await g.json();throw new Error(C.details||C.error||"Chat failed")}return g.json()}async function v6(t,e,n,r,s,i){if(!r)throw new Error("User must be authenticated to ingest documents");const c=new FormData;c.append("file",t),c.append("title",e),c.append("author",n),c.append("firebase_uid",r),s&&c.append("book_id",s),i&&c.append("tags",i);const f=await $n(`${Kt}/api/ingest`,{method:"POST",body:c});if(!f.ok){const p=await f.json();throw new Error(p.details||p.error||"Ingestion failed")}return f.json()}async function FW(t){const e=await $n(`${Kt}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.details||n.error||"Feedback failed")}return e.json()}async function zW(t,e,n){if(!e)throw new Error("User must be authenticated to fetch ingestion status");const r=new URLSearchParams;r.set("firebase_uid",e),n&&n.trim()&&r.set("title",n.trim());const s=await $n(`${Kt}/api/books/${encodeURIComponent(t)}/ingestion-status?${r.toString()}`,{method:"GET",headers:{"Content-Type":"application/json","X-Firebase-UID":e}});if(!s.ok){const i=await s.json();throw new Error(i.details||i.error||"Failed to fetch ingestion status")}return s.json()}async function UW(t){const e=new FormData;e.append("file",t);const n=await $n(`${Kt}/api/extract-metadata`,{method:"POST",body:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Metadata extraction failed")}return n.json()}async function C6(t,e,n,r,s,i){const c=w6(r),f=await $n(`${Kt}/api/add-item`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,title:e,author:n,type:c,firebase_uid:s,...i})});if(!f.ok)throw new Error("Failed to add item");return f.json()}async function HW(t,e){const n=t.map(s=>({...s,type:w6(s.type)})),r=await $n(`${Kt}/api/migrate_bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n,firebase_uid:e})});if(!r.ok)throw new Error("Failed to migrate batch");return r.json()}async function E6(t,e,n,r,s){const i=s.map(f=>({...f,type:Wp(f.type)})),c=await $n(`${Kt}/api/books/${encodeURIComponent(e)}/sync-highlights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,title:n,author:r,highlights:i})});if(!c.ok){const f=await c.text();throw new Error(f||"Failed to sync highlights")}return c.json()}async function VW(t,e,n){const r=await $n(`${Kt}/api/notes/${encodeURIComponent(e)}/sync-personal-note`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,...n})});if(!r.ok){const s=await r.text();throw new Error(s||"Failed to sync personal note")}return r.json()}async function D3(t,e){const n=await $n(`${Kt}/api/resources/${encodeURIComponent(e)}/purge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t})});if(!n.ok)throw new Error("Failed to purge resource content");return n.json()}async function GW(t,e,n,r=50,s=0){const i=new URL(`${Kt}/api/analytics/concordance`);i.searchParams.append("book_id",e),i.searchParams.append("term",n),i.searchParams.append("limit",r.toString()),i.searchParams.append("offset",s.toString()),i.searchParams.append("firebase_uid",t);const c=await $n(i.toString(),{headers:{"Content-Type":"application/json"}});if(!c.ok)throw new Error("Failed to fetch concordance");return c.json()}async function WW(t,e,n){const r=new URL(`${Kt}/api/analytics/distribution`);r.searchParams.append("book_id",e),r.searchParams.append("term",n),r.searchParams.append("firebase_uid",t);const s=await $n(r.toString(),{headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch distribution");return s.json()}async function qW(t,e=0,n=100){if(!t)throw new Error("User must be authenticated for realtime polling");const r=new URL(`${Kt}/api/realtime/poll`);r.searchParams.append("firebase_uid",t),r.searchParams.append("since_ms",String(Math.max(0,Math.floor(e||0)))),r.searchParams.append("limit",String(Math.min(300,Math.max(1,Math.floor(n||100)))));const s=await $n(r.toString(),{headers:{"Content-Type":"application/json"}});if(s.status===404)throw new Error("REALTIME_ENDPOINT_NOT_FOUND");if(!s.ok){let i="Realtime polling failed";try{const c=await s.json();i=c.details||c.error||i}catch{}throw new Error(i)}return s.json()}const $W=({initialData:t,initialType:e,noteDefaults:n,onSave:r,onCancel:s})=>{const[i,c]=L.useState(t||e==="WEBSITE"||e==="PERSONAL_NOTE"?"edit":"search"),[f,p]=L.useState(""),[g,C]=L.useState([]),[v,A]=L.useState(!1),[T,_]=L.useState(!1),[M,R]=L.useState(!1),[j,H]=L.useState(!1),[G,Z]=L.useState(!1),[J,oe]=L.useState(!1),[U,ee]=L.useState(null),[X,Qe]=L.useState(!1),{user:je}=p1(),[ue,Ie]=L.useState({title:"",author:"",translator:"",publisher:"",publicationYear:"",isbn:"",url:"",code:"",status:"On Shelf",readingStatus:"To Read",tags:"",generalNotes:"",summaryText:"",coverUrl:"",lentToName:"",lentDate:"",addedAt:new Date().toISOString().split("T")[0],pageCount:"",contentLanguageMode:"AUTO",contentLanguageResolved:"",sourceLanguageHint:"",personalNoteCategory:"DAILY",personalFolderId:"",folderPath:""});L.useEffect(()=>{var K,Ce,Ae;t?Ie({title:t.title,author:t.author,translator:t.translator||"",publisher:t.publisher||"",publicationYear:t.publicationYear||"",isbn:t.isbn||"",url:t.url||"",code:t.code||"",status:t.status,readingStatus:t.readingStatus,tags:t.tags.join(", "),generalNotes:t.generalNotes||"",summaryText:t.summaryText||"",coverUrl:t.coverUrl||"",lentToName:((K=t.lentInfo)==null?void 0:K.borrowerName)||"",lentDate:((Ce=t.lentInfo)==null?void 0:Ce.lentDate)||"",addedAt:new Date(t.addedAt).toISOString().split("T")[0],pageCount:((Ae=t.pageCount)==null?void 0:Ae.toString())||"",contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved||"",sourceLanguageHint:t.sourceLanguageHint||"",personalNoteCategory:t.personalNoteCategory||"DAILY",personalFolderId:t.personalFolderId||"",folderPath:t.folderPath||""}):e==="PERSONAL_NOTE"&&Ie(ze=>({...ze,author:"Self",status:"On Shelf",readingStatus:"Finished",personalNoteCategory:(n==null?void 0:n.personalNoteCategory)||"DAILY",personalFolderId:(n==null?void 0:n.personalFolderId)||"",folderPath:(n==null?void 0:n.folderPath)||""}))},[t,e,n]);const Ze=async K=>{if(K.preventDefault(),!!f.trim()){A(!0),C([]);try{const Ce=await _2(f,e);C(Ce),e==="BOOK"&&console.log(` Search completed for book: "${f}"`)}catch(Ce){console.error("Search failed:",Ce)}finally{A(!1)}}},ne=async()=>{const K=Jc(ue.generalNotes);if(!K)return;H(!0);const Ce=await ey(K);Ce.length>0&&Ie(Ae=>({...Ae,tags:Ce.join(", ")})),H(!1)},ie=async(K,Ce,Ae)=>{_(!0);try{const{fetchBookCover:ze}=await $c(async()=>{const{fetchBookCover:ot}=await Promise.resolve().then(()=>I3);return{fetchBookCover:ot}},void 0),rt=await ze(K,Ce,Ae);rt&&Ie(ot=>({...ot,coverUrl:rt}))}catch(ze){console.error("Cover fetch failed:",ze)}finally{_(!1)}},pe=async(K,Ce=!1)=>{R(!0);try{const{enrichBookWithAI:Ae}=await $c(async()=>{const{enrichBookWithAI:rt}=await Promise.resolve().then(()=>I3);return{enrichBookWithAI:rt}},void 0),ze=await Ae({...K,contentLanguageMode:ue.contentLanguageMode,sourceLanguageHint:ue.sourceLanguageHint||K.sourceLanguageHint},{forceRegenerate:Ce});Ie(rt=>({...rt,tags:ze.tags&&ze.tags.length>0?ze.tags.join(", "):rt.tags,summaryText:ze.summary&&ze.summary.length>0?ze.summary:rt.summaryText,publisher:ze.publisher||rt.publisher,publicationYear:ze.publishedDate?String(ze.publishedDate):rt.publicationYear,isbn:ze.isbn||rt.isbn,pageCount:ze.pageCount?String(ze.pageCount):rt.pageCount,translator:ze.translator||rt.translator,contentLanguageResolved:ze.content_language_resolved||ze.contentLanguageResolved||rt.contentLanguageResolved||""}))}catch(Ae){console.error("Enrichment failed",Ae)}finally{R(!1)}},me=async K=>{Ie(Ce=>{var Ae;return{...Ce,title:K.title,author:K.author,publisher:K.publisher||"",isbn:K.isbn||"",publicationYear:K.publishedDate||"",translator:K.translator||"",tags:K.tags?K.tags.join(", "):"",summaryText:K.summary||"",coverUrl:K.coverUrl||"",url:(e==="WEBSITE"||e==="ARTICLE")&&K.url||"",pageCount:((Ae=K.pageCount)==null?void 0:Ae.toString())||"",contentLanguageMode:K.contentLanguageMode||ue.contentLanguageMode||"AUTO",contentLanguageResolved:(K.contentLanguageResolved||"").toLowerCase()==="tr"?"tr":(K.contentLanguageResolved||"").toLowerCase()==="en"?"en":"",sourceLanguageHint:(K.sourceLanguageHint||"").toLowerCase()==="tr"?"tr":(K.sourceLanguageHint||"").toLowerCase()==="en"?"en":""}}),c("edit"),e==="BOOK"&&(ie(K.title,K.author,K.isbn||""),(!K.summary||!K.tags||K.tags.length===0||K.sourceLanguageHint)&&pe(K))},Y=K=>{const{name:Ce,value:Ae}=K.target;Ie(ze=>Ce==="contentLanguageMode"?{...ze,[Ce]:Ae,contentLanguageResolved:""}:{...ze,[Ce]:Ae})},le=async K=>{if(K.target.files&&K.target.files[0]){const Ce=K.target.files[0];if(Ce.type==="application/pdf"){ee(Ce),oe(!0);try{const Ae=await UW(Ce);Ie(ze=>{var rt;return{...ze,title:ze.title||Ae.title||"",author:ze.author||Ae.author||"",pageCount:ze.pageCount||((rt=Ae.page_count)==null?void 0:rt.toString())||""}}),!ue.title&&Ae.title&&e==="BOOK"&&!ue.coverUrl&&ie(Ae.title,Ae.author||"","")}catch(Ae){console.error("Failed to extract PDF metadata:",Ae)}finally{oe(!1)}}else alert("Please select a PDF file"),K.target.value=""}},V=async K=>{K.preventDefault();const Ce=t?t.id:Date.now().toString();if(U&&je){Z(!0);try{await v6(U,ue.title,ue.author,je.uid,Ce,ue.tags)}catch(rt){console.error("PDF Ingestion failed:",rt)}finally{Z(!1)}}const Ae=e==="BOOK"&&ue.status==="Lent Out"&&ue.lentToName?{borrowerName:ue.lentToName,lentDate:ue.lentDate||new Date().toISOString().split("T")[0]}:void 0,ze=ue.addedAt?new Date(ue.addedAt).getTime():Date.now();r({id:Ce,type:e,title:ue.title,author:ue.author,translator:ue.translator,publisher:ue.publisher,publicationYear:ue.publicationYear,isbn:ue.isbn,url:e==="WEBSITE"||e==="ARTICLE"?ue.url:"",code:ue.code,status:ue.status,readingStatus:ue.readingStatus,tags:ue.tags.split(",").map(rt=>rt.trim()).filter(rt=>rt.length>0),generalNotes:ge?ue.generalNotes:"",summaryText:ge?"":ue.summaryText,contentLanguageMode:ue.contentLanguageMode,contentLanguageResolved:ue.contentLanguageResolved||void 0,sourceLanguageHint:ue.sourceLanguageHint||void 0,personalNoteCategory:ge?ue.personalNoteCategory:void 0,personalFolderId:ge&&ue.personalFolderId.trim()||void 0,folderPath:ge&&ue.folderPath.trim()||void 0,coverUrl:ue.coverUrl,lentInfo:Ae,addedAt:ze,pageCount:ue.pageCount?parseInt(ue.pageCount):void 0})},te=()=>{switch(e){case"ARTICLE":return b.jsx(sf,{className:"text-[#CC561E]",size:24});case"WEBSITE":return b.jsx(Fp,{className:"text-[#CC561E]",size:24});case"PERSONAL_NOTE":return b.jsx(v0,{className:"text-[#CC561E]",size:24});default:return b.jsx(F2,{className:"text-[#CC561E]",size:24})}},fe=()=>{if(t)return"Edit Details";switch(e){case"ARTICLE":return"New Article";case"WEBSITE":return"New Website Resource";case"PERSONAL_NOTE":return"New Note";default:return"New Book"}},ge=e==="PERSONAL_NOTE",We=ge?"text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300",se=ge?"text-slate-800 dark:text-slate-200":"text-slate-700 dark:text-slate-300",Be=ge?"text-slate-700 dark:text-slate-400":"text-slate-500 dark:text-slate-400";return b.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:b.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full overflow-hidden flex flex-col ${ge?"max-w-3xl max-h-[94vh]":"max-w-2xl max-h-[90vh]"}`,children:[b.jsxs("div",{className:`${ge?"p-4":"p-5"} border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white dark:bg-slate-900 z-10`,children:[b.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:i==="search"?b.jsxs(b.Fragment,{children:[b.jsx(Ea,{className:"text-[#CC561E]",size:24}),"Find ",e==="ARTICLE"?"Article":"Book"]}):b.jsxs(b.Fragment,{children:[te(),fe()]})}),b.jsx("button",{onClick:s,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:b.jsx(wi,{size:24})})]}),i==="search"&&b.jsxs("div",{className:"p-6 flex flex-col h-full overflow-y-auto",children:[b.jsxs("form",{onSubmit:Ze,className:"relative mb-4",children:[b.jsx("input",{autoFocus:!0,type:"text",value:f,onChange:K=>p(K.target.value),placeholder:e==="ARTICLE"?"Enter Title, DOI, Author...":"Enter Title, ISBN, Author...",className:"w-full pl-5 pr-28 py-4 text-lg border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:border-[#CC561E] dark:focus:border-[#CC561E] focus:ring-4 focus:ring-[#CC561E]/10 outline-none transition-all placeholder:text-slate-400 dark:placeholder:text-slate-500 bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),b.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1.5",children:[e==="BOOK"&&b.jsx("button",{type:"button",onClick:()=>Qe(!0),className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 p-2 rounded-lg hover:bg-[#CC561E]/10 hover:text-[#CC561E] dark:hover:bg-[#CC561E]/20 dark:hover:text-[#f3a47b] transition-colors",title:"Scan ISBN barcode with camera",children:b.jsx(jl,{size:20})}),b.jsx("button",{type:"submit",disabled:v||!f.trim(),className:"bg-[#CC561E] text-white p-2 rounded-lg hover:bg-[#b34b1a] disabled:opacity-50 disabled:hover:bg-[#CC561E] transition-colors",children:v?b.jsx(mr,{className:"animate-spin",size:20}):b.jsx(Ea,{size:20})})]})]}),X&&b.jsx(s3,{onDetected:K=>{Qe(!1),p(K),A(!0),C([]),_2(K,e).then(Ce=>C(Ce)).catch(Ce=>console.error("Barcode search failed:",Ce)).finally(()=>A(!1))},onClose:()=>Qe(!1)}),b.jsx("div",{className:"space-y-3 flex-1 mt-6",children:g.length>0?b.jsxs(b.Fragment,{children:[b.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"Matches Found"}),g.map((K,Ce)=>b.jsxs("button",{onClick:()=>me(K),className:"w-full text-left p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 dark:hover:border-[#CC561E]/50 hover:shadow-md hover:bg-[rgba(204,86,30,0.05)] dark:hover:bg-[rgba(204,86,30,0.1)] transition-all group flex justify-between items-center",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:K.title}),b.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:K.author}),b.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-slate-400",children:[K.publisher&&b.jsx("span",{children:K.publisher}),K.publishedDate&&b.jsx("span",{children:K.publishedDate}),K.isbn&&b.jsxs("span",{className:"font-mono tracking-tight",children:["ISBN: ",K.isbn]})]})]}),b.jsx(_A,{className:"text-slate-300 dark:text-slate-600 group-hover:text-[#CC561E]",size:20})]},Ce))]}):!v&&f&&b.jsxs("div",{className:"text-center py-10 text-slate-500",children:[b.jsxs("p",{children:['No AI results found matching "',f,'".']}),b.jsx("p",{className:"text-sm mt-2",children:"Try entering details manually."})]})}),b.jsx("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:b.jsxs("button",{onClick:()=>c("edit"),className:"text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] text-sm font-medium flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[b.jsx("span",{children:"Don't see it? Enter details manually"}),b.jsx(zR,{size:16})]})})]}),i==="edit"&&b.jsxs("form",{onSubmit:V,className:`${ge?"p-4 md:p-5":"p-6"} overflow-y-auto flex-1`,children:[b.jsxs("div",{className:ge?"space-y-3":"space-y-5",children:[b.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${ge?"gap-3":"gap-4"}`,children:[b.jsxs("div",{className:"md:col-span-2",children:[b.jsx("label",{className:`block text-sm font-medium mb-1 ${We}`,children:"Title *"}),b.jsx("input",{required:!0,name:"title",value:ue.title,onChange:Y,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${ge?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:ge?"Note Title":e==="WEBSITE"?"Page Title or Site Name":"e.g. The Stranger"})]}),!ge&&b.jsxs("div",{className:e==="WEBSITE"?"md:col-span-2":"",children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="WEBSITE"?"Author / Organization":"Author *"}),b.jsx("input",{required:e!=="WEBSITE",name:"author",value:ue.author,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Albert Camus"})]}),ge&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{children:[b.jsxs("label",{className:`block text-[13px] font-medium mb-1 flex items-center gap-1 ${se}`,children:[b.jsx(Xc,{size:14,className:"text-slate-400"}),"Date"]}),b.jsx("input",{type:"date",name:"addedAt",value:ue.addedAt,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),b.jsxs("div",{children:[b.jsx("label",{className:`block text-[13px] font-medium mb-1 ${se}`,children:"Category"}),b.jsxs("select",{name:"personalNoteCategory",value:ue.personalNoteCategory,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[b.jsx("option",{value:"PRIVATE",children:"Private"}),b.jsx("option",{value:"DAILY",children:"Daily"}),b.jsx("option",{value:"IDEAS",children:"Ideas"})]}),b.jsx("p",{className:`mt-0.5 text-[10px] leading-tight ${Be}`,children:"Private/Daily sadece local aramada kalir. Ideas AI aramalara da katilir."})]})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Translator"}),b.jsx("input",{name:"translator",value:ue.translator,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Content Language"}),b.jsxs("select",{name:"contentLanguageMode",value:ue.contentLanguageMode,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[b.jsx("option",{value:"AUTO",children:"AUTO (Recommended)"}),b.jsx("option",{value:"TR",children:"TR"}),b.jsx("option",{value:"EN",children:"EN"})]}),(ue.contentLanguageResolved||ue.sourceLanguageHint)&&b.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:["Resolved: ",ue.contentLanguageResolved||"-"," | Source Hint: ",ue.sourceLanguageHint||"-"]})]})]}),!ge&&b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e!=="WEBSITE"&&b.jsxs("div",{className:e==="ARTICLE"?"md:col-span-2":"",children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="ARTICLE"?"Journal / Publisher":"Publisher"}),b.jsx("input",{name:"publisher",value:ue.publisher,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ISBN"}),b.jsxs("div",{className:"flex gap-1.5",children:[b.jsx("input",{name:"isbn",value:ue.isbn,onChange:Y,className:"flex-1 border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),b.jsx("button",{type:"button",onClick:()=>Qe(!0),className:"px-2.5 border border-slate-300 dark:border-slate-700 rounded-lg text-slate-500 dark:text-slate-400 hover:text-[#CC561E] hover:border-[#CC561E]/50 dark:hover:text-[#f3a47b] dark:hover:border-[#CC561E]/50 transition-colors",title:"Scan ISBN barcode",children:b.jsx(jl,{size:18})})]}),X&&b.jsx(s3,{onDetected:K=>{Qe(!1),Ie(Ce=>({...Ce,isbn:K}))},onClose:()=>Qe(!1)})]}),e==="ARTICLE"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Year"}),b.jsx("input",{name:"publicationYear",value:ue.publicationYear,onChange:Y,placeholder:"YYYY",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Page Count"}),b.jsx("input",{type:"number",name:"pageCount",value:ue.pageCount,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. 250"})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Shelf Code"}),b.jsx("input",{name:"code",value:ue.code,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. A-12"})]})]}),(e==="WEBSITE"||e==="ARTICLE")&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"URL"}),b.jsx("input",{name:"url",value:ue.url,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-[#CC561E] dark:text-[#f3a47b] bg-white dark:bg-slate-950",placeholder:"https://..."})]}),ge&&b.jsxs("div",{children:[b.jsx("label",{className:`block text-sm font-medium mb-1 ${We}`,children:"Sub-file (optional)"}),b.jsx("input",{name:"folderPath",value:ue.folderPath,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Sermon Ideas or Journal-2026-Week1"})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 flex items-center justify-between",children:b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(OC,{size:16}),"Cover Image URL"]})}),b.jsxs("div",{className:"flex gap-4 items-start",children:[b.jsxs("div",{className:"flex-1 relative",children:[b.jsx("input",{name:"coverUrl",value:ue.coverUrl,onChange:Y,placeholder:"Paste image URL or Auto-Find ->",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg pl-3 pr-24 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-sm text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-950"}),b.jsxs("button",{type:"button",onClick:()=>ie(ue.title,ue.author,ue.isbn),disabled:T||!ue.title&&!ue.isbn,className:"absolute right-1 top-1 bottom-1 px-3 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] hover:bg-[rgba(204,86,30,0.15)] dark:hover:bg-[rgba(204,86,30,0.25)] text-[#CC561E] dark:text-[#f3a47b] rounded text-xs font-semibold flex items-center gap-1 transition-colors",title:"Auto-find cover based on Title/ISBN",children:[T?b.jsx(mr,{size:14,className:"animate-spin"}):b.jsx(hM,{size:14}),"Auto-Find"]})]}),b.jsxs("div",{className:"w-16 h-20 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0 shadow-sm relative group",children:[ue.coverUrl?b.jsx("img",{src:ue.coverUrl,alt:"Preview",className:"w-full h-full object-cover",onError:K=>K.currentTarget.style.display="none"}):b.jsx(OC,{className:"text-slate-300",size:20}),T&&b.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center backdrop-blur-[1px]",children:b.jsx(mr,{size:16,className:"animate-spin text-[#CC561E]"})}),!T&&!ue.coverUrl&&b.jsx("div",{className:"absolute inset-0 bg-black/5 hidden group-hover:flex items-center justify-center",children:b.jsx(Ea,{size:12,className:"text-slate-500"})})]})]}),b.jsx("div",{className:"mt-1 flex justify-end",children:b.jsxs("a",{href:`https://www.google.com/search?tbm=isch&q=book+cover+${encodeURIComponent(ue.title+" "+ue.author)}`,target:"_blank",rel:"noreferrer",className:"text-xs text-slate-400 dark:text-slate-500 hover:text-[#CC561E] dark:hover:text-[#f3a47b] hover:underline flex items-center gap-1",children:["Manual Search on Google Images ",b.jsx(Ea,{size:10})]})})]}),(e==="BOOK"||e==="ARTICLE")&&b.jsxs("div",{className:"bg-[rgba(204,86,30,0.05)] dark:bg-[rgba(204,86,30,0.1)] p-4 rounded-xl border border-[#CC561E]/10 dark:border-[#CC561E]/20",children:[b.jsxs("label",{className:"block text-sm font-semibold text-[#CC561E] dark:text-[#f3a47b] mb-2 flex items-center gap-2",children:[b.jsx(E0,{size:16}),"Upload PDF Document to Library"]}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("input",{type:"file",accept:".pdf",onChange:le,className:"flex-1 text-sm text-slate-600 dark:text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[#CC561E] file:text-white hover:file:bg-[#b34b1a] transition-all cursor-pointer"}),U&&b.jsx("button",{type:"button",onClick:()=>ee(null),className:"text-red-500 hover:text-red-600 p-2",title:"Remove PDF",children:b.jsx(wi,{size:18})}),J&&b.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[#CC561E] font-medium animate-pulse",children:[b.jsx(mr,{size:14,className:"animate-spin"}),"Verifying metadata..."]})]}),b.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-2",children:"PDF content will be vectorized and added to your searchable AI library."})]})]}),b.jsx("hr",{className:`${ge?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),ge&&b.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[b.jsx("label",{className:`block text-sm font-medium mb-1 ${We}`,children:"Content"}),b.jsx(yT,{value:ue.generalNotes,onChange:K=>Ie(Ce=>({...Ce,generalNotes:K})),minHeight:420}),b.jsx("p",{className:`mt-1 text-[10px] ${Be}`,children:"Toolbar supports heading, bold, underline, bullet list, numbered list and checklist."})]}),b.jsxs("div",{className:ge?"space-y-3":"space-y-5",children:[!ge&&b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Reading Status *"}),b.jsxs("select",{name:"readingStatus",value:ue.readingStatus,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[b.jsx("option",{value:"To Read",children:"To Read"}),b.jsx("option",{value:"Reading",children:"Reading"}),b.jsx("option",{value:"Finished",children:"Finished"})]})]}),e==="BOOK"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Inventory Status *"}),b.jsxs("select",{name:"status",value:ue.status,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[b.jsx("option",{value:"On Shelf",children:"On Shelf"}),b.jsx("option",{value:"Lent Out",children:"Lent Out"}),b.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),b.jsxs("div",{className:"relative",children:[b.jsxs("label",{className:`block text-sm font-medium mb-1 flex justify-between ${We}`,children:[b.jsxs("div",{className:"flex items-center gap-2",children:["Tags (comma separated)",M&&b.jsxs("span",{className:"text-xs text-[#CC561E] animate-pulse flex items-center gap-1",children:[b.jsx(ka,{size:10})," AI Enriching..."]})]}),ge&&b.jsxs("button",{type:"button",onClick:ne,disabled:j||!M0(ue.generalNotes),className:"text-xs text-[#CC561E] dark:text-[#f3a47b] hover:text-[#b34b1a] dark:hover:text-white flex items-center gap-1 disabled:opacity-50",children:[j?b.jsx(mr,{size:12,className:"animate-spin"}):b.jsx(ka,{size:12}),"AI Auto-Tag"]})]}),b.jsx("input",{name:"tags",value:ue.tags,onChange:Y,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${ge?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:ge?"Use AI to generate tags...":"Ideas, Todo, Research"})]}),e==="BOOK"&&ue.status==="Lent Out"&&b.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 grid grid-cols-1 md:grid-cols-2 gap-4 animate-in slide-in-from-top-2",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Lent To (Name) *"}),b.jsx("input",{required:!0,name:"lentToName",value:ue.lentToName,onChange:Y,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Date"}),b.jsx("input",{type:"date",name:"lentDate",value:ue.lentDate,onChange:Y,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]})]})]}),b.jsx("hr",{className:`${ge?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),!ge&&b.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[b.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Summary"}),b.jsx("textarea",{name:"summaryText",rows:4,value:ue.summaryText,onChange:Y,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] resize-none leading-relaxed flex-1 bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:e==="WEBSITE"?"Why did you save this website?":"Your thoughts..."})]}),b.jsxs("div",{className:`flex justify-between items-center ${ge?"pt-1":"pt-2"} mt-auto`,children:[!t&&e!=="WEBSITE"&&!ge&&b.jsx("button",{type:"button",onClick:()=>c("search"),className:"text-sm text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] underline decoration-[#CC561E]/30 dark:decoration-[#CC561E]/50 hover:decoration-[#CC561E] dark:hover:decoration-[#CC561E]",children:"Back to Search"}),b.jsxs("div",{className:"flex gap-3 ml-auto",children:[b.jsx("button",{type:"button",onClick:s,className:"px-5 py-2 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium",children:"Cancel"}),b.jsx("button",{type:"submit",disabled:G,className:"px-5 py-2 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg shadow-lg shadow-[#CC561E]/20 transition-all font-medium flex items-center gap-2 active:scale-95",children:G?b.jsxs(b.Fragment,{children:[b.jsx(mr,{size:18,className:"animate-spin"}),"Ingesting PDF..."]}):b.jsxs(b.Fragment,{children:["Save ",e==="ARTICLE"?"Article":e==="WEBSITE"?"Website":e==="PERSONAL_NOTE"?"Note":"Book"]})})]})]})]})]})})};var lx={exports:{}},L3;function XW(){return L3||(L3=1,(function(t){var e=(function(n){var r=Object.prototype,s=r.hasOwnProperty,i=Object.defineProperty||function(Y,le,V){Y[le]=V.value},c,f=typeof Symbol=="function"?Symbol:{},p=f.iterator||"@@iterator",g=f.asyncIterator||"@@asyncIterator",C=f.toStringTag||"@@toStringTag";function v(Y,le,V){return Object.defineProperty(Y,le,{value:V,enumerable:!0,configurable:!0,writable:!0}),Y[le]}try{v({},"")}catch{v=function(le,V,te){return le[V]=te}}function A(Y,le,V,te){var fe=le&&le.prototype instanceof G?le:G,ge=Object.create(fe.prototype),We=new ie(te||[]);return i(ge,"_invoke",{value:ue(Y,V,We)}),ge}n.wrap=A;function T(Y,le,V){try{return{type:"normal",arg:Y.call(le,V)}}catch(te){return{type:"throw",arg:te}}}var _="suspendedStart",M="suspendedYield",R="executing",j="completed",H={};function G(){}function Z(){}function J(){}var oe={};v(oe,p,function(){return this});var U=Object.getPrototypeOf,ee=U&&U(U(pe([])));ee&&ee!==r&&s.call(ee,p)&&(oe=ee);var X=J.prototype=G.prototype=Object.create(oe);Z.prototype=J,i(X,"constructor",{value:J,configurable:!0}),i(J,"constructor",{value:Z,configurable:!0}),Z.displayName=v(J,C,"GeneratorFunction");function Qe(Y){["next","throw","return"].forEach(function(le){v(Y,le,function(V){return this._invoke(le,V)})})}n.isGeneratorFunction=function(Y){var le=typeof Y=="function"&&Y.constructor;return le?le===Z||(le.displayName||le.name)==="GeneratorFunction":!1},n.mark=function(Y){return Object.setPrototypeOf?Object.setPrototypeOf(Y,J):(Y.__proto__=J,v(Y,C,"GeneratorFunction")),Y.prototype=Object.create(X),Y},n.awrap=function(Y){return{__await:Y}};function je(Y,le){function V(ge,We,se,Be){var K=T(Y[ge],Y,We);if(K.type==="throw")Be(K.arg);else{var Ce=K.arg,Ae=Ce.value;return Ae&&typeof Ae=="object"&&s.call(Ae,"__await")?le.resolve(Ae.__await).then(function(ze){V("next",ze,se,Be)},function(ze){V("throw",ze,se,Be)}):le.resolve(Ae).then(function(ze){Ce.value=ze,se(Ce)},function(ze){return V("throw",ze,se,Be)})}}var te;function fe(ge,We){function se(){return new le(function(Be,K){V(ge,We,Be,K)})}return te=te?te.then(se,se):se()}i(this,"_invoke",{value:fe})}Qe(je.prototype),v(je.prototype,g,function(){return this}),n.AsyncIterator=je,n.async=function(Y,le,V,te,fe){fe===void 0&&(fe=Promise);var ge=new je(A(Y,le,V,te),fe);return n.isGeneratorFunction(le)?ge:ge.next().then(function(We){return We.done?We.value:ge.next()})};function ue(Y,le,V){var te=_;return function(ge,We){if(te===R)throw new Error("Generator is already running");if(te===j){if(ge==="throw")throw We;return me()}for(V.method=ge,V.arg=We;;){var se=V.delegate;if(se){var Be=Ie(se,V);if(Be){if(Be===H)continue;return Be}}if(V.method==="next")V.sent=V._sent=V.arg;else if(V.method==="throw"){if(te===_)throw te=j,V.arg;V.dispatchException(V.arg)}else V.method==="return"&&V.abrupt("return",V.arg);te=R;var K=T(Y,le,V);if(K.type==="normal"){if(te=V.done?j:M,K.arg===H)continue;return{value:K.arg,done:V.done}}else K.type==="throw"&&(te=j,V.method="throw",V.arg=K.arg)}}}function Ie(Y,le){var V=le.method,te=Y.iterator[V];if(te===c)return le.delegate=null,V==="throw"&&Y.iterator.return&&(le.method="return",le.arg=c,Ie(Y,le),le.method==="throw")||V!=="return"&&(le.method="throw",le.arg=new TypeError("The iterator does not provide a '"+V+"' method")),H;var fe=T(te,Y.iterator,le.arg);if(fe.type==="throw")return le.method="throw",le.arg=fe.arg,le.delegate=null,H;var ge=fe.arg;if(!ge)return le.method="throw",le.arg=new TypeError("iterator result is not an object"),le.delegate=null,H;if(ge.done)le[Y.resultName]=ge.value,le.next=Y.nextLoc,le.method!=="return"&&(le.method="next",le.arg=c);else return ge;return le.delegate=null,H}Qe(X),v(X,C,"Generator"),v(X,p,function(){return this}),v(X,"toString",function(){return"[object Generator]"});function Ze(Y){var le={tryLoc:Y[0]};1 in Y&&(le.catchLoc=Y[1]),2 in Y&&(le.finallyLoc=Y[2],le.afterLoc=Y[3]),this.tryEntries.push(le)}function ne(Y){var le=Y.completion||{};le.type="normal",delete le.arg,Y.completion=le}function ie(Y){this.tryEntries=[{tryLoc:"root"}],Y.forEach(Ze,this),this.reset(!0)}n.keys=function(Y){var le=Object(Y),V=[];for(var te in le)V.push(te);return V.reverse(),function fe(){for(;V.length;){var ge=V.pop();if(ge in le)return fe.value=ge,fe.done=!1,fe}return fe.done=!0,fe}};function pe(Y){if(Y){var le=Y[p];if(le)return le.call(Y);if(typeof Y.next=="function")return Y;if(!isNaN(Y.length)){var V=-1,te=function fe(){for(;++V<Y.length;)if(s.call(Y,V))return fe.value=Y[V],fe.done=!1,fe;return fe.value=c,fe.done=!0,fe};return te.next=te}}return{next:me}}n.values=pe;function me(){return{value:c,done:!0}}return ie.prototype={constructor:ie,reset:function(Y){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(ne),!Y)for(var le in this)le.charAt(0)==="t"&&s.call(this,le)&&!isNaN(+le.slice(1))&&(this[le]=c)},stop:function(){this.done=!0;var Y=this.tryEntries[0],le=Y.completion;if(le.type==="throw")throw le.arg;return this.rval},dispatchException:function(Y){if(this.done)throw Y;var le=this;function V(Be,K){return ge.type="throw",ge.arg=Y,le.next=Be,K&&(le.method="next",le.arg=c),!!K}for(var te=this.tryEntries.length-1;te>=0;--te){var fe=this.tryEntries[te],ge=fe.completion;if(fe.tryLoc==="root")return V("end");if(fe.tryLoc<=this.prev){var We=s.call(fe,"catchLoc"),se=s.call(fe,"finallyLoc");if(We&&se){if(this.prev<fe.catchLoc)return V(fe.catchLoc,!0);if(this.prev<fe.finallyLoc)return V(fe.finallyLoc)}else if(We){if(this.prev<fe.catchLoc)return V(fe.catchLoc,!0)}else if(se){if(this.prev<fe.finallyLoc)return V(fe.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Y,le){for(var V=this.tryEntries.length-1;V>=0;--V){var te=this.tryEntries[V];if(te.tryLoc<=this.prev&&s.call(te,"finallyLoc")&&this.prev<te.finallyLoc){var fe=te;break}}fe&&(Y==="break"||Y==="continue")&&fe.tryLoc<=le&&le<=fe.finallyLoc&&(fe=null);var ge=fe?fe.completion:{};return ge.type=Y,ge.arg=le,fe?(this.method="next",this.next=fe.finallyLoc,H):this.complete(ge)},complete:function(Y,le){if(Y.type==="throw")throw Y.arg;return Y.type==="break"||Y.type==="continue"?this.next=Y.arg:Y.type==="return"?(this.rval=this.arg=Y.arg,this.method="return",this.next="end"):Y.type==="normal"&&le&&(this.next=le),H},finish:function(Y){for(var le=this.tryEntries.length-1;le>=0;--le){var V=this.tryEntries[le];if(V.finallyLoc===Y)return this.complete(V.completion,V.afterLoc),ne(V),H}},catch:function(Y){for(var le=this.tryEntries.length-1;le>=0;--le){var V=this.tryEntries[le];if(V.tryLoc===Y){var te=V.completion;if(te.type==="throw"){var fe=te.arg;ne(V)}return fe}}throw new Error("illegal catch attempt")},delegateYield:function(Y,le,V){return this.delegate={iterator:pe(Y),resultName:le,nextLoc:V},this.method==="next"&&(this.arg=c),H}},n})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(lx)),lx.exports}var cx,j3;function ny(){return j3||(j3=1,cx=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),cx}var ux,B3;function S6(){if(B3)return ux;B3=1;const t=ny();let e=0;return ux=({id:n,action:r,payload:s={}})=>{let i=n;return typeof i>"u"&&(i=t("Job",e),e+=1),{id:i,action:r,payload:s}},ux}var ud={},P3;function ry(){if(P3)return ud;P3=1;let t=!1;return ud.logging=t,ud.setLogging=e=>{t=e},ud.log=(...e)=>t?console.log.apply(this,e):null,ud}var dx,F3;function YW(){if(F3)return dx;F3=1;const t=S6(),{log:e}=ry(),n=ny();let r=0;return dx=()=>{const s=n("Scheduler",r),i={},c={};let f=[];r+=1;const p=()=>f.length,g=()=>Object.keys(i).length,C=()=>{if(f.length!==0){const M=Object.keys(i);for(let R=0;R<M.length;R+=1)if(typeof c[M[R]]>"u"){f[0](i[M[R]]);break}}},v=(M,R)=>new Promise((j,H)=>{const G=t({action:M,payload:R});f.push(async Z=>{f.shift(),c[Z.id]=G;try{j(await Z[M].apply(this,[...R,G.id]))}catch(J){H(J)}finally{delete c[Z.id],C()}}),e(`[${s}]: Add ${G.id} to JobQueue`),e(`[${s}]: JobQueue length=${f.length}`),C()});return{addWorker:M=>(i[M.id]=M,e(`[${s}]: Add ${M.id}`),e(`[${s}]: Number of workers=${g()}`),C(),M.id),addJob:async(M,...R)=>{if(g()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return v(M,R)},terminate:async()=>{Object.keys(i).forEach(async M=>{await i[M].terminate()}),f=[]},getQueueLen:p,getNumWorkers:g}},dx}function KW(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fx,z3;function ZW(){return z3||(z3=1,fx=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof KW=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),fx}var hx,U3;function JW(){if(U3)return hx;U3=1;const e=ZW()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return hx=n=>{const r={...n};return["corePath","workerPath","langPath"].forEach(s=>{n[s]&&(r[s]=e(r[s]))}),r},hx}var px,H3;function A6(){return H3||(H3=1,px={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),px}const QW="7.0.0",eq={version:QW};var mx,V3;function tq(){return V3||(V3=1,mx={workerBlobURL:!0,logger:()=>{}}),mx}var gx,G3;function nq(){if(G3)return gx;G3=1;const t=eq.version;return gx={...tq(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},gx}var xx,W3;function rq(){return W3||(W3=1,xx=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n}),xx}var bx,q3;function sq(){return q3||(q3=1,bx=t=>{t.terminate()}),bx}var yx,$3;function iq(){return $3||($3=1,yx=(t,e)=>{t.onmessage=({data:n})=>{e(n)}}),yx}var wx,X3;function aq(){return X3||(X3=1,wx=async(t,e)=>{t.postMessage(e)}),wx}var vx,Y3;function oq(){if(Y3)return vx;Y3=1;const t=n=>new Promise((r,s)=>{const i=new FileReader;i.onload=()=>{r(i.result)},i.onerror=({target:{error:{code:c}}})=>{s(Error(`File could not be read! Code=${c}`))},i.readAsArrayBuffer(n)}),e=async n=>{let r=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?r=atob(n.split(",")[1]).split("").map(s=>s.charCodeAt(0)):r=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(r=await e(n.src)),n.tagName==="VIDEO"&&(r=await e(n.poster)),n.tagName==="CANVAS"&&await new Promise(s=>{n.toBlob(async i=>{r=await t(i),s()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const s=await n.convertToBlob();r=await t(s)}else(n instanceof File||n instanceof Blob)&&(r=await t(n));return new Uint8Array(r)};return vx=e,vx}var Cx,K3;function lq(){if(K3)return Cx;K3=1;const t=nq(),e=rq(),n=sq(),r=iq(),s=aq(),i=oq();return Cx={defaultOptions:t,spawnWorker:e,terminateWorker:n,onMessage:r,send:s,loadImage:i},Cx}var Ex,Z3;function N6(){if(Z3)return Ex;Z3=1;const t=JW(),e=S6(),{log:n}=ry(),r=ny(),s=A6(),{defaultOptions:i,spawnWorker:c,terminateWorker:f,onMessage:p,loadImage:g,send:C}=lq();let v=0;return Ex=async(A="eng",T=s.LSTM_ONLY,_={},M={})=>{const R=r("Worker",v),{logger:j,errorHandler:H,...G}=t({...i,..._}),Z={},J=typeof A=="string"?A.split("+"):A;let oe=T,U=M;const ee=[s.DEFAULT,s.LSTM_ONLY].includes(T)&&!G.legacyCore;let X,Qe;const je=new Promise((Ce,Ae)=>{Qe=Ce,X=Ae}),ue=Ce=>{X(Ce.message)};let Ie=c(G);Ie.onerror=ue,v+=1;const Ze=({id:Ce,action:Ae,payload:ze})=>new Promise((rt,ot)=>{n(`[${R}]: Start ${Ce}, action=${Ae}`);const gt=`${Ae}-${Ce}`;Z[gt]={resolve:rt,reject:ot},C(Ie,{workerId:R,jobId:Ce,action:Ae,payload:ze})}),ne=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),ie=Ce=>Ze(e({id:Ce,action:"load",payload:{options:{lstmOnly:ee,corePath:G.corePath,logging:G.logging}}})),pe=(Ce,Ae,ze)=>Ze(e({id:ze,action:"FS",payload:{method:"writeFile",args:[Ce,Ae]}})),me=(Ce,Ae)=>Ze(e({id:Ae,action:"FS",payload:{method:"readFile",args:[Ce,{encoding:"utf8"}]}})),Y=(Ce,Ae)=>Ze(e({id:Ae,action:"FS",payload:{method:"unlink",args:[Ce]}})),le=(Ce,Ae,ze)=>Ze(e({id:ze,action:"FS",payload:{method:Ce,args:Ae}})),V=(Ce,Ae)=>Ze(e({id:Ae,action:"loadLanguage",payload:{langs:Ce,options:{langPath:G.langPath,dataPath:G.dataPath,cachePath:G.cachePath,cacheMethod:G.cacheMethod,gzip:G.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(oe)&&!G.legacyLang}}})),te=(Ce,Ae,ze,rt)=>Ze(e({id:rt,action:"initialize",payload:{langs:Ce,oem:Ae,config:ze}})),fe=(Ce="eng",Ae,ze,rt)=>{if(ee&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(Ae))throw Error("Legacy model requested but code missing.");const ot=Ae||oe;oe=ot;const gt=ze||U;U=gt;const Pt=(typeof Ce=="string"?Ce.split("+"):Ce).filter(et=>!J.includes(et));return J.push(...Pt),Pt.length>0?V(Pt,rt).then(()=>te(Ce,ot,gt,rt)):te(Ce,ot,gt,rt)},ge=(Ce={},Ae)=>Ze(e({id:Ae,action:"setParameters",payload:{params:Ce}})),We=async(Ce,Ae={},ze={text:!0},rt)=>Ze(e({id:rt,action:"recognize",payload:{image:await g(Ce),options:Ae,output:ze}})),se=async(Ce,Ae)=>{if(ee)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return Ze(e({id:Ae,action:"detect",payload:{image:await g(Ce)}}))},Be=async()=>(Ie!==null&&(f(Ie),Ie=null),Promise.resolve());p(Ie,({workerId:Ce,jobId:Ae,status:ze,action:rt,data:ot})=>{const gt=`${rt}-${Ae}`;if(ze==="resolve")n(`[${Ce}]: Complete ${Ae}`),Z[gt].resolve({jobId:Ae,data:ot}),delete Z[gt];else if(ze==="reject")if(Z[gt].reject(ot),delete Z[gt],rt==="load"&&X(ot),H)H(ot);else throw Error(ot);else ze==="progress"&&j({...ot,userJobId:Ae})});const K={id:R,worker:Ie,load:ne,writeText:pe,readText:me,removeFile:Y,FS:le,reinitialize:fe,setParameters:ge,recognize:We,detect:se,terminate:Be};return ie().then(()=>V(A)).then(()=>te(A,T,M)).then(()=>Qe(K)).catch(()=>{}),je},Ex}var Sx,J3;function cq(){if(J3)return Sx;J3=1;const t=N6();return Sx={recognize:async(r,s,i)=>{const c=await t(s,1,i);return c.recognize(r).finally(async()=>{await c.terminate()})},detect:async(r,s)=>{const i=await t("osd",0,s);return i.detect(r).finally(async()=>{await i.terminate()})}},Sx}var Ax,Q3;function uq(){return Q3||(Q3=1,Ax={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Ax}var Nx,eA;function dq(){return eA||(eA=1,Nx={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Nx}var kx,tA;function fq(){if(tA)return kx;tA=1,XW();const t=YW(),e=N6(),n=cq(),r=uq(),s=A6(),i=dq(),{setLogging:c}=ry();return kx={languages:r,OEM:s,PSM:i,createScheduler:t,createWorker:e,setLogging:c,...n},kx}var hq=fq();const pq=async(t,e)=>{const n=await hq.createWorker("tur+eng",1,{logger:r=>{r.status==="recognizing text"&&e&&e(Math.round(r.progress*100))}});try{const{data:{text:r,confidence:s}}=await n.recognize(t);return{text:r,confidence:s}}finally{await n.terminate()}},mq=1600,gq=.85;function xq(t){const e=t.maxTouchPoints>0||t.hasCoarsePointer,n=t.viewportWidth<=1024;return e&&n}function bq(t,e){const n=(t||"").trim(),r=(e||"").trim();return r?n?`${n}

${r}`:r:n}async function yq(t,e={}){const n=e.maxWidth??mq,r=e.quality??gq,s=await createImageBitmap(t);try{const i=s.width,c=s.height;if(!i||!c)throw new Error("Invalid image dimensions");const f=i>n?n/i:1,p=Math.max(1,Math.round(i*f)),g=Math.max(1,Math.round(c*f)),C=document.createElement("canvas");C.width=p,C.height=g;const v=C.getContext("2d");if(!v)throw new Error("Canvas context is unavailable");return v.drawImage(s,0,0,p,g),await new Promise(T=>{C.toBlob(T,"image/jpeg",r)})||t}finally{s.close()}}const nA=.02,wq=({open:t,onClose:e,onApply:n,onProcessingChange:r,onErrorChange:s,onDraftChange:i})=>{const[c,f]=L.useState(null),[p,g]=L.useState(null),[C,v]=L.useState(null),[A,T]=L.useState(!1),[_,M]=L.useState(!1),[R,j]=L.useState(0),[H,G]=L.useState(""),Z=L.useRef(null),J=L.useRef(null),oe=L.useRef(null),U=L.useRef(null),ee=(me,Y,le)=>Math.min(le,Math.max(Y,me));if(L.useEffect(()=>{t&&(f(null),g(null),v(null),G(""),j(0),T(!1),M(!1),r(!1),s(null),i(""),setTimeout(()=>{var me;(me=Z.current)==null||me.click()},100))},[t,i,s,r]),L.useEffect(()=>{U.current=C},[C]),!t)return null;const X=me=>{var V;const Y=(V=me.target.files)==null?void 0:V[0];if(!Y)return;g(Y),v(null),G(""),i(""),s(null);const le=new FileReader;le.onload=te=>{var fe;f((fe=te.target)==null?void 0:fe.result)},le.readAsDataURL(Y)},Qe=me=>{if(!J.current)return null;const Y=J.current.getBoundingClientRect();return Y.width<=0||Y.height<=0?null:{x:ee((me.clientX-Y.left)/Y.width,0,1),y:ee((me.clientY-Y.top)/Y.height,0,1)}},je=me=>{if(A)return;const Y=Qe(me);Y&&(me.currentTarget.setPointerCapture(me.pointerId),oe.current=Y,v({x:Y.x,y:Y.y,width:0,height:0}),M(!0))},ue=me=>{if(!_||!oe.current)return;const Y=Qe(me);if(!Y)return;const le=oe.current,V=Math.min(le.x,Y.x),te=Math.min(le.y,Y.y),fe=Math.abs(Y.x-le.x),ge=Math.abs(Y.y-le.y);v({x:V,y:te,width:fe,height:ge})},Ie=me=>{if(!_)return;me.currentTarget.hasPointerCapture(me.pointerId)&&me.currentTarget.releasePointerCapture(me.pointerId),M(!1);const Y=U.current;(!Y||Y.width<nA||Y.height<nA)&&v(null)},Ze=async(me,Y)=>{const le=await createImageBitmap(me);try{const V=ee(Math.round(Y.x*le.width),0,le.width-1),te=ee(Math.round(Y.y*le.height),0,le.height-1),fe=Math.max(1,Math.round(Y.width*le.width)),ge=Math.max(1,Math.round(Y.height*le.height)),We=Math.min(fe,le.width-V),se=Math.min(ge,le.height-te),Be=document.createElement("canvas");Be.width=We,Be.height=se;const K=Be.getContext("2d");if(!K)throw new Error("Canvas context is unavailable");return K.drawImage(le,V,te,We,se,0,0,We,se),await new Promise(Ae=>{Be.toBlob(Ae,"image/jpeg",.92)})||me}finally{le.close()}},ne=async me=>{if(p){T(!0),r(!0),s(null),j(0);try{const Y=me&&C?await Ze(p,C):p,le=await yq(Y),te=((await pq(le,fe=>j(fe))).text||"").trim();G(te),i(te),te||s("Secilen alanda okunabilir metin bulunamadi. Alani degistirip tekrar deneyin.")}catch(Y){console.error("OCR Error:",Y);const le="Metin okunamadi. Isigi ve aciyi duzeltip tekrar deneyin.";s(le),alert(le)}finally{T(!1),r(!1)}}},ie=()=>{f(null),g(null),v(null),G(""),j(0),M(!1),i(""),s(null),Z.current&&(Z.current.value="",Z.current.click())},pe=()=>{n(H),e()};return b.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[b.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[b.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-white/10",children:[b.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[b.jsx(jl,{size:20,className:"text-primary dark:text-orange-500"}),"Metin Tara (OCR)"]}),b.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 dark:hover:bg-white/5 rounded-full transition-colors","aria-label":"Kapat",children:b.jsx(wi,{size:20,className:"text-slate-500"})})]}),b.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!c&&b.jsxs("div",{onClick:()=>{var me;return(me=Z.current)==null?void 0:me.click()},className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-12 flex flex-col items-center justify-center gap-4 cursor-pointer hover:border-primary/50 dark:hover:border-orange-500/50 transition-colors",children:[b.jsx("div",{className:"w-16 h-16 bg-primary/10 dark:bg-orange-500/10 rounded-full flex items-center justify-center text-primary dark:text-orange-500",children:b.jsx(jl,{size:32})}),b.jsxs("div",{className:"text-center",children:[b.jsx("p",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Kamerayi Ac"}),b.jsx("p",{className:"text-sm text-slate-500",children:"Sayfayi cekin, sonra metin alanini secin"})]})]}),c&&b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"relative bg-black rounded-lg border border-slate-200 dark:border-white/10 shadow-inner p-2",children:[b.jsxs("div",{className:"relative mx-auto w-fit max-w-full touch-none",children:[b.jsx("img",{src:c,alt:"Captured",className:"block max-h-[58vh] w-auto max-w-full rounded-md"}),!A&&b.jsx("div",{ref:J,className:"absolute inset-0 cursor-crosshair",onPointerDown:je,onPointerMove:ue,onPointerUp:Ie,onPointerCancel:Ie,children:C&&b.jsx("div",{className:"absolute border-2 border-emerald-400 bg-emerald-400/12",style:{left:`${C.x*100}%`,top:`${C.y*100}%`,width:`${C.width*100}%`,height:`${C.height*100}%`}})})]}),A&&b.jsxs("div",{className:"absolute inset-0 bg-black/60 flex flex-col items-center justify-center text-white p-6 text-center backdrop-blur-[2px]",children:[b.jsx(mr,{size:48,className:"animate-spin mb-4 text-primary dark:text-orange-500"}),b.jsx("p",{className:"font-bold text-lg mb-2",children:"Metin Isleniyor..."}),b.jsx("div",{className:"w-full max-w-xs bg-white/20 h-2 rounded-full overflow-hidden",children:b.jsx("div",{className:"bg-primary dark:bg-orange-500 h-full transition-all duration-300",style:{width:`${R}%`}})}),b.jsxs("p",{className:"mt-2 text-sm font-medium",children:["%",R]}),b.jsx("p",{className:"mt-4 text-[10px] text-white/60",children:"Bu islem cihaz hizina gore 5-10 saniye surebilir."})]})]}),!A&&b.jsxs("div",{className:"space-y-2",children:[b.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Metin bolgesini secmek icin gorsel uzerinde surukleyin."}),b.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[b.jsxs("button",{type:"button",onClick:()=>ne(!0),disabled:!C,className:"py-2 px-3 rounded-lg bg-emerald-600 text-white text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center gap-2",children:[b.jsx(DR,{size:16}),"Secili Alani Tara"]}),b.jsx("button",{type:"button",onClick:()=>ne(!1),className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:"Tum Sayfayi Tara"}),b.jsxs("button",{type:"button",onClick:ie,className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:[b.jsx(BA,{size:16}),"Tekrar Cek"]})]})]}),!A&&H&&b.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[b.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Okunan Metin"}),b.jsx("textarea",{value:H,onChange:me=>{G(me.target.value),i(me.target.value)},className:"w-full h-40 border border-slate-200 dark:border-white/10 rounded-xl p-3 text-sm bg-slate-50 dark:bg-white/5 text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/20 outline-none resize-none font-lora"}),b.jsx("p",{className:"text-[10px] text-slate-400 italic text-right",children:"* Hatalari buradan duzeltebilirsiniz."})]})]})]}),b.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-white/10 flex gap-3",children:[c&&!A&&b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 border border-slate-200 dark:border-white/10 rounded-xl text-slate-600 dark:text-slate-300 font-semibold hover:bg-slate-50 dark:hover:bg-white/5 transition-colors",children:"Kapat"}),b.jsxs("button",{onClick:pe,disabled:!H,className:"flex-[1.5] py-3 px-4 bg-primary dark:bg-orange-600 text-white rounded-xl font-bold hover:opacity-90 transition-all shadow-lg shadow-primary/20 dark:shadow-orange-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:[b.jsx(z2,{size:18}),"Highlight'a Ekle"]})]}),!c&&b.jsx("button",{onClick:e,className:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 dark:hover:text-slate-300 transition-colors",children:"Vazgec"})]})]}),b.jsx("input",{ref:Z,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:X})]})},vq=({highlights:t,onUpdate:e,autoEditHighlightId:n})=>{const[r,s]=L.useState(!1),[i,c]=L.useState(null),[f,p]=L.useState({}),[g,C]=L.useState("highlight"),[v,A]=L.useState(!1),[T,_]=L.useState(!1),[M,R]=L.useState(!1),[j,H]=L.useState(""),[G,Z]=L.useState(null),[J,oe]=L.useState(""),[U,ee]=L.useState(""),[X,Qe]=L.useState(!1);It.useEffect(()=>{if(n){const me=t.find(Y=>Y.id===n);me&&ue(me)}},[n]),It.useEffect(()=>{const me=()=>{if(typeof window>"u"){_(!1);return}const Y=typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches,le=typeof navigator<"u"?Number(navigator.maxTouchPoints||0):0;_(xq({viewportWidth:window.innerWidth||0,maxTouchPoints:le,hasCoarsePointer:Y}))};return me(),window.addEventListener("resize",me),()=>window.removeEventListener("resize",me)},[]);const je=()=>{c(null),p({}),C("highlight"),oe(new Date().toISOString().split("T")[0]),ee(""),A(!1),Z(null),H(""),s(!0)},ue=me=>{c(me.id),p({...me}),C(Wp(me.type)),oe(new Date(me.createdAt).toISOString().split("T")[0]),ee(me.tags?me.tags.join(", "):""),A(!1),Z(null),H(""),s(!0)},Ie=()=>{s(!1),c(null),p({}),ee(""),oe(""),A(!1),Z(null),H(""),R(!1)},Ze=It.useCallback(me=>{p(Y=>({...Y,text:bq(String(Y.text||""),me)})),H(me),Z(null),A(!1)},[]),ne=async()=>{if(!f.text)return;Qe(!0);const me=`"${f.text}"
${f.comment?`Context: ${f.comment}`:""}`,Y=await ey(me);if(Y.length>0){const le=U?U.split(",").map(te=>te.trim()).filter(Boolean):[],V=Array.from(new Set([...le,...Y]));ee(V.join(", "))}Qe(!1)},ie=()=>{if(!f.text)return;const me=U.split(",").map(V=>V.trim()).filter(V=>V.length>0),Y=J?new Date(J).getTime():Date.now(),le={id:i||Date.now().toString(),text:f.text,type:g,pageNumber:f.pageNumber,paragraphNumber:f.paragraphNumber,chapterTitle:f.chapterTitle,comment:f.comment,createdAt:Y,tags:me};if(i){const V=t.map(te=>te.id===i?le:te);e(V)}else e([le,...t]);Ie()},pe=me=>{window.confirm("Delete this item?")&&e(t.filter(Y=>Y.id!==me))};return b.jsxs("div",{className:"space-y-4 md:space-y-6",children:[!r&&b.jsxs("button",{onClick:je,className:"w-full py-3 md:py-4 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl text-slate-500 dark:text-slate-400 hover:border-[#262D40]/24 hover:text-[#262D40] hover:bg-[#262D40]/30 dark:hover:bg-white/5 transition-all flex flex-col items-center gap-1 md:gap-2",children:[b.jsx(Ix,{size:20,className:"md:w-6 md:h-6"}),b.jsx("span",{className:"text-sm md:text-base font-medium",children:"Add Highlight or Insights"})]}),r&&b.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl shadow-lg border border-[#262D40]/8 dark:border-white/10 animate-in fade-in zoom-in-95 duration-200 relative ring-1 ring-[#262D40]/5 dark:ring-white/5",children:[b.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[b.jsxs("h4",{className:"font-semibold text-slate-800 dark:text-white flex items-center gap-2 text-sm md:text-base",children:[i?b.jsx(C0,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}):b.jsx(Ix,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}),i?g==="highlight"?"Edit Highlight":"Edit Note":"New Entry"]}),b.jsxs("div",{className:"flex items-center gap-2",children:[g==="highlight"&&T&&b.jsxs("button",{type:"button",onClick:()=>{Z(null),H(""),A(!0)},disabled:M,className:"inline-flex items-center gap-1 rounded-md border border-sky-200 bg-sky-50 px-2 py-1 text-[11px] font-semibold text-sky-700 transition-colors hover:bg-sky-100 disabled:cursor-not-allowed disabled:opacity-60 dark:border-sky-700 dark:bg-sky-950/35 dark:text-sky-200 dark:hover:bg-sky-950/55",title:"Kamera ile metin tara",children:[M?b.jsx(mr,{size:12,className:"animate-spin"}):b.jsx(jl,{size:12}),"Tara"]}),b.jsx("button",{onClick:Ie,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:b.jsx(wi,{size:18,className:"md:w-5 md:h-5"})})]})]}),b.jsxs("div",{className:"flex bg-[#F3F5FA] dark:bg-white/5 p-1 rounded-lg mb-4 md:mb-5",children:[b.jsxs("button",{type:"button",onClick:()=>{g!=="highlight"&&(C("highlight"),p({}),ee(""),Z(null),H(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${g==="highlight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[b.jsx(Bd,{size:14,className:"md:w-4 md:h-4"}),"Highlight"]}),b.jsxs("button",{type:"button",onClick:()=>{g!=="insight"&&(C("insight"),p({}),ee(""),A(!1),Z(null),H(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${g==="insight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[b.jsx(Kc,{size:14,className:"md:w-4 md:h-4"}),"Insights"]})]}),b.jsxs("div",{className:"space-y-2 md:space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:g==="highlight"?"Highlight Text *":"Insight Content *"}),b.jsx("textarea",{autoFocus:!0,rows:12,className:"w-full border rounded-lg p-2 md:p-3 text-sm md:text-base text-slate-800 dark:text-white focus:ring-2 focus:ring-[#262D40]/30 dark:focus:ring-orange-500/30 focus:border-[#262D40]/30 dark:focus:border-orange-500/30 font-lora bg-[#F3F5FA] border-[#E6EAF2] dark:bg-slate-800/50 dark:border-white/10",placeholder:g==="highlight"?"Type the text exactly as it appears...":"Write your thoughts, summary, or key takeaway...",value:f.text||"",onChange:me=>p(Y=>({...Y,text:me.target.value}))}),g==="highlight"&&j&&b.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-sky-700 dark:text-sky-300",children:"OCR metni eklendi. Kaydetmeden once metni kontrol edebilirsiniz."}),g==="highlight"&&G&&b.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-red-600 dark:text-red-400",children:G})]}),g==="highlight"&&b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Comment"}),b.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Why is this quote important?",value:f.comment||"",onChange:me=>p(Y=>({...Y,comment:me.target.value}))})]}),b.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Page #"}),b.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:f.pageNumber||"",onChange:me=>p(Y=>({...Y,pageNumber:parseInt(me.target.value)||void 0}))})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Paragraph #"}),b.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:f.paragraphNumber||"",onChange:me=>p(Y=>({...Y,paragraphNumber:parseInt(me.target.value)||void 0}))})]}),b.jsxs("div",{className:"col-span-2 md:col-span-1",children:[b.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Chapter"}),b.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Title or No.",value:f.chapterTitle||"",onChange:me=>p(Y=>({...Y,chapterTitle:me.target.value}))})]})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4 pt-2 border-t border-slate-50 dark:border-white/5",children:[b.jsxs("div",{className:"md:col-span-1",children:[b.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center gap-1",children:[b.jsx(Xc,{size:10,className:"md:w-3 md:h-3"})," Date"]}),b.jsx("input",{type:"date",value:J,onChange:me=>oe(me.target.value),className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]}),b.jsxs("div",{className:"md:col-span-2",children:[b.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center justify-between",children:[b.jsx("span",{children:"Tags"}),b.jsxs("button",{type:"button",onClick:ne,disabled:X||!f.text,className:"text-[#262D40] dark:text-orange-500 hover:text-[#262D40] dark:hover:text-orange-400 flex items-center gap-1 disabled:opacity-50 text-[10px] font-bold tracking-wide",children:[X?b.jsx(mr,{size:10,className:"animate-spin"}):b.jsx(ka,{size:10}),"AI AUTO-TAG"]})]}),b.jsx("input",{type:"text",value:U,onChange:me=>ee(me.target.value),placeholder:"Separate with commas...",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]})]}),b.jsxs("div",{className:"flex justify-end gap-3 pt-2 mt-2",children:[b.jsx("button",{onClick:Ie,className:"px-3 md:px-4 py-2 text-xs md:text-sm text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-white/5 rounded-lg flex items-center gap-2",children:"Cancel"}),b.jsxs("button",{onClick:ie,disabled:!f.text,className:"px-3 md:px-4 py-2 text-xs md:text-sm bg-[#262D40]/40 dark:bg-orange-600/40 text-white rounded-lg hover:bg-[#262D40]/55 dark:hover:bg-orange-600/60 disabled:opacity-50 shadow-sm flex items-center gap-2",children:[b.jsx(MR,{size:14,className:"md:w-4 md:h-4"}),i?"Update Entry":"Save Entry"]})]})]})]}),b.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.map(me=>{const Y=lN(me.type);return b.jsxs("div",{className:"p-3 md:p-6 rounded-xl border transition-all relative group bg-white dark:bg-slate-900/50 border-[#E6EAF2] dark:border-white/10 hover:border-[#262D40]/12 dark:hover:border-orange-500/30 hover:shadow-md",children:[b.jsxs("div",{className:"absolute top-1 right-1 md:top-4 md:right-4 flex gap-0.5 md:gap-2 md:bg-white/80 md:dark:bg-slate-800/90 md:backdrop-blur-sm p-0 md:p-1 rounded-lg md:shadow-sm md:border md:border-[#E6EAF2] md:dark:border-white/10 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity z-10",children:[b.jsx("button",{type:"button",onClick:le=>{le.stopPropagation(),ue(me)},className:"p-1.5 text-slate-400/70 dark:text-slate-500/70 hover:text-[#262D40] dark:hover:text-orange-500 hover:bg-[#262D40]/5 dark:hover:bg-white/5 rounded-md transition-colors",title:"Edit",children:b.jsx(C0,{size:14,className:"md:w-4 md:h-4"})}),b.jsx("button",{type:"button",onClick:le=>{le.stopPropagation(),pe(me.id)},className:"p-1.5 text-slate-400/70 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:b.jsx(Ol,{size:14,className:"md:w-4 md:h-4"})})]}),b.jsxs("div",{className:"flex gap-3 md:gap-4",children:[b.jsx("div",{className:"flex-shrink-0 mt-0.5 md:mt-1",children:Y?b.jsx(Kc,{size:16,className:"text-[#262D40]/82 fill-[#262D40]/85 md:w-5 md:h-5"}):b.jsx(Bd,{size:16,className:"text-yellow-400 fill-yellow-200 md:w-5 md:h-5"})}),b.jsxs("div",{className:"flex-1",children:[b.jsx("p",{className:`text-sm md:text-lg leading-relaxed mb-2 md:mb-3 pr-0 md:pr-16 whitespace-pre-wrap font-lora ${Y?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-white"}`,children:me.text}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mb-2",children:[(me.pageNumber||me.paragraphNumber)&&b.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 md:px-2 md:py-1 rounded border bg-[#F3F5FA] dark:bg-white/5 border-[#E6EAF2] dark:border-white/10 text-slate-600 dark:text-slate-400",children:[b.jsx(fR,{size:10,className:"md:w-3 md:h-3"}),me.pageNumber&&b.jsxs("span",{children:["Pg ",me.pageNumber]}),me.pageNumber&&me.paragraphNumber&&b.jsx("span",{children:""}),me.paragraphNumber&&b.jsxs("span",{children:["Para ",me.paragraphNumber]})]}),me.chapterTitle&&b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx(sf,{size:10,className:"md:w-3 md:h-3"}),b.jsx("span",{children:me.chapterTitle})]}),b.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[b.jsx(Xc,{size:10,className:"md:w-3 md:h-3"}),b.jsx("span",{children:new Date(me.createdAt).toLocaleDateString()})]})]}),me.tags&&me.tags.length>0&&b.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-2",children:me.tags.map((le,V)=>b.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-white/5 border border-[#E6EAF2] dark:border-white/10 rounded text-[9px] md:text-[10px] text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[b.jsx(w0,{size:8})," ",le]},V))}),me.comment&&b.jsx("div",{className:"mt-2 md:mt-3 pl-3 md:pl-4 border-l-2 border-[#E6EAF2] dark:border-white/10 py-0.5 md:py-1",children:b.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 italic",children:me.comment})})]})]})]},me.id)}),t.length===0&&!r&&b.jsx("div",{className:"text-center py-8 md:py-12 text-slate-400",children:b.jsx("p",{className:"text-xs md:text-base",children:"No highlights or insights added yet."})})]}),b.jsx(wq,{open:v,onClose:()=>A(!1),onApply:Ze,onProcessingChange:R,onErrorChange:Z,onDraftChange:H})]})},Dp=(t,e)=>{if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=Date.parse(t);if(Number.isFinite(n))return n}return e},Cq=t=>{const e=String(t||"AUTO").trim().toUpperCase();return e==="TR"||e==="EN"?e:"AUTO"},rA=t=>{const e=String(t||"").trim().toLowerCase();if(e==="tr"||e==="en")return e},Eq=(t,e)=>{const n=Dp(t.createdAt,Date.now());return{id:typeof t.id=="string"&&t.id.trim()?t.id:`${n}-${e}`,text:t.text||"",type:Wp(t.type),pageNumber:t.pageNumber,paragraphNumber:t.paragraphNumber,chapterTitle:t.chapterTitle,comment:t.comment,createdAt:n,tags:Array.isArray(t.tags)?t.tags:[],isFavorite:!!t.isFavorite}},k6=t=>({...t,addedAt:Dp(t.addedAt,Date.now()),tags:Array.isArray(t.tags)?t.tags:[],contentLanguageMode:Cq(t.contentLanguageMode),contentLanguageResolved:rA(t.contentLanguageResolved),sourceLanguageHint:rA(t.sourceLanguageHint),highlights:Array.isArray(t.highlights)?t.highlights.map((e,n)=>Eq(e,n)):[],personalNoteCategory:t.type==="PERSONAL_NOTE"?qp(t.personalNoteCategory):void 0,personalFolderId:t.type==="PERSONAL_NOTE"?hN(t.personalFolderId):void 0,folderPath:t.type==="PERSONAL_NOTE"?fN(t.folderPath):void 0,status:t.status||"On Shelf",readingStatus:t.readingStatus||"To Read",author:(t.author||"Unknown Author").trim()||"Unknown Author",title:(t.title||"Untitled").trim()||"Untitled",summaryText:typeof t.summaryText=="string"?t.summaryText:void 0}),T6=t=>({...t,category:qp(t.category),name:(t.name||"").trim(),order:Number.isFinite(t.order)?t.order:0,createdAt:Dp(t.createdAt,Date.now()),updatedAt:Dp(t.updatedAt,Date.now())});function Sq(t){return t?{__oracleCursor:t}:null}function Aq(t){return t?t.__oracleCursor:void 0}const Tx=async(t,e=2e3,n)=>{const r=new URL(`${Kt}/api/library/items`);r.searchParams.set("limit",String(e));const s=Aq(n);s&&r.searchParams.set("cursor",s);const i=await $n(r.toString());if(!i.ok)throw new Error(await Ei(i,"Failed to fetch library items from Oracle"));const c=await i.json(),p=(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(C=>k6(C)),g=Sq(typeof(c==null?void 0:c.next_cursor)=="string"?c.next_cursor:null);return{items:p,lastDoc:g}},Fc=async(t,e)=>{const n=k6(e),r=await $n(`${Kt}/api/library/items/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Ei(r,"Failed to save library item to Oracle"))},R2=async(t,e,n)=>{const r=await $n(`${Kt}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:n})});if(!r.ok)throw new Error(await Ei(r,"Failed to patch library item in Oracle"))},Nq=async(t,e)=>{const n=await $n(`${Kt}/api/library/items/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Ei(n,"Failed to delete library item from Oracle"))},kq=async(t,e)=>{if(e.length===0)return;const n=await $n(`${Kt}/api/library/items/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:e})});if(!n.ok)throw new Error(await Ei(n,"Failed to bulk delete library items from Oracle"))},sA=async t=>{const e=await $n(`${Kt}/api/library/personal-note-folders`);if(!e.ok)throw new Error(await Ei(e,"Failed to fetch personal note folders from Oracle"));const n=await e.json();return(Array.isArray(n==null?void 0:n.folders)?n.folders:[]).map(s=>T6(s)).sort((s,i)=>s.category!==i.category?s.category.localeCompare(i.category):s.order!==i.order?s.order-i.order:s.name.localeCompare(i.name))},iA=async(t,e)=>{const n=T6(e),r=await $n(`${Kt}/api/library/personal-note-folders/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Ei(r,"Failed to save personal note folder to Oracle"))},aA=async(t,e,n)=>{const r=await $n(`${Kt}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Ei(r,"Failed to update personal note folder in Oracle"))},Tq=async(t,e)=>{const n=await $n(`${Kt}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Ei(n,"Failed to delete personal note folder from Oracle"))},n0=async(t,e,n,r,s)=>{const i=await $n(`${Kt}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:{personalNoteCategory:qp(n),personalFolderId:hN(r)||null,folderPath:fN(s)||null}})});if(!i.ok)throw new Error(await Ei(i,"Failed to move personal note in Oracle"))},Oq=It.memo(({book:t,onBack:e,onEdit:n,onDelete:r,onUpdateHighlights:s,initialTab:i="info",autoEditHighlightId:c,onIngestSuccess:f,onBookUpdated:p})=>{const[g,C]=L.useState(i),[v,A]=L.useState(null),[T,_]=L.useState(!1),[M,R]=L.useState(!1),[j,H]=L.useState(!1),[G,Z]=L.useState(null),[J,oe]=L.useState(null),[U,ee]=L.useState(null),[X,Qe]=L.useState(null),[je,ue]=L.useState(null),[Ie,Ze]=L.useState(0),[ne,ie]=L.useState(0),{user:pe}=p1(),me=It.useRef(null),Y=It.useRef(null),le=t.type==="PERSONAL_NOTE",V=et=>{if(!et)return"";const ft=et.replace(/_/g," ").replace(/\s+/g," ").trim(),Ve=24;return ft.length<=Ve?ft:`${ft.slice(0,Ve).trimEnd()}...`},te=async et=>{var Ve;const ft=(Ve=et.target.files)==null?void 0:Ve[0];if(!(!ft||!pe)){if(ft.type!=="application/pdf"){ee("Please select a PDF file");return}R(!0),ee(null),oe(null),Qe({status:"PROCESSING",file_name:ft.name,chunk_count:null,embedding_count:null,updated_at:new Date().toISOString()}),Ze(lt=>lt+1);try{const lt=await v6(ft,t.title,t.author,pe.uid,t.id);oe(lt),setTimeout(()=>oe(null),5e3)}catch(lt){ee(lt instanceof Error?lt.message:"Ingestion failed")}finally{R(!1),me.current&&(me.current.value="")}}},fe=et=>{switch(et){case"Reading":return{icon:Tl,color:"text-[#38BDF8]",bg:"bg-[#38BDF8]/12",border:"border-[#38BDF8]/45"};case"Finished":return{icon:jd,color:"text-[#22C55E]",bg:"bg-[#22C55E]/12",border:"border-[#22C55E]/45"};case"To Read":return{icon:x_,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"};default:return{icon:Tl,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"}}},ge=et=>{switch(et){case"Lent Out":return{icon:To,color:"text-[#F59E0B]",bg:"bg-[#F59E0B]/15",border:"border-[#F59E0B]/45"};case"Lost":return{icon:To,color:"text-[#F43F5E]",bg:"bg-[#F43F5E]/15",border:"border-[#F43F5E]/45"};case"On Shelf":default:return{icon:LA,color:"text-[#14B8A6]",bg:"bg-[#14B8A6]/15",border:"border-[#14B8A6]/45"}}},We=async()=>{if(t.highlights.length===0)return;_(!0);const et=t.highlights.map(Ve=>Ve.text),ft=await p6(et);A(ft),_(!1)},se=async()=>{if(!(!(pe!=null&&pe.uid)||j)){H(!0),Z(null);try{const et=f1(t),ft=await ty(et,{forceRegenerate:!0}),Ve=h1(t,ft),lt={};Ve.summaryText!==t.summaryText&&(lt.summaryText=Ve.summaryText),JSON.stringify(Ve.tags||[])!==JSON.stringify(t.tags||[])&&(lt.tags=Ve.tags),Ve.publisher!==t.publisher&&(lt.publisher=Ve.publisher),Ve.translator!==t.translator&&(lt.translator=Ve.translator),Ve.publicationYear!==t.publicationYear&&(lt.publicationYear=Ve.publicationYear),Ve.isbn!==t.isbn&&(lt.isbn=Ve.isbn),Ve.coverUrl!==t.coverUrl&&(lt.coverUrl=Ve.coverUrl),Ve.pageCount!==t.pageCount&&(lt.pageCount=Ve.pageCount),Ve.contentLanguageMode!==t.contentLanguageMode&&(lt.contentLanguageMode=Ve.contentLanguageMode),Ve.contentLanguageResolved!==t.contentLanguageResolved&&(lt.contentLanguageResolved=Ve.contentLanguageResolved),Ve.sourceLanguageHint!==t.sourceLanguageHint&&(lt.sourceLanguageHint=Ve.sourceLanguageHint),Ve.languageDecisionReason!==t.languageDecisionReason&&(lt.languageDecisionReason=Ve.languageDecisionReason),Ve.languageDecisionConfidence!==t.languageDecisionConfidence&&(lt.languageDecisionConfidence=Ve.languageDecisionConfidence),Object.keys(lt).length>0&&await R2(pe.uid,t.id,lt),p==null||p({...t,...lt}),(Ve.summaryText||Ve.generalNotes)&&A(Ve.summaryText||Ve.generalNotes||null)}catch(et){console.error("Enrich failed",et),Z(et instanceof Error?et.message:"Failed to generate with AI")}finally{H(!1)}}},Be=le?null:fe(t.readingStatus),K=le?null:ge(t.status),Ce=!!((X==null?void 0:X.status)==="COMPLETED"&&(X!=null&&X.matched_by_title)&&(X!=null&&X.resolved_book_id)&&String(X.resolved_book_id)!==String(t.id)),Ae=(X==null?void 0:X.status)==="COMPLETED"&&!Ce,ze=(X==null?void 0:X.status)==="PROCESSING",rt=(X==null?void 0:X.status)==="FAILED",ot=Ae||ze||M,gt=Math.min(95,Math.max(12,12+ne*3)),jt=It.useCallback(()=>{Ze(et=>et+1)},[]);It.useEffect(()=>{if(!(pe!=null&&pe.uid)||!(t!=null&&t.id)||le){Qe(null),ue(null),ie(0),Y.current&&(clearTimeout(Y.current),Y.current=null);return}let et=!1;const ft=60,Ve=async()=>{try{const lt=await zW(t.id,pe.uid,t.title);if(et)return;Qe(lt),ue(null);const tt=!!(lt.status==="COMPLETED"&&lt.matched_by_title&&lt.resolved_book_id&&String(lt.resolved_book_id)!==String(t.id)),Xn=lt.status==="COMPLETED"&&!tt;if(t.isIngested!==Xn){const Lr={...t,isIngested:Xn};p==null||p(Lr)}lt.status==="COMPLETED"&&!tt&&(f==null||f()),lt.status==="PROCESSING"&&ie(Lr=>{const on=Lr+1;return on<ft&&!et&&(Y.current=setTimeout(Ve,1e4)),on})}catch(lt){if(et)return;ue(lt instanceof Error?lt.message:"Failed to fetch ingestion status"),ie(tt=>{const Xn=tt+1;return Xn<ft&&!et&&(Y.current=setTimeout(Ve,1e4)),Xn})}};return ie(0),Ve(),()=>{et=!0,Y.current&&(clearTimeout(Y.current),Y.current=null)}},[t.id,pe==null?void 0:pe.uid,le,Ie]);const Pt=(et,ft,Ve)=>b.jsxs("div",{className:`p-2 md:p-4 rounded-lg md:rounded-xl border-2 ${et.bg} ${et.border} flex items-center gap-2 md:gap-3 shadow-sm h-full`,children:[b.jsx("div",{className:`p-1.5 md:p-2 rounded-full bg-white/50 dark:bg-black/20 ${et.color} flex-shrink-0`,children:b.jsx(et.icon,{size:16,className:"md:w-5 md:h-5"})}),b.jsxs("div",{className:"min-w-0 flex-1",children:[b.jsx("span",{className:"block text-[9px] md:text-[10px] uppercase tracking-wider font-bold text-[#111827] dark:text-white/60 truncate",children:ft}),b.jsx("span",{className:"font-bold text-xs md:text-base leading-tight text-[#111827] dark:text-white truncate block",children:Ve})]})]});return b.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-3 md:p-4 pb-20 animate-in fade-in duration-300",children:[b.jsxs("button",{onClick:e,className:"mb-2 md:mb-6 flex items-center text-slate-500 dark:text-slate-400 hover:text-[#262D40] dark:hover:text-white transition-colors group text-base md:text-base",children:[b.jsx(OA,{size:18,className:"mr-1.5 md:mr-1 md:w-5 md:h-5 group-hover:-translate-x-1 transition-transform"}),"Back to ",le?"Notes":"Library"]}),b.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 overflow-hidden",children:[b.jsx("div",{className:"p-4 md:p-8 border-b border-[#E6EAF2] dark:border-slate-800",children:le?b.jsxs("div",{className:"flex justify-between items-start",children:[b.jsxs("div",{className:"flex-1",children:[b.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2 md:mb-4 text-[#262D40]/90 dark:text-white/85",children:[b.jsx(v0,{size:18,className:"md:w-6 md:h-6"}),b.jsx("span",{className:"text-xs md:text-sm font-bold tracking-wide uppercase text-[#262D40]/80 dark:text-white",children:"Personal Note"}),b.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs font-bold tracking-wide",children:es(t)}),t.folderPath&&b.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs border border-[#E6EAF2] dark:border-slate-700",children:t.folderPath})]}),b.jsx("h1",{className:"text-xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 md:mb-4 leading-tight",children:t.title}),b.jsxs("div",{className:"flex flex-wrap gap-1.5 md:gap-2 mb-2",children:[t.tags.map((et,ft)=>b.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",et]},ft)),b.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 text-slate-400 dark:text-slate-500 text-[10px] md:text-xs flex items-center gap-1",children:[b.jsx(Xc,{size:10,className:"md:w-3 md:h-3"}),new Date(t.addedAt).toLocaleDateString()]})]})]}),b.jsxs("div",{className:"flex gap-1 md:gap-2 ml-2 md:ml-4 flex-shrink-0",children:[b.jsx("input",{type:"file",ref:me,className:"hidden",accept:".pdf",onChange:te}),b.jsx("button",{type:"button",onClick:()=>{var et;return(et=me.current)==null?void 0:et.click()},disabled:ot,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors relative",title:Ae?`PDF already indexed: ${(X==null?void 0:X.file_name)||""}`:"Upload PDF",children:M?b.jsx(mr,{size:18,className:"md:w-5 md:h-5 animate-spin text-[#262D40]/90"}):b.jsx(E0,{size:18,className:"md:w-5 md:h-5"})}),b.jsx("button",{type:"button",onClick:et=>{et.stopPropagation(),n()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors",title:"Edit Note",children:b.jsx(C0,{size:18,className:"md:w-5 md:h-5"})}),b.jsx("button",{type:"button",onClick:et=>{et.stopPropagation(),r()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-full transition-colors",title:"Delete Note",children:b.jsx(Ol,{size:18,className:"md:w-5 md:h-5"})})]})]}):b.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[b.jsxs("div",{className:"flex gap-4 md:block md:shrink-0",children:[b.jsx("div",{className:"w-20 h-32 md:w-34 md:h-52 bg-slate-200 dark:bg-slate-800 rounded-lg shadow-inner flex-shrink-0 flex items-center justify-center text-slate-400 dark:text-slate-600 self-center md:self-start overflow-hidden relative border border-[#E6EAF2] dark:border-slate-700",children:t.type==="BOOK"&&t.coverUrl?b.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-full h-full object-cover"}):t.type==="BOOK"?b.jsx(Tl,{size:32,className:"md:w-12 md:h-12"}):t.type==="ARTICLE"?b.jsx(sf,{size:32,className:"md:w-12 md:h-12"}):b.jsx(Fp,{size:32,className:"md:w-12 md:h-12"})}),b.jsxs("div",{className:"md:hidden flex-1 flex justify-between items-start min-w-0 py-1 gap-2",children:[b.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[b.jsx("h1",{className:"text-[16px] font-bold text-slate-900 dark:text-white mb-1 leading-snug line-clamp-3",children:t.title}),b.jsx("p",{className:"text-[13px] text-slate-600 dark:text-slate-400 mb-2 line-clamp-2",children:t.author}),t.url&&t.type!=="BOOK"&&b.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 text-[#262D40] dark:text-slate-400 hover:underline max-w-full",children:[b.jsx(_C,{size:12}),b.jsx("span",{className:"text-xs truncate",children:new URL(t.url).hostname})]})]}),b.jsxs("div",{className:"flex flex-col gap-1.5 flex-shrink-0 pt-0.5",children:[Be&&b.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${Be.bg} ${Be.border} ${Be.color}`,children:[b.jsx(Be.icon,{size:10}),b.jsx("span",{children:t.readingStatus})]}),K&&t.type==="BOOK"&&b.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${K.bg} ${K.border} ${K.color}`,children:[b.jsx(K.icon,{size:10}),b.jsx("span",{children:t.status})]})]})]})]}),b.jsxs("div",{className:"hidden md:block flex-1 min-w-0",children:[b.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 leading-tight",children:t.title}),b.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 mb-4",children:t.author}),b.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.tags.map((et,ft)=>b.jsxs("span",{className:"px-2 py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",et]},ft))}),t.url&&t.type!=="BOOK"&&b.jsx("div",{className:"mb-6",children:b.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[#262D40] dark:text-[#262D40]/82 hover:underline",children:[b.jsx(_C,{size:16}),b.jsx("span",{className:"text-sm",children:t.url})]})})]}),b.jsx("div",{className:"md:hidden flex flex-wrap gap-1.5 -mt-1 mb-1",children:t.tags.map((et,ft)=>b.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",et]},ft))}),b.jsxs("div",{className:"w-full md:w-64 flex-shrink-0 flex flex-col gap-2 md:gap-3",children:[b.jsxs("div",{className:"hidden md:flex md:flex-col gap-2 md:gap-3",children:[Be&&b.jsx("div",{className:!K||t.type!=="BOOK"?"col-span-2 md:col-span-1":"col-span-1",children:Pt(Be,"Status",t.readingStatus)}),K&&t.type==="BOOK"&&b.jsx("div",{className:"col-span-1",children:Pt(K,"Inventory",t.status)})]}),b.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1 md:mt-2",children:[b.jsx("input",{type:"file",ref:me,className:"hidden",accept:".pdf",onChange:te}),b.jsxs("button",{type:"button",onClick:()=>{var et;return(et=me.current)==null?void 0:et.click()},disabled:ot,className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium disabled:opacity-50",title:Ae?`PDF already indexed: ${(X==null?void 0:X.file_name)||""}`:"Upload PDF",children:[M?b.jsx(mr,{size:14,className:"animate-spin"}):b.jsx(E0,{size:14}),b.jsx("span",{className:"hidden lg:inline",children:"PDF"})]}),b.jsxs("button",{type:"button",onClick:et=>{et.stopPropagation(),n()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[b.jsx(C0,{size:14})," ",b.jsx("span",{className:"hidden lg:inline",children:"Edit"})]}),b.jsxs("button",{type:"button",onClick:et=>{et.stopPropagation(),r()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-red-300 dark:hover:border-red-500 hover:text-red-600 dark:hover:text-red-400 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[b.jsx(Ol,{size:14})," ",b.jsx("span",{className:"hidden lg:inline",children:"Delete"})]})]}),(J||Ae)&&b.jsxs("div",{className:"mt-2 text-[10px] text-emerald-600 dark:text-emerald-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[b.jsx(jd,{size:10}),(X==null?void 0:X.chunk_count)!=null?`PDF indexlendi (${X.chunk_count} chunk)`:"PDF indexlendi"]}),Ce&&b.jsxs("div",{className:"mt-2 text-[10px] text-amber-600 dark:text-amber-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[b.jsx(To,{size:10})," Ayni baslikta baska bir kaydin PDF'i bulundu; bu kayit icin indexli sayilmadi."]}),U&&b.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[b.jsx(Yc,{size:10})," ",U]}),rt&&b.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[b.jsx(To,{size:10})," PDF islenemedi. Lutfen farkli bir PDF ile tekrar deneyin."]})]})]})}),!le&&b.jsxs("div",{className:"flex border-b border-[#E6EAF2] dark:border-slate-800",children:[b.jsx("button",{onClick:()=>C("info"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${g==="info"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:"Details"}),b.jsxs("button",{onClick:()=>C("highlights"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${g==="highlights"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:["Highlights (",t.highlights.length,")"]})]}),b.jsxs("div",{className:"p-4 md:p-8 bg-[#F7F8FB] dark:bg-slate-900/50 min-h-[400px]",children:[(g==="info"||le)&&b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8",children:[b.jsx("div",{className:le?"md:col-span-3":"md:col-span-2 space-y-6",children:b.jsxs("div",{className:`bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm ${le?"min-h-[300px]":""}`,children:[!le&&b.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 md:mb-4",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(Kc,{size:18,className:"text-[#262D40]/90 dark:text-[#262D40]/82 md:w-5 md:h-5"}),b.jsx("h3",{className:"text-base md:text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Summary"})]}),b.jsxs("button",{type:"button",onClick:se,disabled:j,className:"flex items-center gap-1.5 text-[11px] md:text-xs font-semibold text-white px-2 py-1 rounded-lg border border-[#262D40] bg-[#262D40] hover:bg-[#1d2333] disabled:opacity-60",children:[j?b.jsx(mr,{size:14,className:"animate-spin"}):b.jsx(ka,{size:14}),j?"Generating...":"Generate with AI"]})]}),(le?t.generalNotes:t.summaryText||t.generalNotes)?le?b.jsx("div",{className:"personal-note-render text-slate-700 dark:text-slate-300 leading-relaxed text-sm md:text-base max-w-none",dangerouslySetInnerHTML:{__html:K2(t.generalNotes)}}):b.jsx("p",{className:"text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed text-sm md:text-lg",children:t.summaryText||t.generalNotes}):b.jsx("p",{className:"text-slate-400 dark:text-slate-500 italic text-sm",children:"No content added."}),G&&b.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2 flex items-center gap-1",children:[b.jsx(Yc,{size:12})," ",G]})]})}),!le&&b.jsx("div",{className:"space-y-4 md:space-y-6",children:b.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm space-y-4",children:[b.jsx("h3",{className:"text-xs md:text-sm font-semibold text-slate-900 dark:text-white uppercase tracking-wider mb-2 md:mb-4",children:"Information"}),t.publisher&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:t.type==="ARTICLE"?"Journal":"Publisher"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publisher})]}),t.publicationYear&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Year"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publicationYear})]}),t.translator&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Translator"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.translator})]}),t.isbn&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"ISBN"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 font-mono",children:t.isbn})]}),t.pageCount&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Page Count"}),b.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[t.pageCount," pages"]})]}),X&&X.status!=="NOT_FOUND"&&!Ce&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"PDF"}),b.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[ze&&"Processing...",rt&&"Failed - please re-upload",Ae&&b.jsxs(b.Fragment,{children:[X.file_name?b.jsx("span",{title:X.file_name,children:`Indexed: ${V(X.file_name)}`}):"Indexed",X.chunk_count!==null?` (${X.chunk_count} chunks)`:""]})]}),(ze||M)&&b.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[b.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700 overflow-hidden",children:b.jsx("div",{className:"h-full rounded-full bg-sky-500 transition-all duration-500",style:{width:`${gt}%`}})}),b.jsx("button",{type:"button",onClick:jt,className:"text-[10px] md:text-xs text-sky-600 dark:text-sky-400 underline underline-offset-2",children:"Yenile"})]}),je&&b.jsx("span",{className:"text-[10px] md:text-xs text-red-600 dark:text-red-400",children:je})]}),t.code&&b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Shelf Code"}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(w0,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.code})]})]}),b.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[b.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Added"}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(Xc,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),b.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:new Date(t.addedAt).toLocaleDateString()})]})]})]})})]}),!le&&g==="highlights"&&b.jsxs("div",{className:"space-y-6",children:[t.highlights.length>0&&b.jsx("div",{className:"flex justify-end",children:b.jsxs("button",{onClick:We,disabled:T,className:"text-xs md:text-sm text-[#262D40] dark:text-[#262D40]/82 hover:text-[#262D40] dark:hover:text-[#262D40]/78 flex items-center gap-2 disabled:opacity-50",children:[b.jsx(ka,{size:14,className:"md:w-4 md:h-4"}),T?"Analyzing...":"Analyze Highlights with AI"]})}),v&&b.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 border border-[#262D40]/8 dark:border-[#262D40]/70 p-3 md:p-4 rounded-lg mb-4 animate-in fade-in slide-in-from-top-2",children:[b.jsxs("h4",{className:"text-[#262D40] dark:text-[#262D40]/78 font-semibold text-xs md:text-sm mb-2 flex items-center gap-2",children:[b.jsx(ka,{size:14})," AI Analysis"]}),b.jsxs("p",{className:"text-[#262D40] dark:text-[#262D40]/75 text-xs md:text-sm leading-relaxed italic",children:['"',v,'"']})]}),b.jsx(vq,{highlights:t.highlights,onUpdate:s,autoEditHighlightId:c})]})]})]})]})}),O6="/assets/logo_v9-D75hAm-V.png",_6=L.createContext(void 0),_q=({children:t})=>{const[e,n]=L.useState("light");L.useEffect(()=>{const s=localStorage.getItem("theme");s?n(s):window.matchMedia("(prefers-color-scheme: dark)").matches&&n("dark")},[]),L.useEffect(()=>{const s=window.document.documentElement;e==="dark"?s.classList.add("dark"):s.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const r=()=>{n(s=>s==="light"?"dark":"light")};return b.jsx(_6.Provider,{value:{theme:e,toggleTheme:r},children:t})},Rq=()=>{const t=L.useContext(_6);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},Mq=({activeTab:t,onTabChange:e,isOpen:n,onClose:r})=>{const{theme:s,toggleTheme:i}=Rq(),c=[{id:"DASHBOARD",label:"Dashboard",icon:sN},{id:"SMART_SEARCH",label:"Search (Layer 2)",icon:R0},{id:"RAG_SEARCH",label:"LogosChat (Layer 3)",icon:oN},{id:"FLOW",label:"Flux (Layer 4)",icon:KI},{id:"BOOK",label:"Books",icon:Bx},{id:"ARTICLE",label:"Articles",icon:a0},{id:"WEBSITE",label:"Websites",icon:o0},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:aN},{id:"NOTES",label:"All Notes",icon:iN}];return b.jsxs(b.Fragment,{children:[n&&b.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-40 lg:hidden backdrop-blur-sm",onClick:r}),b.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50 w-[269px] bg-[#262D40] border-r border-white/10 transform transition-transform duration-300 ease-in-out flex flex-col shadow-xl lg:shadow-none h-full
        ${n?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:[b.jsxs("div",{className:"px-3 pt-0 pb-3 flex flex-col items-center border-b border-white/10 bg-[#262D40] gap-2 relative",children:[b.jsx("img",{src:O6,alt:"TomeHub Icon",className:"h-[68px] lg:h-[77px] w-auto object-contain brightness-110 drop-shadow-md"}),b.jsx("button",{onClick:r,className:"lg:hidden absolute top-2 right-3 p-1 hover:bg-white/10 rounded-full text-white/70 hover:text-white transition-colors",children:b.jsx(wi,{size:20})})]}),b.jsx("nav",{className:"flex-1 px-3 pt-2 pb-6 space-y-1 overflow-y-auto",children:c.map(f=>{const p=f.icon,g=t===f.id;return b.jsxs("button",{onClick:()=>{e(f.id),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${g?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[b.jsx(p,{className:`w-[18px] h-[18px] lg:w-5 lg:h-5 transition-colors ${g?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),f.label]},f.id)})}),b.jsxs("div",{className:"p-3 border-t border-white/10",children:[b.jsxs("button",{onClick:()=>{e("PROFILE"),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${t==="PROFILE"?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[b.jsx(U2,{className:`w-[17px] h-[17px] lg:w-5 lg:h-5 transition-colors ${t==="PROFILE"?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),"Profile"]}),b.jsx("button",{onClick:i,className:"w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium text-white/70 hover:bg-white/5 hover:text-white transition-all duration-200 group mt-1",children:s==="light"?b.jsxs(b.Fragment,{children:[b.jsx(xR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-white/60 group-hover:text-white"}),"Dark Mode"]}):b.jsxs(b.Fragment,{children:[b.jsx(ZR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-amber-400"}),"Light Mode"]})})]}),b.jsx("div",{className:"p-4 border-t border-white/10",children:b.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[b.jsx("p",{className:"text-[13px] text-white/70 font-medium mb-1",children:"My Personal Library"}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CC561E] animate-pulse"}),b.jsx("p",{className:"text-[11px] text-white/50 uppercase tracking-wider font-semibold",children:"Online"})]})]})})]})]})},Iq=({books:t,userId:e})=>{const[n,r]=L.useState(!1),[s,i]=L.useState(0),[c,f]=L.useState({success:0,failed:0,total:0}),[p,g]=L.useState(""),[C,v]=L.useState(null),[A,T]=L.useState(!1),_=async()=>{if(!e)return;r(!0),v(null),T(!1);let M=0,R=0;f({success:0,failed:0,total:t.length});const j=t.map(U=>{if(er(U)&&!uN(U))return null;let ee="";return U.type==="PERSONAL_NOTE"?(ee=Jc(U.generalNotes||"")||U.title,U.highlights&&U.highlights.length>0&&(ee+=`

`+U.highlights.map(X=>X.text).join(`

`))):(ee=`Title: ${U.title}
Author: ${U.author}
`,U.generalNotes&&(ee+=`
Summary/Notes: ${Jc(U.generalNotes)}`),U.tags&&U.tags.length>0&&(ee+=`
Tags: ${U.tags.join(", ")}`)),{text:ee,title:U.title,author:U.author,type:er(U)?dN(U):U.type,book_id:U.id,tags:U.tags}}).filter(U=>!!U&&U.text.length>20),H=j.length,G=20,Z=[];for(let U=0;U<j.length;U+=G)Z.push(j.slice(U,U+G));let J=0;for(let U=0;U<Z.length;U++){const ee=Z[U];g(`Batch ${U+1}/${Z.length} (${ee.length} items)`);try{const X=await HW(ee,e);X.success&&X.results&&(M+=X.results.success,R+=X.results.failed)}catch(X){console.error(`Batch ${U+1} failed:`,X),R+=ee.length}J+=ee.length,i(Math.round(J/H*100)),f(X=>({...X,success:M,failed:R+(t.length-H)}))}const oe=t.filter(U=>U.highlights&&U.highlights.length>0);if(oe.length>0){g("Syncing highlights...");for(const U of oe)try{await E6(e,U.id,U.title,U.author,U.highlights||[])}catch(ee){console.error(`Highlight sync failed for ${U.title}:`,ee)}}r(!1),T(!0),g("")};return b.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-slate-50 dark:from-[#262D40]/20 dark:to-slate-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:b.jsxs("div",{className:"p-6 md:p-8",children:[b.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[b.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:b.jsx(C_,{size:24})}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Migrate to AI Library"}),b.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Sync your existing books and notes to the new AI backend to make them searchable."})]})]}),b.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[b.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:n?"Migration in Progress...":"Ready to Sync"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:A?b.jsxs("span",{className:"text-[#262D40] font-medium",children:["Migration Complete! ",c.success," items synced."]}):n?b.jsxs("span",{children:["Syncing: ",b.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:p})]}):b.jsxs("span",{children:["Sync ",t.length," items to Oracle AI Vector Database."]})})]}),!n&&!A&&b.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-6 py-3 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg font-medium transition-colors shadow-md shadow-[#CC561E]/20 dark:shadow-none",children:[b.jsx(jA,{size:18,fill:"currentColor"}),"Start Migration"]}),n&&b.jsxs("div",{className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-slate-500 rounded-lg border border-slate-200 dark:border-slate-700",children:[b.jsx(mr,{size:18,className:"animate-spin"}),"Processing..."]})]}),(n||A)&&b.jsxs("div",{className:"mt-6",children:[b.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[b.jsx("span",{children:"Progress"}),b.jsxs("span",{children:[s,"%"]})]}),b.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:b.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:`${s}%`}})}),b.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[b.jsxs("span",{children:[c.success+c.failed,"/",c.total," items"]}),b.jsxs("span",{children:["Success: ",c.success,"  Failed: ",c.failed]})]})]})]})]})})},Dq=()=>{const{user:t}=p1(),[e,n]=L.useState(!1),[r,s]=L.useState(0),[i,c]=L.useState(0),[f,p]=L.useState(!1),[g,C]=L.useState(null),v=L.useRef(null),A=async M=>{var H;const R=(H=M.target.files)==null?void 0:H[0];if(!R)return;if(!R.name.toLowerCase().endsWith(".json")){C("Please upload a valid JSON file.");return}const j=new FileReader;j.onload=async G=>{var Z;try{const J=(Z=G.target)==null?void 0:Z.result,oe=JSON.parse(J);if(!Array.isArray(oe))throw new Error("JSON must be an array of books.");await T(oe)}catch(J){console.error("File parsing error:",J),C("Failed to parse JSON file. Make sure it's a valid list of books.")}},j.onerror=()=>{C("Error reading file.")},j.readAsText(R)},T=async M=>{if(!t)return;n(!0),C(null),p(!1),c(M.length),s(0);let R=0;try{for(const j of M){const H={id:Date.now().toString()+Math.random().toString(36).substr(2,9),type:"BOOK",title:j.title||"Untitled",author:j.author||"Unknown Author",status:"On Shelf",readingStatus:"To Read",tags:[],highlights:[],addedAt:Date.now(),coverUrl:j.coverUrl||void 0};await Fc(t.uid,H);try{const G=`Title: ${H.title}
Author: ${H.author}`;await C6(G,H.title,H.author,H.type,t.uid,{book_id:H.id,tags:H.tags||[]})}catch(G){console.error("Import sync to AI backend failed:",G)}R++,s(R),await new Promise(G=>setTimeout(G,50))}p(!0),v.current&&(v.current.value="")}catch(j){console.error("Import failed:",j),C("Failed to import books. Please try again.")}finally{n(!1)}},_=()=>{var M;(M=v.current)==null||M.click()};return b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 md:p-8 mt-6",children:[b.jsxs("div",{className:"flex items-start justify-between mb-4",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Import Books"}),b.jsx("p",{className:"text-slate-500 mt-1",children:"Upload a JSON file to add books to your library."})]}),b.jsx("div",{className:"p-3 bg-[#262D40]/5 text-[#262D40] rounded-lg",children:b.jsx(IA,{size:24})})]}),g&&b.jsxs("div",{className:"mb-4 p-4 bg-red-50 text-red-700 rounded-lg flex items-center gap-2",children:[b.jsx(Yc,{size:20}),g]}),f?b.jsxs("div",{className:"mb-4 p-4 bg-green-50 text-green-700 rounded-lg flex items-center gap-2",children:[b.jsx(z2,{size:20}),"Successfully imported ",i," books!"]}):null,e?b.jsxs("div",{className:"space-y-2",children:[b.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[b.jsx("span",{children:"Importing..."}),b.jsxs("span",{children:[Math.round(r/i*100),"%"]})]}),b.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2.5 overflow-hidden",children:b.jsx("div",{className:"bg-[#262D40]/40 h-2.5 rounded-full transition-all duration-300",style:{width:`${r/i*100}%`}})}),b.jsxs("p",{className:"text-xs text-slate-400 text-center mt-2",children:[r," / ",i," books processed"]})]}):b.jsxs(b.Fragment,{children:[b.jsx("input",{type:"file",ref:v,onChange:A,accept:".json",className:"hidden"}),b.jsxs("button",{onClick:_,disabled:e,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white shadow-md hover:shadow-lg",children:[b.jsx(E0,{size:20}),"Select JSON File"]})]})]})},Lq=({books:t})=>{const[e,n]=L.useState(!1),[r,s]=L.useState(!1),[i,c]=L.useState(null),f=()=>{try{n(!0),c(null),s(!1);const p=t.map(_=>({..._,id:_.id,type:_.type,title:_.title,author:_.author,status:_.status,readingStatus:_.readingStatus,tags:_.tags,highlights:_.highlights,addedAt:_.addedAt,generalNotes:_.generalNotes,coverUrl:_.coverUrl,isbn:_.isbn,publisher:_.publisher,publicationYear:_.publicationYear,translator:_.translator,code:_.code,url:_.url,lentTo:_.lentTo,lentDate:_.lentDate})),g=JSON.stringify(p,null,2),C=new Blob([g],{type:"application/json"}),v=URL.createObjectURL(C),A=document.createElement("a");A.href=v;const T=new Date().toISOString().split("T")[0];A.download=`tomehub-export-${T}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(v),s(!0),n(!1),setTimeout(()=>{s(!1)},3e3)}catch(p){console.error("Export failed:",p),c("Failed to export library. Please try again."),n(!1)}};return b.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 md:p-8 mt-6",children:[b.jsxs("div",{className:"flex items-start justify-between mb-4",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Export Library"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Download your entire library as a JSON file."})]}),b.jsx("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg",children:b.jsx(IA,{size:24})})]}),i&&b.jsxs("div",{className:"mb-4 p-4 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg flex items-center gap-2 border border-[#262D40]/8 dark:border-[#262D40]/30",children:[b.jsx(Yc,{size:20}),i]}),r&&b.jsxs("div",{className:"mb-4 p-4 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 rounded-lg flex items-center gap-2 border border-orange-100 dark:border-orange-900/30",children:[b.jsx(z2,{size:20}),"Successfully exported ",t.length," items!"]}),b.jsxs("button",{onClick:f,disabled:e||t.length===0,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#CC561E] dark:bg-[#CC561E] hover:bg-[#b34b1a] text-white shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[b.jsx(S_,{size:20}),t.length===0?"No Items to Export":`Export ${t.length} Items`]}),b.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 text-center mt-3",children:"Exports all books, articles, websites, and notes with highlights"})]})},jq=({userId:t,email:e,onLogout:n,onBack:r,books:s,onStartEnrichment:i,onStopEnrichment:c,isEnriching:f,enrichmentStats:p})=>{const g=s.filter(C=>C.type==="BOOK"&&(!C.generalNotes||C.generalNotes.length<10)&&(!C.tags||C.tags.length===0)).length;return b.jsxs("div",{className:"p-6 md:p-10 max-w-[1100px] w-full mx-auto animate-in fade-in slide-in-from-bottom-4",children:[b.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white mb-6 transition-colors group",children:[b.jsx(OA,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),b.jsx("span",{className:"font-medium",children:"Back"})]}),b.jsxs("div",{className:"mb-8",children:[b.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Profile"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Manage your account settings"})]}),b.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden mb-8",children:[b.jsxs("div",{className:"p-6 md:p-8 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-start md:items-center gap-6",children:[b.jsx("div",{className:"w-20 h-20 bg-[#262D40]/8 dark:bg-[#262D40]/30 rounded-full flex items-center justify-center text-[#262D40] dark:text-[#262D40]/82",children:b.jsx(U2,{size:40})}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Account Information"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Signed in as"}),b.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-slate-200 mt-1",children:e||"No email available"})]})]}),b.jsx("div",{className:"p-6 md:p-8 bg-slate-50/50 dark:bg-slate-900/50",children:b.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30",children:[b.jsx(uR,{size:20}),"Log Out"]})})]}),b.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-purple-50 dark:from-[#262D40]/20 dark:to-purple-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:b.jsxs("div",{className:"p-6 md:p-8",children:[b.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[b.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:b.jsx(ka,{size:24})}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"AI Library Assistant"}),b.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Automatically fill in missing summaries and tags for your imported books."})]})]}),b.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[b.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:f?"Enrichment in Progress...":"Library Status"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:f?b.jsxs("span",{children:["Processing: ",b.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:p.currentBookTitle||"Initializing..."})]}):b.jsxs("span",{children:[b.jsx("span",{className:"font-bold text-[#262D40] dark:text-[#262D40]/82",children:g})," books are missing details."]})})]}),f?b.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30 shadow-sm",children:[b.jsx($R,{size:18,fill:"currentColor"}),"Stop"]}):b.jsxs("button",{onClick:()=>i(s),disabled:g===0,className:"flex items-center gap-2 px-6 py-3 bg-[#262D40]/40 dark:bg-[#262D40]/30 text-white hover:bg-[#262D40]/55 dark:hover:bg-[#262D40]/40 rounded-lg font-medium transition-colors shadow-md shadow-[#262D40]/12 dark:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",children:[b.jsx(jA,{size:18,fill:"currentColor"}),"Auto-fill Missing Info"]})]}),f&&b.jsxs("div",{className:"mt-6",children:[b.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[b.jsx("span",{children:"Progress"}),b.jsxs("span",{children:[Math.round(p.processed/p.total*100),"%"]})]}),b.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:b.jsx("div",{className:"h-full bg-[#262D40]/30 dark:bg-[#262D40]/24 transition-all duration-500 ease-out",style:{width:`${p.processed/p.total*100}%`}})}),b.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[b.jsxs("span",{children:["Processed: ",p.processed,"/",p.total]}),b.jsxs("span",{children:["Success: ",p.success,"  Failed: ",p.failed]})]})]})]})]})}),b.jsx(Iq,{books:s,userId:t}),b.jsx(Dq,{}),b.jsx(Lq,{books:s})]})},Bq=({data:t,onBarClick:e,currentStartPage:n,currentEndPage:r})=>{const{maxPage:s,maxCount:i,bars:c}=L.useMemo(()=>{if(!t||t.length===0)return{maxPage:0,maxCount:0,bars:[]};const f=Math.max(...t.map(g=>g.page_number)),p=Math.max(...t.map(g=>g.count));return{maxPage:f,maxCount:p,bars:t}},[t]);return c.length===0?null:b.jsxs("div",{className:"w-full space-y-2",children:[b.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-mono uppercase tracking-wider",children:[b.jsx("span",{children:"Page 1"}),b.jsx("span",{children:"Distribution Timeline"}),b.jsxs("span",{children:["Page ",s]})]}),b.jsxs("div",{className:"relative w-full h-[60px] bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden flex items-end",children:[b.jsxs("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none p-[1px]",children:[b.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"}),b.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"})]}),c.map(f=>{const p=(f.page_number-1)/s*100,g=f.count/i*100,C=f.count>i*.7;return b.jsxs("div",{onClick:()=>e&&e(f.page_number),className:"absolute bottom-0 cursor-pointer transition-all hover:opacity-80 group",style:{left:`${p}%`,height:`${g}%`,width:`max(2px, ${100/s}%)`,minHeight:"4px"},children:[b.jsx("div",{className:`w-full h-full rounded-t-sm ${C?"bg-[#262D40]/30 dark:bg-[#262D40]/24":"bg-[#262D40]/18 dark:bg-[#262D40]/40"}`}),b.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block z-20 whitespace-nowrap",children:b.jsxs("div",{className:"bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg",children:["Page ",f.page_number,": ",f.count," hits"]})})]},f.page_number)})]})]})},R6=({bookId:t,term:e,initialContexts:n=[],firebaseUid:r,onClose:s})=>{const[i,c]=It.useState(n||[]),[f,p]=It.useState(!1),[g,C]=It.useState((i==null?void 0:i.length)||0),[v,A]=It.useState(((i==null?void 0:i.length)||0)>=10),[T,_]=It.useState([]);L.useEffect(()=>{(async()=>{try{const H=await WW(r,t,e);_(H.distribution||[])}catch(H){console.error("Dist fetch failed",H)}})()},[t,e,r]);const M=async()=>{if(!f){p(!0);try{const j=await GW(r,t,e,50,g);j.contexts.length>0?(c(H=>[...H,...j.contexts]),C(H=>H+j.contexts.length)):A(!1)}catch(j){console.error("Failed to load more contexts:",j)}finally{p(!1)}}},R=(j,H)=>{if(!H)return j;const G=j.split(new RegExp(`(${H})`,"gi"));return b.jsx(b.Fragment,{children:G.map((Z,J)=>Z.toLowerCase()===H.toLowerCase()?b.jsx("mark",{className:"bg-yellow-200 text-slate-900 font-semibold rounded-sm px-0.5",children:Z},J):Z)})};return b.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-950 border-l border-slate-200 dark:border-slate-800 shadow-xl animate-in slide-in-from-right duration-300",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-900 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[b.jsxs("div",{children:[b.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:['"',e,'" Balamlar']}),b.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total occurrences found"})]}),b.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-500",children:b.jsx(wi,{size:20})})]}),b.jsxs("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 m-4 rounded-lg border border-[#262D40]/8 dark:border-[#262D40]/70 flex gap-3 text-xs text-[#262D40] dark:text-[#262D40]/78",children:[b.jsx(Y_,{size:16,className:"shrink-0 mt-0.5"}),b.jsx("p",{children:"Bu liste, kelimenin kitaptaki farkl formlarn (ekim ekleri, kk formlar) ve getii orijinal pasajlar gsterir."})]}),b.jsx("div",{className:"px-4 pb-2",children:b.jsx(Bq,{data:T})}),b.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[i.map((j,H)=>b.jsxs("div",{className:"group relative",children:[b.jsxs("div",{className:"flex justify-between items-start mb-1 text-[10px] items-center",children:[b.jsxs("span",{className:"font-semibold text-[#262D40] dark:text-[#262D40]/82 bg-[#262D40]/5 dark:bg-[#262D40]/40 px-1.5 py-0.5 rounded uppercase tracking-wider",children:["Sayfa ",j.page_number]}),b.jsxs("button",{className:"text-slate-300 group-hover:text-slate-500 dark:text-slate-700 dark:group-hover:text-slate-400 flex items-center gap-1 transition-colors",children:[b.jsx("span",{className:"text-[9px]",children:"GRNTLE"}),b.jsx(Pp,{size:10})]})]}),b.jsx("div",{className:"text-sm md:text-base text-slate-700 dark:text-slate-300 leading-relaxed font-lora border-l-2 border-slate-100 dark:border-slate-800 pl-4 py-1 italic hover:border-[#262D40]/18 dark:hover:border-[#262D40]/55 transition-colors",children:R(j.snippet,j.keyword_found)})]},H)),v&&b.jsx("button",{onClick:M,disabled:f,className:"w-full py-4 text-sm font-medium text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-xl hover:border-[#262D40]/12 dark:hover:border-[#262D40]/70 hover:bg-slate-50 dark:hover:bg-slate-900 transition-all flex items-center justify-center gap-2",children:f?b.jsxs(b.Fragment,{children:[b.jsx(mr,{size:16,className:"animate-spin"}),"Ykleniyor..."]}):"Daha Fazla Balam Ykle"})]})]})},Pq=new Set(["ve","veya","ile","ama","fakat","ancak","lakin","ki","de","da","gibi","icin","iin","gore","gre","kadar","hem","ya","yada","yahut","mi","mu","m","m"]);function Fq({userId:t,onBack:e,books:n=[]}){const[r,s]=L.useState(""),[i,c]=L.useState([]),[f,p]=L.useState(!1),[g,C]=L.useState(null),[v,A]=L.useState(!1),[T,_]=L.useState(null),[M,R]=L.useState(!1),[j,H]=L.useState(0),[G,Z]=L.useState(0),J=20,oe=(ee,X)=>{if(!X||!ee)return ee;const Qe={i:"[iI]",:"[iI]",s:"[sS]",:"[sS]",c:"[cC]",:"[cC]",g:"[gG]",:"[gG]",o:"[oO]",:"[oO]",u:"[uU]",:"[uU]"},je=X.toLowerCase().split(/\s+/).map(ue=>ue.trim()).filter(ue=>ue.length>=2&&!Pq.has(ue));if(je.length===0)return ee;try{const ue=je.map(ne=>ne.split("").map(ie=>Qe[ie]||ie).join("")),Ie=new RegExp(`((?<![\\p{L}\\p{N}])(?:${ue.join("|")})[\\p{L}\\p{N}]*(?![\\p{L}\\p{N}]))`,"giu");return ee.split(Ie).map((ne,ie)=>ie%2===1?b.jsx("mark",{className:"bg-[rgba(204,86,30,0.12)] dark:bg-[rgba(204,86,30,0.25)] text-[#111827] dark:text-white px-0.5 rounded font-medium shadow-sm transition-colors duration-200",children:ne},ie):b.jsx("span",{children:ne},ie))}catch{return ee}},U=async(ee,X=0)=>{var Qe,je,ue;if(ee&&ee.preventDefault(),!!r.trim()){p(!0),C(null),X===0&&(c([]),A(!0)),H(X);try{const Ie=`${Kt}/api/smart-search`;console.log("[SmartSearch] Calling:",Ie,"Offset:",X);const Ze=await $n(Ie,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:r,firebase_uid:t,limit:J,offset:X})});if(!Ze.ok)throw new Error(await Ei(Ze,"Search failed"));const ne=await Ze.json();((Qe=ne.metadata)==null?void 0:Qe.status)==="analytic"&&((je=ne.metadata)!=null&&je.analytics)?(_({...ne.metadata.analytics,answer:ne.answer}),c([]),Z(0)):(c(ne.results||[]),Z(ne.total||((ue=ne.results)==null?void 0:ue.length)||0),_(null))}catch(Ie){console.error("[SmartSearch] Error:",Ie),C(Pc(Ie))}finally{p(!1)}}};return b.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${v?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[b.jsxs("div",{className:"relative flex items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[b.jsx("div",{className:"flex-shrink-0 z-10",children:e&&b.jsxs("button",{onClick:e,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(Mo,{size:16})}),b.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),v&&b.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[b.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:b.jsx(R0,{className:"w-5 h-5 md:w-8 md:h-8"})}),b.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"Search"})]}),b.jsx("div",{className:"w-20 hidden sm:block"})," "]}),b.jsx("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${v?"pt-4 md:pt-6":"justify-center items-center"}`,children:b.jsxs("form",{onSubmit:U,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${v?"max-w-none":"max-w-2xl text-center"}`,children:[!v&&b.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[b.jsxs("div",{className:"flex items-center justify-center gap-3",children:[b.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0",children:b.jsx(R0,{className:"w-6 h-6 md:w-10 md:h-10"})}),b.jsx("h1",{className:"text-2xl md:text-5xl font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight",children:"Search"})]}),b.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 md:gap-4 mt-4 opacity-80",children:[b.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[b.jsx(ka,{className:"w-3 h-3 text-[#CC561E]"})," AI Query Expansion"]}),b.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[b.jsx(oM,{className:"w-3 h-3"})," Typo Correction"]}),b.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[b.jsx(Tl,{className:"w-3 h-3"})," Hybrid Retrieval"]})]})]}),b.jsxs("div",{className:"relative group",children:[b.jsx(Ea,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),b.jsx("input",{type:"text",value:r,onChange:ee=>s(ee.target.value),placeholder:"Search your library intelligently...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400"})]}),b.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${v?"text-left":"text-center"}`,children:["Tip: ",b.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search."]})]})}),g&&b.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/78 p-5 rounded-2xl flex items-center gap-4 border border-[#262D40]/8 dark:border-[#262D40]/50 shadow-sm",children:[b.jsx(Yc,{className:"w-6 h-6 shrink-0"}),b.jsx("p",{className:"font-medium",children:g})]}),b.jsx("div",{className:"space-y-6 pb-12 mt-6",children:i.length>0?b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"flex items-center justify-between px-2",children:b.jsxs("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider",children:["Found ",G," relevant items"]})}),b.jsx("div",{className:"grid gap-5",children:i.map((ee,X)=>b.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 border border-[#E6EAF2] dark:border-gray-700 transition-all duration-300",children:[b.jsxs("div",{className:"flex justify-between items-start mb-4",children:[b.jsxs("h3",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 flex items-center gap-3 group-hover:text-[#CC561E] transition-colors",children:[b.jsx(Tl,{className:"w-5 h-5 text-[#CC561E]"}),oe(ee.title,r)]}),b.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[ee.match_type==="content_exact"&&b.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Match"}),ee.match_type==="semantic"&&b.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Semantic"}),b.jsxs("span",{className:"bg-[#262D40] text-white text-xs px-3 py-1 rounded-full font-mono font-medium ring-1 ring-white/10",children:["p.",ee.page_number]})]})]}),b.jsx("div",{className:"pl-5 border-l-4 border-[#262D40]/10 group-hover:border-[#CC561E]/30 transition-colors",children:b.jsx("p",{className:"text-gray-700 dark:text-gray-200 leading-relaxed text-base whitespace-pre-wrap font-serif",children:oe(ee.content_chunk,r)})}),(ee.comment||ee.personal_comment)&&b.jsxs("div",{className:"mt-4 pt-4 border-t border-[#E6EAF2] dark:border-gray-700 bg-[rgba(204,86,30,0.08)] dark:bg-[rgba(204,86,30,0.1)] -mx-6 px-6 py-4 rounded-b-2xl",children:[b.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#CC561E] block mb-1",children:"Comment:"}),b.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 italic border-l-2 border-[#CC561E]/30 pl-3",children:oe(ee.comment||ee.personal_comment||"",r)})]})]},X))}),G>J&&b.jsxs("div",{className:"flex items-center justify-between mt-10 pt-6 border-t border-[#E6EAF2] dark:border-gray-700",children:[b.jsxs("button",{onClick:()=>U(void 0,Math.max(0,j-J)),disabled:f||j===0,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:[b.jsx(Mo,{size:20}),"Previous"]}),b.jsxs("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:["Page ",Math.floor(j/J)+1," of ",Math.ceil(G/J)]}),b.jsxs("button",{onClick:()=>U(void 0,j+J),disabled:f||j+J>=G,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:["Next",b.jsx(Mo,{size:20,className:"rotate-180"})]})]})]}):v&&!f&&!g?b.jsxs("div",{className:"text-center py-24 opacity-60",children:[b.jsx("div",{className:"bg-[#F3F5FA] dark:bg-gray-800 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6",children:b.jsx(Ea,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),b.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"No results found"})]}):null}),T&&b.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-xl border-t-4 border-[#CC561E] animate-in zoom-in duration-300 relative overflow-hidden",children:[b.jsx("div",{className:"absolute right-[-20px] top-[-20px] opacity-[0.03] dark:opacity-[0.05] pointer-events-none",children:b.jsx(R_,{size:220})}),b.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] text-xs font-bold uppercase tracking-widest",children:[b.jsx(ka,{size:12}),"Deterministic Analytics"]}),b.jsx("h3",{className:"text-3xl font-extrabold text-slate-900 dark:text-white leading-tight",children:T.answer})]}),T.contexts&&T.contexts.length>0&&b.jsxs("button",{onClick:()=>R(!0),className:"group flex items-center gap-3 bg-[#CC561E] hover:bg-[#b34b1a] text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-[#CC561E]/30 transition-all hover:scale-[1.02] active:scale-[0.98]",children:[b.jsx(DA,{size:20,className:"group-hover:rotate-12 transition-transform"}),"See Contexts"]})]})]}),M&&T&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[b.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>R(!1)}),b.jsx("div",{className:"relative w-full max-w-lg h-full overflow-hidden",children:b.jsx(R6,{bookId:T.resolved_book_id||"",term:T.term,initialContexts:T.contexts,firebaseUid:t,onClose:()=>R(!1)})})]})]})}const zq=(t,e)=>{const[n,r]=L.useState(!1),[s,i]=L.useState({total:0,processed:0,success:0,failed:0}),c=L.useRef(!1),f=L.useCallback(async g=>{const C=g.filter(A=>A.type==="BOOK"&&(!(A.summaryText||A.generalNotes)||(A.summaryText||A.generalNotes||"").length<10)&&(!A.tags||A.tags.length===0));if(C.length===0){alert("No books found that need enrichment!");return}r(!0),c.current=!1,i({total:C.length,processed:0,success:0,failed:0,currentBookTitle:""});const v=5;for(let A=0;A<C.length&&!c.current;A+=v){const T=C.slice(A,A+v),_=T.map(M=>M.title).join(", ");i(M=>({...M,currentBookTitle:`Batch: ${_.substring(0,30)}...`}));try{A>0&&await new Promise(j=>setTimeout(j,2e3));const M=T.map(j=>f1(j)),R=await g6(M);for(let j=0;j<T.length;j++){const H=T[j],G=R.find(Z=>Z.title===H.title)||R[j];if(G){const Z=h1(H,G);await Fc(t,Z),e(Z),i(J=>({...J,processed:J.processed+1,success:J.success+1}))}else i(Z=>({...Z,processed:Z.processed+1,failed:Z.failed+1}))}}catch(M){console.error(`Failed to enrich batch starting at ${A}:`,M),i(R=>({...R,processed:R.processed+T.length,failed:R.failed+T.length}))}}r(!1),i(A=>({...A,currentBookTitle:void 0}))},[t,e]),p=L.useCallback(()=>{c.current=!0},[]);return{isEnriching:n,stats:s,startEnrichment:f,stopEnrichment:p}},Uq=({state:t})=>{const[e,n]=L.useState(!1);return!t.active_topic&&(!t.assumptions||t.assumptions.length===0)?null:b.jsx("div",{className:"sticky top-0 z-10 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border-b border-[#CC561E]/10 dark:border-slate-700 shadow-sm transition-all",children:b.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-2 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>n(!e),children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[b.jsx("div",{className:"p-1.5 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-md flex-shrink-0",children:b.jsx(MA,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),b.jsxs("div",{className:"min-w-0",children:[b.jsx("p",{className:"text-[10px] font-bold text-[#CC561E] dark:text-[#f3a47b] uppercase tracking-widest",children:"Current Topic"}),b.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:t.active_topic||"Initializing exploration..."})]})]}),b.jsxs("div",{className:"flex items-center gap-3",children:[t.assumptions&&t.assumptions.length>0&&b.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 text-xs px-2 py-1 rounded-full bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border border-amber-100 dark:border-amber-800/50",children:[b.jsx(To,{className:"w-3 h-3"}),t.assumptions.length," Assumptions"]}),e?b.jsx(RA,{className:"w-4 h-4 text-slate-400"}):b.jsx(Cl,{className:"w-4 h-4 text-slate-400"})]})]}),e&&b.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-700 space-y-4 pb-2 animate-fade-in-down",children:[t.assumptions&&t.assumptions.length>0&&b.jsxs("div",{className:"space-y-2",children:[b.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[b.jsx(To,{className:"w-3 h-3"})," Working Assumptions"]}),b.jsx("div",{className:"grid gap-2",children:t.assumptions.map((r,s)=>b.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 bg-amber-50/50 dark:bg-amber-900/10 p-2 rounded border-l-2 border-amber-400",children:[r.text,b.jsxs("span",{className:"ml-2 text-xs text-amber-600 dark:text-amber-500 font-medium opacity-75",children:["(",r.confidence,")"]})]},s))})]}),t.open_questions&&t.open_questions.length>0&&b.jsxs("div",{className:"space-y-2",children:[b.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[b.jsx(h_,{className:"w-3 h-3"})," Open Questions"]}),b.jsx("ul",{className:"space-y-1",children:t.open_questions.map((r,s)=>b.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[b.jsx("span",{className:"text-slate-400 mt-1.5",children:""}),r]},s))})]}),t.established_facts&&t.established_facts.length>0&&b.jsxs("div",{className:"space-y-2",children:[b.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[b.jsx(jd,{className:"w-3 h-3"})," Validated Facts"]}),b.jsx("ul",{className:"space-y-1",children:t.established_facts.map((r,s)=>b.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[b.jsx(jd,{className:"w-3 h-3 text-green-500 mt-0.5 flex-shrink-0"}),b.jsxs("span",{children:[r.text,b.jsxs("span",{className:"ml-1 text-xs text-slate-400",children:["[",r.source,"]"]})]})]},s))})]})]})]})})},Hq=({userId:t,onBack:e})=>{var ie,pe,me,Y,le,V,te,fe,ge,We,se,Be;const[n,r]=L.useState([]),[s,i]=L.useState(""),[c,f]=L.useState(!1),[p,g]=L.useState(null),[C,v]=L.useState(null),[A,T]=L.useState(new Set),[_,M]=L.useState(new Set),[R,j]=L.useState(null),[H,G]=L.useState("AUTO"),[Z,J]=L.useState({}),oe=L.useRef(null),U=L.useRef(null);L.useEffect(()=>{var K;(K=oe.current)==null||K.scrollIntoView({behavior:"smooth"})},[n]),L.useEffect(()=>{var K;(K=U.current)==null||K.focus()},[]);const ee=async()=>{var Ce;if(!s.trim()||c)return;if(!t||t.includes("@")){v("Authentication error. Please refresh the page.");return}const K={id:Date.now(),role:"user",content:s.trim(),timestamp:new Date().toISOString()};r(Ae=>[...Ae,K]),i(""),f(!0),v(null);try{const Ae=await PW(K.content,t,p,"EXPLORER",null,20,H);Ae.session_id&&g(Ae.session_id),Ae.conversation_state&&J(Ae.conversation_state);const ze={id:Date.now()+1,role:"assistant",content:Ae.answer||"",sources:Ae.sources||[],thinkingHistory:Ae.thinking_history||[],timestamp:Ae.timestamp||new Date().toISOString()};r(rt=>[...rt,ze])}catch(Ae){v(Ae instanceof Error?Ae.message:"Failed to send message")}finally{f(!1),(Ce=U.current)==null||Ce.focus()}},X=K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),ee())},Qe=K=>{M(Ce=>{const Ae=new Set(Ce);return Ae.has(K)?Ae.delete(K):Ae.add(K),Ae})},je=K=>{T(Ce=>{const Ae=new Set(Ce);return Ae.has(K)?Ae.delete(K):Ae.add(K),Ae})},ue=()=>{var K;r([]),g(null),v(null),J({}),(K=U.current)==null||K.focus()},Ie=K=>K.replace(/\[DNCE SREC\][\s\S]*?\[\/DNCE SREC\]/,"").replace(/## AAMA 0:[\s\S]*?(?=##)/,"").trim(),Ze=(K,Ce,Ae)=>Ce?K.split(/(\[ID: \d+\])/g).map((rt,ot)=>{const gt=rt.match(/\[ID: (\d+)\]/);if(gt){const jt=parseInt(gt[1]);if(Ce.find(et=>et.id===jt))return b.jsx("button",{onMouseEnter:et=>{const ft=et.currentTarget.getBoundingClientRect();j({id:jt,messageId:Ae||0,x:ft.left,y:ft.top-10})},onMouseLeave:()=>j(null),className:"inline-flex items-center justify-center w-5 h-5 mx-0.5 text-[10px] font-bold bg-[#CC561E]/10 dark:bg-[#CC561E]/20 text-[#CC561E] dark:text-[#f3a47b] rounded-md border border-[#CC561E]/20 dark:border-[#CC561E]/30 hover:bg-[#CC561E] hover:text-white transition-all transform hover:-translate-y-0.5 cursor-help",children:jt},ot)}return rt}):K,ne=(K,Ce,Ae)=>{const ze=Ie(K);let rt=!1;return ze.split(`
`).map((ot,gt)=>{const jt=ot.trim();if(jt.toLowerCase().includes("keif nerileri")||jt.toLowerCase().includes("exploration paths"))return rt=!0,b.jsxs("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 mt-6 mb-3 flex items-center gap-2",children:[b.jsx(MA,{className:"w-4 h-4 text-[#CC561E]"}),jt]},gt);if(jt.startsWith("## ")||jt.startsWith("### ")&&!rt)return b.jsx("h3",{className:"text-base font-bold text-[#CC561E] dark:text-[#f3a47b] mt-5 mb-2",children:jt.replace(/^#+\s+/,"")},gt);if(jt==="")return b.jsx("div",{className:"h-2"},gt);if(rt&&(jt.startsWith("-")||jt.startsWith("")||/^\d+\./.test(jt))){const Pt=jt.replace(/^[-\d.]+\s+/,"");return b.jsx("div",{onClick:()=>{c||i(Pt)},className:"ml-2 mb-2 p-3 bg-white dark:bg-slate-800/50 border border-[#CC561E]/10 dark:border-[#CC561E]/20 rounded-xl shadow-sm hover:shadow-md hover:border-[#CC561E]/40 dark:hover:border-[#CC561E]/60 transition-all cursor-pointer group active:scale-[0.98]",children:b.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-200 flex items-center gap-3",children:[b.jsxs("span",{className:"w-6 h-6 flex-shrink-0 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full flex items-center justify-center text-[10px] font-bold text-[#CC561E] group-hover:bg-[#CC561E] group-hover:text-white transition-colors",children:[gt-10," "]}),Pt]})},gt)}else return b.jsx("p",{className:`text-sm leading-relaxed mb-2 ${rt?"text-slate-500 dark:text-slate-400 italic":"text-slate-700 dark:text-slate-300"}`,children:Ze(ot,Ce,Ae)},gt)})};return b.jsx("div",{className:"flex h-[calc(100vh-120px)] w-full gap-4",children:b.jsxs("div",{className:"flex flex-col flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[b.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-t-xl",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"p-2 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-lg",children:b.jsx(Mx,{className:"w-5 h-5 text-[#CC561E] dark:text-[#f3a47b]"})}),b.jsxs("div",{children:[b.jsx("h2",{className:"font-semibold text-slate-900 dark:text-white",children:"Explorer Mode"}),b.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:p?`Session #${p}  ${n.length} messages`:"New conversation"})]})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("label",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-slate-200 dark:border-slate-700 text-xs text-slate-600 dark:text-slate-300 bg-slate-50 dark:bg-slate-800",children:[b.jsx("input",{type:"checkbox",checked:H==="BOOK_FIRST",onChange:K=>G(K.target.checked?"BOOK_FIRST":"AUTO"),className:"w-3.5 h-3.5 rounded border-slate-300 text-[#CC561E] focus:ring-[#CC561E]/40","aria-label":"Bu kitapla snrla"}),"Bu kitapla snrla"]}),b.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Start new conversation",children:[b.jsx(BA,{className:"w-4 h-4"}),"New"]}),e&&b.jsx("button",{onClick:e,className:"px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Back"})]})]}),b.jsx(Uq,{state:Z}),b.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 dark:bg-slate-900",children:[n.length===0&&!c&&b.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[b.jsx("div",{className:"p-4 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full mb-4",children:b.jsx(Tl,{className:"w-8 h-8 text-[#CC561E] dark:text-[#f3a47b]"})}),b.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"Explorer Mode"}),b.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-md",children:"Ask deep, philosophical questions. I'll analyze your notes dialectically, identify gaps, and expand with general knowledge when needed."}),b.jsx("div",{className:"mt-6 space-y-2",children:["What is the relationship between consciousness and reality?","How do different philosophers define virtue?","Analyze the concept of free will in my notes"].map((K,Ce)=>b.jsx("button",{onClick:()=>i(K),className:"block w-full text-left px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300 hover:bg-[#CC561E]/5 dark:hover:bg-[#CC561E]/10 transition-colors",children:K},Ce))})]}),n.map(K=>b.jsxs("div",{className:`flex gap-3 ${K.role==="user"?"justify-end":"justify-start"}`,children:[K.role==="assistant"&&b.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:b.jsx(AC,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),b.jsxs("div",{className:`max-w-[80%] ${K.role==="user"?"order-first":""}`,children:[K.role==="assistant"&&K.thinkingHistory&&K.thinkingHistory.length>0&&b.jsxs("div",{className:"mb-2",children:[b.jsxs("button",{onClick:()=>Qe(K.id),className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-400 hover:text-[#CC561E] transition-colors",children:[b.jsx(n_,{className:"w-3 h-3"}),_.has(K.id)?"Hide Reflection":"Show Reflection",b.jsxs("span",{className:"opacity-50",children:[" ",K.thinkingHistory.length," Iterations"]})]}),_.has(K.id)&&b.jsx("div",{className:"mt-2 mb-3 space-y-3 bg-slate-100/50 dark:bg-slate-800/50 p-3 rounded-xl border border-dashed border-slate-200 dark:border-slate-700 animate-fade-in",children:K.thinkingHistory.map((Ce,Ae)=>b.jsxs("div",{className:"space-y-1",children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Ce.evaluation.verdict==="PASSED"?"bg-green-500":Ce.evaluation.verdict==="DECLINE"?"bg-red-500":"bg-amber-500"}`}),b.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:["STEP ",Ce.attempt,": ",Ce.evaluation.verdict]})]}),b.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:[b.jsx(F_,{className:"w-2.5 h-2.5"}),(Ce.latency/1e3).toFixed(1),"s"]})]}),b.jsx("div",{className:"h-1 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:b.jsx("div",{className:`h-full transition-all duration-1000 ${Ce.evaluation.overall_score>.7?"bg-green-500":Ce.evaluation.overall_score>.4?"bg-amber-500":"bg-red-500"}`,style:{width:`${Ce.evaluation.overall_score*100}%`}})}),b.jsx("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-snug",children:Ce.evaluation.explanation})]},Ae))})]}),b.jsx("div",{className:`rounded-2xl px-4 py-3 ${K.role==="user"?"bg-[#CC561E] text-white rounded-br-md shadow-lg shadow-[#CC561E]/20":"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-bl-md"}`,children:K.role==="user"?b.jsx("p",{className:"text-sm",children:K.content}):b.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:ne(K.content,K.sources,K.id)})}),K.role==="assistant"&&K.sources&&K.sources.length>0&&b.jsxs("div",{className:"mt-2",children:[b.jsxs("button",{onClick:()=>je(K.id),className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] transition-colors",children:[A.has(K.id)?b.jsx(RA,{className:"w-3 h-3"}):b.jsx(Cl,{className:"w-3 h-3"}),K.sources.length," sources"]}),A.has(K.id)&&b.jsx("div",{className:"mt-2 space-y-1 pl-2 border-l-2 border-[#CC561E]/30 dark:border-[#CC561E]/50",children:K.sources.map((Ce,Ae)=>b.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 py-1 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800/50 rounded px-1",children:[b.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[9px] font-bold",children:Ce.id||Ae+1}),b.jsx("span",{className:"font-medium",children:Ce.title}),b.jsxs("span",{className:"ml-2 text-slate-400 text-[10px]",children:["p.",Ce.page_number]})]},Ae))})]})]}),K.role==="user"&&b.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E] flex items-center justify-center",children:b.jsx(U2,{className:"w-4 h-4 text-white"})})]},K.id)),R&&b.jsx("div",{className:"fixed z-50 pointer-events-none",style:{left:R.x,top:R.y-120},children:b.jsxs("div",{className:"w-64 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl p-4 animate-in fade-in zoom-in duration-200 origin-bottom",children:[(pe=(ie=n.find(K=>K.id===R.messageId))==null?void 0:ie.sources)!=null&&pe.find(K=>K.id===R.id)?b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"flex items-center gap-2 mb-2 text-[#CC561E]",children:[b.jsx(Bd,{className:"w-3 h-3"}),b.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Source Snippet"})]}),b.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-300 leading-relaxed italic mb-3",children:['"...',(V=(le=(Y=(me=n.find(K=>K.id===R.messageId))==null?void 0:me.sources)==null?void 0:Y.find(K=>K.id===R.id))==null?void 0:le.content)==null?void 0:V.slice(0,200),'..."']}),b.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 dark:border-slate-700 pt-2 text-[10px] text-slate-400",children:[b.jsx("span",{className:"font-medium truncate max-w-[120px]",children:(ge=(fe=(te=n.find(K=>K.id===R.messageId))==null?void 0:te.sources)==null?void 0:fe.find(K=>K.id===R.id))==null?void 0:ge.title}),b.jsxs("span",{className:"flex items-center gap-1",children:[b.jsx(Pp,{className:"w-2.5 h-2.5"}),"p.",(Be=(se=(We=n.find(K=>K.id===R.messageId))==null?void 0:We.sources)==null?void 0:se.find(K=>K.id===R.id))==null?void 0:Be.page_number]})]})]}):b.jsx("p",{className:"text-xs text-slate-400",children:"Loading source info..."}),b.jsx("div",{className:"absolute -bottom-1 left-4 w-2 h-2 bg-white dark:bg-slate-800 border-r border-b border-slate-200 dark:border-slate-700 rotate-45"})]})}),c&&b.jsxs("div",{className:"flex gap-3",children:[b.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:b.jsx(AC,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),b.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:b.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[b.jsx(mr,{className:"w-4 h-4 animate-spin"}),"Analyzing deeply..."]})})]}),C&&b.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-300",children:C}),b.jsx("div",{ref:oe})]}),b.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-b-xl",children:b.jsxs("div",{className:"flex gap-3",children:[b.jsx("input",{ref:U,type:"text",value:s,onChange:K=>i(K.target.value),onKeyPress:X,placeholder:"Ask a deep question...",disabled:c,className:"flex-1 px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#CC561E] focus:border-transparent disabled:opacity-50"}),b.jsx("button",{onClick:ee,disabled:!s.trim()||c,className:"px-4 py-3 bg-[#CC561E] hover:bg-[#b34b1a] disabled:bg-slate-300 dark:disabled:bg-slate-800 disabled:text-slate-500 dark:disabled:text-slate-500 disabled:opacity-50 text-white rounded-xl transition-all shadow-lg shadow-[#CC561E]/20 flex items-center gap-2",children:c?b.jsx(mr,{className:"w-5 h-5 animate-spin"}):b.jsx(BR,{className:"w-5 h-5"})})]})})]})})},Vq=({userId:t,userEmail:e,onBack:n,books:r=[]})=>{var je,ue,Ie,Ze;const[s,i]=L.useState(""),[c,f]=L.useState(!1),[p,g]=L.useState(null),[C,v]=L.useState(null),[A,T]=L.useState("none"),[_,M]=L.useState(!1),[R,j]=L.useState("STANDARD"),[H,G]=L.useState(""),[Z,J]=L.useState(!1);if(R==="EXPLORER")return b.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-6 animate-fade-in space-y-4",children:[b.jsx("div",{className:"flex justify-start",children:b.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(Mo,{size:16})}),b.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]})}),b.jsx("div",{className:"flex justify-center mb-2 md:mb-4",children:b.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center",children:[b.jsx("button",{type:"button",onClick:()=>j("STANDARD"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-500 hover:text-slate-700 dark:text-slate-400",children:"Standard"}),b.jsxs("button",{type:"button",className:"px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:[b.jsx(Mx,{className:"w-4 h-4 text-[#CC561E]"})," Explorer"]})]})}),b.jsx(Hq,{userId:t,onBack:()=>j("STANDARD")})]});const oe=async ne=>{if(ne.preventDefault(),!s.trim()){v("Please enter a question");return}if(!t||t.includes("@")){v("Authentication is still loading. Please wait a moment and try again.");return}f(!0),v(null),g(null),T("none");try{const ie=await BW(s,t,"STANDARD");g(ie),G(s)}catch(ie){v(Pc(ie))}finally{f(!1)}},U=async ne=>{var ie;if(!(!p||_)){M(!0);try{await FW({firebase_uid:t,query:H||s,answer:p.answer,rating:ne,search_log_id:(ie=p.metadata)==null?void 0:ie.search_log_id}),T(ne===1?"liked":"disliked")}catch(pe){console.error("Feedback failed:",pe)}finally{M(!1)}}},ee=(p==null?void 0:p.answer)||"",X=Array.from(ee.matchAll(/<think>([\s\S]*?)<\/think>/gi)).map(ne=>(ne[1]||"").trim()).filter(Boolean).join(`

`),Qe=ee.replace(/<think>[\s\S]*?<\/think>/gi,"").replace(/## AAMA 0:[\s\S]*?(?=##|$)/i,"").trim();return b.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${p?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[b.jsxs("div",{className:"relative flex flex-row items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[b.jsx("div",{className:"flex items-center gap-3 md:gap-5 z-10",children:b.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(Mo,{size:16})}),b.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),p&&b.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[b.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:b.jsx(R0,{className:"w-5 h-5 md:w-8 md:h-8"})}),b.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"LogosChat"})]}),b.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center z-10",children:[b.jsx("button",{type:"button",className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:"Standard"}),b.jsxs("button",{type:"button",onClick:()=>j("EXPLORER"),className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all flex items-center gap-1.5 md:gap-2 text-slate-500 hover:text-slate-700 dark:text-slate-400",children:[b.jsx(Mx,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})," Explorer"]})]})]}),b.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${p?"pt-4 md:pt-6":"justify-center items-center"}`,children:[!p&&!c&&b.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-full pointer-events-none -z-10 animate-fade-in",children:[b.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-[#CC561E]/5 dark:bg-[#CC561E]/10 rounded-full blur-[80px] md:blur-[120px]"}),b.jsx("div",{className:"absolute top-1/3 left-1/4 w-[200px] h-[200px] bg-blue-500/5 dark:bg-blue-500/5 rounded-full blur-[100px]"})]}),b.jsxs("form",{onSubmit:oe,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${p?"max-w-none":"max-w-2xl text-center"}`,children:[!p&&!c&&b.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[b.jsxs("div",{className:"flex items-center justify-center gap-3",children:[b.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-xl shrink-0",children:b.jsx(oN,{className:"w-5 h-5 md:w-8 md:h-8"})}),b.jsxs("h1",{className:"text-2xl md:text-4xl font-black text-slate-900 dark:text-white tracking-tight",children:["Logos",b.jsx("span",{className:"text-[#CC561E]",children:"Chat"})]})]}),b.jsx("p",{className:"text-sm md:text-base text-slate-500 dark:text-slate-400 max-w-lg mx-auto leading-relaxed",children:"Analyze your library with intelligence. Ask anything."})]}),b.jsxs("div",{className:"relative group flex items-center",children:[b.jsxs("div",{className:"relative flex-1 group",children:[b.jsx(Ea,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),b.jsx("input",{type:"text",value:s,onChange:ne=>i(ne.target.value),placeholder:"Type your question here...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400",disabled:c})]}),b.jsx("button",{type:"submit",disabled:c||!s.trim(),className:"ml-2 md:ml-3 p-3.5 md:p-5 rounded-2xl bg-[#CC561E] text-white shadow-lg shadow-[#CC561E]/20 hover:bg-[#b04a1a] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed group/btn",children:c?b.jsx(mr,{className:"w-5 h-5 md:w-6 md:h-6 animate-spin"}):b.jsx(Ea,{className:"w-5 h-5 md:w-6 md:h-6 group-hover/btn:scale-110 transition-transform"})})]}),b.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${p?"text-left":"text-center"}`,children:["Tip: ",b.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search. Mention ",b.jsx("span",{className:"font-bold text-[#CC561E]",children:"@book"})," for focus."]})]})]}),C&&b.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 flex items-start gap-3",children:[b.jsx(Yc,{className:"w-5 h-5 text-red-600 shrink-0 mt-0.5"}),b.jsxs("div",{children:[b.jsx("h3",{className:"font-medium text-red-900 dark:text-red-100",children:"Search Failed"}),b.jsx("p",{className:"text-sm text-red-700 mt-1",children:C})]})]}),p&&b.jsxs("div",{className:"space-y-4 md:space-y-6",children:[b.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[b.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[b.jsx(Tl,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Answer"]}),b.jsx("div",{className:"max-w-none",children:Qe.split(`
`).map((ne,ie)=>{const pe=ne.trim();return pe.startsWith("## ")?b.jsx("h3",{className:"text-base md:text-lg font-bold underline decoration-[#CC561E]/50 underline-offset-4 mt-2.5 md:mt-6 mb-1 md:mb-2.5 text-slate-900 dark:text-white",children:pe.replace(/^##\s+/,"")},ie):pe===""?b.jsx("div",{className:"h-1 md:h-2"},ie):b.jsx("p",{className:"text-justify text-[14px] md:text-base leading-[1.55] md:leading-relaxed text-slate-700 dark:text-slate-300 mb-1.5 md:mb-2",children:ne},ie)})}),X&&b.jsxs("details",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900/40",children:[b.jsx("summary",{className:"cursor-pointer select-none px-3 md:px-4 py-2.5 text-xs md:text-sm font-medium text-slate-600 dark:text-slate-300",children:"Internal Notes (Optional)"}),b.jsx("div",{className:"px-3 md:px-4 pb-3 md:pb-4 border-t border-[#E6EAF2] dark:border-slate-700",children:b.jsx("pre",{className:"mt-3 whitespace-pre-wrap break-words text-xs md:text-sm leading-relaxed text-slate-600 dark:text-slate-300 font-sans",children:X})})]}),b.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2.5 md:gap-4 pt-2.5 md:pt-4 border-t border-[#E6EAF2] dark:border-slate-700",children:[b.jsxs("div",{className:"flex items-center gap-2.5 md:gap-4",children:[b.jsx("span",{className:"text-xs md:text-sm text-slate-500 dark:text-slate-400",children:"Was this answer helpful?"}),b.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[b.jsx("button",{onClick:()=>U(1),disabled:A!=="none"||_,className:`p-1.5 md:p-2 rounded-lg transition-colors ${A==="liked"?"bg-green-100 text-green-600":"text-slate-400 hover:text-green-600"}`,children:b.jsx(rM,{className:"w-4 h-4 md:w-5 md:h-5"})}),b.jsx("button",{onClick:()=>U(0),disabled:A!=="none"||_,className:`p-1.5 md:p-2 rounded-lg transition-colors ${A==="disliked"?"bg-red-100 text-red-600":"text-slate-400 hover:text-red-600"}`,children:b.jsx(tM,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),((je=p.metadata)==null?void 0:je.status)==="analytic"&&((Ie=(ue=p.metadata)==null?void 0:ue.analytics)==null?void 0:Ie.contexts)&&p.metadata.analytics.contexts.length>0&&b.jsxs("button",{onClick:()=>J(!0),className:"flex items-center gap-1.5 md:gap-2 text-[#CC561E] hover:text-[#b34b1a] font-bold text-xs md:text-sm transition-colors py-1.5 md:py-2 px-2.5 md:px-3 hover:bg-orange-50 dark:hover:bg-orange-900/10 rounded-lg",children:[b.jsx(DA,{size:14,className:"md:w-4 md:h-4"}),"See Contexts"]})]})]}),p.sources&&p.sources.length>0&&b.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[b.jsxs("h3",{className:"text-base md:text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[b.jsx(Pp,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Sources (",p.sources.length,")"]}),b.jsx("div",{className:"space-y-1.5 md:space-y-2",children:p.sources.map((ne,ie)=>b.jsxs("div",{className:"flex items-start gap-2 md:gap-3 p-2 md:p-3 rounded-lg bg-[#F3F5FA] dark:bg-slate-700/50 hover:bg-[#F3F5FA] transition-colors",children:[b.jsx("div",{className:"flex-shrink-0 w-5 h-5 md:w-6 md:h-6 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] flex items-center justify-center text-xs md:text-sm font-medium",children:ie+1}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("p",{className:"text-sm md:text-base font-medium text-slate-900 dark:text-white truncate",children:ne.title}),b.jsxs("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:["Page ",ne.page_number]})]})]},ie))})]})]}),Z&&((Ze=p==null?void 0:p.metadata)==null?void 0:Ze.analytics)&&b.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[b.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>J(!1)}),b.jsx("div",{className:"relative w-full max-w-2xl h-full bg-white dark:bg-gray-900 shadow-2xl flex flex-col",children:b.jsx(R6,{term:p.metadata.analytics.term,bookId:p.metadata.analytics.resolved_book_id,initialContexts:p.metadata.analytics.contexts,firebaseUid:t,onClose:()=>J(!1)})})]})]})},vf=async()=>{const e=Qb().currentUser;if(!e)throw new Error("User must be logged in to use Knowledge Stream");return await e.getIdToken()},Gq=12e4,Dd=new Map,Ox=new Map,M6=t=>{const e=t.anchor_type||"note",n=t.anchor_id||"",r=t.mode||"FOCUS",s=Number(t.horizon_value??.25).toFixed(2),i=(t.resource_type||"").toUpperCase(),c=(t.category||"").toUpperCase();return[t.firebase_uid,e,n,r,s,i,c].join("|")},I6=t=>t?Date.now()-t.createdAt<=Gq:!1;async function Wq(t){const e=M6(t),n=Dd.get(e);if(I6(n))return;const r=Ox.get(e);if(r){await r;return}const s=(async()=>{const i=await D6(t);return Dd.set(e,{response:i,createdAt:Date.now()}),i})();Ox.set(e,s);try{await s}finally{Ox.delete(e)}}function qq(t){const e=M6(t),n=Dd.get(e);return I6(n)?(Dd.delete(e),n.response):(Dd.delete(e),null)}async function D6(t){if(!t.firebase_uid)throw new Error("User must be authenticated");const e=await vf(),n=await fetch(`${Kt}/api/flow/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to start flow session")}return n.json()}async function _x(t){const e=await vf(),n=await fetch(`${Kt}/api/flow/next`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to get next batch")}return n.json()}async function $q(t){const e=await vf(),n=await fetch(`${Kt}/api/flow/feedback`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to send feedback")}return n.json()}async function Xq(t,e,n){const r=await vf(),s=await fetch(`${Kt}/api/flow/adjust`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({session_id:t,horizon_value:e,firebase_uid:n})});if(!s.ok){const i=await s.json();throw new Error(i.detail||"Failed to adjust horizon")}return s.json()}async function oA(t,e,n,r,s,i){const c=await vf(),f=await fetch(`${Kt}/api/flow/reset-anchor`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({session_id:t,anchor_type:e,anchor_id:n,firebase_uid:r,resource_type:s,category:i})});if(!f.ok){const p=await f.json();throw new Error(p.detail||"Failed to reset anchor")}return f.json()}const lA={1:{color:"#CC561E",label:"Tight Context",icon:""},2:{color:"#e66a2e",label:"Author's Mind",icon:""},3:{color:"#b34b1a",label:"Syntopic Debate",icon:""},4:{color:"#CC561E",label:"Keif Kprs",icon:""}},Yq=({card:t,sessionId:e,firebaseUid:n,onFeedback:r})=>{const[s,i]=L.useState(!1),[c,f]=L.useState(null),p=lA[t.zone]||lA[1],g=async C=>{try{await $q({firebase_uid:n,session_id:e,chunk_id:t.chunk_id,action:C}),f(C),r==null||r(C)}catch(v){console.error("Feedback failed:",v)}};return b.jsxs("div",{className:"flow-card",style:{"--zone-color":p.color},children:[b.jsxs("div",{className:"flow-card__top-bar",children:[b.jsxs("div",{className:"flow-card__zone-indicator",children:[b.jsx("span",{className:"zone-dot",style:{backgroundColor:p.color}}),b.jsx("span",{className:"zone-label",children:p.label})]}),t.page_number!==void 0&&t.page_number!==null&&t.page_number>0&&b.jsxs("div",{className:"flow-card__meta-item",children:[b.jsx("span",{className:"text-slate-500 mr-1.5 opacity-50",children:"#"}),b.jsxs("span",{children:["Page ",t.page_number]})]})]}),b.jsxs("div",{className:"flow-card__header",children:[b.jsx("h3",{className:"flow-card__title",children:t.title}),t.author&&b.jsxs("div",{className:"flow-card__author-pill",children:[b.jsx("span",{className:"opacity-60 italic",children:"by"})," ",t.author]})]}),b.jsx("div",{className:`flow-card__content ${s?"expanded":""}`,children:b.jsx("p",{children:t.content})}),b.jsxs("div",{className:"flow-card__footer",children:[b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsxs("div",{className:"flow-card__feedback",children:[b.jsx("button",{className:`feedback-btn ${c==="like"?"active like":""}`,onClick:()=>g("like"),disabled:!!c,title:"Relevant",children:b.jsx("span",{className:"btn-icon",children:""})}),b.jsx("button",{className:`feedback-btn ${c==="dislike"?"active dislike":""}`,onClick:()=>g("dislike"),disabled:!!c,title:"Not relevant",children:b.jsx("span",{className:"btn-icon",children:""})}),b.jsx("button",{className:`feedback-btn ${c==="save"?"active save":""}`,onClick:()=>g("save"),disabled:!!c,title:"Keep in Library",children:b.jsx("span",{className:"btn-icon",children:""})})]}),t.reason&&b.jsx("div",{className:"flow-card__footer-reason",children:t.reason})]}),b.jsx("button",{className:`expand-toggle ${s?"is-expanded":""}`,onClick:()=>i(!s),children:s?"Collapse":"Read More"})]}),b.jsx("style",{children:`
                .flow-card {
                    background: #ffffff;
                    border: 1px solid #E6EAF2;
                    border-left: 3px solid var(--zone-color);
                    border-radius: 20px;
                    padding: 20px;
                    margin-bottom: 12px;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                    overflow: hidden;
                }

                @media (max-width: 768px) {
                    .flow-card {
                        padding: 16px;
                        margin-bottom: 8px;
                        border-radius: 16px;
                    }
                }

                @media (min-width: 769px) {
                    .flow-card {
                            margin-bottom: 10px;
                    }
                }
                
                .dark .flow-card {
                    background: rgba(15, 23, 42, 0.5);
                    border-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    right: 0;
                    width: 150px;
                    height: 150px;
                    background: radial-gradient(circle at top right, var(--zone-color), transparent 70%);
                    opacity: 0.04;
                    pointer-events: none;
                }

                .flow-card:hover {
                    background: #ffffff;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    box-shadow: 0 12px 40px rgba(15, 23, 42, 0.08);
                }

                .dark .flow-card:hover {
                    background: rgba(15, 23, 42, 0.7);
                    border-color: rgba(204, 86, 30, 0.3);
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
                }

                .flow-card__top-bar {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 16px;
                }

                .flow-card__zone-indicator {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .zone-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 50%;
                    box-shadow: 0 0 10px var(--zone-color);
                }

                .zone-label {
                    font-size: 11px;
                    font-weight: 700;
                    letter-spacing: 0.05em;
                    text-transform: uppercase;
                    color: var(--zone-color);
                    opacity: 0.9;
                }

                @media (max-width: 768px) {
                    .zone-label {
                        font-size: 9px;
                    }
                }

                .flow-card__meta-item {
                    font-size: 12px;
                    font-weight: 600;
                    color: #64748b;
                }

                @media (max-width: 768px) {
                    .flow-card__meta-item {
                        font-size: 10px;
                    }
                }

                .flow-card__header {
                    margin-bottom: 12px;
                }

                .flow-card__title {
                    font-family: 'Outfit', 'Inter', sans-serif;
                    font-size: 17px;
                    font-weight: 700;
                    color: #1e293b;
                    line-height: 1.3;
                    margin: 0 0 8px 0;
                }

                @media (max-width: 768px) {
                    .flow-card__title {
                        font-size: 15px;
                    }
                }

                .dark .flow-card__title {
                    color: #f1f5f9;
                }

                .flow-card__author-pill {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 4px 12px;
                    background: #F3F5FA;
                    border: 1px solid #E6EAF2;
                    border-radius: 100px;
                    font-size: 12px;
                    color: #475569;
                    font-weight: 500;
                }

                .dark .flow-card__author-pill {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .flow-card__content {
                    color: #475569;
                    font-size: 15px;
                    line-height: 1.7;
                    max-height: 120px;
                    overflow: hidden;
                    position: relative;
                    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                }

                .dark .flow-card__content {
                    color: #94a3b8;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.95));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-card__content.expanded {
                    max-height: 2000px;
                    color: #111827;
                }

                .dark .flow-card__content.expanded {
                    color: #f1f5f9;
                }

                .flow-card__footer-reason {
                    font-size: 12px;
                    line-height: 1.5;
                    color: rgba(204, 86, 30, 0.7);
                    font-weight: 600;
                    font-style: italic;
                    letter-spacing: 0.02em;
                }

                @media (max-width: 768px) {
                    .flow-card__footer-reason {
                        font-size: 10px;
                    }
                }

                .flow-card__footer {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-top: 16px;
                    padding-top: 14px;
                    border-top: 1px solid #E6EAF2;
                }

                .dark .flow-card__footer {
                    border-top-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card__feedback {
                    display: flex;
                    gap: 8px;
                }

                .feedback-btn {
                    width: 38px;
                    height: 38px;
                    border-radius: 10px;
                    border: 1px solid #E6EAF2;
                    background: #ffffff;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    color: #64748b;
                }

                .dark .feedback-btn {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .feedback-btn:hover:not(:disabled) {
                    background: #F3F5FA;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    color: #1e293b;
                }

                .dark .feedback-btn:hover:not(:disabled) {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(204, 86, 30, 0.4);
                    color: #f1f5f9;
                }

                .feedback-btn.active.like { background: rgba(34, 197, 94, 0.1); color: #22c55e; border-color: rgba(34, 197, 94, 0.2); }
                .feedback-btn.active.dislike { background: rgba(239, 68, 68, 0.1); color: #ef4444; border-color: rgba(239, 68, 68, 0.2); }
                .feedback-btn.active.save { background: rgba(204, 86, 30, 0.1); color: #CC561E; border-color: rgba(204, 86, 30, 0.2); }

                .expand-toggle {
                    background: transparent;
                    border: none;
                    color: #CC561E;
                    font-size: 13px;
                    font-weight: 700;
                    cursor: pointer;
                    padding: 8px 16px;
                    border-radius: 8px;
                    transition: all 0.2s ease;
                }

                @media (max-width: 768px) {
                    .expand-toggle {
                        font-size: 11px;
                        padding: 6px 12px;
                    }
                }

                .expand-toggle:hover {
                    background: rgba(204, 86, 30, 0.1);
                    transform: translateX(4px);
                }
            `})]})},Kq=[{label:" Focus",description:"Deep context & related works"},{label:" Syntopic",description:"Similar ideas across different authors"},{label:" Discovery",description:"Unexpected connections & serendipity"}],Zq=({value:t,onChange:e,disabled:n=!1})=>{const s=(i=>i<.33?0:i<.66?1:2)(t);return b.jsxs("div",{className:"horizon-slider",children:[b.jsxs("div",{className:"horizon-slider__header",children:[b.jsxs("div",{className:"flex flex-col",children:[b.jsx("span",{className:"horizon-slider__title",children:"Epistemic Horizon"}),b.jsx("span",{className:"text-[10px] text-card-foreground/70 font-medium tracking-tight",children:"Search Breadth Control"})]}),b.jsxs("div",{className:"horizon-slider__value-badge",children:[Math.round(t*100),"%"]})]}),b.jsxs("div",{className:"horizon-slider__track-container",children:[b.jsx("input",{type:"range",min:"0",max:"100",value:t*100,onChange:i=>e(parseInt(i.target.value)/100),disabled:n,className:"horizon-slider__input"}),b.jsx("div",{className:"horizon-slider__progress",style:{width:`${t*100}%`}})]}),b.jsx("div",{className:"horizon-slider__zones",children:Kq.map((i,c)=>{const f=c===s,p=i.label.split(" ")[0],g=i.label.split(" ")[1];return b.jsxs("div",{className:`horizon-slider__zone ${f?"active":""}`,onClick:()=>e(c*.333+.165),children:[b.jsx("span",{className:"zone-emoji",children:p}),b.jsx("span",{className:"zone-text",children:g}),f&&b.jsx("div",{className:"active-indicator"})]},c)})}),b.jsx("style",{children:`
                .horizon-slider {
                    background: hsl(var(--card));
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    padding: 12px;
                }

                .horizon-slider__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    margin-bottom: 12px;
                }

                .horizon-slider__title {
                    font-size: 11px;
                    font-weight: 700;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    color: hsl(var(--card-foreground));
                    opacity: 0.8;
                    font-family: 'Outfit', sans-serif;
                }

                .horizon-slider__value-badge {
                    padding: 2px 8px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 11px;
                    font-weight: 800;
                    border-radius: 6px;
                    font-family: 'JetBrains Mono', monospace;
                }

                .horizon-slider__track-container {
                    position: relative;
                    height: 4px;
                    background: rgba(255, 255, 255, 0.08);
                    border-radius: 100px;
                    margin-bottom: 12px;
                    overflow: visible;
                }

                .horizon-slider__input {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    -webkit-appearance: none;
                    appearance: none;
                    background: transparent;
                    cursor: pointer;
                    z-index: 5;
                    margin: 0;
                    padding: 0;
                }

                .horizon-slider__input::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #fff;
                    box-shadow: 0 0 10px rgba(204, 86, 30, 0.5);
                    cursor: grab;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                    border: 3px solid #CC561E;
                }

                .horizon-slider__input::-webkit-slider-thumb:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 20px rgba(204, 86, 30, 0.7);
                }

                .horizon-slider__progress {
                    position: absolute;
                    top: 0;
                    left: 0;
                    height: 100%;
                    background: linear-gradient(90deg, #CC561E 0%, #e66a2e 100%);
                    border-radius: 100px;
                    pointer-events: none;
                    z-index: 1;
                }

                .horizon-slider__zones {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 2px;
                }

                .horizon-slider__zone {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 2px;
                    padding: 8px 2px;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    position: relative;
                }

                .horizon-slider__zone:hover {
                    background: rgba(255, 255, 255, 0.06);
                }

                .horizon-slider__zone.active {
                    background: rgba(204, 86, 30, 0.08);
                }

                .zone-emoji {
                    font-size: 14px;
                    filter: grayscale(1) opacity(0.55);
                    transition: all 0.3s ease;
                }

                .horizon-slider__zone.active .zone-emoji {
                    filter: grayscale(0) opacity(1);
                    transform: scale(1.1);
                }

                .zone-text {
                    font-size: 9px;
                    font-weight: 700;
                    color: rgba(255, 255, 255, 0.7);
                    text-transform: uppercase;
                    letter-spacing: 0.02em;
                    transition: all 0.3s ease;
                    text-align: center;
                }

                .horizon-slider__zone.active .zone-text {
                    color: rgba(255, 255, 255, 0.95);
                }

                .active-indicator {
                    position: absolute;
                    bottom: 0;
                    width: 3px;
                    height: 3px;
                    background: #CC561E;
                    border-radius: 50%;
                    box-shadow: 0 0 8px #CC561E;
                }
            `})]})},Jq=({activeFilter:t,onFilterChange:e})=>{const n=[{id:"ALL",label:"All Notes",icon:Q_,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"BOOK",label:"Books",icon:F2,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"ARTICLE",label:"Articles",icon:sf,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"WEBSITE",label:"Websites",icon:Fp,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:Kc,color:"text-slate-400",bg:"bg-slate-500/10"}];return b.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[b.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[b.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Source Navigator"]}),b.jsx("div",{className:"space-y-1",children:n.map(r=>{const s=r.icon,i=t===r.id;return b.jsxs("button",{onClick:()=>e(r.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl transition-all duration-300 group relative overflow-hidden border bg-card text-card-foreground ${i?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[b.jsxs("div",{className:"flex items-center gap-2.5 relative z-10",children:[b.jsx("div",{className:`p-1.5 rounded-lg transition-all duration-300 ${i?"text-[#CC561E]":"text-card-foreground/70 group-hover:text-card-foreground"}`,children:b.jsx(s,{size:18})}),b.jsx("span",{className:`text-xs font-medium tracking-tight ${i?"text-card-foreground":"text-card-foreground/80 group-hover:text-card-foreground"}`,children:r.label})]}),i&&b.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r.id)})})]})},Qq=({firebaseUid:t,anchorType:e,anchorId:n,anchorLabel:r,categoryOptions:s,onClose:i})=>{const[c,f]=L.useState(null),[p,g]=L.useState([]),[C,v]=L.useState(r||"Flux"),[A,T]=L.useState(null),[_,M]=L.useState(.25),[R,j]=L.useState(!1),[H,G]=L.useState(!0),[Z,J]=L.useState(null),[oe,U]=L.useState(!1),[ee,X]=L.useState(!1),[Qe,je]=L.useState(!1),[ue,Ie]=L.useState(null),[Ze,ne]=L.useState(!1),[ie,pe]=L.useState("ALL"),me=L.useRef(null);L.useRef(null),L.useRef(null);const Y=L.useCallback(se=>se==="ALL"?"ALL_NOTES":se,[]),le=L.useCallback(async(se,Be=null,K=.25)=>{if(t){j(!0),J(null),g([]),G(!0);try{const Ce=Y(se),Ae={firebase_uid:t,anchor_type:e,anchor_id:n,mode:"FOCUS",horizon_value:K,resource_type:Ce,category:Be||void 0},rt=qq(Ae)??await D6(Ae);f(rt.session_id),g(rt.initial_cards),v(rt.topic_label),Ie(null)}catch(Ce){J(Pc(Ce))}finally{j(!1)}}},[t,e,n,Y]);L.useEffect(()=>{t&&(oe||U(!0))},[t,oe]),L.useEffect(()=>{oe&&le(ie,A,_)},[oe,ie,A,le]);const V=L.useCallback(async()=>{if(!(c===null||R||!H)){j(!0);try{const se=await _x({firebase_uid:t,session_id:c,batch_size:5});g(Be=>[...Be,...se.cards]),G(se.has_more),se.pivot_info&&Ie(se.pivot_info)}catch(se){console.error("Failed to load more:",se)}finally{j(!1)}}},[c,t,R,H]),te=async se=>{if(M(se),!oe){U(!0);return}if(c!==null)try{await Xq(c,se,t)}catch(Be){console.error("Failed to adjust horizon:",Be)}},fe=async()=>{if(!oe){U(!0);return}if(c!==null){j(!0),ne(!0),J(null),Ie(null);try{const se=await oA(c,"topic","General Discovery",t,Y(ie),A||void 0);v(se.topic_label),se.pivot_info&&Ie(se.pivot_info),g([]),G(!0);const Be=await _x({session_id:c,firebase_uid:t,batch_size:5});g(Be.cards),G(Be.has_more),Be.pivot_info&&Ie(Be.pivot_info)}catch(se){J(Pc(se))}finally{j(!1),ne(!1)}}},ge=se=>{if(se!==A){if(T(se),!oe){U(!0);return}c!==null&&(j(!0),oA(c,"topic","General Discovery",t||"",Y(ie),se||void 0).then(Be=>{g([]),v(Be.topic_label),Ie(Be.pivot_info||null),G(!0),_x({session_id:c,firebase_uid:t,batch_size:5}).then(K=>{g(K.cards),G(K.has_more),K.pivot_info&&Ie(K.pivot_info)}).catch(K=>{console.error("Failed to load initial batch after category pivot:",K),J(Pc(K))}).finally(()=>{j(!1)})}).catch(Be=>{console.error("Failed to pivot category:",Be),J(Pc(Be)),j(!1)}))}},We=se=>{se!==ie&&(pe(se),oe||U(!0))};return b.jsxs("div",{className:"flow-container",ref:me,children:[b.jsxs("div",{className:"flow-layout",children:[b.jsxs("aside",{className:"flow-left",children:[i&&b.jsxs("button",{onClick:i,className:"flow-left__back group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(Mo,{size:16})}),b.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]}),(ie==="ALL"||ie==="BOOK")&&b.jsx(XC,{activeCategory:A,onCategoryChange:ge,categories:s})]}),b.jsxs("div",{className:"flow-main",children:[b.jsx("div",{className:"flow-container__header lg:hidden",children:b.jsx("div",{className:"flow-container__title-section",children:b.jsxs("div",{className:"flow-container__mobile-actions relative flex items-center justify-between",children:[b.jsxs("div",{className:"lg:hidden flex items-center gap-2 z-10 w-1/3",children:[i&&b.jsx("button",{onClick:i,className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300","aria-label":"Back",children:b.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(Mo,{size:16})})}),b.jsxs("button",{onClick:()=>je(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(gg,{size:16})}),b.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Explore"})]})]}),b.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none",children:b.jsx("span",{className:"text-[10px] font-extrabold uppercase tracking-[0.2em] text-[#CC561E] bg-[#CC561E]/10 px-3 py-1 rounded-md",children:"FLUX"})}),b.jsx("div",{className:"lg:hidden flex items-center justify-end gap-2 z-10 w-1/3",children:b.jsxs("button",{onClick:()=>X(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[b.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Filters"}),b.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:b.jsx(HR,{size:16})})]})})]})})}),oe&&Z&&b.jsxs("div",{className:"flow-container__error",children:[b.jsxs("p",{children:[" ",Z]}),b.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),oe&&ue&&b.jsxs("div",{className:"flow-container__pivot",children:[b.jsx("span",{className:"pivot-icon",children:""}),b.jsx("p",{children:ue.message})]}),b.jsxs("div",{className:"flow-container__cards",children:[oe?b.jsxs(b.Fragment,{children:[p.map(se=>b.jsx(Yq,{card:se,sessionId:c??"",firebaseUid:t},se.flow_id)),!R&&!Z&&p.length===0&&b.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[b.jsx("div",{className:"text-6xl mb-6 opacity-80",children:""}),b.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-2",children:ie==="PERSONAL_NOTE"?"No Personal Notes Found":"Library Empty"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-8",children:ie==="PERSONAL_NOTE"?"We couldn't find any personal notes or highlights. Try adding some content or switching to 'All Notes'.":"Your knowledge stream is waiting for content. Upload books or add notes to get started."}),b.jsx("button",{onClick:i,className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Go to Dashboard"})]})]}):b.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[b.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-3",children:"Flux session not started"}),b.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-6",children:"Select a filter to begin or click the button below."}),b.jsx("button",{onClick:()=>U(!0),className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Start Flux"})]}),oe&&(p.length>0||R)&&b.jsxs("div",{className:"flow-container__load-more py-8 flex justify-center",children:[R?b.jsxs("div",{className:"flex items-center gap-3 text-slate-500 dark:text-slate-400",children:[b.jsx("div",{className:"w-5 h-5 border-2 border-[#CC561E] border-t-transparent rounded-full animate-spin"}),b.jsx("span",{className:"text-sm font-medium",children:Ze?"Topic is shifting...":"Loading more thoughts..."})]}):H&&b.jsxs("button",{onClick:V,className:"px-8 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 text-slate-700 dark:text-slate-300 hover:text-[#CC561E] dark:hover:text-[#CC561E] font-medium rounded-full shadow-sm hover:shadow-md transition-all duration-300 flex items-center gap-2 group",children:[b.jsx("span",{children:"Load More"}),b.jsx(Cl,{className:"w-4 h-4 group-hover:translate-y-0.5 transition-transform"})]}),!H&&p.length>0&&b.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:b.jsx("span",{children:" You've explored all related thoughts"})})]})]})]}),b.jsxs("div",{className:`flow-category-container ${Qe?"is-open":""}`,children:[b.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>je(!1)}),b.jsx("aside",{className:"flow-category-sidebar",children:b.jsxs("div",{className:"flow-sidebar__sticky",children:[b.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-6 pb-4 border-bottom border-slate-100 dark:border-slate-800",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:b.jsx(gg,{size:20})}),b.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Discovery Areas"})]}),b.jsx("button",{onClick:()=>je(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:b.jsx(wi,{size:20})})]}),(ie==="ALL"||ie==="BOOK")&&b.jsx(XC,{activeCategory:A,onCategoryChange:se=>{ge(se),je(!1)},categories:s})]})})]}),b.jsxs("div",{className:`flow-sidebar-container ${ee?"is-open":""}`,children:[b.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>X(!1)}),b.jsx("aside",{className:"flow-sidebar",children:b.jsxs("div",{className:"flow-sidebar__sticky",children:[b.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-4 md:mb-0 pb-4 md:pb-0 border-bottom border-slate-100 dark:border-slate-800",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:b.jsx(gg,{size:20})}),b.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Controls"})]}),b.jsx("button",{onClick:()=>X(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:b.jsx(wi,{size:20})})]}),b.jsx(Jq,{activeFilter:ie,onFilterChange:We}),b.jsx(Zq,{value:_,onChange:te,disabled:R}),b.jsxs("button",{className:"flow-sidebar__pivot-button",onClick:fe,disabled:R,children:[b.jsx("span",{className:"icon",children:""}),"Change Topic"]})]})})]})]}),b.jsx("style",{children:`
                .flow-container {
                    max-width: 1280px;
                    margin: 0 auto;
                    width: 100%;
                    display: flex;
                    flex-direction: column;
                    height: 100%;
                    background: transparent;
                    position: relative;
                    padding: 24px;
                }

                @media (max-width: 768px) {
                    .flow-container {
                        padding: 12px;
                    }
                }

                .flow-container::before {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: 
                        radial-gradient(circle at 10% 20%, rgba(204, 86, 30, 0.03) 0%, transparent 40%),
                        radial-gradient(circle at 90% 80%, rgba(204, 86, 30, 0.03) 0%, transparent 40%);
                    pointer-events: none;
                    z-index: -1;
                }

                .flow-layout {
                    display: grid;
                    grid-template-columns: 210px 1fr 210px;
                    gap: 24px;
                    align-items: flex-start;
                    padding-top: 20px;
                    max-width: 1280px;
                    margin: 0 auto;
                }

                @media (max-width: 1024px) {
                    .flow-layout {
                        grid-template-columns: 1fr;
                        gap: 12px;
                        padding-top: 4px;
                    }

                    .flow-left {
                        display: none;
                    }

                    .flow-main {
                        padding-top: 48px;
                    }

                    .flow-sidebar-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-end;
                    }

                    .flow-category-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-start;
                    }

                    .flow-sidebar-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-category-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-sidebar-backdrop {
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0, 0, 0, 0.5);
                        backdrop-filter: blur(4px);
                        opacity: 0;
                        transition: opacity 0.4s ease;
                        pointer-events: none;
                    }

                    .is-open .flow-sidebar-backdrop {
                        opacity: 1;
                        pointer-events: auto;
                    }

                    .flow-sidebar {
                        width: 55%;
                        min-width: 250px;
                        max-width: 400px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-sidebar {
                        background: #0f172a;
                    }

                    .flow-category-sidebar {
                        width: 25%;
                        min-width: 150px;
                        max-width: 340px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(-100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-category-sidebar {
                        background: #0f172a;
                    }

                    .is-open .flow-sidebar {
                        transform: translateX(0);
                    }

                    .is-open .flow-category-sidebar {
                        transform: translateX(0);
                    }

                    .flow-sidebar__sticky {
                        height: 100%;
                        max-height: 100vh;
                        padding: 12px;
                        overflow-y: auto;
                        position: relative;
                        top: 0 !important;
                    }

                    .flow-container__mobile-actions {
                        position: sticky;
                        top: 0;
                        z-index: 100;
                        background: rgba(255, 255, 255, 0.85);
                        backdrop-filter: blur(16px);
                        margin: -20px -20px 20px -20px;
                        padding: 12px 20px;
                        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
                        width: calc(100% + 40px);
                    }

                    .flow-mobile-actions-row {
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 8px;
                        width: 100%;
                    }

                    .flow-mobile-actions-right {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-left: auto;
                    }

                    .flow-mobile-action-btn {
                        padding: 6px 10px;
                        border-radius: 10px;
                        border: 1px solid rgba(148, 163, 184, 0.22);
                        background: rgba(255, 255, 255, 0.9);
                    }

                    .dark .flow-mobile-action-btn {
                        background: rgba(15, 23, 42, 0.9);
                        border-color: rgba(255, 255, 255, 0.12);
                    }

                    .flow-badge--title {
                        display: table;
                        margin: 4px auto 0 auto;
                        text-align: center;
                        font-size: 11px;
                        padding: 6px 14px;
                        letter-spacing: 0.14em;
                    }

                    .dark .flow-container__mobile-actions {
                        background: rgba(15, 23, 42, 0.85);
                        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
                    }
                }

                @media (min-width: 1025px) {
                    .flow-container__mobile-actions {
                        display: none;
                    }

                    .flow-category-container {
                        display: none;
                    }
                }

                .flow-sidebar__sticky {
                    position: sticky;
                    top: 24px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                }

                .flow-main {
                    padding-top: 0;
                }

                @media (min-width: 1025px) {
                    .flow-main {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                    .flow-sidebar__sticky {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                }

                .flow-left {
                    position: sticky;
                    top: 24px;
                    align-self: flex-start;
                }

                .flow-sidebar-container {
                    align-self: flex-start;
                }

                .flow-sidebar {
                    align-self: flex-start;
                }

                .flow-left__back {
                    margin-bottom: 24px;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(248, 250, 252, 0.9));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-sidebar__pivot-button {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                    width: 100%;
                    padding: 12px;
                    background: #262D40;
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-weight: 700;
                    font-size: 13px;
                    cursor: pointer;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 4px 15px rgba(38, 45, 64, 0.25);
                }

                .flow-sidebar__pivot-button:hover:not(:disabled) {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(38, 45, 64, 0.35);
                    filter: brightness(1.08);
                }

                .flow-sidebar__pivot-button:disabled {
                    opacity: 0.4;
                    cursor: not-allowed;
                    filter: grayscale(0.5);
                }

                .flow-sidebar__stats {
                    padding: 16px;
                    background: hsl(var(--card));
                    border-radius: 16px;
                    border: 1px solid rgba(255, 255, 255, 0.08);
                }

                .stat-item {
                    display: flex;
                    justify-content: space-between;
                    font-size: 11px;
                    margin-bottom: 8px;
                }

                .stat-label { color: rgba(255, 255, 255, 0.65); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
                .stat-value { color: rgba(255, 255, 255, 0.95); font-family: 'JetBrains Mono', monospace; }

                .flow-container__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-end;
                    margin-bottom: 24px;
                    padding-bottom: 12px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }

                @media (min-width: 1025px) {
                    .flow-container__header {
                        display: none;
                    }
                }

                .flow-badge {
                    display: inline-block;
                    padding: 4px 10px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 10px;
                    font-weight: 800;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    border-radius: 6px;
                    margin-bottom: 12px;
                }

                .flow-container__title {
                    margin: 0 0 8px 0;
                    font-size: 28px;
                    font-weight: 800;
                    color: #0f172a;
                    letter-spacing: -0.02em;
                    font-family: 'Outfit', sans-serif;
                }

                .dark .flow-container__title {
                    color: #fff;
                }

                .flow-container__meta {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .meta-dot {
                    width: 4px;
                    height: 4px;
                    background: #CC561E;
                    border-radius: 50%;
                }

                .flow-container__subtitle {
                    font-size: 14px;
                    color: #64748b;
                    font-weight: 500;
                }

                .flow-container__close {
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    width: 40px;
                    height: 40px;
                    font-size: 14px;
                    color: #64748b;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .flow-container__close:hover {
                    background: rgba(239, 68, 68, 0.1);
                    color: #f87171;
                    border-color: rgba(239, 68, 68, 0.2);
                }

                .flow-container__pivot {
                    background: rgba(204, 86, 30, 0.05);
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(204, 86, 30, 0.1);
                    padding: 20px 24px;
                    border-radius: 16px;
                    margin-bottom: 32px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    animation: slideInDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
                }

                @keyframes slideInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .pivot-icon {
                    font-size: 24px;
                }

                .flow-container__pivot p {
                    margin: 0;
                    color: rgba(204, 86, 30, 0.8);
                    font-size: 14px;
                    line-height: 1.6;
                    font-weight: 500;
                }

                .flow-container__cards {
                    display: flex;
                    flex-direction: column;
                    gap: 24px;
                }

                .flow-container__loader {
                    padding: 60px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 16px;
                    color: #64748b;
                    font-size: 14px;
                    font-weight: 500;
                }

                .spinner {
                    width: 24px;
                    height: 24px;
                    border: 2px solid rgba(204, 86, 30, 0.1);
                    border-top-color: #CC561E;
                    border-radius: 50%;
                    animation: spin 0.8s linear infinite;
                }

                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            `})]})},e$=({userId:t,userEmail:e,onLogout:n})=>{const[r,s]=L.useState([]),i=L.useRef([]),[c,f]=L.useState("list"),[p,g]=L.useState(null),[C,v]=L.useState(!1),[A,T]=L.useState(null),[_,M]=L.useState(!1),[R,j]=L.useState(null),[H,G]=L.useState("DASHBOARD"),[Z,J]=L.useState(!1),[oe,U]=L.useState(!0),[ee,X]=L.useState(null),[Qe,je]=L.useState(!0),[ue,Ie]=L.useState(null),[Ze,ne]=L.useState(1),[ie,pe]=L.useState(""),[me,Y]=L.useState("ALL"),[le,V]=L.useState("date_desc"),[te,fe]=L.useState(""),[ge,We]=L.useState({}),[se,Be]=L.useState([]),[K,Ce]=L.useState(!1),Ae=L.useRef(!1),ze=L.useRef(0),rt=L.useRef(new Set),ot=L.useRef(!1),gt=L.useRef(new Map),jt=L.useMemo(()=>{const de=Fe=>Fe.trim().toLocaleLowerCase("tr-TR"),we=new Map(_0.map(Fe=>[de(Fe),Fe])),Oe=new Map;return r.filter(Fe=>Fe.type==="BOOK").forEach(Fe=>{(Fe.tags||[]).forEach(it=>{const nt=we.get(de(it));nt&&Oe.set(nt,(Oe.get(nt)||0)+1)})}),_0.filter(Fe=>(Oe.get(Fe)||0)>=YI)},[r]);L.useEffect(()=>{i.current=r},[r]);const Pt=L.useCallback(de=>{const we=gt.current.get(de);we&&(window.clearTimeout(we.timerId),gt.current.delete(de))},[]),et=L.useCallback((de,we)=>{Pt(we.id);const Oe=window.setTimeout(()=>{gt.current.delete(we.id)},45e3);gt.current.set(we.id,{mode:de,snapshot:we,timerId:Oe})},[Pt]),ft=L.useCallback(de=>gt.current.size===0?de:de.map(we=>{const Oe=gt.current.get(we.id);return Oe?Oe.mode==="HIGHLIGHTS"?{...we,highlights:Oe.snapshot.highlights}:{...we,title:Oe.snapshot.title,author:Oe.snapshot.author,tags:Oe.snapshot.tags,generalNotes:Oe.snapshot.generalNotes,summaryText:Oe.snapshot.summaryText,personalNoteCategory:Oe.snapshot.personalNoteCategory,personalFolderId:Oe.snapshot.personalFolderId,folderPath:Oe.snapshot.folderPath}:we}),[]);L.useEffect(()=>()=>{for(const de of gt.current.values())window.clearTimeout(de.timerId);gt.current.clear()},[]),L.useEffect(()=>{let de=!0;async function we(){if(!t){U(!1);return}try{const[{items:Oe,lastDoc:Fe},it]=await Promise.all([Tx(t),sA(t)]);de&&(s(Oe),Be(it),X(Fe),je(!!Fe),Ce(!1))}catch(Oe){console.error("Failed to load items:",Oe)}finally{de&&U(!1)}}return we(),()=>{de=!1}},[t]),L.useEffect(()=>{if(!t)return;let de=!1,we=null,Oe=!1;ze.current=Date.now(),ot.current=!1;const Fe=()=>{if(de)return;const ct=typeof document<"u"&&document.visibilityState==="hidden"?5e3:2500;we=window.setTimeout(()=>{it()},ct)},it=async()=>{if(de||ot.current){Fe();return}ot.current=!0;try{const Xe=await qW(t,ze.current,100),ct=Xe.events||[],ut=ct.reduce((yt,De)=>{const Tt=Number(De.updated_at_ms||0);return Tt>yt?Tt:yt},0);if(ze.current=Math.max(ze.current,Number(Xe.server_time_ms||0),ut),ct.length>0){const[{items:yt,lastDoc:De},Tt]=await Promise.all([Tx(t),sA(t)]);if(!de){const qt=rt.current,_t=qt.size>0?yt.filter(Pr=>!qt.has(Pr.id)):yt;s(ft(_t)),Be(Tt),X(De),je(!!De)}}}catch(Xe){if(Xe instanceof Error&&Xe.message==="REALTIME_ENDPOINT_NOT_FOUND"){Oe=!0,console.warn("Realtime polling disabled: endpoint is not available on current backend.");return}console.warn("Realtime polling failed (non-critical):",Xe)}finally{if(ot.current=!1,Oe)return;Fe()}},nt=()=>{we!==null&&window.clearTimeout(we),Fe()};return Fe(),document.addEventListener("visibilitychange",nt),()=>{de=!0,we!==null&&window.clearTimeout(we),document.removeEventListener("visibilitychange",nt)}},[ft,t]),L.useEffect(()=>{},[t]),L.useEffect(()=>{const de=()=>{setTimeout(()=>{window.scrollTo(0,0),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},100)},we=document.querySelectorAll("input, textarea");return we.forEach(Oe=>{Oe.addEventListener("blur",de)}),()=>{we.forEach(Oe=>{Oe.removeEventListener("blur",de)})}},[]),L.useEffect(()=>{if(!t||Ae.current)return;Ae.current=!0;let de=!1,we=null,Oe=null;const Fe=()=>{de||Wq({firebase_uid:t,anchor_type:"topic",anchor_id:"General Discovery",mode:"FOCUS",horizon_value:.25,resource_type:"ALL_NOTES"}).catch(it=>{console.warn("Flow prewarm failed (non-critical):",it)})};return typeof window<"u"&&typeof window.requestIdleCallback=="function"?Oe=window.requestIdleCallback(()=>Fe(),{timeout:2500}):we=window.setTimeout(Fe,1200),()=>{de=!0,we!==null&&window.clearTimeout(we),Oe!==null&&typeof window<"u"&&typeof window.cancelIdleCallback=="function"&&window.cancelIdleCallback(Oe)}},[t]);const Ve=L.useCallback(async(de,we=!1)=>{if(!er(de))return!0;try{return await VW(t,de.id,{title:de.title,author:de.author,content:de.generalNotes||"",tags:de.tags||[],category:es(de),delete_only:we}),!0}catch(Oe){return console.error("Failed to sync personal note to AI Backend:",Oe),!1}},[t]),lt=L.useCallback(de=>{if(!de)return;const we=se.find(Oe=>Oe.id===de);return we==null?void 0:we.name},[se]),tt=L.useCallback(async de=>{const we={...de,id:de.id||Date.now().toString(),addedAt:de.addedAt||Date.now(),highlights:[]};s(Oe=>[we,...Oe]),v(!1),We({});try{await Fc(t,we)}catch(Oe){console.error("Failed to save item to Firestore:",Oe)}(async()=>{try{if(er(we)){await Ve(we,!1);return}const Oe=[];Oe.push(`Title: ${we.title}`),Oe.push(`Author: ${we.author}`),er(we)&&we.personalNoteCategory&&Oe.push(`Category: ${we.personalNoteCategory}`),er(we)&&we.folderPath&&Oe.push(`SubFile: ${we.folderPath}`),we.publisher&&Oe.push(`Publisher: ${we.publisher}`),we.tags&&we.tags.length>0&&Oe.push(`Tags: ${we.tags.join(", ")}`);const Fe=er(we)?we.generalNotes:we.summaryText||we.generalNotes;Fe&&Oe.push(`
Content/Notes:
${Fe}`);const it=Oe.join(`
`);it.length>20&&(await C6(it,we.title,we.author,er(we)?dN(we):we.type,t,{book_id:we.id,tags:we.tags||[]}),console.log("Synced new item to AI Backend:",we.title))}catch(Oe){console.error("Failed to sync item to AI Backend:",Oe)}})(),de.type!=="PERSONAL_NOTE"&&(async()=>{try{const Oe=f1(we),Fe=await ty(Oe),it=h1(we,Fe),nt=i.current.find(De=>De.id===we.id);if(!nt)return;const Xe=(De,Tt)=>JSON.stringify(Array.isArray(De)?De:[])===JSON.stringify(Array.isArray(Tt)?Tt:[]),ct={},ut=De=>{const Tt=we[De],qt=nt[De],_t=it[De];_t!==void 0&&_t!==Tt&&qt===Tt&&(ct[De]=_t)};if((()=>{const De=we.tags||[],Tt=nt.tags||[],qt=it.tags||[];Xe(qt,De)||Xe(Tt,De)&&(ct.tags=qt)})(),ut("summaryText"),ut("publisher"),ut("translator"),ut("publicationYear"),ut("isbn"),ut("coverUrl"),ut("pageCount"),ut("contentLanguageMode"),ut("contentLanguageResolved"),ut("sourceLanguageHint"),ut("languageDecisionReason"),ut("languageDecisionConfidence"),Object.keys(ct).length===0)return;s(De=>De.map(Tt=>Tt.id===we.id?{...Tt,...ct}:Tt));try{await R2(t,we.id,ct)}catch(De){console.error("Failed to patch enriched item in Oracle:",De)}}catch(Oe){console.error("Background enrichment failed:",Oe)}})()},[R2,Ve,t]),Xn=L.useCallback(de=>{We({personalNoteCategory:(de==null?void 0:de.category)||"DAILY",personalFolderId:de==null?void 0:de.folderId,folderPath:(de==null?void 0:de.folderPath)||lt(de==null?void 0:de.folderId)}),T(null),v(!0)},[lt]),Lr=L.useCallback(de=>{tt({type:"PERSONAL_NOTE",title:de.title,author:"Self",status:"On Shelf",readingStatus:"Finished",tags:[],generalNotes:de.content,addedAt:Date.now(),personalNoteCategory:de.category,personalFolderId:de.folderId,folderPath:de.folderPath||lt(de.folderId)})},[lt,tt]),on=L.useCallback(async de=>{if(!A)return;let we=null;if(s(Oe=>Oe.map(Fe=>Fe.id===A?(we={...Fe,...de},we):Fe)),v(!1),T(null),we){const Oe=er(we);Oe&&et("PERSONAL_NOTE",we);try{await Fc(t,we)}catch(Fe){console.error("Failed to update item in Firestore:",Fe)}if(Oe)try{await Ve(we,!1)}finally{Pt(we.id)}}},[Pt,A,et,Ve,t]),_s=L.useCallback(async de=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const we=r.find(Fe=>Fe.id===de);Pt(de),rt.current.add(de),setTimeout(()=>rt.current.delete(de),1e4),s(Fe=>Fe.filter(it=>it.id!==de)),p===de&&(g(null),f("list"));let Oe=!1;try{await Nq(t,de),Oe=!0}catch(Fe){console.error("Failed to delete item from Firestore:",Fe)}if(!(!Oe||!we))try{await D3(t,we.id)}catch(Fe){console.error("Failed to purge item from AI Backend:",Fe)}},[r,Pt,p,t]),tr=L.useCallback(async de=>{if(!window.confirm(`Are you sure you want to delete ${de.length} items?`))return;const we=r.filter(it=>de.includes(it.id));de.forEach(it=>{Pt(it),rt.current.add(it),setTimeout(()=>rt.current.delete(it),1e4)}),s(it=>it.filter(nt=>!de.includes(nt.id))),p&&de.includes(p)&&(g(null),f("list"));let Oe=!1;try{await kq(t,de),Oe=!0}catch(it){console.error("Failed to delete items from Firestore:",it)}if(!Oe||we.length===0)return;(await Promise.allSettled(we.map(it=>D3(t,it.id)))).forEach((it,nt)=>{it.status==="rejected"&&console.error(`Failed to purge item ${we[nt].id} from AI Backend:`,it.reason)})},[r,Pt,p,t]),jr=L.useCallback(async de=>{if(!p)return;let we=null;if(s(Oe=>Oe.map(Fe=>Fe.id===p?(we={...Fe,highlights:de},we):Fe)),we){et("HIGHLIGHTS",we);try{await E6(t,we.id,we.title,we.author,we.highlights||[])}catch(Oe){console.error("Failed to sync highlights to AI Backend:",Oe)}finally{Pt(we.id)}}},[Pt,et,p,t]),On=L.useCallback(async de=>{const we=r.findIndex(it=>it.id===de);if(we===-1)return;const Oe=r[we],Fe={...Oe,isFavorite:!Oe.isFavorite};s(it=>{const nt=[...it];return nt[we]=Fe,nt});try{await Fc(t,Fe)}catch(it){console.error("Failed to update favorite status in Firestore:",it)}},[r,t]),xn=L.useCallback(async(de,we)=>{const Oe=r.findIndex(Xe=>Xe.id===de);if(Oe===-1)return;const Fe=r[Oe],it=Fe.highlights.map(Xe=>Xe.id===we?{...Xe,isFavorite:!Xe.isFavorite}:Xe),nt={...Fe,highlights:it};s(Xe=>{const ct=[...Xe];return ct[Oe]=nt,ct});try{await Fc(t,nt)}catch(Xe){console.error("Failed to update highlight favorite status in Firestore:",Xe)}},[r,t]),is=L.useCallback(de=>{s(we=>we.map(Oe=>Oe.id===de.id?de:Oe))},[]),{isEnriching:nr,stats:ms,startEnrichment:ln,stopEnrichment:He}=zq(t,is),At=r.find(de=>de.id===p)||void 0,cn=r.find(de=>de.id===A),bn=L.useCallback(de=>{G(de),f("list"),g(null),ne(1),pe(""),Y("ALL"),fe(""),de!=="BOOK"&&Ie(null)},[]),gs=L.useCallback(de=>{Ie(de),Y("ALL"),G("BOOK"),f("list"),g(null),ne(1),pe(""),fe(""),M(!1),j(null)},[]),Br=L.useCallback(de=>{Y(de),Ie(null),G("BOOK"),f("list"),g(null),ne(1),pe(""),fe(""),M(!1),j(null)},[]);L.useCallback(async()=>{if(ee)try{const{items:de,lastDoc:we}=await Tx(t,1e3,ee);s(Oe=>[...Oe,...de]),X(we),je(!!we)}catch(de){console.error("Error loading more items:",de)}},[t,ee]);const Dt=()=>`folder-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,Gt=L.useCallback(async(de,we)=>{const Oe=we.trim();if(!Oe)return null;const Fe=Date.now(),it=se.filter(Xe=>Xe.category===de).reduce((Xe,ct)=>Math.max(Xe,ct.order),0)+1,nt={id:Dt(),category:de,name:Oe,order:it,createdAt:Fe,updatedAt:Fe};Be(Xe=>[...Xe,nt]);try{return await iA(t,nt),nt}catch(Xe){return console.error("Failed to create personal note folder:",Xe),Be(ct=>ct.filter(ut=>ut.id!==nt.id)),null}},[se,t]),pn=L.useCallback(async(de,we)=>{const Oe=we.trim();if(!Oe)return!1;const Fe=se,it=Date.now();Be(nt=>nt.map(Xe=>Xe.id===de?{...Xe,name:Oe,updatedAt:it}:Xe));try{return await aA(t,de,{name:Oe,updatedAt:it}),s(nt=>nt.map(Xe=>!er(Xe)||Xe.personalFolderId!==de?Xe:{...Xe,folderPath:Oe})),!0}catch(nt){return console.error("Failed to rename personal note folder:",nt),Be(Fe),!1}},[se,t]),Bn=L.useCallback(async de=>{if(!se.find(nt=>nt.id===de))return!1;const Oe=se,Fe=r,it=r.filter(nt=>er(nt)&&nt.personalFolderId===de);Be(nt=>nt.filter(Xe=>Xe.id!==de)),s(nt=>nt.map(Xe=>!er(Xe)||Xe.personalFolderId!==de?Xe:{...Xe,personalFolderId:void 0,folderPath:void 0}));try{return await Promise.all([...it.map(nt=>n0(t,nt.id,es(nt),void 0,void 0)),Tq(t,de)]),!0}catch(nt){return console.error("Failed to delete personal note folder:",nt),Be(Oe),s(Fe),!1}},[r,se,t]),Jt=L.useCallback(async(de,we)=>{const Oe=se.find(ut=>ut.id===de);if(!Oe)return!1;if(Oe.category===we)return!0;const Fe=se,it=r,nt=Date.now(),Xe=se.filter(ut=>ut.category===we&&ut.id!==de).reduce((ut,yt)=>Math.max(ut,yt.order),0)+1,ct=r.filter(ut=>er(ut)&&ut.personalFolderId===de);Be(ut=>ut.map(yt=>yt.id!==de?yt:{...yt,category:we,order:Xe,updatedAt:nt})),s(ut=>ut.map(yt=>!er(yt)||yt.personalFolderId!==de?yt:{...yt,personalNoteCategory:we,personalFolderId:de,folderPath:Oe.name}));try{return await Promise.all([aA(t,de,{category:we,order:Xe,updatedAt:nt}),...ct.map(ut=>n0(t,ut.id,we,de,Oe.name))]),await Promise.all(ct.map(ut=>Ve({...ut,personalNoteCategory:we,personalFolderId:de,folderPath:Oe.name},!1))),!0}catch(ut){return console.error("Failed to move personal note folder:",ut),Be(Fe),s(it),!1}},[r,se,Ve,t]),dn=L.useCallback(async(de,we,Oe)=>{const Fe=r.find(De=>De.id===de);if(!Fe||!er(Fe))return!1;const it=Oe?se.find(De=>De.id===Oe):void 0,nt=it==null?void 0:it.id,Xe=it==null?void 0:it.name,ct=es(Fe),ut=Fe.personalFolderId,yt=Fe.folderPath;if(ct===we&&(ut||void 0)===(nt||void 0))return!0;s(De=>De.map(Tt=>Tt.id!==de||!er(Tt)?Tt:{...Tt,personalNoteCategory:we,personalFolderId:nt,folderPath:Xe}));try{return await n0(t,de,we,nt,Xe),await Ve({...Fe,personalNoteCategory:we,personalFolderId:nt,folderPath:Xe},!1),!0}catch(De){return console.error("Failed to move personal note:",De),s(Tt=>Tt.map(qt=>qt.id!==de||!er(qt)?qt:{...qt,personalNoteCategory:ct,personalFolderId:ut,folderPath:yt})),!1}},[r,se,Ve,t]);return L.useEffect(()=>{if(oe||K)return;const de=r.filter(Fe=>er(Fe)&&!!Fe.folderPath&&!Fe.personalFolderId);if(de.length===0){Ce(!0);return}let we=!1;return(async()=>{const Fe=new Map;se.forEach(Xe=>{const ct=`${Xe.category}::${Xe.name.toLowerCase()}`;Fe.set(ct,Xe)});const it=[],nt=[];if(de.forEach(Xe=>{const ct=es(Xe),ut=(Xe.folderPath||"").trim();if(!ut)return;const yt=`${ct}::${ut.toLowerCase()}`;let De=Fe.get(yt);if(!De){const Tt=Date.now(),qt=Math.max(...se.filter(_t=>_t.category===ct).map(_t=>_t.order),...it.filter(_t=>_t.category===ct).map(_t=>_t.order),0)+1;De={id:Dt(),category:ct,name:ut,order:qt,createdAt:Tt,updatedAt:Tt},it.push(De),Fe.set(yt,De)}nt.push({noteId:Xe.id,category:ct,folderId:De.id,folderPath:De.name})}),!we){it.length>0&&Be(Xe=>[...Xe,...it]),nt.length>0&&s(Xe=>Xe.map(ct=>{const ut=nt.find(yt=>yt.noteId===ct.id);return!ut||!er(ct)?ct:{...ct,personalNoteCategory:ut.category,personalFolderId:ut.folderId,folderPath:ut.folderPath}}));try{await Promise.all([...it.map(Xe=>iA(t,Xe)),...nt.map(Xe=>n0(t,Xe.noteId,Xe.category,Xe.folderId,Xe.folderPath))])}catch(Xe){console.error("Legacy personal note folder migration failed:",Xe)}finally{we||Ce(!0)}}})(),()=>{we=!0}},[r,K,oe,se,t]),oe&&r.length===0?b.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 text-slate-500",children:"Loading your library from cloud..."}):b.jsxs("div",{className:"flex h-screen bg-[#F7F8FB] dark:bg-[#0b0e14] overflow-hidden",children:[b.jsx(Mq,{activeTab:H,onTabChange:bn,isOpen:Z,onClose:()=>J(!1)}),b.jsx("main",{className:`flex-1 flex flex-col h-full w-full relative overflow-y-auto transition-all duration-300 bg-[#F7F8FB] dark:bg-[#0b0e14] noise-bg\r
`,children:H==="PROFILE"?b.jsx(jq,{email:e,userId:t,onLogout:n,onBack:()=>bn("DASHBOARD"),books:r,onStartEnrichment:ln,onStopEnrichment:He,isEnriching:nr,enrichmentStats:ms}):H==="SMART_SEARCH"?b.jsx(Fq,{userId:t,onBack:()=>bn("DASHBOARD"),books:r}):H==="RAG_SEARCH"?b.jsx(Vq,{userId:t,userEmail:e,onBack:()=>bn("DASHBOARD"),books:r}):H==="FLOW"?b.jsx(Qq,{firebaseUid:t,anchorType:"topic",anchorId:"General Discovery",categoryOptions:jt,onClose:()=>bn("DASHBOARD")}):c==="list"?b.jsx(dU,{books:r,activeTab:H,userId:t,categoryFilter:ue,onCategoryFilterChange:Ie,onCategoryNavigate:gs,onStatusNavigate:Br,onSelectBook:de=>{g(de.id),M(!1),f("detail")},onSelectBookWithTab:(de,we,Oe)=>{g(de.id),M(we==="highlights"),j(Oe||null),f("detail")},onAddBook:()=>{We({}),T(null),v(!0)},personalNoteFolders:se,onCreatePersonalFolder:Gt,onRenamePersonalFolder:pn,onDeletePersonalFolder:Bn,onMovePersonalFolder:Jt,onMovePersonalNote:dn,onAddPersonalNote:({category:de,folderId:we,folderPath:Oe})=>{Xn({category:de,folderId:we,folderPath:Oe})},onQuickCreatePersonalNote:Lr,onMobileMenuClick:()=>J(!0),onDeleteBook:_s,onDeleteMultiple:tr,onToggleFavorite:On,onToggleHighlightFavorite:xn,currentPage:Ze,onPageChange:ne,searchQuery:ie,onSearchChange:pe,statusFilter:me,onStatusFilterChange:Y,sortOption:le,onSortOptionChange:V,publisherFilter:te,onPublisherFilterChange:fe,onTabChange:bn}):At&&b.jsx(Oq,{book:At,initialTab:_?"highlights":"info",autoEditHighlightId:R||void 0,onBack:()=>{g(null),M(!1),j(null),f("list")},onEdit:()=>{T(At.id),v(!0)},onDelete:()=>_s(At.id),onUpdateHighlights:jr,onBookUpdated:is})}),C&&b.jsx($W,{initialType:cn?cn.type:H==="NOTES"||H==="DASHBOARD"||H==="PROFILE"||H==="RAG_SEARCH"||H==="SMART_SEARCH"||H==="FLOW"?"BOOK":H,initialData:cn,noteDefaults:!cn&&H==="PERSONAL_NOTE"?ge:void 0,onSave:A?on:tt,onCancel:()=>{v(!1),T(null),We({})}})]})},t$=()=>{const{user:t,loading:e,loginWithGoogle:n,logout:r}=p1();return e?b.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-500",children:"Loading..."}):t?b.jsx(OO,{children:b.jsx(e$,{userId:t.uid,userEmail:t.email,onLogout:r})}):b.jsx("div",{className:`min-h-screen flex items-center justify-center bg-[#F7F8FB] dark:bg-[#0b0e14] transition-colors duration-300\r
`,children:b.jsxs("div",{className:"bg-white dark:bg-slate-900 shadow-lg rounded-2xl px-8 py-10 flex flex-col items-center gap-4 border border-slate-100 dark:border-slate-800",children:[b.jsx("div",{className:"flex flex-col items-center gap-6 mb-12",children:b.jsx("img",{src:O6,alt:"TomeHub Icon",className:"h-[156px] w-auto object-contain brightness-110 drop-shadow-xl"})}),b.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center max-w-xs",children:"Sign in with your Google account to access your library across all devices."}),b.jsx("button",{onClick:n,className:"mt-2 bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white px-5 py-2 rounded-lg text-sm font-medium shadow-md transition-colors",children:"Continue with Google"})]})})},n$=()=>b.jsx(jW,{children:b.jsx(_q,{children:b.jsx(t$,{})})}),L6=document.getElementById("root");if(!L6)throw new Error("Could not find root element to mount to");const r$=l8.createRoot(L6);r$.render(b.jsx(It.StrictMode,{children:b.jsx(n$,{})}));export{a0 as A,Bx as B,_0 as C,a$ as F,iN as H,o$ as I,sN as K,pR as M,aN as N,s$ as P,i$ as S,o0 as W,YI as a,jd as b,Je as c,x_ as d,ka as e,RA as f,Cl as g,Ea as h,b as j,L as r};
