function jO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function C0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dg={exports:{}},Mu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bE;function PO(){if(bE)return Mu;bE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var s in i)s!=="key"&&(a[s]=i[s])}else a=i;return i=a.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Mu.Fragment=e,Mu.jsx=n,Mu.jsxs=n,Mu}var wE;function BO(){return wE||(wE=1,dg.exports=PO()),dg.exports}var m=BO(),fg={exports:{}},tt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE;function FO(){if(CE)return tt;CE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function v(M){return M===null||typeof M!="object"?null:(M=x&&M[x]||M["@@iterator"],typeof M=="function"?M:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,E={};function S(M,V,Z){this.props=M,this.context=V,this.refs=E,this.updater=Z||b}S.prototype.isReactComponent={},S.prototype.setState=function(M,V){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,V,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function N(){}N.prototype=S.prototype;function k(M,V,Z){this.props=M,this.context=V,this.refs=E,this.updater=Z||b}var I=k.prototype=new N;I.constructor=k,C(I,S.prototype),I.isPureReactComponent=!0;var D=Array.isArray;function L(){}var O={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function U(M,V,Z){var re=Z.ref;return{$$typeof:t,type:M,key:V,ref:re!==void 0?re:null,props:Z}}function fe(M,V){return U(M.type,V,M.props)}function le(M){return typeof M=="object"&&M!==null&&M.$$typeof===t}function q(M){var V={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(Z){return V[Z]})}var de=/\/+/g;function ge(M,V){return typeof M=="object"&&M!==null&&M.key!=null?q(""+M.key):V.toString(36)}function xe(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(L,L):(M.status="pending",M.then(function(V){M.status==="pending"&&(M.status="fulfilled",M.value=V)},function(V){M.status==="pending"&&(M.status="rejected",M.reason=V)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function H(M,V,Z,re,_e){var J=typeof M;(J==="undefined"||J==="boolean")&&(M=null);var we=!1;if(M===null)we=!0;else switch(J){case"bigint":case"string":case"number":we=!0;break;case"object":switch(M.$$typeof){case t:case e:we=!0;break;case h:return we=M._init,H(we(M._payload),V,Z,re,_e)}}if(we)return _e=_e(M),we=re===""?"."+ge(M,0):re,D(_e)?(Z="",we!=null&&(Z=we.replace(de,"$&/")+"/"),H(_e,V,Z,"",function(ce){return ce})):_e!=null&&(le(_e)&&(_e=fe(_e,Z+(_e.key==null||M&&M.key===_e.key?"":(""+_e.key).replace(de,"$&/")+"/")+we)),V.push(_e)),1;we=0;var z=re===""?".":re+":";if(D(M))for(var ae=0;ae<M.length;ae++)re=M[ae],J=z+ge(re,ae),we+=H(re,V,Z,J,_e);else if(ae=v(M),typeof ae=="function")for(M=ae.call(M),ae=0;!(re=M.next()).done;)re=re.value,J=z+ge(re,ae++),we+=H(re,V,Z,J,_e);else if(J==="object"){if(typeof M.then=="function")return H(xe(M),V,Z,re,_e);throw V=String(M),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return we}function ie(M,V,Z){if(M==null)return M;var re=[],_e=0;return H(M,re,"","",function(J){return V.call(Z,J,_e++)}),re}function K(M){if(M._status===-1){var V=M._result;V=V(),V.then(function(Z){(M._status===0||M._status===-1)&&(M._status=1,M._result=Z)},function(Z){(M._status===0||M._status===-1)&&(M._status=2,M._result=Z)}),M._status===-1&&(M._status=0,M._result=V)}if(M._status===1)return M._result.default;throw M._result}var B=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},G={map:ie,forEach:function(M,V,Z){ie(M,function(){V.apply(this,arguments)},Z)},count:function(M){var V=0;return ie(M,function(){V++}),V},toArray:function(M){return ie(M,function(V){return V})||[]},only:function(M){if(!le(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return tt.Activity=p,tt.Children=G,tt.Component=S,tt.Fragment=n,tt.Profiler=i,tt.PureComponent=k,tt.StrictMode=r,tt.Suspense=c,tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,tt.__COMPILER_RUNTIME={__proto__:null,c:function(M){return O.H.useMemoCache(M)}},tt.cache=function(M){return function(){return M.apply(null,arguments)}},tt.cacheSignal=function(){return null},tt.cloneElement=function(M,V,Z){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var re=C({},M.props),_e=M.key;if(V!=null)for(J in V.key!==void 0&&(_e=""+V.key),V)!j.call(V,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&V.ref===void 0||(re[J]=V[J]);var J=arguments.length-2;if(J===1)re.children=Z;else if(1<J){for(var we=Array(J),z=0;z<J;z++)we[z]=arguments[z+2];re.children=we}return U(M.type,_e,re)},tt.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:a,_context:M},M},tt.createElement=function(M,V,Z){var re,_e={},J=null;if(V!=null)for(re in V.key!==void 0&&(J=""+V.key),V)j.call(V,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(_e[re]=V[re]);var we=arguments.length-2;if(we===1)_e.children=Z;else if(1<we){for(var z=Array(we),ae=0;ae<we;ae++)z[ae]=arguments[ae+2];_e.children=z}if(M&&M.defaultProps)for(re in we=M.defaultProps,we)_e[re]===void 0&&(_e[re]=we[re]);return U(M,J,_e)},tt.createRef=function(){return{current:null}},tt.forwardRef=function(M){return{$$typeof:s,render:M}},tt.isValidElement=le,tt.lazy=function(M){return{$$typeof:h,_payload:{_status:-1,_result:M},_init:K}},tt.memo=function(M,V){return{$$typeof:d,type:M,compare:V===void 0?null:V}},tt.startTransition=function(M){var V=O.T,Z={};O.T=Z;try{var re=M(),_e=O.S;_e!==null&&_e(Z,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(L,B)}catch(J){B(J)}finally{V!==null&&Z.types!==null&&(V.types=Z.types),O.T=V}},tt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},tt.use=function(M){return O.H.use(M)},tt.useActionState=function(M,V,Z){return O.H.useActionState(M,V,Z)},tt.useCallback=function(M,V){return O.H.useCallback(M,V)},tt.useContext=function(M){return O.H.useContext(M)},tt.useDebugValue=function(){},tt.useDeferredValue=function(M,V){return O.H.useDeferredValue(M,V)},tt.useEffect=function(M,V){return O.H.useEffect(M,V)},tt.useEffectEvent=function(M){return O.H.useEffectEvent(M)},tt.useId=function(){return O.H.useId()},tt.useImperativeHandle=function(M,V,Z){return O.H.useImperativeHandle(M,V,Z)},tt.useInsertionEffect=function(M,V){return O.H.useInsertionEffect(M,V)},tt.useLayoutEffect=function(M,V){return O.H.useLayoutEffect(M,V)},tt.useMemo=function(M,V){return O.H.useMemo(M,V)},tt.useOptimistic=function(M,V){return O.H.useOptimistic(M,V)},tt.useReducer=function(M,V,Z){return O.H.useReducer(M,V,Z)},tt.useRef=function(M){return O.H.useRef(M)},tt.useState=function(M){return O.H.useState(M)},tt.useSyncExternalStore=function(M,V,Z){return O.H.useSyncExternalStore(M,V,Z)},tt.useTransition=function(){return O.H.useTransition()},tt.version="19.2.0",tt}var EE;function Pd(){return EE||(EE=1,fg.exports=FO()),fg.exports}var A=Pd();const Qe=C0(A);var hg={exports:{}},Ru={},pg={exports:{}},mg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SE;function zO(){return SE||(SE=1,(function(t){function e(H,ie){var K=H.length;H.push(ie);e:for(;0<K;){var B=K-1>>>1,G=H[B];if(0<i(G,ie))H[B]=ie,H[K]=G,K=B;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var ie=H[0],K=H.pop();if(K!==ie){H[0]=K;e:for(var B=0,G=H.length,M=G>>>1;B<M;){var V=2*(B+1)-1,Z=H[V],re=V+1,_e=H[re];if(0>i(Z,K))re<G&&0>i(_e,Z)?(H[B]=_e,H[re]=K,B=re):(H[B]=Z,H[V]=K,B=V);else if(re<G&&0>i(_e,K))H[B]=_e,H[re]=K,B=re;else break e}}return ie}function i(H,ie){var K=H.sortIndex-ie.sortIndex;return K!==0?K:H.id-ie.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],d=[],h=1,p=null,x=3,v=!1,b=!1,C=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function I(H){for(var ie=n(d);ie!==null;){if(ie.callback===null)r(d);else if(ie.startTime<=H)r(d),ie.sortIndex=ie.expirationTime,e(c,ie);else break;ie=n(d)}}function D(H){if(C=!1,I(H),!b)if(n(c)!==null)b=!0,L||(L=!0,q());else{var ie=n(d);ie!==null&&xe(D,ie.startTime-H)}}var L=!1,O=-1,j=5,U=-1;function fe(){return E?!0:!(t.unstable_now()-U<j)}function le(){if(E=!1,L){var H=t.unstable_now();U=H;var ie=!0;try{e:{b=!1,C&&(C=!1,N(O),O=-1),v=!0;var K=x;try{t:{for(I(H),p=n(c);p!==null&&!(p.expirationTime>H&&fe());){var B=p.callback;if(typeof B=="function"){p.callback=null,x=p.priorityLevel;var G=B(p.expirationTime<=H);if(H=t.unstable_now(),typeof G=="function"){p.callback=G,I(H),ie=!0;break t}p===n(c)&&r(c),I(H)}else r(c);p=n(c)}if(p!==null)ie=!0;else{var M=n(d);M!==null&&xe(D,M.startTime-H),ie=!1}}break e}finally{p=null,x=K,v=!1}ie=void 0}}finally{ie?q():L=!1}}}var q;if(typeof k=="function")q=function(){k(le)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ge=de.port2;de.port1.onmessage=le,q=function(){ge.postMessage(null)}}else q=function(){S(le,0)};function xe(H,ie){O=S(function(){H(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(H){switch(x){case 1:case 2:case 3:var ie=3;break;default:ie=x}var K=x;x=ie;try{return H()}finally{x=K}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(H,ie){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var K=x;x=H;try{return ie()}finally{x=K}},t.unstable_scheduleCallback=function(H,ie,K){var B=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?B+K:B):K=B,H){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=K+G,H={id:h++,callback:ie,priorityLevel:H,startTime:K,expirationTime:G,sortIndex:-1},K>B?(H.sortIndex=K,e(d,H),n(c)===null&&H===n(d)&&(C?(N(O),O=-1):C=!0,xe(D,K-B))):(H.sortIndex=G,e(c,H),b||v||(b=!0,L||(L=!0,q()))),H},t.unstable_shouldYield=fe,t.unstable_wrapCallback=function(H){var ie=x;return function(){var K=x;x=ie;try{return H.apply(this,arguments)}finally{x=K}}}})(mg)),mg}var AE;function UO(){return AE||(AE=1,pg.exports=zO()),pg.exports}var gg={exports:{}},Ar={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E;function HO(){if(_E)return Ar;_E=1;var t=Pd();function e(c){var d="https://react.dev/errors/"+c;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(c,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:c,containerInfo:d,implementation:h}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(c,d){if(c==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ar.createPortal=function(c,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(c,d,null,h)},Ar.flushSync=function(c){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,c)return c()}finally{o.T=d,r.p=h,r.d.f()}},Ar.preconnect=function(c,d){typeof c=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(c,d))},Ar.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},Ar.preinit=function(c,d){if(typeof c=="string"&&d&&typeof d.as=="string"){var h=d.as,p=s(h,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(c,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:v}):h==="script"&&r.d.X(c,{crossOrigin:p,integrity:x,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ar.preinitModule=function(c,d){if(typeof c=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=s(d.as,d.crossOrigin);r.d.M(c,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(c)},Ar.preload=function(c,d){if(typeof c=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=s(h,d.crossOrigin);r.d.L(c,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ar.preloadModule=function(c,d){if(typeof c=="string")if(d){var h=s(d.as,d.crossOrigin);r.d.m(c,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(c)},Ar.requestFormReset=function(c){r.d.r(c)},Ar.unstable_batchedUpdates=function(c,d){return c(d)},Ar.useFormState=function(c,d,h){return o.H.useFormState(c,d,h)},Ar.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ar.version="19.2.0",Ar}var NE;function X_(){if(NE)return gg.exports;NE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),gg.exports=HO(),gg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE;function VO(){if(kE)return Ru;kE=1;var t=UO(),e=Pd(),n=X_();function r(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function a(l){var u=l,f=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(f=u.return),l=u.return;while(l)}return u.tag===3?f:null}function o(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function s(l){if(l.tag===31){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function c(l){if(a(l)!==l)throw Error(r(188))}function d(l){var u=l.alternate;if(!u){if(u=a(l),u===null)throw Error(r(188));return u!==l?null:l}for(var f=l,g=u;;){var y=f.return;if(y===null)break;var w=y.alternate;if(w===null){if(g=y.return,g!==null){f=g;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===f)return c(y),l;if(w===g)return c(y),u;w=w.sibling}throw Error(r(188))}if(f.return!==g.return)f=y,g=w;else{for(var _=!1,T=y.child;T;){if(T===f){_=!0,f=y,g=w;break}if(T===g){_=!0,g=y,f=w;break}T=T.sibling}if(!_){for(T=w.child;T;){if(T===f){_=!0,f=w,g=y;break}if(T===g){_=!0,g=w,f=y;break}T=T.sibling}if(!_)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?l:u}function h(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=h(l),u!==null)return u;l=l.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),fe=Symbol.for("react.memo_cache_sentinel"),le=Symbol.iterator;function q(l){return l===null||typeof l!="object"?null:(l=le&&l[le]||l["@@iterator"],typeof l=="function"?l:null)}var de=Symbol.for("react.client.reference");function ge(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===de?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case C:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case D:return"Suspense";case L:return"SuspenseList";case U:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case b:return"Portal";case k:return l.displayName||"Context";case N:return(l._context.displayName||"Context")+".Consumer";case I:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case O:return u=l.displayName||null,u!==null?u:ge(l.type)||"Memo";case j:u=l._payload,l=l._init;try{return ge(l(u))}catch{}}return null}var xe=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},B=[],G=-1;function M(l){return{current:l}}function V(l){0>G||(l.current=B[G],B[G]=null,G--)}function Z(l,u){G++,B[G]=l.current,l.current=u}var re=M(null),_e=M(null),J=M(null),we=M(null);function z(l,u){switch(Z(J,u),Z(_e,l),Z(re,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?VC(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=VC(u),l=$C(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}V(re),Z(re,l)}function ae(){V(re),V(_e),V(J)}function ce(l){l.memoizedState!==null&&Z(we,l);var u=re.current,f=$C(u,l.type);u!==f&&(Z(_e,l),Z(re,f))}function Te(l){_e.current===l&&(V(re),V(_e)),we.current===l&&(V(we),Tu._currentValue=K)}var Le,ot;function Ke(l){if(Le===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);Le=u&&u[1]||"",ot=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Le+l+ot}var ht=!1;function Ut(l,u){if(!l||ht)return"";ht=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(u){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(ue){var oe=ue}Reflect.construct(l,[],ye)}else{try{ye.call()}catch(ue){oe=ue}l.call(ye.prototype)}}else{try{throw Error()}catch(ue){oe=ue}(ye=l())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(ue){if(ue&&oe&&typeof ue.stack=="string")return[ue.stack,oe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=g.DetermineComponentFrameRoot(),_=w[0],T=w[1];if(_&&T){var F=_.split(`
`),ne=T.split(`
`);for(y=g=0;g<F.length&&!F[g].includes("DetermineComponentFrameRoot");)g++;for(;y<ne.length&&!ne[y].includes("DetermineComponentFrameRoot");)y++;if(g===F.length||y===ne.length)for(g=F.length-1,y=ne.length-1;1<=g&&0<=y&&F[g]!==ne[y];)y--;for(;1<=g&&0<=y;g--,y--)if(F[g]!==ne[y]){if(g!==1||y!==1)do if(g--,y--,0>y||F[g]!==ne[y]){var pe=`
`+F[g].replace(" at new "," at ");return l.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",l.displayName)),pe}while(1<=g&&0<=y);break}}}finally{ht=!1,Error.prepareStackTrace=f}return(f=l?l.displayName||l.name:"")?Ke(f):""}function Me(l,u){switch(l.tag){case 26:case 27:case 5:return Ke(l.type);case 16:return Ke("Lazy");case 13:return l.child!==u&&u!==null?Ke("Suspense Fallback"):Ke("Suspense");case 19:return Ke("SuspenseList");case 0:case 15:return Ut(l.type,!1);case 11:return Ut(l.type.render,!1);case 1:return Ut(l.type,!0);case 31:return Ke("Activity");default:return""}}function We(l){try{var u="",f=null;do u+=Me(l,f),f=l,l=l.return;while(l);return u}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Pe=Object.prototype.hasOwnProperty,Se=t.unstable_scheduleCallback,fn=t.unstable_cancelCallback,An=t.unstable_shouldYield,Mr=t.unstable_requestPaint,rn=t.unstable_now,Fi=t.unstable_getCurrentPriorityLevel,or=t.unstable_ImmediatePriority,sr=t.unstable_UserBlockingPriority,St=t.unstable_NormalPriority,Er=t.unstable_LowPriority,zi=t.unstable_IdlePriority,lr=t.log,xi=t.unstable_setDisableYieldValue,Gr=null,xn=null;function cr(l){if(typeof lr=="function"&&xi(l),xn&&typeof xn.setStrictMode=="function")try{xn.setStrictMode(Gr,l)}catch{}}var Tn=Math.clz32?Math.clz32:aa,xs=Math.log,On=Math.LN2;function aa(l){return l>>>=0,l===0?32:31-(xs(l)/On|0)|0}var Wr=256,vi=262144,At=4194304;function Ht(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Kt(l,u,f){var g=l.pendingLanes;if(g===0)return 0;var y=0,w=l.suspendedLanes,_=l.pingedLanes;l=l.warmLanes;var T=g&134217727;return T!==0?(g=T&~w,g!==0?y=Ht(g):(_&=T,_!==0?y=Ht(_):f||(f=T&~l,f!==0&&(y=Ht(f))))):(T=g&~w,T!==0?y=Ht(T):_!==0?y=Ht(_):f||(f=g&~l,f!==0&&(y=Ht(f)))),y===0?0:u!==0&&u!==y&&(u&w)===0&&(w=y&-y,f=u&-u,w>=f||w===32&&(f&4194048)!==0)?u:y}function Vt(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function vt(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yt(){var l=At;return At<<=1,(At&62914560)===0&&(At=4194304),l}function Xn(l){for(var u=[],f=0;31>f;f++)u.push(l);return u}function ur(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function vn(l,u,f,g,y,w){var _=l.pendingLanes;l.pendingLanes=f,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=f,l.entangledLanes&=f,l.errorRecoveryDisabledLanes&=f,l.shellSuspendCounter=0;var T=l.entanglements,F=l.expirationTimes,ne=l.hiddenUpdates;for(f=_&~f;0<f;){var pe=31-Tn(f),ye=1<<pe;T[pe]=0,F[pe]=-1;var oe=ne[pe];if(oe!==null)for(ne[pe]=null,pe=0;pe<oe.length;pe++){var ue=oe[pe];ue!==null&&(ue.lane&=-536870913)}f&=~ye}g!==0&&Rr(l,g,0),w!==0&&y===0&&l.tag!==0&&(l.suspendedLanes|=w&~(_&~u))}function Rr(l,u,f){l.pendingLanes|=u,l.suspendedLanes&=~u;var g=31-Tn(u);l.entangledLanes|=u,l.entanglements[g]=l.entanglements[g]|1073741824|f&261930}function Kn(l,u){var f=l.entangledLanes|=u;for(l=l.entanglements;f;){var g=31-Tn(f),y=1<<g;y&u|l[g]&u&&(l[g]|=u),f&=~y}}function Sr(l,u){var f=u&-u;return f=(f&42)!==0?1:In(f),(f&(l.suspendedLanes|u))!==0?0:f}function In(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function $(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function X(){var l=ie.p;return l!==0?l:(l=window.event,l===void 0?32:hE(l.type))}function Ae(l,u){var f=ie.p;try{return ie.p=l,u()}finally{ie.p=f}}var Ce=Math.random().toString(36).slice(2),se="__reactFiber$"+Ce,me="__reactProps$"+Ce,Ee="__reactContainer$"+Ce,Ye="__reactEvents$"+Ce,Fe="__reactListeners$"+Ce,rt="__reactHandles$"+Ce,et="__reactResources$"+Ce,Zt="__reactMarker$"+Ce;function bt(l){delete l[se],delete l[me],delete l[Ye],delete l[Fe],delete l[rt]}function Tt(l){var u=l[se];if(u)return u;for(var f=l.parentNode;f;){if(u=f[Ee]||f[se]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(l=ZC(l);l!==null;){if(f=l[se])return f;l=ZC(l)}return u}l=f,f=l.parentNode}return null}function Lr(l){if(l=l[se]||l[Ee]){var u=l.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return l}return null}function Ui(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(r(33))}function lo(l){var u=l[et];return u||(u=l[et]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Dn(l){l[Zt]=!0}var jr=new Set,af={};function yi(l,u){Sa(l,u),Sa(l+"Capture",u)}function Sa(l,u){for(af[l]=u,l=0;l<u.length;l++)jr.add(u[l])}var Hc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vc={},$c={};function o1(l){return Pe.call($c,l)?!0:Pe.call(Vc,l)?!1:Hc.test(l)?$c[l]=!0:(Vc[l]=!0,!1)}function Gc(l,u,f){if(o1(u))if(f===null)l.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var g=u.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+f)}}function xl(l,u,f){if(f===null)l.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+f)}}function Q(l,u,f,g){if(g===null)l.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(f);return}l.setAttributeNS(u,f,""+g)}}function P(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ie(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Ne(l,u,f){var g=Object.getOwnPropertyDescriptor(l.constructor.prototype,u);if(!l.hasOwnProperty(u)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var y=g.get,w=g.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return y.call(this)},set:function(_){f=""+_,w.call(this,_)}}),Object.defineProperty(l,u,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(_){f=""+_},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function ut(l){if(!l._valueTracker){var u=Ie(l)?"checked":"value";l._valueTracker=Ne(l,u,""+l[u])}}function $t(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var f=u.getValue(),g="";return l&&(g=Ie(l)?l.checked?"true":"false":l.value),l=g,l!==f?(u.setValue(l),!0):!1}function pn(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var oa=/[\n"\\]/g;function mn(l){return l.replace(oa,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function oi(l,u,f,g,y,w,_,T){l.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?l.type=_:l.removeAttribute("type"),u!=null?_==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+P(u)):l.value!==""+P(u)&&(l.value=""+P(u)):_!=="submit"&&_!=="reset"||l.removeAttribute("value"),u!=null?vs(l,_,P(u)):f!=null?vs(l,_,P(f)):g!=null&&l.removeAttribute("value"),y==null&&w!=null&&(l.defaultChecked=!!w),y!=null&&(l.checked=y&&typeof y!="function"&&typeof y!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?l.name=""+P(T):l.removeAttribute("name")}function sa(l,u,f,g,y,w,_,T){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(l.type=w),u!=null||f!=null){if(!(w!=="submit"&&w!=="reset"||u!=null)){ut(l);return}f=f!=null?""+P(f):"",u=u!=null?""+P(u):f,T||u===l.value||(l.value=u),l.defaultValue=u}g=g??y,g=typeof g!="function"&&typeof g!="symbol"&&!!g,l.checked=T?l.checked:!!g,l.defaultChecked=!!g,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(l.name=_),ut(l)}function vs(l,u,f){u==="number"&&pn(l.ownerDocument)===l||l.defaultValue===""+f||(l.defaultValue=""+f)}function vl(l,u,f,g){if(l=l.options,u){u={};for(var y=0;y<f.length;y++)u["$"+f[y]]=!0;for(f=0;f<l.length;f++)y=u.hasOwnProperty("$"+l[f].value),l[f].selected!==y&&(l[f].selected=y),y&&g&&(l[f].defaultSelected=!0)}else{for(f=""+P(f),u=null,y=0;y<l.length;y++){if(l[y].value===f){l[y].selected=!0,g&&(l[y].defaultSelected=!0);return}u!==null||l[y].disabled||(u=l[y])}u!==null&&(u.selected=!0)}}function B2(l,u,f){if(u!=null&&(u=""+P(u),u!==l.value&&(l.value=u),f==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=f!=null?""+P(f):""}function F2(l,u,f,g){if(u==null){if(g!=null){if(f!=null)throw Error(r(92));if(xe(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),u=f}f=P(u),l.defaultValue=f,g=l.textContent,g===f&&g!==""&&g!==null&&(l.value=g),ut(l)}function yl(l,u){if(u){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=u;return}}l.textContent=u}var IT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function z2(l,u,f){var g=u.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":g?l.setProperty(u,f):typeof f!="number"||f===0||IT.has(u)?u==="float"?l.cssFloat=f:l[u]=(""+f).trim():l[u]=f+"px"}function U2(l,u,f){if(u!=null&&typeof u!="object")throw Error(r(62));if(l=l.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||u!=null&&u.hasOwnProperty(g)||(g.indexOf("--")===0?l.setProperty(g,""):g==="float"?l.cssFloat="":l[g]="");for(var y in u)g=u[y],u.hasOwnProperty(y)&&f[y]!==g&&z2(l,y,g)}else for(var w in u)u.hasOwnProperty(w)&&z2(l,w,u[w])}function s1(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var DT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function of(l){return MT.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function Aa(){}var l1=null;function c1(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var bl=null,wl=null;function H2(l){var u=Lr(l);if(u&&(l=u.stateNode)){var f=l[me]||null;e:switch(l=u.stateNode,u.type){case"input":if(oi(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),u=f.name,f.type==="radio"&&u!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+mn(""+u)+'"][type="radio"]'),u=0;u<f.length;u++){var g=f[u];if(g!==l&&g.form===l.form){var y=g[me]||null;if(!y)throw Error(r(90));oi(g,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(u=0;u<f.length;u++)g=f[u],g.form===l.form&&$t(g)}break e;case"textarea":B2(l,f.value,f.defaultValue);break e;case"select":u=f.value,u!=null&&vl(l,!!f.multiple,u,!1)}}}var u1=!1;function V2(l,u,f){if(u1)return l(u,f);u1=!0;try{var g=l(u);return g}finally{if(u1=!1,(bl!==null||wl!==null)&&(qf(),bl&&(u=bl,l=wl,wl=bl=null,H2(u),l)))for(u=0;u<l.length;u++)H2(l[u])}}function Wc(l,u){var f=l.stateNode;if(f===null)return null;var g=f[me]||null;if(g===null)return null;f=g[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(l=l.type,g=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!g;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(r(231,u,typeof f));return f}var _a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d1=!1;if(_a)try{var qc={};Object.defineProperty(qc,"passive",{get:function(){d1=!0}}),window.addEventListener("test",qc,qc),window.removeEventListener("test",qc,qc)}catch{d1=!1}var co=null,f1=null,sf=null;function $2(){if(sf)return sf;var l,u=f1,f=u.length,g,y="value"in co?co.value:co.textContent,w=y.length;for(l=0;l<f&&u[l]===y[l];l++);var _=f-l;for(g=1;g<=_&&u[f-g]===y[w-g];g++);return sf=y.slice(l,1<g?1-g:void 0)}function lf(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function cf(){return!0}function G2(){return!1}function qr(l){function u(f,g,y,w,_){this._reactName=f,this._targetInst=y,this.type=g,this.nativeEvent=w,this.target=_,this.currentTarget=null;for(var T in l)l.hasOwnProperty(T)&&(f=l[T],this[T]=f?f(w):w[T]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?cf:G2,this.isPropagationStopped=G2,this}return p(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cf)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cf)},persist:function(){},isPersistent:cf}),u}var ys={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uf=qr(ys),Xc=p({},ys,{view:0,detail:0}),RT=qr(Xc),h1,p1,Kc,df=p({},Xc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:g1,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Kc&&(Kc&&l.type==="mousemove"?(h1=l.screenX-Kc.screenX,p1=l.screenY-Kc.screenY):p1=h1=0,Kc=l),h1)},movementY:function(l){return"movementY"in l?l.movementY:p1}}),W2=qr(df),LT=p({},df,{dataTransfer:0}),jT=qr(LT),PT=p({},Xc,{relatedTarget:0}),m1=qr(PT),BT=p({},ys,{animationName:0,elapsedTime:0,pseudoElement:0}),FT=qr(BT),zT=p({},ys,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),UT=qr(zT),HT=p({},ys,{data:0}),q2=qr(HT),VT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$T={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function WT(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=GT[l])?!!u[l]:!1}function g1(){return WT}var qT=p({},Xc,{key:function(l){if(l.key){var u=VT[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=lf(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?$T[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:g1,charCode:function(l){return l.type==="keypress"?lf(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?lf(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),XT=qr(qT),KT=p({},df,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X2=qr(KT),YT=p({},Xc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:g1}),ZT=qr(YT),JT=p({},ys,{propertyName:0,elapsedTime:0,pseudoElement:0}),QT=qr(JT),e8=p({},df,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),t8=qr(e8),n8=p({},ys,{newState:0,oldState:0}),r8=qr(n8),i8=[9,13,27,32],x1=_a&&"CompositionEvent"in window,Yc=null;_a&&"documentMode"in document&&(Yc=document.documentMode);var a8=_a&&"TextEvent"in window&&!Yc,K2=_a&&(!x1||Yc&&8<Yc&&11>=Yc),Y2=" ",Z2=!1;function J2(l,u){switch(l){case"keyup":return i8.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Q2(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Cl=!1;function o8(l,u){switch(l){case"compositionend":return Q2(u);case"keypress":return u.which!==32?null:(Z2=!0,Y2);case"textInput":return l=u.data,l===Y2&&Z2?null:l;default:return null}}function s8(l,u){if(Cl)return l==="compositionend"||!x1&&J2(l,u)?(l=$2(),sf=f1=co=null,Cl=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return K2&&u.locale!=="ko"?null:u.data;default:return null}}var l8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eb(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!l8[l.type]:u==="textarea"}function tb(l,u,f,g){bl?wl?wl.push(g):wl=[g]:bl=g,u=eh(u,"onChange"),0<u.length&&(f=new uf("onChange","change",null,f,g),l.push({event:f,listeners:u}))}var Zc=null,Jc=null;function c8(l){PC(l,0)}function ff(l){var u=Ui(l);if($t(u))return l}function nb(l,u){if(l==="change")return u}var rb=!1;if(_a){var v1;if(_a){var y1="oninput"in document;if(!y1){var ib=document.createElement("div");ib.setAttribute("oninput","return;"),y1=typeof ib.oninput=="function"}v1=y1}else v1=!1;rb=v1&&(!document.documentMode||9<document.documentMode)}function ab(){Zc&&(Zc.detachEvent("onpropertychange",ob),Jc=Zc=null)}function ob(l){if(l.propertyName==="value"&&ff(Jc)){var u=[];tb(u,Jc,l,c1(l)),V2(c8,u)}}function u8(l,u,f){l==="focusin"?(ab(),Zc=u,Jc=f,Zc.attachEvent("onpropertychange",ob)):l==="focusout"&&ab()}function d8(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return ff(Jc)}function f8(l,u){if(l==="click")return ff(u)}function h8(l,u){if(l==="input"||l==="change")return ff(u)}function p8(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var si=typeof Object.is=="function"?Object.is:p8;function Qc(l,u){if(si(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var f=Object.keys(l),g=Object.keys(u);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var y=f[g];if(!Pe.call(u,y)||!si(l[y],u[y]))return!1}return!0}function sb(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function lb(l,u){var f=sb(l);l=0;for(var g;f;){if(f.nodeType===3){if(g=l+f.textContent.length,l<=u&&g>=u)return{node:f,offset:u-l};l=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=sb(f)}}function cb(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?cb(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function ub(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=pn(l.document);u instanceof l.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)l=u.contentWindow;else break;u=pn(l.document)}return u}function b1(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var m8=_a&&"documentMode"in document&&11>=document.documentMode,El=null,w1=null,eu=null,C1=!1;function db(l,u,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;C1||El==null||El!==pn(g)||(g=El,"selectionStart"in g&&b1(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),eu&&Qc(eu,g)||(eu=g,g=eh(w1,"onSelect"),0<g.length&&(u=new uf("onSelect","select",null,u,f),l.push({event:u,listeners:g}),u.target=El)))}function bs(l,u){var f={};return f[l.toLowerCase()]=u.toLowerCase(),f["Webkit"+l]="webkit"+u,f["Moz"+l]="moz"+u,f}var Sl={animationend:bs("Animation","AnimationEnd"),animationiteration:bs("Animation","AnimationIteration"),animationstart:bs("Animation","AnimationStart"),transitionrun:bs("Transition","TransitionRun"),transitionstart:bs("Transition","TransitionStart"),transitioncancel:bs("Transition","TransitionCancel"),transitionend:bs("Transition","TransitionEnd")},E1={},fb={};_a&&(fb=document.createElement("div").style,"AnimationEvent"in window||(delete Sl.animationend.animation,delete Sl.animationiteration.animation,delete Sl.animationstart.animation),"TransitionEvent"in window||delete Sl.transitionend.transition);function ws(l){if(E1[l])return E1[l];if(!Sl[l])return l;var u=Sl[l],f;for(f in u)if(u.hasOwnProperty(f)&&f in fb)return E1[l]=u[f];return l}var hb=ws("animationend"),pb=ws("animationiteration"),mb=ws("animationstart"),g8=ws("transitionrun"),x8=ws("transitionstart"),v8=ws("transitioncancel"),gb=ws("transitionend"),xb=new Map,S1="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");S1.push("scrollEnd");function Hi(l,u){xb.set(l,u),yi(u,[l])}var hf=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},bi=[],Al=0,A1=0;function pf(){for(var l=Al,u=A1=Al=0;u<l;){var f=bi[u];bi[u++]=null;var g=bi[u];bi[u++]=null;var y=bi[u];bi[u++]=null;var w=bi[u];if(bi[u++]=null,g!==null&&y!==null){var _=g.pending;_===null?y.next=y:(y.next=_.next,_.next=y),g.pending=y}w!==0&&vb(f,y,w)}}function mf(l,u,f,g){bi[Al++]=l,bi[Al++]=u,bi[Al++]=f,bi[Al++]=g,A1|=g,l.lanes|=g,l=l.alternate,l!==null&&(l.lanes|=g)}function _1(l,u,f,g){return mf(l,u,f,g),gf(l)}function Cs(l,u){return mf(l,null,null,u),gf(l)}function vb(l,u,f){l.lanes|=f;var g=l.alternate;g!==null&&(g.lanes|=f);for(var y=!1,w=l.return;w!==null;)w.childLanes|=f,g=w.alternate,g!==null&&(g.childLanes|=f),w.tag===22&&(l=w.stateNode,l===null||l._visibility&1||(y=!0)),l=w,w=w.return;return l.tag===3?(w=l.stateNode,y&&u!==null&&(y=31-Tn(f),l=w.hiddenUpdates,g=l[y],g===null?l[y]=[u]:g.push(u),u.lane=f|536870912),w):null}function gf(l){if(50<Cu)throw Cu=0,Lm=null,Error(r(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var _l={};function y8(l,u,f,g){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function li(l,u,f,g){return new y8(l,u,f,g)}function N1(l){return l=l.prototype,!(!l||!l.isReactComponent)}function Na(l,u){var f=l.alternate;return f===null?(f=li(l.tag,u,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=u,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&65011712,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,u=l.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f.refCleanup=l.refCleanup,f}function yb(l,u){l.flags&=65011714;var f=l.alternate;return f===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,u=f.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function xf(l,u,f,g,y,w){var _=0;if(g=l,typeof l=="function")N1(l)&&(_=1);else if(typeof l=="string")_=SO(l,f,re.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case U:return l=li(31,f,u,y),l.elementType=U,l.lanes=w,l;case C:return Es(f.children,y,w,u);case E:_=8,y|=24;break;case S:return l=li(12,f,u,y|2),l.elementType=S,l.lanes=w,l;case D:return l=li(13,f,u,y),l.elementType=D,l.lanes=w,l;case L:return l=li(19,f,u,y),l.elementType=L,l.lanes=w,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case k:_=10;break e;case N:_=9;break e;case I:_=11;break e;case O:_=14;break e;case j:_=16,g=null;break e}_=29,f=Error(r(130,l===null?"null":typeof l,"")),g=null}return u=li(_,f,u,y),u.elementType=l,u.type=g,u.lanes=w,u}function Es(l,u,f,g){return l=li(7,l,g,u),l.lanes=f,l}function k1(l,u,f){return l=li(6,l,null,u),l.lanes=f,l}function bb(l){var u=li(18,null,null,0);return u.stateNode=l,u}function T1(l,u,f){return u=li(4,l.children!==null?l.children:[],l.key,u),u.lanes=f,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var wb=new WeakMap;function wi(l,u){if(typeof l=="object"&&l!==null){var f=wb.get(l);return f!==void 0?f:(u={value:l,source:u,stack:We(u)},wb.set(l,u),u)}return{value:l,source:u,stack:We(u)}}var Nl=[],kl=0,vf=null,tu=0,Ci=[],Ei=0,uo=null,la=1,ca="";function ka(l,u){Nl[kl++]=tu,Nl[kl++]=vf,vf=l,tu=u}function Cb(l,u,f){Ci[Ei++]=la,Ci[Ei++]=ca,Ci[Ei++]=uo,uo=l;var g=la;l=ca;var y=32-Tn(g)-1;g&=~(1<<y),f+=1;var w=32-Tn(u)+y;if(30<w){var _=y-y%5;w=(g&(1<<_)-1).toString(32),g>>=_,y-=_,la=1<<32-Tn(u)+y|f<<y|g,ca=w+l}else la=1<<w|f<<y|g,ca=l}function O1(l){l.return!==null&&(ka(l,1),Cb(l,1,0))}function I1(l){for(;l===vf;)vf=Nl[--kl],Nl[kl]=null,tu=Nl[--kl],Nl[kl]=null;for(;l===uo;)uo=Ci[--Ei],Ci[Ei]=null,ca=Ci[--Ei],Ci[Ei]=null,la=Ci[--Ei],Ci[Ei]=null}function Eb(l,u){Ci[Ei++]=la,Ci[Ei++]=ca,Ci[Ei++]=uo,la=u.id,ca=u.overflow,uo=l}var dr=null,an=null,gt=!1,fo=null,Si=!1,D1=Error(r(519));function ho(l){var u=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nu(wi(u,l)),D1}function Sb(l){var u=l.stateNode,f=l.type,g=l.memoizedProps;switch(u[se]=l,u[me]=g,f){case"dialog":ft("cancel",u),ft("close",u);break;case"iframe":case"object":case"embed":ft("load",u);break;case"video":case"audio":for(f=0;f<Su.length;f++)ft(Su[f],u);break;case"source":ft("error",u);break;case"img":case"image":case"link":ft("error",u),ft("load",u);break;case"details":ft("toggle",u);break;case"input":ft("invalid",u),sa(u,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":ft("invalid",u);break;case"textarea":ft("invalid",u),F2(u,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||u.textContent===""+f||g.suppressHydrationWarning===!0||UC(u.textContent,f)?(g.popover!=null&&(ft("beforetoggle",u),ft("toggle",u)),g.onScroll!=null&&ft("scroll",u),g.onScrollEnd!=null&&ft("scrollend",u),g.onClick!=null&&(u.onclick=Aa),u=!0):u=!1,u||ho(l,!0)}function Ab(l){for(dr=l.return;dr;)switch(dr.tag){case 5:case 31:case 13:Si=!1;return;case 27:case 3:Si=!0;return;default:dr=dr.return}}function Tl(l){if(l!==dr)return!1;if(!gt)return Ab(l),gt=!0,!1;var u=l.tag,f;if((f=u!==3&&u!==27)&&((f=u===5)&&(f=l.type,f=!(f!=="form"&&f!=="button")||Ym(l.type,l.memoizedProps)),f=!f),f&&an&&ho(l),Ab(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));an=YC(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));an=YC(l)}else u===27?(u=an,No(l.type)?(l=tg,tg=null,an=l):an=u):an=dr?_i(l.stateNode.nextSibling):null;return!0}function Ss(){an=dr=null,gt=!1}function M1(){var l=fo;return l!==null&&(Zr===null?Zr=l:Zr.push.apply(Zr,l),fo=null),l}function nu(l){fo===null?fo=[l]:fo.push(l)}var R1=M(null),As=null,Ta=null;function po(l,u,f){Z(R1,u._currentValue),u._currentValue=f}function Oa(l){l._currentValue=R1.current,V(R1)}function L1(l,u,f){for(;l!==null;){var g=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),l===f)break;l=l.return}}function j1(l,u,f,g){var y=l.child;for(y!==null&&(y.return=l);y!==null;){var w=y.dependencies;if(w!==null){var _=y.child;w=w.firstContext;e:for(;w!==null;){var T=w;w=y;for(var F=0;F<u.length;F++)if(T.context===u[F]){w.lanes|=f,T=w.alternate,T!==null&&(T.lanes|=f),L1(w.return,f,l),g||(_=null);break e}w=T.next}}else if(y.tag===18){if(_=y.return,_===null)throw Error(r(341));_.lanes|=f,w=_.alternate,w!==null&&(w.lanes|=f),L1(_,f,l),_=null}else _=y.child;if(_!==null)_.return=y;else for(_=y;_!==null;){if(_===l){_=null;break}if(y=_.sibling,y!==null){y.return=_.return,_=y;break}_=_.return}y=_}}function Ol(l,u,f,g){l=null;for(var y=u,w=!1;y!==null;){if(!w){if((y.flags&524288)!==0)w=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var _=y.alternate;if(_===null)throw Error(r(387));if(_=_.memoizedProps,_!==null){var T=y.type;si(y.pendingProps.value,_.value)||(l!==null?l.push(T):l=[T])}}else if(y===we.current){if(_=y.alternate,_===null)throw Error(r(387));_.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(l!==null?l.push(Tu):l=[Tu])}y=y.return}l!==null&&j1(u,l,f,g),u.flags|=262144}function yf(l){for(l=l.firstContext;l!==null;){if(!si(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function _s(l){As=l,Ta=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function fr(l){return _b(As,l)}function bf(l,u){return As===null&&_s(l),_b(l,u)}function _b(l,u){var f=u._currentValue;if(u={context:u,memoizedValue:f,next:null},Ta===null){if(l===null)throw Error(r(308));Ta=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Ta=Ta.next=u;return f}var b8=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(f,g){l.push(g)}};this.abort=function(){u.aborted=!0,l.forEach(function(f){return f()})}},w8=t.unstable_scheduleCallback,C8=t.unstable_NormalPriority,Mn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function P1(){return{controller:new b8,data:new Map,refCount:0}}function ru(l){l.refCount--,l.refCount===0&&w8(C8,function(){l.controller.abort()})}var iu=null,B1=0,Il=0,Dl=null;function E8(l,u){if(iu===null){var f=iu=[];B1=0,Il=Um(),Dl={status:"pending",value:void 0,then:function(g){f.push(g)}}}return B1++,u.then(Nb,Nb),u}function Nb(){if(--B1===0&&iu!==null){Dl!==null&&(Dl.status="fulfilled");var l=iu;iu=null,Il=0,Dl=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function S8(l,u){var f=[],g={status:"pending",value:null,reason:null,then:function(y){f.push(y)}};return l.then(function(){g.status="fulfilled",g.value=u;for(var y=0;y<f.length;y++)(0,f[y])(u)},function(y){for(g.status="rejected",g.reason=y,y=0;y<f.length;y++)(0,f[y])(void 0)}),g}var kb=H.S;H.S=function(l,u){dC=rn(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&E8(l,u),kb!==null&&kb(l,u)};var Ns=M(null);function F1(){var l=Ns.current;return l!==null?l:Gt.pooledCache}function wf(l,u){u===null?Z(Ns,Ns.current):Z(Ns,u.pool)}function Tb(){var l=F1();return l===null?null:{parent:Mn._currentValue,pool:l}}var Ml=Error(r(460)),z1=Error(r(474)),Cf=Error(r(542)),Ef={then:function(){}};function Ob(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Ib(l,u,f){switch(f=l[f],f===void 0?l.push(u):f!==u&&(u.then(Aa,Aa),u=f),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Mb(l),l;default:if(typeof u.status=="string")u.then(Aa,Aa);else{if(l=Gt,l!==null&&100<l.shellSuspendCounter)throw Error(r(482));l=u,l.status="pending",l.then(function(g){if(u.status==="pending"){var y=u;y.status="fulfilled",y.value=g}},function(g){if(u.status==="pending"){var y=u;y.status="rejected",y.reason=g}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Mb(l),l}throw Ts=u,Ml}}function ks(l){try{var u=l._init;return u(l._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Ts=f,Ml):f}}var Ts=null;function Db(){if(Ts===null)throw Error(r(459));var l=Ts;return Ts=null,l}function Mb(l){if(l===Ml||l===Cf)throw Error(r(483))}var Rl=null,au=0;function Sf(l){var u=au;return au+=1,Rl===null&&(Rl=[]),Ib(Rl,l,u)}function ou(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function Af(l,u){throw u.$$typeof===x?Error(r(525)):(l=Object.prototype.toString.call(u),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function Rb(l){function u(Y,W){if(l){var te=Y.deletions;te===null?(Y.deletions=[W],Y.flags|=16):te.push(W)}}function f(Y,W){if(!l)return null;for(;W!==null;)u(Y,W),W=W.sibling;return null}function g(Y){for(var W=new Map;Y!==null;)Y.key!==null?W.set(Y.key,Y):W.set(Y.index,Y),Y=Y.sibling;return W}function y(Y,W){return Y=Na(Y,W),Y.index=0,Y.sibling=null,Y}function w(Y,W,te){return Y.index=te,l?(te=Y.alternate,te!==null?(te=te.index,te<W?(Y.flags|=67108866,W):te):(Y.flags|=67108866,W)):(Y.flags|=1048576,W)}function _(Y){return l&&Y.alternate===null&&(Y.flags|=67108866),Y}function T(Y,W,te,ve){return W===null||W.tag!==6?(W=k1(te,Y.mode,ve),W.return=Y,W):(W=y(W,te),W.return=Y,W)}function F(Y,W,te,ve){var Ve=te.type;return Ve===C?pe(Y,W,te.props.children,ve,te.key):W!==null&&(W.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===j&&ks(Ve)===W.type)?(W=y(W,te.props),ou(W,te),W.return=Y,W):(W=xf(te.type,te.key,te.props,null,Y.mode,ve),ou(W,te),W.return=Y,W)}function ne(Y,W,te,ve){return W===null||W.tag!==4||W.stateNode.containerInfo!==te.containerInfo||W.stateNode.implementation!==te.implementation?(W=T1(te,Y.mode,ve),W.return=Y,W):(W=y(W,te.children||[]),W.return=Y,W)}function pe(Y,W,te,ve,Ve){return W===null||W.tag!==7?(W=Es(te,Y.mode,ve,Ve),W.return=Y,W):(W=y(W,te),W.return=Y,W)}function ye(Y,W,te){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=k1(""+W,Y.mode,te),W.return=Y,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case v:return te=xf(W.type,W.key,W.props,null,Y.mode,te),ou(te,W),te.return=Y,te;case b:return W=T1(W,Y.mode,te),W.return=Y,W;case j:return W=ks(W),ye(Y,W,te)}if(xe(W)||q(W))return W=Es(W,Y.mode,te,null),W.return=Y,W;if(typeof W.then=="function")return ye(Y,Sf(W),te);if(W.$$typeof===k)return ye(Y,bf(Y,W),te);Af(Y,W)}return null}function oe(Y,W,te,ve){var Ve=W!==null?W.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return Ve!==null?null:T(Y,W,""+te,ve);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case v:return te.key===Ve?F(Y,W,te,ve):null;case b:return te.key===Ve?ne(Y,W,te,ve):null;case j:return te=ks(te),oe(Y,W,te,ve)}if(xe(te)||q(te))return Ve!==null?null:pe(Y,W,te,ve,null);if(typeof te.then=="function")return oe(Y,W,Sf(te),ve);if(te.$$typeof===k)return oe(Y,W,bf(Y,te),ve);Af(Y,te)}return null}function ue(Y,W,te,ve,Ve){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return Y=Y.get(te)||null,T(W,Y,""+ve,Ve);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case v:return Y=Y.get(ve.key===null?te:ve.key)||null,F(W,Y,ve,Ve);case b:return Y=Y.get(ve.key===null?te:ve.key)||null,ne(W,Y,ve,Ve);case j:return ve=ks(ve),ue(Y,W,te,ve,Ve)}if(xe(ve)||q(ve))return Y=Y.get(te)||null,pe(W,Y,ve,Ve,null);if(typeof ve.then=="function")return ue(Y,W,te,Sf(ve),Ve);if(ve.$$typeof===k)return ue(Y,W,te,bf(W,ve),Ve);Af(W,ve)}return null}function je(Y,W,te,ve){for(var Ve=null,wt=null,ze=W,it=W=0,mt=null;ze!==null&&it<te.length;it++){ze.index>it?(mt=ze,ze=null):mt=ze.sibling;var Ct=oe(Y,ze,te[it],ve);if(Ct===null){ze===null&&(ze=mt);break}l&&ze&&Ct.alternate===null&&u(Y,ze),W=w(Ct,W,it),wt===null?Ve=Ct:wt.sibling=Ct,wt=Ct,ze=mt}if(it===te.length)return f(Y,ze),gt&&ka(Y,it),Ve;if(ze===null){for(;it<te.length;it++)ze=ye(Y,te[it],ve),ze!==null&&(W=w(ze,W,it),wt===null?Ve=ze:wt.sibling=ze,wt=ze);return gt&&ka(Y,it),Ve}for(ze=g(ze);it<te.length;it++)mt=ue(ze,Y,it,te[it],ve),mt!==null&&(l&&mt.alternate!==null&&ze.delete(mt.key===null?it:mt.key),W=w(mt,W,it),wt===null?Ve=mt:wt.sibling=mt,wt=mt);return l&&ze.forEach(function(Do){return u(Y,Do)}),gt&&ka(Y,it),Ve}function Xe(Y,W,te,ve){if(te==null)throw Error(r(151));for(var Ve=null,wt=null,ze=W,it=W=0,mt=null,Ct=te.next();ze!==null&&!Ct.done;it++,Ct=te.next()){ze.index>it?(mt=ze,ze=null):mt=ze.sibling;var Do=oe(Y,ze,Ct.value,ve);if(Do===null){ze===null&&(ze=mt);break}l&&ze&&Do.alternate===null&&u(Y,ze),W=w(Do,W,it),wt===null?Ve=Do:wt.sibling=Do,wt=Do,ze=mt}if(Ct.done)return f(Y,ze),gt&&ka(Y,it),Ve;if(ze===null){for(;!Ct.done;it++,Ct=te.next())Ct=ye(Y,Ct.value,ve),Ct!==null&&(W=w(Ct,W,it),wt===null?Ve=Ct:wt.sibling=Ct,wt=Ct);return gt&&ka(Y,it),Ve}for(ze=g(ze);!Ct.done;it++,Ct=te.next())Ct=ue(ze,Y,it,Ct.value,ve),Ct!==null&&(l&&Ct.alternate!==null&&ze.delete(Ct.key===null?it:Ct.key),W=w(Ct,W,it),wt===null?Ve=Ct:wt.sibling=Ct,wt=Ct);return l&&ze.forEach(function(LO){return u(Y,LO)}),gt&&ka(Y,it),Ve}function Bt(Y,W,te,ve){if(typeof te=="object"&&te!==null&&te.type===C&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case v:e:{for(var Ve=te.key;W!==null;){if(W.key===Ve){if(Ve=te.type,Ve===C){if(W.tag===7){f(Y,W.sibling),ve=y(W,te.props.children),ve.return=Y,Y=ve;break e}}else if(W.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===j&&ks(Ve)===W.type){f(Y,W.sibling),ve=y(W,te.props),ou(ve,te),ve.return=Y,Y=ve;break e}f(Y,W);break}else u(Y,W);W=W.sibling}te.type===C?(ve=Es(te.props.children,Y.mode,ve,te.key),ve.return=Y,Y=ve):(ve=xf(te.type,te.key,te.props,null,Y.mode,ve),ou(ve,te),ve.return=Y,Y=ve)}return _(Y);case b:e:{for(Ve=te.key;W!==null;){if(W.key===Ve)if(W.tag===4&&W.stateNode.containerInfo===te.containerInfo&&W.stateNode.implementation===te.implementation){f(Y,W.sibling),ve=y(W,te.children||[]),ve.return=Y,Y=ve;break e}else{f(Y,W);break}else u(Y,W);W=W.sibling}ve=T1(te,Y.mode,ve),ve.return=Y,Y=ve}return _(Y);case j:return te=ks(te),Bt(Y,W,te,ve)}if(xe(te))return je(Y,W,te,ve);if(q(te)){if(Ve=q(te),typeof Ve!="function")throw Error(r(150));return te=Ve.call(te),Xe(Y,W,te,ve)}if(typeof te.then=="function")return Bt(Y,W,Sf(te),ve);if(te.$$typeof===k)return Bt(Y,W,bf(Y,te),ve);Af(Y,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,W!==null&&W.tag===6?(f(Y,W.sibling),ve=y(W,te),ve.return=Y,Y=ve):(f(Y,W),ve=k1(te,Y.mode,ve),ve.return=Y,Y=ve),_(Y)):f(Y,W)}return function(Y,W,te,ve){try{au=0;var Ve=Bt(Y,W,te,ve);return Rl=null,Ve}catch(ze){if(ze===Ml||ze===Cf)throw ze;var wt=li(29,ze,null,Y.mode);return wt.lanes=ve,wt.return=Y,wt}finally{}}}var Os=Rb(!0),Lb=Rb(!1),mo=!1;function U1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function H1(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function go(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function xo(l,u,f){var g=l.updateQueue;if(g===null)return null;if(g=g.shared,(_t&2)!==0){var y=g.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),g.pending=u,u=gf(l),vb(l,null,f),u}return mf(l,g,u,f),gf(l)}function su(l,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194048)!==0)){var g=u.lanes;g&=l.pendingLanes,f|=g,u.lanes=f,Kn(l,f)}}function V1(l,u){var f=l.updateQueue,g=l.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var y=null,w=null;if(f=f.firstBaseUpdate,f!==null){do{var _={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};w===null?y=w=_:w=w.next=_,f=f.next}while(f!==null);w===null?y=w=u:w=w.next=u}else y=w=u;f={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:g.shared,callbacks:g.callbacks},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=u}var $1=!1;function lu(){if($1){var l=Dl;if(l!==null)throw l}}function cu(l,u,f,g){$1=!1;var y=l.updateQueue;mo=!1;var w=y.firstBaseUpdate,_=y.lastBaseUpdate,T=y.shared.pending;if(T!==null){y.shared.pending=null;var F=T,ne=F.next;F.next=null,_===null?w=ne:_.next=ne,_=F;var pe=l.alternate;pe!==null&&(pe=pe.updateQueue,T=pe.lastBaseUpdate,T!==_&&(T===null?pe.firstBaseUpdate=ne:T.next=ne,pe.lastBaseUpdate=F))}if(w!==null){var ye=y.baseState;_=0,pe=ne=F=null,T=w;do{var oe=T.lane&-536870913,ue=oe!==T.lane;if(ue?(pt&oe)===oe:(g&oe)===oe){oe!==0&&oe===Il&&($1=!0),pe!==null&&(pe=pe.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var je=l,Xe=T;oe=u;var Bt=f;switch(Xe.tag){case 1:if(je=Xe.payload,typeof je=="function"){ye=je.call(Bt,ye,oe);break e}ye=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Xe.payload,oe=typeof je=="function"?je.call(Bt,ye,oe):je,oe==null)break e;ye=p({},ye,oe);break e;case 2:mo=!0}}oe=T.callback,oe!==null&&(l.flags|=64,ue&&(l.flags|=8192),ue=y.callbacks,ue===null?y.callbacks=[oe]:ue.push(oe))}else ue={lane:oe,tag:T.tag,payload:T.payload,callback:T.callback,next:null},pe===null?(ne=pe=ue,F=ye):pe=pe.next=ue,_|=oe;if(T=T.next,T===null){if(T=y.shared.pending,T===null)break;ue=T,T=ue.next,ue.next=null,y.lastBaseUpdate=ue,y.shared.pending=null}}while(!0);pe===null&&(F=ye),y.baseState=F,y.firstBaseUpdate=ne,y.lastBaseUpdate=pe,w===null&&(y.shared.lanes=0),Co|=_,l.lanes=_,l.memoizedState=ye}}function jb(l,u){if(typeof l!="function")throw Error(r(191,l));l.call(u)}function Pb(l,u){var f=l.callbacks;if(f!==null)for(l.callbacks=null,l=0;l<f.length;l++)jb(f[l],u)}var Ll=M(null),_f=M(0);function Bb(l,u){l=Fa,Z(_f,l),Z(Ll,u),Fa=l|u.baseLanes}function G1(){Z(_f,Fa),Z(Ll,Ll.current)}function W1(){Fa=_f.current,V(Ll),V(_f)}var ci=M(null),Ai=null;function vo(l){var u=l.alternate;Z(_n,_n.current&1),Z(ci,l),Ai===null&&(u===null||Ll.current!==null||u.memoizedState!==null)&&(Ai=l)}function q1(l){Z(_n,_n.current),Z(ci,l),Ai===null&&(Ai=l)}function Fb(l){l.tag===22?(Z(_n,_n.current),Z(ci,l),Ai===null&&(Ai=l)):yo()}function yo(){Z(_n,_n.current),Z(ci,ci.current)}function ui(l){V(ci),Ai===l&&(Ai=null),V(_n)}var _n=M(0);function Nf(l){for(var u=l;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Qm(f)||eg(f)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Ia=0,nt=null,jt=null,Rn=null,kf=!1,jl=!1,Is=!1,Tf=0,uu=0,Pl=null,A8=0;function yn(){throw Error(r(321))}function X1(l,u){if(u===null)return!1;for(var f=0;f<u.length&&f<l.length;f++)if(!si(l[f],u[f]))return!1;return!0}function K1(l,u,f,g,y,w){return Ia=w,nt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,H.H=l===null||l.memoizedState===null?Cw:um,Is=!1,w=f(g,y),Is=!1,jl&&(w=Ub(u,f,g,y)),zb(l),w}function zb(l){H.H=hu;var u=jt!==null&&jt.next!==null;if(Ia=0,Rn=jt=nt=null,kf=!1,uu=0,Pl=null,u)throw Error(r(300));l===null||Ln||(l=l.dependencies,l!==null&&yf(l)&&(Ln=!0))}function Ub(l,u,f,g){nt=l;var y=0;do{if(jl&&(Pl=null),uu=0,jl=!1,25<=y)throw Error(r(301));if(y+=1,Rn=jt=null,l.updateQueue!=null){var w=l.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}H.H=Ew,w=u(f,g)}while(jl);return w}function _8(){var l=H.H,u=l.useState()[0];return u=typeof u.then=="function"?du(u):u,l=l.useState()[0],(jt!==null?jt.memoizedState:null)!==l&&(nt.flags|=1024),u}function Y1(){var l=Tf!==0;return Tf=0,l}function Z1(l,u,f){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~f}function J1(l){if(kf){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}kf=!1}Ia=0,Rn=jt=nt=null,jl=!1,uu=Tf=0,Pl=null}function Pr(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?nt.memoizedState=Rn=l:Rn=Rn.next=l,Rn}function Nn(){if(jt===null){var l=nt.alternate;l=l!==null?l.memoizedState:null}else l=jt.next;var u=Rn===null?nt.memoizedState:Rn.next;if(u!==null)Rn=u,jt=l;else{if(l===null)throw nt.alternate===null?Error(r(467)):Error(r(310));jt=l,l={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Rn===null?nt.memoizedState=Rn=l:Rn=Rn.next=l}return Rn}function Of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function du(l){var u=uu;return uu+=1,Pl===null&&(Pl=[]),l=Ib(Pl,l,u),u=nt,(Rn===null?u.memoizedState:Rn.next)===null&&(u=u.alternate,H.H=u===null||u.memoizedState===null?Cw:um),l}function If(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return du(l);if(l.$$typeof===k)return fr(l)}throw Error(r(438,String(l)))}function Q1(l){var u=null,f=nt.updateQueue;if(f!==null&&(u=f.memoCache),u==null){var g=nt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(u={data:g.data.map(function(y){return y.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),f===null&&(f=Of(),nt.updateQueue=f),f.memoCache=u,f=u.data[u.index],f===void 0)for(f=u.data[u.index]=Array(l),g=0;g<l;g++)f[g]=fe;return u.index++,f}function Da(l,u){return typeof u=="function"?u(l):u}function Df(l){var u=Nn();return em(u,jt,l)}function em(l,u,f){var g=l.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var y=l.baseQueue,w=g.pending;if(w!==null){if(y!==null){var _=y.next;y.next=w.next,w.next=_}u.baseQueue=y=w,g.pending=null}if(w=l.baseState,y===null)l.memoizedState=w;else{u=y.next;var T=_=null,F=null,ne=u,pe=!1;do{var ye=ne.lane&-536870913;if(ye!==ne.lane?(pt&ye)===ye:(Ia&ye)===ye){var oe=ne.revertLane;if(oe===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ye===Il&&(pe=!0);else if((Ia&oe)===oe){ne=ne.next,oe===Il&&(pe=!0);continue}else ye={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},F===null?(T=F=ye,_=w):F=F.next=ye,nt.lanes|=oe,Co|=oe;ye=ne.action,Is&&f(w,ye),w=ne.hasEagerState?ne.eagerState:f(w,ye)}else oe={lane:ye,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},F===null?(T=F=oe,_=w):F=F.next=oe,nt.lanes|=ye,Co|=ye;ne=ne.next}while(ne!==null&&ne!==u);if(F===null?_=w:F.next=T,!si(w,l.memoizedState)&&(Ln=!0,pe&&(f=Dl,f!==null)))throw f;l.memoizedState=w,l.baseState=_,l.baseQueue=F,g.lastRenderedState=w}return y===null&&(g.lanes=0),[l.memoizedState,g.dispatch]}function tm(l){var u=Nn(),f=u.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=l;var g=f.dispatch,y=f.pending,w=u.memoizedState;if(y!==null){f.pending=null;var _=y=y.next;do w=l(w,_.action),_=_.next;while(_!==y);si(w,u.memoizedState)||(Ln=!0),u.memoizedState=w,u.baseQueue===null&&(u.baseState=w),f.lastRenderedState=w}return[w,g]}function Hb(l,u,f){var g=nt,y=Nn(),w=gt;if(w){if(f===void 0)throw Error(r(407));f=f()}else f=u();var _=!si((jt||y).memoizedState,f);if(_&&(y.memoizedState=f,Ln=!0),y=y.queue,im(Gb.bind(null,g,y,l),[l]),y.getSnapshot!==u||_||Rn!==null&&Rn.memoizedState.tag&1){if(g.flags|=2048,Bl(9,{destroy:void 0},$b.bind(null,g,y,f,u),null),Gt===null)throw Error(r(349));w||(Ia&127)!==0||Vb(g,u,f)}return f}function Vb(l,u,f){l.flags|=16384,l={getSnapshot:u,value:f},u=nt.updateQueue,u===null?(u=Of(),nt.updateQueue=u,u.stores=[l]):(f=u.stores,f===null?u.stores=[l]:f.push(l))}function $b(l,u,f,g){u.value=f,u.getSnapshot=g,Wb(u)&&qb(l)}function Gb(l,u,f){return f(function(){Wb(u)&&qb(l)})}function Wb(l){var u=l.getSnapshot;l=l.value;try{var f=u();return!si(l,f)}catch{return!0}}function qb(l){var u=Cs(l,2);u!==null&&Jr(u,l,2)}function nm(l){var u=Pr();if(typeof l=="function"){var f=l;if(l=f(),Is){cr(!0);try{f()}finally{cr(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:l},u}function Xb(l,u,f,g){return l.baseState=f,em(l,jt,typeof g=="function"?g:Da)}function N8(l,u,f,g,y){if(Lf(l))throw Error(r(485));if(l=u.action,l!==null){var w={payload:y,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){w.listeners.push(_)}};H.T!==null?f(!0):w.isTransition=!1,g(w),f=u.pending,f===null?(w.next=u.pending=w,Kb(u,w)):(w.next=f.next,u.pending=f.next=w)}}function Kb(l,u){var f=u.action,g=u.payload,y=l.state;if(u.isTransition){var w=H.T,_={};H.T=_;try{var T=f(y,g),F=H.S;F!==null&&F(_,T),Yb(l,u,T)}catch(ne){rm(l,u,ne)}finally{w!==null&&_.types!==null&&(w.types=_.types),H.T=w}}else try{w=f(y,g),Yb(l,u,w)}catch(ne){rm(l,u,ne)}}function Yb(l,u,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){Zb(l,u,g)},function(g){return rm(l,u,g)}):Zb(l,u,f)}function Zb(l,u,f){u.status="fulfilled",u.value=f,Jb(u),l.state=f,u=l.pending,u!==null&&(f=u.next,f===u?l.pending=null:(f=f.next,u.next=f,Kb(l,f)))}function rm(l,u,f){var g=l.pending;if(l.pending=null,g!==null){g=g.next;do u.status="rejected",u.reason=f,Jb(u),u=u.next;while(u!==g)}l.action=null}function Jb(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function Qb(l,u){return u}function ew(l,u){if(gt){var f=Gt.formState;if(f!==null){e:{var g=nt;if(gt){if(an){t:{for(var y=an,w=Si;y.nodeType!==8;){if(!w){y=null;break t}if(y=_i(y.nextSibling),y===null){y=null;break t}}w=y.data,y=w==="F!"||w==="F"?y:null}if(y){an=_i(y.nextSibling),g=y.data==="F!";break e}}ho(g)}g=!1}g&&(u=f[0])}}return f=Pr(),f.memoizedState=f.baseState=u,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qb,lastRenderedState:u},f.queue=g,f=yw.bind(null,nt,g),g.dispatch=f,g=nm(!1),w=cm.bind(null,nt,!1,g.queue),g=Pr(),y={state:u,dispatch:null,action:l,pending:null},g.queue=y,f=N8.bind(null,nt,y,w,f),y.dispatch=f,g.memoizedState=l,[u,f,!1]}function tw(l){var u=Nn();return nw(u,jt,l)}function nw(l,u,f){if(u=em(l,u,Qb)[0],l=Df(Da)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var g=du(u)}catch(_){throw _===Ml?Cf:_}else g=u;u=Nn();var y=u.queue,w=y.dispatch;return f!==u.memoizedState&&(nt.flags|=2048,Bl(9,{destroy:void 0},k8.bind(null,y,f),null)),[g,w,l]}function k8(l,u){l.action=u}function rw(l){var u=Nn(),f=jt;if(f!==null)return nw(u,f,l);Nn(),u=u.memoizedState,f=Nn();var g=f.queue.dispatch;return f.memoizedState=l,[u,g,!1]}function Bl(l,u,f,g){return l={tag:l,create:f,deps:g,inst:u,next:null},u=nt.updateQueue,u===null&&(u=Of(),nt.updateQueue=u),f=u.lastEffect,f===null?u.lastEffect=l.next=l:(g=f.next,f.next=l,l.next=g,u.lastEffect=l),l}function iw(){return Nn().memoizedState}function Mf(l,u,f,g){var y=Pr();nt.flags|=l,y.memoizedState=Bl(1|u,{destroy:void 0},f,g===void 0?null:g)}function Rf(l,u,f,g){var y=Nn();g=g===void 0?null:g;var w=y.memoizedState.inst;jt!==null&&g!==null&&X1(g,jt.memoizedState.deps)?y.memoizedState=Bl(u,w,f,g):(nt.flags|=l,y.memoizedState=Bl(1|u,w,f,g))}function aw(l,u){Mf(8390656,8,l,u)}function im(l,u){Rf(2048,8,l,u)}function T8(l){nt.flags|=4;var u=nt.updateQueue;if(u===null)u=Of(),nt.updateQueue=u,u.events=[l];else{var f=u.events;f===null?u.events=[l]:f.push(l)}}function ow(l){var u=Nn().memoizedState;return T8({ref:u,nextImpl:l}),function(){if((_t&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}function sw(l,u){return Rf(4,2,l,u)}function lw(l,u){return Rf(4,4,l,u)}function cw(l,u){if(typeof u=="function"){l=l();var f=u(l);return function(){typeof f=="function"?f():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function uw(l,u,f){f=f!=null?f.concat([l]):null,Rf(4,4,cw.bind(null,u,l),f)}function am(){}function dw(l,u){var f=Nn();u=u===void 0?null:u;var g=f.memoizedState;return u!==null&&X1(u,g[1])?g[0]:(f.memoizedState=[l,u],l)}function fw(l,u){var f=Nn();u=u===void 0?null:u;var g=f.memoizedState;if(u!==null&&X1(u,g[1]))return g[0];if(g=l(),Is){cr(!0);try{l()}finally{cr(!1)}}return f.memoizedState=[g,u],g}function om(l,u,f){return f===void 0||(Ia&1073741824)!==0&&(pt&261930)===0?l.memoizedState=u:(l.memoizedState=f,l=hC(),nt.lanes|=l,Co|=l,f)}function hw(l,u,f,g){return si(f,u)?f:Ll.current!==null?(l=om(l,f,g),si(l,u)||(Ln=!0),l):(Ia&42)===0||(Ia&1073741824)!==0&&(pt&261930)===0?(Ln=!0,l.memoizedState=f):(l=hC(),nt.lanes|=l,Co|=l,u)}function pw(l,u,f,g,y){var w=ie.p;ie.p=w!==0&&8>w?w:8;var _=H.T,T={};H.T=T,cm(l,!1,u,f);try{var F=y(),ne=H.S;if(ne!==null&&ne(T,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var pe=S8(F,g);fu(l,u,pe,hi(l))}else fu(l,u,g,hi(l))}catch(ye){fu(l,u,{then:function(){},status:"rejected",reason:ye},hi())}finally{ie.p=w,_!==null&&T.types!==null&&(_.types=T.types),H.T=_}}function O8(){}function sm(l,u,f,g){if(l.tag!==5)throw Error(r(476));var y=mw(l).queue;pw(l,y,u,K,f===null?O8:function(){return gw(l),f(g)})}function mw(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:K},next:null};var f={};return u.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:f},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function gw(l){var u=mw(l);u.next===null&&(u=l.alternate.memoizedState),fu(l,u.next.queue,{},hi())}function lm(){return fr(Tu)}function xw(){return Nn().memoizedState}function vw(){return Nn().memoizedState}function I8(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var f=hi();l=go(f);var g=xo(u,l,f);g!==null&&(Jr(g,u,f),su(g,u,f)),u={cache:P1()},l.payload=u;return}u=u.return}}function D8(l,u,f){var g=hi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Lf(l)?bw(u,f):(f=_1(l,u,f,g),f!==null&&(Jr(f,l,g),ww(f,u,g)))}function yw(l,u,f){var g=hi();fu(l,u,f,g)}function fu(l,u,f,g){var y={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Lf(l))bw(u,y);else{var w=l.alternate;if(l.lanes===0&&(w===null||w.lanes===0)&&(w=u.lastRenderedReducer,w!==null))try{var _=u.lastRenderedState,T=w(_,f);if(y.hasEagerState=!0,y.eagerState=T,si(T,_))return mf(l,u,y,0),Gt===null&&pf(),!1}catch{}finally{}if(f=_1(l,u,y,g),f!==null)return Jr(f,l,g),ww(f,u,g),!0}return!1}function cm(l,u,f,g){if(g={lane:2,revertLane:Um(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Lf(l)){if(u)throw Error(r(479))}else u=_1(l,f,g,2),u!==null&&Jr(u,l,2)}function Lf(l){var u=l.alternate;return l===nt||u!==null&&u===nt}function bw(l,u){jl=kf=!0;var f=l.pending;f===null?u.next=u:(u.next=f.next,f.next=u),l.pending=u}function ww(l,u,f){if((f&4194048)!==0){var g=u.lanes;g&=l.pendingLanes,f|=g,u.lanes=f,Kn(l,f)}}var hu={readContext:fr,use:If,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};hu.useEffectEvent=yn;var Cw={readContext:fr,use:If,useCallback:function(l,u){return Pr().memoizedState=[l,u===void 0?null:u],l},useContext:fr,useEffect:aw,useImperativeHandle:function(l,u,f){f=f!=null?f.concat([l]):null,Mf(4194308,4,cw.bind(null,u,l),f)},useLayoutEffect:function(l,u){return Mf(4194308,4,l,u)},useInsertionEffect:function(l,u){Mf(4,2,l,u)},useMemo:function(l,u){var f=Pr();u=u===void 0?null:u;var g=l();if(Is){cr(!0);try{l()}finally{cr(!1)}}return f.memoizedState=[g,u],g},useReducer:function(l,u,f){var g=Pr();if(f!==void 0){var y=f(u);if(Is){cr(!0);try{f(u)}finally{cr(!1)}}}else y=u;return g.memoizedState=g.baseState=y,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:y},g.queue=l,l=l.dispatch=D8.bind(null,nt,l),[g.memoizedState,l]},useRef:function(l){var u=Pr();return l={current:l},u.memoizedState=l},useState:function(l){l=nm(l);var u=l.queue,f=yw.bind(null,nt,u);return u.dispatch=f,[l.memoizedState,f]},useDebugValue:am,useDeferredValue:function(l,u){var f=Pr();return om(f,l,u)},useTransition:function(){var l=nm(!1);return l=pw.bind(null,nt,l.queue,!0,!1),Pr().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,f){var g=nt,y=Pr();if(gt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=u(),Gt===null)throw Error(r(349));(pt&127)!==0||Vb(g,u,f)}y.memoizedState=f;var w={value:f,getSnapshot:u};return y.queue=w,aw(Gb.bind(null,g,w,l),[l]),g.flags|=2048,Bl(9,{destroy:void 0},$b.bind(null,g,w,f,u),null),f},useId:function(){var l=Pr(),u=Gt.identifierPrefix;if(gt){var f=ca,g=la;f=(g&~(1<<32-Tn(g)-1)).toString(32)+f,u="_"+u+"R_"+f,f=Tf++,0<f&&(u+="H"+f.toString(32)),u+="_"}else f=A8++,u="_"+u+"r_"+f.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:lm,useFormState:ew,useActionState:ew,useOptimistic:function(l){var u=Pr();u.memoizedState=u.baseState=l;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=f,u=cm.bind(null,nt,!0,f),f.dispatch=u,[l,u]},useMemoCache:Q1,useCacheRefresh:function(){return Pr().memoizedState=I8.bind(null,nt)},useEffectEvent:function(l){var u=Pr(),f={impl:l};return u.memoizedState=f,function(){if((_t&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},um={readContext:fr,use:If,useCallback:dw,useContext:fr,useEffect:im,useImperativeHandle:uw,useInsertionEffect:sw,useLayoutEffect:lw,useMemo:fw,useReducer:Df,useRef:iw,useState:function(){return Df(Da)},useDebugValue:am,useDeferredValue:function(l,u){var f=Nn();return hw(f,jt.memoizedState,l,u)},useTransition:function(){var l=Df(Da)[0],u=Nn().memoizedState;return[typeof l=="boolean"?l:du(l),u]},useSyncExternalStore:Hb,useId:xw,useHostTransitionStatus:lm,useFormState:tw,useActionState:tw,useOptimistic:function(l,u){var f=Nn();return Xb(f,jt,l,u)},useMemoCache:Q1,useCacheRefresh:vw};um.useEffectEvent=ow;var Ew={readContext:fr,use:If,useCallback:dw,useContext:fr,useEffect:im,useImperativeHandle:uw,useInsertionEffect:sw,useLayoutEffect:lw,useMemo:fw,useReducer:tm,useRef:iw,useState:function(){return tm(Da)},useDebugValue:am,useDeferredValue:function(l,u){var f=Nn();return jt===null?om(f,l,u):hw(f,jt.memoizedState,l,u)},useTransition:function(){var l=tm(Da)[0],u=Nn().memoizedState;return[typeof l=="boolean"?l:du(l),u]},useSyncExternalStore:Hb,useId:xw,useHostTransitionStatus:lm,useFormState:rw,useActionState:rw,useOptimistic:function(l,u){var f=Nn();return jt!==null?Xb(f,jt,l,u):(f.baseState=l,[l,f.queue.dispatch])},useMemoCache:Q1,useCacheRefresh:vw};Ew.useEffectEvent=ow;function dm(l,u,f,g){u=l.memoizedState,f=f(g,u),f=f==null?u:p({},u,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var fm={enqueueSetState:function(l,u,f){l=l._reactInternals;var g=hi(),y=go(g);y.payload=u,f!=null&&(y.callback=f),u=xo(l,y,g),u!==null&&(Jr(u,l,g),su(u,l,g))},enqueueReplaceState:function(l,u,f){l=l._reactInternals;var g=hi(),y=go(g);y.tag=1,y.payload=u,f!=null&&(y.callback=f),u=xo(l,y,g),u!==null&&(Jr(u,l,g),su(u,l,g))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var f=hi(),g=go(f);g.tag=2,u!=null&&(g.callback=u),u=xo(l,g,f),u!==null&&(Jr(u,l,f),su(u,l,f))}};function Sw(l,u,f,g,y,w,_){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(g,w,_):u.prototype&&u.prototype.isPureReactComponent?!Qc(f,g)||!Qc(y,w):!0}function Aw(l,u,f,g){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,g),u.state!==l&&fm.enqueueReplaceState(u,u.state,null)}function Ds(l,u){var f=u;if("ref"in u){f={};for(var g in u)g!=="ref"&&(f[g]=u[g])}if(l=l.defaultProps){f===u&&(f=p({},f));for(var y in l)f[y]===void 0&&(f[y]=l[y])}return f}function _w(l){hf(l)}function Nw(l){console.error(l)}function kw(l){hf(l)}function jf(l,u){try{var f=l.onUncaughtError;f(u.value,{componentStack:u.stack})}catch(g){setTimeout(function(){throw g})}}function Tw(l,u,f){try{var g=l.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function hm(l,u,f){return f=go(f),f.tag=3,f.payload={element:null},f.callback=function(){jf(l,u)},f}function Ow(l){return l=go(l),l.tag=3,l}function Iw(l,u,f,g){var y=f.type.getDerivedStateFromError;if(typeof y=="function"){var w=g.value;l.payload=function(){return y(w)},l.callback=function(){Tw(u,f,g)}}var _=f.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(l.callback=function(){Tw(u,f,g),typeof y!="function"&&(Eo===null?Eo=new Set([this]):Eo.add(this));var T=g.stack;this.componentDidCatch(g.value,{componentStack:T!==null?T:""})})}function M8(l,u,f,g,y){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(u=f.alternate,u!==null&&Ol(u,f,y,!0),f=ci.current,f!==null){switch(f.tag){case 31:case 13:return Ai===null?Xf():f.alternate===null&&bn===0&&(bn=3),f.flags&=-257,f.flags|=65536,f.lanes=y,g===Ef?f.flags|=16384:(u=f.updateQueue,u===null?f.updateQueue=new Set([g]):u.add(g),Bm(l,g,y)),!1;case 22:return f.flags|=65536,g===Ef?f.flags|=16384:(u=f.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=u):(f=u.retryQueue,f===null?u.retryQueue=new Set([g]):f.add(g)),Bm(l,g,y)),!1}throw Error(r(435,f.tag))}return Bm(l,g,y),Xf(),!1}if(gt)return u=ci.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=y,g!==D1&&(l=Error(r(422),{cause:g}),nu(wi(l,f)))):(g!==D1&&(u=Error(r(423),{cause:g}),nu(wi(u,f))),l=l.current.alternate,l.flags|=65536,y&=-y,l.lanes|=y,g=wi(g,f),y=hm(l.stateNode,g,y),V1(l,y),bn!==4&&(bn=2)),!1;var w=Error(r(520),{cause:g});if(w=wi(w,f),wu===null?wu=[w]:wu.push(w),bn!==4&&(bn=2),u===null)return!0;g=wi(g,f),f=u;do{switch(f.tag){case 3:return f.flags|=65536,l=y&-y,f.lanes|=l,l=hm(f.stateNode,g,l),V1(f,l),!1;case 1:if(u=f.type,w=f.stateNode,(f.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Eo===null||!Eo.has(w))))return f.flags|=65536,y&=-y,f.lanes|=y,y=Ow(y),Iw(y,l,f,g),V1(f,y),!1}f=f.return}while(f!==null);return!1}var pm=Error(r(461)),Ln=!1;function hr(l,u,f,g){u.child=l===null?Lb(u,null,f,g):Os(u,l.child,f,g)}function Dw(l,u,f,g,y){f=f.render;var w=u.ref;if("ref"in g){var _={};for(var T in g)T!=="ref"&&(_[T]=g[T])}else _=g;return _s(u),g=K1(l,u,f,_,w,y),T=Y1(),l!==null&&!Ln?(Z1(l,u,y),Ma(l,u,y)):(gt&&T&&O1(u),u.flags|=1,hr(l,u,g,y),u.child)}function Mw(l,u,f,g,y){if(l===null){var w=f.type;return typeof w=="function"&&!N1(w)&&w.defaultProps===void 0&&f.compare===null?(u.tag=15,u.type=w,Rw(l,u,w,g,y)):(l=xf(f.type,null,g,u,u.mode,y),l.ref=u.ref,l.return=u,u.child=l)}if(w=l.child,!Cm(l,y)){var _=w.memoizedProps;if(f=f.compare,f=f!==null?f:Qc,f(_,g)&&l.ref===u.ref)return Ma(l,u,y)}return u.flags|=1,l=Na(w,g),l.ref=u.ref,l.return=u,u.child=l}function Rw(l,u,f,g,y){if(l!==null){var w=l.memoizedProps;if(Qc(w,g)&&l.ref===u.ref)if(Ln=!1,u.pendingProps=g=w,Cm(l,y))(l.flags&131072)!==0&&(Ln=!0);else return u.lanes=l.lanes,Ma(l,u,y)}return mm(l,u,f,g,y)}function Lw(l,u,f,g){var y=g.children,w=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((u.flags&128)!==0){if(w=w!==null?w.baseLanes|f:f,l!==null){for(g=u.child=l.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;g=y&~w}else g=0,u.child=null;return jw(l,u,w,f,g)}if((f&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&wf(u,w!==null?w.cachePool:null),w!==null?Bb(u,w):G1(),Fb(u);else return g=u.lanes=536870912,jw(l,u,w!==null?w.baseLanes|f:f,f,g)}else w!==null?(wf(u,w.cachePool),Bb(u,w),yo(),u.memoizedState=null):(l!==null&&wf(u,null),G1(),yo());return hr(l,u,y,f),u.child}function pu(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function jw(l,u,f,g,y){var w=F1();return w=w===null?null:{parent:Mn._currentValue,pool:w},u.memoizedState={baseLanes:f,cachePool:w},l!==null&&wf(u,null),G1(),Fb(u),l!==null&&Ol(l,u,g,!0),u.childLanes=y,null}function Pf(l,u){return u=Ff({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function Pw(l,u,f){return Os(u,l.child,null,f),l=Pf(u,u.pendingProps),l.flags|=2,ui(u),u.memoizedState=null,l}function R8(l,u,f){var g=u.pendingProps,y=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(gt){if(g.mode==="hidden")return l=Pf(u,g),u.lanes=536870912,pu(null,l);if(q1(u),(l=an)?(l=KC(l,Si),l=l!==null&&l.data==="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:uo!==null?{id:la,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},f=bb(l),f.return=u,u.child=f,dr=u,an=null)):l=null,l===null)throw ho(u);return u.lanes=536870912,null}return Pf(u,g)}var w=l.memoizedState;if(w!==null){var _=w.dehydrated;if(q1(u),y)if(u.flags&256)u.flags&=-257,u=Pw(l,u,f);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(r(558));else if(Ln||Ol(l,u,f,!1),y=(f&l.childLanes)!==0,Ln||y){if(g=Gt,g!==null&&(_=Sr(g,f),_!==0&&_!==w.retryLane))throw w.retryLane=_,Cs(l,_),Jr(g,l,_),pm;Xf(),u=Pw(l,u,f)}else l=w.treeContext,an=_i(_.nextSibling),dr=u,gt=!0,fo=null,Si=!1,l!==null&&Eb(u,l),u=Pf(u,g),u.flags|=4096;return u}return l=Na(l.child,{mode:g.mode,children:g.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Bf(l,u){var f=u.ref;if(f===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(l===null||l.ref!==f)&&(u.flags|=4194816)}}function mm(l,u,f,g,y){return _s(u),f=K1(l,u,f,g,void 0,y),g=Y1(),l!==null&&!Ln?(Z1(l,u,y),Ma(l,u,y)):(gt&&g&&O1(u),u.flags|=1,hr(l,u,f,y),u.child)}function Bw(l,u,f,g,y,w){return _s(u),u.updateQueue=null,f=Ub(u,g,f,y),zb(l),g=Y1(),l!==null&&!Ln?(Z1(l,u,w),Ma(l,u,w)):(gt&&g&&O1(u),u.flags|=1,hr(l,u,f,w),u.child)}function Fw(l,u,f,g,y){if(_s(u),u.stateNode===null){var w=_l,_=f.contextType;typeof _=="object"&&_!==null&&(w=fr(_)),w=new f(g,w),u.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=fm,u.stateNode=w,w._reactInternals=u,w=u.stateNode,w.props=g,w.state=u.memoizedState,w.refs={},U1(u),_=f.contextType,w.context=typeof _=="object"&&_!==null?fr(_):_l,w.state=u.memoizedState,_=f.getDerivedStateFromProps,typeof _=="function"&&(dm(u,f,_,g),w.state=u.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(_=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),_!==w.state&&fm.enqueueReplaceState(w,w.state,null),cu(u,g,w,y),lu(),w.state=u.memoizedState),typeof w.componentDidMount=="function"&&(u.flags|=4194308),g=!0}else if(l===null){w=u.stateNode;var T=u.memoizedProps,F=Ds(f,T);w.props=F;var ne=w.context,pe=f.contextType;_=_l,typeof pe=="object"&&pe!==null&&(_=fr(pe));var ye=f.getDerivedStateFromProps;pe=typeof ye=="function"||typeof w.getSnapshotBeforeUpdate=="function",T=u.pendingProps!==T,pe||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(T||ne!==_)&&Aw(u,w,g,_),mo=!1;var oe=u.memoizedState;w.state=oe,cu(u,g,w,y),lu(),ne=u.memoizedState,T||oe!==ne||mo?(typeof ye=="function"&&(dm(u,f,ye,g),ne=u.memoizedState),(F=mo||Sw(u,f,F,g,oe,ne,_))?(pe||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(u.flags|=4194308)):(typeof w.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=ne),w.props=g,w.state=ne,w.context=_,g=F):(typeof w.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{w=u.stateNode,H1(l,u),_=u.memoizedProps,pe=Ds(f,_),w.props=pe,ye=u.pendingProps,oe=w.context,ne=f.contextType,F=_l,typeof ne=="object"&&ne!==null&&(F=fr(ne)),T=f.getDerivedStateFromProps,(ne=typeof T=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(_!==ye||oe!==F)&&Aw(u,w,g,F),mo=!1,oe=u.memoizedState,w.state=oe,cu(u,g,w,y),lu();var ue=u.memoizedState;_!==ye||oe!==ue||mo||l!==null&&l.dependencies!==null&&yf(l.dependencies)?(typeof T=="function"&&(dm(u,f,T,g),ue=u.memoizedState),(pe=mo||Sw(u,f,pe,g,oe,ue,F)||l!==null&&l.dependencies!==null&&yf(l.dependencies))?(ne||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(g,ue,F),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(g,ue,F)),typeof w.componentDidUpdate=="function"&&(u.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof w.componentDidUpdate!="function"||_===l.memoizedProps&&oe===l.memoizedState||(u.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||_===l.memoizedProps&&oe===l.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=ue),w.props=g,w.state=ue,w.context=F,g=pe):(typeof w.componentDidUpdate!="function"||_===l.memoizedProps&&oe===l.memoizedState||(u.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||_===l.memoizedProps&&oe===l.memoizedState||(u.flags|=1024),g=!1)}return w=g,Bf(l,u),g=(u.flags&128)!==0,w||g?(w=u.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:w.render(),u.flags|=1,l!==null&&g?(u.child=Os(u,l.child,null,y),u.child=Os(u,null,f,y)):hr(l,u,f,y),u.memoizedState=w.state,l=u.child):l=Ma(l,u,y),l}function zw(l,u,f,g){return Ss(),u.flags|=256,hr(l,u,f,g),u.child}var gm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xm(l){return{baseLanes:l,cachePool:Tb()}}function vm(l,u,f){return l=l!==null?l.childLanes&~f:0,u&&(l|=fi),l}function Uw(l,u,f){var g=u.pendingProps,y=!1,w=(u.flags&128)!==0,_;if((_=w)||(_=l!==null&&l.memoizedState===null?!1:(_n.current&2)!==0),_&&(y=!0,u.flags&=-129),_=(u.flags&32)!==0,u.flags&=-33,l===null){if(gt){if(y?vo(u):yo(),(l=an)?(l=KC(l,Si),l=l!==null&&l.data!=="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:uo!==null?{id:la,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},f=bb(l),f.return=u,u.child=f,dr=u,an=null)):l=null,l===null)throw ho(u);return eg(l)?u.lanes=32:u.lanes=536870912,null}var T=g.children;return g=g.fallback,y?(yo(),y=u.mode,T=Ff({mode:"hidden",children:T},y),g=Es(g,y,f,null),T.return=u,g.return=u,T.sibling=g,u.child=T,g=u.child,g.memoizedState=xm(f),g.childLanes=vm(l,_,f),u.memoizedState=gm,pu(null,g)):(vo(u),ym(u,T))}var F=l.memoizedState;if(F!==null&&(T=F.dehydrated,T!==null)){if(w)u.flags&256?(vo(u),u.flags&=-257,u=bm(l,u,f)):u.memoizedState!==null?(yo(),u.child=l.child,u.flags|=128,u=null):(yo(),T=g.fallback,y=u.mode,g=Ff({mode:"visible",children:g.children},y),T=Es(T,y,f,null),T.flags|=2,g.return=u,T.return=u,g.sibling=T,u.child=g,Os(u,l.child,null,f),g=u.child,g.memoizedState=xm(f),g.childLanes=vm(l,_,f),u.memoizedState=gm,u=pu(null,g));else if(vo(u),eg(T)){if(_=T.nextSibling&&T.nextSibling.dataset,_)var ne=_.dgst;_=ne,g=Error(r(419)),g.stack="",g.digest=_,nu({value:g,source:null,stack:null}),u=bm(l,u,f)}else if(Ln||Ol(l,u,f,!1),_=(f&l.childLanes)!==0,Ln||_){if(_=Gt,_!==null&&(g=Sr(_,f),g!==0&&g!==F.retryLane))throw F.retryLane=g,Cs(l,g),Jr(_,l,g),pm;Qm(T)||Xf(),u=bm(l,u,f)}else Qm(T)?(u.flags|=192,u.child=l.child,u=null):(l=F.treeContext,an=_i(T.nextSibling),dr=u,gt=!0,fo=null,Si=!1,l!==null&&Eb(u,l),u=ym(u,g.children),u.flags|=4096);return u}return y?(yo(),T=g.fallback,y=u.mode,F=l.child,ne=F.sibling,g=Na(F,{mode:"hidden",children:g.children}),g.subtreeFlags=F.subtreeFlags&65011712,ne!==null?T=Na(ne,T):(T=Es(T,y,f,null),T.flags|=2),T.return=u,g.return=u,g.sibling=T,u.child=g,pu(null,g),g=u.child,T=l.child.memoizedState,T===null?T=xm(f):(y=T.cachePool,y!==null?(F=Mn._currentValue,y=y.parent!==F?{parent:F,pool:F}:y):y=Tb(),T={baseLanes:T.baseLanes|f,cachePool:y}),g.memoizedState=T,g.childLanes=vm(l,_,f),u.memoizedState=gm,pu(l.child,g)):(vo(u),f=l.child,l=f.sibling,f=Na(f,{mode:"visible",children:g.children}),f.return=u,f.sibling=null,l!==null&&(_=u.deletions,_===null?(u.deletions=[l],u.flags|=16):_.push(l)),u.child=f,u.memoizedState=null,f)}function ym(l,u){return u=Ff({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Ff(l,u){return l=li(22,l,null,u),l.lanes=0,l}function bm(l,u,f){return Os(u,l.child,null,f),l=ym(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Hw(l,u,f){l.lanes|=u;var g=l.alternate;g!==null&&(g.lanes|=u),L1(l.return,u,f)}function wm(l,u,f,g,y,w){var _=l.memoizedState;_===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:y,treeForkCount:w}:(_.isBackwards=u,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=f,_.tailMode=y,_.treeForkCount=w)}function Vw(l,u,f){var g=u.pendingProps,y=g.revealOrder,w=g.tail;g=g.children;var _=_n.current,T=(_&2)!==0;if(T?(_=_&1|2,u.flags|=128):_&=1,Z(_n,_),hr(l,u,g,f),g=gt?tu:0,!T&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Hw(l,f,u);else if(l.tag===19)Hw(l,f,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(y){case"forwards":for(f=u.child,y=null;f!==null;)l=f.alternate,l!==null&&Nf(l)===null&&(y=f),f=f.sibling;f=y,f===null?(y=u.child,u.child=null):(y=f.sibling,f.sibling=null),wm(u,!1,y,f,w,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,y=u.child,u.child=null;y!==null;){if(l=y.alternate,l!==null&&Nf(l)===null){u.child=y;break}l=y.sibling,y.sibling=f,f=y,y=l}wm(u,!0,f,null,w,g);break;case"together":wm(u,!1,null,null,void 0,g);break;default:u.memoizedState=null}return u.child}function Ma(l,u,f){if(l!==null&&(u.dependencies=l.dependencies),Co|=u.lanes,(f&u.childLanes)===0)if(l!==null){if(Ol(l,u,f,!1),(f&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(r(153));if(u.child!==null){for(l=u.child,f=Na(l,l.pendingProps),u.child=f,f.return=u;l.sibling!==null;)l=l.sibling,f=f.sibling=Na(l,l.pendingProps),f.return=u;f.sibling=null}return u.child}function Cm(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&yf(l)))}function L8(l,u,f){switch(u.tag){case 3:z(u,u.stateNode.containerInfo),po(u,Mn,l.memoizedState.cache),Ss();break;case 27:case 5:ce(u);break;case 4:z(u,u.stateNode.containerInfo);break;case 10:po(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,q1(u),null;break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(vo(u),u.flags|=128,null):(f&u.child.childLanes)!==0?Uw(l,u,f):(vo(u),l=Ma(l,u,f),l!==null?l.sibling:null);vo(u);break;case 19:var y=(l.flags&128)!==0;if(g=(f&u.childLanes)!==0,g||(Ol(l,u,f,!1),g=(f&u.childLanes)!==0),y){if(g)return Vw(l,u,f);u.flags|=128}if(y=u.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Z(_n,_n.current),g)break;return null;case 22:return u.lanes=0,Lw(l,u,f,u.pendingProps);case 24:po(u,Mn,l.memoizedState.cache)}return Ma(l,u,f)}function $w(l,u,f){if(l!==null)if(l.memoizedProps!==u.pendingProps)Ln=!0;else{if(!Cm(l,f)&&(u.flags&128)===0)return Ln=!1,L8(l,u,f);Ln=(l.flags&131072)!==0}else Ln=!1,gt&&(u.flags&1048576)!==0&&Cb(u,tu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var g=u.pendingProps;if(l=ks(u.elementType),u.type=l,typeof l=="function")N1(l)?(g=Ds(l,g),u.tag=1,u=Fw(null,u,l,g,f)):(u.tag=0,u=mm(null,u,l,g,f));else{if(l!=null){var y=l.$$typeof;if(y===I){u.tag=11,u=Dw(null,u,l,g,f);break e}else if(y===O){u.tag=14,u=Mw(null,u,l,g,f);break e}}throw u=ge(l)||l,Error(r(306,u,""))}}return u;case 0:return mm(l,u,u.type,u.pendingProps,f);case 1:return g=u.type,y=Ds(g,u.pendingProps),Fw(l,u,g,y,f);case 3:e:{if(z(u,u.stateNode.containerInfo),l===null)throw Error(r(387));g=u.pendingProps;var w=u.memoizedState;y=w.element,H1(l,u),cu(u,g,null,f);var _=u.memoizedState;if(g=_.cache,po(u,Mn,g),g!==w.cache&&j1(u,[Mn],f,!0),lu(),g=_.element,w.isDehydrated)if(w={element:g,isDehydrated:!1,cache:_.cache},u.updateQueue.baseState=w,u.memoizedState=w,u.flags&256){u=zw(l,u,g,f);break e}else if(g!==y){y=wi(Error(r(424)),u),nu(y),u=zw(l,u,g,f);break e}else{switch(l=u.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(an=_i(l.firstChild),dr=u,gt=!0,fo=null,Si=!0,f=Lb(u,null,g,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ss(),g===y){u=Ma(l,u,f);break e}hr(l,u,g,f)}u=u.child}return u;case 26:return Bf(l,u),l===null?(f=tE(u.type,null,u.pendingProps,null))?u.memoizedState=f:gt||(f=u.type,l=u.pendingProps,g=th(J.current).createElement(f),g[se]=u,g[me]=l,pr(g,f,l),Dn(g),u.stateNode=g):u.memoizedState=tE(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return ce(u),l===null&&gt&&(g=u.stateNode=JC(u.type,u.pendingProps,J.current),dr=u,Si=!0,y=an,No(u.type)?(tg=y,an=_i(g.firstChild)):an=y),hr(l,u,u.pendingProps.children,f),Bf(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&gt&&((y=g=an)&&(g=dO(g,u.type,u.pendingProps,Si),g!==null?(u.stateNode=g,dr=u,an=_i(g.firstChild),Si=!1,y=!0):y=!1),y||ho(u)),ce(u),y=u.type,w=u.pendingProps,_=l!==null?l.memoizedProps:null,g=w.children,Ym(y,w)?g=null:_!==null&&Ym(y,_)&&(u.flags|=32),u.memoizedState!==null&&(y=K1(l,u,_8,null,null,f),Tu._currentValue=y),Bf(l,u),hr(l,u,g,f),u.child;case 6:return l===null&&gt&&((l=f=an)&&(f=fO(f,u.pendingProps,Si),f!==null?(u.stateNode=f,dr=u,an=null,l=!0):l=!1),l||ho(u)),null;case 13:return Uw(l,u,f);case 4:return z(u,u.stateNode.containerInfo),g=u.pendingProps,l===null?u.child=Os(u,null,g,f):hr(l,u,g,f),u.child;case 11:return Dw(l,u,u.type,u.pendingProps,f);case 7:return hr(l,u,u.pendingProps,f),u.child;case 8:return hr(l,u,u.pendingProps.children,f),u.child;case 12:return hr(l,u,u.pendingProps.children,f),u.child;case 10:return g=u.pendingProps,po(u,u.type,g.value),hr(l,u,g.children,f),u.child;case 9:return y=u.type._context,g=u.pendingProps.children,_s(u),y=fr(y),g=g(y),u.flags|=1,hr(l,u,g,f),u.child;case 14:return Mw(l,u,u.type,u.pendingProps,f);case 15:return Rw(l,u,u.type,u.pendingProps,f);case 19:return Vw(l,u,f);case 31:return R8(l,u,f);case 22:return Lw(l,u,f,u.pendingProps);case 24:return _s(u),g=fr(Mn),l===null?(y=F1(),y===null&&(y=Gt,w=P1(),y.pooledCache=w,w.refCount++,w!==null&&(y.pooledCacheLanes|=f),y=w),u.memoizedState={parent:g,cache:y},U1(u),po(u,Mn,y)):((l.lanes&f)!==0&&(H1(l,u),cu(u,null,null,f),lu()),y=l.memoizedState,w=u.memoizedState,y.parent!==g?(y={parent:g,cache:g},u.memoizedState=y,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=y),po(u,Mn,g)):(g=w.cache,po(u,Mn,g),g!==y.cache&&j1(u,[Mn],f,!0))),hr(l,u,u.pendingProps.children,f),u.child;case 29:throw u.pendingProps}throw Error(r(156,u.tag))}function Ra(l){l.flags|=4}function Em(l,u,f,g,y){if((u=(l.mode&32)!==0)&&(u=!1),u){if(l.flags|=16777216,(y&335544128)===y)if(l.stateNode.complete)l.flags|=8192;else if(xC())l.flags|=8192;else throw Ts=Ef,z1}else l.flags&=-16777217}function Gw(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!oE(u))if(xC())l.flags|=8192;else throw Ts=Ef,z1}function zf(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?Yt():536870912,l.lanes|=u,Hl|=u)}function mu(l,u){if(!gt)switch(l.tailMode){case"hidden":u=l.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:g.sibling=null}}function on(l){var u=l.alternate!==null&&l.alternate.child===l.child,f=0,g=0;if(u)for(var y=l.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags&65011712,g|=y.flags&65011712,y.return=l,y=y.sibling;else for(y=l.child;y!==null;)f|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=l,y=y.sibling;return l.subtreeFlags|=g,l.childLanes=f,u}function j8(l,u,f){var g=u.pendingProps;switch(I1(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(u),null;case 1:return on(u),null;case 3:return f=u.stateNode,g=null,l!==null&&(g=l.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),Oa(Mn),ae(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(l===null||l.child===null)&&(Tl(u)?Ra(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,M1())),on(u),null;case 26:var y=u.type,w=u.memoizedState;return l===null?(Ra(u),w!==null?(on(u),Gw(u,w)):(on(u),Em(u,y,null,g,f))):w?w!==l.memoizedState?(Ra(u),on(u),Gw(u,w)):(on(u),u.flags&=-16777217):(l=l.memoizedProps,l!==g&&Ra(u),on(u),Em(u,y,l,g,f)),null;case 27:if(Te(u),f=J.current,y=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==g&&Ra(u);else{if(!g){if(u.stateNode===null)throw Error(r(166));return on(u),null}l=re.current,Tl(u)?Sb(u):(l=JC(y,g,f),u.stateNode=l,Ra(u))}return on(u),null;case 5:if(Te(u),y=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==g&&Ra(u);else{if(!g){if(u.stateNode===null)throw Error(r(166));return on(u),null}if(w=re.current,Tl(u))Sb(u);else{var _=th(J.current);switch(w){case 1:w=_.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:w=_.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":w=_.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":w=_.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":w=_.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof g.is=="string"?_.createElement("select",{is:g.is}):_.createElement("select"),g.multiple?w.multiple=!0:g.size&&(w.size=g.size);break;default:w=typeof g.is=="string"?_.createElement(y,{is:g.is}):_.createElement(y)}}w[se]=u,w[me]=g;e:for(_=u.child;_!==null;){if(_.tag===5||_.tag===6)w.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===u)break e;for(;_.sibling===null;){if(_.return===null||_.return===u)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}u.stateNode=w;e:switch(pr(w,y,g),y){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Ra(u)}}return on(u),Em(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,f),null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==g&&Ra(u);else{if(typeof g!="string"&&u.stateNode===null)throw Error(r(166));if(l=J.current,Tl(u)){if(l=u.stateNode,f=u.memoizedProps,g=null,y=dr,y!==null)switch(y.tag){case 27:case 5:g=y.memoizedProps}l[se]=u,l=!!(l.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||UC(l.nodeValue,f)),l||ho(u,!0)}else l=th(l).createTextNode(g),l[se]=u,u.stateNode=l}return on(u),null;case 31:if(f=u.memoizedState,l===null||l.memoizedState!==null){if(g=Tl(u),f!==null){if(l===null){if(!g)throw Error(r(318));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(557));l[se]=u}else Ss(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;on(u),l=!1}else f=M1(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=f),l=!0;if(!l)return u.flags&256?(ui(u),u):(ui(u),null);if((u.flags&128)!==0)throw Error(r(558))}return on(u),null;case 13:if(g=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(y=Tl(u),g!==null&&g.dehydrated!==null){if(l===null){if(!y)throw Error(r(318));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[se]=u}else Ss(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;on(u),y=!1}else y=M1(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=y),y=!0;if(!y)return u.flags&256?(ui(u),u):(ui(u),null)}return ui(u),(u.flags&128)!==0?(u.lanes=f,u):(f=g!==null,l=l!==null&&l.memoizedState!==null,f&&(g=u.child,y=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(y=g.alternate.memoizedState.cachePool.pool),w=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(w=g.memoizedState.cachePool.pool),w!==y&&(g.flags|=2048)),f!==l&&f&&(u.child.flags|=8192),zf(u,u.updateQueue),on(u),null);case 4:return ae(),l===null&&Gm(u.stateNode.containerInfo),on(u),null;case 10:return Oa(u.type),on(u),null;case 19:if(V(_n),g=u.memoizedState,g===null)return on(u),null;if(y=(u.flags&128)!==0,w=g.rendering,w===null)if(y)mu(g,!1);else{if(bn!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(w=Nf(l),w!==null){for(u.flags|=128,mu(g,!1),l=w.updateQueue,u.updateQueue=l,zf(u,l),u.subtreeFlags=0,l=f,f=u.child;f!==null;)yb(f,l),f=f.sibling;return Z(_n,_n.current&1|2),gt&&ka(u,g.treeForkCount),u.child}l=l.sibling}g.tail!==null&&rn()>Gf&&(u.flags|=128,y=!0,mu(g,!1),u.lanes=4194304)}else{if(!y)if(l=Nf(w),l!==null){if(u.flags|=128,y=!0,l=l.updateQueue,u.updateQueue=l,zf(u,l),mu(g,!0),g.tail===null&&g.tailMode==="hidden"&&!w.alternate&&!gt)return on(u),null}else 2*rn()-g.renderingStartTime>Gf&&f!==536870912&&(u.flags|=128,y=!0,mu(g,!1),u.lanes=4194304);g.isBackwards?(w.sibling=u.child,u.child=w):(l=g.last,l!==null?l.sibling=w:u.child=w,g.last=w)}return g.tail!==null?(l=g.tail,g.rendering=l,g.tail=l.sibling,g.renderingStartTime=rn(),l.sibling=null,f=_n.current,Z(_n,y?f&1|2:f&1),gt&&ka(u,g.treeForkCount),l):(on(u),null);case 22:case 23:return ui(u),W1(),g=u.memoizedState!==null,l!==null?l.memoizedState!==null!==g&&(u.flags|=8192):g&&(u.flags|=8192),g?(f&536870912)!==0&&(u.flags&128)===0&&(on(u),u.subtreeFlags&6&&(u.flags|=8192)):on(u),f=u.updateQueue,f!==null&&zf(u,f.retryQueue),f=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==f&&(u.flags|=2048),l!==null&&V(Ns),null;case 24:return f=null,l!==null&&(f=l.memoizedState.cache),u.memoizedState.cache!==f&&(u.flags|=2048),Oa(Mn),on(u),null;case 25:return null;case 30:return null}throw Error(r(156,u.tag))}function P8(l,u){switch(I1(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Oa(Mn),ae(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return Te(u),null;case 31:if(u.memoizedState!==null){if(ui(u),u.alternate===null)throw Error(r(340));Ss()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(ui(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Ss()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return V(_n),null;case 4:return ae(),null;case 10:return Oa(u.type),null;case 22:case 23:return ui(u),W1(),l!==null&&V(Ns),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return Oa(Mn),null;case 25:return null;default:return null}}function Ww(l,u){switch(I1(u),u.tag){case 3:Oa(Mn),ae();break;case 26:case 27:case 5:Te(u);break;case 4:ae();break;case 31:u.memoizedState!==null&&ui(u);break;case 13:ui(u);break;case 19:V(_n);break;case 10:Oa(u.type);break;case 22:case 23:ui(u),W1(),l!==null&&V(Ns);break;case 24:Oa(Mn)}}function gu(l,u){try{var f=u.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var y=g.next;f=y;do{if((f.tag&l)===l){g=void 0;var w=f.create,_=f.inst;g=w(),_.destroy=g}f=f.next}while(f!==y)}}catch(T){Mt(u,u.return,T)}}function bo(l,u,f){try{var g=u.updateQueue,y=g!==null?g.lastEffect:null;if(y!==null){var w=y.next;g=w;do{if((g.tag&l)===l){var _=g.inst,T=_.destroy;if(T!==void 0){_.destroy=void 0,y=u;var F=f,ne=T;try{ne()}catch(pe){Mt(y,F,pe)}}}g=g.next}while(g!==w)}}catch(pe){Mt(u,u.return,pe)}}function qw(l){var u=l.updateQueue;if(u!==null){var f=l.stateNode;try{Pb(u,f)}catch(g){Mt(l,l.return,g)}}}function Xw(l,u,f){f.props=Ds(l.type,l.memoizedProps),f.state=l.memoizedState;try{f.componentWillUnmount()}catch(g){Mt(l,u,g)}}function xu(l,u){try{var f=l.ref;if(f!==null){switch(l.tag){case 26:case 27:case 5:var g=l.stateNode;break;case 30:g=l.stateNode;break;default:g=l.stateNode}typeof f=="function"?l.refCleanup=f(g):f.current=g}}catch(y){Mt(l,u,y)}}function ua(l,u){var f=l.ref,g=l.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(y){Mt(l,u,y)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(y){Mt(l,u,y)}else f.current=null}function Kw(l){var u=l.type,f=l.memoizedProps,g=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(y){Mt(l,l.return,y)}}function Sm(l,u,f){try{var g=l.stateNode;aO(g,l.type,f,u),g[me]=u}catch(y){Mt(l,l.return,y)}}function Yw(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&No(l.type)||l.tag===4}function Am(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Yw(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&No(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function _m(l,u,f){var g=l.tag;if(g===5||g===6)l=l.stateNode,u?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(l,u):(u=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,u.appendChild(l),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=Aa));else if(g!==4&&(g===27&&No(l.type)&&(f=l.stateNode,u=null),l=l.child,l!==null))for(_m(l,u,f),l=l.sibling;l!==null;)_m(l,u,f),l=l.sibling}function Uf(l,u,f){var g=l.tag;if(g===5||g===6)l=l.stateNode,u?f.insertBefore(l,u):f.appendChild(l);else if(g!==4&&(g===27&&No(l.type)&&(f=l.stateNode),l=l.child,l!==null))for(Uf(l,u,f),l=l.sibling;l!==null;)Uf(l,u,f),l=l.sibling}function Zw(l){var u=l.stateNode,f=l.memoizedProps;try{for(var g=l.type,y=u.attributes;y.length;)u.removeAttributeNode(y[0]);pr(u,g,f),u[se]=l,u[me]=f}catch(w){Mt(l,l.return,w)}}var La=!1,jn=!1,Nm=!1,Jw=typeof WeakSet=="function"?WeakSet:Set,Yn=null;function B8(l,u){if(l=l.containerInfo,Xm=lh,l=ub(l),b1(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var y=g.anchorOffset,w=g.focusNode;g=g.focusOffset;try{f.nodeType,w.nodeType}catch{f=null;break e}var _=0,T=-1,F=-1,ne=0,pe=0,ye=l,oe=null;t:for(;;){for(var ue;ye!==f||y!==0&&ye.nodeType!==3||(T=_+y),ye!==w||g!==0&&ye.nodeType!==3||(F=_+g),ye.nodeType===3&&(_+=ye.nodeValue.length),(ue=ye.firstChild)!==null;)oe=ye,ye=ue;for(;;){if(ye===l)break t;if(oe===f&&++ne===y&&(T=_),oe===w&&++pe===g&&(F=_),(ue=ye.nextSibling)!==null)break;ye=oe,oe=ye.parentNode}ye=ue}f=T===-1||F===-1?null:{start:T,end:F}}else f=null}f=f||{start:0,end:0}}else f=null;for(Km={focusedElem:l,selectionRange:f},lh=!1,Yn=u;Yn!==null;)if(u=Yn,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Yn=l;else for(;Yn!==null;){switch(u=Yn,w=u.alternate,l=u.flags,u.tag){case 0:if((l&4)!==0&&(l=u.updateQueue,l=l!==null?l.events:null,l!==null))for(f=0;f<l.length;f++)y=l[f],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&w!==null){l=void 0,f=u,y=w.memoizedProps,w=w.memoizedState,g=f.stateNode;try{var je=Ds(f.type,y);l=g.getSnapshotBeforeUpdate(je,w),g.__reactInternalSnapshotBeforeUpdate=l}catch(Xe){Mt(f,f.return,Xe)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,f=l.nodeType,f===9)Jm(l);else if(f===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Jm(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(r(163))}if(l=u.sibling,l!==null){l.return=u.return,Yn=l;break}Yn=u.return}}function Qw(l,u,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:Pa(l,f),g&4&&gu(5,f);break;case 1:if(Pa(l,f),g&4)if(l=f.stateNode,u===null)try{l.componentDidMount()}catch(_){Mt(f,f.return,_)}else{var y=Ds(f.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(y,u,l.__reactInternalSnapshotBeforeUpdate)}catch(_){Mt(f,f.return,_)}}g&64&&qw(f),g&512&&xu(f,f.return);break;case 3:if(Pa(l,f),g&64&&(l=f.updateQueue,l!==null)){if(u=null,f.child!==null)switch(f.child.tag){case 27:case 5:u=f.child.stateNode;break;case 1:u=f.child.stateNode}try{Pb(l,u)}catch(_){Mt(f,f.return,_)}}break;case 27:u===null&&g&4&&Zw(f);case 26:case 5:Pa(l,f),u===null&&g&4&&Kw(f),g&512&&xu(f,f.return);break;case 12:Pa(l,f);break;case 31:Pa(l,f),g&4&&nC(l,f);break;case 13:Pa(l,f),g&4&&rC(l,f),g&64&&(l=f.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(f=q8.bind(null,f),hO(l,f))));break;case 22:if(g=f.memoizedState!==null||La,!g){u=u!==null&&u.memoizedState!==null||jn,y=La;var w=jn;La=g,(jn=u)&&!w?Ba(l,f,(f.subtreeFlags&8772)!==0):Pa(l,f),La=y,jn=w}break;case 30:break;default:Pa(l,f)}}function eC(l){var u=l.alternate;u!==null&&(l.alternate=null,eC(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&bt(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var hn=null,Xr=!1;function ja(l,u,f){for(f=f.child;f!==null;)tC(l,u,f),f=f.sibling}function tC(l,u,f){if(xn&&typeof xn.onCommitFiberUnmount=="function")try{xn.onCommitFiberUnmount(Gr,f)}catch{}switch(f.tag){case 26:jn||ua(f,u),ja(l,u,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:jn||ua(f,u);var g=hn,y=Xr;No(f.type)&&(hn=f.stateNode,Xr=!1),ja(l,u,f),_u(f.stateNode),hn=g,Xr=y;break;case 5:jn||ua(f,u);case 6:if(g=hn,y=Xr,hn=null,ja(l,u,f),hn=g,Xr=y,hn!==null)if(Xr)try{(hn.nodeType===9?hn.body:hn.nodeName==="HTML"?hn.ownerDocument.body:hn).removeChild(f.stateNode)}catch(w){Mt(f,u,w)}else try{hn.removeChild(f.stateNode)}catch(w){Mt(f,u,w)}break;case 18:hn!==null&&(Xr?(l=hn,qC(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,f.stateNode),Yl(l)):qC(hn,f.stateNode));break;case 4:g=hn,y=Xr,hn=f.stateNode.containerInfo,Xr=!0,ja(l,u,f),hn=g,Xr=y;break;case 0:case 11:case 14:case 15:bo(2,f,u),jn||bo(4,f,u),ja(l,u,f);break;case 1:jn||(ua(f,u),g=f.stateNode,typeof g.componentWillUnmount=="function"&&Xw(f,u,g)),ja(l,u,f);break;case 21:ja(l,u,f);break;case 22:jn=(g=jn)||f.memoizedState!==null,ja(l,u,f),jn=g;break;default:ja(l,u,f)}}function nC(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Yl(l)}catch(f){Mt(u,u.return,f)}}}function rC(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{Yl(l)}catch(f){Mt(u,u.return,f)}}function F8(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new Jw),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new Jw),u;default:throw Error(r(435,l.tag))}}function Hf(l,u){var f=F8(l);u.forEach(function(g){if(!f.has(g)){f.add(g);var y=X8.bind(null,l,g);g.then(y,y)}})}function Kr(l,u){var f=u.deletions;if(f!==null)for(var g=0;g<f.length;g++){var y=f[g],w=l,_=u,T=_;e:for(;T!==null;){switch(T.tag){case 27:if(No(T.type)){hn=T.stateNode,Xr=!1;break e}break;case 5:hn=T.stateNode,Xr=!1;break e;case 3:case 4:hn=T.stateNode.containerInfo,Xr=!0;break e}T=T.return}if(hn===null)throw Error(r(160));tC(w,_,y),hn=null,Xr=!1,w=y.alternate,w!==null&&(w.return=null),y.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)iC(u,l),u=u.sibling}var Vi=null;function iC(l,u){var f=l.alternate,g=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Kr(u,l),Yr(l),g&4&&(bo(3,l,l.return),gu(3,l),bo(5,l,l.return));break;case 1:Kr(u,l),Yr(l),g&512&&(jn||f===null||ua(f,f.return)),g&64&&La&&(l=l.updateQueue,l!==null&&(g=l.callbacks,g!==null&&(f=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var y=Vi;if(Kr(u,l),Yr(l),g&512&&(jn||f===null||ua(f,f.return)),g&4){var w=f!==null?f.memoizedState:null;if(g=l.memoizedState,f===null)if(g===null)if(l.stateNode===null){e:{g=l.type,f=l.memoizedProps,y=y.ownerDocument||y;t:switch(g){case"title":w=y.getElementsByTagName("title")[0],(!w||w[Zt]||w[se]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=y.createElement(g),y.head.insertBefore(w,y.querySelector("head > title"))),pr(w,g,f),w[se]=l,Dn(w),g=w;break e;case"link":var _=iE("link","href",y).get(g+(f.href||""));if(_){for(var T=0;T<_.length;T++)if(w=_[T],w.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&w.getAttribute("rel")===(f.rel==null?null:f.rel)&&w.getAttribute("title")===(f.title==null?null:f.title)&&w.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){_.splice(T,1);break t}}w=y.createElement(g),pr(w,g,f),y.head.appendChild(w);break;case"meta":if(_=iE("meta","content",y).get(g+(f.content||""))){for(T=0;T<_.length;T++)if(w=_[T],w.getAttribute("content")===(f.content==null?null:""+f.content)&&w.getAttribute("name")===(f.name==null?null:f.name)&&w.getAttribute("property")===(f.property==null?null:f.property)&&w.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&w.getAttribute("charset")===(f.charSet==null?null:f.charSet)){_.splice(T,1);break t}}w=y.createElement(g),pr(w,g,f),y.head.appendChild(w);break;default:throw Error(r(468,g))}w[se]=l,Dn(w),g=w}l.stateNode=g}else aE(y,l.type,l.stateNode);else l.stateNode=rE(y,g,l.memoizedProps);else w!==g?(w===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):w.count--,g===null?aE(y,l.type,l.stateNode):rE(y,g,l.memoizedProps)):g===null&&l.stateNode!==null&&Sm(l,l.memoizedProps,f.memoizedProps)}break;case 27:Kr(u,l),Yr(l),g&512&&(jn||f===null||ua(f,f.return)),f!==null&&g&4&&Sm(l,l.memoizedProps,f.memoizedProps);break;case 5:if(Kr(u,l),Yr(l),g&512&&(jn||f===null||ua(f,f.return)),l.flags&32){y=l.stateNode;try{yl(y,"")}catch(je){Mt(l,l.return,je)}}g&4&&l.stateNode!=null&&(y=l.memoizedProps,Sm(l,y,f!==null?f.memoizedProps:y)),g&1024&&(Nm=!0);break;case 6:if(Kr(u,l),Yr(l),g&4){if(l.stateNode===null)throw Error(r(162));g=l.memoizedProps,f=l.stateNode;try{f.nodeValue=g}catch(je){Mt(l,l.return,je)}}break;case 3:if(ih=null,y=Vi,Vi=nh(u.containerInfo),Kr(u,l),Vi=y,Yr(l),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Yl(u.containerInfo)}catch(je){Mt(l,l.return,je)}Nm&&(Nm=!1,aC(l));break;case 4:g=Vi,Vi=nh(l.stateNode.containerInfo),Kr(u,l),Yr(l),Vi=g;break;case 12:Kr(u,l),Yr(l);break;case 31:Kr(u,l),Yr(l),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Hf(l,g)));break;case 13:Kr(u,l),Yr(l),l.child.flags&8192&&l.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&($f=rn()),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Hf(l,g)));break;case 22:y=l.memoizedState!==null;var F=f!==null&&f.memoizedState!==null,ne=La,pe=jn;if(La=ne||y,jn=pe||F,Kr(u,l),jn=pe,La=ne,Yr(l),g&8192)e:for(u=l.stateNode,u._visibility=y?u._visibility&-2:u._visibility|1,y&&(f===null||F||La||jn||Ms(l)),f=null,u=l;;){if(u.tag===5||u.tag===26){if(f===null){F=f=u;try{if(w=F.stateNode,y)_=w.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{T=F.stateNode;var ye=F.memoizedProps.style,oe=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;T.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(je){Mt(F,F.return,je)}}}else if(u.tag===6){if(f===null){F=u;try{F.stateNode.nodeValue=y?"":F.memoizedProps}catch(je){Mt(F,F.return,je)}}}else if(u.tag===18){if(f===null){F=u;try{var ue=F.stateNode;y?XC(ue,!0):XC(F.stateNode,!1)}catch(je){Mt(F,F.return,je)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;f===u&&(f=null),u=u.return}f===u&&(f=null),u.sibling.return=u.return,u=u.sibling}g&4&&(g=l.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Hf(l,f))));break;case 19:Kr(u,l),Yr(l),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Hf(l,g)));break;case 30:break;case 21:break;default:Kr(u,l),Yr(l)}}function Yr(l){var u=l.flags;if(u&2){try{for(var f,g=l.return;g!==null;){if(Yw(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var y=f.stateNode,w=Am(l);Uf(l,w,y);break;case 5:var _=f.stateNode;f.flags&32&&(yl(_,""),f.flags&=-33);var T=Am(l);Uf(l,T,_);break;case 3:case 4:var F=f.stateNode.containerInfo,ne=Am(l);_m(l,ne,F);break;default:throw Error(r(161))}}catch(pe){Mt(l,l.return,pe)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function aC(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;aC(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function Pa(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Qw(l,u.alternate,u),u=u.sibling}function Ms(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:bo(4,u,u.return),Ms(u);break;case 1:ua(u,u.return);var f=u.stateNode;typeof f.componentWillUnmount=="function"&&Xw(u,u.return,f),Ms(u);break;case 27:_u(u.stateNode);case 26:case 5:ua(u,u.return),Ms(u);break;case 22:u.memoizedState===null&&Ms(u);break;case 30:Ms(u);break;default:Ms(u)}l=l.sibling}}function Ba(l,u,f){for(f=f&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var g=u.alternate,y=l,w=u,_=w.flags;switch(w.tag){case 0:case 11:case 15:Ba(y,w,f),gu(4,w);break;case 1:if(Ba(y,w,f),g=w,y=g.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ne){Mt(g,g.return,ne)}if(g=w,y=g.updateQueue,y!==null){var T=g.stateNode;try{var F=y.shared.hiddenCallbacks;if(F!==null)for(y.shared.hiddenCallbacks=null,y=0;y<F.length;y++)jb(F[y],T)}catch(ne){Mt(g,g.return,ne)}}f&&_&64&&qw(w),xu(w,w.return);break;case 27:Zw(w);case 26:case 5:Ba(y,w,f),f&&g===null&&_&4&&Kw(w),xu(w,w.return);break;case 12:Ba(y,w,f);break;case 31:Ba(y,w,f),f&&_&4&&nC(y,w);break;case 13:Ba(y,w,f),f&&_&4&&rC(y,w);break;case 22:w.memoizedState===null&&Ba(y,w,f),xu(w,w.return);break;case 30:break;default:Ba(y,w,f)}u=u.sibling}}function km(l,u){var f=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==f&&(l!=null&&l.refCount++,f!=null&&ru(f))}function Tm(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&ru(l))}function $i(l,u,f,g){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)oC(l,u,f,g),u=u.sibling}function oC(l,u,f,g){var y=u.flags;switch(u.tag){case 0:case 11:case 15:$i(l,u,f,g),y&2048&&gu(9,u);break;case 1:$i(l,u,f,g);break;case 3:$i(l,u,f,g),y&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&ru(l)));break;case 12:if(y&2048){$i(l,u,f,g),l=u.stateNode;try{var w=u.memoizedProps,_=w.id,T=w.onPostCommit;typeof T=="function"&&T(_,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(F){Mt(u,u.return,F)}}else $i(l,u,f,g);break;case 31:$i(l,u,f,g);break;case 13:$i(l,u,f,g);break;case 23:break;case 22:w=u.stateNode,_=u.alternate,u.memoizedState!==null?w._visibility&2?$i(l,u,f,g):vu(l,u):w._visibility&2?$i(l,u,f,g):(w._visibility|=2,Fl(l,u,f,g,(u.subtreeFlags&10256)!==0||!1)),y&2048&&km(_,u);break;case 24:$i(l,u,f,g),y&2048&&Tm(u.alternate,u);break;default:$i(l,u,f,g)}}function Fl(l,u,f,g,y){for(y=y&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var w=l,_=u,T=f,F=g,ne=_.flags;switch(_.tag){case 0:case 11:case 15:Fl(w,_,T,F,y),gu(8,_);break;case 23:break;case 22:var pe=_.stateNode;_.memoizedState!==null?pe._visibility&2?Fl(w,_,T,F,y):vu(w,_):(pe._visibility|=2,Fl(w,_,T,F,y)),y&&ne&2048&&km(_.alternate,_);break;case 24:Fl(w,_,T,F,y),y&&ne&2048&&Tm(_.alternate,_);break;default:Fl(w,_,T,F,y)}u=u.sibling}}function vu(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var f=l,g=u,y=g.flags;switch(g.tag){case 22:vu(f,g),y&2048&&km(g.alternate,g);break;case 24:vu(f,g),y&2048&&Tm(g.alternate,g);break;default:vu(f,g)}u=u.sibling}}var yu=8192;function zl(l,u,f){if(l.subtreeFlags&yu)for(l=l.child;l!==null;)sC(l,u,f),l=l.sibling}function sC(l,u,f){switch(l.tag){case 26:zl(l,u,f),l.flags&yu&&l.memoizedState!==null&&AO(f,Vi,l.memoizedState,l.memoizedProps);break;case 5:zl(l,u,f);break;case 3:case 4:var g=Vi;Vi=nh(l.stateNode.containerInfo),zl(l,u,f),Vi=g;break;case 22:l.memoizedState===null&&(g=l.alternate,g!==null&&g.memoizedState!==null?(g=yu,yu=16777216,zl(l,u,f),yu=g):zl(l,u,f));break;default:zl(l,u,f)}}function lC(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function bu(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var f=0;f<u.length;f++){var g=u[f];Yn=g,uC(g,l)}lC(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)cC(l),l=l.sibling}function cC(l){switch(l.tag){case 0:case 11:case 15:bu(l),l.flags&2048&&bo(9,l,l.return);break;case 3:bu(l);break;case 12:bu(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,Vf(l)):bu(l);break;default:bu(l)}}function Vf(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var f=0;f<u.length;f++){var g=u[f];Yn=g,uC(g,l)}lC(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:bo(8,u,u.return),Vf(u);break;case 22:f=u.stateNode,f._visibility&2&&(f._visibility&=-3,Vf(u));break;default:Vf(u)}l=l.sibling}}function uC(l,u){for(;Yn!==null;){var f=Yn;switch(f.tag){case 0:case 11:case 15:bo(8,f,u);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:ru(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,Yn=g;else e:for(f=l;Yn!==null;){g=Yn;var y=g.sibling,w=g.return;if(eC(g),g===f){Yn=null;break e}if(y!==null){y.return=w,Yn=y;break e}Yn=w}}}var z8={getCacheForType:function(l){var u=fr(Mn),f=u.data.get(l);return f===void 0&&(f=l(),u.data.set(l,f)),f},cacheSignal:function(){return fr(Mn).controller.signal}},U8=typeof WeakMap=="function"?WeakMap:Map,_t=0,Gt=null,dt=null,pt=0,Dt=0,di=null,wo=!1,Ul=!1,Om=!1,Fa=0,bn=0,Co=0,Rs=0,Im=0,fi=0,Hl=0,wu=null,Zr=null,Dm=!1,$f=0,dC=0,Gf=1/0,Wf=null,Eo=null,Fn=0,So=null,Vl=null,za=0,Mm=0,Rm=null,fC=null,Cu=0,Lm=null;function hi(){return(_t&2)!==0&&pt!==0?pt&-pt:H.T!==null?Um():X()}function hC(){if(fi===0)if((pt&536870912)===0||gt){var l=vi;vi<<=1,(vi&3932160)===0&&(vi=262144),fi=l}else fi=536870912;return l=ci.current,l!==null&&(l.flags|=32),fi}function Jr(l,u,f){(l===Gt&&(Dt===2||Dt===9)||l.cancelPendingCommit!==null)&&($l(l,0),Ao(l,pt,fi,!1)),ur(l,f),((_t&2)===0||l!==Gt)&&(l===Gt&&((_t&2)===0&&(Rs|=f),bn===4&&Ao(l,pt,fi,!1)),da(l))}function pC(l,u,f){if((_t&6)!==0)throw Error(r(327));var g=!f&&(u&127)===0&&(u&l.expiredLanes)===0||Vt(l,u),y=g?$8(l,u):Pm(l,u,!0),w=g;do{if(y===0){Ul&&!g&&Ao(l,u,0,!1);break}else{if(f=l.current.alternate,w&&!H8(f)){y=Pm(l,u,!1),w=!1;continue}if(y===2){if(w=u,l.errorRecoveryDisabledLanes&w)var _=0;else _=l.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){u=_;e:{var T=l;y=wu;var F=T.current.memoizedState.isDehydrated;if(F&&($l(T,_).flags|=256),_=Pm(T,_,!1),_!==2){if(Om&&!F){T.errorRecoveryDisabledLanes|=w,Rs|=w,y=4;break e}w=Zr,Zr=y,w!==null&&(Zr===null?Zr=w:Zr.push.apply(Zr,w))}y=_}if(w=!1,y!==2)continue}}if(y===1){$l(l,0),Ao(l,u,0,!0);break}e:{switch(g=l,w=y,w){case 0:case 1:throw Error(r(345));case 4:if((u&4194048)!==u)break;case 6:Ao(g,u,fi,!wo);break e;case 2:Zr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((u&62914560)===u&&(y=$f+300-rn(),10<y)){if(Ao(g,u,fi,!wo),Kt(g,0,!0)!==0)break e;za=u,g.timeoutHandle=GC(mC.bind(null,g,f,Zr,Wf,Dm,u,fi,Rs,Hl,wo,w,"Throttled",-0,0),y);break e}mC(g,f,Zr,Wf,Dm,u,fi,Rs,Hl,wo,w,null,-0,0)}}break}while(!0);da(l)}function mC(l,u,f,g,y,w,_,T,F,ne,pe,ye,oe,ue){if(l.timeoutHandle=-1,ye=u.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Aa},sC(u,w,ye);var je=(w&62914560)===w?$f-rn():(w&4194048)===w?dC-rn():0;if(je=_O(ye,je),je!==null){za=w,l.cancelPendingCommit=je(EC.bind(null,l,u,w,f,g,y,_,T,F,pe,ye,null,oe,ue)),Ao(l,w,_,!ne);return}}EC(l,u,w,f,g,y,_,T,F)}function H8(l){for(var u=l;;){var f=u.tag;if((f===0||f===11||f===15)&&u.flags&16384&&(f=u.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var y=f[g],w=y.getSnapshot;y=y.value;try{if(!si(w(),y))return!1}catch{return!1}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ao(l,u,f,g){u&=~Im,u&=~Rs,l.suspendedLanes|=u,l.pingedLanes&=~u,g&&(l.warmLanes|=u),g=l.expirationTimes;for(var y=u;0<y;){var w=31-Tn(y),_=1<<w;g[w]=-1,y&=~_}f!==0&&Rr(l,f,u)}function qf(){return(_t&6)===0?(Eu(0),!1):!0}function jm(){if(dt!==null){if(Dt===0)var l=dt.return;else l=dt,Ta=As=null,J1(l),Rl=null,au=0,l=dt;for(;l!==null;)Ww(l.alternate,l),l=l.return;dt=null}}function $l(l,u){var f=l.timeoutHandle;f!==-1&&(l.timeoutHandle=-1,lO(f)),f=l.cancelPendingCommit,f!==null&&(l.cancelPendingCommit=null,f()),za=0,jm(),Gt=l,dt=f=Na(l.current,null),pt=u,Dt=0,di=null,wo=!1,Ul=Vt(l,u),Om=!1,Hl=fi=Im=Rs=Co=bn=0,Zr=wu=null,Dm=!1,(u&8)!==0&&(u|=u&32);var g=l.entangledLanes;if(g!==0)for(l=l.entanglements,g&=u;0<g;){var y=31-Tn(g),w=1<<y;u|=l[y],g&=~w}return Fa=u,pf(),f}function gC(l,u){nt=null,H.H=hu,u===Ml||u===Cf?(u=Db(),Dt=3):u===z1?(u=Db(),Dt=4):Dt=u===pm?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,di=u,dt===null&&(bn=1,jf(l,wi(u,l.current)))}function xC(){var l=ci.current;return l===null?!0:(pt&4194048)===pt?Ai===null:(pt&62914560)===pt||(pt&536870912)!==0?l===Ai:!1}function vC(){var l=H.H;return H.H=hu,l===null?hu:l}function yC(){var l=H.A;return H.A=z8,l}function Xf(){bn=4,wo||(pt&4194048)!==pt&&ci.current!==null||(Ul=!0),(Co&134217727)===0&&(Rs&134217727)===0||Gt===null||Ao(Gt,pt,fi,!1)}function Pm(l,u,f){var g=_t;_t|=2;var y=vC(),w=yC();(Gt!==l||pt!==u)&&(Wf=null,$l(l,u)),u=!1;var _=bn;e:do try{if(Dt!==0&&dt!==null){var T=dt,F=di;switch(Dt){case 8:jm(),_=6;break e;case 3:case 2:case 9:case 6:ci.current===null&&(u=!0);var ne=Dt;if(Dt=0,di=null,Gl(l,T,F,ne),f&&Ul){_=0;break e}break;default:ne=Dt,Dt=0,di=null,Gl(l,T,F,ne)}}V8(),_=bn;break}catch(pe){gC(l,pe)}while(!0);return u&&l.shellSuspendCounter++,Ta=As=null,_t=g,H.H=y,H.A=w,dt===null&&(Gt=null,pt=0,pf()),_}function V8(){for(;dt!==null;)bC(dt)}function $8(l,u){var f=_t;_t|=2;var g=vC(),y=yC();Gt!==l||pt!==u?(Wf=null,Gf=rn()+500,$l(l,u)):Ul=Vt(l,u);e:do try{if(Dt!==0&&dt!==null){u=dt;var w=di;t:switch(Dt){case 1:Dt=0,di=null,Gl(l,u,w,1);break;case 2:case 9:if(Ob(w)){Dt=0,di=null,wC(u);break}u=function(){Dt!==2&&Dt!==9||Gt!==l||(Dt=7),da(l)},w.then(u,u);break e;case 3:Dt=7;break e;case 4:Dt=5;break e;case 7:Ob(w)?(Dt=0,di=null,wC(u)):(Dt=0,di=null,Gl(l,u,w,7));break;case 5:var _=null;switch(dt.tag){case 26:_=dt.memoizedState;case 5:case 27:var T=dt;if(_?oE(_):T.stateNode.complete){Dt=0,di=null;var F=T.sibling;if(F!==null)dt=F;else{var ne=T.return;ne!==null?(dt=ne,Kf(ne)):dt=null}break t}}Dt=0,di=null,Gl(l,u,w,5);break;case 6:Dt=0,di=null,Gl(l,u,w,6);break;case 8:jm(),bn=6;break e;default:throw Error(r(462))}}G8();break}catch(pe){gC(l,pe)}while(!0);return Ta=As=null,H.H=g,H.A=y,_t=f,dt!==null?0:(Gt=null,pt=0,pf(),bn)}function G8(){for(;dt!==null&&!An();)bC(dt)}function bC(l){var u=$w(l.alternate,l,Fa);l.memoizedProps=l.pendingProps,u===null?Kf(l):dt=u}function wC(l){var u=l,f=u.alternate;switch(u.tag){case 15:case 0:u=Bw(f,u,u.pendingProps,u.type,void 0,pt);break;case 11:u=Bw(f,u,u.pendingProps,u.type.render,u.ref,pt);break;case 5:J1(u);default:Ww(f,u),u=dt=yb(u,Fa),u=$w(f,u,Fa)}l.memoizedProps=l.pendingProps,u===null?Kf(l):dt=u}function Gl(l,u,f,g){Ta=As=null,J1(u),Rl=null,au=0;var y=u.return;try{if(M8(l,y,u,f,pt)){bn=1,jf(l,wi(f,l.current)),dt=null;return}}catch(w){if(y!==null)throw dt=y,w;bn=1,jf(l,wi(f,l.current)),dt=null;return}u.flags&32768?(gt||g===1?l=!0:Ul||(pt&536870912)!==0?l=!1:(wo=l=!0,(g===2||g===9||g===3||g===6)&&(g=ci.current,g!==null&&g.tag===13&&(g.flags|=16384))),CC(u,l)):Kf(u)}function Kf(l){var u=l;do{if((u.flags&32768)!==0){CC(u,wo);return}l=u.return;var f=j8(u.alternate,u,Fa);if(f!==null){dt=f;return}if(u=u.sibling,u!==null){dt=u;return}dt=u=l}while(u!==null);bn===0&&(bn=5)}function CC(l,u){do{var f=P8(l.alternate,l);if(f!==null){f.flags&=32767,dt=f;return}if(f=l.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!u&&(l=l.sibling,l!==null)){dt=l;return}dt=l=f}while(l!==null);bn=6,dt=null}function EC(l,u,f,g,y,w,_,T,F){l.cancelPendingCommit=null;do Yf();while(Fn!==0);if((_t&6)!==0)throw Error(r(327));if(u!==null){if(u===l.current)throw Error(r(177));if(w=u.lanes|u.childLanes,w|=A1,vn(l,f,w,_,T,F),l===Gt&&(dt=Gt=null,pt=0),Vl=u,So=l,za=f,Mm=w,Rm=y,fC=g,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,K8(St,function(){return kC(),null})):(l.callbackNode=null,l.callbackPriority=0),g=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||g){g=H.T,H.T=null,y=ie.p,ie.p=2,_=_t,_t|=4;try{B8(l,u,f)}finally{_t=_,ie.p=y,H.T=g}}Fn=1,SC(),AC(),_C()}}function SC(){if(Fn===1){Fn=0;var l=So,u=Vl,f=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var g=ie.p;ie.p=2;var y=_t;_t|=4;try{iC(u,l);var w=Km,_=ub(l.containerInfo),T=w.focusedElem,F=w.selectionRange;if(_!==T&&T&&T.ownerDocument&&cb(T.ownerDocument.documentElement,T)){if(F!==null&&b1(T)){var ne=F.start,pe=F.end;if(pe===void 0&&(pe=ne),"selectionStart"in T)T.selectionStart=ne,T.selectionEnd=Math.min(pe,T.value.length);else{var ye=T.ownerDocument||document,oe=ye&&ye.defaultView||window;if(oe.getSelection){var ue=oe.getSelection(),je=T.textContent.length,Xe=Math.min(F.start,je),Bt=F.end===void 0?Xe:Math.min(F.end,je);!ue.extend&&Xe>Bt&&(_=Bt,Bt=Xe,Xe=_);var Y=lb(T,Xe),W=lb(T,Bt);if(Y&&W&&(ue.rangeCount!==1||ue.anchorNode!==Y.node||ue.anchorOffset!==Y.offset||ue.focusNode!==W.node||ue.focusOffset!==W.offset)){var te=ye.createRange();te.setStart(Y.node,Y.offset),ue.removeAllRanges(),Xe>Bt?(ue.addRange(te),ue.extend(W.node,W.offset)):(te.setEnd(W.node,W.offset),ue.addRange(te))}}}}for(ye=[],ue=T;ue=ue.parentNode;)ue.nodeType===1&&ye.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ye.length;T++){var ve=ye[T];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}lh=!!Xm,Km=Xm=null}finally{_t=y,ie.p=g,H.T=f}}l.current=u,Fn=2}}function AC(){if(Fn===2){Fn=0;var l=So,u=Vl,f=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var g=ie.p;ie.p=2;var y=_t;_t|=4;try{Qw(l,u.alternate,u)}finally{_t=y,ie.p=g,H.T=f}}Fn=3}}function _C(){if(Fn===4||Fn===3){Fn=0,Mr();var l=So,u=Vl,f=za,g=fC;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Fn=5:(Fn=0,Vl=So=null,NC(l,l.pendingLanes));var y=l.pendingLanes;if(y===0&&(Eo=null),$(f),u=u.stateNode,xn&&typeof xn.onCommitFiberRoot=="function")try{xn.onCommitFiberRoot(Gr,u,void 0,(u.current.flags&128)===128)}catch{}if(g!==null){u=H.T,y=ie.p,ie.p=2,H.T=null;try{for(var w=l.onRecoverableError,_=0;_<g.length;_++){var T=g[_];w(T.value,{componentStack:T.stack})}}finally{H.T=u,ie.p=y}}(za&3)!==0&&Yf(),da(l),y=l.pendingLanes,(f&261930)!==0&&(y&42)!==0?l===Lm?Cu++:(Cu=0,Lm=l):Cu=0,Eu(0)}}function NC(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,ru(u)))}function Yf(){return SC(),AC(),_C(),kC()}function kC(){if(Fn!==5)return!1;var l=So,u=Mm;Mm=0;var f=$(za),g=H.T,y=ie.p;try{ie.p=32>f?32:f,H.T=null,f=Rm,Rm=null;var w=So,_=za;if(Fn=0,Vl=So=null,za=0,(_t&6)!==0)throw Error(r(331));var T=_t;if(_t|=4,cC(w.current),oC(w,w.current,_,f),_t=T,Eu(0,!1),xn&&typeof xn.onPostCommitFiberRoot=="function")try{xn.onPostCommitFiberRoot(Gr,w)}catch{}return!0}finally{ie.p=y,H.T=g,NC(l,u)}}function TC(l,u,f){u=wi(f,u),u=hm(l.stateNode,u,2),l=xo(l,u,2),l!==null&&(ur(l,2),da(l))}function Mt(l,u,f){if(l.tag===3)TC(l,l,f);else for(;u!==null;){if(u.tag===3){TC(u,l,f);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Eo===null||!Eo.has(g))){l=wi(f,l),f=Ow(2),g=xo(u,f,2),g!==null&&(Iw(f,g,u,l),ur(g,2),da(g));break}}u=u.return}}function Bm(l,u,f){var g=l.pingCache;if(g===null){g=l.pingCache=new U8;var y=new Set;g.set(u,y)}else y=g.get(u),y===void 0&&(y=new Set,g.set(u,y));y.has(f)||(Om=!0,y.add(f),l=W8.bind(null,l,u,f),u.then(l,l))}function W8(l,u,f){var g=l.pingCache;g!==null&&g.delete(u),l.pingedLanes|=l.suspendedLanes&f,l.warmLanes&=~f,Gt===l&&(pt&f)===f&&(bn===4||bn===3&&(pt&62914560)===pt&&300>rn()-$f?(_t&2)===0&&$l(l,0):Im|=f,Hl===pt&&(Hl=0)),da(l)}function OC(l,u){u===0&&(u=Yt()),l=Cs(l,u),l!==null&&(ur(l,u),da(l))}function q8(l){var u=l.memoizedState,f=0;u!==null&&(f=u.retryLane),OC(l,f)}function X8(l,u){var f=0;switch(l.tag){case 31:case 13:var g=l.stateNode,y=l.memoizedState;y!==null&&(f=y.retryLane);break;case 19:g=l.stateNode;break;case 22:g=l.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(u),OC(l,f)}function K8(l,u){return Se(l,u)}var Zf=null,Wl=null,Fm=!1,Jf=!1,zm=!1,_o=0;function da(l){l!==Wl&&l.next===null&&(Wl===null?Zf=Wl=l:Wl=Wl.next=l),Jf=!0,Fm||(Fm=!0,Z8())}function Eu(l,u){if(!zm&&Jf){zm=!0;do for(var f=!1,g=Zf;g!==null;){if(l!==0){var y=g.pendingLanes;if(y===0)var w=0;else{var _=g.suspendedLanes,T=g.pingedLanes;w=(1<<31-Tn(42|l)+1)-1,w&=y&~(_&~T),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(f=!0,RC(g,w))}else w=pt,w=Kt(g,g===Gt?w:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(w&3)===0||Vt(g,w)||(f=!0,RC(g,w));g=g.next}while(f);zm=!1}}function Y8(){IC()}function IC(){Jf=Fm=!1;var l=0;_o!==0&&sO()&&(l=_o);for(var u=rn(),f=null,g=Zf;g!==null;){var y=g.next,w=DC(g,u);w===0?(g.next=null,f===null?Zf=y:f.next=y,y===null&&(Wl=f)):(f=g,(l!==0||(w&3)!==0)&&(Jf=!0)),g=y}Fn!==0&&Fn!==5||Eu(l),_o!==0&&(_o=0)}function DC(l,u){for(var f=l.suspendedLanes,g=l.pingedLanes,y=l.expirationTimes,w=l.pendingLanes&-62914561;0<w;){var _=31-Tn(w),T=1<<_,F=y[_];F===-1?((T&f)===0||(T&g)!==0)&&(y[_]=vt(T,u)):F<=u&&(l.expiredLanes|=T),w&=~T}if(u=Gt,f=pt,f=Kt(l,l===u?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),g=l.callbackNode,f===0||l===u&&(Dt===2||Dt===9)||l.cancelPendingCommit!==null)return g!==null&&g!==null&&fn(g),l.callbackNode=null,l.callbackPriority=0;if((f&3)===0||Vt(l,f)){if(u=f&-f,u===l.callbackPriority)return u;switch(g!==null&&fn(g),$(f)){case 2:case 8:f=sr;break;case 32:f=St;break;case 268435456:f=zi;break;default:f=St}return g=MC.bind(null,l),f=Se(f,g),l.callbackPriority=u,l.callbackNode=f,u}return g!==null&&g!==null&&fn(g),l.callbackPriority=2,l.callbackNode=null,2}function MC(l,u){if(Fn!==0&&Fn!==5)return l.callbackNode=null,l.callbackPriority=0,null;var f=l.callbackNode;if(Yf()&&l.callbackNode!==f)return null;var g=pt;return g=Kt(l,l===Gt?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),g===0?null:(pC(l,g,u),DC(l,rn()),l.callbackNode!=null&&l.callbackNode===f?MC.bind(null,l):null)}function RC(l,u){if(Yf())return null;pC(l,u,!0)}function Z8(){cO(function(){(_t&6)!==0?Se(or,Y8):IC()})}function Um(){if(_o===0){var l=Il;l===0&&(l=Wr,Wr<<=1,(Wr&261888)===0&&(Wr=256)),_o=l}return _o}function LC(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:of(""+l)}function jC(l,u){var f=u.ownerDocument.createElement("input");return f.name=u.name,f.value=u.value,l.id&&f.setAttribute("form",l.id),u.parentNode.insertBefore(f,u),l=new FormData(l),f.parentNode.removeChild(f),l}function J8(l,u,f,g,y){if(u==="submit"&&f&&f.stateNode===y){var w=LC((y[me]||null).action),_=g.submitter;_&&(u=(u=_[me]||null)?LC(u.formAction):_.getAttribute("formAction"),u!==null&&(w=u,_=null));var T=new uf("action","action",null,g,y);l.push({event:T,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(_o!==0){var F=_?jC(y,_):new FormData(y);sm(f,{pending:!0,data:F,method:y.method,action:w},null,F)}}else typeof w=="function"&&(T.preventDefault(),F=_?jC(y,_):new FormData(y),sm(f,{pending:!0,data:F,method:y.method,action:w},w,F))},currentTarget:y}]})}}for(var Hm=0;Hm<S1.length;Hm++){var Vm=S1[Hm],Q8=Vm.toLowerCase(),eO=Vm[0].toUpperCase()+Vm.slice(1);Hi(Q8,"on"+eO)}Hi(hb,"onAnimationEnd"),Hi(pb,"onAnimationIteration"),Hi(mb,"onAnimationStart"),Hi("dblclick","onDoubleClick"),Hi("focusin","onFocus"),Hi("focusout","onBlur"),Hi(g8,"onTransitionRun"),Hi(x8,"onTransitionStart"),Hi(v8,"onTransitionCancel"),Hi(gb,"onTransitionEnd"),Sa("onMouseEnter",["mouseout","mouseover"]),Sa("onMouseLeave",["mouseout","mouseover"]),Sa("onPointerEnter",["pointerout","pointerover"]),Sa("onPointerLeave",["pointerout","pointerover"]),yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Su));function PC(l,u){u=(u&4)!==0;for(var f=0;f<l.length;f++){var g=l[f],y=g.event;g=g.listeners;e:{var w=void 0;if(u)for(var _=g.length-1;0<=_;_--){var T=g[_],F=T.instance,ne=T.currentTarget;if(T=T.listener,F!==w&&y.isPropagationStopped())break e;w=T,y.currentTarget=ne;try{w(y)}catch(pe){hf(pe)}y.currentTarget=null,w=F}else for(_=0;_<g.length;_++){if(T=g[_],F=T.instance,ne=T.currentTarget,T=T.listener,F!==w&&y.isPropagationStopped())break e;w=T,y.currentTarget=ne;try{w(y)}catch(pe){hf(pe)}y.currentTarget=null,w=F}}}}function ft(l,u){var f=u[Ye];f===void 0&&(f=u[Ye]=new Set);var g=l+"__bubble";f.has(g)||(BC(u,l,2,!1),f.add(g))}function $m(l,u,f){var g=0;u&&(g|=4),BC(f,l,g,u)}var Qf="_reactListening"+Math.random().toString(36).slice(2);function Gm(l){if(!l[Qf]){l[Qf]=!0,jr.forEach(function(f){f!=="selectionchange"&&(tO.has(f)||$m(f,!1,l),$m(f,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Qf]||(u[Qf]=!0,$m("selectionchange",!1,u))}}function BC(l,u,f,g){switch(hE(u)){case 2:var y=TO;break;case 8:y=OO;break;default:y=og}f=y.bind(null,u,f,l),y=void 0,!d1||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(y=!0),g?y!==void 0?l.addEventListener(u,f,{capture:!0,passive:y}):l.addEventListener(u,f,!0):y!==void 0?l.addEventListener(u,f,{passive:y}):l.addEventListener(u,f,!1)}function Wm(l,u,f,g,y){var w=g;if((u&1)===0&&(u&2)===0&&g!==null)e:for(;;){if(g===null)return;var _=g.tag;if(_===3||_===4){var T=g.stateNode.containerInfo;if(T===y)break;if(_===4)for(_=g.return;_!==null;){var F=_.tag;if((F===3||F===4)&&_.stateNode.containerInfo===y)return;_=_.return}for(;T!==null;){if(_=Tt(T),_===null)return;if(F=_.tag,F===5||F===6||F===26||F===27){g=w=_;continue e}T=T.parentNode}}g=g.return}V2(function(){var ne=w,pe=c1(f),ye=[];e:{var oe=xb.get(l);if(oe!==void 0){var ue=uf,je=l;switch(l){case"keypress":if(lf(f)===0)break e;case"keydown":case"keyup":ue=XT;break;case"focusin":je="focus",ue=m1;break;case"focusout":je="blur",ue=m1;break;case"beforeblur":case"afterblur":ue=m1;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=W2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=jT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=ZT;break;case hb:case pb:case mb:ue=FT;break;case gb:ue=QT;break;case"scroll":case"scrollend":ue=RT;break;case"wheel":ue=t8;break;case"copy":case"cut":case"paste":ue=UT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=X2;break;case"toggle":case"beforetoggle":ue=r8}var Xe=(u&4)!==0,Bt=!Xe&&(l==="scroll"||l==="scrollend"),Y=Xe?oe!==null?oe+"Capture":null:oe;Xe=[];for(var W=ne,te;W!==null;){var ve=W;if(te=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||te===null||Y===null||(ve=Wc(W,Y),ve!=null&&Xe.push(Au(W,ve,te))),Bt)break;W=W.return}0<Xe.length&&(oe=new ue(oe,je,null,f,pe),ye.push({event:oe,listeners:Xe}))}}if((u&7)===0){e:{if(oe=l==="mouseover"||l==="pointerover",ue=l==="mouseout"||l==="pointerout",oe&&f!==l1&&(je=f.relatedTarget||f.fromElement)&&(Tt(je)||je[Ee]))break e;if((ue||oe)&&(oe=pe.window===pe?pe:(oe=pe.ownerDocument)?oe.defaultView||oe.parentWindow:window,ue?(je=f.relatedTarget||f.toElement,ue=ne,je=je?Tt(je):null,je!==null&&(Bt=a(je),Xe=je.tag,je!==Bt||Xe!==5&&Xe!==27&&Xe!==6)&&(je=null)):(ue=null,je=ne),ue!==je)){if(Xe=W2,ve="onMouseLeave",Y="onMouseEnter",W="mouse",(l==="pointerout"||l==="pointerover")&&(Xe=X2,ve="onPointerLeave",Y="onPointerEnter",W="pointer"),Bt=ue==null?oe:Ui(ue),te=je==null?oe:Ui(je),oe=new Xe(ve,W+"leave",ue,f,pe),oe.target=Bt,oe.relatedTarget=te,ve=null,Tt(pe)===ne&&(Xe=new Xe(Y,W+"enter",je,f,pe),Xe.target=te,Xe.relatedTarget=Bt,ve=Xe),Bt=ve,ue&&je)t:{for(Xe=nO,Y=ue,W=je,te=0,ve=Y;ve;ve=Xe(ve))te++;ve=0;for(var Ve=W;Ve;Ve=Xe(Ve))ve++;for(;0<te-ve;)Y=Xe(Y),te--;for(;0<ve-te;)W=Xe(W),ve--;for(;te--;){if(Y===W||W!==null&&Y===W.alternate){Xe=Y;break t}Y=Xe(Y),W=Xe(W)}Xe=null}else Xe=null;ue!==null&&FC(ye,oe,ue,Xe,!1),je!==null&&Bt!==null&&FC(ye,Bt,je,Xe,!0)}}e:{if(oe=ne?Ui(ne):window,ue=oe.nodeName&&oe.nodeName.toLowerCase(),ue==="select"||ue==="input"&&oe.type==="file")var wt=nb;else if(eb(oe))if(rb)wt=h8;else{wt=d8;var ze=u8}else ue=oe.nodeName,!ue||ue.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ne&&s1(ne.elementType)&&(wt=nb):wt=f8;if(wt&&(wt=wt(l,ne))){tb(ye,wt,f,pe);break e}ze&&ze(l,oe,ne),l==="focusout"&&ne&&oe.type==="number"&&ne.memoizedProps.value!=null&&vs(oe,"number",oe.value)}switch(ze=ne?Ui(ne):window,l){case"focusin":(eb(ze)||ze.contentEditable==="true")&&(El=ze,w1=ne,eu=null);break;case"focusout":eu=w1=El=null;break;case"mousedown":C1=!0;break;case"contextmenu":case"mouseup":case"dragend":C1=!1,db(ye,f,pe);break;case"selectionchange":if(m8)break;case"keydown":case"keyup":db(ye,f,pe)}var it;if(x1)e:{switch(l){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Cl?J2(l,f)&&(mt="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(mt="onCompositionStart");mt&&(K2&&f.locale!=="ko"&&(Cl||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Cl&&(it=$2()):(co=pe,f1="value"in co?co.value:co.textContent,Cl=!0)),ze=eh(ne,mt),0<ze.length&&(mt=new q2(mt,l,null,f,pe),ye.push({event:mt,listeners:ze}),it?mt.data=it:(it=Q2(f),it!==null&&(mt.data=it)))),(it=a8?o8(l,f):s8(l,f))&&(mt=eh(ne,"onBeforeInput"),0<mt.length&&(ze=new q2("onBeforeInput","beforeinput",null,f,pe),ye.push({event:ze,listeners:mt}),ze.data=it)),J8(ye,l,ne,f,pe)}PC(ye,u)})}function Au(l,u,f){return{instance:l,listener:u,currentTarget:f}}function eh(l,u){for(var f=u+"Capture",g=[];l!==null;){var y=l,w=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||w===null||(y=Wc(l,f),y!=null&&g.unshift(Au(l,y,w)),y=Wc(l,u),y!=null&&g.push(Au(l,y,w))),l.tag===3)return g;l=l.return}return[]}function nO(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function FC(l,u,f,g,y){for(var w=u._reactName,_=[];f!==null&&f!==g;){var T=f,F=T.alternate,ne=T.stateNode;if(T=T.tag,F!==null&&F===g)break;T!==5&&T!==26&&T!==27||ne===null||(F=ne,y?(ne=Wc(f,w),ne!=null&&_.unshift(Au(f,ne,F))):y||(ne=Wc(f,w),ne!=null&&_.push(Au(f,ne,F)))),f=f.return}_.length!==0&&l.push({event:u,listeners:_})}var rO=/\r\n?/g,iO=/\u0000|\uFFFD/g;function zC(l){return(typeof l=="string"?l:""+l).replace(rO,`
`).replace(iO,"")}function UC(l,u){return u=zC(u),zC(l)===u}function Pt(l,u,f,g,y,w){switch(f){case"children":typeof g=="string"?u==="body"||u==="textarea"&&g===""||yl(l,g):(typeof g=="number"||typeof g=="bigint")&&u!=="body"&&yl(l,""+g);break;case"className":xl(l,"class",g);break;case"tabIndex":xl(l,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":xl(l,f,g);break;case"style":U2(l,g,w);break;case"data":if(u!=="object"){xl(l,"data",g);break}case"src":case"href":if(g===""&&(u!=="a"||f!=="href")){l.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){l.removeAttribute(f);break}g=of(""+g),l.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){l.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(f==="formAction"?(u!=="input"&&Pt(l,u,"name",y.name,y,null),Pt(l,u,"formEncType",y.formEncType,y,null),Pt(l,u,"formMethod",y.formMethod,y,null),Pt(l,u,"formTarget",y.formTarget,y,null)):(Pt(l,u,"encType",y.encType,y,null),Pt(l,u,"method",y.method,y,null),Pt(l,u,"target",y.target,y,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){l.removeAttribute(f);break}g=of(""+g),l.setAttribute(f,g);break;case"onClick":g!=null&&(l.onclick=Aa);break;case"onScroll":g!=null&&ft("scroll",l);break;case"onScrollEnd":g!=null&&ft("scrollend",l);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(y.children!=null)throw Error(r(60));l.innerHTML=f}}break;case"multiple":l.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":l.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){l.removeAttribute("xlink:href");break}f=of(""+g),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?l.setAttribute(f,""+g):l.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?l.setAttribute(f,""):l.removeAttribute(f);break;case"capture":case"download":g===!0?l.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?l.setAttribute(f,g):l.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?l.setAttribute(f,g):l.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?l.removeAttribute(f):l.setAttribute(f,g);break;case"popover":ft("beforetoggle",l),ft("toggle",l),Gc(l,"popover",g);break;case"xlinkActuate":Q(l,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Q(l,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Q(l,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Q(l,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Q(l,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Q(l,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Q(l,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Q(l,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Q(l,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Gc(l,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=DT.get(f)||f,Gc(l,f,g))}}function qm(l,u,f,g,y,w){switch(f){case"style":U2(l,g,w);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(y.children!=null)throw Error(r(60));l.innerHTML=f}}break;case"children":typeof g=="string"?yl(l,g):(typeof g=="number"||typeof g=="bigint")&&yl(l,""+g);break;case"onScroll":g!=null&&ft("scroll",l);break;case"onScrollEnd":g!=null&&ft("scrollend",l);break;case"onClick":g!=null&&(l.onclick=Aa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!af.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(y=f.endsWith("Capture"),u=f.slice(2,y?f.length-7:void 0),w=l[me]||null,w=w!=null?w[f]:null,typeof w=="function"&&l.removeEventListener(u,w,y),typeof g=="function")){typeof w!="function"&&w!==null&&(f in l?l[f]=null:l.hasAttribute(f)&&l.removeAttribute(f)),l.addEventListener(u,g,y);break e}f in l?l[f]=g:g===!0?l.setAttribute(f,""):Gc(l,f,g)}}}function pr(l,u,f){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",l),ft("load",l);var g=!1,y=!1,w;for(w in f)if(f.hasOwnProperty(w)){var _=f[w];if(_!=null)switch(w){case"src":g=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,u));default:Pt(l,u,w,_,f,null)}}y&&Pt(l,u,"srcSet",f.srcSet,f,null),g&&Pt(l,u,"src",f.src,f,null);return;case"input":ft("invalid",l);var T=w=_=y=null,F=null,ne=null;for(g in f)if(f.hasOwnProperty(g)){var pe=f[g];if(pe!=null)switch(g){case"name":y=pe;break;case"type":_=pe;break;case"checked":F=pe;break;case"defaultChecked":ne=pe;break;case"value":w=pe;break;case"defaultValue":T=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,u));break;default:Pt(l,u,g,pe,f,null)}}sa(l,w,T,F,ne,_,y,!1);return;case"select":ft("invalid",l),g=_=w=null;for(y in f)if(f.hasOwnProperty(y)&&(T=f[y],T!=null))switch(y){case"value":w=T;break;case"defaultValue":_=T;break;case"multiple":g=T;default:Pt(l,u,y,T,f,null)}u=w,f=_,l.multiple=!!g,u!=null?vl(l,!!g,u,!1):f!=null&&vl(l,!!g,f,!0);return;case"textarea":ft("invalid",l),w=y=g=null;for(_ in f)if(f.hasOwnProperty(_)&&(T=f[_],T!=null))switch(_){case"value":g=T;break;case"defaultValue":y=T;break;case"children":w=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:Pt(l,u,_,T,f,null)}F2(l,g,y,w);return;case"option":for(F in f)if(f.hasOwnProperty(F)&&(g=f[F],g!=null))switch(F){case"selected":l.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Pt(l,u,F,g,f,null)}return;case"dialog":ft("beforetoggle",l),ft("toggle",l),ft("cancel",l),ft("close",l);break;case"iframe":case"object":ft("load",l);break;case"video":case"audio":for(g=0;g<Su.length;g++)ft(Su[g],l);break;case"image":ft("error",l),ft("load",l);break;case"details":ft("toggle",l);break;case"embed":case"source":case"link":ft("error",l),ft("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in f)if(f.hasOwnProperty(ne)&&(g=f[ne],g!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,u));default:Pt(l,u,ne,g,f,null)}return;default:if(s1(u)){for(pe in f)f.hasOwnProperty(pe)&&(g=f[pe],g!==void 0&&qm(l,u,pe,g,f,void 0));return}}for(T in f)f.hasOwnProperty(T)&&(g=f[T],g!=null&&Pt(l,u,T,g,f,null))}function aO(l,u,f,g){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,w=null,_=null,T=null,F=null,ne=null,pe=null;for(ue in f){var ye=f[ue];if(f.hasOwnProperty(ue)&&ye!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":F=ye;default:g.hasOwnProperty(ue)||Pt(l,u,ue,null,g,ye)}}for(var oe in g){var ue=g[oe];if(ye=f[oe],g.hasOwnProperty(oe)&&(ue!=null||ye!=null))switch(oe){case"type":w=ue;break;case"name":y=ue;break;case"checked":ne=ue;break;case"defaultChecked":pe=ue;break;case"value":_=ue;break;case"defaultValue":T=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,u));break;default:ue!==ye&&Pt(l,u,oe,ue,g,ye)}}oi(l,_,T,F,ne,pe,w,y);return;case"select":ue=_=T=oe=null;for(w in f)if(F=f[w],f.hasOwnProperty(w)&&F!=null)switch(w){case"value":break;case"multiple":ue=F;default:g.hasOwnProperty(w)||Pt(l,u,w,null,g,F)}for(y in g)if(w=g[y],F=f[y],g.hasOwnProperty(y)&&(w!=null||F!=null))switch(y){case"value":oe=w;break;case"defaultValue":T=w;break;case"multiple":_=w;default:w!==F&&Pt(l,u,y,w,g,F)}u=T,f=_,g=ue,oe!=null?vl(l,!!f,oe,!1):!!g!=!!f&&(u!=null?vl(l,!!f,u,!0):vl(l,!!f,f?[]:"",!1));return;case"textarea":ue=oe=null;for(T in f)if(y=f[T],f.hasOwnProperty(T)&&y!=null&&!g.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Pt(l,u,T,null,g,y)}for(_ in g)if(y=g[_],w=f[_],g.hasOwnProperty(_)&&(y!=null||w!=null))switch(_){case"value":oe=y;break;case"defaultValue":ue=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==w&&Pt(l,u,_,y,g,w)}B2(l,oe,ue);return;case"option":for(var je in f)if(oe=f[je],f.hasOwnProperty(je)&&oe!=null&&!g.hasOwnProperty(je))switch(je){case"selected":l.selected=!1;break;default:Pt(l,u,je,null,g,oe)}for(F in g)if(oe=g[F],ue=f[F],g.hasOwnProperty(F)&&oe!==ue&&(oe!=null||ue!=null))switch(F){case"selected":l.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:Pt(l,u,F,oe,g,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in f)oe=f[Xe],f.hasOwnProperty(Xe)&&oe!=null&&!g.hasOwnProperty(Xe)&&Pt(l,u,Xe,null,g,oe);for(ne in g)if(oe=g[ne],ue=f[ne],g.hasOwnProperty(ne)&&oe!==ue&&(oe!=null||ue!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(r(137,u));break;default:Pt(l,u,ne,oe,g,ue)}return;default:if(s1(u)){for(var Bt in f)oe=f[Bt],f.hasOwnProperty(Bt)&&oe!==void 0&&!g.hasOwnProperty(Bt)&&qm(l,u,Bt,void 0,g,oe);for(pe in g)oe=g[pe],ue=f[pe],!g.hasOwnProperty(pe)||oe===ue||oe===void 0&&ue===void 0||qm(l,u,pe,oe,g,ue);return}}for(var Y in f)oe=f[Y],f.hasOwnProperty(Y)&&oe!=null&&!g.hasOwnProperty(Y)&&Pt(l,u,Y,null,g,oe);for(ye in g)oe=g[ye],ue=f[ye],!g.hasOwnProperty(ye)||oe===ue||oe==null&&ue==null||Pt(l,u,ye,oe,g,ue)}function HC(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function oO(){if(typeof performance.getEntriesByType=="function"){for(var l=0,u=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var y=f[g],w=y.transferSize,_=y.initiatorType,T=y.duration;if(w&&T&&HC(_)){for(_=0,T=y.responseEnd,g+=1;g<f.length;g++){var F=f[g],ne=F.startTime;if(ne>T)break;var pe=F.transferSize,ye=F.initiatorType;pe&&HC(ye)&&(F=F.responseEnd,_+=pe*(F<T?1:(T-ne)/(F-ne)))}if(--g,u+=8*(w+_)/(y.duration/1e3),l++,10<l)break}}if(0<l)return u/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Xm=null,Km=null;function th(l){return l.nodeType===9?l:l.ownerDocument}function VC(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $C(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function Ym(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Zm=null;function sO(){var l=window.event;return l&&l.type==="popstate"?l===Zm?!1:(Zm=l,!0):(Zm=null,!1)}var GC=typeof setTimeout=="function"?setTimeout:void 0,lO=typeof clearTimeout=="function"?clearTimeout:void 0,WC=typeof Promise=="function"?Promise:void 0,cO=typeof queueMicrotask=="function"?queueMicrotask:typeof WC<"u"?function(l){return WC.resolve(null).then(l).catch(uO)}:GC;function uO(l){setTimeout(function(){throw l})}function No(l){return l==="head"}function qC(l,u){var f=u,g=0;do{var y=f.nextSibling;if(l.removeChild(f),y&&y.nodeType===8)if(f=y.data,f==="/$"||f==="/&"){if(g===0){l.removeChild(y),Yl(u);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")_u(l.ownerDocument.documentElement);else if(f==="head"){f=l.ownerDocument.head,_u(f);for(var w=f.firstChild;w;){var _=w.nextSibling,T=w.nodeName;w[Zt]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&w.rel.toLowerCase()==="stylesheet"||f.removeChild(w),w=_}}else f==="body"&&_u(l.ownerDocument.body);f=y}while(f);Yl(u)}function XC(l,u){var f=l;l=0;do{var g=f.nextSibling;if(f.nodeType===1?u?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(u?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(l===0)break;l--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||l++;f=g}while(f)}function Jm(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var f=u;switch(u=u.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Jm(f),bt(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}l.removeChild(f)}}function dO(l,u,f,g){for(;l.nodeType===1;){var y=f;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!g&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(g){if(!l[Zt])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(w=l.getAttribute("rel"),w==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(w!==y.rel||l.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||l.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||l.getAttribute("title")!==(y.title==null?null:y.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(w=l.getAttribute("src"),(w!==(y.src==null?null:y.src)||l.getAttribute("type")!==(y.type==null?null:y.type)||l.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&w&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var w=y.name==null?null:""+y.name;if(y.type==="hidden"&&l.getAttribute("name")===w)return l}else return l;if(l=_i(l.nextSibling),l===null)break}return null}function fO(l,u,f){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!f||(l=_i(l.nextSibling),l===null))return null;return l}function KC(l,u){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!u||(l=_i(l.nextSibling),l===null))return null;return l}function Qm(l){return l.data==="$?"||l.data==="$~"}function eg(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function hO(l,u){var f=l.ownerDocument;if(l.data==="$~")l._reactRetry=u;else if(l.data!=="$?"||f.readyState!=="loading")u();else{var g=function(){u(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),l._reactRetry=g}}function _i(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return l}var tg=null;function YC(l){l=l.nextSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"||f==="/&"){if(u===0)return _i(l.nextSibling);u--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||u++}l=l.nextSibling}return null}function ZC(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(u===0)return l;u--}else f!=="/$"&&f!=="/&"||u++}l=l.previousSibling}return null}function JC(l,u,f){switch(u=th(f),l){case"html":if(l=u.documentElement,!l)throw Error(r(452));return l;case"head":if(l=u.head,!l)throw Error(r(453));return l;case"body":if(l=u.body,!l)throw Error(r(454));return l;default:throw Error(r(451))}}function _u(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);bt(l)}var Ni=new Map,QC=new Set;function nh(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Ua=ie.d;ie.d={f:pO,r:mO,D:gO,C:xO,L:vO,m:yO,X:wO,S:bO,M:CO};function pO(){var l=Ua.f(),u=qf();return l||u}function mO(l){var u=Lr(l);u!==null&&u.tag===5&&u.type==="form"?gw(u):Ua.r(l)}var ql=typeof document>"u"?null:document;function eE(l,u,f){var g=ql;if(g&&typeof u=="string"&&u){var y=mn(u);y='link[rel="'+l+'"][href="'+y+'"]',typeof f=="string"&&(y+='[crossorigin="'+f+'"]'),QC.has(y)||(QC.add(y),l={rel:l,crossOrigin:f,href:u},g.querySelector(y)===null&&(u=g.createElement("link"),pr(u,"link",l),Dn(u),g.head.appendChild(u)))}}function gO(l){Ua.D(l),eE("dns-prefetch",l,null)}function xO(l,u){Ua.C(l,u),eE("preconnect",l,u)}function vO(l,u,f){Ua.L(l,u,f);var g=ql;if(g&&l&&u){var y='link[rel="preload"][as="'+mn(u)+'"]';u==="image"&&f&&f.imageSrcSet?(y+='[imagesrcset="'+mn(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(y+='[imagesizes="'+mn(f.imageSizes)+'"]')):y+='[href="'+mn(l)+'"]';var w=y;switch(u){case"style":w=Xl(l);break;case"script":w=Kl(l)}Ni.has(w)||(l=p({rel:"preload",href:u==="image"&&f&&f.imageSrcSet?void 0:l,as:u},f),Ni.set(w,l),g.querySelector(y)!==null||u==="style"&&g.querySelector(Nu(w))||u==="script"&&g.querySelector(ku(w))||(u=g.createElement("link"),pr(u,"link",l),Dn(u),g.head.appendChild(u)))}}function yO(l,u){Ua.m(l,u);var f=ql;if(f&&l){var g=u&&typeof u.as=="string"?u.as:"script",y='link[rel="modulepreload"][as="'+mn(g)+'"][href="'+mn(l)+'"]',w=y;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Kl(l)}if(!Ni.has(w)&&(l=p({rel:"modulepreload",href:l},u),Ni.set(w,l),f.querySelector(y)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(ku(w)))return}g=f.createElement("link"),pr(g,"link",l),Dn(g),f.head.appendChild(g)}}}function bO(l,u,f){Ua.S(l,u,f);var g=ql;if(g&&l){var y=lo(g).hoistableStyles,w=Xl(l);u=u||"default";var _=y.get(w);if(!_){var T={loading:0,preload:null};if(_=g.querySelector(Nu(w)))T.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":u},f),(f=Ni.get(w))&&ng(l,f);var F=_=g.createElement("link");Dn(F),pr(F,"link",l),F._p=new Promise(function(ne,pe){F.onload=ne,F.onerror=pe}),F.addEventListener("load",function(){T.loading|=1}),F.addEventListener("error",function(){T.loading|=2}),T.loading|=4,rh(_,u,g)}_={type:"stylesheet",instance:_,count:1,state:T},y.set(w,_)}}}function wO(l,u){Ua.X(l,u);var f=ql;if(f&&l){var g=lo(f).hoistableScripts,y=Kl(l),w=g.get(y);w||(w=f.querySelector(ku(y)),w||(l=p({src:l,async:!0},u),(u=Ni.get(y))&&rg(l,u),w=f.createElement("script"),Dn(w),pr(w,"link",l),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},g.set(y,w))}}function CO(l,u){Ua.M(l,u);var f=ql;if(f&&l){var g=lo(f).hoistableScripts,y=Kl(l),w=g.get(y);w||(w=f.querySelector(ku(y)),w||(l=p({src:l,async:!0,type:"module"},u),(u=Ni.get(y))&&rg(l,u),w=f.createElement("script"),Dn(w),pr(w,"link",l),f.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},g.set(y,w))}}function tE(l,u,f,g){var y=(y=J.current)?nh(y):null;if(!y)throw Error(r(446));switch(l){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(u=Xl(f.href),f=lo(y).hoistableStyles,g=f.get(u),g||(g={type:"style",instance:null,count:0,state:null},f.set(u,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){l=Xl(f.href);var w=lo(y).hoistableStyles,_=w.get(l);if(_||(y=y.ownerDocument||y,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(l,_),(w=y.querySelector(Nu(l)))&&!w._p&&(_.instance=w,_.state.loading=5),Ni.has(l)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Ni.set(l,f),w||EO(y,l,f,_.state))),u&&g===null)throw Error(r(528,""));return _}if(u&&g!==null)throw Error(r(529,""));return null;case"script":return u=f.async,f=f.src,typeof f=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Kl(f),f=lo(y).hoistableScripts,g=f.get(u),g||(g={type:"script",instance:null,count:0,state:null},f.set(u,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,l))}}function Xl(l){return'href="'+mn(l)+'"'}function Nu(l){return'link[rel="stylesheet"]['+l+"]"}function nE(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function EO(l,u,f,g){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?g.loading=1:(u=l.createElement("link"),g.preload=u,u.addEventListener("load",function(){return g.loading|=1}),u.addEventListener("error",function(){return g.loading|=2}),pr(u,"link",f),Dn(u),l.head.appendChild(u))}function Kl(l){return'[src="'+mn(l)+'"]'}function ku(l){return"script[async]"+l}function rE(l,u,f){if(u.count++,u.instance===null)switch(u.type){case"style":var g=l.querySelector('style[data-href~="'+mn(f.href)+'"]');if(g)return u.instance=g,Dn(g),g;var y=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(l.ownerDocument||l).createElement("style"),Dn(g),pr(g,"style",y),rh(g,f.precedence,l),u.instance=g;case"stylesheet":y=Xl(f.href);var w=l.querySelector(Nu(y));if(w)return u.state.loading|=4,u.instance=w,Dn(w),w;g=nE(f),(y=Ni.get(y))&&ng(g,y),w=(l.ownerDocument||l).createElement("link"),Dn(w);var _=w;return _._p=new Promise(function(T,F){_.onload=T,_.onerror=F}),pr(w,"link",g),u.state.loading|=4,rh(w,f.precedence,l),u.instance=w;case"script":return w=Kl(f.src),(y=l.querySelector(ku(w)))?(u.instance=y,Dn(y),y):(g=f,(y=Ni.get(w))&&(g=p({},f),rg(g,y)),l=l.ownerDocument||l,y=l.createElement("script"),Dn(y),pr(y,"link",g),l.head.appendChild(y),u.instance=y);case"void":return null;default:throw Error(r(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(g=u.instance,u.state.loading|=4,rh(g,f.precedence,l));return u.instance}function rh(l,u,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=g.length?g[g.length-1]:null,w=y,_=0;_<g.length;_++){var T=g[_];if(T.dataset.precedence===u)w=T;else if(w!==y)break}w?w.parentNode.insertBefore(l,w.nextSibling):(u=f.nodeType===9?f.head:f,u.insertBefore(l,u.firstChild))}function ng(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function rg(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var ih=null;function iE(l,u,f){if(ih===null){var g=new Map,y=ih=new Map;y.set(f,g)}else y=ih,g=y.get(f),g||(g=new Map,y.set(f,g));if(g.has(l))return g;for(g.set(l,null),f=f.getElementsByTagName(l),y=0;y<f.length;y++){var w=f[y];if(!(w[Zt]||w[se]||l==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var _=w.getAttribute(u)||"";_=l+_;var T=g.get(_);T?T.push(w):g.set(_,[w])}}return g}function aE(l,u,f){l=l.ownerDocument||l,l.head.insertBefore(f,u==="title"?l.querySelector("head > title"):null)}function SO(l,u,f){if(f===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return l=u.disabled,typeof u.precedence=="string"&&l==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function oE(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function AO(l,u,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var y=Xl(g.href),w=u.querySelector(Nu(y));if(w){u=w._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(l.count++,l=ah.bind(l),u.then(l,l)),f.state.loading|=4,f.instance=w,Dn(w);return}w=u.ownerDocument||u,g=nE(g),(y=Ni.get(y))&&ng(g,y),w=w.createElement("link"),Dn(w);var _=w;_._p=new Promise(function(T,F){_.onload=T,_.onerror=F}),pr(w,"link",g),f.instance=w}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(f,u),(u=f.state.preload)&&(f.state.loading&3)===0&&(l.count++,f=ah.bind(l),u.addEventListener("load",f),u.addEventListener("error",f))}}var ig=0;function _O(l,u){return l.stylesheets&&l.count===0&&sh(l,l.stylesheets),0<l.count||0<l.imgCount?function(f){var g=setTimeout(function(){if(l.stylesheets&&sh(l,l.stylesheets),l.unsuspend){var w=l.unsuspend;l.unsuspend=null,w()}},6e4+u);0<l.imgBytes&&ig===0&&(ig=62500*oO());var y=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&sh(l,l.stylesheets),l.unsuspend)){var w=l.unsuspend;l.unsuspend=null,w()}},(l.imgBytes>ig?50:800)+u);return l.unsuspend=f,function(){l.unsuspend=null,clearTimeout(g),clearTimeout(y)}}:null}function ah(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sh(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var oh=null;function sh(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,oh=new Map,u.forEach(NO,l),oh=null,ah.call(l))}function NO(l,u){if(!(u.state.loading&4)){var f=oh.get(l);if(f)var g=f.get(null);else{f=new Map,oh.set(l,f);for(var y=l.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<y.length;w++){var _=y[w];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(f.set(_.dataset.precedence,_),g=_)}g&&f.set(null,g)}y=u.instance,_=y.getAttribute("data-precedence"),w=f.get(_)||g,w===g&&f.set(null,y),f.set(_,y),this.count++,g=ah.bind(this),y.addEventListener("load",g),y.addEventListener("error",g),w?w.parentNode.insertBefore(y,w.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(y,l.firstChild)),u.state.loading|=4}}var Tu={$$typeof:k,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function kO(l,u,f,g,y,w,_,T,F){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xn(0),this.hiddenUpdates=Xn(null),this.identifierPrefix=g,this.onUncaughtError=y,this.onCaughtError=w,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function sE(l,u,f,g,y,w,_,T,F,ne,pe,ye){return l=new kO(l,u,f,_,F,ne,pe,ye,T),u=1,w===!0&&(u|=24),w=li(3,null,null,u),l.current=w,w.stateNode=l,u=P1(),u.refCount++,l.pooledCache=u,u.refCount++,w.memoizedState={element:g,isDehydrated:f,cache:u},U1(w),l}function lE(l){return l?(l=_l,l):_l}function cE(l,u,f,g,y,w){y=lE(y),g.context===null?g.context=y:g.pendingContext=y,g=go(u),g.payload={element:f},w=w===void 0?null:w,w!==null&&(g.callback=w),f=xo(l,g,u),f!==null&&(Jr(f,l,u),su(f,l,u))}function uE(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<u?f:u}}function ag(l,u){uE(l,u),(l=l.alternate)&&uE(l,u)}function dE(l){if(l.tag===13||l.tag===31){var u=Cs(l,67108864);u!==null&&Jr(u,l,67108864),ag(l,67108864)}}function fE(l){if(l.tag===13||l.tag===31){var u=hi();u=In(u);var f=Cs(l,u);f!==null&&Jr(f,l,u),ag(l,u)}}var lh=!0;function TO(l,u,f,g){var y=H.T;H.T=null;var w=ie.p;try{ie.p=2,og(l,u,f,g)}finally{ie.p=w,H.T=y}}function OO(l,u,f,g){var y=H.T;H.T=null;var w=ie.p;try{ie.p=8,og(l,u,f,g)}finally{ie.p=w,H.T=y}}function og(l,u,f,g){if(lh){var y=sg(g);if(y===null)Wm(l,u,g,ch,f),pE(l,g);else if(DO(y,l,u,f,g))g.stopPropagation();else if(pE(l,g),u&4&&-1<IO.indexOf(l)){for(;y!==null;){var w=Lr(y);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var _=Ht(w.pendingLanes);if(_!==0){var T=w;for(T.pendingLanes|=2,T.entangledLanes|=2;_;){var F=1<<31-Tn(_);T.entanglements[1]|=F,_&=~F}da(w),(_t&6)===0&&(Gf=rn()+500,Eu(0))}}break;case 31:case 13:T=Cs(w,2),T!==null&&Jr(T,w,2),qf(),ag(w,2)}if(w=sg(g),w===null&&Wm(l,u,g,ch,f),w===y)break;y=w}y!==null&&g.stopPropagation()}else Wm(l,u,g,null,f)}}function sg(l){return l=c1(l),lg(l)}var ch=null;function lg(l){if(ch=null,l=Tt(l),l!==null){var u=a(l);if(u===null)l=null;else{var f=u.tag;if(f===13){if(l=o(u),l!==null)return l;l=null}else if(f===31){if(l=s(u),l!==null)return l;l=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return ch=l,null}function hE(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fi()){case or:return 2;case sr:return 8;case St:case Er:return 32;case zi:return 268435456;default:return 32}default:return 32}}var cg=!1,ko=null,To=null,Oo=null,Ou=new Map,Iu=new Map,Io=[],IO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pE(l,u){switch(l){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":To=null;break;case"mouseover":case"mouseout":Oo=null;break;case"pointerover":case"pointerout":Ou.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Iu.delete(u.pointerId)}}function Du(l,u,f,g,y,w){return l===null||l.nativeEvent!==w?(l={blockedOn:u,domEventName:f,eventSystemFlags:g,nativeEvent:w,targetContainers:[y]},u!==null&&(u=Lr(u),u!==null&&dE(u)),l):(l.eventSystemFlags|=g,u=l.targetContainers,y!==null&&u.indexOf(y)===-1&&u.push(y),l)}function DO(l,u,f,g,y){switch(u){case"focusin":return ko=Du(ko,l,u,f,g,y),!0;case"dragenter":return To=Du(To,l,u,f,g,y),!0;case"mouseover":return Oo=Du(Oo,l,u,f,g,y),!0;case"pointerover":var w=y.pointerId;return Ou.set(w,Du(Ou.get(w)||null,l,u,f,g,y)),!0;case"gotpointercapture":return w=y.pointerId,Iu.set(w,Du(Iu.get(w)||null,l,u,f,g,y)),!0}return!1}function mE(l){var u=Tt(l.target);if(u!==null){var f=a(u);if(f!==null){if(u=f.tag,u===13){if(u=o(f),u!==null){l.blockedOn=u,Ae(l.priority,function(){fE(f)});return}}else if(u===31){if(u=s(f),u!==null){l.blockedOn=u,Ae(l.priority,function(){fE(f)});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function uh(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var f=sg(l.nativeEvent);if(f===null){f=l.nativeEvent;var g=new f.constructor(f.type,f);l1=g,f.target.dispatchEvent(g),l1=null}else return u=Lr(f),u!==null&&dE(u),l.blockedOn=f,!1;u.shift()}return!0}function gE(l,u,f){uh(l)&&f.delete(u)}function MO(){cg=!1,ko!==null&&uh(ko)&&(ko=null),To!==null&&uh(To)&&(To=null),Oo!==null&&uh(Oo)&&(Oo=null),Ou.forEach(gE),Iu.forEach(gE)}function dh(l,u){l.blockedOn===u&&(l.blockedOn=null,cg||(cg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,MO)))}var fh=null;function xE(l){fh!==l&&(fh=l,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){fh===l&&(fh=null);for(var u=0;u<l.length;u+=3){var f=l[u],g=l[u+1],y=l[u+2];if(typeof g!="function"){if(lg(g||f)===null)continue;break}var w=Lr(f);w!==null&&(l.splice(u,3),u-=3,sm(w,{pending:!0,data:y,method:f.method,action:g},g,y))}}))}function Yl(l){function u(F){return dh(F,l)}ko!==null&&dh(ko,l),To!==null&&dh(To,l),Oo!==null&&dh(Oo,l),Ou.forEach(u),Iu.forEach(u);for(var f=0;f<Io.length;f++){var g=Io[f];g.blockedOn===l&&(g.blockedOn=null)}for(;0<Io.length&&(f=Io[0],f.blockedOn===null);)mE(f),f.blockedOn===null&&Io.shift();if(f=(l.ownerDocument||l).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var y=f[g],w=f[g+1],_=y[me]||null;if(typeof w=="function")_||xE(f);else if(_){var T=null;if(w&&w.hasAttribute("formAction")){if(y=w,_=w[me]||null)T=_.formAction;else if(lg(y)!==null)continue}else T=_.action;typeof T=="function"?f[g+1]=T:(f.splice(g,3),g-=3),xE(f)}}}function vE(){function l(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(_){return y=_})},focusReset:"manual",scroll:"manual"})}function u(){y!==null&&(y(),y=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,y=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),y!==null&&(y(),y=null)}}}function ug(l){this._internalRoot=l}hh.prototype.render=ug.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(r(409));var f=u.current,g=hi();cE(f,g,l,u,null,null)},hh.prototype.unmount=ug.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;cE(l.current,2,null,l,null,null),qf(),u[Ee]=null}};function hh(l){this._internalRoot=l}hh.prototype.unstable_scheduleHydration=function(l){if(l){var u=X();l={blockedOn:null,target:l,priority:u};for(var f=0;f<Io.length&&u!==0&&u<Io[f].priority;f++);Io.splice(f,0,l),f===0&&mE(l)}};var yE=e.version;if(yE!=="19.2.0")throw Error(r(527,yE,"19.2.0"));ie.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=d(u),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var RO={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ph.isDisabled&&ph.supportsFiber)try{Gr=ph.inject(RO),xn=ph}catch{}}return Ru.createRoot=function(l,u){if(!i(l))throw Error(r(299));var f=!1,g="",y=_w,w=Nw,_=kw;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(w=u.onCaughtError),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=sE(l,1,!1,null,null,f,g,null,y,w,_,vE),l[Ee]=u.current,Gm(l),new ug(u)},Ru.hydrateRoot=function(l,u,f){if(!i(l))throw Error(r(299));var g=!1,y="",w=_w,_=Nw,T=kw,F=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(y=f.identifierPrefix),f.onUncaughtError!==void 0&&(w=f.onUncaughtError),f.onCaughtError!==void 0&&(_=f.onCaughtError),f.onRecoverableError!==void 0&&(T=f.onRecoverableError),f.formState!==void 0&&(F=f.formState)),u=sE(l,1,!0,u,f??null,g,y,F,w,_,T,vE),u.context=lE(null),f=u.current,g=hi(),g=In(g),y=go(g),y.callback=null,xo(f,y,g),f=g,u.current.lanes=f,ur(u,f),da(u),l[Ee]=u.current,Gm(l),new hh(u)},Ru.version="19.2.0",Ru}var TE;function $O(){if(TE)return hg.exports;TE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),hg.exports=VO(),hg.exports}var GO=$O();const WO=C0(GO);/**
 * react-router v7.13.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OE="popstate";function IE(t){return typeof t=="object"&&t!=null&&"pathname"in t&&"search"in t&&"hash"in t&&"state"in t&&"key"in t}function qO(t={}){function e(i,a){let{pathname:o="/",search:s="",hash:c=""}=Rc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Gx("",{pathname:o,search:s,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){let o=i.document.querySelector("base"),s="";if(o&&o.getAttribute("href")){let c=i.location.href,d=c.indexOf("#");s=d===-1?c:c.slice(0,d)}return s+"#"+(typeof a=="string"?a:xd(a))}function r(i,a){ea(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return KO(e,n,r,t)}function qn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ea(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function XO(){return Math.random().toString(36).substring(2,10)}function DE(t,e){return{usr:t.state,key:t.key,idx:e,masked:t.unstable_mask?{pathname:t.pathname,search:t.search,hash:t.hash}:void 0}}function Gx(t,e,n=null,r,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Rc(e):e,state:n,key:e&&e.key||r||XO(),unstable_mask:i}}function xd({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Rc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function KO(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s="POP",c=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){s="POP";let E=h(),S=E==null?null:E-d;d=E,c&&c({action:s,location:C.location,delta:S})}function x(E,S){s="PUSH";let N=IE(E)?E:Gx(C.location,E,S);n&&n(N,E),d=h()+1;let k=DE(N,d),I=C.createHref(N.unstable_mask||N);try{o.pushState(k,"",I)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(I)}a&&c&&c({action:s,location:C.location,delta:1})}function v(E,S){s="REPLACE";let N=IE(E)?E:Gx(C.location,E,S);n&&n(N,E),d=h();let k=DE(N,d),I=C.createHref(N.unstable_mask||N);o.replaceState(k,"",I),a&&c&&c({action:s,location:C.location,delta:0})}function b(E){return YO(E)}let C={get action(){return s},get location(){return t(i,o)},listen(E){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(OE,p),c=E,()=>{i.removeEventListener(OE,p),c=null}},createHref(E){return e(i,E)},createURL:b,encodeLocation(E){let S=b(E);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:v,go(E){return o.go(E)}};return C}function YO(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),qn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:xd(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function K_(t,e,n="/"){return ZO(t,e,n,!1)}function ZO(t,e,n,r){let i=typeof e=="string"?Rc(e):e,a=no(i.pathname||"/",n);if(a==null)return null;let o=Y_(t);JO(o);let s=null;for(let c=0;s==null&&c<o.length;++c){let d=cI(a);s=sI(o[c],d,r)}return s}function Y_(t,e=[],n=[],r="",i=!1){let a=(o,s,c=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&c)return;qn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=xa([r,h.relativePath]),x=n.concat(h);o.children&&o.children.length>0&&(qn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Y_(o.children,e,x,p,c)),!(o.path==null&&!o.index)&&e.push({path:p,score:aI(p,o.index),routesMeta:x})};return t.forEach((o,s)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,s);else for(let d of Z_(o.path))a(o,s,!0,d)}),e}function Z_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=Z_(r.join("/")),s=[];return s.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&s.push(...o),s.map(c=>t.startsWith("/")&&c===""?"/":c)}function JO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:oI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var QO=/^:[\w-]+$/,eI=3,tI=2,nI=1,rI=10,iI=-2,ME=t=>t==="*";function aI(t,e){let n=t.split("/"),r=n.length;return n.some(ME)&&(r+=iI),e&&(r+=tI),n.filter(i=>!ME(i)).reduce((i,a)=>i+(QO.test(a)?eI:a===""?nI:rI),r)}function oI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function sI(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",o=[];for(let s=0;s<r.length;++s){let c=r[s],d=s===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=op({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=op({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:xa([a,p.pathname]),pathnameBase:hI(xa([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=xa([a,p.pathnameBase]))}return o}function op(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=lI(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},x)=>{if(h==="*"){let b=s[x]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const v=s[x];return p&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:t}}function lI(t,e=!1,n=!0){ea(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,c,d,h)=>{if(r.push({paramName:s,isOptional:c!=null}),c){let p=h.charAt(d+o.length);return p&&p!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function cI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ea(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function no(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var uI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function dI(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Rc(t):t,a;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?a=RE(n.substring(1),"/"):a=RE(n,e)):a=e,{pathname:a,search:pI(r),hash:mI(i)}}function RE(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function xg(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function fI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function J_(t){let e=fI(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function ay(t,e,n,r=!1){let i;typeof t=="string"?i=Rc(t):(i={...t},qn(!i.pathname||!i.pathname.includes("?"),xg("?","pathname","search",i)),qn(!i.pathname||!i.pathname.includes("#"),xg("#","pathname","hash",i)),qn(!i.search||!i.search.includes("#"),xg("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,s;if(o==null)s=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;i.pathname=x.join("/")}s=p>=0?e[p]:"/"}let c=dI(i,s),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}var xa=t=>t.join("/").replace(/\/\/+/g,"/"),hI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,gI=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function xI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function vI(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Q_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function e4(t,e){let n=t;if(typeof n!="string"||!uI.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,i=!1;if(Q_)try{let a=new URL(window.location.href),o=n.startsWith("//")?new URL(a.protocol+n):new URL(n),s=no(o.pathname,e);o.origin===a.origin&&s!=null?n=s+o.search+o.hash:i=!0}catch{ea(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var t4=["POST","PUT","PATCH","DELETE"];new Set(t4);var yI=["GET",...t4];new Set(yI);var Lc=A.createContext(null);Lc.displayName="DataRouter";var E0=A.createContext(null);E0.displayName="DataRouterState";var bI=A.createContext(!1),n4=A.createContext({isTransitioning:!1});n4.displayName="ViewTransition";var wI=A.createContext(new Map);wI.displayName="Fetchers";var CI=A.createContext(null);CI.displayName="Await";var Bi=A.createContext(null);Bi.displayName="Navigation";var S0=A.createContext(null);S0.displayName="Location";var oo=A.createContext({outlet:null,matches:[],isDataRoute:!1});oo.displayName="Route";var oy=A.createContext(null);oy.displayName="RouteError";var r4="REACT_ROUTER_ERROR",EI="REDIRECT",SI="ROUTE_ERROR_RESPONSE";function AI(t){if(t.startsWith(`${r4}:${EI}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function _I(t){if(t.startsWith(`${r4}:${SI}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new gI(e.status,e.statusText,e.data)}catch{}}function NI(t,{relative:e}={}){qn(Bd(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(Bi),{hash:i,pathname:a,search:o}=Fd(t,{relative:e}),s=a;return n!=="/"&&(s=a==="/"?n:xa([n,a])),r.createHref({pathname:s,search:o,hash:i})}function Bd(){return A.useContext(S0)!=null}function us(){return qn(Bd(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(S0).location}var i4="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function a4(t){A.useContext(Bi).static||A.useLayoutEffect(t)}function kI(){let{isDataRoute:t}=A.useContext(oo);return t?UI():TI()}function TI(){qn(Bd(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(Lc),{basename:e,navigator:n}=A.useContext(Bi),{matches:r}=A.useContext(oo),{pathname:i}=us(),a=JSON.stringify(J_(r)),o=A.useRef(!1);return a4(()=>{o.current=!0}),A.useCallback((c,d={})=>{if(ea(o.current,i4),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=ay(c,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:xa([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,a,i,t])}A.createContext(null);function Fd(t,{relative:e}={}){let{matches:n}=A.useContext(oo),{pathname:r}=us(),i=JSON.stringify(J_(n));return A.useMemo(()=>ay(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function OI(t,e,n){qn(Bd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=A.useContext(Bi),{matches:i}=A.useContext(oo),a=i[i.length-1],o=a?a.params:{},s=a?a.pathname:"/",c=a?a.pathnameBase:"/",d=a&&a.route;{let E=d&&d.path||"";s4(s,!d||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${s}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let h=us(),p;p=h;let x=p.pathname||"/",v=x;if(c!=="/"){let E=c.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=K_(t,{pathname:v});return ea(d||b!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),ea(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),LI(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},o,E.params),pathname:xa([c,r.encodeLocation?r.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:xa([c,r.encodeLocation?r.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),i,n)}function II(){let t=zI(),e=xI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:a},"ErrorBoundary")," or"," ",A.createElement("code",{style:a},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:i},n):null,o)}var DI=A.createElement(II,null),o4=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=_I(t.digest);n&&(t=n)}let e=t!==void 0?A.createElement(oo.Provider,{value:this.props.routeContext},A.createElement(oy.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?A.createElement(MI,{error:t},e):e}};o4.contextType=bI;var vg=new WeakMap;function MI({children:t,error:e}){let{basename:n}=A.useContext(Bi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=AI(e.digest);if(r){let i=vg.get(e);if(i)throw i;let a=e4(r.location,n);if(Q_&&!vg.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw vg.set(e,o),o}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function RI({routeContext:t,match:e,children:n}){let r=A.useContext(Lc);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(oo.Provider,{value:t},n)}function LI(t,e=[],n){let r=n==null?void 0:n.state;if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,a=r==null?void 0:r.errors;if(a!=null){let h=i.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);qn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let o=!1,s=-1;if(n&&r){o=r.renderFallback;for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(s=h),p.route.id){let{loaderData:x,errors:v}=r,b=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){n.isStatic&&(o=!0),s>=0?i=i.slice(0,s+1):i=[i[0]];break}}}}let c=n==null?void 0:n.onError,d=r&&c?(h,p)=>{var x,v;c(h,{location:r.location,params:((v=(x=r.matches)==null?void 0:x[0])==null?void 0:v.params)??{},unstable_pattern:vI(r.matches),errorInfo:p})}:void 0;return i.reduceRight((h,p,x)=>{let v,b=!1,C=null,E=null;r&&(v=a&&p.route.id?a[p.route.id]:void 0,C=p.route.errorElement||DI,o&&(s<0&&x===0?(s4("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,E=null):s===x&&(b=!0,E=p.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,x+1)),N=()=>{let k;return v?k=C:b?k=E:p.route.Component?k=A.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=h,A.createElement(RI,{match:p,routeContext:{outlet:h,matches:S,isDataRoute:r!=null},children:k})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?A.createElement(o4,{location:r.location,revalidation:r.revalidation,component:C,error:v,children:N(),routeContext:{outlet:null,matches:S,isDataRoute:!0},onError:d}):N()},null)}function sy(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jI(t){let e=A.useContext(Lc);return qn(e,sy(t)),e}function PI(t){let e=A.useContext(E0);return qn(e,sy(t)),e}function BI(t){let e=A.useContext(oo);return qn(e,sy(t)),e}function ly(t){let e=BI(t),n=e.matches[e.matches.length-1];return qn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function FI(){return ly("useRouteId")}function zI(){var r;let t=A.useContext(oy),e=PI("useRouteError"),n=ly("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function UI(){let{router:t}=jI("useNavigate"),e=ly("useNavigate"),n=A.useRef(!1);return a4(()=>{n.current=!0}),A.useCallback(async(i,a={})=>{ea(n.current,i4),n.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var LE={};function s4(t,e,n){!e&&!LE[t]&&(LE[t]=!0,ea(!1,n))}A.memo(HI);function HI({routes:t,future:e,state:n,isStatic:r,onError:i}){return OI(t,void 0,{state:n,isStatic:r,onError:i})}function VI({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){qn(!Bd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),c=A.useMemo(()=>({basename:s,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[s,i,a,o]);typeof n=="string"&&(n=Rc(n));let{pathname:d="/",search:h="",hash:p="",state:x=null,key:v="default",unstable_mask:b}=n,C=A.useMemo(()=>{let E=no(d,s);return E==null?null:{location:{pathname:E,search:h,hash:p,state:x,key:v,unstable_mask:b},navigationType:r}},[s,d,h,p,x,v,r,b]);return ea(C!=null,`<Router basename="${s}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:A.createElement(Bi.Provider,{value:c},A.createElement(S0.Provider,{children:e,value:C}))}var Uh="get",Hh="application/x-www-form-urlencoded";function A0(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function $I(t){return A0(t)&&t.tagName.toLowerCase()==="button"}function GI(t){return A0(t)&&t.tagName.toLowerCase()==="form"}function WI(t){return A0(t)&&t.tagName.toLowerCase()==="input"}function qI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function XI(t,e){return t.button===0&&(!e||e==="_self")&&!qI(t)}var mh=null;function KI(){if(mh===null)try{new FormData(document.createElement("form"),0),mh=!1}catch{mh=!0}return mh}var YI=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yg(t){return t!=null&&!YI.has(t)?(ea(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Hh}"`),null):t}function ZI(t,e){let n,r,i,a,o;if(GI(t)){let s=t.getAttribute("action");r=s?no(s,e):null,n=t.getAttribute("method")||Uh,i=yg(t.getAttribute("enctype"))||Hh,a=new FormData(t)}else if($I(t)||WI(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||s.getAttribute("action");if(r=c?no(c,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Uh,i=yg(t.getAttribute("formenctype"))||yg(s.getAttribute("enctype"))||Hh,a=new FormData(s,t),!KI()){let{name:d,type:h,value:p}=t;if(h==="image"){let x=d?`${d}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else d&&a.append(d,p)}}else{if(A0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Uh,r=null,i=Hh,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cy(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function JI(t,e,n,r){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&no(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function QI(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function eD(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function tD(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await QI(a,n);return o.links?o.links():[]}return[]}));return aD(r.flat(1).filter(eD).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function jE(t,e,n,r,i,a){let o=(c,d)=>n[d]?c.route.id!==n[d].route.id:!0,s=(c,d)=>{var h;return n[d].pathname!==c.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,d)=>o(c,d)||s(c,d)):a==="data"?e.filter((c,d)=>{var p;let h=r.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,d)||s(c,d))return!0;if(c.route.shouldRevalidate){let x=c.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function nD(t,e,{includeHydrateFallback:n}={}){return rD(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function rD(t){return[...new Set(t)]}function iD(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function aD(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(iD(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function l4(){let t=A.useContext(Lc);return cy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function oD(){let t=A.useContext(E0);return cy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var uy=A.createContext(void 0);uy.displayName="FrameworkContext";function c4(){let t=A.useContext(uy);return cy(t,"You must render this element inside a <HydratedRouter> element"),t}function sD(t,e){let n=A.useContext(uy),[r,i]=A.useState(!1),[a,o]=A.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,x=A.useRef(null);A.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let C=S=>{S.forEach(N=>{o(N.isIntersecting)})},E=new IntersectionObserver(C,{threshold:.5});return x.current&&E.observe(x.current),()=>{E.disconnect()}}},[t]),A.useEffect(()=>{if(r){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[r]);let v=()=>{i(!0)},b=()=>{i(!1),o(!1)};return n?t!=="intent"?[a,x,{}]:[a,x,{onFocus:Lu(s,v),onBlur:Lu(c,b),onMouseEnter:Lu(d,v),onMouseLeave:Lu(h,b),onTouchStart:Lu(p,v)}]:[!1,x,{}]}function Lu(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function lD({page:t,...e}){let{router:n}=l4(),r=A.useMemo(()=>K_(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?A.createElement(uD,{page:t,matches:r,...e}):null}function cD(t){let{manifest:e,routeModules:n}=c4(),[r,i]=A.useState([]);return A.useEffect(()=>{let a=!1;return tD(t,e,n).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,n]),r}function uD({page:t,matches:e,...n}){let r=us(),{future:i,manifest:a,routeModules:o}=c4(),{basename:s}=l4(),{loaderData:c,matches:d}=oD(),h=A.useMemo(()=>jE(t,e,d,a,r,"data"),[t,e,d,a,r]),p=A.useMemo(()=>jE(t,e,d,a,r,"assets"),[t,e,d,a,r]),x=A.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let C=new Set,E=!1;if(e.forEach(N=>{var I;let k=a.routes[N.route.id];!k||!k.hasLoader||(!h.some(D=>D.route.id===N.route.id)&&N.route.id in c&&((I=o[N.route.id])!=null&&I.shouldRevalidate)||k.hasClientLoader?E=!0:C.add(N.route.id))}),C.size===0)return[];let S=JI(t,s,i.unstable_trailingSlashAwareDataRequests,"data");return E&&C.size>0&&S.searchParams.set("_routes",e.filter(N=>C.has(N.route.id)).map(N=>N.route.id).join(",")),[S.pathname+S.search]},[s,i.unstable_trailingSlashAwareDataRequests,c,r,a,h,e,t,o]),v=A.useMemo(()=>nD(p,a),[p,a]),b=cD(p);return A.createElement(A.Fragment,null,x.map(C=>A.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),v.map(C=>A.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),b.map(({key:C,link:E})=>A.createElement("link",{key:C,nonce:n.nonce,...E,crossOrigin:E.crossOrigin??n.crossOrigin})))}function dD(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var fD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fD&&(window.__reactRouterVersion="7.13.1")}catch{}function hD({basename:t,children:e,unstable_useTransitions:n,window:r}){let i=A.useRef();i.current==null&&(i.current=qO({window:r,v5Compat:!0}));let a=i.current,[o,s]=A.useState({action:a.action,location:a.location}),c=A.useCallback(d=>{n===!1?s(d):A.startTransition(()=>s(d))},[n]);return A.useLayoutEffect(()=>a.listen(c),[a,c]),A.createElement(VI,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:n})}var u4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,d4=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,unstable_mask:s,state:c,target:d,to:h,preventScrollReset:p,viewTransition:x,unstable_defaultShouldRevalidate:v,...b},C){let{basename:E,navigator:S,unstable_useTransitions:N}=A.useContext(Bi),k=typeof h=="string"&&u4.test(h),I=e4(h,E);h=I.to;let D=NI(h,{relative:i}),L=us(),O=null;if(s){let xe=ay(s,[],L.unstable_mask?L.unstable_mask.pathname:"/",!0);E!=="/"&&(xe.pathname=xe.pathname==="/"?E:xa([E,xe.pathname])),O=S.createHref(xe)}let[j,U,fe]=sD(r,b),le=xD(h,{replace:o,unstable_mask:s,state:c,target:d,preventScrollReset:p,relative:i,viewTransition:x,unstable_defaultShouldRevalidate:v,unstable_useTransitions:N});function q(xe){e&&e(xe),xe.defaultPrevented||le(xe)}let de=!(I.isExternal||a),ge=A.createElement("a",{...b,...fe,href:(de?O:void 0)||I.absoluteURL||D,onClick:de?q:e,ref:dD(C,U),target:d,"data-discover":!k&&n==="render"?"true":void 0});return j&&!k?A.createElement(A.Fragment,null,ge,A.createElement(lD,{page:D})):ge});d4.displayName="Link";var pD=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:s,children:c,...d},h){let p=Fd(o,{relative:d.relative}),x=us(),v=A.useContext(E0),{navigator:b,basename:C}=A.useContext(Bi),E=v!=null&&CD(p)&&s===!0,S=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,N=x.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(N=N.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&C&&(k=no(k,C)||k);const I=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let D=N===S||!i&&N.startsWith(S)&&N.charAt(I)==="/",L=k!=null&&(k===S||!i&&k.startsWith(S)&&k.charAt(S.length)==="/"),O={isActive:D,isPending:L,isTransitioning:E},j=D?e:void 0,U;typeof r=="function"?U=r(O):U=[r,D?"active":null,L?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let fe=typeof a=="function"?a(O):a;return A.createElement(d4,{...d,"aria-current":j,className:U,ref:h,style:fe,to:o,viewTransition:s},typeof c=="function"?c(O):c)});pD.displayName="NavLink";var mD=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:o=Uh,action:s,onSubmit:c,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x,...v},b)=>{let{unstable_useTransitions:C}=A.useContext(Bi),E=bD(),S=wD(s,{relative:d}),N=o.toLowerCase()==="get"?"get":"post",k=typeof s=="string"&&u4.test(s),I=D=>{if(c&&c(D),D.defaultPrevented)return;D.preventDefault();let L=D.nativeEvent.submitter,O=(L==null?void 0:L.getAttribute("formmethod"))||o,j=()=>E(L||D.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:x});C&&n!==!1?A.startTransition(()=>j()):j()};return A.createElement("form",{ref:b,method:N,action:S,onSubmit:r?c:I,...v,"data-discover":!k&&t==="render"?"true":void 0})});mD.displayName="Form";function gD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f4(t){let e=A.useContext(Lc);return qn(e,gD(t)),e}function xD(t,{target:e,replace:n,unstable_mask:r,state:i,preventScrollReset:a,relative:o,viewTransition:s,unstable_defaultShouldRevalidate:c,unstable_useTransitions:d}={}){let h=kI(),p=us(),x=Fd(t,{relative:o});return A.useCallback(v=>{if(XI(v,e)){v.preventDefault();let b=n!==void 0?n:xd(p)===xd(x),C=()=>h(t,{replace:b,unstable_mask:r,state:i,preventScrollReset:a,relative:o,viewTransition:s,unstable_defaultShouldRevalidate:c});d?A.startTransition(()=>C()):C()}},[p,h,x,n,r,i,e,t,a,o,s,c,d])}var vD=0,yD=()=>`__${String(++vD)}__`;function bD(){let{router:t}=f4("useSubmit"),{basename:e}=A.useContext(Bi),n=FI(),r=t.fetch,i=t.navigate;return A.useCallback(async(a,o={})=>{let{action:s,method:c,encType:d,formData:h,body:p}=ZI(a,e);if(o.navigate===!1){let x=o.fetcherKey||yD();await r(x,n,o.action||s,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||c,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||s,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||c,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,n])}function wD(t,{relative:e}={}){let{basename:n}=A.useContext(Bi),r=A.useContext(oo);qn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...Fd(t||".",{relative:e})},o=us();if(t==null){a.search=o.search;let s=new URLSearchParams(a.search),c=s.getAll("index");if(c.some(h=>h==="")){s.delete("index"),c.filter(p=>p).forEach(p=>s.append("index",p));let h=s.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:xa([n,a.pathname])),xd(a)}function CD(t,{relative:e}={}){let n=A.useContext(n4);qn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=f4("useViewTransitionState"),i=Fd(t,{relative:e});if(!n.isTransitioning)return!1;let a=no(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=no(n.nextLocation.pathname,r)||n.nextLocation.pathname;return op(i.pathname,o)!=null||op(i.pathname,a)!=null}var ac=X_();const ED=C0(ac),SD="modulepreload",AD=function(t){return"/"+t},PE={},ol=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let o=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=o(n.map(d=>{if(d=AD(d),d in PE)return;PE[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":SD,h||(x.as="script"),x.crossOrigin="",x.href=d,c&&x.setAttribute("nonce",c),document.head.appendChild(x),h)return new Promise((v,b)=>{x.addEventListener("load",v),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ND=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),BE=t=>{const e=ND(t);return e.charAt(0).toUpperCase()+e.slice(1)},h4=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),kD=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=A.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...s},c)=>A.createElement("svg",{ref:c,...TD,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:h4("lucide",i),...!a&&!kD(s)&&{"aria-hidden":"true"},...s},[...o.map(([d,h])=>A.createElement(d,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=(t,e)=>{const n=A.forwardRef(({className:r,...i},a)=>A.createElement(OD,{ref:a,iconNode:e,className:h4(`lucide-${_D(BE(t))}`,`lucide-${t}`,r),...i}));return n.displayName=BE(t),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],p4=Oe("arrow-left",ID);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],MD=Oe("arrow-up-down",DD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],LD=Oe("bold",RD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jD=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Zs=Oe("book-open",jD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],dy=Oe("book",PD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],FE=Oe("bot",BD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],zD=Oe("brain",FD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xc=Oe("calendar",UD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],vc=Oe("camera",HD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],fy=Oe("check",VD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$s=Oe("chevron-down",$D);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Qo=Oe("chevron-left",GD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],m4=Oe("chevron-right",WD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],g4=Oe("chevron-up",qD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],yc=Oe("circle-alert",XD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],vd=Oe("circle-check-big",KD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ZD=Oe("circle-question-mark",YD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],QD=Oe("clock-3",JD);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tM=Oe("clock",eM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],rM=Oe("columns-3",nM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],x4=Oe("compass",iM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],oM=Oe("database",aM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],lM=Oe("download",sM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],uM=Oe("eraser",cM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],_0=Oe("external-link",dM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zE=Oe("eye",fM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],v4=Oe("file-braces",hM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],mM=Oe("file-search",pM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],zd=Oe("file-text",gM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],vM=Oe("folder-plus",xM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],UE=Oe("folder",yM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],wM=Oe("funnel",bM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CM=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],EM=Oe("gauge",CM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],N0=Oe("globe",SM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],HE=Oe("grip-vertical",AM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],sp=Oe("hash",_M);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],kM=Oe("heading-1",NM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],OM=Oe("heading-2",TM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],VE=Oe("image",IM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],MM=Oe("info",DM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],LM=Oe("italic",RM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],PM=Oe("layers",jM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],y4=Oe("layout-panel-left",BM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],b4=Oe("library",FM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],$E=Oe("link",zM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],GE=Oe("list-filter",UM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],VM=Oe("list-ordered",HM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],GM=Oe("list",$M);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],kn=Oe("loader-circle",WM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],XM=Oe("log-out",qM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],YM=Oe("map-pin",KM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],JM=Oe("menu",ZM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Wx=Oe("message-circle",QM);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],tR=Oe("moon",eR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],rR=Oe("palette",nR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],lp=Oe("pen-tool",iR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],cp=Oe("pen",aR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],WE=Oe("pencil-line",oR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],lR=Oe("pencil",sR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],w4=Oe("play",cR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qx=Oe("plus",uR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],yd=Oe("quote",dR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],C4=Oe("rotate-ccw",fR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],pR=Oe("rows-3",hR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],gR=Oe("save",mR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],vR=Oe("scan-line",xR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ka=Oe("search",yR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],wR=Oe("send",bR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],bg=Oe("settings-2",CR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],SR=Oe("skip-forward",ER);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],_R=Oe("sliders-horizontal",AR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Qa=Oe("sparkles",NR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],TR=Oe("square-check-big",kR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],IR=Oe("square",OR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Zl=Oe("star",DR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],bc=Oe("sticky-note",MR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],LR=Oe("sun",RR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],PR=Oe("table-2",jR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],FR=Oe("thumbs-down",BR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],UR=Oe("thumbs-up",zR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Js=Oe("trash-2",HR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ko=Oe("triangle-alert",VR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],GR=Oe("type",$R);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],qR=Oe("underline",WR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],up=Oe("upload",XR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hy=Oe("user",KR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ZR=Oe("wand-sparkles",YR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ta=Oe("x",JR),k0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function jc(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function py(t){return"nodeType"in t}function $r(t){var e,n;return t?jc(t)?t:py(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function my(t){const{Document:e}=$r(t);return t instanceof e}function Ud(t){return jc(t)?!1:t instanceof $r(t).HTMLElement}function E4(t){return t instanceof $r(t).SVGElement}function Pc(t){return t?jc(t)?t.document:py(t)?my(t)?t:Ud(t)||E4(t)?t.ownerDocument:document:document:document}const ro=k0?A.useLayoutEffect:A.useEffect;function T0(t){const e=A.useRef(t);return ro(()=>{e.current=t}),A.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function QR(){const t=A.useRef(null),e=A.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=A.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function bd(t,e){e===void 0&&(e=[t]);const n=A.useRef(t);return ro(()=>{n.current!==t&&(n.current=t)},e),n}function Hd(t,e){const n=A.useRef();return A.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function dp(t){const e=T0(t),n=A.useRef(null),r=A.useCallback(i=>{i!==n.current&&(e==null||e(i,n.current)),n.current=i},[]);return[n,r]}function fp(t){const e=A.useRef();return A.useEffect(()=>{e.current=t},[t]),e.current}let wg={};function O0(t,e){return A.useMemo(()=>{if(e)return e;const n=wg[t]==null?0:wg[t]+1;return wg[t]=n,t+"-"+n},[t,e])}function S4(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((a,o)=>{const s=Object.entries(o);for(const[c,d]of s){const h=a[c];h!=null&&(a[c]=h+t*d)}return a},{...e})}}const uc=S4(1),hp=S4(-1);function e7(t){return"clientX"in t&&"clientY"in t}function gy(t){if(!t)return!1;const{KeyboardEvent:e}=$r(t.target);return e&&t instanceof e}function t7(t){if(!t)return!1;const{TouchEvent:e}=$r(t.target);return e&&t instanceof e}function pp(t){if(t7(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return e7(t)?{x:t.clientX,y:t.clientY}:null}const wc=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[wc.Translate.toString(t),wc.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),qE="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function n7(t){return t.matches(qE)?t:t.querySelector(qE)}const r7={display:"none"};function i7(t){let{id:e,value:n}=t;return Qe.createElement("div",{id:e,style:r7},n)}function a7(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Qe.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function o7(){const[t,e]=A.useState("");return{announce:A.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const A4=A.createContext(null);function s7(t){const e=A.useContext(A4);A.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function l7(){const[t]=A.useState(()=>new Set),e=A.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[A.useCallback(r=>{let{type:i,event:a}=r;t.forEach(o=>{var s;return(s=o[i])==null?void 0:s.call(o,a)})},[t]),e]}const c7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},u7={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function d7(t){let{announcements:e=u7,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=c7}=t;const{announce:a,announcement:o}=o7(),s=O0("DndLiveRegion"),[c,d]=A.useState(!1);if(A.useEffect(()=>{d(!0)},[]),s7(A.useMemo(()=>({onDragStart(p){let{active:x}=p;a(e.onDragStart({active:x}))},onDragMove(p){let{active:x,over:v}=p;e.onDragMove&&a(e.onDragMove({active:x,over:v}))},onDragOver(p){let{active:x,over:v}=p;a(e.onDragOver({active:x,over:v}))},onDragEnd(p){let{active:x,over:v}=p;a(e.onDragEnd({active:x,over:v}))},onDragCancel(p){let{active:x,over:v}=p;a(e.onDragCancel({active:x,over:v}))}}),[a,e])),!c)return null;const h=Qe.createElement(Qe.Fragment,null,Qe.createElement(i7,{id:r,value:i.draggable}),Qe.createElement(a7,{id:s,announcement:o}));return n?ac.createPortal(h,n):h}var Vn;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Vn||(Vn={}));function mp(){}function XE(t,e){return A.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function f7(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return A.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const na=Object.freeze({x:0,y:0});function h7(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function p7(t,e){const n=pp(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function m7(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function g7(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function x7(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function KE(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const v7=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=KE(e,e.left,e.top),a=[];for(const o of r){const{id:s}=o,c=n.get(s);if(c){const d=h7(KE(c),i);a.push({id:s,data:{droppableContainer:o,value:d}})}}return a.sort(m7)};function y7(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),o=i-r,s=a-n;if(r<i&&n<a){const c=e.width*e.height,d=t.width*t.height,h=o*s,p=h/(c+d-h);return Number(p.toFixed(4))}return 0}const b7=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=[];for(const a of r){const{id:o}=a,s=n.get(o);if(s){const c=y7(s,e);c>0&&i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(g7)};function w7(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function _4(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:na}function C7(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i.reduce((o,s)=>({...o,top:o.top+t*s.y,bottom:o.bottom+t*s.y,left:o.left+t*s.x,right:o.right+t*s.x}),{...n})}}const E7=C7(1);function N4(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function S7(t,e,n){const r=N4(e);if(!r)return t;const{scaleX:i,scaleY:a,x:o,y:s}=r,c=t.left-o-(1-i)*parseFloat(n),d=t.top-s-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),h=i?t.width/i:t.width,p=a?t.height/a:t.height;return{width:h,height:p,top:d,right:c+h,bottom:d+p,left:c}}const A7={ignoreTransform:!1};function Vd(t,e){e===void 0&&(e=A7);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:d,transformOrigin:h}=$r(t).getComputedStyle(t);d&&(n=S7(n,d,h))}const{top:r,left:i,width:a,height:o,bottom:s,right:c}=n;return{top:r,left:i,width:a,height:o,bottom:s,right:c}}function YE(t){return Vd(t,{ignoreTransform:!0})}function _7(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function N7(t,e){return e===void 0&&(e=$r(t).getComputedStyle(t)),e.position==="fixed"}function k7(t,e){e===void 0&&(e=$r(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?n.test(a):!1})}function xy(t,e){const n=[];function r(i){if(e!=null&&n.length>=e||!i)return n;if(my(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Ud(i)||E4(i)||n.includes(i))return n;const a=$r(t).getComputedStyle(i);return i!==t&&k7(i,a)&&n.push(i),N7(i,a)?n:r(i.parentNode)}return t?r(t):n}function k4(t){const[e]=xy(t,1);return e??null}function Cg(t){return!k0||!t?null:jc(t)?t:py(t)?my(t)||t===Pc(t).scrollingElement?window:Ud(t)?t:null:null}function T4(t){return jc(t)?t.scrollX:t.scrollLeft}function O4(t){return jc(t)?t.scrollY:t.scrollTop}function Xx(t){return{x:T4(t),y:O4(t)}}var Qn;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Qn||(Qn={}));function I4(t){return!k0||!t?!1:t===document.scrollingElement}function D4(t){const e={x:0,y:0},n=I4(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,o=t.scrollTop>=r.y,s=t.scrollLeft>=r.x;return{isTop:i,isLeft:a,isBottom:o,isRight:s,maxScroll:r,minScroll:e}}const T7={x:.2,y:.2};function O7(t,e,n,r,i){let{top:a,left:o,right:s,bottom:c}=n;r===void 0&&(r=10),i===void 0&&(i=T7);const{isTop:d,isBottom:h,isLeft:p,isRight:x}=D4(t),v={x:0,y:0},b={x:0,y:0},C={height:e.height*i.y,width:e.width*i.x};return!d&&a<=e.top+C.height?(v.y=Qn.Backward,b.y=r*Math.abs((e.top+C.height-a)/C.height)):!h&&c>=e.bottom-C.height&&(v.y=Qn.Forward,b.y=r*Math.abs((e.bottom-C.height-c)/C.height)),!x&&s>=e.right-C.width?(v.x=Qn.Forward,b.x=r*Math.abs((e.right-C.width-s)/C.width)):!p&&o<=e.left+C.width&&(v.x=Qn.Backward,b.x=r*Math.abs((e.left+C.width-o)/C.width)),{direction:v,speed:b}}function I7(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:e,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function M4(t){return t.reduce((e,n)=>uc(e,Xx(n)),na)}function D7(t){return t.reduce((e,n)=>e+T4(n),0)}function M7(t){return t.reduce((e,n)=>e+O4(n),0)}function R4(t,e){if(e===void 0&&(e=Vd),!t)return;const{top:n,left:r,bottom:i,right:a}=e(t);k4(t)&&(i<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const R7=[["x",["left","right"],D7],["y",["top","bottom"],M7]];class vy{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=xy(n),i=M4(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,o,s]of R7)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=s(r),h=i[a]-d;return this.rect[c]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ed{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var i;(i=this.target)==null||i.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function L7(t){const{EventTarget:e}=$r(t);return t instanceof e?t:Pc(t)}function Eg(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Ii;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Ii||(Ii={}));function ZE(t){t.preventDefault()}function j7(t){t.stopPropagation()}var Wt;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Wt||(Wt={}));const L4={start:[Wt.Space,Wt.Enter],cancel:[Wt.Esc],end:[Wt.Space,Wt.Enter,Wt.Tab]},P7=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Wt.Right:return{...n,x:n.x+25};case Wt.Left:return{...n,x:n.x-25};case Wt.Down:return{...n,y:n.y+25};case Wt.Up:return{...n,y:n.y-25}}};class j4{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new ed(Pc(n)),this.windowListeners=new ed($r(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ii.Resize,this.handleCancel),this.windowListeners.add(Ii.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ii.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&R4(r),n(na)}handleKeyDown(e){if(gy(e)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:a=L4,coordinateGetter:o=P7,scrollBehavior:s="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:d}=r.current,h=d?{x:d.left,y:d.top}:na;this.referenceCoordinates||(this.referenceCoordinates=h);const p=o(e,{active:n,context:r.current,currentCoordinates:h});if(p){const x=hp(p,h),v={x:0,y:0},{scrollableAncestors:b}=r.current;for(const C of b){const E=e.code,{isTop:S,isRight:N,isLeft:k,isBottom:I,maxScroll:D,minScroll:L}=D4(C),O=I7(C),j={x:Math.min(E===Wt.Right?O.right-O.width/2:O.right,Math.max(E===Wt.Right?O.left:O.left+O.width/2,p.x)),y:Math.min(E===Wt.Down?O.bottom-O.height/2:O.bottom,Math.max(E===Wt.Down?O.top:O.top+O.height/2,p.y))},U=E===Wt.Right&&!N||E===Wt.Left&&!k,fe=E===Wt.Down&&!I||E===Wt.Up&&!S;if(U&&j.x!==p.x){const le=C.scrollLeft+x.x,q=E===Wt.Right&&le<=D.x||E===Wt.Left&&le>=L.x;if(q&&!x.y){C.scrollTo({left:le,behavior:s});return}q?v.x=C.scrollLeft-le:v.x=E===Wt.Right?C.scrollLeft-D.x:C.scrollLeft-L.x,v.x&&C.scrollBy({left:-v.x,behavior:s});break}else if(fe&&j.y!==p.y){const le=C.scrollTop+x.y,q=E===Wt.Down&&le<=D.y||E===Wt.Up&&le>=L.y;if(q&&!x.x){C.scrollTo({top:le,behavior:s});return}q?v.y=C.scrollTop-le:v.y=E===Wt.Down?C.scrollTop-D.y:C.scrollTop-L.y,v.y&&C.scrollBy({top:-v.y,behavior:s});break}}this.handleMove(e,uc(hp(p,this.referenceCoordinates),v))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}j4.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=L4,onActivation:i}=e,{active:a}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const s=a.activatorNode.current;return s&&t.target!==s?!1:(t.preventDefault(),i==null||i({event:t.nativeEvent}),!0)}return!1}}];function JE(t){return!!(t&&"distance"in t)}function QE(t){return!!(t&&"delay"in t)}class yy{constructor(e,n,r){var i;r===void 0&&(r=L7(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:a}=e,{target:o}=a;this.props=e,this.events=n,this.document=Pc(o),this.documentListeners=new ed(this.document),this.listeners=new ed(r),this.windowListeners=new ed($r(o)),this.initialCoordinates=(i=pp(a))!=null?i:na,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Ii.Resize,this.handleCancel),this.windowListeners.add(Ii.DragStart,ZE),this.windowListeners.add(Ii.VisibilityChange,this.handleCancel),this.windowListeners.add(Ii.ContextMenu,ZE),this.documentListeners.add(Ii.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(QE(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(JE(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Ii.Click,j7,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ii.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:i,props:a}=this,{onMove:o,options:{activationConstraint:s}}=a;if(!i)return;const c=(n=pp(e))!=null?n:na,d=hp(i,c);if(!r&&s){if(JE(s)){if(s.tolerance!=null&&Eg(d,s.tolerance))return this.handleCancel();if(Eg(d,s.distance))return this.handleStart()}if(QE(s)&&Eg(d,s.tolerance))return this.handleCancel();this.handlePending(s,d);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Wt.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const B7={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class by extends yy{constructor(e){const{event:n}=e,r=Pc(n.target);super(e,B7,r)}}by.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const F7={move:{name:"mousemove"},end:{name:"mouseup"}};var Kx;(function(t){t[t.RightClick=2]="RightClick"})(Kx||(Kx={}));class z7 extends yy{constructor(e){super(e,F7,Pc(e.event.target))}}z7.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Kx.RightClick?!1:(r==null||r({event:n}),!0)}}];const Sg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class P4 extends yy{constructor(e){super(e,Sg)}static setup(){return window.addEventListener(Sg.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Sg.move.name,e)};function e(){}}}P4.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var td;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(td||(td={}));var gp;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(gp||(gp={}));function U7(t){let{acceleration:e,activator:n=td.Pointer,canScroll:r,draggingRect:i,enabled:a,interval:o=5,order:s=gp.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:h,delta:p,threshold:x}=t;const v=V7({delta:p,disabled:!a}),[b,C]=QR(),E=A.useRef({x:0,y:0}),S=A.useRef({x:0,y:0}),N=A.useMemo(()=>{switch(n){case td.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case td.DraggableRect:return i}},[n,i,c]),k=A.useRef(null),I=A.useCallback(()=>{const L=k.current;if(!L)return;const O=E.current.x*S.current.x,j=E.current.y*S.current.y;L.scrollBy(O,j)},[]),D=A.useMemo(()=>s===gp.TreeOrder?[...d].reverse():d,[s,d]);A.useEffect(()=>{if(!a||!d.length||!N){C();return}for(const L of D){if((r==null?void 0:r(L))===!1)continue;const O=d.indexOf(L),j=h[O];if(!j)continue;const{direction:U,speed:fe}=O7(L,j,N,e,x);for(const le of["x","y"])v[le][U[le]]||(fe[le]=0,U[le]=0);if(fe.x>0||fe.y>0){C(),k.current=L,b(I,o),E.current=fe,S.current=U;return}}E.current={x:0,y:0},S.current={x:0,y:0},C()},[e,I,r,C,a,o,JSON.stringify(N),JSON.stringify(v),b,d,D,h,JSON.stringify(x)])}const H7={x:{[Qn.Backward]:!1,[Qn.Forward]:!1},y:{[Qn.Backward]:!1,[Qn.Forward]:!1}};function V7(t){let{delta:e,disabled:n}=t;const r=fp(e);return Hd(i=>{if(n||!r||!i)return H7;const a={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Qn.Backward]:i.x[Qn.Backward]||a.x===-1,[Qn.Forward]:i.x[Qn.Forward]||a.x===1},y:{[Qn.Backward]:i.y[Qn.Backward]||a.y===-1,[Qn.Forward]:i.y[Qn.Forward]||a.y===1}}},[n,e,r])}function $7(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return Hd(i=>{var a;return e==null?null:(a=r??i)!=null?a:null},[r,e])}function G7(t,e){return A.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,a=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,r)}));return[...n,...a]},[]),[t,e])}var wd;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(wd||(wd={}));var Yx;(function(t){t.Optimized="optimized"})(Yx||(Yx={}));const eS=new Map;function W7(t,e){let{dragging:n,dependencies:r,config:i}=e;const[a,o]=A.useState(null),{frequency:s,measure:c,strategy:d}=i,h=A.useRef(t),p=E(),x=bd(p),v=A.useCallback(function(S){S===void 0&&(S=[]),!x.current&&o(N=>N===null?S:N.concat(S.filter(k=>!N.includes(k))))},[x]),b=A.useRef(null),C=Hd(S=>{if(p&&!n)return eS;if(!S||S===eS||h.current!==t||a!=null){const N=new Map;for(let k of t){if(!k)continue;if(a&&a.length>0&&!a.includes(k.id)&&k.rect.current){N.set(k.id,k.rect.current);continue}const I=k.node.current,D=I?new vy(c(I),I):null;k.rect.current=D,D&&N.set(k.id,D)}return N}return S},[t,a,n,p,c]);return A.useEffect(()=>{h.current=t},[t]),A.useEffect(()=>{p||v()},[n,p]),A.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),A.useEffect(()=>{p||typeof s!="number"||b.current!==null||(b.current=setTimeout(()=>{v(),b.current=null},s))},[s,p,v,...r]),{droppableRects:C,measureDroppableContainers:v,measuringScheduled:a!=null};function E(){switch(d){case wd.Always:return!1;case wd.BeforeDragging:return n;default:return!n}}}function wy(t,e){return Hd(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function q7(t,e){return wy(t,e)}function X7(t){let{callback:e,disabled:n}=t;const r=T0(e),i=A.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return A.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function I0(t){let{callback:e,disabled:n}=t;const r=T0(e),i=A.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return A.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function K7(t){return new vy(Vd(t),t)}function tS(t,e,n){e===void 0&&(e=K7);const[r,i]=A.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=c??n)!=null?d:null}const h=e(t);return JSON.stringify(c)===JSON.stringify(h)?c:h})}const o=X7({callback(c){if(t)for(const d of c){const{type:h,target:p}=d;if(h==="childList"&&p instanceof HTMLElement&&p.contains(t)){a();break}}}}),s=I0({callback:a});return ro(()=>{a(),t?(s==null||s.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),o==null||o.disconnect())},[t]),r}function Y7(t){const e=wy(t);return _4(t,e)}const nS=[];function Z7(t){const e=A.useRef(t),n=Hd(r=>t?r&&r!==nS&&t&&e.current&&t.parentNode===e.current.parentNode?r:xy(t):nS,[t]);return A.useEffect(()=>{e.current=t},[t]),n}function J7(t){const[e,n]=A.useState(null),r=A.useRef(t),i=A.useCallback(a=>{const o=Cg(a.target);o&&n(s=>s?(s.set(o,Xx(o)),new Map(s)):null)},[]);return A.useEffect(()=>{const a=r.current;if(t!==a){o(a);const s=t.map(c=>{const d=Cg(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,Xx(d)]):null}).filter(c=>c!=null);n(s.length?new Map(s):null),r.current=t}return()=>{o(t),o(a)};function o(s){s.forEach(c=>{const d=Cg(c);d==null||d.removeEventListener("scroll",i)})}},[i,t]),A.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,o)=>uc(a,o),na):M4(t):na,[t,e])}function rS(t,e){e===void 0&&(e=[]);const n=A.useRef(null);return A.useEffect(()=>{n.current=null},e),A.useEffect(()=>{const r=t!==na;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?hp(t,n.current):na}function Q7(t){A.useEffect(()=>{if(!k0)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function e9(t,e){return A.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:a}=r;return n[i]=o=>{a(o,e)},n},{}),[t,e])}function B4(t){return A.useMemo(()=>t?_7(t):null,[t])}const iS=[];function t9(t,e){e===void 0&&(e=Vd);const[n]=t,r=B4(n?$r(n):null),[i,a]=A.useState(iS);function o(){a(()=>t.length?t.map(c=>I4(c)?r:new vy(e(c),c)):iS)}const s=I0({callback:o});return ro(()=>{s==null||s.disconnect(),o(),t.forEach(c=>s==null?void 0:s.observe(c))},[t]),i}function F4(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Ud(e)?e:t}function n9(t){let{measure:e}=t;const[n,r]=A.useState(null),i=A.useCallback(d=>{for(const{target:h}of d)if(Ud(h)){r(p=>{const x=e(h);return p?{...p,width:x.width,height:x.height}:x});break}},[e]),a=I0({callback:i}),o=A.useCallback(d=>{const h=F4(d);a==null||a.disconnect(),h&&(a==null||a.observe(h)),r(h?e(h):null)},[e,a]),[s,c]=dp(o);return A.useMemo(()=>({nodeRef:s,rect:n,setRef:c}),[n,s,c])}const r9=[{sensor:by,options:{}},{sensor:j4,options:{}}],i9={current:{}},Vh={draggable:{measure:YE},droppable:{measure:YE,strategy:wd.WhileDragging,frequency:Yx.Optimized},dragOverlay:{measure:Vd}};class nd extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const a9={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new nd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:mp},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Vh,measureDroppableContainers:mp,windowRect:null,measuringScheduled:!1},z4={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:mp,draggableNodes:new Map,over:null,measureDroppableContainers:mp},$d=A.createContext(z4),U4=A.createContext(a9);function o9(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new nd}}}function s9(t,e){switch(e.type){case Vn.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Vn.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Vn.DragEnd:case Vn.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Vn.RegisterDroppable:{const{element:n}=e,{id:r}=n,i=new nd(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Vn.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=e,a=t.droppable.containers.get(n);if(!a||r!==a.key)return t;const o=new nd(t.droppable.containers);return o.set(n,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Vn.UnregisterDroppable:{const{id:n,key:r}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const a=new nd(t.droppable.containers);return a.delete(n),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function l9(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:i}=A.useContext($d),a=fp(r),o=fp(n==null?void 0:n.id);return A.useEffect(()=>{if(!e&&!r&&a&&o!=null){if(!gy(a)||document.activeElement===a.target)return;const s=i.get(o);if(!s)return;const{activatorNode:c,node:d}=s;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[c.current,d.current]){if(!h)continue;const p=n7(h);if(p){p.focus();break}}})}},[r,e,i,o,a]),null}function H4(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...r}),n):n}function c9(t){return A.useMemo(()=>({draggable:{...Vh.draggable,...t==null?void 0:t.draggable},droppable:{...Vh.droppable,...t==null?void 0:t.droppable},dragOverlay:{...Vh.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function u9(t){let{activeNode:e,measure:n,initialRect:r,config:i=!0}=t;const a=A.useRef(!1),{x:o,y:s}=typeof i=="boolean"?{x:i,y:i}:i;ro(()=>{if(!o&&!s||!e){a.current=!1;return}if(a.current||!r)return;const d=e==null?void 0:e.node.current;if(!d||d.isConnected===!1)return;const h=n(d),p=_4(h,r);if(o||(p.x=0),s||(p.y=0),a.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const x=k4(d);x&&x.scrollBy({top:p.y,left:p.x})}},[e,o,s,r,n])}const D0=A.createContext({...na,scaleX:1,scaleY:1});var Bo;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Bo||(Bo={}));const d9=A.memo(function(e){var n,r,i,a;let{id:o,accessibility:s,autoScroll:c=!0,children:d,sensors:h=r9,collisionDetection:p=b7,measuring:x,modifiers:v,...b}=e;const C=A.useReducer(s9,void 0,o9),[E,S]=C,[N,k]=l7(),[I,D]=A.useState(Bo.Uninitialized),L=I===Bo.Initialized,{draggable:{active:O,nodes:j,translate:U},droppable:{containers:fe}}=E,le=O!=null?j.get(O):null,q=A.useRef({initial:null,translated:null}),de=A.useMemo(()=>{var At;return O!=null?{id:O,data:(At=le==null?void 0:le.data)!=null?At:i9,rect:q}:null},[O,le]),ge=A.useRef(null),[xe,H]=A.useState(null),[ie,K]=A.useState(null),B=bd(b,Object.values(b)),G=O0("DndDescribedBy",o),M=A.useMemo(()=>fe.getEnabled(),[fe]),V=c9(x),{droppableRects:Z,measureDroppableContainers:re,measuringScheduled:_e}=W7(M,{dragging:L,dependencies:[U.x,U.y],config:V.droppable}),J=$7(j,O),we=A.useMemo(()=>ie?pp(ie):null,[ie]),z=vi(),ae=q7(J,V.draggable.measure);u9({activeNode:O!=null?j.get(O):null,config:z.layoutShiftCompensation,initialRect:ae,measure:V.draggable.measure});const ce=tS(J,V.draggable.measure,ae),Te=tS(J?J.parentElement:null),Le=A.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:Z,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:fe,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ot=fe.getNodeFor((n=Le.current.over)==null?void 0:n.id),Ke=n9({measure:V.dragOverlay.measure}),ht=(r=Ke.nodeRef.current)!=null?r:J,Ut=L?(i=Ke.rect)!=null?i:ce:null,Me=!!(Ke.nodeRef.current&&Ke.rect),We=Y7(Me?null:ce),Pe=B4(ht?$r(ht):null),Se=Z7(L?ot??J:null),fn=t9(Se),An=H4(v,{transform:{x:U.x-We.x,y:U.y-We.y,scaleX:1,scaleY:1},activatorEvent:ie,active:de,activeNodeRect:ce,containerNodeRect:Te,draggingNodeRect:Ut,over:Le.current.over,overlayNodeRect:Ke.rect,scrollableAncestors:Se,scrollableAncestorRects:fn,windowRect:Pe}),Mr=we?uc(we,U):null,rn=J7(Se),Fi=rS(rn),or=rS(rn,[ce]),sr=uc(An,Fi),St=Ut?E7(Ut,An):null,Er=de&&St?p({active:de,collisionRect:St,droppableRects:Z,droppableContainers:M,pointerCoordinates:Mr}):null,zi=x7(Er,"id"),[lr,xi]=A.useState(null),Gr=Me?An:uc(An,or),xn=w7(Gr,(a=lr==null?void 0:lr.rect)!=null?a:null,ce),cr=A.useRef(null),Tn=A.useCallback((At,Ht)=>{let{sensor:Kt,options:Vt}=Ht;if(ge.current==null)return;const vt=j.get(ge.current);if(!vt)return;const Yt=At.nativeEvent,Xn=new Kt({active:ge.current,activeNode:vt,event:Yt,options:Vt,context:Le,onAbort(vn){if(!j.get(vn))return;const{onDragAbort:Kn}=B.current,Sr={id:vn};Kn==null||Kn(Sr),N({type:"onDragAbort",event:Sr})},onPending(vn,Rr,Kn,Sr){if(!j.get(vn))return;const{onDragPending:$}=B.current,X={id:vn,constraint:Rr,initialCoordinates:Kn,offset:Sr};$==null||$(X),N({type:"onDragPending",event:X})},onStart(vn){const Rr=ge.current;if(Rr==null)return;const Kn=j.get(Rr);if(!Kn)return;const{onDragStart:Sr}=B.current,In={activatorEvent:Yt,active:{id:Rr,data:Kn.data,rect:q}};ac.unstable_batchedUpdates(()=>{Sr==null||Sr(In),D(Bo.Initializing),S({type:Vn.DragStart,initialCoordinates:vn,active:Rr}),N({type:"onDragStart",event:In}),H(cr.current),K(Yt)})},onMove(vn){S({type:Vn.DragMove,coordinates:vn})},onEnd:ur(Vn.DragEnd),onCancel:ur(Vn.DragCancel)});cr.current=Xn;function ur(vn){return async function(){const{active:Kn,collisions:Sr,over:In,scrollAdjustedTranslate:$}=Le.current;let X=null;if(Kn&&$){const{cancelDrop:Ae}=B.current;X={activatorEvent:Yt,active:Kn,collisions:Sr,delta:$,over:In},vn===Vn.DragEnd&&typeof Ae=="function"&&await Promise.resolve(Ae(X))&&(vn=Vn.DragCancel)}ge.current=null,ac.unstable_batchedUpdates(()=>{S({type:vn}),D(Bo.Uninitialized),xi(null),H(null),K(null),cr.current=null;const Ae=vn===Vn.DragEnd?"onDragEnd":"onDragCancel";if(X){const Ce=B.current[Ae];Ce==null||Ce(X),N({type:Ae,event:X})}})}}},[j]),xs=A.useCallback((At,Ht)=>(Kt,Vt)=>{const vt=Kt.nativeEvent,Yt=j.get(Vt);if(ge.current!==null||!Yt||vt.dndKit||vt.defaultPrevented)return;const Xn={active:Yt};At(Kt,Ht.options,Xn)===!0&&(vt.dndKit={capturedBy:Ht.sensor},ge.current=Vt,Tn(Kt,Ht))},[j,Tn]),On=G7(h,xs);Q7(h),ro(()=>{ce&&I===Bo.Initializing&&D(Bo.Initialized)},[ce,I]),A.useEffect(()=>{const{onDragMove:At}=B.current,{active:Ht,activatorEvent:Kt,collisions:Vt,over:vt}=Le.current;if(!Ht||!Kt)return;const Yt={active:Ht,activatorEvent:Kt,collisions:Vt,delta:{x:sr.x,y:sr.y},over:vt};ac.unstable_batchedUpdates(()=>{At==null||At(Yt),N({type:"onDragMove",event:Yt})})},[sr.x,sr.y]),A.useEffect(()=>{const{active:At,activatorEvent:Ht,collisions:Kt,droppableContainers:Vt,scrollAdjustedTranslate:vt}=Le.current;if(!At||ge.current==null||!Ht||!vt)return;const{onDragOver:Yt}=B.current,Xn=Vt.get(zi),ur=Xn&&Xn.rect.current?{id:Xn.id,rect:Xn.rect.current,data:Xn.data,disabled:Xn.disabled}:null,vn={active:At,activatorEvent:Ht,collisions:Kt,delta:{x:vt.x,y:vt.y},over:ur};ac.unstable_batchedUpdates(()=>{xi(ur),Yt==null||Yt(vn),N({type:"onDragOver",event:vn})})},[zi]),ro(()=>{Le.current={activatorEvent:ie,active:de,activeNode:J,collisionRect:St,collisions:Er,droppableRects:Z,draggableNodes:j,draggingNode:ht,draggingNodeRect:Ut,droppableContainers:fe,over:lr,scrollableAncestors:Se,scrollAdjustedTranslate:sr},q.current={initial:Ut,translated:St}},[de,J,Er,St,j,ht,Ut,Z,fe,lr,Se,sr]),U7({...z,delta:U,draggingRect:St,pointerCoordinates:Mr,scrollableAncestors:Se,scrollableAncestorRects:fn});const aa=A.useMemo(()=>({active:de,activeNode:J,activeNodeRect:ce,activatorEvent:ie,collisions:Er,containerNodeRect:Te,dragOverlay:Ke,draggableNodes:j,droppableContainers:fe,droppableRects:Z,over:lr,measureDroppableContainers:re,scrollableAncestors:Se,scrollableAncestorRects:fn,measuringConfiguration:V,measuringScheduled:_e,windowRect:Pe}),[de,J,ce,ie,Er,Te,Ke,j,fe,Z,lr,re,Se,fn,V,_e,Pe]),Wr=A.useMemo(()=>({activatorEvent:ie,activators:On,active:de,activeNodeRect:ce,ariaDescribedById:{draggable:G},dispatch:S,draggableNodes:j,over:lr,measureDroppableContainers:re}),[ie,On,de,ce,S,G,j,lr,re]);return Qe.createElement(A4.Provider,{value:k},Qe.createElement($d.Provider,{value:Wr},Qe.createElement(U4.Provider,{value:aa},Qe.createElement(D0.Provider,{value:xn},d)),Qe.createElement(l9,{disabled:(s==null?void 0:s.restoreFocus)===!1})),Qe.createElement(d7,{...s,hiddenTextDescribedById:G}));function vi(){const At=(xe==null?void 0:xe.autoScrollEnabled)===!1,Ht=typeof c=="object"?c.enabled===!1:c===!1,Kt=L&&!At&&!Ht;return typeof c=="object"?{...c,enabled:Kt}:{enabled:Kt}}}),f9=A.createContext(null),aS="button",h9="Draggable";function p9(t){let{id:e,data:n,disabled:r=!1,attributes:i}=t;const a=O0(h9),{activators:o,activatorEvent:s,active:c,activeNodeRect:d,ariaDescribedById:h,draggableNodes:p,over:x}=A.useContext($d),{role:v=aS,roleDescription:b="draggable",tabIndex:C=0}=i??{},E=(c==null?void 0:c.id)===e,S=A.useContext(E?D0:f9),[N,k]=dp(),[I,D]=dp(),L=e9(o,e),O=bd(n);ro(()=>(p.set(e,{id:e,key:a,node:N,activatorNode:I,data:O}),()=>{const U=p.get(e);U&&U.key===a&&p.delete(e)}),[p,e]);const j=A.useMemo(()=>({role:v,tabIndex:C,"aria-disabled":r,"aria-pressed":E&&v===aS?!0:void 0,"aria-roledescription":b,"aria-describedby":h.draggable}),[r,v,C,E,b,h.draggable]);return{active:c,activatorEvent:s,activeNodeRect:d,attributes:j,isDragging:E,listeners:r?void 0:L,node:N,over:x,setNodeRef:k,setActivatorNodeRef:D,transform:S}}function m9(){return A.useContext(U4)}const g9="Droppable",x9={timeout:25};function v9(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const a=O0(g9),{active:o,dispatch:s,over:c,measureDroppableContainers:d}=A.useContext($d),h=A.useRef({disabled:n}),p=A.useRef(!1),x=A.useRef(null),v=A.useRef(null),{disabled:b,updateMeasurementsFor:C,timeout:E}={...x9,...i},S=bd(C??r),N=A.useCallback(()=>{if(!p.current){p.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{d(Array.isArray(S.current)?S.current:[S.current]),v.current=null},E)},[E]),k=I0({callback:N,disabled:b||!o}),I=A.useCallback((j,U)=>{k&&(U&&(k.unobserve(U),p.current=!1),j&&k.observe(j))},[k]),[D,L]=dp(I),O=bd(e);return A.useEffect(()=>{!k||!D.current||(k.disconnect(),p.current=!1,k.observe(D.current))},[D,k]),A.useEffect(()=>(s({type:Vn.RegisterDroppable,element:{id:r,key:a,disabled:n,node:D,rect:x,data:O}}),()=>s({type:Vn.UnregisterDroppable,key:a,id:r})),[r]),A.useEffect(()=>{n!==h.current.disabled&&(s({type:Vn.SetDroppableDisabled,id:r,key:a,disabled:n}),h.current.disabled=n)},[r,a,n,s]),{active:o,rect:x,isOver:(c==null?void 0:c.id)===r,node:D,over:c,setNodeRef:L}}function y9(t){let{animation:e,children:n}=t;const[r,i]=A.useState(null),[a,o]=A.useState(null),s=fp(n);return!n&&!r&&s&&i(s),ro(()=>{if(!a)return;const c=r==null?void 0:r.key,d=r==null?void 0:r.props.id;if(c==null||d==null){i(null);return}Promise.resolve(e(d,a)).then(()=>{i(null)})},[e,r,a]),Qe.createElement(Qe.Fragment,null,n,r?A.cloneElement(r,{ref:o}):null)}const b9={x:0,y:0,scaleX:1,scaleY:1};function w9(t){let{children:e}=t;return Qe.createElement($d.Provider,{value:z4},Qe.createElement(D0.Provider,{value:b9},e))}const C9={position:"fixed",touchAction:"none"},E9=t=>gy(t)?"transform 250ms ease":void 0,S9=A.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:i,children:a,className:o,rect:s,style:c,transform:d,transition:h=E9}=t;if(!s)return null;const p=i?d:{...d,scaleX:1,scaleY:1},x={...C9,width:s.width,height:s.height,top:s.top,left:s.left,transform:wc.Transform.toString(p),transformOrigin:i&&r?p7(r,s):void 0,transition:typeof h=="function"?h(r):h,...c};return Qe.createElement(n,{className:o,style:x,ref:e},a)}),A9=t=>e=>{let{active:n,dragOverlay:r}=e;const i={},{styles:a,className:o}=t;if(a!=null&&a.active)for(const[s,c]of Object.entries(a.active))c!==void 0&&(i[s]=n.node.style.getPropertyValue(s),n.node.style.setProperty(s,c));if(a!=null&&a.dragOverlay)for(const[s,c]of Object.entries(a.dragOverlay))c!==void 0&&r.node.style.setProperty(s,c);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&r.node.classList.add(o.dragOverlay),function(){for(const[c,d]of Object.entries(i))n.node.style.setProperty(c,d);o!=null&&o.active&&n.node.classList.remove(o.active)}},_9=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:wc.Transform.toString(e)},{transform:wc.Transform.toString(n)}]},N9={duration:250,easing:"ease",keyframes:_9,sideEffects:A9({styles:{active:{opacity:"0"}}})};function k9(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:i}=t;return T0((a,o)=>{if(e===null)return;const s=n.get(a);if(!s)return;const c=s.node.current;if(!c)return;const d=F4(o);if(!d)return;const{transform:h}=$r(o).getComputedStyle(o),p=N4(h);if(!p)return;const x=typeof e=="function"?e:T9(e);return R4(c,i.draggable.measure),x({active:{id:a,data:s.data,node:c,rect:i.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:i.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:i,transform:p})})}function T9(t){const{duration:e,easing:n,sideEffects:r,keyframes:i}={...N9,...t};return a=>{let{active:o,dragOverlay:s,transform:c,...d}=a;if(!e)return;const h={x:s.rect.left-o.rect.left,y:s.rect.top-o.rect.top},p={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/s.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/s.rect.height:1},x={x:c.x-h.x,y:c.y-h.y,...p},v=i({...d,active:o,dragOverlay:s,transform:{initial:c,final:x}}),[b]=v,C=v[v.length-1];if(JSON.stringify(b)===JSON.stringify(C))return;const E=r==null?void 0:r({active:o,dragOverlay:s,...d}),S=s.node.animate(v,{duration:e,easing:n,fill:"forwards"});return new Promise(N=>{S.onfinish=()=>{E==null||E(),N()}})}}let oS=0;function O9(t){return A.useMemo(()=>{if(t!=null)return oS++,oS},[t])}const I9=Qe.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:i,transition:a,modifiers:o,wrapperElement:s="div",className:c,zIndex:d=999}=t;const{activatorEvent:h,active:p,activeNodeRect:x,containerNodeRect:v,draggableNodes:b,droppableContainers:C,dragOverlay:E,over:S,measuringConfiguration:N,scrollableAncestors:k,scrollableAncestorRects:I,windowRect:D}=m9(),L=A.useContext(D0),O=O9(p==null?void 0:p.id),j=H4(o,{activatorEvent:h,active:p,activeNodeRect:x,containerNodeRect:v,draggingNodeRect:E.rect,over:S,overlayNodeRect:E.rect,scrollableAncestors:k,scrollableAncestorRects:I,transform:L,windowRect:D}),U=wy(x),fe=k9({config:r,draggableNodes:b,droppableContainers:C,measuringConfiguration:N}),le=U?E.setRef:void 0;return Qe.createElement(w9,null,Qe.createElement(y9,{animation:fe},p&&O?Qe.createElement(S9,{key:O,id:p.id,ref:le,as:s,activatorEvent:h,adjustScale:e,className:c,transition:a,rect:U,style:{zIndex:d,...i},transform:j},n):null))});function D9(t,e,n){const r={...t};return e.top+t.y<=n.top?r.y=n.top-e.top:e.bottom+t.y>=n.top+n.height&&(r.y=n.top+n.height-e.bottom),e.left+t.x<=n.left?r.x=n.left-e.left:e.right+t.x>=n.left+n.width&&(r.x=n.left+n.width-e.right),r}const sS=t=>{let{transform:e,draggingNodeRect:n,windowRect:r}=t;return!n||!r?e:D9(e,n,r)},M9=4,xp=["Felsefe","Sosyoloji","Psikoloji","Bilim ve Teknoloji","Din ve nan","Tarih","nceleme ve Aratrma","Ekonomi ve Hukuk","Trk Edebiyat","Dnya Edebiyat","Sanat ve Kltr","Dier"],lS=({activeCategory:t,onCategoryChange:e,categories:n=xp})=>m.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[m.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[m.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Discovery Areas"]}),m.jsxs("div",{className:"space-y-1",children:[m.jsxs("button",{onClick:()=>e(null),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===null?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[m.jsx("span",{className:t===null?"text-card-foreground":"text-card-foreground/80",children:"All Categories"}),t===null&&m.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]}),n.map(r=>m.jsxs("button",{onClick:()=>e(r),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===r?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[m.jsx("span",{className:t===r?"text-card-foreground":"text-card-foreground/80",children:r}),t===r&&m.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r))]})]}),V4=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("defs",{children:m.jsxs("linearGradient",{id:"kb-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[m.jsx("stop",{offset:"0%",stopColor:"#CC561E"}),m.jsx("stop",{offset:"100%",stopColor:"#A44319"})]})}),m.jsx("rect",{x:"2",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"}),m.jsx("rect",{x:"9",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),m.jsx("rect",{x:"16",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),m.jsx("rect",{x:"2",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),m.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)"}),m.jsx("rect",{x:"16",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),m.jsx("rect",{x:"2",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),m.jsx("rect",{x:"9",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),m.jsx("rect",{x:"16",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"})]}),$4=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("path",{d:"M12 20H21",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M16.5 3.5C17.3284 2.67157 18.6716 2.67157 19.5 3.5C20.3284 4.32843 20.3284 5.67157 19.5 6.5L7 19L3 20L4 16L16.5 3.5Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),m.jsx("path",{d:"M15 5L19 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),Zx=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("rect",{x:"3",y:"6",width:"4",height:"12",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("path",{d:"M4 9H6",stroke:"#CC561E",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.4"}),m.jsx("rect",{x:"8",y:"4",width:"4",height:"14",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.3"}),m.jsx("path",{d:"M9 7H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),m.jsx("path",{d:"M9 15H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),m.jsx("rect",{x:"13",y:"7",width:"4",height:"11",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("rect",{x:"18",y:"5",width:"4",height:"13",rx:"0.5",transform:"rotate(12 18 5)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.8"}),m.jsx("path",{d:"M2 19H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.3"})]}),$h=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("path",{d:"M4 4H14L20 10V20H4V4Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),m.jsx("path",{d:"M14 4V10H20",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),m.jsx("path",{d:"M8 14H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M8 17H12",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),Gh=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("circle",{cx:"11",cy:"11",r:"9",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),m.jsx("ellipse",{cx:"11",cy:"11",rx:"3.5",ry:"9",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),m.jsx("path",{d:"M2 11H20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),m.jsx("path",{d:"M11 2V20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),m.jsx("path",{d:"M16 14L22 17L19 18L21 21L19 22L17 19L14 22V14Z",fill:"#CC561E",stroke:"#000",strokeWidth:"0.5"})]}),G4=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("rect",{x:"5",y:"5",width:"14",height:"15",rx:"1.5",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.3",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("path",{d:"M3 4C3 3.44772 3.44772 3 4 3H19C19.5523 3 20 3.44772 20 4V20C20 20.5523 19.5523 21 19 21H4C3.44772 21 3 20.5523 3 20V4Z",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.15"}),m.jsx("path",{d:"M5 1V5M9 1V5M13 1V5M17 1V5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M7 9H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),m.jsx("path",{d:"M7 12H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),m.jsx("path",{d:"M7 15H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),m.jsx("path",{d:"M16 21L20 17",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),oQ=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("path",{d:"M6 20V14",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),m.jsx("path",{d:"M12 20V10",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),m.jsx("path",{d:"M18 20V5",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),m.jsx("path",{d:"M4 14L10 8L15 13L21 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M21 4H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M21 4V9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),sQ=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("rect",{x:"5",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("rect",{x:"13",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("rect",{x:"5",y:"13",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("rect",{x:"16",y:"13",width:"6",height:"6",rx:"2",transform:"rotate(45 16 16)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"})]}),lQ=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.8"}),m.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.5"}),m.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"#CC561E",fillOpacity:"0.8"}),m.jsx("path",{d:"M19 5L13.5 10.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M19 5L20 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M19 5L15 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),cQ=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("path",{d:"M21 8V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.05"}),m.jsx("path",{d:"M23 3H1V8H23V3Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("rect",{x:"10",y:"12",width:"4",height:"2",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("path",{d:"M7 16H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"}),m.jsx("path",{d:"M7 19H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"})]}),vp=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"#CC561E",strokeWidth:"2.5",fill:"#CC561E",fillOpacity:"0.05"}),m.jsx("path",{d:"M14.5 7.5C14.5 7.5 13.5 6.5 11 6.5",stroke:"#fff",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.7"}),m.jsx("circle",{cx:"11",cy:"11",r:"4",stroke:"#CC561E",strokeWidth:"1",strokeOpacity:"0.3"}),m.jsx("path",{d:"M16 16L20 20",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),m.jsx("path",{d:"M17 17L19 19",stroke:"#fff",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.5"}),m.jsx("circle",{cx:"18",cy:"6",r:"1.5",fill:"#CC561E",fillOpacity:"0.8"}),m.jsx("circle",{cx:"21",cy:"9",r:"1",fill:"#CC561E",fillOpacity:"0.4"})]}),W4=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("rect",{x:"4",y:"6",width:"16",height:"15",rx:"4",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),m.jsx("path",{d:"M12 6V3",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),m.jsx("circle",{cx:"12",cy:"3",r:"2",stroke:"#CC561E",strokeWidth:"1.5"}),m.jsx("circle",{cx:"12",cy:"3",r:"0.5",fill:"#CC561E"}),m.jsx("rect",{x:"7",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),m.jsx("rect",{x:"14",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),m.jsx("path",{d:"M9 16C9 16 10 17 12 17C14 17 15 16 15 16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:"0.6"}),m.jsx("path",{d:"M2 13H4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"}),m.jsx("path",{d:"M20 13H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),R9=({className:t,size:e=24})=>m.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[m.jsx("path",{d:"M2 6C6 6 6 10 10 10C14 10 14 6 18 6C20 6 21 7 22 8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.05"}),m.jsx("path",{d:"M2 12C6 12 6 16 10 16C14 16 14 12 18 12C20 12 21 13 22 14",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.1"}),m.jsx("path",{d:"M2 18C6 18 6 22 10 22C14 22 14 18 18 18C20 18 21 19 22 20",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.2"}),m.jsx("path",{d:"M10 4V20",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"2 4",strokeOpacity:"0.5"})]});function M0(t){const e=typeof t=="string"?t.trim().toLowerCase():"";return e==="insight"||e==="note"?"insight":"highlight"}function q4(t){return M0(t)==="insight"}const X4="PRIVATE";function R0(t){const e=typeof t=="string"?t.trim().toUpperCase():"";return e==="DAILY"?"DAILY":e==="IDEAS"?"IDEAS":X4}function gn(t){return t.type==="PERSONAL_NOTE"}function Nr(t){return gn(t)?R0(t.personalNoteCategory):X4}function K4(t){return gn(t)&&Nr(t)==="IDEAS"}function Y4(t){return K4(t)?"INSIGHT":"PERSONAL_NOTE"}function Z4(t){return typeof t!="string"?void 0:t.trim().replace(/\s+/g," ")||void 0}function J4(t){return typeof t!="string"?void 0:t.trim()||void 0}const L9=/<\/?[a-z][\s\S]*>/i,Q4=t=>L9.test(t),Ls=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),js=t=>t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(.+?)__/g,"<u>$1</u>").replace(/_(.+?)_/g,"<em>$1</em>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,'<code class="px-1 py-0.5 rounded bg-slate-100 text-slate-700">$1</code>'),j9=t=>{if(typeof window>"u")return t;const n=new DOMParser().parseFromString(t,"text/html");return n.querySelectorAll("script,style,iframe,object,embed").forEach(r=>r.remove()),n.body.querySelectorAll("*").forEach(r=>{[...r.attributes].forEach(i=>{const a=i.name.toLowerCase(),o=i.value.toLowerCase();a.startsWith("on")&&r.removeAttribute(i.name),(a==="href"||a==="src")&&o.startsWith("javascript:")&&r.removeAttribute(i.name)})}),n.body.innerHTML},Cc=t=>{if(!t)return"";if(Q4(t)){const e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/(p|div|li|h1|h2|h3|h4|h5|h6|blockquote|pre|tr|td|th|ul|ol)>/gi,`
`);return typeof window<"u"?(new DOMParser().parseFromString(e,"text/html").body.textContent||"").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).trim():e.replace(/<[^>]*>/g," ").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]{2,}/g," ").trim()}return t.replace(/^#{1,6}\s+/gm,"").replace(/^\s*-\s\[(?: |x|X)\]\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/^\s*>\s?/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\s+\n/g,`
`).trim()},yp=t=>Cc(t).trim().length>0,Cy=t=>{if(!yp(t))return'<p class="text-slate-400 italic">No content added.</p>';if(Q4(t))return j9(t);const e=t.split(`
`);let n="",r=null;const i=()=>{r&&(n+=`</${r}>`,r=null)};for(const a of e){if(!a.trim()){i(),n+='<div class="h-2"></div>';continue}const o=a.match(/^\s*#\s+(.+)/),s=a.match(/^\s*##\s+(.+)/),c=a.match(/^\s*-\s\[( |x|X)\]\s+(.+)/),d=a.match(/^\s*-\s+(.+)/),h=a.match(/^\s*\d+\.\s+(.+)/),p=a.match(/^\s*>\s+(.+)/);if(o){i(),n+=`<h1 class="text-xl font-bold mt-3 mb-1.5">${js(Ls(o[1]))}</h1>`;continue}if(s){i(),n+=`<h2 class="text-lg font-semibold mt-3 mb-1.5">${js(Ls(s[1]))}</h2>`;continue}if(p){i(),n+=`<blockquote class="border-l-2 border-[#CC561E]/40 pl-3 italic text-slate-600 my-1">${js(Ls(p[1]))}</blockquote>`;continue}if(c){r!=="ul"&&(i(),r="ul",n+='<ul class="space-y-1 my-1">');const x=c[1].toLowerCase()==="x";n+=`<li class="text-sm flex items-start gap-2"><span class="mt-0.5">${x?"&#9745;":"&#9744;"}</span><span>${js(Ls(c[2]))}</span></li>`;continue}if(d){r!=="ul"&&(i(),r="ul",n+='<ul class="list-disc pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${js(Ls(d[1]))}</li>`;continue}if(h){r!=="ol"&&(i(),r="ol",n+='<ol class="list-decimal pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${js(Ls(h[1]))}</li>`;continue}i(),n+=`<p class="text-sm leading-relaxed my-1">${js(Ls(a.trim()))}</p>`}return i(),n};var Ag={exports:{}},_g={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function P9(){if(cS)return _g;cS=1;var t=Pd();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function s(p,x){var v=x(),b=r({inst:{value:v,getSnapshot:x}}),C=b[0].inst,E=b[1];return a(function(){C.value=v,C.getSnapshot=x,c(C)&&E({inst:C})},[p,v,x]),i(function(){return c(C)&&E({inst:C}),p(function(){c(C)&&E({inst:C})})},[p]),o(v),v}function c(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!n(p,v)}catch{return!0}}function d(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:s;return _g.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,_g}var uS;function eN(){return uS||(uS=1,Ag.exports=P9()),Ag.exports}var tN=eN();function xr(t){this.content=t}xr.prototype={constructor:xr,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),a=r.content.slice();return i==-1?a.push(n||t,e):(a[i+1]=e,n&&(a[i]=n)),new xr(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new xr(n)},addToStart:function(t,e){return new xr([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new xr(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),a=r.find(t);return i.splice(a==-1?i.length:a,0,e,n),new xr(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=xr.from(t),t.size?new xr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=xr.from(t),t.size?new xr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=xr.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};xr.from=function(t){if(t instanceof xr)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new xr(e)};function nN(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),a=e.child(r);if(i==a){n+=i.nodeSize;continue}if(!i.sameMarkup(a))return n;if(i.isText&&i.text!=a.text){for(let o=0;i.text[o]==a.text[o];o++)n++;return n}if(i.content.size||a.content.size){let o=nN(i.content,a.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function rN(t,e,n,r){for(let i=t.childCount,a=e.childCount;;){if(i==0||a==0)return i==a?null:{a:n,b:r};let o=t.child(--i),s=e.child(--a),c=o.nodeSize;if(o==s){n-=c,r-=c;continue}if(!o.sameMarkup(s))return{a:n,b:r};if(o.isText&&o.text!=s.text){let d=0,h=Math.min(o.text.length,s.text.length);for(;d<h&&o.text[o.text.length-d-1]==s.text[s.text.length-d-1];)d++,n--,r--;return{a:n,b:r}}if(o.content.size||s.content.size){let d=rN(o.content,s.content,n-1,r-1);if(d)return d}n-=c,r-=c}}class be{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,a){for(let o=0,s=0;s<n;o++){let c=this.content[o],d=s+c.nodeSize;if(d>e&&r(c,i+s,a||null,o)!==!1&&c.content.size){let h=s+1;c.nodesBetween(Math.max(0,e-h),Math.min(c.content.size,n-h),r,i+h)}s=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let a="",o=!0;return this.nodesBetween(e,n,(s,c)=>{let d=s.isText?s.text.slice(Math.max(e,c)-c,n-c):s.isLeaf?i?typeof i=="function"?i(s):i:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&d||s.isTextblock)&&r&&(o?o=!1:a+=r),a+=d},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),a=1);a<e.content.length;a++)i.push(e.content[a]);return new be(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let a=0,o=0;o<n;a++){let s=this.content[a],c=o+s.nodeSize;c>e&&((o<e||c>n)&&(s.isText?s=s.cut(Math.max(0,e-o),Math.min(s.text.length,n-o)):s=s.cut(Math.max(0,e-o-1),Math.min(s.content.size,n-o-1))),r.push(s),i+=s.nodeSize),o=c}return new be(r,i)}cutByIndex(e,n){return e==n?be.empty:e==0&&n==this.content.length?this:new be(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),a=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new be(i,a)}addToStart(e){return new be([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new be(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return nN(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return rN(this,e,n,r)}findIndex(e){if(e==0)return gh(0,e);if(e==this.size)return gh(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),a=r+i.nodeSize;if(a>=e)return a==e?gh(n+1,a):gh(n,r);r=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return be.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new be(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return be.empty;let n,r=0;for(let i=0;i<e.length;i++){let a=e[i];r+=a.nodeSize,i&&a.isText&&e[i-1].sameMarkup(a)?(n||(n=e.slice(0,i)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new be(n||e,r)}static from(e){if(!e)return be.empty;if(e instanceof be)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new be([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}be.empty=new be([],0);const Ng={index:0,offset:0};function gh(t,e){return Ng.index=t,Ng.offset=e,Ng}function bp(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!bp(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!bp(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Xt=class Jx{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let a=e[i];if(this.eq(a))return e;if(this.type.excludes(a.type))n||(n=e.slice(0,i));else{if(a.type.excludes(this.type))return e;!r&&a.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(a)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&bp(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Jx.none;if(e instanceof Jx)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Xt.none=[];class wp extends Error{}class Re{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=aN(this.content,e+this.openStart,n);return r&&new Re(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Re(iN(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Re.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Re(be.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let a=e.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=e.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)i++;return new Re(e,r,i)}}Re.empty=new Re(be.empty,0,0);function iN(t,e,n){let{index:r,offset:i}=t.findIndex(e),a=t.maybeChild(r),{index:o,offset:s}=t.findIndex(n);if(i==e||a.isText){if(s!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,a.copy(iN(a.content,e-i-1,n-i-1)))}function aN(t,e,n,r){let{index:i,offset:a}=t.findIndex(e),o=t.maybeChild(i);if(a==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let s=aN(o.content,e-a-1,n,o);return s&&t.replaceChild(i,o.copy(s))}function B9(t,e,n){if(n.openStart>t.depth)throw new wp("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new wp("Inconsistent open depths");return oN(t,e,n,0)}function oN(t,e,n,r){let i=t.index(r),a=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=oN(t,e,n,r+1);return a.copy(a.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,s=o.content;return el(o,s.cut(0,t.parentOffset).append(n.content).append(s.cut(e.parentOffset)))}else{let{start:o,end:s}=F9(n,t);return el(a,lN(t,o,s,e,r))}else return el(a,Cp(t,e,r))}function sN(t,e){if(!e.type.compatibleContent(t.type))throw new wp("Cannot join "+e.type.name+" onto "+t.type.name)}function Qx(t,e,n){let r=t.node(n);return sN(r,e.node(n)),r}function Qs(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function rd(t,e,n,r){let i=(e||t).node(n),a=0,o=e?e.index(n):i.childCount;t&&(a=t.index(n),t.depth>n?a++:t.textOffset&&(Qs(t.nodeAfter,r),a++));for(let s=a;s<o;s++)Qs(i.child(s),r);e&&e.depth==n&&e.textOffset&&Qs(e.nodeBefore,r)}function el(t,e){return t.type.checkContent(e),t.copy(e)}function lN(t,e,n,r,i){let a=t.depth>i&&Qx(t,e,i+1),o=r.depth>i&&Qx(n,r,i+1),s=[];return rd(null,t,i,s),a&&o&&e.index(i)==n.index(i)?(sN(a,o),Qs(el(a,lN(t,e,n,r,i+1)),s)):(a&&Qs(el(a,Cp(t,e,i+1)),s),rd(e,n,i,s),o&&Qs(el(o,Cp(n,r,i+1)),s)),rd(r,null,i,s),new be(s)}function Cp(t,e,n){let r=[];if(rd(null,t,n,r),t.depth>n){let i=Qx(t,e,n+1);Qs(el(i,Cp(t,e,n+1)),r)}return rd(e,null,n,r),new be(r)}function F9(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let a=n-1;a>=0;a--)i=e.node(a).copy(be.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Cd{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let a=0;a<e;a++)i+=r.child(a).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Xt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let s=r;r=i,i=s}let a=r.marks;for(var o=0;o<a.length;o++)a[o].type.spec.inclusive===!1&&(!i||!a[o].isInSet(i.marks))&&(a=a[o--].removeFromSet(a));return a}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!i||!r[a].isInSet(i.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Ep(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,a=n;for(let o=e;;){let{index:s,offset:c}=o.content.findIndex(a),d=a-c;if(r.push(o,s,i+c),!d||(o=o.child(s),o.isText))break;a=d-1,i+=c+1}return new Cd(n,r,a)}static resolveCached(e,n){let r=dS.get(e);if(r)for(let a=0;a<r.elts.length;a++){let o=r.elts[a];if(o.pos==n)return o}else dS.set(e,r=new z9);let i=r.elts[r.i]=Cd.resolve(e,n);return r.i=(r.i+1)%U9,i}}class z9{constructor(){this.elts=[],this.i=0}}const U9=12,dS=new WeakMap;class Ep{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const H9=Object.create(null);class Ji{constructor(e,n,r,i=Xt.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||be.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&bp(this.attrs,n||e.defaultAttrs||H9)&&Xt.sameSet(this.marks,r||Xt.none)}copy(e=null){return e==this.content?this:new Ji(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ji(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return Re.empty;let i=this.resolve(e),a=this.resolve(n),o=r?0:i.sharedDepth(n),s=i.start(o),d=i.node(o).content.cut(i.pos-s,a.pos-s);return new Re(d,i.depth-o,a.depth-o)}replace(e,n,r){return B9(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Cd.resolveCached(this,e)}resolveNoCache(e){return Cd.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,a=>(r.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),cN(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=be.empty,i=0,a=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,a),s=o&&o.matchFragment(this.content,n);if(!s||!s.validEnd)return!1;for(let c=i;c<a;c++)if(!this.type.allowsMarks(r.child(c).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(e).matchType(r),o=a&&a.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Xt.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Xt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=be.fromJSON(e,n.content),a=e.nodeType(n.type).create(n.attrs,i,r);return a.type.checkAttrs(a.attrs),a}}Ji.prototype.text=void 0;class Sp extends Ji{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):cN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Sp(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Sp(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function cN(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class sl{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new V9(e,n);if(r.next==null)return sl.empty;let i=uN(r);r.next&&r.err("Unexpected trailing text");let a=Y9(K9(i));return Z9(a,r),a}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let a=n;i&&a<r;a++)i=i.matchType(e.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function a(o,s){let c=o.matchFragment(e,r);if(c&&(!n||c.validEnd))return be.from(s.map(d=>d.createAndFill()));for(let d=0;d<o.next.length;d++){let{type:h,next:p}=o.next[d];if(!(h.isText||h.hasRequiredAttrs())&&i.indexOf(p)==-1){i.push(p);let x=a(p,s.concat(h));if(x)return x}}return null}return a(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),a=i.match;if(a.matchType(e)){let o=[];for(let s=i;s.type;s=s.via)o.push(s.type);return o.reverse()}for(let o=0;o<a.next.length;o++){let{type:s,next:c}=a.next[o];!s.isLeaf&&!s.hasRequiredAttrs()&&!(s.name in n)&&(!i.type||c.validEnd)&&(r.push({match:s.contentMatch,type:s,via:i}),n[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let a=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)a+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return a}).join(`
`)}}sl.empty=new sl(!0);class V9{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function uN(t){let e=[];do e.push($9(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function $9(t){let e=[];do e.push(G9(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function G9(t){let e=X9(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=W9(t,e);else break;return e}function fS(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function W9(t,e){let n=fS(t),r=n;return t.eat(",")&&(t.next!="}"?r=fS(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function q9(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let a in n){let o=n[a];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function X9(t){if(t.eat("(")){let e=uN(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=q9(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function K9(t){let e=[[]];return i(a(t,0),n()),e;function n(){return e.push([])-1}function r(o,s,c){let d={term:c,to:s};return e[o].push(d),d}function i(o,s){o.forEach(c=>c.to=s)}function a(o,s){if(o.type=="choice")return o.exprs.reduce((c,d)=>c.concat(a(d,s)),[]);if(o.type=="seq")for(let c=0;;c++){let d=a(o.exprs[c],s);if(c==o.exprs.length-1)return d;i(d,s=n())}else if(o.type=="star"){let c=n();return r(s,c),i(a(o.expr,c),c),[r(c)]}else if(o.type=="plus"){let c=n();return i(a(o.expr,s),c),i(a(o.expr,c),c),[r(c)]}else{if(o.type=="opt")return[r(s)].concat(a(o.expr,s));if(o.type=="range"){let c=s;for(let d=0;d<o.min;d++){let h=n();i(a(o.expr,c),h),c=h}if(o.max==-1)i(a(o.expr,c),c);else for(let d=o.min;d<o.max;d++){let h=n();r(c,h),i(a(o.expr,c),h),c=h}return[r(c)]}else{if(o.type=="name")return[r(s,void 0,o.value)];throw new Error("Unknown expr type")}}}}function dN(t,e){return e-t}function hS(t,e){let n=[];return r(e),n.sort(dN);function r(i){let a=t[i];if(a.length==1&&!a[0].term)return r(a[0].to);n.push(i);for(let o=0;o<a.length;o++){let{term:s,to:c}=a[o];!s&&n.indexOf(c)==-1&&r(c)}}}function Y9(t){let e=Object.create(null);return n(hS(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:s,to:c})=>{if(!s)return;let d;for(let h=0;h<i.length;h++)i[h][0]==s&&(d=i[h][1]);hS(t,c).forEach(h=>{d||i.push([s,d=[]]),d.indexOf(h)==-1&&d.push(h)})})});let a=e[r.join(",")]=new sl(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let s=i[o][1].sort(dN);a.next.push({type:i[o][0],next:e[s.join(",")]||n(s)})}return a}}function Z9(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],a=!i.validEnd,o=[];for(let s=0;s<i.next.length;s++){let{type:c,next:d}=i.next[s];o.push(c.name),a&&!(c.isText||c.hasRequiredAttrs())&&(a=!1),r.indexOf(d)==-1&&r.push(d)}a&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function fN(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function hN(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let a=t[r];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function pN(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let a=t[i];a.validate&&a.validate(e[i])}}function mN(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new Q9(t,r,e[r]);return n}let pS=class gN{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=mN(e,r.attrs),this.defaultAttrs=fN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==sl.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:hN(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ji(this,this.computeAttrs(e),be.from(n),Xt.setFrom(r))}createChecked(e=null,n,r){return n=be.from(n),this.checkContent(n),new Ji(this,this.computeAttrs(e),n,Xt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=be.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),a=i&&i.fillBefore(be.empty,!0);return a?new Ji(this,e,n.append(a),Xt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){pN(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Xt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((a,o)=>r[a]=new gN(a,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function J9(t,e,n){let r=n.split("|");return i=>{let a=i===null?"null":typeof i;if(r.indexOf(a)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${a}`)}}class Q9{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?J9(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class L0{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=mN(e,i.attrs),this.excluded=null;let a=fN(this.attrs);this.instance=a?new Xt(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Xt(this,hN(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((a,o)=>r[a]=new L0(a,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){pN(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class xN{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=xr.from(e.nodes),n.marks=xr.from(e.marks||{}),this.nodes=pS.compile(this.spec.nodes,this),this.marks=L0.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],o=a.spec.content||"",s=a.spec.marks;if(a.contentMatch=r[o]||(r[o]=sl.parse(o,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=s=="_"?null:s?mS(this,s.split(" ")):s==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],o=a.spec.excludes;a.excluded=o==null?[a]:o==""?[]:mS(this,o.split(" "))}this.nodeFromJSON=i=>Ji.fromJSON(this,i),this.markFromJSON=i=>Xt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof pS){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Sp(r,r.defaultAttrs,e,Xt.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function mS(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],a=t.marks[i],o=a;if(a)n.push(a);else for(let s in t.marks){let c=t.marks[s];(i=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=c)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function eL(t){return t.tag!=null}function tL(t){return t.style!=null}let id=class ev{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(eL(i))this.tags.push(i);else if(tL(i)){let a=/[^=]*/.exec(i.style)[0];r.indexOf(a)<0&&r.push(a),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let a=e.nodes[i.node];return a.contentMatch.matchType(a)})}parse(e,n={}){let r=new xS(this,n,!1);return r.addAll(e,Xt.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new xS(this,n,!0);return r.addAll(e,Xt.none,n.from,n.to),Re.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(iL(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){let o=a.getAttrs(e);if(o===!1)continue;a.attrs=o||void 0}return a}}}matchStyle(e,n,r,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let o=this.styles[a],s=o.style;if(!(s.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||s.length>e.length&&(s.charCodeAt(e.length)!=61||s.slice(e.length+1)!=n))){if(o.getAttrs){let c=o.getAttrs(n);if(c===!1)continue;o.attrs=c||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let a=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let s=n[o];if((s.priority==null?50:s.priority)<a)break}n.splice(o,0,i)}for(let i in e.marks){let a=e.marks[i].spec.parseDOM;a&&a.forEach(o=>{r(o=vS(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let a=e.nodes[i].spec.parseDOM;a&&a.forEach(o=>{r(o=vS(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ev(e,ev.schemaRules(e)))}};const vN={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},nL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},yN={ol:!0,ul:!0},Ed=1,tv=2,ad=4;function gS(t,e,n){return e!=null?(e?Ed:0)|(e==="full"?tv:0):t&&t.whitespace=="pre"?Ed|tv:n&~ad}class xh{constructor(e,n,r,i,a,o){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=Xt.none,this.match=a||(o&ad?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(be.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ed)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let n=be.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(be.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!vN.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class xS{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,a,o=gS(null,n.preserveWhitespace,0)|(r?ad:0);i?a=new xh(i.type,i.attrs,Xt.none,!0,n.topMatch||i.type.contentMatch,o):r?a=new xh(null,null,Xt.none,!0,null,o):a=new xh(e.schema.topNodeType,null,Xt.none,!0,null,o),this.nodes=[a],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,a=i.options&tv?"full":this.localPreserveWS||(i.options&Ed)>0,{schema:o}=this.parser;if(a==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(a)if(a==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let s=r.split(/\r?\n|\r/);for(let c=0;c<s.length;c++)c&&this.insertNode(o.linebreakReplacement.create(),n,!0),s[c]&&this.insertNode(o.text(s[c]),n,!/\S/.test(s[c]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],c=e.previousSibling;(!s||c&&c.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),s;yN.hasOwnProperty(o)&&this.parser.normalizeLists&&rL(e);let c=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,r));e:if(c?c.ignore:nL.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(e=c.skip);let d,h=this.needsBlock;if(vN.hasOwnProperty(o))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),d=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let p=c&&c.skip?n:this.readStyles(e,n);p&&this.addAll(e,p),d&&this.sync(a),this.needsBlock=h}else{let d=this.readStyles(e,n);d&&this.addElementByRule(e,c,d,c.consuming===!1?s:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let a=this.parser.matchedStyles[i],o=r.getPropertyValue(a);if(o)for(let s=void 0;;){let c=this.parser.matchStyle(a,o,this,s);if(!c)break;if(c.ignore)return null;if(c.clearMark?n=n.filter(d=>!c.clearMark(d)):n=n.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)s=c;else break}}return n}addElementByRule(e,n,r,i){let a,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let c=this.enter(o,n.attrs||null,r,n.preserveWhitespace);c&&(a=!0,r=c)}else{let c=this.parser.schema.marks[n.mark];r=r.concat(c.create(n.attrs))}let s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(c=>this.insertNode(c,r,!1));else{let c=e;typeof n.contentElement=="string"?c=e.querySelector(n.contentElement):typeof n.contentElement=="function"?c=n.contentElement(e):n.contentElement&&(c=n.contentElement),this.findAround(e,c,!0),this.addAll(c,r),this.findAround(e,c,!1)}a&&this.sync(s)&&this.open--}addAll(e,n,r,i){let a=r||0;for(let o=r?e.childNodes[r]:e.firstChild,s=i==null?null:e.childNodes[i];o!=s;o=o.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(o,n);this.findAtPoint(e,a)}findPlace(e,n,r){let i,a;for(let o=this.open,s=0;o>=0;o--){let c=this.nodes[o],d=c.findWrapping(e);if(d&&(!i||i.length>d.length+s)&&(i=d,a=c,!d.length))break;if(c.solid){if(r)break;s+=2}}if(!i)return null;this.sync(a);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(n=this.enterInner(a,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let o=Xt.none;for(let s of i.concat(e.marks))(a.type?a.type.allowsMarkType(s.type):yS(s.type,e.type))&&(o=s.addToSet(o));return a.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let a=this.findPlace(e.create(n),r,!1);return a&&(a=this.enterInner(e,n,r,!0,i)),a}enterInner(e,n,r,i=!1,a){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let s=gS(e,a,o.options);o.options&ad&&o.content.length==0&&(s|=ad);let c=Xt.none;return r=r.filter(d=>(o.type?o.type.allowsMarkType(d.type):yS(d.type,e))?(c=d.addToSet(c),!1):!0),this.nodes.push(new xh(e,n,c,i,null,s)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Ed)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(i?0:1),o=(s,c)=>{for(;s>=0;s--){let d=n[s];if(d==""){if(s==n.length-1||s==0)continue;for(;c>=a;c--)if(o(s-1,c))return!0;return!1}else{let h=c>0||c==0&&i?this.nodes[c].type:r&&c>=a?r.node(c-a).type:null;if(!h||h.name!=d&&!h.isInGroup(d))return!1;c--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function rL(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&yN.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function iL(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function vS(t){let e={};for(let n in t)e[n]=t[n];return e}function yS(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let a=[],o=s=>{a.push(s);for(let c=0;c<s.edgeCount;c++){let{type:d,next:h}=s.edge(c);if(d==e||a.indexOf(h)<0&&o(h))return!0}};if(o(i.contentMatch))return!0}}class ml{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=kg(n).createDocumentFragment());let i=r,a=[];return e.forEach(o=>{if(a.length||o.marks.length){let s=0,c=0;for(;s<a.length&&c<o.marks.length;){let d=o.marks[c];if(!this.marks[d.type.name]){c++;continue}if(!d.eq(a[s][0])||d.type.spec.spanning===!1)break;s++,c++}for(;s<a.length;)i=a.pop()[1];for(;c<o.marks.length;){let d=o.marks[c++],h=this.serializeMark(d,o.isInline,n);h&&(a.push([d,i]),i.appendChild(h.dom),i=h.contentDOM||h.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=Wh(kg(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let a=this.serializeMark(e.marks[i],e.isInline,n);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&Wh(kg(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return Wh(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ml(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=bS(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return bS(e.marks)}}function bS(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function kg(t){return t.document||window.document}const wS=new WeakMap;function aL(t){let e=wS.get(t);return e===void 0&&wS.set(t,e=oL(t)),e}function oL(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function Wh(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(a=aL(r))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let s,c=n?t.createElementNS(n,i):t.createElement(i),d=e[1],h=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){h=2;for(let p in d)if(d[p]!=null){let x=p.indexOf(" ");x>0?c.setAttributeNS(p.slice(0,x),p.slice(x+1),d[p]):p=="style"&&c.style?c.style.cssText=d[p]:c.setAttribute(p,d[p])}}for(let p=h;p<e.length;p++){let x=e[p];if(x===0){if(p<e.length-1||p>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:v,contentDOM:b}=Wh(t,x,n,r);if(c.appendChild(v),b){if(s)throw new RangeError("Multiple content holes");s=b}}}return{dom:c,contentDOM:s}}const bN=65535,wN=Math.pow(2,16);function sL(t,e){return t+e*wN}function CS(t){return t&bN}function lL(t){return(t-(t&bN))/wN}const CN=1,EN=2,qh=4,SN=8;class nv{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&SN)>0}get deletedBefore(){return(this.delInfo&(CN|qh))>0}get deletedAfter(){return(this.delInfo&(EN|qh))>0}get deletedAcross(){return(this.delInfo&qh)>0}}class pi{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&pi.empty)return pi.empty}recover(e){let n=0,r=CS(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+lL(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,a=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let c=this.ranges[s]-(this.inverted?i:0);if(c>e)break;let d=this.ranges[s+a],h=this.ranges[s+o],p=c+d;if(e<=p){let x=d?e==c?-1:e==p?1:n:n,v=c+i+(x<0?0:h);if(r)return v;let b=e==(n<0?c:p)?null:sL(s/3,e-c),C=e==c?EN:e==p?CN:qh;return(n<0?e!=c:e!=p)&&(C|=SN),new nv(v,C,b)}i+=h-d}return r?e+i:new nv(e+i,0,null)}touches(e,n){let r=0,i=CS(n),a=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let c=this.ranges[s]-(this.inverted?r:0);if(c>e)break;let d=this.ranges[s+a],h=c+d;if(e<=h&&s==i*3)return!0;r+=this.ranges[s+o]-d}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let o=this.ranges[i],s=o-(this.inverted?a:0),c=o+(this.inverted?0:a),d=this.ranges[i+n],h=this.ranges[i+r];e(s,s+d,c,c+h),a+=h-d}}invert(){return new pi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?pi.empty:new pi(e<0?[0,-e,0]:[0,0,e])}}pi.empty=new pi([]);class Sd{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Sd(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Sd;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let a=this.from;a<this.to;a++){let o=this._maps[a],s=o.mapResult(e,n);if(s.recover!=null){let c=this.getMirror(a);if(c!=null&&c>a&&c<this.to){a=c,e=this._maps[c].recover(s.recover);continue}}i|=s.delInfo,e=s.pos}return r?e:new nv(e,i,null)}}const Tg=Object.create(null);class Ir{getMap(){return pi.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Tg[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Tg)throw new RangeError("Duplicate use of step JSON ID "+e);return Tg[e]=n,n.prototype.jsonID=e,n}}class Pn{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Pn(e,null)}static fail(e){return new Pn(null,e)}static fromReplace(e,n,r,i){try{return Pn.ok(e.replace(n,r,i))}catch(a){if(a instanceof wp)return Pn.fail(a.message);throw a}}}function Ey(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let a=t.child(i);a.content.size&&(a=a.copy(Ey(a.content,e,a))),a.isInline&&(a=e(a,n,i)),r.push(a)}return be.fromArray(r)}class Yo extends Ir{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),a=new Re(Ey(n.content,(o,s)=>!o.isAtom||!s.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return Pn.fromReplace(e,this.from,this.to,a)}invert(){return new Yi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Yo(n.pos,r.pos,this.mark)}merge(e){return e instanceof Yo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Yo(n.from,n.to,e.markFromJSON(n.mark))}}Ir.jsonID("addMark",Yo);class Yi extends Ir{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new Re(Ey(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return Pn.fromReplace(e,this.from,this.to,r)}invert(){return new Yo(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Yi(n.pos,r.pos,this.mark)}merge(e){return e instanceof Yi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Yi(n.from,n.to,e.markFromJSON(n.mark))}}Ir.jsonID("removeMark",Yi);class Zo extends Ir{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Pn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Pn.fromReplace(e,this.pos,this.pos+1,new Re(be.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Zo(this.pos,n.marks[i]);return new Zo(this.pos,this.mark)}}return new ll(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Zo(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Zo(n.pos,e.markFromJSON(n.mark))}}Ir.jsonID("addNodeMark",Zo);class ll extends Ir{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Pn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Pn.fromReplace(e,this.pos,this.pos+1,new Re(be.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Zo(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ll(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ll(n.pos,e.markFromJSON(n.mark))}}Ir.jsonID("removeNodeMark",ll);class er extends Ir{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&rv(e,this.from,this.to)?Pn.fail("Structure replace would overwrite content"):Pn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new pi([this.from,this.to-this.from,this.slice.size])}invert(e){return new er(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new er(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof er)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?Re.empty:new Re(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new er(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?Re.empty:new Re(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new er(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new er(n.from,n.to,Re.fromJSON(e,n.slice),!!n.structure)}}Ir.jsonID("replace",er);class ir extends Ir{constructor(e,n,r,i,a,o,s=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=a,this.insert=o,this.structure=s}apply(e){if(this.structure&&(rv(e,this.from,this.gapFrom)||rv(e,this.gapTo,this.to)))return Pn.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Pn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Pn.fromReplace(e,this.from,this.to,r):Pn.fail("Content does not fit in gap")}getMap(){return new pi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new ir(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||a>r.pos?null:new ir(n.pos,r.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ir(n.from,n.to,n.gapFrom,n.gapTo,Re.fromJSON(e,n.slice),n.insert,!!n.structure)}}Ir.jsonID("replaceAround",ir);function rv(t,e,n){let r=t.resolve(e),i=n-e,a=r.depth;for(;i>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,i--;if(i>0){let o=r.node(a).maybeChild(r.indexAfter(a));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function cL(t,e,n,r){let i=[],a=[],o,s;t.doc.nodesBetween(e,n,(c,d,h)=>{if(!c.isInline)return;let p=c.marks;if(!r.isInSet(p)&&h.type.allowsMarkType(r.type)){let x=Math.max(d,e),v=Math.min(d+c.nodeSize,n),b=r.addToSet(p);for(let C=0;C<p.length;C++)p[C].isInSet(b)||(o&&o.to==x&&o.mark.eq(p[C])?o.to=v:i.push(o=new Yi(x,v,p[C])));s&&s.to==x?s.to=v:a.push(s=new Yo(x,v,r))}}),i.forEach(c=>t.step(c)),a.forEach(c=>t.step(c))}function uL(t,e,n,r){let i=[],a=0;t.doc.nodesBetween(e,n,(o,s)=>{if(!o.isInline)return;a++;let c=null;if(r instanceof L0){let d=o.marks,h;for(;h=r.isInSet(d);)(c||(c=[])).push(h),d=h.removeFromSet(d)}else r?r.isInSet(o.marks)&&(c=[r]):c=o.marks;if(c&&c.length){let d=Math.min(s+o.nodeSize,n);for(let h=0;h<c.length;h++){let p=c[h],x;for(let v=0;v<i.length;v++){let b=i[v];b.step==a-1&&p.eq(i[v].style)&&(x=b)}x?(x.to=d,x.step=a):i.push({style:p,from:Math.max(s,e),to:d,step:a})}}}),i.forEach(o=>t.step(new Yi(o.from,o.to,o.style)))}function Sy(t,e,n,r=n.contentMatch,i=!0){let a=t.doc.nodeAt(e),o=[],s=e+1;for(let c=0;c<a.childCount;c++){let d=a.child(c),h=s+d.nodeSize,p=r.matchType(d.type);if(!p)o.push(new er(s,h,Re.empty));else{r=p;for(let x=0;x<d.marks.length;x++)n.allowsMarkType(d.marks[x].type)||t.step(new Yi(s,h,d.marks[x]));if(i&&d.isText&&n.whitespace!="pre"){let x,v=/\r?\n|\r/g,b;for(;x=v.exec(d.text);)b||(b=new Re(be.from(n.schema.text(" ",n.allowedMarks(d.marks))),0,0)),o.push(new er(s+x.index,s+x.index+x[0].length,b))}}s=h}if(!r.validEnd){let c=r.fillBefore(be.empty,!0);t.replace(s,s,new Re(c,0,0))}for(let c=o.length-1;c>=0;c--)t.step(o[c])}function dL(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Bc(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,a=0;;--r){let o=t.$from.node(r),s=t.$from.index(r)+i,c=t.$to.indexAfter(r)-a;if(r<t.depth&&o.canReplace(s,c,n))return r;if(r==0||o.type.spec.isolating||!dL(o,s,c))break;s&&(i=1),c<o.childCount&&(a=1)}return null}function fL(t,e,n){let{$from:r,$to:i,depth:a}=e,o=r.before(a+1),s=i.after(a+1),c=o,d=s,h=be.empty,p=0;for(let b=a,C=!1;b>n;b--)C||r.index(b)>0?(C=!0,h=be.from(r.node(b).copy(h)),p++):c--;let x=be.empty,v=0;for(let b=a,C=!1;b>n;b--)C||i.after(b+1)<i.end(b)?(C=!0,x=be.from(i.node(b).copy(x)),v++):d++;t.step(new ir(c,d,o,s,new Re(h.append(x),p,v),h.size-p,!0))}function Ay(t,e,n=null,r=t){let i=hL(t,e),a=i&&pL(r,e);return a?i.map(ES).concat({type:e,attrs:n}).concat(a.map(ES)):null}function ES(t){return{type:t,attrs:null}}function hL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,a=n.contentMatchAt(r).findWrapping(e);if(!a)return null;let o=a.length?a[0]:e;return n.canReplaceWith(r,i,o)?a:null}function pL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,a=n.child(r),o=e.contentMatch.findWrapping(a.type);if(!o)return null;let c=(o.length?o[o.length-1]:e).contentMatch;for(let d=r;c&&d<i;d++)c=c.matchType(n.child(d).type);return!c||!c.validEnd?null:o}function mL(t,e,n){let r=be.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let s=n[o].type.contentMatch.matchFragment(r);if(!s||!s.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=be.from(n[o].type.create(n[o].attrs,r))}let i=e.start,a=e.end;t.step(new ir(i,a,i,a,new Re(r,0,0),n.length,!0))}function gL(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,n,(o,s)=>{let c=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,c)&&xL(t.doc,t.mapping.slice(a).map(s),r)){let d=null;if(r.schema.linebreakReplacement){let v=r.whitespace=="pre",b=!!r.contentMatch.matchType(r.schema.linebreakReplacement);v&&!b?d=!1:!v&&b&&(d=!0)}d===!1&&_N(t,o,s,a),Sy(t,t.mapping.slice(a).map(s,1),r,void 0,d===null);let h=t.mapping.slice(a),p=h.map(s,1),x=h.map(s+o.nodeSize,1);return t.step(new ir(p,x,p+1,x-1,new Re(be.from(r.create(c,null,o.marks)),0,0),1,!0)),d===!0&&AN(t,o,s,a),!1}})}function AN(t,e,n,r){e.forEach((i,a)=>{if(i.isText){let o,s=/\r?\n|\r/g;for(;o=s.exec(i.text);){let c=t.mapping.slice(r).map(n+1+a+o.index);t.replaceWith(c,c+1,e.type.schema.linebreakReplacement.create())}}})}function _N(t,e,n,r){e.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+a);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function xL(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function vL(t,e,n,r,i){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");n||(n=a.type);let o=n.create(r,null,i||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,o);if(!n.validContent(a.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ir(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new Re(be.from(o),0,0),1,!0))}function eo(t,e,n=1,r){let i=t.resolve(e),a=i.depth-n,o=r&&r[r.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,h=n-2;d>a;d--,h--){let p=i.node(d),x=i.index(d);if(p.type.spec.isolating)return!1;let v=p.content.cutByIndex(x,p.childCount),b=r&&r[h+1];b&&(v=v.replaceChild(0,b.type.create(b.attrs)));let C=r&&r[h]||p;if(!p.canReplace(x+1,p.childCount)||!C.type.validContent(v))return!1}let s=i.indexAfter(a),c=r&&r[0];return i.node(a).canReplaceWith(s,s,c?c.type:i.node(a+1).type)}function yL(t,e,n=1,r){let i=t.doc.resolve(e),a=be.empty,o=be.empty;for(let s=i.depth,c=i.depth-n,d=n-1;s>c;s--,d--){a=be.from(i.node(s).copy(a));let h=r&&r[d];o=be.from(h?h.type.create(h.attrs,o):i.node(s).copy(o))}t.step(new er(e,e,new Re(a.append(o),n,n),!0))}function ds(t,e){let n=t.resolve(e),r=n.index();return NN(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function bL(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let a=e.child(i),o=a.type==r?t.type.schema.nodes.text:a.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(a.marks))return!1}return n.validEnd}function NN(t,e){return!!(t&&e&&!t.isLeaf&&bL(t,e))}function j0(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let a,o,s=r.index(i);if(i==r.depth?(a=r.nodeBefore,o=r.nodeAfter):n>0?(a=r.node(i+1),s++,o=r.node(i).maybeChild(s)):(a=r.node(i).maybeChild(s-1),o=r.node(i+1)),a&&!a.isTextblock&&NN(a,o)&&r.node(i).canReplace(s,s+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function wL(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,a=t.doc.resolve(e-n),o=a.node().type;if(i&&o.inlineContent){let h=o.whitespace=="pre",p=!!o.contentMatch.matchType(i);h&&!p?r=!1:!h&&p&&(r=!0)}let s=t.steps.length;if(r===!1){let h=t.doc.resolve(e+n);_N(t,h.node(),h.before(),s)}o.inlineContent&&Sy(t,e+n-1,o,a.node().contentMatchAt(a.index()),r==null);let c=t.mapping.slice(s),d=c.map(e-n);if(t.step(new er(d,c.map(e+n,-1),Re.empty,!0)),r===!0){let h=t.doc.resolve(d);AN(t,h.node(),h.before(),t.steps.length)}return t}function CL(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let a=r.index(i);if(r.node(i).canReplaceWith(a,a,n))return r.before(i+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let a=r.indexAfter(i);if(r.node(i).canReplaceWith(a,a,n))return r.after(i+1);if(a<r.node(i).childCount)return null}return null}function kN(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let a=0;a<n.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(n.openStart==0&&n.size?2:1);a++)for(let o=r.depth;o>=0;o--){let s=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,c=r.index(o)+(s>0?1:0),d=r.node(o),h=!1;if(a==1)h=d.canReplace(c,c,i);else{let p=d.contentMatchAt(c).findWrapping(i.firstChild.type);h=p&&d.canReplaceWith(c,c,p[0])}if(h)return s==0?r.pos:s<0?r.before(o+1):r.after(o+1)}return null}function P0(t,e,n=e,r=Re.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),a=t.resolve(n);return TN(i,a,r)?new er(e,n,r):new EL(i,a,r).fit()}function TN(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class EL{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=be.empty;for(let i=0;i<=e.depth;i++){let a=e.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=be.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let a=this.placed,o=r.depth,s=i.depth;for(;o&&s&&a.childCount==1;)a=a.firstChild.content,o--,s--;let c=new Re(a,o,s);return e>-1?new ir(r.pos,e,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new er(r.pos,i.pos,c):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let a=n.firstChild;if(n.childCount>1&&(i=0),a.type.spec.isolating&&i<=r){e=r;break}n=a.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,a=null;r?(a=Og(this.unplaced.content,r-1).firstChild,i=a.content):i=this.unplaced.content;let o=i.firstChild;for(let s=this.depth;s>=0;s--){let{type:c,match:d}=this.frontier[s],h,p=null;if(n==1&&(o?d.matchType(o.type)||(p=d.fillBefore(be.from(o),!1)):a&&c.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:s,parent:a,inject:p};if(n==2&&o&&(h=d.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:s,parent:a,wrap:h};if(a&&d.matchType(a.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Og(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Re(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Og(e,n);if(i.childCount<=1&&n>0){let a=e.size-n<=n+i.size;this.unplaced=new Re(Vu(e,n-1,1),n-1,a?n-1:r)}else this.unplaced=new Re(Vu(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:a}){for(;this.depth>n;)this.closeFrontierNode();if(a)for(let C=0;C<a.length;C++)this.openFrontierNode(a[C]);let o=this.unplaced,s=r?r.content:o.content,c=o.openStart-e,d=0,h=[],{match:p,type:x}=this.frontier[n];if(i){for(let C=0;C<i.childCount;C++)h.push(i.child(C));p=p.matchFragment(i)}let v=s.size+e-(o.content.size-o.openEnd);for(;d<s.childCount;){let C=s.child(d),E=p.matchType(C.type);if(!E)break;d++,(d>1||c==0||C.content.size)&&(p=E,h.push(ON(C.mark(x.allowedMarks(C.marks)),d==1?c:0,d==s.childCount?v:-1)))}let b=d==s.childCount;b||(v=-1),this.placed=$u(this.placed,n,be.from(h)),this.frontier[n].match=p,b&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let C=0,E=s;C<v;C++){let S=E.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),E=S.content}this.unplaced=b?e==0?Re.empty:new Re(Vu(o.content,e-1,1),e-1,v<0?o.openEnd:e-1):new Re(Vu(o.content,e,d),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Ig(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],a=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Ig(e,n,i,r,a);if(o){for(let s=n-1;s>=0;s--){let{match:c,type:d}=this.frontier[s],h=Ig(e,s,d,c,!0);if(!h||h.childCount)continue e}return{depth:n,fit:o,move:a?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=$u(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),a=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,a)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=$u(this.placed,this.depth,be.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(be.empty,!0);n.childCount&&(this.placed=$u(this.placed,this.frontier.length,n))}}function Vu(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Vu(t.firstChild.content,e-1,n)))}function $u(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy($u(t.lastChild.content,e-1,n)))}function Og(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function ON(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,ON(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(be.empty,!0)))),t.copy(r)}function Ig(t,e,n,r,i){let a=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==a.childCount&&!n.compatibleContent(a.type))return null;let s=r.fillBefore(a.content,!0,o);return s&&!SL(n,a.content,o)?s:null}function SL(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function AL(t){return t.spec.defining||t.spec.definingForContent}function _L(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),a=t.doc.resolve(n);if(TN(i,a,r))return t.step(new er(e,n,r));let o=DN(i,a);o[o.length-1]==0&&o.pop();let s=-(i.depth+1);o.unshift(s);for(let x=i.depth,v=i.pos-1;x>0;x--,v--){let b=i.node(x).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;o.indexOf(x)>-1?s=x:i.before(x)==v&&o.splice(1,0,-x)}let c=o.indexOf(s),d=[],h=r.openStart;for(let x=r.content,v=0;;v++){let b=x.firstChild;if(d.push(b),v==r.openStart)break;x=b.content}for(let x=h-1;x>=0;x--){let v=d[x],b=AL(v.type);if(b&&!v.sameMarkup(i.node(Math.abs(s)-1)))h=x;else if(b||!v.type.isTextblock)break}for(let x=r.openStart;x>=0;x--){let v=(x+h+1)%(r.openStart+1),b=d[v];if(b)for(let C=0;C<o.length;C++){let E=o[(C+c)%o.length],S=!0;E<0&&(S=!1,E=-E);let N=i.node(E-1),k=i.index(E-1);if(N.canReplaceWith(k,k,b.type,b.marks))return t.replace(i.before(E),S?a.after(E):n,new Re(IN(r.content,0,r.openStart,v),v,r.openEnd))}}let p=t.steps.length;for(let x=o.length-1;x>=0&&(t.replace(e,n,r),!(t.steps.length>p));x--){let v=o[x];v<0||(e=i.before(v),n=a.after(v))}}function IN(t,e,n,r,i){if(e<n){let a=t.firstChild;t=t.replaceChild(0,a.copy(IN(a.content,e+1,n,r,a)))}if(e>r){let a=i.contentMatchAt(0),o=a.fillBefore(t).append(t);t=o.append(a.matchFragment(o).fillBefore(be.empty,!0))}return t}function NL(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=CL(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new Re(be.from(r),0,0))}function kL(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),a=DN(r,i);for(let o=0;o<a.length;o++){let s=a[o],c=o==a.length-1;if(c&&s==0||r.node(s).type.contentMatch.validEnd)return t.delete(r.start(s),i.end(s));if(s>0&&(c||r.node(s-1).canReplace(r.index(s-1),i.indexAfter(s-1))))return t.delete(r.before(s),i.after(s))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function DN(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let a=t.start(i);if(a<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(a==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==a-1)&&n.push(i)}return n}class dc extends Ir{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Pn.fail("No node at attribute step's position");let r=Object.create(null);for(let a in n.attrs)r[a]=n.attrs[a];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Pn.fromReplace(e,this.pos,this.pos+1,new Re(be.from(i),0,n.isLeaf?0:1))}getMap(){return pi.empty}invert(e){return new dc(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new dc(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new dc(n.pos,n.attr,n.value)}}Ir.jsonID("attr",dc);class Ad extends Ir{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Pn.ok(r)}getMap(){return pi.empty}invert(e){return new Ad(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ad(n.attr,n.value)}}Ir.jsonID("docAttr",Ad);let Ec=class extends Error{};Ec=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Ec.prototype=Object.create(Error.prototype);Ec.prototype.constructor=Ec;Ec.prototype.name="TransformError";class _y{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Sd}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Ec(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),n=i.map(n,-1)),i.forEach((a,o,s,c)=>{e=Math.min(e,s),n=Math.max(n,c)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=Re.empty){let i=P0(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new Re(be.from(r),0,0))}delete(e,n){return this.replace(e,n,Re.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return _L(this,e,n,r),this}replaceRangeWith(e,n,r){return NL(this,e,n,r),this}deleteRange(e,n){return kL(this,e,n),this}lift(e,n){return fL(this,e,n),this}join(e,n=1){return wL(this,e,n),this}wrap(e,n){return mL(this,e,n),this}setBlockType(e,n=e,r,i=null){return gL(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return vL(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new dc(e,n,r)),this}setDocAttribute(e,n){return this.step(new Ad(e,n)),this}addNodeMark(e,n){return this.step(new Zo(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Xt)n.isInSet(r.marks)&&this.step(new ll(e,n));else{let i=r.marks,a,o=[];for(;a=n.isInSet(i);)o.push(new ll(e,a)),i=a.removeFromSet(i);for(let s=o.length-1;s>=0;s--)this.step(o[s])}return this}split(e,n=1,r){return yL(this,e,n,r),this}addMark(e,n,r){return cL(this,e,n,r),this}removeMark(e,n,r){return uL(this,e,n,r),this}clearIncompatible(e,n,r){return Sy(this,e,n,r),this}}const Dg=Object.create(null);class Ze{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new MN(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=Re.empty){let r=n.content.lastChild,i=null;for(let s=0;s<n.openEnd;s++)i=r,r=r.lastChild;let a=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:c,$to:d}=o[s],h=e.mapping.slice(a);e.replaceRange(h.map(c.pos),h.map(d.pos),s?Re.empty:n),s==0&&_S(e,a,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:o,$to:s}=i[a],c=e.mapping.slice(r),d=c.map(o.pos),h=c.map(s.pos);a?e.deleteRange(d,h):(e.replaceRangeWith(d,h,n),_S(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new Ge(e):tc(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let a=e.depth-1;a>=0;a--){let o=n<0?tc(e.node(0),e.node(a),e.before(a+1),e.index(a),n,r):tc(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new gi(e.node(0))}static atStart(e){return tc(e,e,0,0,1)||new gi(e)}static atEnd(e){return tc(e,e,e.content.size,e.childCount,-1)||new gi(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Dg[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Dg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Dg[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ge.between(this.$anchor,this.$head).getBookmark()}}Ze.prototype.visible=!0;class MN{constructor(e,n){this.$from=e,this.$to=n}}let SS=!1;function AS(t){!SS&&!t.parent.inlineContent&&(SS=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ge extends Ze{constructor(e,n=e){AS(e),AS(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ze.near(r);let i=e.resolve(n.map(this.anchor));return new Ge(i.parent.inlineContent?i:r,r)}replace(e,n=Re.empty){if(super.replace(e,n),n==Re.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ge&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new B0(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ge(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let a=Ze.findFrom(n,r,!0)||Ze.findFrom(n,-r,!0);if(a)n=a.$head;else return Ze.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(Ze.findFrom(e,-r,!0)||Ze.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new Ge(e,n)}}Ze.jsonID("text",Ge);class B0{constructor(e,n){this.anchor=e,this.head=n}map(e){return new B0(e.map(this.anchor),e.map(this.head))}resolve(e){return Ge.between(e.resolve(this.anchor),e.resolve(this.head))}}class $e extends Ze{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),a=e.resolve(i);return r?Ze.near(a):new $e(a)}content(){return new Re(be.from(this.node),0,0)}eq(e){return e instanceof $e&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ny(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new $e(e.resolve(n.anchor))}static create(e,n){return new $e(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}$e.prototype.visible=!1;Ze.jsonID("node",$e);class Ny{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new B0(r,r):new Ny(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&$e.isSelectable(r)?new $e(n):Ze.near(n)}}class gi extends Ze{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=Re.empty){if(n==Re.empty){e.delete(0,e.doc.content.size);let r=Ze.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new gi(e)}map(e){return new gi(e)}eq(e){return e instanceof gi}getBookmark(){return TL}}Ze.jsonID("all",gi);const TL={map(){return this},resolve(t){return new gi(t)}};function tc(t,e,n,r,i,a=!1){if(e.inlineContent)return Ge.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let s=e.child(o);if(s.isAtom){if(!a&&$e.isSelectable(s))return $e.create(t,n-(i<0?s.nodeSize:0))}else{let c=tc(t,s,n+i,i<0?s.childCount:0,i,a);if(c)return c}n+=s.nodeSize*i}return null}function _S(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof er||i instanceof ir))return;let a=t.mapping.maps[r],o;a.forEach((s,c,d,h)=>{o==null&&(o=h)}),t.setSelection(Ze.near(t.doc.resolve(o),n))}const NS=1,vh=2,kS=4;class OL extends _y{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|NS)&~vh,this.storedMarks=null,this}get selectionSet(){return(this.updated&NS)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=vh,this}ensureMarks(e){return Xt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&vh)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~vh,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Xt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let a=this.storedMarks;if(!a){let o=this.doc.resolve(n);a=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,a)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Ze.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=kS,this}get scrolledIntoView(){return(this.updated&kS)>0}}function TS(t,e){return!e||!t?t:t.bind(e)}class Gu{constructor(e,n,r){this.name=e,this.init=TS(n.init,r),this.apply=TS(n.apply,r)}}const IL=[new Gu("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Gu("selection",{init(t,e){return t.selection||Ze.atStart(e.doc)},apply(t){return t.selection}}),new Gu("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Gu("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Mg{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=IL.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Gu(r.key,r.spec.state,r))})}}class oc{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let a=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let c=i?i[o].n:0,d=i?i[o].state:this,h=c<n.length&&s.spec.appendTransaction.call(s,c?n.slice(c):n,d,r);if(h&&r.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!i){i=[];for(let p=0;p<this.config.plugins.length;p++)i.push(p<o?{state:r,n:n.length}:{state:this,n:0})}n.push(h),r=r.applyInner(h),a=!0}i&&(i[o]={state:r,n:n.length})}}if(!a)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new oc(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let a=r[i];n[a.name]=a.apply(e,this[a.name],this,n)}return n}get tr(){return new OL(this)}static create(e){let n=new Mg(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new oc(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Mg(this.schema,e.plugins),r=n.fields,i=new oc(n);for(let a=0;a<r.length;a++){let o=r[a].name;i[o]=this.hasOwnProperty(o)?this[o]:r[a].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],a=i.spec.state;a&&a.toJSON&&(n[r]=a.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Mg(e.schema,e.plugins),a=new oc(i);return i.fields.forEach(o=>{if(o.name=="doc")a.doc=Ji.fromJSON(e.schema,n.doc);else if(o.name=="selection")a.selection=Ze.fromJSON(a.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let s in r){let c=r[s],d=c.spec.state;if(c.key==o.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(n,s)){a[o.name]=d.fromJSON.call(c,e,n[s],a);return}}a[o.name]=o.init(e,a)}}),a}}function RN(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=RN(i,e,{})),n[r]=i}return n}class dn{constructor(e){this.spec=e,this.props={},e.props&&RN(e.props,this,this.props),this.key=e.key?e.key.key:LN("plugin")}getState(e){return e[this.key]}}const Rg=Object.create(null);function LN(t){return t in Rg?t+"$"+ ++Rg[t]:(Rg[t]=0,t+"$")}class Sn{constructor(e="key"){this.key=LN(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const ky=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function jN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const PN=(t,e,n)=>{let r=jN(t,n);if(!r)return!1;let i=Ty(r);if(!i){let o=r.blockRange(),s=o&&Bc(o);return s==null?!1:(e&&e(t.tr.lift(o,s).scrollIntoView()),!0)}let a=i.nodeBefore;if(WN(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Sc(a,"end")||$e.isSelectable(a)))for(let o=r.depth;;o--){let s=P0(t.doc,r.before(o),r.after(o),Re.empty);if(s&&s.slice.size<s.to-s.from){if(e){let c=t.tr.step(s);c.setSelection(Sc(a,"end")?Ze.findFrom(c.doc.resolve(c.mapping.map(i.pos,-1)),-1):$e.create(c.doc,i.pos-a.nodeSize)),e(c.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return a.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},DL=(t,e,n)=>{let r=jN(t,n);if(!r)return!1;let i=Ty(r);return i?BN(t,i,e):!1},ML=(t,e,n)=>{let r=zN(t,n);if(!r)return!1;let i=Oy(r);return i?BN(t,i,e):!1};function BN(t,e,n){let r=e.nodeBefore,i=r,a=e.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let h=i.lastChild;if(!h)return!1;i=h}let o=e.nodeAfter,s=o,c=e.pos+1;for(;!s.isTextblock;c++){if(s.type.spec.isolating)return!1;let h=s.firstChild;if(!h)return!1;s=h}let d=P0(t.doc,a,c,Re.empty);if(!d||d.from!=a||d instanceof er&&d.slice.size>=c-a)return!1;if(n){let h=t.tr.step(d);h.setSelection(Ge.create(h.doc,a)),n(h.scrollIntoView())}return!0}function Sc(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const FN=(t,e,n)=>{let{$head:r,empty:i}=t.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;a=Ty(r)}let o=a&&a.nodeBefore;return!o||!$e.isSelectable(o)?!1:(e&&e(t.tr.setSelection($e.create(t.doc,a.pos-o.nodeSize)).scrollIntoView()),!0)};function Ty(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function zN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const UN=(t,e,n)=>{let r=zN(t,n);if(!r)return!1;let i=Oy(r);if(!i)return!1;let a=i.nodeAfter;if(WN(t,i,e,1))return!0;if(r.parent.content.size==0&&(Sc(a,"start")||$e.isSelectable(a))){let o=P0(t.doc,r.before(),r.after(),Re.empty);if(o&&o.slice.size<o.to-o.from){if(e){let s=t.tr.step(o);s.setSelection(Sc(a,"start")?Ze.findFrom(s.doc.resolve(s.mapping.map(i.pos)),1):$e.create(s.doc,s.mapping.map(i.pos))),e(s.scrollIntoView())}return!0}}return a.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},HN=(t,e,n)=>{let{$head:r,empty:i}=t.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;a=Oy(r)}let o=a&&a.nodeAfter;return!o||!$e.isSelectable(o)?!1:(e&&e(t.tr.setSelection($e.create(t.doc,a.pos)).scrollIntoView()),!0)};function Oy(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const RL=(t,e)=>{let n=t.selection,r=n instanceof $e,i;if(r){if(n.node.isTextblock||!ds(t.doc,n.from))return!1;i=n.from}else if(i=j0(t.doc,n.from,-1),i==null)return!1;if(e){let a=t.tr.join(i);r&&a.setSelection($e.create(a.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},LL=(t,e)=>{let n=t.selection,r;if(n instanceof $e){if(n.node.isTextblock||!ds(t.doc,n.to))return!1;r=n.to}else if(r=j0(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},jL=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),a=i&&Bc(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)},VN=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Iy(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const PL=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),a=n.indexAfter(-1),o=Iy(i.contentMatchAt(a));if(!o||!i.canReplaceWith(a,a,o))return!1;if(e){let s=n.after(),c=t.tr.replaceWith(s,s,o.createAndFill());c.setSelection(Ze.near(c.doc.resolve(s),1)),e(c.scrollIntoView())}return!0},$N=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof gi||r.parent.inlineContent||i.parent.inlineContent)return!1;let a=Iy(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,s=t.tr.insert(o,a.createAndFill());s.setSelection(Ge.create(s.doc,o+1)),e(s.scrollIntoView())}return!0},GN=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if(eo(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Bc(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function BL(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof $e&&e.selection.node.isBlock)return!r.parentOffset||!eo(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let a=[],o,s,c=!1,d=!1;for(let v=r.depth;;v--)if(r.node(v).isBlock){c=r.end(v)==r.pos+(r.depth-v),d=r.start(v)==r.pos-(r.depth-v),s=Iy(r.node(v-1).contentMatchAt(r.indexAfter(v-1))),a.unshift(c&&s?{type:s}:null),o=v;break}else{if(v==1)return!1;a.unshift(null)}let h=e.tr;(e.selection instanceof Ge||e.selection instanceof gi)&&h.deleteSelection();let p=h.mapping.map(r.pos),x=eo(h.doc,p,a.length,a);if(x||(a[0]=s?{type:s}:null,x=eo(h.doc,p,a.length,a)),!x)return!1;if(h.split(p,a.length,a),!c&&d&&r.node(o).type!=s){let v=h.mapping.map(r.before(o)),b=h.doc.resolve(v);s&&r.node(o-1).canReplaceWith(b.index(),b.index()+1,s)&&h.setNodeMarkup(h.mapping.map(r.before(o)),s)}return n&&n(h.scrollIntoView()),!0}}const FL=BL(),zL=(t,e)=>{let{$from:n,to:r}=t.selection,i,a=n.sharedDepth(r);return a==0?!1:(i=n.before(a),e&&e(t.tr.setSelection($e.create(t.doc,i))),!0)};function UL(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,a=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(a-1,a)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(i.isTextblock||ds(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function WN(t,e,n,r){let i=e.nodeBefore,a=e.nodeAfter,o,s,c=i.type.spec.isolating||a.type.spec.isolating;if(!c&&UL(t,e,n))return!0;let d=!c&&e.parent.canReplace(e.index(),e.index()+1);if(d&&(o=(s=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&s.matchType(o[0]||a.type).validEnd){if(n){let v=e.pos+a.nodeSize,b=be.empty;for(let S=o.length-1;S>=0;S--)b=be.from(o[S].create(null,b));b=be.from(i.copy(b));let C=t.tr.step(new ir(e.pos-1,v,e.pos,v,new Re(b,1,0),o.length,!0)),E=C.doc.resolve(v+2*o.length);E.nodeAfter&&E.nodeAfter.type==i.type&&ds(C.doc,E.pos)&&C.join(E.pos),n(C.scrollIntoView())}return!0}let h=a.type.spec.isolating||r>0&&c?null:Ze.findFrom(e,1),p=h&&h.$from.blockRange(h.$to),x=p&&Bc(p);if(x!=null&&x>=e.depth)return n&&n(t.tr.lift(p,x).scrollIntoView()),!0;if(d&&Sc(a,"start",!0)&&Sc(i,"end")){let v=i,b=[];for(;b.push(v),!v.isTextblock;)v=v.lastChild;let C=a,E=1;for(;!C.isTextblock;C=C.firstChild)E++;if(v.canReplace(v.childCount,v.childCount,C.content)){if(n){let S=be.empty;for(let k=b.length-1;k>=0;k--)S=be.from(b[k].copy(S));let N=t.tr.step(new ir(e.pos-b.length,e.pos+a.nodeSize,e.pos+E,e.pos+a.nodeSize-E,new Re(S,b.length,0),0,!0));n(N.scrollIntoView())}return!0}}return!1}function qN(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(n&&n(e.tr.setSelection(Ge.create(e.doc,t<0?i.start(a):i.end(a)))),!0):!1}}const HL=qN(-1),VL=qN(1);function $L(t,e=null){return function(n,r){let{$from:i,$to:a}=n.selection,o=i.blockRange(a),s=o&&Ay(o,t,e);return s?(r&&r(n.tr.wrap(o,s).scrollIntoView()),!0):!1}}function OS(t,e=null){return function(n,r){let i=!1;for(let a=0;a<n.selection.ranges.length&&!i;a++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[a];n.doc.nodesBetween(o,s,(c,d)=>{if(i)return!1;if(!(!c.isTextblock||c.hasMarkup(t,e)))if(c.type==t)i=!0;else{let h=n.doc.resolve(d),p=h.index();i=h.parent.canReplaceWith(p,p+1,t)}})}if(!i)return!1;if(r){let a=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:s},$to:{pos:c}}=n.selection.ranges[o];a.setBlockType(s,c,t,e)}r(a.scrollIntoView())}return!0}}function Dy(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Dy(ky,PN,FN);Dy(ky,UN,HN);Dy(VN,$N,GN,FL);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function GL(t,e=null){return function(n,r){let{$from:i,$to:a}=n.selection,o=i.blockRange(a);if(!o)return!1;let s=r?n.tr:null;return WL(s,o,t,e)?(r&&r(s.scrollIntoView()),!0):!1}}function WL(t,e,n,r=null){let i=!1,a=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let c=o.resolve(e.start-2);a=new Ep(c,c,e.depth),e.endIndex<e.parent.childCount&&(e=new Ep(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let s=Ay(a,n,r,e);return s?(t&&qL(t,e,s,i,n),!0):!1}function qL(t,e,n,r,i){let a=be.empty;for(let h=n.length-1;h>=0;h--)a=be.from(n[h].type.create(n[h].attrs,a));t.step(new ir(e.start-(r?2:0),e.end,e.start,e.end,new Re(a,0,0),n.length,!0));let o=0;for(let h=0;h<n.length;h++)n[h].type==i&&(o=h+1);let s=n.length-o,c=e.start+n.length-(r?2:0),d=e.parent;for(let h=e.startIndex,p=e.endIndex,x=!0;h<p;h++,x=!1)!x&&eo(t.doc,c,s)&&(t.split(c,s),c+=2*s),c+=d.child(h).nodeSize;return t}function XL(t){return function(e,n){let{$from:r,$to:i}=e.selection,a=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return a?n?r.node(a.depth-1).type==t?KL(e,n,t,a):YL(e,n,a):!0:!1}}function KL(t,e,n,r){let i=t.tr,a=r.end,o=r.$to.end(r.depth);a<o&&(i.step(new ir(a-1,o,a,o,new Re(be.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ep(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const s=Bc(r);if(s==null)return!1;i.lift(r,s);let c=i.doc.resolve(i.mapping.map(a,-1)-1);return ds(i.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&i.join(c.pos),e(i.scrollIntoView()),!0}function YL(t,e,n){let r=t.tr,i=n.parent;for(let v=n.end,b=n.endIndex-1,C=n.startIndex;b>C;b--)v-=i.child(b).nodeSize,r.delete(v-1,v+1);let a=r.doc.resolve(n.start),o=a.nodeAfter;if(r.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let s=n.startIndex==0,c=n.endIndex==i.childCount,d=a.node(-1),h=a.index(-1);if(!d.canReplace(h+(s?0:1),h+1,o.content.append(c?be.empty:be.from(i))))return!1;let p=a.pos,x=p+o.nodeSize;return r.step(new ir(p-(s?1:0),x+(c?1:0),p+1,x-1,new Re((s?be.empty:be.from(i.copy(be.empty))).append(c?be.empty:be.from(i.copy(be.empty))),s?0:1,c?0:1),s?0:1)),e(r.scrollIntoView()),!0}function ZL(t){return function(e,n){let{$from:r,$to:i}=e.selection,a=r.blockRange(i,d=>d.childCount>0&&d.firstChild.type==t);if(!a)return!1;let o=a.startIndex;if(o==0)return!1;let s=a.parent,c=s.child(o-1);if(c.type!=t)return!1;if(n){let d=c.lastChild&&c.lastChild.type==s.type,h=be.from(d?t.create():null),p=new Re(be.from(t.create(null,be.from(s.type.create(null,h)))),d?3:1,0),x=a.start,v=a.end;n(e.tr.step(new ir(x-(d?3:1),v,x,v,p,1,!0)).scrollIntoView())}return!0}}const vr=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Ac=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let iv=null;const qa=function(t,e,n){let r=iv||(iv=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},JL=function(){iv=null},cl=function(t,e,n,r){return n&&(IS(t,e,n,r,-1)||IS(t,e,n,r,1))},QL=/^(img|br|input|textarea|hr)$/i;function IS(t,e,n,r,i){for(var a;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Mi(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Gd(t)||QL.test(t.nodeName)||t.contentEditable=="false")return!1;e=vr(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((a=o.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=i;else return!1;else t=o,e=i<0?Mi(t):0}else return!1}}function Mi(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ej(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Mi(t)}else if(t.parentNode&&!Gd(t))e=vr(t),t=t.parentNode;else return null}}function tj(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Gd(t))e=vr(t)+1,t=t.parentNode;else return null}}function nj(t,e,n){for(let r=e==0,i=e==Mi(t);r||i;){if(t==n)return!0;let a=vr(t);if(t=t.parentNode,!t)return!1;r=r&&a==0,i=i&&a==Mi(t)}}function Gd(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const F0=function(t){return t.focusNode&&cl(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Vs(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function rj(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function ij(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Mi(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Mi(r.startContainer),r.startOffset)}}}const ya=typeof navigator<"u"?navigator:null,DS=typeof document<"u"?document:null,fs=ya&&ya.userAgent||"",av=/Edge\/(\d+)/.exec(fs),XN=/MSIE \d/.exec(fs),ov=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fs),ii=!!(XN||ov||av),es=XN?document.documentMode:ov?+ov[1]:av?+av[1]:0,Li=!ii&&/gecko\/(\d+)/i.test(fs);Li&&+(/Firefox\/(\d+)/.exec(fs)||[0,0])[1];const sv=!ii&&/Chrome\/(\d+)/.exec(fs),br=!!sv,KN=sv?+sv[1]:0,Tr=!ii&&!!ya&&/Apple Computer/.test(ya.vendor),_c=Tr&&(/Mobile\/\w+/.test(fs)||!!ya&&ya.maxTouchPoints>2),Di=_c||(ya?/Mac/.test(ya.platform):!1),YN=ya?/Win/.test(ya.platform):!1,Ya=/Android \d/.test(fs),Wd=!!DS&&"webkitFontSmoothing"in DS.documentElement.style,aj=Wd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function oj(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ha(t,e){return typeof t=="number"?t:t[e]}function sj(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function MS(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=Ac(o);continue}let s=o,c=s==a.body,d=c?oj(a):sj(s),h=0,p=0;if(e.top<d.top+Ha(r,"top")?p=-(d.top-e.top+Ha(i,"top")):e.bottom>d.bottom-Ha(r,"bottom")&&(p=e.bottom-e.top>d.bottom-d.top?e.top+Ha(i,"top")-d.top:e.bottom-d.bottom+Ha(i,"bottom")),e.left<d.left+Ha(r,"left")?h=-(d.left-e.left+Ha(i,"left")):e.right>d.right-Ha(r,"right")&&(h=e.right-d.right+Ha(i,"right")),h||p)if(c)a.defaultView.scrollBy(h,p);else{let v=s.scrollLeft,b=s.scrollTop;p&&(s.scrollTop+=p),h&&(s.scrollLeft+=h);let C=s.scrollLeft-v,E=s.scrollTop-b;e={left:e.left-C,top:e.top-E,right:e.right-C,bottom:e.bottom-E}}let x=c?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(x))break;o=x=="absolute"?o.offsetParent:Ac(o)}}function lj(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let a=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let s=t.root.elementFromPoint(a,o);if(!s||s==t.dom||!t.dom.contains(s))continue;let c=s.getBoundingClientRect();if(c.top>=n-20){r=s,i=c.top;break}}return{refDOM:r,refTop:i,stack:ZN(t.dom)}}function ZN(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ac(r));return e}function cj({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;JN(n,r==0?0:r-e)}function JN(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:a}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=a&&(r.scrollLeft=a)}}let Jl=null;function uj(t){if(t.setActive)return t.setActive();if(Jl)return t.focus(Jl);let e=ZN(t);t.focus(Jl==null?{get preventScroll(){return Jl={preventScroll:!0},!0}}:void 0),Jl||(Jl=!1,JN(e,0))}function QN(t,e){let n,r=2e8,i,a=0,o=e.top,s=e.top,c,d;for(let h=t.firstChild,p=0;h;h=h.nextSibling,p++){let x;if(h.nodeType==1)x=h.getClientRects();else if(h.nodeType==3)x=qa(h).getClientRects();else continue;for(let v=0;v<x.length;v++){let b=x[v];if(b.top<=o&&b.bottom>=s){o=Math.max(b.bottom,o),s=Math.min(b.top,s);let C=b.left>e.left?b.left-e.left:b.right<e.left?e.left-b.right:0;if(C<r){n=h,r=C,i=C&&n.nodeType==3?{left:b.right<e.left?b.right:b.left,top:e.top}:e,h.nodeType==1&&C&&(a=p+(e.left>=(b.left+b.right)/2?1:0));continue}}else b.top>e.top&&!c&&b.left<=e.left&&b.right>=e.left&&(c=h,d={left:Math.max(b.left,Math.min(b.right,e.left)),top:b.top});!n&&(e.left>=b.right&&e.top>=b.top||e.left>=b.left&&e.top>=b.bottom)&&(a=p+1)}}return!n&&c&&(n=c,i=d,r=0),n&&n.nodeType==3?dj(n,i):!n||r&&n.nodeType==1?{node:t,offset:a}:QN(n,i)}function dj(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let a=0;a<n;a++){r.setEnd(t,a+1),r.setStart(t,a);let o=Po(r,1);if(o.top!=o.bottom&&My(e,o)){i={node:t,offset:a+(e.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function My(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function fj(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function hj(t,e,n){let{node:r,offset:i}=QN(e,n),a=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();a=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,a)}function pj(t,e,n,r){let i=-1;for(let a=e,o=!1;a!=t.dom;){let s=t.docView.nearestDesc(a,!0),c;if(!s)return null;if(s.dom.nodeType==1&&(s.node.isBlock&&s.parent||!s.contentDOM)&&((c=s.dom.getBoundingClientRect()).width||c.height)&&(s.node.isBlock&&s.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(s.dom.nodeName)&&(!o&&c.left>r.left||c.top>r.top?i=s.posBefore:(!o&&c.right<r.left||c.bottom<r.top)&&(i=s.posAfter),o=!0),!s.contentDOM&&i<0&&!s.node.isText))return(s.node.isBlock?r.top<(c.top+c.bottom)/2:r.left<(c.left+c.right)/2)?s.posBefore:s.posAfter;a=s.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function ek(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),a=i;;){let o=t.childNodes[a];if(o.nodeType==1){let s=o.getClientRects();for(let c=0;c<s.length;c++){let d=s[c];if(My(e,d))return ek(o,e,d)}}if((a=(a+1)%r)==i)break}return t}function mj(t,e){let n=t.dom.ownerDocument,r,i=0,a=ij(n,e.left,e.top);a&&({node:r,offset:i}=a);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),s;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let d=t.dom.getBoundingClientRect();if(!My(e,d)||(o=ek(t.dom,e,d),!o))return null}if(Tr)for(let d=o;r&&d;d=Ac(d))d.draggable&&(r=void 0);if(o=fj(o,e),r){if(Li&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let h=r.childNodes[i],p;h.nodeName=="IMG"&&(p=h.getBoundingClientRect()).right<=e.left&&p.bottom>e.top&&i++}let d;Wd&&i&&r.nodeType==1&&(d=r.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?s=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(s=pj(t,r,i,e))}s==null&&(s=hj(t,o,e));let c=t.docView.nearestDesc(o,!0);return{pos:s,inside:c?c.posAtStart-c.border:-1}}function RS(t){return t.top<t.bottom||t.left<t.right}function Po(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(RS(r))return r}return Array.prototype.find.call(n,RS)||t.getBoundingClientRect()}const gj=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function tk(t,e,n){let{node:r,offset:i,atom:a}=t.docView.domFromPos(e,n<0?-1:1),o=Wd||Li;if(r.nodeType==3)if(o&&(gj.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let c=Po(qa(r,i,i),n);if(Li&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let d=Po(qa(r,i-1,i-1),-1);if(d.top==c.top){let h=Po(qa(r,i,i+1),-1);if(h.top!=c.top)return ju(h,h.left<d.left)}}return c}else{let c=i,d=i,h=n<0?1:-1;return n<0&&!i?(d++,h=-1):n>=0&&i==r.nodeValue.length?(c--,h=1):n<0?c--:d++,ju(Po(qa(r,c,d),h),h<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&i&&(n<0||i==Mi(r))){let c=r.childNodes[i-1];if(c.nodeType==1)return Lg(c.getBoundingClientRect(),!1)}if(a==null&&i<Mi(r)){let c=r.childNodes[i];if(c.nodeType==1)return Lg(c.getBoundingClientRect(),!0)}return Lg(r.getBoundingClientRect(),n>=0)}if(a==null&&i&&(n<0||i==Mi(r))){let c=r.childNodes[i-1],d=c.nodeType==3?qa(c,Mi(c)-(o?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(d)return ju(Po(d,1),!1)}if(a==null&&i<Mi(r)){let c=r.childNodes[i];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let d=c?c.nodeType==3?qa(c,0,o?0:1):c.nodeType==1?c:null:null;if(d)return ju(Po(d,-1),!0)}return ju(Po(r.nodeType==3?qa(r):r,-n),n>=0)}function ju(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Lg(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function nk(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function xj(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return nk(t,e,()=>{let{node:a}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let s=t.docView.nearestDesc(a,!0);if(!s)break;if(s.node.isBlock){a=s.contentDOM||s.dom;break}a=s.dom.parentNode}let o=tk(t,i.pos,1);for(let s=a.firstChild;s;s=s.nextSibling){let c;if(s.nodeType==1)c=s.getClientRects();else if(s.nodeType==3)c=qa(s,0,s.nodeValue.length).getClientRects();else continue;for(let d=0;d<c.length;d++){let h=c[d];if(h.bottom>h.top+1&&(n=="up"?o.top-h.top>(h.bottom-o.top)*2:h.bottom-o.bottom>(o.bottom-h.top)*2))return!1}}return!0})}const vj=/[\u0590-\u08ac]/;function yj(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,a=!i,o=i==r.parent.content.size,s=t.domSelection();return s?!vj.test(r.parent.textContent)||!s.modify?n=="left"||n=="backward"?a:o:nk(t,e,()=>{let{focusNode:c,focusOffset:d,anchorNode:h,anchorOffset:p}=t.domSelectionRange(),x=s.caretBidiLevel;s.modify("move",n,"character");let v=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:b,focusOffset:C}=t.domSelectionRange(),E=b&&!v.contains(b.nodeType==1?b:b.parentNode)||c==b&&d==C;try{s.collapse(h,p),c&&(c!=h||d!=p)&&s.extend&&s.extend(c,d)}catch{}return x!=null&&(s.caretBidiLevel=x),E}):r.pos==r.start()||r.pos==r.end()}let LS=null,jS=null,PS=!1;function bj(t,e,n){return LS==e&&jS==n?PS:(LS=e,jS=n,PS=n=="up"||n=="down"?xj(t,e,n):yj(t,e,n))}const ji=0,BS=1,Gs=2,ba=3;class qd{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=ji,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let a,o;if(e==this.contentDOM)a=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((o=a.pmViewDesc)&&o.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(o)+o.size:this.posAtStart}else{let a,o;if(e==this.contentDOM)a=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((o=a.pmViewDesc)&&o.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>vr(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let a=this.getDesc(i),o;if(a&&(!n||a.node))if(r&&(o=a.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return a}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],a=r+i.size;if(r==e&&a!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let s=i.children[o];if(s.size){i=s;break}}return i}if(e<a)return i.descAt(e-r-i.border);r=a}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let a=0;r<this.children.length;r++){let o=this.children[r],s=a+o.size;if(s>e||o instanceof ik){i=e-a;break}a=s}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof rk&&a.side>=0;r--);if(n<=0){let a,o=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,o=!1);return a&&n&&o&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?vr(a.dom)+1:0}}else{let a,o=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,o=!1);return a&&o&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?vr(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let o=r,s=0;;s++){let c=this.children[s],d=o+c.size;if(i==-1&&e<=d){let h=o+c.border;if(e>=h&&n<=d-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(e,n,h);e=o;for(let p=s;p>0;p--){let x=this.children[p-1];if(x.size&&x.dom.parentNode==this.contentDOM&&!x.emptyChildAt(1)){i=vr(x.dom)+1;break}e-=x.size}i==-1&&(i=0)}if(i>-1&&(d>n||s==this.children.length-1)){n=d;for(let h=s+1;h<this.children.length;h++){let p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){a=vr(p.dom);break}n+=p.size}a==-1&&(a=this.contentDOM.childNodes.length);break}o=d}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let a=Math.min(e,n),o=Math.max(e,n);for(let v=0,b=0;v<this.children.length;v++){let C=this.children[v],E=b+C.size;if(a>b&&o<E)return C.setSelection(e-b-C.border,n-b-C.border,r,i);b=E}let s=this.domFromPos(e,e?-1:1),c=n==e?s:this.domFromPos(n,n?-1:1),d=r.root.getSelection(),h=r.domSelectionRange(),p=!1;if((Li||Tr)&&e==n){let{node:v,offset:b}=s;if(v.nodeType==3){if(p=!!(b&&v.nodeValue[b-1]==`
`),p&&b==v.nodeValue.length)for(let C=v,E;C;C=C.parentNode){if(E=C.nextSibling){E.nodeName=="BR"&&(s=c={node:E.parentNode,offset:vr(E)+1});break}let S=C.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let C=v.childNodes[b-1];p=C&&(C.nodeName=="BR"||C.contentEditable=="false")}}if(Li&&h.focusNode&&h.focusNode!=c.node&&h.focusNode.nodeType==1){let v=h.focusNode.childNodes[h.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||p&&Tr)&&cl(s.node,s.offset,h.anchorNode,h.anchorOffset)&&cl(c.node,c.offset,h.focusNode,h.focusOffset))return;let x=!1;if((d.extend||e==n)&&!(p&&Li)){d.collapse(s.node,s.offset);try{e!=n&&d.extend(c.node,c.offset),x=!0}catch{}}if(!x){if(e>n){let b=s;s=c,c=b}let v=document.createRange();v.setEnd(c.node,c.offset),v.setStart(s.node,s.offset),d.removeAllRanges(),d.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let a=this.children[i],o=r+a.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let s=r+a.border,c=o-a.border;if(e>=s&&n<=c){this.dirty=e==r||n==o?Gs:BS,e==s&&n==c&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=ba:a.markDirty(e-s,n-s);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Gs:ba}r=o}this.dirty=Gs}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Gs:BS;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class rk extends qd{constructor(e,n,r,i){let a,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!n.type.spec.raw){if(o.nodeType!=1){let s=document.createElement("span");s.appendChild(o),o=s}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,a=this}matchesWidget(e){return this.dirty==ji&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class wj extends qd{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ul extends qd{constructor(e,n,r,i,a){super(e,[],r,i),this.mark=n,this.spec=a}static create(e,n,r,i){let a=i.nodeViews[n.type.name],o=a&&a(n,i,r);return(!o||!o.dom)&&(o=ml.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new ul(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&ba||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ba&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=ji){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ji}}slice(e,n,r){let i=ul.create(this.parent,this.mark,!0,r),a=this.children,o=this.size;n<o&&(a=cv(a,n,o,r)),e>0&&(a=cv(a,0,e,r));for(let s=0;s<a.length;s++)a[s].parent=i;return i.children=a,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ts extends qd{constructor(e,n,r,i,a,o,s,c,d){super(e,[],a,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=s}static create(e,n,r,i,a,o){let s=a.nodeViews[n.type.name],c,d=s&&s(n,a,()=>{if(!c)return o;if(c.parent)return c.parent.posBeforeChild(c)},r,i),h=d&&d.dom,p=d&&d.contentDOM;if(n.isText){if(!h)h=document.createTextNode(n.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:p}=ml.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!p&&!n.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),n.type.spec.draggable&&(h.draggable=!0));let x=h;return h=sk(h,r,n),d?c=new Cj(e,n,r,i,h,p||null,x,d,a,o+1):n.isText?new z0(e,n,r,i,h,x,a):new ts(e,n,r,i,h,p||null,x,a,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>be.empty)}return e}matchesNode(e,n,r){return this.dirty==ji&&e.eq(this.node)&&Ap(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,a=e.composing?this.localCompositionInfo(e,n):null,o=a&&a.pos>-1?a:null,s=a&&a.pos<0,c=new Sj(this,o&&o.node,e);Nj(this.node,this.innerDeco,(d,h,p)=>{d.spec.marks?c.syncToMarks(d.spec.marks,r,e,h):d.type.side>=0&&!p&&c.syncToMarks(h==this.node.childCount?Xt.none:this.node.child(h).marks,r,e,h),c.placeWidget(d,e,i)},(d,h,p,x)=>{c.syncToMarks(d.marks,r,e,x);let v;c.findNodeMatch(d,h,p,x)||s&&e.state.selection.from>i&&e.state.selection.to<i+d.nodeSize&&(v=c.findIndexWithChild(a.node))>-1&&c.updateNodeAt(d,h,p,v,e)||c.updateNextNode(d,h,p,e,x,i)||c.addNode(d,h,p,e,i),i+=d.nodeSize}),c.syncToMarks([],r,e,0),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Gs)&&(o&&this.protectLocalComposition(e,o),ak(this.contentDOM,this.children,e),_c&&kj(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Ge)||r<n||i>n+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let o=a.nodeValue,s=Tj(this.node.content,o,r-n,i-n);return s<0?null:{node:a,pos:s,text:o}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let o=new wj(this,a,n,i);e.input.compositionNodes.push(o),this.children=cv(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==ba||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=ji}updateOuterDeco(e){if(Ap(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ok(this.dom,this.nodeDOM,lv(this.outerDeco,this.node,n),lv(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function FS(t,e,n,r,i){sk(r,e,t);let a=new ts(void 0,t,e,n,r,r,r,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class z0 extends ts{constructor(e,n,r,i,a,o,s){super(e,n,r,i,a,null,o,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==ba||this.dirty!=ji&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=ji||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=ji,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),a=document.createTextNode(i.text);return new z0(this.parent,i,this.outerDeco,this.innerDeco,a,a,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=ba)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ik extends qd{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ji&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Cj extends ts{constructor(e,n,r,i,a,o,s,c,d,h){super(e,n,r,i,a,o,s,d,h),this.spec=c}update(e,n,r,i){if(this.dirty==ba)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,n,r);return a&&this.updateInner(e,n,r,i),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ak(t,e,n){let r=t.firstChild,i=!1;for(let a=0;a<e.length;a++){let o=e[a],s=o.dom;if(s.parentNode==t){for(;s!=r;)r=zS(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(s,r);if(o instanceof ul){let c=r?r.previousSibling:t.lastChild;ak(o.contentDOM,o.children,n),r=c?c.nextSibling:t.firstChild}}for(;r;)r=zS(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const od=function(t){t&&(this.nodeName=t)};od.prototype=Object.create(null);const Ws=[new od];function lv(t,e,n){if(t.length==0)return Ws;let r=n?Ws[0]:new od,i=[r];for(let a=0;a<t.length;a++){let o=t[a].type.attrs;if(o){o.nodeName&&i.push(r=new od(o.nodeName));for(let s in o){let c=o[s];c!=null&&(n&&i.length==1&&i.push(r=new od(e.isInline?"span":"div")),s=="class"?r.class=(r.class?r.class+" ":"")+c:s=="style"?r.style=(r.style?r.style+";":"")+c:s!="nodeName"&&(r[s]=c))}}}return i}function ok(t,e,n,r){if(n==Ws&&r==Ws)return e;let i=e;for(let a=0;a<r.length;a++){let o=r[a],s=n[a];if(a){let c;s&&s.nodeName==o.nodeName&&i!=t&&(c=i.parentNode)&&c.nodeName.toLowerCase()==o.nodeName||(c=document.createElement(o.nodeName),c.pmIsDeco=!0,c.appendChild(i),s=Ws[0]),i=c}Ej(i,s||Ws[0],o)}return i}function Ej(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)i.indexOf(r[a])==-1&&t.classList.remove(r[a]);for(let a=0;a<i.length;a++)r.indexOf(i[a])==-1&&t.classList.add(i[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function sk(t,e,n){return ok(t,t,Ws,lv(e,n,t.nodeType!=1))}function Ap(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function zS(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Sj{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Aj(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,i){let a=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;a<s&&(a==o-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<o;)this.destroyRest(),this.top.dirty=ji,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let c=-1,d=this.top.children.length;i<this.preMatch.index&&(d=Math.min(this.index+3,d));for(let h=this.index;h<d;h++){let p=this.top.children[h];if(p.matchesMark(e[o])&&!this.isLocked(p.dom)){c=h;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let h=ul.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let a=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))a=this.top.children.indexOf(o,this.index);else for(let s=this.index,c=Math.min(this.top.children.length,s+5);s<c;s++){let d=this.top.children[s];if(d.matchesNode(e,n,r)&&!this.preMatch.matched.has(d)){a=s;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,n,r,i,a){let o=this.top.children[i];return o.dirty==ba&&o.dom==o.contentDOM&&(o.dirty=Gs),o.update(e,n,r,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,a,o){for(let s=this.index;s<this.top.children.length;s++){let c=this.top.children[s];if(c instanceof ts){let d=this.preMatch.matched.get(c);if(d!=null&&d!=a)return!1;let h=c.dom,p,x=this.isLocked(h)&&!(e.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==e.text&&c.dirty!=ba&&Ap(n,c.outerDeco));if(!x&&c.update(e,n,r,i))return this.destroyBetween(this.index,s),c.dom!=h&&(this.changed=!0),this.index++,!0;if(!x&&(p=this.recreateWrapper(c,e,n,r,i,o)))return this.destroyBetween(this.index,s),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=Gs,p.updateChildren(i,o+1),p.dirty=ji),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,a,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Ap(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let s=ts.create(this.top,n,r,i,a,o);if(s.contentDOM){s.children=e.children,e.children=[];for(let c of s.children)c.parent=s}return e.destroy(),s}addNode(e,n,r,i,a){let o=ts.create(this.top,e,n,r,i,a);o.contentDOM&&o.updateChildren(i,a+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new rk(this.top,e,n,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof ul;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof z0)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Tr||br)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new ik(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Aj(t,e){let n=e,r=n.children.length,i=t.childCount,a=new Map,o=[];e:for(;i>0;){let s;for(;;)if(r){let d=n.children[r-1];if(d instanceof ul)n=d,r=d.children.length;else{s=d,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let c=s.node;if(c){if(c!=t.child(i-1))break;--i,a.set(s,i),o.push(s)}}return{index:i,matched:a,matches:o.reverse()}}function _j(t,e){return t.type.side-e.type.side}function Nj(t,e,n,r){let i=e.locals(t),a=0;if(i.length==0){for(let d=0;d<t.childCount;d++){let h=t.child(d);r(h,i,e.forChild(a,h),d),a+=h.nodeSize}return}let o=0,s=[],c=null;for(let d=0;;){let h,p;for(;o<i.length&&i[o].to==a;){let E=i[o++];E.widget&&(h?(p||(p=[h])).push(E):h=E)}if(h)if(p){p.sort(_j);for(let E=0;E<p.length;E++)n(p[E],d,!!c)}else n(h,d,!!c);let x,v;if(c)v=-1,x=c,c=null;else if(d<t.childCount)v=d,x=t.child(d++);else break;for(let E=0;E<s.length;E++)s[E].to<=a&&s.splice(E--,1);for(;o<i.length&&i[o].from<=a&&i[o].to>a;)s.push(i[o++]);let b=a+x.nodeSize;if(x.isText){let E=b;o<i.length&&i[o].from<E&&(E=i[o].from);for(let S=0;S<s.length;S++)s[S].to<E&&(E=s[S].to);E<b&&(c=x.cut(E-a),x=x.cut(0,E-a),b=E,v=-1)}else for(;o<i.length&&i[o].to<b;)o++;let C=x.isInline&&!x.isLeaf?s.filter(E=>!E.inline):s.slice();r(x,C,e.forChild(a,x),v),a=b}}function kj(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function Tj(t,e,n,r){for(let i=0,a=0;i<t.childCount&&a<=r;){let o=t.child(i++),s=a;if(a+=o.nodeSize,!o.isText)continue;let c=o.text;for(;i<t.childCount;){let d=t.child(i++);if(a+=d.nodeSize,!d.isText)break;c+=d.text}if(a>=n){if(a>=r&&c.slice(r-e.length-s,r-s)==e)return r-e.length;let d=s<r?c.lastIndexOf(e,r-s-1):-1;if(d>=0&&d+e.length+s>=n)return s+d;if(n==r&&c.length>=r+e.length-s&&c.slice(r-s,r-s+e.length)==e)return r}}return-1}function cv(t,e,n,r,i){let a=[];for(let o=0,s=0;o<t.length;o++){let c=t[o],d=s,h=s+=c.size;d>=n||h<=e?a.push(c):(d<e&&a.push(c.slice(0,e-d,r)),i&&(a.push(i),i=void 0),h>n&&a.push(c.slice(n-d,c.size,r)))}return a}function Ry(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),a=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let s=r.resolve(o),c,d;if(F0(n)){for(c=o;i&&!i.node;)i=i.parent;let p=i.node;if(i&&p.isAtom&&$e.isSelectable(p)&&i.parent&&!(p.isInline&&nj(n.focusNode,n.focusOffset,i.dom))){let x=i.posBefore;d=new $e(o==x?s:r.resolve(x))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let p=o,x=o;for(let v=0;v<n.rangeCount;v++){let b=n.getRangeAt(v);p=Math.min(p,t.docView.posFromDOM(b.startContainer,b.startOffset,1)),x=Math.max(x,t.docView.posFromDOM(b.endContainer,b.endOffset,-1))}if(p<0)return null;[c,o]=x==t.state.selection.anchor?[x,p]:[p,x],s=r.resolve(o)}else c=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(c<0)return null}let h=r.resolve(c);if(!d){let p=e=="pointer"||t.state.selection.head<s.pos&&!a?1:-1;d=Ly(t,h,s,p)}return d}function lk(t){return t.editable?t.hasFocus():uk(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function to(t,e=!1){let n=t.state.selection;if(ck(t,n),!!lk(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&br){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&cl(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Ij(t);else{let{anchor:r,head:i}=n,a,o;US&&!(n instanceof Ge)&&(n.$from.parent.inlineContent||(a=HS(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=HS(t,n.to))),t.docView.setSelection(r,i,t,e),US&&(a&&VS(a),o&&VS(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Oj(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const US=Tr||br&&KN<63;function HS(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,a=r?n.childNodes[r-1]:null;if(Tr&&i&&i.contentEditable=="false")return jg(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return jg(i);if(a)return jg(a)}}function jg(t){return t.contentEditable="true",Tr&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function VS(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Oj(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!lk(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Ij(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,vr(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&ii&&es<=11&&(n.disabled=!0,n.disabled=!1)}function ck(t,e){if(e instanceof $e){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&($S(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else $S(t)}function $S(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Ly(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||Ge.between(e,n,r)}function GS(t){return t.editable&&!t.hasFocus()?!1:uk(t)}function uk(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Dj(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return cl(e.node,e.offset,n.anchorNode,n.anchorOffset)}function uv(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),a=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return a&&Ze.findFrom(a,e)}function Fo(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function WS(t,e,n){let r=t.state.selection;if(r instanceof Ge)if(n.indexOf("s")>-1){let{$head:i}=r,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+a.nodeSize*(e<0?-1:1));return Fo(t,new Ge(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=uv(t.state,e);return i&&i instanceof $e?Fo(t,i):!1}else if(!(Di&&n.indexOf("m")>-1)){let i=r.$head,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!a||a.isText)return!1;let s=e<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(o=t.docView.descAt(s))&&!o.contentDOM?$e.isSelectable(a)?Fo(t,new $e(e<0?t.state.doc.resolve(i.pos-a.nodeSize):i)):Wd?Fo(t,new Ge(t.state.doc.resolve(e<0?s:s+a.nodeSize))):!1:!1}}else return!1;else{if(r instanceof $e&&r.node.isInline)return Fo(t,new Ge(e>0?r.$to:r.$from));{let i=uv(t.state,e);return i?Fo(t,i):!1}}}function _p(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function sd(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ql(t,e){return e<0?Mj(t):Rj(t)}function Mj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,a,o=!1;for(Li&&n.nodeType==1&&r<_p(n)&&sd(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let s=n.childNodes[r-1];if(sd(s,-1))i=n,a=--r;else if(s.nodeType==3)n=s,r=n.nodeValue.length;else break}}else{if(dk(n))break;{let s=n.previousSibling;for(;s&&sd(s,-1);)i=n.parentNode,a=vr(s),s=s.previousSibling;if(s)n=s,r=_p(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?dv(t,n,r):i&&dv(t,i,a)}function Rj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=_p(n),a,o;for(;;)if(r<i){if(n.nodeType!=1)break;let s=n.childNodes[r];if(sd(s,1))a=n,o=++r;else break}else{if(dk(n))break;{let s=n.nextSibling;for(;s&&sd(s,1);)a=s.parentNode,o=vr(s)+1,s=s.nextSibling;if(s)n=s,r=0,i=_p(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}a&&dv(t,a,o)}function dk(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Lj(t,e){for(;t&&e==t.childNodes.length&&!Gd(t);)e=vr(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function jj(t,e){for(;t&&!e&&!Gd(t);)e=vr(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function dv(t,e,n){if(e.nodeType!=3){let a,o;(o=Lj(e,n))?(e=o,n=0):(a=jj(e,n))&&(e=a,n=a.nodeValue.length)}let r=t.domSelection();if(!r)return;if(F0(r)){let a=document.createRange();a.setEnd(e,n),a.setStart(e,n),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&to(t)},50)}function qS(t,e){let n=t.state.doc.resolve(e);if(!(br||YN)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let a=t.coordsAtPos(e-1),o=(a.top+a.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(e<n.end()){let a=t.coordsAtPos(e+1),o=(a.top+a.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function XS(t,e,n){let r=t.state.selection;if(r instanceof Ge&&!r.empty||n.indexOf("s")>-1||Di&&n.indexOf("m")>-1)return!1;let{$from:i,$to:a}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=uv(t.state,e);if(o&&o instanceof $e)return Fo(t,o)}if(!i.parent.inlineContent){let o=e<0?i:a,s=r instanceof gi?Ze.near(o,e):Ze.findFrom(o,e);return s?Fo(t,s):!1}return!1}function KS(t,e){if(!(t.state.selection instanceof Ge))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let o=t.state.tr;return e<0?o.delete(n.pos-a.nodeSize,n.pos):o.delete(n.pos,n.pos+a.nodeSize),t.dispatch(o),!0}return!1}function YS(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Pj(t){if(!Tr||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;YS(t,r,"true"),setTimeout(()=>YS(t,r,"false"),20)}return!1}function Bj(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Fj(t,e){let n=e.keyCode,r=Bj(e);if(n==8||Di&&n==72&&r=="c")return KS(t,-1)||Ql(t,-1);if(n==46&&!e.shiftKey||Di&&n==68&&r=="c")return KS(t,1)||Ql(t,1);if(n==13||n==27)return!0;if(n==37||Di&&n==66&&r=="c"){let i=n==37?qS(t,t.state.selection.from)=="ltr"?-1:1:-1;return WS(t,i,r)||Ql(t,i)}else if(n==39||Di&&n==70&&r=="c"){let i=n==39?qS(t,t.state.selection.from)=="ltr"?1:-1:1;return WS(t,i,r)||Ql(t,i)}else{if(n==38||Di&&n==80&&r=="c")return XS(t,-1,r)||Ql(t,-1);if(n==40||Di&&n==78&&r=="c")return Pj(t)||XS(t,1,r)||Ql(t,1);if(r==(Di?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function jy(t,e){t.someProp("transformCopied",v=>{e=v(e,t)});let n=[],{content:r,openStart:i,openEnd:a}=e;for(;i>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,a--;let v=r.firstChild;n.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),r=v.content}let o=t.someProp("clipboardSerializer")||ml.fromSchema(t.state.schema),s=xk(),c=s.createElement("div");c.appendChild(o.serializeFragment(r,{document:s}));let d=c.firstChild,h,p=0;for(;d&&d.nodeType==1&&(h=gk[d.nodeName.toLowerCase()]);){for(let v=h.length-1;v>=0;v--){let b=s.createElement(h[v]);for(;c.firstChild;)b.appendChild(c.firstChild);c.appendChild(b),p++}d=c.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${a}${p?` -${p}`:""} ${JSON.stringify(n)}`);let x=t.someProp("clipboardTextSerializer",v=>v(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:c,text:x,slice:e}}function fk(t,e,n,r,i){let a=i.parent.type.spec.code,o,s;if(!n&&!e)return null;let c=!!e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",x=>{e=x(e,a||r,t)}),a)return s=new Re(be.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",x=>{s=x(s,t,!0)}),s;let p=t.someProp("clipboardTextParser",x=>x(e,i,r,t));if(p)s=p;else{let x=i.marks(),{schema:v}=t.state,b=ml.fromSchema(v);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(C=>{let E=o.appendChild(document.createElement("p"));C&&E.appendChild(b.serializeNode(v.text(C,x)))})}}else t.someProp("transformPastedHTML",p=>{n=p(n,t)}),o=Vj(n),Wd&&$j(o);let d=o&&o.querySelector("[data-pm-slice]"),h=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let p=+h[3];p>0;p--){let x=o.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;o=x}if(s||(s=(t.someProp("clipboardParser")||t.someProp("domParser")||id.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(c||h),context:i,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!zj.test(x.parentNode.nodeName)?{ignore:!0}:null}})),h)s=Gj(ZS(s,+h[1],+h[2]),h[4]);else if(s=Re.maxOpen(Uj(s.content,i),!0),s.openStart||s.openEnd){let p=0,x=0;for(let v=s.content.firstChild;p<s.openStart&&!v.type.spec.isolating;p++,v=v.firstChild);for(let v=s.content.lastChild;x<s.openEnd&&!v.type.spec.isolating;x++,v=v.lastChild);s=ZS(s,p,x)}return t.someProp("transformPasted",p=>{s=p(s,t,c)}),s}const zj=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Uj(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),a,o=[];if(t.forEach(s=>{if(!o)return;let c=i.findWrapping(s.type),d;if(!c)return o=null;if(d=o.length&&a.length&&pk(c,a,s,o[o.length-1],0))o[o.length-1]=d;else{o.length&&(o[o.length-1]=mk(o[o.length-1],a.length));let h=hk(s,c);o.push(h),i=i.matchType(h.type),a=c}}),o)return be.from(o)}return t}function hk(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,be.from(t));return t}function pk(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let a=pk(t,e,n,r.lastChild,i+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(be.from(hk(n,t,i+1))))}}function mk(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,mk(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(be.empty,!0);return t.copy(n.append(r))}function fv(t,e,n,r,i,a){let o=e<0?t.firstChild:t.lastChild,s=o.content;return t.childCount>1&&(a=0),i<r-1&&(s=fv(s,e,n,r,i+1,a)),i>=n&&(s=e<0?o.contentMatchAt(0).fillBefore(s,a<=i).append(s):s.append(o.contentMatchAt(o.childCount).fillBefore(be.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(s))}function ZS(t,e,n){return e<t.openStart&&(t=new Re(fv(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new Re(fv(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const gk={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let JS=null;function xk(){return JS||(JS=document.implementation.createHTMLDocument("title"))}let Pg=null;function Hj(t){let e=window.trustedTypes;return e?(Pg||(Pg=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Pg.createHTML(t)):t}function Vj(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=xk().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&gk[r[1].toLowerCase()])&&(t=i.map(a=>"<"+a+">").join("")+t+i.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=Hj(t),i)for(let a=0;a<i.length;a++)n=n.querySelector(i[a])||n;return n}function $j(t){let e=t.querySelectorAll(br?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Gj(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:a,openEnd:o}=t;for(let s=r.length-2;s>=0;s-=2){let c=n.nodes[r[s]];if(!c||c.hasRequiredAttrs())break;i=be.from(c.create(r[s+1],i)),a++,o++}return new Re(i,a,o)}const Ur={},Hr={},Wj={touchstart:!0,touchmove:!0};class qj{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Xj(t){for(let e in Ur){let n=Ur[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Yj(t,r)&&!Py(t,r)&&(t.editable||!(r.type in Hr))&&n(t,r)},Wj[e]?{passive:!0}:void 0)}Tr&&t.dom.addEventListener("input",()=>null),hv(t)}function Jo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Kj(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function hv(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Py(t,r))})}function Py(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Yj(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Zj(t,e){!Py(t,e)&&Ur[e.type]&&(t.editable||!(e.type in Hr))&&Ur[e.type](t,e)}Hr.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!yk(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Ya&&br&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),_c&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Vs(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Fj(t,n)?n.preventDefault():Jo(t,"key")};Hr.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Hr.keypress=(t,e)=>{let n=e;if(yk(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Di&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Ge)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),a=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i,a))&&t.dispatch(a()),n.preventDefault()}};function U0(t){return{left:t.clientX,top:t.clientY}}function Jj(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function By(t,e,n,r,i){if(r==-1)return!1;let a=t.state.doc.resolve(r);for(let o=a.depth+1;o>0;o--)if(t.someProp(e,s=>o>a.depth?s(t,n,a.nodeAfter,a.before(o),i,!0):s(t,n,a.node(o),a.before(o),i,!1)))return!0;return!1}function fc(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Qj(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&$e.isSelectable(r)?(fc(t,new $e(n)),!0):!1}function eP(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof $e&&(r=n.node);let a=t.state.doc.resolve(e);for(let o=a.depth+1;o>0;o--){let s=o>a.depth?a.nodeAfter:a.node(o);if($e.isSelectable(s)){r&&n.$from.depth>0&&o>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?i=a.before(n.$from.depth):i=a.before(o);break}}return i!=null?(fc(t,$e.create(t.state.doc,i)),!0):!1}function tP(t,e,n,r,i){return By(t,"handleClickOn",e,n,r)||t.someProp("handleClick",a=>a(t,e,r))||(i?eP(t,n):Qj(t,n))}function nP(t,e,n,r){return By(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function rP(t,e,n,r){return By(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||iP(t,n,r)}function iP(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(fc(t,Ge.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let a=i.depth+1;a>0;a--){let o=a>i.depth?i.nodeAfter:i.node(a),s=i.before(a);if(o.inlineContent)fc(t,Ge.create(r,s+1,s+1+o.content.size));else if($e.isSelectable(o))fc(t,$e.create(r,s));else continue;return!0}}function Fy(t){return Np(t)}const vk=Di?"metaKey":"ctrlKey";Ur.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Fy(t),i=Date.now(),a="singleClick";i-t.input.lastClick.time<500&&Jj(n,t.input.lastClick)&&!n[vk]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:a,button:n.button};let o=t.posAtCoords(U0(n));o&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new aP(t,o,n,!!r)):(a=="doubleClick"?nP:rP)(t,o.pos,o.inside,n)?n.preventDefault():Jo(t,"pointer"))};class aP{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[vk],this.allowDefault=r.shiftKey;let a,o;if(n.inside>-1)a=e.state.doc.nodeAt(n.inside),o=n.inside;else{let h=e.state.doc.resolve(n.pos);a=h.parent,o=h.depth?h.before():0}const s=i?null:r.target,c=s?e.docView.nearestDesc(s,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;let{selection:d}=e.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||d instanceof $e&&d.from<=o&&d.to>o)&&(this.mightDrag={node:a,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Li&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Jo(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>to(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(U0(e))),this.updateAllowDefault(e),this.allowDefault||!n?Jo(this.view,"pointer"):tP(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Tr&&this.mightDrag&&!this.mightDrag.node.isAtom||br&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(fc(this.view,Ze.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Jo(this.view,"pointer")}move(e){this.updateAllowDefault(e),Jo(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ur.touchstart=t=>{t.input.lastTouch=Date.now(),Fy(t),Jo(t,"pointer")};Ur.touchmove=t=>{t.input.lastTouch=Date.now(),Jo(t,"pointer")};Ur.contextmenu=t=>Fy(t);function yk(t,e){return t.composing?!0:Tr&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const oP=Ya?5e3:-1;Hr.compositionstart=Hr.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Ge&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||br&&YN&&sP(t)))t.markCursor=t.state.storedMarks||n.marks(),Np(t,!0),t.markCursor=null;else if(Np(t,!e.selection.empty),Li&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,a=r.focusOffset;i&&i.nodeType==1&&a!=0;){let o=a<0?i.lastChild:i.childNodes[a-1];if(!o)break;if(o.nodeType==3){let s=t.domSelection();s&&s.collapse(o,o.nodeValue.length);break}else i=o,a=-1}}t.input.composing=!0}bk(t,oP)};function sP(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}Hr.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,bk(t,20))};function bk(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Np(t),e))}function wk(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=cP());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function lP(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=ej(e.focusNode,e.focusOffset),r=tj(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(n==a||r==a)return a;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function cP(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Np(t,e=!1){if(!(Ya&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),wk(t),e||t.docView&&t.docView.dirty){let n=Ry(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function uP(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const _d=ii&&es<15||_c&&aj<604;Ur.copy=Hr.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let a=_d?null:n.clipboardData,o=r.content(),{dom:s,text:c}=jy(t,o);a?(n.preventDefault(),a.clearData(),a.setData("text/html",s.innerHTML),a.setData("text/plain",c)):uP(t,s),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function dP(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function fP(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Nd(t,r.value,null,i,e):Nd(t,r.textContent,r.innerHTML,i,e)},50)}function Nd(t,e,n,r,i){let a=fk(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",c=>c(t,i,a||Re.empty)))return!0;if(!a)return!1;let o=dP(a),s=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(a);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Ck(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Hr.paste=(t,e)=>{let n=e;if(t.composing&&!Ya)return;let r=_d?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Nd(t,Ck(r),r.getData("text/html"),i,n)?n.preventDefault():fP(t,n)};class Ek{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const hP=Di?"altKey":"ctrlKey";function Sk(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[hP]}Ur.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,a=i.empty?null:t.posAtCoords(U0(n)),o;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof $e?i.to-1:i.to))){if(r&&r.mightDrag)o=$e.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let p=t.docView.nearestDesc(n.target,!0);p&&p.node.type.spec.draggable&&p!=t.docView&&(o=$e.create(t.state.doc,p.posBefore))}}let s=(o||t.state.selection).content(),{dom:c,text:d,slice:h}=jy(t,s);(!n.dataTransfer.files.length||!br||KN>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(_d?"Text":"text/html",c.innerHTML),n.dataTransfer.effectAllowed="copyMove",_d||n.dataTransfer.setData("text/plain",d),t.dragging=new Ek(h,Sk(t,n),o)};Ur.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Hr.dragover=Hr.dragenter=(t,e)=>e.preventDefault();Hr.drop=(t,e)=>{try{pP(t,e,t.dragging)}finally{t.dragging=null}};function pP(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(U0(e));if(!r)return;let i=t.state.doc.resolve(r.pos),a=n&&n.slice;a?t.someProp("transformPasted",v=>{a=v(a,t,!1)}):a=fk(t,Ck(e.dataTransfer),_d?null:e.dataTransfer.getData("text/html"),!1,i);let o=!!(n&&Sk(t,e));if(t.someProp("handleDrop",v=>v(t,e,a||Re.empty,o))){e.preventDefault();return}if(!a)return;e.preventDefault();let s=a?kN(t.state.doc,i.pos,a):i.pos;s==null&&(s=i.pos);let c=t.state.tr;if(o){let{node:v}=n;v?v.replace(c):c.deleteSelection()}let d=c.mapping.map(s),h=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,p=c.doc;if(h?c.replaceRangeWith(d,d,a.content.firstChild):c.replaceRange(d,d,a),c.doc.eq(p))return;let x=c.doc.resolve(d);if(h&&$e.isSelectable(a.content.firstChild)&&x.nodeAfter&&x.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new $e(x));else{let v=c.mapping.map(s);c.mapping.maps[c.mapping.maps.length-1].forEach((b,C,E,S)=>v=S),c.setSelection(Ly(t,x,c.doc.resolve(v)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}Ur.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&to(t)},20))};Ur.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Ur.beforeinput=(t,e)=>{if(br&&Ya&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,Vs(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Hr)Ur[t]=Hr[t];function kd(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class kp{constructor(e,n){this.toDOM=e,this.spec=n||tl,this.side=this.spec.side||0}map(e,n,r,i){let{pos:a,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new nr(a-r,a-r,this)}valid(){return!0}eq(e){return this==e||e instanceof kp&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&kd(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ns{constructor(e,n){this.attrs=e,this.spec=n||tl}map(e,n,r,i){let a=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return a>=o?null:new nr(a,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof ns&&kd(this.attrs,e.attrs)&&kd(this.spec,e.spec)}static is(e){return e.type instanceof ns}destroy(){}}class zy{constructor(e,n){this.attrs=e,this.spec=n||tl}map(e,n,r,i){let a=e.mapResult(n.from+i,1);if(a.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=a.pos?null:new nr(a.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),a;return i==n.from&&!(a=e.child(r)).isText&&i+a.nodeSize==n.to}eq(e){return this==e||e instanceof zy&&kd(this.attrs,e.attrs)&&kd(this.spec,e.spec)}destroy(){}}class nr{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new nr(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new nr(e,e,new kp(n,r))}static inline(e,n,r,i){return new nr(e,n,new ns(r,i))}static node(e,n,r,i){return new nr(e,n,new zy(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof ns}get widget(){return this.type instanceof kp}}const nc=[],tl={};class Jt{constructor(e,n){this.local=e.length?e:nc,this.children=n.length?n:nc}static create(e,n){return n.length?Tp(n,e,0,tl):kr}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,a){for(let o=0;o<this.local.length;o++){let s=this.local[o];s.from<=n&&s.to>=e&&(!a||a(s.spec))&&r.push(s.copy(s.from+i,s.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let s=this.children[o]+1;this.children[o+2].findInner(e-s,n-s,r,i+s,a)}}map(e,n,r){return this==kr||e.maps.length==0?this:this.mapInner(e,n,0,0,r||tl)}mapInner(e,n,r,i,a){let o;for(let s=0;s<this.local.length;s++){let c=this.local[s].map(e,r,i);c&&c.type.valid(n,c)?(o||(o=[])).push(c):a.onRemove&&a.onRemove(this.local[s].spec)}return this.children.length?mP(this.children,o||[],e,n,r,i,a):o?new Jt(o.sort(nl),nc):kr}add(e,n){return n.length?this==kr?Jt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,a=0;e.forEach((s,c)=>{let d=c+r,h;if(h=_k(n,s,d)){for(i||(i=this.children.slice());a<i.length&&i[a]<c;)a+=3;i[a]==c?i[a+2]=i[a+2].addInner(s,h,d+1):i.splice(a,0,c,c+s.nodeSize,Tp(h,s,d+1,tl)),a+=3}});let o=Ak(a?Nk(n):n,-r);for(let s=0;s<o.length;s++)o[s].type.valid(e,o[s])||o.splice(s--,1);return new Jt(o.length?this.local.concat(o).sort(nl):this.local,i||this.children)}remove(e){return e.length==0||this==kr?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let a=0;a<r.length;a+=3){let o,s=r[a]+n,c=r[a+1]+n;for(let h=0,p;h<e.length;h++)(p=e[h])&&p.from>s&&p.to<c&&(e[h]=null,(o||(o=[])).push(p));if(!o)continue;r==this.children&&(r=this.children.slice());let d=r[a+2].removeInner(o,s+1);d!=kr?r[a+2]=d:(r.splice(a,3),a-=3)}if(i.length){for(let a=0,o;a<e.length;a++)if(o=e[a])for(let s=0;s<i.length;s++)i[s].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(s--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Jt(i,r):kr}forChild(e,n){if(this==kr)return this;if(n.isLeaf)return Jt.empty;let r,i;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(r=this.children[s+2]);break}let a=e+1,o=a+n.content.size;for(let s=0;s<this.local.length;s++){let c=this.local[s];if(c.from<o&&c.to>a&&c.type instanceof ns){let d=Math.max(a,c.from)-a,h=Math.min(o,c.to)-a;d<h&&(i||(i=[])).push(c.copy(d,h))}}if(i){let s=new Jt(i.sort(nl),nc);return r?new Vo([s,r]):s}return r||kr}eq(e){if(this==e)return!0;if(!(e instanceof Jt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Uy(this.localsInner(e))}localsInner(e){if(this==kr)return nc;if(e.inlineContent||!this.local.some(ns.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ns||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Jt.empty=new Jt([],[]);Jt.removeOverlap=Uy;const kr=Jt.empty;class Vo{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,tl));return Vo.from(r)}forChild(e,n){if(n.isLeaf)return Jt.empty;let r=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(e,n);a!=kr&&(a instanceof Vo?r=r.concat(a.members):r.push(a))}return Vo.from(r)}eq(e){if(!(e instanceof Vo)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(e);if(a.length)if(!n)n=a;else{r&&(n=n.slice(),r=!1);for(let o=0;o<a.length;o++)n.push(a[o])}}return n?Uy(r?n:n.sort(nl)):nc}static from(e){switch(e.length){case 0:return kr;case 1:return e[0];default:return new Vo(e.every(n=>n instanceof Jt)?e:e.reduce((n,r)=>n.concat(r instanceof Jt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function mP(t,e,n,r,i,a,o){let s=t.slice();for(let d=0,h=a;d<n.maps.length;d++){let p=0;n.maps[d].forEach((x,v,b,C)=>{let E=C-b-(v-x);for(let S=0;S<s.length;S+=3){let N=s[S+1];if(N<0||x>N+h-p)continue;let k=s[S]+h-p;v>=k?s[S+1]=x<=k?-2:-1:x>=h&&E&&(s[S]+=E,s[S+1]+=E)}p+=E}),h=n.maps[d].map(h,-1)}let c=!1;for(let d=0;d<s.length;d+=3)if(s[d+1]<0){if(s[d+1]==-2){c=!0,s[d+1]=-1;continue}let h=n.map(t[d]+a),p=h-i;if(p<0||p>=r.content.size){c=!0;continue}let x=n.map(t[d+1]+a,-1),v=x-i,{index:b,offset:C}=r.content.findIndex(p),E=r.maybeChild(b);if(E&&C==p&&C+E.nodeSize==v){let S=s[d+2].mapInner(n,E,h+1,t[d]+a+1,o);S!=kr?(s[d]=p,s[d+1]=v,s[d+2]=S):(s[d+1]=-2,c=!0)}else c=!0}if(c){let d=gP(s,t,e,n,i,a,o),h=Tp(d,r,0,o);e=h.local;for(let p=0;p<s.length;p+=3)s[p+1]<0&&(s.splice(p,3),p-=3);for(let p=0,x=0;p<h.children.length;p+=3){let v=h.children[p];for(;x<s.length&&s[x]<v;)x+=3;s.splice(x,0,h.children[p],h.children[p+1],h.children[p+2])}}return new Jt(e.sort(nl),s)}function Ak(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new nr(i.from+e,i.to+e,i.type))}return n}function gP(t,e,n,r,i,a,o){function s(c,d){for(let h=0;h<c.local.length;h++){let p=c.local[h].map(r,i,d);p?n.push(p):o.onRemove&&o.onRemove(c.local[h].spec)}for(let h=0;h<c.children.length;h+=3)s(c.children[h+2],c.children[h]+d+1)}for(let c=0;c<t.length;c+=3)t[c+1]==-1&&s(t[c+2],e[c]+a+1);return n}function _k(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let a=0,o;a<t.length;a++)(o=t[a])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[a]=null);return i}function Nk(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Tp(t,e,n,r){let i=[],a=!1;e.forEach((s,c)=>{let d=_k(t,s,c+n);if(d){a=!0;let h=Tp(d,s,n+c+1,r);h!=kr&&i.push(c,c+s.nodeSize,h)}});let o=Ak(a?Nk(t):t,-n).sort(nl);for(let s=0;s<o.length;s++)o[s].type.valid(e,o[s])||(r.onRemove&&r.onRemove(o[s].spec),o.splice(s--,1));return o.length||i.length?new Jt(o,i):kr}function nl(t,e){return t.from-e.from||t.to-e.to}function Uy(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let a=e[i];if(a.from==r.from){a.to!=r.to&&(e==t&&(e=t.slice()),e[i]=a.copy(a.from,r.to),QS(e,i+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,a.from),QS(e,i,r.copy(a.from,r.to)));break}}}return e}function QS(t,e,n){for(;e<t.length&&nl(n,t[e])>0;)e++;t.splice(e,0,n)}function Bg(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=kr&&e.push(r)}),t.cursorWrapper&&e.push(Jt.create(t.state.doc,[t.cursorWrapper.deco])),Vo.from(e)}const xP={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},vP=ii&&es<=11;class yP{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class bP{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new yP,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);ii&&es<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Tr&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),vP&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xP)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(GS(this.view)){if(this.suppressingSelectionUpdates)return to(this.view);if(ii&&es<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&cl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let a=e.focusNode;a;a=Ac(a))n.add(a);for(let a=e.anchorNode;a;a=Ac(a))if(n.has(a)){r=a;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&GS(e)&&!this.ignoreSelectionChange(r),a=-1,o=-1,s=!1,c=[];if(e.editable)for(let h=0;h<n.length;h++){let p=this.registerMutation(n[h],c);p&&(a=a<0?p.from:Math.min(p.from,a),o=o<0?p.to:Math.max(p.to,o),p.typeOver&&(s=!0))}if(c.some(h=>h.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let h of c)if(h.nodeName=="BR"&&h.parentNode){let p=h.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&h.parentNode.removeChild(h)}}else if(Li&&c.length){let h=c.filter(p=>p.nodeName=="BR");if(h.length==2){let[p,x]=h;p.parentNode&&p.parentNode.parentNode==x.parentNode?x.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let x of h){let v=x.parentNode;v&&v.nodeName=="LI"&&(!p||EP(e,p)!=v)&&x.remove()}}}let d=null;a<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&F0(r)&&(d=Ry(e))&&d.eq(Ze.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,to(e),this.currentSelection.set(r),e.scrollToSelection()):(a>-1||i)&&(a>-1&&(e.docView.markDirty(a,o),wP(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,SP(e,c)),this.handleDOMChange(a,o,s,c),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||to(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let h=0;h<e.addedNodes.length;h++){let p=e.addedNodes[h];n.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,a=e.nextSibling;if(ii&&es<=11&&e.addedNodes.length)for(let h=0;h<e.addedNodes.length;h++){let{previousSibling:p,nextSibling:x}=e.addedNodes[h];(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p),(!x||Array.prototype.indexOf.call(e.addedNodes,x)<0)&&(a=x)}let o=i&&i.parentNode==e.target?vr(i)+1:0,s=r.localPosFromDOM(e.target,o,-1),c=a&&a.parentNode==e.target?vr(a):e.target.childNodes.length,d=r.localPosFromDOM(e.target,c,1);return{from:s,to:d}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let eA=new WeakMap,tA=!1;function wP(t){if(!eA.has(t)&&(eA.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Li,tA)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),tA=!0}}function nA(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,a=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return cl(o.node,o.offset,i,a)&&([n,r,i,a]=[i,a,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:a}}function CP(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return nA(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?nA(t,n):null}function EP(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function SP(t,e){var n;let{focusNode:r,focusOffset:i}=t.domSelectionRange();for(let a of e)if(((n=a.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let o=a.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let s=o;for(;;){let c=s.firstChild;if(!c||c.nodeType!=1||c.contentEditable=="false"||/^(BR|IMG)$/.test(c.nodeName))break;s=c}s.insertBefore(a,s.firstChild),r==a&&t.domSelection().collapse(a,i)}else a.parentNode.removeChild(a)}}function AP(t,e,n){let{node:r,fromOffset:i,toOffset:a,from:o,to:s}=t.docView.parseRange(e,n),c=t.domSelectionRange(),d,h=c.anchorNode;if(h&&t.dom.contains(h.nodeType==1?h:h.parentNode)&&(d=[{node:h,offset:c.anchorOffset}],F0(c)||d.push({node:c.focusNode,offset:c.focusOffset})),br&&t.input.lastKeyCode===8)for(let E=a;E>i;E--){let S=r.childNodes[E-1],N=S.pmViewDesc;if(S.nodeName=="BR"&&!N){a=E;break}if(!N||N.size)break}let p=t.state.doc,x=t.someProp("domParser")||id.fromSchema(t.state.schema),v=p.resolve(o),b=null,C=x.parse(r,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:a,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:_P,context:v});if(d&&d[0].pos!=null){let E=d[0].pos,S=d[1]&&d[1].pos;S==null&&(S=E),b={anchor:E+o,head:S+o}}return{doc:C,sel:b,from:o,to:s}}function _P(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Tr&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Tr&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const NP=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function kP(t,e,n,r,i){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,j=Ry(t,O);if(j&&!t.state.selection.eq(j)){if(br&&Ya&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",fe=>fe(t,Vs(13,"Enter"))))return;let U=t.state.tr.setSelection(j);O=="pointer"?U.setMeta("pointer",!0):O=="key"&&U.scrollIntoView(),a&&U.setMeta("composition",a),t.dispatch(U)}return}let o=t.state.doc.resolve(e),s=o.sharedDepth(n);e=o.before(s+1),n=t.state.doc.resolve(n).after(s+1);let c=t.state.selection,d=AP(t,e,n),h=t.state.doc,p=h.slice(d.from,d.to),x,v;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(x=t.state.selection.to,v="end"):(x=t.state.selection.from,v="start"),t.input.lastKeyCode=null;let b=IP(p.content,d.doc.content,d.from,x,v);if(b&&t.input.domChangeCount++,(_c&&t.input.lastIOSEnter>Date.now()-225||Ya)&&i.some(O=>O.nodeType==1&&!NP.test(O.nodeName))&&(!b||b.endA>=b.endB)&&t.someProp("handleKeyDown",O=>O(t,Vs(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!b)if(r&&c instanceof Ge&&!c.empty&&c.$head.sameParent(c.$anchor)&&!t.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))b={start:c.from,endA:c.to,endB:c.to};else{if(d.sel){let O=rA(t,t.state.doc,d.sel);if(O&&!O.eq(t.state.selection)){let j=t.state.tr.setSelection(O);a&&j.setMeta("composition",a),t.dispatch(j)}}return}t.state.selection.from<t.state.selection.to&&b.start==b.endB&&t.state.selection instanceof Ge&&(b.start>t.state.selection.from&&b.start<=t.state.selection.from+2&&t.state.selection.from>=d.from?b.start=t.state.selection.from:b.endA<t.state.selection.to&&b.endA>=t.state.selection.to-2&&t.state.selection.to<=d.to&&(b.endB+=t.state.selection.to-b.endA,b.endA=t.state.selection.to)),ii&&es<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>d.from&&d.doc.textBetween(b.start-d.from-1,b.start-d.from+1)==" "&&(b.start--,b.endA--,b.endB--);let C=d.doc.resolveNoCache(b.start-d.from),E=d.doc.resolveNoCache(b.endB-d.from),S=h.resolve(b.start),N=C.sameParent(E)&&C.parent.inlineContent&&S.end()>=b.endA;if((_c&&t.input.lastIOSEnter>Date.now()-225&&(!N||i.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!N&&C.pos<d.doc.content.size&&(!C.sameParent(E)||!C.parent.inlineContent)&&C.pos<E.pos&&!/\S/.test(d.doc.textBetween(C.pos,E.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,Vs(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>b.start&&OP(h,b.start,b.endA,C,E)&&t.someProp("handleKeyDown",O=>O(t,Vs(8,"Backspace")))){Ya&&br&&t.domObserver.suppressSelectionUpdates();return}br&&b.endB==b.start&&(t.input.lastChromeDelete=Date.now()),Ya&&!N&&C.start()!=E.start()&&E.parentOffset==0&&C.depth==E.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==b.endA&&(b.endB-=2,E=d.doc.resolveNoCache(b.endB-d.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Vs(13,"Enter"))})},20));let k=b.start,I=b.endA,D=O=>{let j=O||t.state.tr.replace(k,I,d.doc.slice(b.start-d.from,b.endB-d.from));if(d.sel){let U=rA(t,j.doc,d.sel);U&&!(br&&t.composing&&U.empty&&(b.start!=b.endB||t.input.lastChromeDelete<Date.now()-100)&&(U.head==k||U.head==j.mapping.map(I)-1)||ii&&U.empty&&U.head==k)&&j.setSelection(U)}return a&&j.setMeta("composition",a),j.scrollIntoView()},L;if(N)if(C.pos==E.pos){ii&&es<=11&&C.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>to(t),20));let O=D(t.state.tr.delete(k,I)),j=h.resolve(b.start).marksAcross(h.resolve(b.endA));j&&O.ensureMarks(j),t.dispatch(O)}else if(b.endA==b.endB&&(L=TP(C.parent.content.cut(C.parentOffset,E.parentOffset),S.parent.content.cut(S.parentOffset,b.endA-S.start())))){let O=D(t.state.tr);L.type=="add"?O.addMark(k,I,L.mark):O.removeMark(k,I,L.mark),t.dispatch(O)}else if(C.parent.child(C.index()).isText&&C.index()==E.index()-(E.textOffset?0:1)){let O=C.parent.textBetween(C.parentOffset,E.parentOffset),j=()=>D(t.state.tr.insertText(O,k,I));t.someProp("handleTextInput",U=>U(t,k,I,O,j))||t.dispatch(j())}else t.dispatch(D());else t.dispatch(D())}function rA(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Ly(t,e.resolve(n.anchor),e.resolve(n.head))}function TP(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,a=r,o,s,c;for(let h=0;h<r.length;h++)i=r[h].removeFromSet(i);for(let h=0;h<n.length;h++)a=n[h].removeFromSet(a);if(i.length==1&&a.length==0)s=i[0],o="add",c=h=>h.mark(s.addToSet(h.marks));else if(i.length==0&&a.length==1)s=a[0],o="remove",c=h=>h.mark(s.removeFromSet(h.marks));else return null;let d=[];for(let h=0;h<e.childCount;h++)d.push(c(e.child(h)));if(be.from(d).eq(t))return{mark:s,type:o}}function OP(t,e,n,r,i){if(n-e<=i.pos-r.pos||Fg(r,!0,!1)<i.pos)return!1;let a=t.resolve(e);if(!r.parent.isTextblock){let s=a.nodeAfter;return s!=null&&n==e+s.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let o=t.resolve(Fg(a,!0,!0));return!o.parent.isTextblock||o.pos>n||Fg(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Fg(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let a=t.node(r).maybeChild(t.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function IP(t,e,n,r,i){let a=t.findDiffStart(e,n);if(a==null)return null;let{a:o,b:s}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let c=Math.max(0,a-Math.min(o,s));r-=o+c-a}if(o<a&&t.size<e.size){let c=r<=a&&r>=o?a-r:0;a-=c,a&&a<e.size&&iA(e.textBetween(a-1,a+1))&&(a+=c?1:-1),s=a+(s-o),o=a}else if(s<a){let c=r<=a&&r>=s?a-r:0;a-=c,a&&a<t.size&&iA(t.textBetween(a-1,a+1))&&(a+=c?1:-1),o=a+(o-s),s=a}return{start:a,endA:o,endB:s}}function iA(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class kk{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new qj,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(cA),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=sA(this),oA(this),this.nodeViews=lA(this),this.docView=FS(this.state.doc,aA(this),Bg(this),this.dom,this),this.domObserver=new bP(this,(r,i,a,o)=>kP(this,r,i,a,o)),this.domObserver.start(),Xj(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&hv(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(cA),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,a=!1,o=!1;e.storedMarks&&this.composing&&(wk(this),o=!0),this.state=e;let s=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(s||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let v=lA(this);MP(v,this.nodeViews)&&(this.nodeViews=v,a=!0)}(s||n.handleDOMEvents!=this._props.handleDOMEvents)&&hv(this),this.editable=sA(this),oA(this);let c=Bg(this),d=aA(this),h=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",p=a||!this.docView.matchesNode(e.doc,d,c);(p||!e.selection.eq(i.selection))&&(o=!0);let x=h=="preserve"&&o&&this.dom.style.overflowAnchor==null&&lj(this);if(o){this.domObserver.stop();let v=p&&(ii||br)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&DP(i.selection,e.selection);if(p){let b=br?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=lP(this)),(a||!this.docView.update(e.doc,d,c,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=FS(e.doc,d,c,this.dom,this)),b&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Dj(this))?to(this,v):(ck(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():x&&cj(x)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof $e){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&MS(this,n.getBoundingClientRect(),e)}else MS(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let a=r.from+(this.state.doc.content.size-n.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==r.node&&(i=a)}this.dragging=new Ek(e.slice,e.move,i<0?void 0:$e.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let s=this.directPlugins[o].props[e];if(s!=null&&(i=n?n(s):s))return i}let a=this.state.plugins;if(a)for(let o=0;o<a.length;o++){let s=a[o].props[e];if(s!=null&&(i=n?n(s):s))return i}}hasFocus(){if(ii){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&uj(this.dom),to(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return mj(this,e)}coordsAtPos(e,n=1){return tk(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return bj(this,n||this.state,e)}pasteHTML(e,n){return Nd(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Nd(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return jy(this,e)}destroy(){this.docView&&(Kj(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Bg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,JL())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Zj(this,e)}domSelectionRange(){let e=this.domSelection();return e?Tr&&this.root.nodeType===11&&rj(this.dom.ownerDocument)==this.dom&&CP(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}kk.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function aA(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[nr.node(0,t.state.doc.content.size,e)]}function oA(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:nr.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function sA(t){return!t.someProp("editable",e=>e(t.state)===!1)}function DP(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function lA(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function MP(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function cA(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ls={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Op={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},RP=typeof navigator<"u"&&/Mac/.test(navigator.platform),LP=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var yr=0;yr<10;yr++)ls[48+yr]=ls[96+yr]=String(yr);for(var yr=1;yr<=24;yr++)ls[yr+111]="F"+yr;for(var yr=65;yr<=90;yr++)ls[yr]=String.fromCharCode(yr+32),Op[yr]=String.fromCharCode(yr);for(var zg in ls)Op.hasOwnProperty(zg)||(Op[zg]=ls[zg]);function jP(t){var e=RP&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||LP&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Op:ls)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const PP=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),BP=typeof navigator<"u"&&/Win/.test(navigator.platform);function FP(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,a,o;for(let s=0;s<e.length-1;s++){let c=e[s];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))PP?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function zP(t){let e=Object.create(null);for(let n in t)e[FP(n)]=t[n];return e}function Ug(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function UP(t){return new dn({props:{handleKeyDown:Hy(t)}})}function Hy(t){let e=zP(t);return function(n,r){let i=jP(r),a,o=e[Ug(i,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let s=e[Ug(i,r,!1)];if(s&&s(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(BP&&r.ctrlKey&&r.altKey)&&(a=ls[r.keyCode])&&a!=i){let s=e[Ug(a,r)];if(s&&s(n.state,n.dispatch,n))return!0}}return!1}}var HP=Object.defineProperty,Vy=(t,e)=>{for(var n in e)HP(t,n,{get:e[n],enumerable:!0})};function H0(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:a}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,a=n.storedMarks,n}}}var V0=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:i}=n,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([o,s])=>[o,(...d)=>{const h=s(...d)(a);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:a}=r,o=[],s=!!t,c=t||i.tr,d=()=>(!s&&e&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(c),o.every(p=>p===!0)),h={...Object.fromEntries(Object.entries(n).map(([p,x])=>[p,(...b)=>{const C=this.buildProps(c,e),E=x(...b)(C);return o.push(E),h}])),run:d};return h}createCan(t){const{rawCommands:e,state:n}=this,r=!1,i=t||n.tr,a=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([s,c])=>[s,(...d)=>c(...d)({...a,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:a}=r,o={tr:t,editor:r,view:a,state:H0({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([s,c])=>[s,(...d)=>c(...d)(o)]))}};return o}},Tk={};Vy(Tk,{blur:()=>VP,clearContent:()=>$P,clearNodes:()=>GP,command:()=>WP,createParagraphNear:()=>qP,cut:()=>XP,deleteCurrentNode:()=>KP,deleteNode:()=>YP,deleteRange:()=>ZP,deleteSelection:()=>JP,enter:()=>QP,exitCode:()=>eB,extendMarkRange:()=>tB,first:()=>nB,focus:()=>iB,forEach:()=>aB,insertContent:()=>oB,insertContentAt:()=>cB,joinBackward:()=>fB,joinDown:()=>dB,joinForward:()=>hB,joinItemBackward:()=>pB,joinItemForward:()=>mB,joinTextblockBackward:()=>gB,joinTextblockForward:()=>xB,joinUp:()=>uB,keyboardShortcut:()=>yB,lift:()=>bB,liftEmptyBlock:()=>wB,liftListItem:()=>CB,newlineInCode:()=>EB,resetAttributes:()=>SB,scrollIntoView:()=>AB,selectAll:()=>_B,selectNodeBackward:()=>NB,selectNodeForward:()=>kB,selectParentNode:()=>TB,selectTextblockEnd:()=>OB,selectTextblockStart:()=>IB,setContent:()=>DB,setMark:()=>ZB,setMeta:()=>JB,setNode:()=>QB,setNodeSelection:()=>eF,setTextDirection:()=>tF,setTextSelection:()=>nF,sinkListItem:()=>rF,splitBlock:()=>iF,splitListItem:()=>aF,toggleList:()=>oF,toggleMark:()=>sF,toggleNode:()=>lF,toggleWrap:()=>cF,undoInputRule:()=>uF,unsetAllMarks:()=>dF,unsetMark:()=>fF,unsetTextDirection:()=>hF,updateAttributes:()=>pF,wrapIn:()=>mF,wrapInList:()=>gF});var VP=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),$P=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),GP=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:a,$to:o})=>{t.doc.nodesBetween(a.pos,o.pos,(s,c)=>{if(s.type.isText)return;const{doc:d,mapping:h}=e,p=d.resolve(h.map(c)),x=d.resolve(h.map(c+s.nodeSize)),v=p.blockRange(x);if(!v)return;const b=Bc(v);if(s.type.isTextblock){const{defaultType:C}=p.parent.contentMatchAt(p.index());e.setNodeMarkup(v.start,C)}(b||b===0)&&e.lift(v,b)})}),!0},WP=t=>e=>t(e),qP=()=>({state:t,dispatch:e})=>$N(t,e),XP=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,a=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,a.content),r.setSelection(new Ge(r.doc.resolve(Math.max(o-1,0)))),!0},KP=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===r.type){if(e){const s=i.before(a),c=i.after(a);t.delete(s,c).scrollIntoView()}return!0}return!1};function Bn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var YP=t=>({tr:e,state:n,dispatch:r})=>{const i=Bn(t,n.schema),a=e.selection.$anchor;for(let o=a.depth;o>0;o-=1)if(a.node(o).type===i){if(r){const c=a.before(o),d=a.after(o);e.delete(c,d).scrollIntoView()}return!0}return!1},ZP=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},JP=()=>({state:t,dispatch:e})=>ky(t,e),QP=()=>({commands:t})=>t.keyboardShortcut("Enter"),eB=()=>({state:t,dispatch:e})=>PL(t,e);function $y(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ip(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:$y(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function Ok(t,e,n={}){return t.find(r=>r.type===e&&Ip(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function uA(t,e,n={}){return!!Ok(t,e,n)}function Gy(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===e)||(n=n||((r=i.node.marks[0])==null?void 0:r.attrs),!Ok([...i.node.marks],e,n)))return;let o=i.index,s=t.start()+i.offset,c=o+1,d=s+i.node.nodeSize;for(;o>0&&uA([...t.parent.child(o-1).marks],e,n);)o-=1,s-=t.parent.child(o).nodeSize;for(;c<t.parent.childCount&&uA([...t.parent.child(c).marks],e,n);)d+=t.parent.child(c).nodeSize,c+=1;return{from:s,to:d}}function so(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var tB=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const a=so(t,r.schema),{doc:o,selection:s}=n,{$from:c,from:d,to:h}=s;if(i){const p=Gy(c,a,e);if(p&&p.from<=d&&p.to>=h){const x=Ge.create(o,p.from,p.to);n.setSelection(x)}}return!0},nB=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Ik(t){return t instanceof Ge}function qs(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Dk(t,e=null){if(!e)return null;const n=Ze.atStart(t),r=Ze.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,a=r.to;return e==="all"?Ge.create(t,qs(0,i,a),qs(t.content.size,i,a)):Ge.create(t,qs(e,i,a),qs(e,i,a))}function dA(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Dp(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function rB(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var iB=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:a})=>{e={scrollIntoView:!0,...e};const o=()=>{(Dp()||dA())&&r.dom.focus(),rB()&&!Dp()&&!dA()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};try{if(r.hasFocus()&&t===null||t===!1)return!0}catch{return!1}if(a&&t===null&&!Ik(n.state.selection))return o(),!0;const s=Dk(i.doc,t)||n.state.selection,c=n.state.selection.eq(s);return a&&(c||i.setSelection(s),c&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},aB=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),oB=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Mk=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Mk(r)}return t};function yh(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Mk(n)}function Td(t,e,n){if(t instanceof Ji||t instanceof be)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return be.fromArray(t.map(s=>e.nodeFromJSON(s)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(a){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),Td("",e,n)}if(i){if(n.errorOnInvalidContent){let o=!1,s="";const c=new xN({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(o=!0,s=typeof d=="string"?d:d.outerHTML,null)}]}})});if(n.slice?id.fromSchema(c).parseSlice(yh(t),n.parseOptions):id.fromSchema(c).parse(yh(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${s}`)})}const a=id.fromSchema(e);return n.slice?a.parseSlice(yh(t),n.parseOptions).content:a.parse(yh(t),n.parseOptions)}return Td("",e,n)}function sB(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof er||i instanceof ir))return;const a=t.mapping.maps[r];let o=0;a.forEach((s,c,d,h)=>{o===0&&(o=h)}),t.setSelection(Ze.near(t.doc.resolve(o),n))}var lB=t=>!("type"in t),cB=(t,e,n)=>({tr:r,dispatch:i,editor:a})=>{var o;if(i){n={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let s;const c=E=>{a.emit("contentError",{editor:a,error:E,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},d={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{Td(e,a.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(E){c(E)}try{s=Td(e,a.schema,{parseOptions:d,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:a.options.enableContentCheck})}catch(E){return c(E),!1}let{from:h,to:p}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,v=!0;if((lB(s)?s:[s]).forEach(E=>{E.check(),x=x?E.isText&&E.marks.length===0:!1,v=v?E.isBlock:!1}),h===p&&v){const{parent:E}=r.doc.resolve(h);E.isTextblock&&!E.type.spec.code&&!E.childCount&&(h-=1,p+=1)}let C;if(x){if(Array.isArray(e))C=e.map(E=>E.text||"").join("");else if(e instanceof be){let E="";e.forEach(S=>{S.text&&(E+=S.text)}),C=E}else typeof e=="object"&&e&&e.text?C=e.text:C=e;r.insertText(C,h,p)}else{C=s;const E=r.doc.resolve(h),S=E.node(),N=E.parentOffset===0,k=S.isText||S.isTextblock,I=S.content.size>0;N&&k&&I&&(h=Math.max(0,h-1)),r.replaceWith(h,p,C)}n.updateSelection&&sB(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:h,text:C}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:h,text:C})}return!0},uB=()=>({state:t,dispatch:e})=>RL(t,e),dB=()=>({state:t,dispatch:e})=>LL(t,e),fB=()=>({state:t,dispatch:e})=>PN(t,e),hB=()=>({state:t,dispatch:e})=>UN(t,e),pB=()=>({state:t,dispatch:e,tr:n})=>{try{const r=j0(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},mB=()=>({state:t,dispatch:e,tr:n})=>{try{const r=j0(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},gB=()=>({state:t,dispatch:e})=>DL(t,e),xB=()=>({state:t,dispatch:e})=>ML(t,e);function Rk(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function vB(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,a,o;for(let s=0;s<e.length-1;s+=1){const c=e[s];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))Dp()||Rk()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}var yB=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const a=vB(t).split(/-(?!$)/),o=a.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),s=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{n.someProp("handleKeyDown",d=>d(n,s))});return c==null||c.steps.forEach(d=>{const h=d.map(r.mapping);h&&i&&r.maybeStep(h)}),!0};function cs(t,e,n={}){const{from:r,to:i,empty:a}=t.selection,o=e?Bn(e,t.schema):null,s=[];t.doc.nodesBetween(r,i,(p,x)=>{if(p.isText)return;const v=Math.max(r,x),b=Math.min(i,x+p.nodeSize);s.push({node:p,from:v,to:b})});const c=i-r,d=s.filter(p=>o?o.name===p.node.type.name:!0).filter(p=>Ip(p.node.attrs,n,{strict:!1}));return a?!!d.length:d.reduce((p,x)=>p+x.to-x.from,0)>=c}var bB=(t,e={})=>({state:n,dispatch:r})=>{const i=Bn(t,n.schema);return cs(n,i,e)?jL(n,r):!1},wB=()=>({state:t,dispatch:e})=>GN(t,e),CB=t=>({state:e,dispatch:n})=>{const r=Bn(t,e.schema);return XL(r)(e,n)},EB=()=>({state:t,dispatch:e})=>VN(t,e);function $0(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function fA(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}var SB=(t,e)=>({tr:n,state:r,dispatch:i})=>{let a=null,o=null;const s=$0(typeof t=="string"?t:t.name,r.schema);if(!s)return!1;s==="node"&&(a=Bn(t,r.schema)),s==="mark"&&(o=so(t,r.schema));let c=!1;return n.selection.ranges.forEach(d=>{r.doc.nodesBetween(d.$from.pos,d.$to.pos,(h,p)=>{a&&a===h.type&&(c=!0,i&&n.setNodeMarkup(p,void 0,fA(h.attrs,e))),o&&h.marks.length&&h.marks.forEach(x=>{o===x.type&&(c=!0,i&&n.addMark(p,p+h.nodeSize,o.create(fA(x.attrs,e))))})})}),c},AB=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),_B=()=>({tr:t,dispatch:e})=>{if(e){const n=new gi(t.doc);t.setSelection(n)}return!0},NB=()=>({state:t,dispatch:e})=>FN(t,e),kB=()=>({state:t,dispatch:e})=>HN(t,e),TB=()=>({state:t,dispatch:e})=>zL(t,e),OB=()=>({state:t,dispatch:e})=>VL(t,e),IB=()=>({state:t,dispatch:e})=>HL(t,e);function pv(t,e,n={},r={}){return Td(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var DB=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:i,tr:a,dispatch:o,commands:s})=>{const{doc:c}=a;if(r.preserveWhitespace!=="full"){const d=pv(t,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return o&&a.replaceWith(0,c.content.size,d).setMeta("preventUpdate",!n),!0}return o&&a.setMeta("preventUpdate",!n),s.insertContentAt({from:0,to:c.content.size},t,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function Lk(t,e){const n=so(e,t.schema),{from:r,to:i,empty:a}=t.selection,o=[];a?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,c=>{o.push(...c.marks)});const s=o.find(c=>c.type.name===n.name);return s?{...s.attrs}:{}}function jk(t,e){const n=new _y(t);return e.forEach(r=>{r.steps.forEach(i=>{n.step(i)})}),n}function MB(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function RB(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(i,a)=>{n(i)&&r.push({node:i,pos:a})}),r}function Pk(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function G0(t){return e=>Pk(e.$from,t)}function He(t,e,n){return t.config[e]===void 0&&t.parent?He(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?He(t.parent,e,n):null}):t.config[e]}function Wy(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=He(e,"addExtensions",n);return r?[e,...Wy(r())]:e}).flat(10)}function qy(t,e){const n=ml.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function Bk(t){return typeof t=="function"}function It(t,e=void 0,...n){return Bk(t)?e?t.bind(e)(...n):t(...n):t}function LB(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Nc(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function Fk(t){const e=[],{nodeExtensions:n,markExtensions:r}=Nc(t),i=[...n,...r],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const s={name:o.name,options:o.options,storage:o.storage,extensions:i},c=He(o,"addGlobalAttributes",s);if(!c)return;c().forEach(h=>{h.types.forEach(p=>{Object.entries(h.attributes).forEach(([x,v])=>{e.push({type:p,name:x,attribute:{...a,...v}})})})})}),i.forEach(o=>{const s={name:o.name,options:o.options,storage:o.storage},c=He(o,"addAttributes",s);if(!c)return;const d=c();Object.entries(d).forEach(([h,p])=>{const x={...a,...p};typeof(x==null?void 0:x.default)=="function"&&(x.default=x.default()),x!=null&&x.isRequired&&(x==null?void 0:x.default)===void 0&&delete x.default,e.push({type:o.name,name:h,attribute:x})})}),e}function un(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,a])=>{if(!r[i]){r[i]=a;return}if(i==="class"){const s=a?String(a).split(" "):[],c=r[i]?r[i].split(" "):[],d=s.filter(h=>!c.includes(h));r[i]=[...c,...d].join(" ")}else if(i==="style"){const s=a?a.split(";").map(h=>h.trim()).filter(Boolean):[],c=r[i]?r[i].split(";").map(h=>h.trim()).filter(Boolean):[],d=new Map;c.forEach(h=>{const[p,x]=h.split(":").map(v=>v.trim());d.set(p,x)}),s.forEach(h=>{const[p,x]=h.split(":").map(v=>v.trim());d.set(p,x)}),r[i]=Array.from(d.entries()).map(([h,p])=>`${h}: ${p}`).join("; ")}else r[i]=a}),r},{})}function Od(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>un(n,r),{})}function jB(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function hA(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((a,o)=>{const s=o.attribute.parseHTML?o.attribute.parseHTML(n):jB(n.getAttribute(o.name));return s==null?a:{...a,[o.name]:s}},{});return{...r,...i}}}}function pA(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&LB(n)?!1:n!=null))}function mA(t){var e,n;const r={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(r.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function PB(t,e){var n;const r=Fk(t),{nodeExtensions:i,markExtensions:a}=Nc(t),o=(n=i.find(d=>He(d,"topNode")))==null?void 0:n.name,s=Object.fromEntries(i.map(d=>{const h=r.filter(S=>S.type===d.name),p={name:d.name,options:d.options,storage:d.storage,editor:e},x=t.reduce((S,N)=>{const k=He(N,"extendNodeSchema",p);return{...S,...k?k(d):{}}},{}),v=pA({...x,content:It(He(d,"content",p)),marks:It(He(d,"marks",p)),group:It(He(d,"group",p)),inline:It(He(d,"inline",p)),atom:It(He(d,"atom",p)),selectable:It(He(d,"selectable",p)),draggable:It(He(d,"draggable",p)),code:It(He(d,"code",p)),whitespace:It(He(d,"whitespace",p)),linebreakReplacement:It(He(d,"linebreakReplacement",p)),defining:It(He(d,"defining",p)),isolating:It(He(d,"isolating",p)),attrs:Object.fromEntries(h.map(mA))}),b=It(He(d,"parseHTML",p));b&&(v.parseDOM=b.map(S=>hA(S,h)));const C=He(d,"renderHTML",p);C&&(v.toDOM=S=>C({node:S,HTMLAttributes:Od(S,h)}));const E=He(d,"renderText",p);return E&&(v.toText=E),[d.name,v]})),c=Object.fromEntries(a.map(d=>{const h=r.filter(E=>E.type===d.name),p={name:d.name,options:d.options,storage:d.storage,editor:e},x=t.reduce((E,S)=>{const N=He(S,"extendMarkSchema",p);return{...E,...N?N(d):{}}},{}),v=pA({...x,inclusive:It(He(d,"inclusive",p)),excludes:It(He(d,"excludes",p)),group:It(He(d,"group",p)),spanning:It(He(d,"spanning",p)),code:It(He(d,"code",p)),attrs:Object.fromEntries(h.map(mA))}),b=It(He(d,"parseHTML",p));b&&(v.parseDOM=b.map(E=>hA(E,h)));const C=He(d,"renderHTML",p);return C&&(v.toDOM=E=>C({mark:E,HTMLAttributes:Od(E,h)})),[d.name,v]}));return new xN({topNode:o,nodes:s,marks:c})}function BB(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Mp(t){return t.sort((n,r)=>{const i=He(n,"priority")||100,a=He(r,"priority")||100;return i>a?-1:i<a?1:0})}function zk(t){const e=Mp(Wy(t)),n=BB(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function Uk(t,e,n){const{from:r,to:i}=e,{blockSeparator:a=`

`,textSerializers:o={}}=n||{};let s="";return t.nodesBetween(r,i,(c,d,h,p)=>{var x;c.isBlock&&d>r&&(s+=a);const v=o==null?void 0:o[c.type.name];if(v)return h&&(s+=v({node:c,pos:d,parent:h,index:p,range:e})),!1;c.isText&&(s+=(x=c==null?void 0:c.text)==null?void 0:x.slice(Math.max(r,d)-d,i-d))}),s}function FB(t,e){const n={from:0,to:t.content.size};return Uk(t,n,e)}function Hk(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function zB(t,e){const n=Bn(e,t.schema),{from:r,to:i}=t.selection,a=[];t.doc.nodesBetween(r,i,s=>{a.push(s)});const o=a.reverse().find(s=>s.type.name===n.name);return o?{...o.attrs}:{}}function Vk(t,e){const n=$0(typeof e=="string"?e:e.name,t.schema);return n==="node"?zB(t,e):n==="mark"?Lk(t,e):{}}function UB(t,e=JSON.stringify){const n={};return t.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function HB(t){const e=UB(t);return e.length===1?e:e.filter((n,r)=>!e.filter((a,o)=>o!==r).some(a=>n.oldRange.from>=a.oldRange.from&&n.oldRange.to<=a.oldRange.to&&n.newRange.from>=a.newRange.from&&n.newRange.to<=a.newRange.to))}function $k(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((i,a)=>{const o=[];if(i.ranges.length)i.forEach((s,c)=>{o.push({from:s,to:c})});else{const{from:s,to:c}=n[a];if(s===void 0||c===void 0)return;o.push({from:s,to:c})}o.forEach(({from:s,to:c})=>{const d=e.slice(a).map(s,-1),h=e.slice(a).map(c),p=e.invert().map(d,-1),x=e.invert().map(h);r.push({oldRange:{from:p,to:x},newRange:{from:d,to:h}})})}),HB(r)}function Xy(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const a=n.resolve(t),o=Gy(a,i.type);o&&r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,a)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:a,to:a+i.nodeSize,mark:o})))}),r}var VB=(t,e,n,r=20)=>{const i=t.doc.resolve(n);let a=r,o=null;for(;a>0&&o===null;){const s=i.node(a);(s==null?void 0:s.type.name)===e?o=s:a-=1}return[o,a]};function bh(t,e){return e.nodes[t]||e.marks[t]||null}function Xh(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(a=>a.type===e&&a.name===r);return i?i.attribute.keepOnSplit:!1}))}var $B=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,a,o,s)=>{var c,d;const h=((d=(c=i.type.spec).toText)==null?void 0:d.call(c,{node:i,pos:a,parent:o,index:s}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?h:h.slice(0,Math.max(0,r-a))}),n};function mv(t,e,n={}){const{empty:r,ranges:i}=t.selection,a=e?so(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(p=>a?a.name===p.type.name:!0).find(p=>Ip(p.attrs,n,{strict:!1}));let o=0;const s=[];if(i.forEach(({$from:p,$to:x})=>{const v=p.pos,b=x.pos;t.doc.nodesBetween(v,b,(C,E)=>{if(!C.isText&&!C.marks.length)return;const S=Math.max(v,E),N=Math.min(b,E+C.nodeSize),k=N-S;o+=k,s.push(...C.marks.map(I=>({mark:I,from:S,to:N})))})}),o===0)return!1;const c=s.filter(p=>a?a.name===p.mark.type.name:!0).filter(p=>Ip(p.mark.attrs,n,{strict:!1})).reduce((p,x)=>p+x.to-x.from,0),d=s.filter(p=>a?p.mark.type!==a&&p.mark.type.excludes(a):!0).reduce((p,x)=>p+x.to-x.from,0);return(c>0?c+d:c)>=o}function GB(t,e,n={}){if(!e)return cs(t,null,n)||mv(t,null,n);const r=$0(e,t.schema);return r==="node"?cs(t,e,n):r==="mark"?mv(t,e,n):!1}var WB=(t,e)=>{const{$from:n,$to:r,$anchor:i}=t.selection;if(e){const a=G0(s=>s.type.name===e)(t.selection);if(!a)return!1;const o=t.doc.resolve(a.pos+1);return i.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},qB=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function gA(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function xA(t,e){const{nodeExtensions:n}=Nc(e),r=n.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},a=It(He(r,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function W0(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(a=>{i!==!1&&(W0(a,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function Gk(t){return t instanceof $e}var Wk=class qk{constructor(e){this.position=e}static fromJSON(e){return new qk(e.position)}toJSON(){return{position:this.position}}};function XB(t,e){const n=e.mapping.mapResult(t.position);return{position:new Wk(n.pos),mapResult:n}}function KB(t){return new Wk(t)}function YB(t,e,n){var r;const{selection:i}=e;let a=null;if(Ik(i)&&(a=i.$cursor),a){const s=(r=t.storedMarks)!=null?r:a.marks();return a.parent.type.allowsMarkType(n)&&(!!n.isInSet(s)||!s.some(d=>d.type.excludes(n)))}const{ranges:o}=i;return o.some(({$from:s,$to:c})=>{let d=s.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(s.pos,c.pos,(h,p,x)=>{if(d)return!1;if(h.isInline){const v=!x||x.type.allowsMarkType(n),b=!!n.isInSet(h.marks)||!h.marks.some(C=>C.type.excludes(n));d=v&&b}return!d}),d})}var ZB=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:a}=n,{empty:o,ranges:s}=a,c=so(t,r.schema);if(i)if(o){const d=Lk(r,c);n.addStoredMark(c.create({...d,...e}))}else s.forEach(d=>{const h=d.$from.pos,p=d.$to.pos;r.doc.nodesBetween(h,p,(x,v)=>{const b=Math.max(v,h),C=Math.min(v+x.nodeSize,p);x.marks.find(S=>S.type===c)?x.marks.forEach(S=>{c===S.type&&n.addMark(b,C,c.create({...S.attrs,...e}))}):n.addMark(b,C,c.create(e))})});return YB(r,n,c)},JB=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),QB=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const a=Bn(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),a.isTextblock?i().command(({commands:s})=>OS(a,{...o,...e})(n)?!0:s.clearNodes()).command(({state:s})=>OS(a,{...o,...e})(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},eF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=qs(t,0,r.content.size),a=$e.create(r,i);e.setSelection(a)}return!0},tF=(t,e)=>({tr:n,state:r,dispatch:i})=>{const{selection:a}=r;let o,s;return typeof e=="number"?(o=e,s=e):e&&"from"in e&&"to"in e?(o=e.from,s=e.to):(o=a.from,s=a.to),i&&n.doc.nodesBetween(o,s,(c,d)=>{c.isText||n.setNodeMarkup(d,void 0,{...c.attrs,dir:t})}),!0},nF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t,o=Ge.atStart(r).from,s=Ge.atEnd(r).to,c=qs(i,o,s),d=qs(a,o,s),h=Ge.create(r,c,d);e.setSelection(h)}return!0},rF=t=>({state:e,dispatch:n})=>{const r=Bn(t,e.schema);return ZL(r)(e,n)};function vA(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}var iF=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:a,doc:o}=e,{$from:s,$to:c}=a,d=i.extensionManager.attributes,h=Xh(d,s.node().type.name,s.node().attrs);if(a instanceof $e&&a.node.isBlock)return!s.parentOffset||!eo(o,s.pos)?!1:(r&&(t&&vA(n,i.extensionManager.splittableMarks),e.split(s.pos).scrollIntoView()),!0);if(!s.parent.isBlock)return!1;const p=c.parentOffset===c.parent.content.size,x=s.depth===0?void 0:MB(s.node(-1).contentMatchAt(s.indexAfter(-1)));let v=p&&x?[{type:x,attrs:h}]:void 0,b=eo(e.doc,e.mapping.map(s.pos),1,v);if(!v&&!b&&eo(e.doc,e.mapping.map(s.pos),1,x?[{type:x}]:void 0)&&(b=!0,v=x?[{type:x,attrs:h}]:void 0),r){if(b&&(a instanceof Ge&&e.deleteSelection(),e.split(e.mapping.map(s.pos),1,v),x&&!p&&!s.parentOffset&&s.parent.type!==x)){const C=e.mapping.map(s.before()),E=e.doc.resolve(C);s.node(-1).canReplaceWith(E.index(),E.index()+1,x)&&e.setNodeMarkup(e.mapping.map(s.before()),x)}t&&vA(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return b},aF=(t,e={})=>({tr:n,state:r,dispatch:i,editor:a})=>{var o;const s=Bn(t,r.schema),{$from:c,$to:d}=r.selection,h=r.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(d))return!1;const p=c.node(-1);if(p.type!==s)return!1;const x=a.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==s||c.index(-2)!==c.node(-2).childCount-1)return!1;if(i){let S=be.empty;const N=c.index(-1)?1:c.index(-2)?2:3;for(let j=c.depth-N;j>=c.depth-3;j-=1)S=be.from(c.node(j).copy(S));const k=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,I={...Xh(x,c.node().type.name,c.node().attrs),...e},D=((o=s.contentMatch.defaultType)==null?void 0:o.createAndFill(I))||void 0;S=S.append(be.from(s.createAndFill(null,D)||void 0));const L=c.before(c.depth-(N-1));n.replace(L,c.after(-k),new Re(S,4-N,0));let O=-1;n.doc.nodesBetween(L,n.doc.content.size,(j,U)=>{if(O>-1)return!1;j.isTextblock&&j.content.size===0&&(O=U+1)}),O>-1&&n.setSelection(Ge.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const v=d.pos===c.end()?p.contentMatchAt(0).defaultType:null,b={...Xh(x,p.type.name,p.attrs),...e},C={...Xh(x,c.node().type.name,c.node().attrs),...e};n.delete(c.pos,d.pos);const E=v?[{type:s,attrs:b},{type:v,attrs:C}]:[{type:s,attrs:b}];if(!eo(n.doc,c.pos,2))return!1;if(i){const{selection:S,storedMarks:N}=r,{splittableMarks:k}=a.extensionManager,I=N||S.$to.parentOffset&&S.$from.marks();if(n.split(c.pos,2,E).scrollIntoView(),!I||!i)return!0;const D=I.filter(L=>k.includes(L.type.name));n.ensureMarks(D)}return!0},Hg=(t,e)=>{const n=G0(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&ds(t.doc,n.pos)&&t.join(n.pos),!0},Vg=(t,e)=>{const n=G0(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&ds(t.doc,r)&&t.join(r),!0},oF=(t,e,n,r={})=>({editor:i,tr:a,state:o,dispatch:s,chain:c,commands:d,can:h})=>{const{extensions:p,splittableMarks:x}=i.extensionManager,v=Bn(t,o.schema),b=Bn(e,o.schema),{selection:C,storedMarks:E}=o,{$from:S,$to:N}=C,k=S.blockRange(N),I=E||C.$to.parentOffset&&C.$from.marks();if(!k)return!1;const D=G0(L=>xA(L.type.name,p))(C);if(k.depth>=1&&D&&k.depth-D.depth<=1){if(D.node.type===v)return d.liftListItem(b);if(xA(D.node.type.name,p)&&v.validContent(D.node.content)&&s)return c().command(()=>(a.setNodeMarkup(D.pos,v),!0)).command(()=>Hg(a,v)).command(()=>Vg(a,v)).run()}return!n||!I||!s?c().command(()=>h().wrapInList(v,r)?!0:d.clearNodes()).wrapInList(v,r).command(()=>Hg(a,v)).command(()=>Vg(a,v)).run():c().command(()=>{const L=h().wrapInList(v,r),O=I.filter(j=>x.includes(j.type.name));return a.ensureMarks(O),L?!0:d.clearNodes()}).wrapInList(v,r).command(()=>Hg(a,v)).command(()=>Vg(a,v)).run()},sF=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:a=!1}=n,o=so(t,r.schema);return mv(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:a}):i.setMark(o,e)},lF=(t,e,n={})=>({state:r,commands:i})=>{const a=Bn(t,r.schema),o=Bn(e,r.schema),s=cs(r,a,n);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),s?i.setNode(o,c):i.setNode(a,{...c,...n})},cF=(t,e={})=>({state:n,commands:r})=>{const i=Bn(t,n.schema);return cs(n,i,e)?r.lift(i):r.wrapIn(i,e)},uF=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let a;if(i.spec.isInputRules&&(a=i.getState(t))){if(e){const o=t.tr,s=a.transform;for(let c=s.steps.length-1;c>=0;c-=1)o.step(s.steps[c].invert(s.docs[c]));if(a.text){const c=o.doc.resolve(a.from).marks();o.replaceWith(a.from,a.to,t.schema.text(a.text,c))}else o.delete(a.from,a.to)}return!0}}return!1},dF=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},fF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var a;const{extendEmptyMarkRange:o=!1}=e,{selection:s}=n,c=so(t,r.schema),{$from:d,empty:h,ranges:p}=s;if(!i)return!0;if(h&&o){let{from:x,to:v}=s;const b=(a=d.marks().find(E=>E.type===c))==null?void 0:a.attrs,C=Gy(d,c,b);C&&(x=C.from,v=C.to),n.removeMark(x,v,c)}else p.forEach(x=>{n.removeMark(x.$from.pos,x.$to.pos,c)});return n.removeStoredMark(c),!0},hF=t=>({tr:e,state:n,dispatch:r})=>{const{selection:i}=n;let a,o;return typeof t=="number"?(a=t,o=t):t&&"from"in t&&"to"in t?(a=t.from,o=t.to):(a=i.from,o=i.to),r&&e.doc.nodesBetween(a,o,(s,c)=>{if(s.isText)return;const d={...s.attrs};delete d.dir,e.setNodeMarkup(c,void 0,d)}),!0},pF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let a=null,o=null;const s=$0(typeof t=="string"?t:t.name,r.schema);if(!s)return!1;s==="node"&&(a=Bn(t,r.schema)),s==="mark"&&(o=so(t,r.schema));let c=!1;return n.selection.ranges.forEach(d=>{const h=d.$from.pos,p=d.$to.pos;let x,v,b,C;n.selection.empty?r.doc.nodesBetween(h,p,(E,S)=>{a&&a===E.type&&(c=!0,b=Math.max(S,h),C=Math.min(S+E.nodeSize,p),x=S,v=E)}):r.doc.nodesBetween(h,p,(E,S)=>{S<h&&a&&a===E.type&&(c=!0,b=Math.max(S,h),C=Math.min(S+E.nodeSize,p),x=S,v=E),S>=h&&S<=p&&(a&&a===E.type&&(c=!0,i&&n.setNodeMarkup(S,void 0,{...E.attrs,...e})),o&&E.marks.length&&E.marks.forEach(N=>{if(o===N.type&&(c=!0,i)){const k=Math.max(S,h),I=Math.min(S+E.nodeSize,p);n.addMark(k,I,o.create({...N.attrs,...e}))}}))}),v&&(x!==void 0&&i&&n.setNodeMarkup(x,void 0,{...v.attrs,...e}),o&&v.marks.length&&v.marks.forEach(E=>{o===E.type&&i&&n.addMark(b,C,o.create({...E.attrs,...e}))}))}),c},mF=(t,e={})=>({state:n,dispatch:r})=>{const i=Bn(t,n.schema);return $L(i,e)(n,r)},gF=(t,e={})=>({state:n,dispatch:r})=>{const i=Bn(t,n.schema);return GL(i,e)(n,r)},xF=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},q0=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},vF=(t,e)=>{if($y(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function wh(t){var e;const{editor:n,from:r,to:i,text:a,rules:o,plugin:s}=t,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(r);if(d.parent.type.spec.code||(e=d.nodeBefore||d.nodeAfter)!=null&&e.marks.find(x=>x.type.spec.code))return!1;let h=!1;const p=$B(d)+a;return o.forEach(x=>{if(h)return;const v=vF(p,x.find);if(!v)return;const b=c.state.tr,C=H0({state:c.state,transaction:b}),E={from:r-(v[0].length-a.length),to:i},{commands:S,chain:N,can:k}=new V0({editor:n,state:C});x.handler({state:C,range:E,match:v,commands:S,chain:N,can:k})===null||!b.steps.length||(x.undoable&&b.setMeta(s,{transform:b,from:r,to:i,text:a}),c.dispatch(b),h=!0)}),h}function yF(t){const{editor:e,rules:n}=t,r=new dn({state:{init(){return null},apply(i,a,o){const s=i.getMeta(r);if(s)return s;const c=i.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:h}=c;typeof h=="string"?h=h:h=qy(be.from(h),o.schema);const{from:p}=c,x=p+h.length;wh({editor:e,from:p,to:x,text:h,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,o,s){return wh({editor:e,from:a,to:o,text:s,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&wh({editor:e,from:a.pos,to:a.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?wh({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function bF(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ch(t){return bF(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Xk(t,e){const n={...t};return Ch(t)&&Ch(e)&&Object.keys(e).forEach(r=>{Ch(e[r])&&Ch(t[r])?n[r]=Xk(t[r],e[r]):n[r]=e[r]}),n}var Ky=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...It(He(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...It(He(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Xk(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},hs=class Kk extends Ky{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new Kk(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(d=>(d==null?void 0:d.type.name)===n.name))return!1;const c=o.find(d=>(d==null?void 0:d.type.name)===n.name);return c&&r.removeStoredMark(c),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function wF(t){return typeof t=="number"}var CF=class{constructor(t){this.find=t.find,this.handler=t.handler}},EF=(t,e,n)=>{if($y(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const a=[i.text];return a.index=i.index,a.input=t,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function SF(t){const{editor:e,state:n,from:r,to:i,rule:a,pasteEvent:o,dropEvent:s}=t,{commands:c,chain:d,can:h}=new V0({editor:e,state:n}),p=[];return n.doc.nodesBetween(r,i,(v,b)=>{var C,E,S,N,k;if((E=(C=v.type)==null?void 0:C.spec)!=null&&E.code||!(v.isText||v.isTextblock||v.isInline))return;const I=(k=(N=(S=v.content)==null?void 0:S.size)!=null?N:v.nodeSize)!=null?k:0,D=Math.max(r,b),L=Math.min(i,b+I);if(D>=L)return;const O=v.isText?v.text||"":v.textBetween(D-b,L-b,void 0,"");EF(O,a.find,o).forEach(U=>{if(U.index===void 0)return;const fe=D+U.index+1,le=fe+U[0].length,q={from:n.tr.mapping.map(fe),to:n.tr.mapping.map(le)},de=a.handler({state:n,range:q,match:U,commands:c,chain:d,can:h,pasteEvent:o,dropEvent:s});p.push(de)})}),p.every(v=>v!==null)}var Eh=null,AF=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function _F(t){const{editor:e,rules:n}=t;let r=null,i=!1,a=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,s;try{s=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{s=null}const c=({state:h,from:p,to:x,rule:v,pasteEvt:b})=>{const C=h.tr,E=H0({state:h,transaction:C});if(!(!SF({editor:e,state:E,from:Math.max(p-1,0),to:x.b-1,rule:v,pasteEvent:b,dropEvent:s})||!C.steps.length)){try{s=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{s=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,C}};return n.map(h=>new dn({view(p){const x=b=>{var C;r=(C=p.dom.parentElement)!=null&&C.contains(b.target)?p.dom.parentElement:null,r&&(Eh=e)},v=()=>{Eh&&(Eh=null)};return window.addEventListener("dragstart",x),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",x),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(p,x)=>{if(a=r===p.dom.parentElement,s=x,!a){const v=Eh;v!=null&&v.isEditable&&setTimeout(()=>{const b=v.state.selection;b&&v.commands.deleteRange({from:b.from,to:b.to})},10)}return!1},paste:(p,x)=>{var v;const b=(v=x.clipboardData)==null?void 0:v.getData("text/html");return o=x,i=!!(b!=null&&b.includes("data-pm-slice")),!1}}},appendTransaction:(p,x,v)=>{const b=p[0],C=b.getMeta("uiEvent")==="paste"&&!i,E=b.getMeta("uiEvent")==="drop"&&!a,S=b.getMeta("applyPasteRules"),N=!!S;if(!C&&!E&&!N)return;if(N){let{text:D}=S;typeof D=="string"?D=D:D=qy(be.from(D),v.schema);const{from:L}=S,O=L+D.length,j=AF(D);return c({rule:h,state:v,from:L,to:{b:O},pasteEvt:j})}const k=x.doc.content.findDiffStart(v.doc.content),I=x.doc.content.findDiffEnd(v.doc.content);if(!(!wF(k)||!I||k===I.b))return c({rule:h,state:v,from:k,to:I,pasteEvt:o})}}))}var X0=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=zk(t),this.schema=PB(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:bh(e.name,this.schema)},r=He(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Mp([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:bh(r.name,this.schema)},a=[],o=He(r,"addKeyboardShortcuts",i);let s={};if(r.type==="mark"&&He(r,"exitable",i)&&(s.ArrowRight=()=>hs.handleExit({editor:t,mark:r})),o){const x=Object.fromEntries(Object.entries(o()).map(([v,b])=>[v,()=>b({editor:t})]));s={...s,...x}}const c=UP(s);a.push(c);const d=He(r,"addInputRules",i);if(gA(r,t.options.enableInputRules)&&d){const x=d();if(x&&x.length){const v=yF({editor:t,rules:x}),b=Array.isArray(v)?v:[v];a.push(...b)}}const h=He(r,"addPasteRules",i);if(gA(r,t.options.enablePasteRules)&&h){const x=h();if(x&&x.length){const v=_F({editor:t,rules:x});a.push(...v)}}const p=He(r,"addProseMirrorPlugins",i);if(p){const x=p();a.push(...x)}return a})}get attributes(){return Fk(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Nc(this.extensions);return Object.fromEntries(e.filter(n=>!!He(n,"addNodeView")).map(n=>{const r=this.attributes.filter(c=>c.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Bn(n.name,this.schema)},a=He(n,"addNodeView",i);if(!a)return[];const o=a();if(!o)return[];const s=(c,d,h,p,x)=>{const v=Od(c,r);return o({node:c,view:d,getPos:h,decorations:p,innerDecorations:x,editor:t,extension:n,HTMLAttributes:v})};return[n.name,s]}))}dispatchTransaction(t){const{editor:e}=this;return Mp([...this.extensions].reverse()).reduceRight((r,i)=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:bh(i.name,this.schema)},o=He(i,"dispatchTransaction",a);return o?s=>{o.call(a,{transaction:s,next:r})}:r},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=Nc(this.extensions);return Object.fromEntries(e.filter(n=>!!He(n,"addMarkView")).map(n=>{const r=this.attributes.filter(s=>s.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:so(n.name,this.schema)},a=He(n,"addMarkView",i);if(!a)return[];const o=(s,c,d)=>{const h=Od(s,r);return a()({mark:s,view:c,inline:d,editor:t,extension:n,HTMLAttributes:h,updateAttributes:p=>{zF(s,t,p)}})};return[n.name,o]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:bh(e.name,this.schema)};e.type==="mark"&&((n=It(He(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const i=He(e,"onBeforeCreate",r),a=He(e,"onCreate",r),o=He(e,"onUpdate",r),s=He(e,"onSelectionUpdate",r),c=He(e,"onTransaction",r),d=He(e,"onFocus",r),h=He(e,"onBlur",r),p=He(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),o&&this.editor.on("update",o),s&&this.editor.on("selectionUpdate",s),c&&this.editor.on("transaction",c),d&&this.editor.on("focus",d),h&&this.editor.on("blur",h),p&&this.editor.on("destroy",p)})}};X0.resolve=zk;X0.sort=Mp;X0.flatten=Wy;var NF={};Vy(NF,{ClipboardTextSerializer:()=>Zk,Commands:()=>Jk,Delete:()=>Qk,Drop:()=>e6,Editable:()=>t6,FocusEvents:()=>r6,Keymap:()=>i6,Paste:()=>a6,Tabindex:()=>o6,TextDirection:()=>s6,focusEventsPluginKey:()=>n6});var zt=class Yk extends Ky{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new Yk(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},Zk=zt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new dn({key:new Sn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:a}=i,o=Math.min(...a.map(h=>h.$from.pos)),s=Math.max(...a.map(h=>h.$to.pos)),c=Hk(n);return Uk(r,{from:o,to:s},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),Jk=zt.create({name:"commands",addCommands(){return{...Tk}}}),Qk=zt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,i;const a=()=>{var o,s,c,d;if((d=(c=(s=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:s.filterTransaction)==null?void 0:c.call(s,t))!=null?d:t.getMeta("y-sync$"))return;const h=jk(t.before,[t,...e]);$k(h).forEach(v=>{h.mapping.mapResult(v.oldRange.from).deletedAfter&&h.mapping.mapResult(v.oldRange.to).deletedBefore&&h.before.nodesBetween(v.oldRange.from,v.oldRange.to,(b,C)=>{const E=C+b.nodeSize-2,S=v.oldRange.from<=C&&E<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:b,from:C,to:E,newFrom:h.mapping.map(C),newTo:h.mapping.map(E),deletedRange:v.oldRange,newRange:v.newRange,partial:!S,editor:this.editor,transaction:t,combinedTransform:h})})});const x=h.mapping;h.steps.forEach((v,b)=>{var C,E;if(v instanceof Yi){const S=x.slice(b).map(v.from,-1),N=x.slice(b).map(v.to),k=x.invert().map(S,-1),I=x.invert().map(N),D=(C=h.doc.nodeAt(S-1))==null?void 0:C.marks.some(O=>O.eq(v.mark)),L=(E=h.doc.nodeAt(N))==null?void 0:E.marks.some(O=>O.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:k,to:I},newRange:{from:S,to:N},partial:!!(L||D),editor:this.editor,transaction:t,combinedTransform:h})}})};(i=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||i?setTimeout(a,0):a()}}),e6=zt.create({name:"drop",addProseMirrorPlugins(){return[new dn({key:new Sn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),t6=zt.create({name:"editable",addProseMirrorPlugins(){return[new dn({key:new Sn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),n6=new Sn("focusEvents"),r6=zt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new dn({key:n6,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),i6=zt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:s})=>{const{selection:c,doc:d}=s,{empty:h,$anchor:p}=c,{pos:x,parent:v}=p,b=p.parent.isTextblock&&x>0?s.doc.resolve(x-1):p,C=b.parent.type.spec.isolating,E=p.pos-p.parentOffset,S=C&&b.parent.childCount===1?E===p.pos:Ze.atStart(d).from===x;return!h||!v.type.isTextblock||v.textContent.length||!S||S&&p.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},a={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Dp()||Rk()?a:i},addProseMirrorPlugins(){return[new dn({key:new Sn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(C=>C.getMeta("composition")))return;const r=t.some(C=>C.docChanged)&&!e.doc.eq(n.doc),i=t.some(C=>C.getMeta("preventClearDocument"));if(!r||i)return;const{empty:a,from:o,to:s}=e.selection,c=Ze.atStart(e.doc).from,d=Ze.atEnd(e.doc).to;if(a||!(o===c&&s===d)||!W0(n.doc))return;const x=n.tr,v=H0({state:n,transaction:x}),{commands:b}=new V0({editor:this.editor,state:v});if(b.clearNodes(),!!x.steps.length)return x}})]}}),a6=zt.create({name:"paste",addProseMirrorPlugins(){return[new dn({key:new Sn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),o6=zt.create({name:"tabindex",addProseMirrorPlugins(){return[new dn({key:new Sn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),s6=zt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Nc(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new dn({key:new Sn("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),kF=class Wu{constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Wu(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Wu(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Wu(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,a=n.isAtom&&!n.isText,o=n.isInline,s=this.pos+r+(a?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(s);if(!i&&!o&&c.depth<=this.depth)return;const d=new Wu(c,this.editor,i,i||o?n:null);i&&(d.actualDepth=this.depth+1),e.push(d)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const a=i.node.attrs,o=Object.keys(n);for(let s=0;s<o.length;s+=1){const c=o[s];if(a[c]!==n[c])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(n);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===e&&a.every(c=>n[c]===o.node.attrs[c])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},TF=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function OF(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var IF=class extends xF{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:XB,createMappablePosition:KB},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:a})=>this.options.onDrop(r,i,a)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=Dk(e,this.options.autofocus);this.editorState=oc.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=OF(TF,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=Bk(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(i=>{const a=typeof i=="string"?`${i}$`:i.key;n=n.filter(o=>!o.key.startsWith(a))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[t6,Zk.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),Jk,r6,i6,o6,e6,a6,Qk,s6.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new X0(r,this)}createCommandManager(){this.commandManager=new V0({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=pv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=pv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=n?this.extensionManager.dispatchTransaction(r):r;this.editorView=new kk(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(d=>{var h;return(h=this.capturedTransaction)==null?void 0:h.step(d)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),i=n.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=n.findLast(d=>d.getMeta("focus")||d.getMeta("blur")),s=o==null?void 0:o.getMeta("focus"),c=o==null?void 0:o.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:o}),c&&this.emit("blur",{editor:this,event:c.event,transaction:o}),!(t.getMeta("preventUpdate")||!n.some(d=>d.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return Vk(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return GB(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return qy(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return FB(this.state.doc,{blockSeparator:e,textSerializers:{...Hk(this.schema),...n}})}get isEmpty(){return W0(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new kF(e,this)}get $doc(){return this.$pos(0)}};function kc(t){return new q0({find:t.find,handler:({state:e,range:n,match:r})=>{const i=It(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:a}=e,o=r[r.length-1],s=r[0];if(o){const c=s.search(/\S/),d=n.from+s.indexOf(o),h=d+o.length;if(Xy(n.from,n.to,e.doc).filter(v=>v.mark.type.excluded.find(C=>C===t.type&&C!==v.mark.type)).filter(v=>v.to>d).length)return null;h<n.to&&a.delete(h,n.to),d>n.from&&a.delete(n.from+c,d);const x=n.from+c+o.length;a.addMark(n.from+c,x,t.type.create(i||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function DF(t){return new q0({find:t.find,handler:({state:e,range:n,match:r})=>{const i=It(t.getAttributes,void 0,r)||{},{tr:a}=e,o=n.from;let s=n.to;const c=t.type.create(i);if(r[1]){const d=r[0].lastIndexOf(r[1]);let h=o+d;h>s?h=s:s=h+r[1].length;const p=r[0][r[0].length-1];a.insertText(p,o+r[0].length-1),a.replaceWith(h,s,c)}else if(r[0]){const d=t.type.isInline?o:o-1;a.insert(d,t.type.create(i)).delete(a.mapping.map(o),a.mapping.map(s))}a.scrollIntoView()},undoable:t.undoable})}function gv(t){return new q0({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),a=It(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,a)},undoable:t.undoable})}function Tc(t){return new q0({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const a=It(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),c=o.doc.resolve(n.from).blockRange(),d=c&&Ay(c,t.type,a);if(!d)return null;if(o.wrap(c,d),t.keepMarks&&t.editor){const{selection:p,storedMarks:x}=e,{splittableMarks:v}=t.editor.extensionManager,b=x||p.$to.parentOffset&&p.$from.marks();if(b){const C=b.filter(E=>v.includes(E.type.name));o.ensureMarks(C)}}if(t.keepAttributes){const p=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(p,a).run()}const h=o.doc.resolve(n.from-1).nodeBefore;h&&h.type===t.type&&ds(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,h))&&o.join(n.from-1)},undoable:t.undoable})}function MF(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof $e){const a=r.index();return r.parent.canReplaceWith(a,a+1,e)}let i=r.depth;for(;i>=0;){const a=r.index(i);if(r.node(i).contentMatchAt(a).matchType(e))return!0;i-=1}return!1}var RF={};Vy(RF,{createAtomBlockMarkdownSpec:()=>LF,createBlockMarkdownSpec:()=>jF,createInlineMarkdownSpec:()=>FF,parseAttributes:()=>Yy,parseIndentedBlocks:()=>xv,renderNestedMarkdownContent:()=>Jy,serializeAttributes:()=>Zy});function Yy(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,d=>(n.push(d),`__QUOTED_${n.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const d=i.map(h=>h.trim().slice(1));e.class=d.join(" ")}const a=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,d,h])=>{var p;const x=parseInt(((p=h.match(/__QUOTED_(\d+)__/))==null?void 0:p[1])||"0",10),v=n[x];v&&(e[d]=v.slice(1,-1))});const c=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(e[h]=!0)}),e}function Zy(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function LF(t){const{nodeName:e,name:n,parseAttributes:r=Yy,serializeAttributes:i=Zy,defaultAttributes:a={},requiredAttributes:o=[],allowedAttributes:s}=t,c=n||e,d=h=>{if(!s)return h;const p={};return s.forEach(x=>{x in h&&(p[x]=h[x])}),p};return{parseMarkdown:(h,p)=>{const x={...a,...h.attributes};return p.createNode(e,x,[])},markdownTokenizer:{name:e,level:"block",start(h){var p;const x=new RegExp(`^:::${c}(?:\\s|$)`,"m"),v=(p=h.match(x))==null?void 0:p.index;return v!==void 0?v:-1},tokenize(h,p,x){const v=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),b=h.match(v);if(!b)return;const C=b[1]||"",E=r(C);if(!o.find(N=>!(N in E)))return{type:e,raw:b[0],attributes:E}}},renderMarkdown:h=>{const p=d(h.attrs||{}),x=i(p),v=x?` {${x}}`:"";return`:::${c}${v} :::`}}}function jF(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=Yy,serializeAttributes:a=Zy,defaultAttributes:o={},content:s="block",allowedAttributes:c}=t,d=n||e,h=p=>{if(!c)return p;const x={};return c.forEach(v=>{v in p&&(x[v]=p[v])}),x};return{parseMarkdown:(p,x)=>{let v;if(r){const C=r(p);v=typeof C=="string"?[{type:"text",text:C}]:C}else s==="block"?v=x.parseChildren(p.tokens||[]):v=x.parseInline(p.tokens||[]);const b={...o,...p.attributes};return x.createNode(e,b,v)},markdownTokenizer:{name:e,level:"block",start(p){var x;const v=new RegExp(`^:::${d}`,"m"),b=(x=p.match(v))==null?void 0:x.index;return b!==void 0?b:-1},tokenize(p,x,v){var b;const C=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),E=p.match(C);if(!E)return;const[S,N=""]=E,k=i(N);let I=1;const D=S.length;let L="";const O=/^:::([\w-]*)(\s.*)?/gm,j=p.slice(D);for(O.lastIndex=0;;){const U=O.exec(j);if(U===null)break;const fe=U.index,le=U[1];if(!((b=U[2])!=null&&b.endsWith(":::"))){if(le)I+=1;else if(I-=1,I===0){const q=j.slice(0,fe);L=q.trim();const de=p.slice(0,D+fe+U[0].length);let ge=[];if(L)if(s==="block")for(ge=v.blockTokens(q),ge.forEach(xe=>{xe.text&&(!xe.tokens||xe.tokens.length===0)&&(xe.tokens=v.inlineTokens(xe.text))});ge.length>0;){const xe=ge[ge.length-1];if(xe.type==="paragraph"&&(!xe.text||xe.text.trim()===""))ge.pop();else break}else ge=v.inlineTokens(L);return{type:e,raw:de,attributes:k,content:L,tokens:ge}}}}}},renderMarkdown:(p,x)=>{const v=h(p.attrs||{}),b=a(v),C=b?` {${b}}`:"",E=x.renderChildren(p.content||[],`

`);return`:::${d}${C}

${E}

:::`}}}function PF(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,i,a,o]=r;e[i]=a||o,r=n.exec(t)}return e}function BF(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function FF(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=PF,serializeAttributes:a=BF,defaultAttributes:o={},selfClosing:s=!1,allowedAttributes:c}=t,d=n||e,h=x=>{if(!c)return x;const v={};return c.forEach(b=>{const C=typeof b=="string"?b:b.name,E=typeof b=="string"?void 0:b.skipIfDefault;if(C in x){const S=x[C];if(E!==void 0&&S===E)return;v[C]=S}}),v},p=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,v)=>{const b={...o,...x.attributes};if(s)return v.createNode(e,b);const C=r?r(x):x.content||"";return C?v.createNode(e,b,[v.createTextNode(C)]):v.createNode(e,b,[])},markdownTokenizer:{name:e,level:"inline",start(x){const v=s?new RegExp(`\\[${p}\\s*[^\\]]*\\]`):new RegExp(`\\[${p}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${p}\\]`),b=x.match(v),C=b==null?void 0:b.index;return C!==void 0?C:-1},tokenize(x,v,b){const C=s?new RegExp(`^\\[${p}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${p}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${p}\\]`),E=x.match(C);if(!E)return;let S="",N="";if(s){const[,I]=E;N=I}else{const[,I,D]=E;N=I,S=D||""}const k=i(N.trim());return{type:e,raw:E[0],content:S.trim(),attributes:k}}},renderMarkdown:x=>{let v="";r?v=r(x):x.content&&x.content.length>0&&(v=x.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const b=h(x.attrs||{}),C=a(b),E=C?` ${C}`:"";return s?`[${d}${E}]`:`[${d}${E}]${v}[/${d}]`}}}function xv(t,e,n){var r,i,a,o;const s=t.split(`
`),c=[];let d="",h=0;const p=e.baseIndentSize||2;for(;h<s.length;){const x=s[h],v=x.match(e.itemPattern);if(!v){if(c.length>0)break;if(x.trim()===""){h+=1,d=`${d}${x}
`;continue}else return}const b=e.extractItemData(v),{indentLevel:C,mainContent:E}=b;d=`${d}${x}
`;const S=[E];for(h+=1;h<s.length;){const D=s[h];if(D.trim()===""){const O=s.slice(h+1).findIndex(fe=>fe.trim()!=="");if(O===-1)break;if((((i=(r=s[h+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>C){S.push(D),d=`${d}${D}
`,h+=1;continue}else break}if((((o=(a=D.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:o.length)||0)>C)S.push(D),d=`${d}${D}
`,h+=1;else break}let N;const k=S.slice(1);if(k.length>0){const D=k.map(L=>L.slice(C+p)).join(`
`);D.trim()&&(e.customNestedParser?N=e.customNestedParser(D):N=n.blockTokens(D))}const I=e.createToken(b,N);c.push(I)}if(c.length!==0)return{items:c,raw:d}}function Jy(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(r):n,[a,...o]=t.content,s=e.renderChildren([a]),c=[`${i}${s}`];return o&&o.length>0&&o.forEach(d=>{const h=e.renderChildren([d]);if(h){const p=h.split(`
`).map(x=>x?e.indent(x):"").join(`
`);c.push(p)}}),c.join(`
`)}function zF(t,e,n={}){const{state:r}=e,{doc:i,tr:a}=r,o=t;i.descendants((s,c)=>{const d=a.mapping.map(c),h=a.mapping.map(c)+s.nodeSize;let p=null;if(s.marks.forEach(v=>{if(v!==o)return!1;p=v}),!p)return;let x=!1;if(Object.keys(n).forEach(v=>{n[v]!==p.attrs[v]&&(x=!0)}),x){const v=t.type.create({...t.attrs,...n});a.removeMark(d,h,t.type),a.addMark(d,h,v)}}),a.docChanged&&e.view.dispatch(a)}var Cr=class l6 extends Ky{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new l6(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function dl(t){return new CF({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const a=It(t.getAttributes,void 0,r,i);if(a===!1||a===null)return null;const{tr:o}=e,s=r[r.length-1],c=r[0];let d=n.to;if(s){const h=c.search(/\S/),p=n.from+c.indexOf(s),x=p+s.length;if(Xy(n.from,n.to,e.doc).filter(b=>b.mark.type.excluded.find(E=>E===t.type&&E!==b.mark.type)).filter(b=>b.to>p).length)return null;x<n.to&&o.delete(x,n.to),p>n.from&&o.delete(n.from+h,p),d=n.from+h+s.length,o.addMark(n.from+h,d,t.type.create(a||{})),o.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:UF,getOwnPropertySymbols:HF}=Object,{hasOwnProperty:VF}=Object.prototype;function $g(t,e){return function(r,i,a){return t(r,i,a)&&e(r,i,a)}}function Sh(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:a}=i,o=a.get(n),s=a.get(r);if(o&&s)return o===r&&s===n;a.set(n,r),a.set(r,n);const c=t(n,r,i);return a.delete(n),a.delete(r),c}}function $F(t){return t!=null?t[Symbol.toStringTag]:void 0}function yA(t){return UF(t).concat(HF(t))}const GF=Object.hasOwn||((t,e)=>VF.call(t,e));function gl(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const WF="__v",qF="__o",XF="_owner",{getOwnPropertyDescriptor:bA,keys:wA}=Object;function KF(t,e){return t.byteLength===e.byteLength&&Rp(new Uint8Array(t),new Uint8Array(e))}function YF(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function ZF(t,e){return t.byteLength===e.byteLength&&Rp(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function JF(t,e){return gl(t.getTime(),e.getTime())}function QF(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function ez(t,e){return t===e}function CA(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),a=t.entries();let o,s,c=0;for(;(o=a.next())&&!o.done;){const d=e.entries();let h=!1,p=0;for(;(s=d.next())&&!s.done;){if(i[p]){p++;continue}const x=o.value,v=s.value;if(n.equals(x[0],v[0],c,p,t,e,n)&&n.equals(x[1],v[1],x[0],v[0],t,e,n)){h=i[p]=!0;break}p++}if(!h)return!1;c++}return!0}const tz=gl;function nz(t,e,n){const r=wA(t);let i=r.length;if(wA(e).length!==i)return!1;for(;i-- >0;)if(!c6(t,e,n,r[i]))return!1;return!0}function Pu(t,e,n){const r=yA(t);let i=r.length;if(yA(e).length!==i)return!1;let a,o,s;for(;i-- >0;)if(a=r[i],!c6(t,e,n,a)||(o=bA(t,a),s=bA(e,a),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function rz(t,e){return gl(t.valueOf(),e.valueOf())}function iz(t,e){return t.source===e.source&&t.flags===e.flags}function EA(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),a=t.values();let o,s;for(;(o=a.next())&&!o.done;){const c=e.values();let d=!1,h=0;for(;(s=c.next())&&!s.done;){if(!i[h]&&n.equals(o.value,s.value,o.value,s.value,t,e,n)){d=i[h]=!0;break}h++}if(!d)return!1}return!0}function Rp(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function az(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function c6(t,e,n,r){return(r===XF||r===qF||r===WF)&&(t.$$typeof||e.$$typeof)?!0:GF(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const oz="[object ArrayBuffer]",sz="[object Arguments]",lz="[object Boolean]",cz="[object DataView]",uz="[object Date]",dz="[object Error]",fz="[object Map]",hz="[object Number]",pz="[object Object]",mz="[object RegExp]",gz="[object Set]",xz="[object String]",vz={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},yz="[object URL]",bz=Object.prototype.toString;function wz({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:o,areNumbersEqual:s,areObjectsEqual:c,arePrimitiveWrappersEqual:d,areRegExpsEqual:h,areSetsEqual:p,areTypedArraysEqual:x,areUrlsEqual:v,unknownTagComparators:b}){return function(E,S,N){if(E===S)return!0;if(E==null||S==null)return!1;const k=typeof E;if(k!==typeof S)return!1;if(k!=="object")return k==="number"?s(E,S,N):k==="function"?a(E,S,N):!1;const I=E.constructor;if(I!==S.constructor)return!1;if(I===Object)return c(E,S,N);if(Array.isArray(E))return e(E,S,N);if(I===Date)return r(E,S,N);if(I===RegExp)return h(E,S,N);if(I===Map)return o(E,S,N);if(I===Set)return p(E,S,N);const D=bz.call(E);if(D===uz)return r(E,S,N);if(D===mz)return h(E,S,N);if(D===fz)return o(E,S,N);if(D===gz)return p(E,S,N);if(D===pz)return typeof E.then!="function"&&typeof S.then!="function"&&c(E,S,N);if(D===yz)return v(E,S,N);if(D===dz)return i(E,S,N);if(D===sz)return c(E,S,N);if(vz[D])return x(E,S,N);if(D===oz)return t(E,S,N);if(D===cz)return n(E,S,N);if(D===lz||D===hz||D===xz)return d(E,S,N);if(b){let L=b[D];if(!L){const O=$F(E);O&&(L=b[O])}if(L)return L(E,S,N)}return!1}}function Cz({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:KF,areArraysEqual:n?Pu:YF,areDataViewsEqual:ZF,areDatesEqual:JF,areErrorsEqual:QF,areFunctionsEqual:ez,areMapsEqual:n?$g(CA,Pu):CA,areNumbersEqual:tz,areObjectsEqual:n?Pu:nz,arePrimitiveWrappersEqual:rz,areRegExpsEqual:iz,areSetsEqual:n?$g(EA,Pu):EA,areTypedArraysEqual:n?$g(Rp,Pu):Rp,areUrlsEqual:az,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=Sh(r.areArraysEqual),a=Sh(r.areMapsEqual),o=Sh(r.areObjectsEqual),s=Sh(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:s})}return r}function Ez(t){return function(e,n,r,i,a,o,s){return t(e,n,s)}}function Sz({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(s,c){const{cache:d=t?new WeakMap:void 0,meta:h}=n();return e(s,c,{cache:d,equals:r,meta:h,strict:i})};if(t)return function(s,c){return e(s,c,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const a={cache:void 0,equals:r,meta:void 0,strict:i};return function(s,c){return e(s,c,a)}}const Az=ps();ps({strict:!0});ps({circular:!0});ps({circular:!0,strict:!0});ps({createInternalComparator:()=>gl});ps({strict:!0,createInternalComparator:()=>gl});ps({circular:!0,createInternalComparator:()=>gl});ps({circular:!0,createInternalComparator:()=>gl,strict:!0});function ps(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,a=Cz(t),o=wz(a),s=n?n(o):Ez(o);return Sz({circular:e,comparator:o,createState:r,equals:s,strict:i})}var Gg={exports:{}},Wg={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SA;function _z(){if(SA)return Wg;SA=1;var t=Pd(),e=eN();function n(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,a=t.useRef,o=t.useEffect,s=t.useMemo,c=t.useDebugValue;return Wg.useSyncExternalStoreWithSelector=function(d,h,p,x,v){var b=a(null);if(b.current===null){var C={hasValue:!1,value:null};b.current=C}else C=b.current;b=s(function(){function S(L){if(!N){if(N=!0,k=L,L=x(L),v!==void 0&&C.hasValue){var O=C.value;if(v(O,L))return I=O}return I=L}if(O=I,r(k,L))return O;var j=x(L);return v!==void 0&&v(O,j)?(k=L,O):(k=L,I=j)}var N=!1,k,I,D=p===void 0?null:p;return[function(){return S(h())},D===null?void 0:function(){return S(D())}]},[h,p,x,v]);var E=i(d,b[0],b[1]);return o(function(){C.hasValue=!0,C.value=E},[E]),c(E),E},Wg}var AA;function Nz(){return AA||(AA=1,Gg.exports=_z()),Gg.exports}var kz=Nz(),Tz=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},Oz=({contentComponent:t})=>{const e=tN.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return m.jsx(m.Fragment,{children:Object.values(e)})};function Iz(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:ED.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}var Dz=class extends Qe.Component{constructor(t){var e;super(t),this.editorContentRef=Qe.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=Iz(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return m.jsxs(m.Fragment,{children:[m.jsx("div",{ref:Tz(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&m.jsx(Oz,{contentComponent:t.contentComponent})]})}},Mz=A.forwardRef((t,e)=>{const n=Qe.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Qe.createElement(Dz,{key:n,innerRef:e,...t})}),u6=Qe.memo(Mz),Rz=typeof window<"u"?A.useLayoutEffect:A.useEffect,Lz=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function jz(t){var e;const[n]=A.useState(()=>new Lz(t.editor)),r=kz.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:Az);return Rz(()=>n.watch(t.editor),[t.editor,n]),A.useDebugValue(r),r}var Pz=!1,vv=typeof window>"u",Bz=vv||!!(typeof window<"u"&&window.next),Fz=class d6{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?vv||Bz?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,a;return(a=(i=this.options.current).onBeforeCreate)==null?void 0:a.call(i,...r)},onBlur:(...r)=>{var i,a;return(a=(i=this.options.current).onBlur)==null?void 0:a.call(i,...r)},onCreate:(...r)=>{var i,a;return(a=(i=this.options.current).onCreate)==null?void 0:a.call(i,...r)},onDestroy:(...r)=>{var i,a;return(a=(i=this.options.current).onDestroy)==null?void 0:a.call(i,...r)},onFocus:(...r)=>{var i,a;return(a=(i=this.options.current).onFocus)==null?void 0:a.call(i,...r)},onSelectionUpdate:(...r)=>{var i,a;return(a=(i=this.options.current).onSelectionUpdate)==null?void 0:a.call(i,...r)},onTransaction:(...r)=>{var i,a;return(a=(i=this.options.current).onTransaction)==null?void 0:a.call(i,...r)},onUpdate:(...r)=>{var i,a;return(a=(i=this.options.current).onUpdate)==null?void 0:a.call(i,...r)},onContentError:(...r)=>{var i,a;return(a=(i=this.options.current).onContentError)==null?void 0:a.call(i,...r)},onDrop:(...r)=>{var i,a;return(a=(i=this.options.current).onDrop)==null?void 0:a.call(i,...r)},onPaste:(...r)=>{var i,a;return(a=(i=this.options.current).onPaste)==null?void 0:a.call(i,...r)},onDelete:(...r)=>{var i,a;return(a=(i=this.options.current).onDelete)==null?void 0:a.call(i,...r)}};return new IF(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,a)=>{var o;return i===((o=n.extensions)==null?void 0:o[a])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?d6.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function zz(t={},e=[]){const n=A.useRef(t);n.current=t;const[r]=A.useState(()=>new Fz(n)),i=tN.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return A.useDebugValue(i),A.useEffect(r.onRender(e)),jz({editor:i,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),i}var f6=A.createContext({editor:null});f6.Consumer;var Uz=A.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Hz=()=>A.useContext(Uz);Qe.forwardRef((t,e)=>{const{onDragStart:n}=Hz(),r=t.as||"div";return m.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});Qe.createContext({markViewContentRef:()=>{}});var Qy=A.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});Qy.displayName="TiptapContext";var Vz=()=>A.useContext(Qy);function h6({editor:t,instance:e,children:n}){const r=t??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const i=A.useMemo(()=>({editor:r}),[r]),a=A.useMemo(()=>({editor:r}),[r]);return m.jsx(f6.Provider,{value:a,children:m.jsx(Qy.Provider,{value:i,children:n})})}h6.displayName="Tiptap";function p6({...t}){const{editor:e}=Vz();return m.jsx(u6,{editor:e,...t})}p6.displayName="Tiptap.Content";Object.assign(h6,{Content:p6});var Lp=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},$z=/^\s*>\s$/,Gz=Cr.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Lp("blockquote",{...un(this.options.HTMLAttributes,t),children:Lp("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(i=>{const s=e.renderChildren([i]).split(`
`).map(c=>c.trim()===""?n:`${n} ${c}`);r.push(s.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Tc({find:$z,type:this.type})]}}),Wz=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,qz=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Xz=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Kz=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Yz=hs.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Lp("strong",{...un(this.options.HTMLAttributes,t),children:Lp("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[kc({find:Wz,type:this.type}),kc({find:Xz,type:this.type})]},addPasteRules(){return[dl({find:qz,type:this.type}),dl({find:Kz,type:this.type})]}}),Zz=/(^|[^`])`([^`]+)`(?!`)$/,Jz=/(^|[^`])`([^`]+)`(?!`)/g,Qz=hs.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",un(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[kc({find:Zz,type:this.type})]},addPasteRules(){return[dl({find:Jz,type:this.type})]}}),qg=4,eU=/^```([a-z]+)?[\s\n]$/,tU=/^~~~([a-z]+)?[\s\n]$/,nU=Cr.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:qg,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",un(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const i=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:qg,{state:r}=t,{selection:i}=r,{$from:a,empty:o}=i;if(a.parent.type!==this.type)return!1;const s=" ".repeat(n);return o?t.commands.insertContent(s):t.commands.command(({tr:c})=>{const{from:d,to:h}=i,v=r.doc.textBetween(d,h,`
`,`
`).split(`
`).map(b=>s+b).join(`
`);return c.replaceWith(d,h,r.schema.text(v)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:qg,{state:r}=t,{selection:i}=r,{$from:a,empty:o}=i;return a.parent.type!==this.type?!1:o?t.commands.command(({tr:s})=>{var c;const{pos:d}=a,h=a.start(),p=a.end(),v=r.doc.textBetween(h,p,`
`,`
`).split(`
`);let b=0,C=0;const E=d-h;for(let L=0;L<v.length;L+=1){if(C+v[L].length>=E){b=L;break}C+=v[L].length+1}const N=((c=v[b].match(/^ */))==null?void 0:c[0])||"",k=Math.min(N.length,n);if(k===0)return!0;let I=h;for(let L=0;L<b;L+=1)I+=v[L].length+1;return s.delete(I,I+k),d-I<=k&&s.setSelection(Ge.create(s.doc,I)),!0}):t.commands.command(({tr:s})=>{const{from:c,to:d}=i,x=r.doc.textBetween(c,d,`
`,`
`).split(`
`).map(v=>{var b;const C=((b=v.match(/^ */))==null?void 0:b[0])||"",E=Math.min(C.length,n);return v.slice(E)}).join(`
`);return s.replaceWith(c,d,r.schema.text(x)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!a||!o?!1:t.chain().command(({tr:s})=>(s.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:a}=n;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const s=i.after();return s===void 0?!1:r.nodeAt(s)?t.commands.command(({tr:d})=>(d.setSelection(Ze.near(r.resolve(s))),!0)):t.commands.exitCode()}}},addInputRules(){return[gv({find:eU,type:this.type,getAttributes:t=>({language:t[1]})}),gv({find:tU,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new dn({key:new Sn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,a=i==null?void 0:i.mode;if(!n||!a)return!1;const{tr:o,schema:s}=t.state,c=s.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:a},c)),o.selection.$from.parent.type!==this.type&&o.setSelection(Ge.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),rU=Cr.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),iU=Cr.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",un(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:a}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:s}=r.extensionManager,c=a||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:h})=>{if(h&&c&&o){const p=c.filter(x=>s.includes(x.type.name));d.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),aU=Cr.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,un(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,i="#".repeat(r);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>gv({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),oU=Cr.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",un(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!MF(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,i=t();return Gk(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:a,tr:o,dispatch:s})=>{if(s){const{$to:c}=o.selection,d=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(Ge.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection($e.create(o.doc,c.pos)):o.setSelection(Ge.create(o.doc,c.pos));else{const h=a.schema.nodes[this.options.nextNodeType]||c.parent.type.contentMatch.defaultType,p=h==null?void 0:h.create();p&&(o.insert(d,p),o.setSelection(Ge.create(o.doc,d+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[DF({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),sU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,lU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,cU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,uU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,dU=hs.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",un(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[kc({find:sU,type:this.type}),kc({find:cU,type:this.type})]},addPasteRules(){return[dl({find:lU,type:this.type}),dl({find:uU,type:this.type})]}});const fU="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",hU="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",yv="numeric",bv="ascii",wv="alpha",ld="asciinumeric",qu="alphanumeric",Cv="domain",m6="emoji",pU="scheme",mU="slashscheme",Xg="whitespace";function gU(t,e){return t in e||(e[t]=[]),e[t]}function Xs(t,e,n){e[yv]&&(e[ld]=!0,e[qu]=!0),e[bv]&&(e[ld]=!0,e[wv]=!0),e[ld]&&(e[qu]=!0),e[wv]&&(e[qu]=!0),e[qu]&&(e[Cv]=!0),e[m6]&&(e[Cv]=!0);for(const r in e){const i=gU(r,n);i.indexOf(t)<0&&i.push(t)}}function xU(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function ni(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}ni.groups={};ni.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],a=e.jr[r][1];if(a&&i.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let i=0;i<t.length;i++)this.tt(t[i],e,n,r)},tr(t,e,n,r){r=r||ni.groups;let i;return e&&e.j?i=e:(i=new ni(e),n&&r&&Xs(e,n,r)),this.jr.push([t,i]),i},ts(t,e,n,r){let i=this;const a=t.length;if(!a)return i;for(let o=0;o<a-1;o++)i=i.tt(t[o]);return i.tt(t[a-1],e,n,r)},tt(t,e,n,r){r=r||ni.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const a=e;let o,s=i.go(t);if(s?(o=new ni,Object.assign(o.j,s.j),o.jr.push.apply(o.jr,s.jr),o.jd=s.jd,o.t=s.t):o=new ni,a){if(r)if(o.t&&typeof o.t=="string"){const c=Object.assign(xU(o.t,r),n);Xs(a,c,r)}else n&&Xs(a,n,r);o.t=a}return i.j[t]=o,o}};const at=(t,e,n,r,i)=>t.ta(e,n,r,i),wn=(t,e,n,r,i)=>t.tr(e,n,r,i),_A=(t,e,n,r,i)=>t.ts(e,n,r,i),ke=(t,e,n,r,i)=>t.tt(e,n,r,i),Ga="WORD",Ev="UWORD",g6="ASCIINUMERICAL",x6="ALPHANUMERICAL",Id="LOCALHOST",Sv="TLD",Av="UTLD",Kh="SCHEME",rc="SLASH_SCHEME",e2="NUM",_v="WS",t2="NL",cd="OPENBRACE",ud="CLOSEBRACE",jp="OPENBRACKET",Pp="CLOSEBRACKET",Bp="OPENPAREN",Fp="CLOSEPAREN",zp="OPENANGLEBRACKET",Up="CLOSEANGLEBRACKET",Hp="FULLWIDTHLEFTPAREN",Vp="FULLWIDTHRIGHTPAREN",$p="LEFTCORNERBRACKET",Gp="RIGHTCORNERBRACKET",Wp="LEFTWHITECORNERBRACKET",qp="RIGHTWHITECORNERBRACKET",Xp="FULLWIDTHLESSTHAN",Kp="FULLWIDTHGREATERTHAN",Yp="AMPERSAND",Zp="APOSTROPHE",Jp="ASTERISK",zo="AT",Qp="BACKSLASH",e0="BACKTICK",t0="CARET",$o="COLON",n2="COMMA",n0="DOLLAR",fa="DOT",r0="EQUALS",r2="EXCLAMATION",Ti="HYPHEN",dd="PERCENT",i0="PIPE",a0="PLUS",o0="POUND",fd="QUERY",i2="QUOTE",v6="FULLWIDTHMIDDLEDOT",a2="SEMI",ha="SLASH",hd="TILDE",s0="UNDERSCORE",y6="EMOJI",l0="SYM";var b6=Object.freeze({__proto__:null,ALPHANUMERICAL:x6,AMPERSAND:Yp,APOSTROPHE:Zp,ASCIINUMERICAL:g6,ASTERISK:Jp,AT:zo,BACKSLASH:Qp,BACKTICK:e0,CARET:t0,CLOSEANGLEBRACKET:Up,CLOSEBRACE:ud,CLOSEBRACKET:Pp,CLOSEPAREN:Fp,COLON:$o,COMMA:n2,DOLLAR:n0,DOT:fa,EMOJI:y6,EQUALS:r0,EXCLAMATION:r2,FULLWIDTHGREATERTHAN:Kp,FULLWIDTHLEFTPAREN:Hp,FULLWIDTHLESSTHAN:Xp,FULLWIDTHMIDDLEDOT:v6,FULLWIDTHRIGHTPAREN:Vp,HYPHEN:Ti,LEFTCORNERBRACKET:$p,LEFTWHITECORNERBRACKET:Wp,LOCALHOST:Id,NL:t2,NUM:e2,OPENANGLEBRACKET:zp,OPENBRACE:cd,OPENBRACKET:jp,OPENPAREN:Bp,PERCENT:dd,PIPE:i0,PLUS:a0,POUND:o0,QUERY:fd,QUOTE:i2,RIGHTCORNERBRACKET:Gp,RIGHTWHITECORNERBRACKET:qp,SCHEME:Kh,SEMI:a2,SLASH:ha,SLASH_SCHEME:rc,SYM:l0,TILDE:hd,TLD:Sv,UNDERSCORE:s0,UTLD:Av,UWORD:Ev,WORD:Ga,WS:_v});const Va=/[a-z]/,Bu=new RegExp("\\p{L}","u"),Kg=new RegExp("\\p{Emoji}","u"),$a=/\d/,Yg=/\s/,NA="\r",Zg=`
`,vU="",yU="",Jg="";let Ah=null,_h=null;function bU(t=[]){const e={};ni.groups=e;const n=new ni;Ah==null&&(Ah=kA(fU)),_h==null&&(_h=kA(hU)),ke(n,"'",Zp),ke(n,"{",cd),ke(n,"}",ud),ke(n,"[",jp),ke(n,"]",Pp),ke(n,"(",Bp),ke(n,")",Fp),ke(n,"<",zp),ke(n,">",Up),ke(n,"",Hp),ke(n,"",Vp),ke(n,"",$p),ke(n,"",Gp),ke(n,"",Wp),ke(n,"",qp),ke(n,"",Xp),ke(n,"",Kp),ke(n,"&",Yp),ke(n,"*",Jp),ke(n,"@",zo),ke(n,"`",e0),ke(n,"^",t0),ke(n,":",$o),ke(n,",",n2),ke(n,"$",n0),ke(n,".",fa),ke(n,"=",r0),ke(n,"!",r2),ke(n,"-",Ti),ke(n,"%",dd),ke(n,"|",i0),ke(n,"+",a0),ke(n,"#",o0),ke(n,"?",fd),ke(n,'"',i2),ke(n,"/",ha),ke(n,";",a2),ke(n,"~",hd),ke(n,"_",s0),ke(n,"\\",Qp),ke(n,"",v6);const r=wn(n,$a,e2,{[yv]:!0});wn(r,$a,r);const i=wn(r,Va,g6,{[ld]:!0}),a=wn(r,Bu,x6,{[qu]:!0}),o=wn(n,Va,Ga,{[bv]:!0});wn(o,$a,i),wn(o,Va,o),wn(i,$a,i),wn(i,Va,i);const s=wn(n,Bu,Ev,{[wv]:!0});wn(s,Va),wn(s,$a,a),wn(s,Bu,s),wn(a,$a,a),wn(a,Va),wn(a,Bu,a);const c=ke(n,Zg,t2,{[Xg]:!0}),d=ke(n,NA,_v,{[Xg]:!0}),h=wn(n,Yg,_v,{[Xg]:!0});ke(n,Jg,h),ke(d,Zg,c),ke(d,Jg,h),wn(d,Yg,h),ke(h,NA),ke(h,Zg),wn(h,Yg,h),ke(h,Jg,h);const p=wn(n,Kg,y6,{[m6]:!0});ke(p,"#"),wn(p,Kg,p),ke(p,vU,p);const x=ke(p,yU);ke(x,"#"),wn(x,Kg,p);const v=[[Va,o],[$a,i]],b=[[Va,null],[Bu,s],[$a,a]];for(let C=0;C<Ah.length;C++)Mo(n,Ah[C],Sv,Ga,v);for(let C=0;C<_h.length;C++)Mo(n,_h[C],Av,Ev,b);Xs(Sv,{tld:!0,ascii:!0},e),Xs(Av,{utld:!0,alpha:!0},e),Mo(n,"file",Kh,Ga,v),Mo(n,"mailto",Kh,Ga,v),Mo(n,"http",rc,Ga,v),Mo(n,"https",rc,Ga,v),Mo(n,"ftp",rc,Ga,v),Mo(n,"ftps",rc,Ga,v),Xs(Kh,{scheme:!0,ascii:!0},e),Xs(rc,{slashscheme:!0,ascii:!0},e),t=t.sort((C,E)=>C[0]>E[0]?1:-1);for(let C=0;C<t.length;C++){const E=t[C][0],N=t[C][1]?{[pU]:!0}:{[mU]:!0};E.indexOf("-")>=0?N[Cv]=!0:Va.test(E)?$a.test(E)?N[ld]=!0:N[bv]=!0:N[yv]=!0,_A(n,E,E,N)}return _A(n,"localhost",Id,{ascii:!0}),n.jd=new ni(l0),{start:n,tokens:Object.assign({groups:e},b6)}}function w6(t,e){const n=wU(e.replace(/[A-Z]/g,s=>s.toLowerCase())),r=n.length,i=[];let a=0,o=0;for(;o<r;){let s=t,c=null,d=0,h=null,p=-1,x=-1;for(;o<r&&(c=s.go(n[o]));)s=c,s.accepts()?(p=0,x=0,h=s):p>=0&&(p+=n[o].length,x++),d+=n[o].length,a+=n[o].length,o++;a-=p,o-=x,d-=p,i.push({t:h.t,v:e.slice(a-d,a),s:a-d,e:a})}return i}function wU(t){const e=[],n=t.length;let r=0;for(;r<n;){let i=t.charCodeAt(r),a,o=i<55296||i>56319||r+1===n||(a=t.charCodeAt(r+1))<56320||a>57343?t[r]:t.slice(r,r+2);e.push(o),r+=o.length}return e}function Mo(t,e,n,r,i){let a;const o=e.length;for(let s=0;s<o-1;s++){const c=e[s];t.j[c]?a=t.j[c]:(a=new ni(r),a.jr=i.slice(),t.j[c]=a),t=a}return a=new ni(n),a.jr=i.slice(),t.j[e[o-1]]=a,a}function kA(t){const e=[],n=[];let r=0,i="0123456789";for(;r<t.length;){let a=0;for(;i.indexOf(t[r+a])>=0;)a++;if(a>0){e.push(n.join(""));for(let o=parseInt(t.substring(r,r+a),10);o>0;o--)n.pop();r+=a}else n.push(t[r]),r++}return e}const Dd={defaultProtocol:"http",events:null,format:TA,formatHref:TA,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function o2(t,e=null){let n=Object.assign({},Dd);t&&(n=Object.assign(n,t instanceof o2?t.o:t));const r=n.ignoreTags,i=[];for(let a=0;a<r.length;a++)i.push(r[a].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=i}o2.prototype={o:Dd,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:Dd[t],typeof i=="function"&&r&&(i=i(e,n))):typeof i=="function"&&r&&(i=i(e,n.t,n)),i)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function TA(t){return t}function C6(t,e){this.t="token",this.v=t,this.tk=e}C6.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Dd.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),i=t.get("tagName",n,e),a=this.toFormattedString(t),o={},s=t.get("className",n,e),c=t.get("target",n,e),d=t.get("rel",n,e),h=t.getObj("attributes",n,e),p=t.getObj("events",n,e);return o.href=r,s&&(o.class=s),c&&(o.target=c),d&&(o.rel=d),h&&Object.assign(o,h),{tagName:i,attributes:o,content:a,eventListeners:p}}};function K0(t,e){class n extends C6{constructor(i,a){super(i,a),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const OA=K0("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),IA=K0("text"),CU=K0("nl"),Nh=K0("url",{isLink:!0,toHref(t=Dd.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Id&&t[1].t===$o}}),ki=t=>new ni(t);function EU({groups:t}){const e=t.domain.concat([Yp,Jp,zo,Qp,e0,t0,n0,r0,Ti,e2,dd,i0,a0,o0,ha,l0,hd,s0]),n=[Zp,$o,n2,fa,r2,dd,fd,i2,a2,zp,Up,cd,ud,Pp,jp,Bp,Fp,Hp,Vp,$p,Gp,Wp,qp,Xp,Kp],r=[Yp,Zp,Jp,Qp,e0,t0,n0,r0,Ti,cd,ud,dd,i0,a0,o0,fd,ha,l0,hd,s0],i=ki(),a=ke(i,hd);at(a,r,a),at(a,t.domain,a);const o=ki(),s=ki(),c=ki();at(i,t.domain,o),at(i,t.scheme,s),at(i,t.slashscheme,c),at(o,r,a),at(o,t.domain,o);const d=ke(o,zo);ke(a,zo,d),ke(s,zo,d),ke(c,zo,d);const h=ke(a,fa);at(h,r,a),at(h,t.domain,a);const p=ki();at(d,t.domain,p),at(p,t.domain,p);const x=ke(p,fa);at(x,t.domain,p);const v=ki(OA);at(x,t.tld,v),at(x,t.utld,v),ke(d,Id,v);const b=ke(p,Ti);ke(b,Ti,b),at(b,t.domain,p),at(v,t.domain,p),ke(v,fa,x),ke(v,Ti,b);const C=ke(v,$o);at(C,t.numeric,OA);const E=ke(o,Ti),S=ke(o,fa);ke(E,Ti,E),at(E,t.domain,o),at(S,r,a),at(S,t.domain,o);const N=ki(Nh);at(S,t.tld,N),at(S,t.utld,N),at(N,t.domain,o),at(N,r,a),ke(N,fa,S),ke(N,Ti,E),ke(N,zo,d);const k=ke(N,$o),I=ki(Nh);at(k,t.numeric,I);const D=ki(Nh),L=ki();at(D,e,D),at(D,n,L),at(L,e,D),at(L,n,L),ke(N,ha,D),ke(I,ha,D);const O=ke(s,$o),j=ke(c,$o),U=ke(j,ha),fe=ke(U,ha);at(s,t.domain,o),ke(s,fa,S),ke(s,Ti,E),at(c,t.domain,o),ke(c,fa,S),ke(c,Ti,E),at(O,t.domain,D),ke(O,ha,D),ke(O,fd,D),at(fe,t.domain,D),at(fe,e,D),ke(fe,ha,D);const le=[[cd,ud],[jp,Pp],[Bp,Fp],[zp,Up],[Hp,Vp],[$p,Gp],[Wp,qp],[Xp,Kp]];for(let q=0;q<le.length;q++){const[de,ge]=le[q],xe=ke(D,de);ke(L,de,xe),ke(xe,ge,D);const H=ki(Nh);at(xe,e,H);const ie=ki();at(xe,n),at(H,e,H),at(H,n,ie),at(ie,e,H),at(ie,n,ie),ke(H,ge,D),ke(ie,ge,D)}return ke(i,Id,N),ke(i,t2,CU),{start:i,tokens:b6}}function SU(t,e,n){let r=n.length,i=0,a=[],o=[];for(;i<r;){let s=t,c=null,d=null,h=0,p=null,x=-1;for(;i<r&&!(c=s.go(n[i].t));)o.push(n[i++]);for(;i<r&&(d=c||s.go(n[i].t));)c=null,s=d,s.accepts()?(x=0,p=s):x>=0&&x++,i++,h++;if(x<0)i-=h,i<r&&(o.push(n[i]),i++);else{o.length>0&&(a.push(Qg(IA,e,o)),o=[]),i-=x,h-=x;const v=p.t,b=n.slice(i-h,i);a.push(Qg(v,e,b))}}return o.length>0&&a.push(Qg(IA,e,o)),a}function Qg(t,e,n){const r=n[0].s,i=n[n.length-1].e,a=e.slice(r,i);return new t(a,n)}const AU=typeof console<"u"&&console&&console.warn||(()=>{}),_U="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",ln={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function NU(){return ni.groups={},ln.scanner=null,ln.parser=null,ln.tokenQueue=[],ln.pluginQueue=[],ln.customSchemes=[],ln.initialized=!1,ln}function DA(t,e=!1){if(ln.initialized&&AU(`linkifyjs: already initialized - will not register custom scheme "${t}" ${_U}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);ln.customSchemes.push([t,e])}function kU(){ln.scanner=bU(ln.customSchemes);for(let t=0;t<ln.tokenQueue.length;t++)ln.tokenQueue[t][1]({scanner:ln.scanner});ln.parser=EU(ln.scanner.tokens);for(let t=0;t<ln.pluginQueue.length;t++)ln.pluginQueue[t][1]({scanner:ln.scanner,parser:ln.parser});return ln.initialized=!0,ln}function s2(t){return ln.initialized||kU(),SU(ln.parser.start,t,w6(ln.scanner.start,t))}s2.scan=w6;function E6(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new o2(n),i=s2(t),a=[];for(let o=0;o<i.length;o++){const s=i[o];s.isLink&&(!e||s.t===e)&&r.check(s)&&a.push(s.toFormattedObject(r))}return a}var l2="[\0- -\u2029]",TU=new RegExp(l2),OU=new RegExp(`${l2}$`),IU=new RegExp(l2,"g");function DU(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function MU(t){return new dn({key:new Sn("autolink"),appendTransaction:(e,n,r)=>{const i=e.some(d=>d.docChanged)&&!n.doc.eq(r.doc),a=e.some(d=>d.getMeta("preventAutolink"));if(!i||a)return;const{tr:o}=r,s=jk(n.doc,[...e]);if($k(s).forEach(({newRange:d})=>{const h=RB(r.doc,d,v=>v.isTextblock);let p,x;if(h.length>1)p=h[0],x=r.doc.textBetween(p.pos,p.pos+p.node.nodeSize,void 0," ");else if(h.length){const v=r.doc.textBetween(d.from,d.to," "," ");if(!OU.test(v))return;p=h[0],x=r.doc.textBetween(p.pos,d.to,void 0," ")}if(p&&x){const v=x.split(TU).filter(Boolean);if(v.length<=0)return!1;const b=v[v.length-1],C=p.pos+x.lastIndexOf(b);if(!b)return!1;const E=s2(b).map(S=>S.toObject(t.defaultProtocol));if(!DU(E))return!1;E.filter(S=>S.isLink).map(S=>({...S,from:C+S.start+1,to:C+S.end+1})).filter(S=>r.schema.marks.code?!r.doc.rangeHasMark(S.from,S.to,r.schema.marks.code):!0).filter(S=>t.validate(S.value)).filter(S=>t.shouldAutoLink(S.value)).forEach(S=>{Xy(S.from,S.to,r.doc).some(N=>N.mark.type===t.type)||o.addMark(S.from,S.to,t.type.create({href:S.href}))})}}),!!o.steps.length)return o}})}function RU(t){return new dn({key:new Sn("handleClickLink"),props:{handleClick:(e,n,r)=>{var i,a;if(r.button!==0||!e.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{const c=r.target;if(!c)return!1;const d=t.editor.view.dom;o=c.closest("a"),o&&!d.contains(o)&&(o=null)}if(!o)return!1;let s=!1;if(t.enableClickSelection&&(s=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const c=Vk(e.state,t.type.name),d=(i=o.href)!=null?i:c.href,h=(a=o.target)!=null?a:c.target;d&&(window.open(d,h),s=!0)}return s}}})}function LU(t){return new dn({key:new Sn("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:i}=t,{state:a}=e,{selection:o}=a,{empty:s}=o;if(s)return!1;let c="";r.content.forEach(h=>{c+=h.textContent});const d=E6(c,{defaultProtocol:t.defaultProtocol}).find(h=>h.isLink&&h.value===c);return!c||!d||i!==void 0&&!i(d.value)?!1:t.editor.commands.setMark(t.type,{href:d.href})}}})}function Ps(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&n.push(i)}),!t||t.replace(IU,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var jU=hs.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){DA(t);return}DA(t.scheme,t.optionalSlashes)})},onDestroy(){NU()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Ps(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Ps(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Ps(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",un(this.options.HTMLAttributes,t),0]:["a",un(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n,r,i,a;const o=(r=(n=t.attrs)==null?void 0:n.href)!=null?r:"",s=(a=(i=t.attrs)==null?void 0:i.title)!=null?a:"",c=e.renderChildren(t);return s?`[${c}](${o} "${s}")`:`[${c}](${o})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Ps(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Ps(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[dl({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,i=E6(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:o=>!!Ps(o,n),protocols:n,defaultProtocol:r}));i.length&&i.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(MU({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!Ps(i,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(RU({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(LU({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),PU=Object.defineProperty,BU=(t,e)=>{for(var n in e)PU(t,n,{get:e[n],enumerable:!0})},FU="listItem",MA="textStyle",RA=/^\s*([-+*])\s$/,S6=Cr.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",un(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(FU,this.editor.getAttributes(MA)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Tc({find:RA,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Tc({find:RA,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(MA),editor:this.editor})),[t]}}),A6=Cr.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",un(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))n=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const o=t.tokens.slice(1),s=e.parseChildren(o);n.push(...s)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Jy(t,e,r=>{var i,a;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((a=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:a.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),zU={};BU(zU,{findListItemPos:()=>Xd,getNextListDepth:()=>c2,handleBackspace:()=>Nv,handleDelete:()=>kv,hasListBefore:()=>_6,hasListItemAfter:()=>UU,hasListItemBefore:()=>N6,listItemHasSubList:()=>k6,nextListIsDeeper:()=>T6,nextListIsHigher:()=>O6});var Xd=(t,e)=>{const{$from:n}=e.selection,r=Bn(t,e.schema);let i=null,a=n.depth,o=n.pos,s=null;for(;a>0&&s===null;)i=n.node(a),i.type===r?s=a:(a-=1,o-=1);return s===null?null:{$pos:e.doc.resolve(o),depth:s}},c2=(t,e)=>{const n=Xd(t,e);if(!n)return!1;const[,r]=VB(e,t,n.$pos.pos+4);return r},_6=(t,e,n)=>{const{$anchor:r}=t.selection,i=Math.max(0,r.pos-2),a=t.doc.resolve(i).node();return!(!a||!n.includes(a.type.name))},N6=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((n=i.nodeBefore)==null?void 0:n.type.name)!==t)},k6=(t,e,n)=>{if(!n)return!1;const r=Bn(t,e.schema);let i=!1;return n.descendants(a=>{a.type===r&&(i=!0)}),i},Nv=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!cs(t.state,e)&&_6(t.state,e,n)){const{$anchor:s}=t.state.selection,c=t.state.doc.resolve(s.before()-1),d=[];c.node().descendants((x,v)=>{x.type.name===e&&d.push({node:x,pos:v})});const h=d.at(-1);if(!h)return!1;const p=t.state.doc.resolve(c.start()+h.pos+1);return t.chain().cut({from:s.start()-1,to:s.end()+1},p.end()).joinForward().run()}if(!cs(t.state,e)||!qB(t.state))return!1;const r=Xd(e,t.state);if(!r)return!1;const a=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=k6(e,t.state,a);return N6(e,t.state)&&!o?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},T6=(t,e)=>{const n=c2(t,e),r=Xd(t,e);return!r||!n?!1:n>r.depth},O6=(t,e)=>{const n=c2(t,e),r=Xd(t,e);return!r||!n?!1:n<r.depth},kv=(t,e)=>{if(!cs(t.state,e)||!WB(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:i}=n;return!n.empty&&r.sameParent(i)?!1:T6(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():O6(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},UU=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((n=i.nodeAfter)==null?void 0:n.type.name)!==t)},I6=zt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&kv(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&kv(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Nv(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Nv(t,n,r)&&(e=!0)}),e}}}}),LA=/^(\s*)(\d+)\.\s+(.*)$/,HU=/^\s/;function VU(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n],a=i.match(LA);if(!a)break;const[,o,s,c]=a,d=o.length;let h=c,p=n+1;const x=[i];for(;p<t.length;){const v=t[p];if(v.match(LA))break;if(v.trim()==="")x.push(v),h+=`
`,p+=1;else if(v.match(HU))x.push(v),h+=`
${v.slice(d+2)}`,p+=1;else break}e.push({indent:d,number:parseInt(s,10),content:h.trim(),raw:x.join(`
`)}),r=p,n=p}return[e,r]}function D6(t,e,n){var r;const i=[];let a=0;for(;a<t.length;){const o=t[a];if(o.indent===e){const s=o.content.split(`
`),c=((r=s[0])==null?void 0:r.trim())||"",d=[];c&&d.push({type:"paragraph",raw:c,tokens:n.inlineTokens(c)});const h=s.slice(1).join(`
`).trim();if(h){const v=n.blockTokens(h);d.push(...v)}let p=a+1;const x=[];for(;p<t.length&&t[p].indent>e;)x.push(t[p]),p+=1;if(x.length>0){const v=Math.min(...x.map(C=>C.indent)),b=D6(x,v,n);d.push({type:"list",ordered:!0,start:x[0].number,items:b,raw:x.map(C=>C.raw).join(`
`)})}i.push({type:"list_item",raw:o.raw,tokens:d}),a=p}else a+=1}return i}function $U(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const a=e.parseChildren([i]);r.push({type:"paragraph",content:a})}else{const a=e.parseChildren([i]);a.length>0&&r.push(...a)}}),{type:"listItem",content:r}})}var GU="listItem",jA="textStyle",PA=/^(\d+)\.\s$/,M6=Cr.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",un(this.options.HTMLAttributes,n),0]:["ol",un(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?$U(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const i=t.split(`
`),[a,o]=VU(i);if(a.length===0)return;const s=D6(a,0,n);return s.length===0?void 0:{type:"list",ordered:!0,start:((r=a[0])==null?void 0:r.number)||1,items:s,raw:i.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(GU,this.editor.getAttributes(jA)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Tc({find:PA,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Tc({find:PA,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(jA)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),WU=/^\s*(\[([( |x])?\])\s$/,R6=Cr.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",un(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const i=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Jy(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const i=document.createElement("li"),a=document.createElement("label"),o=document.createElement("span"),s=document.createElement("input"),c=document.createElement("div"),d=p=>{var x,v;s.ariaLabel=((v=(x=this.options.a11y)==null?void 0:x.checkboxLabel)==null?void 0:v.call(x,p,s.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};d(t),a.contentEditable="false",s.type="checkbox",s.addEventListener("mousedown",p=>p.preventDefault()),s.addEventListener("change",p=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){s.checked=!s.checked;return}const{checked:x}=p.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const b=n();if(typeof b!="number")return!1;const C=v.doc.nodeAt(b);return v.setNodeMarkup(b,void 0,{...C==null?void 0:C.attrs,checked:x}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,x)||(s.checked=!s.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,x])=>{i.setAttribute(p,x)}),i.dataset.checked=t.attrs.checked,s.checked=t.attrs.checked,a.append(s,o),i.append(a,c),Object.entries(e).forEach(([p,x])=>{i.setAttribute(p,x)});let h=new Set(Object.keys(e));return{dom:i,contentDOM:c,update:p=>{if(p.type!==this.type)return!1;i.dataset.checked=p.attrs.checked,s.checked=p.attrs.checked,d(p);const x=r.extensionManager.attributes,v=Od(p,x),b=new Set(Object.keys(v)),C=this.options.HTMLAttributes;return h.forEach(E=>{b.has(E)||(E in C?i.setAttribute(E,C[E]):i.removeAttribute(E))}),Object.entries(v).forEach(([E,S])=>{S==null?E in C?i.setAttribute(E,C[E]):i.removeAttribute(E):i.setAttribute(E,S)}),h=b,!0}}}},addInputRules(){return[Tc({find:WU,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),L6=Cr.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",un(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=a=>{const o=xv(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,c)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:n.inlineTokens(s.mainContent),nestedTokens:c}),customNestedParser:r},n);return o?[{type:"taskList",raw:o.raw,items:o.items}]:n.blockTokens(a)},i=xv(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,o)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:n.inlineTokens(a.mainContent),nestedTokens:o}),customNestedParser:r},n);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});zt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(S6.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(A6.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(I6.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(M6.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(R6.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(L6.configure(this.options.taskList)),t}});var BA="&nbsp;",qU="",XU=Cr.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",un(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];if(n.length===1&&n[0].type==="image")return e.parseChildren([n[0]]);const r=e.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===BA||r[0].text===qU)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(t,e)=>{if(!t)return"";const n=Array.isArray(t.content)?t.content:[];return n.length===0?BA:e.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),KU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,YU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,ZU=hs.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",un(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[kc({find:KU,type:this.type})]},addPasteRules(){return[dl({find:YU,type:this.type})]}}),JU=Cr.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),j6=hs.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",un(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const a=i[2].trim();return{type:"underline",raw:i[0],text:a,tokens:n.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),QU=j6;function eH(t={}){return new dn({view(e){return new tH(e,t)}})}class tH{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=o=>{this[i](o)};return e.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,a=i.getBoundingClientRect(),o=a.width/i.offsetWidth,s=a.height/i.offsetHeight;if(n){let p=e.nodeBefore,x=e.nodeAfter;if(p||x){let v=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(v){let b=v.getBoundingClientRect(),C=p?b.bottom:b.top;p&&x&&(C=(C+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let E=this.width/2*s;r={left:b.left,right:b.right,top:C-E,bottom:C+E}}}}if(!r){let p=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*o;r={left:p.left-x,right:p.left+x,top:p.top,bottom:p.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let d,h;if(!c||c==document.body&&getComputedStyle(c).position=="static")d=-pageXOffset,h=-pageYOffset;else{let p=c.getBoundingClientRect(),x=p.width/c.offsetWidth,v=p.height/c.offsetHeight;d=p.left-c.scrollLeft*x,h=p.top-c.scrollTop*v}this.element.style.left=(r.left-d)/o+"px",this.element.style.top=(r.top-h)/s+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/s+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!a){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let s=kN(this.editorView.state.doc,o,this.editorView.dragging.slice);s!=null&&(o=s)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Cn extends Ze{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Cn.valid(r)?new Cn(r):Ze.near(r)}content(){return Re.empty}eq(e){return e instanceof Cn&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Cn(e.resolve(n.pos))}getBookmark(){return new u2(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!nH(e)||!rH(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Cn.valid(e))return e;let i=e.pos,a=null;for(let o=e.depth;;o--){let s=e.node(o);if(n>0?e.indexAfter(o)<s.childCount:e.index(o)>0){a=s.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let c=e.doc.resolve(i);if(Cn.valid(c))return c}for(;;){let o=n>0?a.firstChild:a.lastChild;if(!o){if(a.isAtom&&!a.isText&&!$e.isSelectable(a)){e=e.doc.resolve(i+a.nodeSize*n),r=!1;continue e}break}a=o,i+=n;let s=e.doc.resolve(i);if(Cn.valid(s))return s}return null}}}Cn.prototype.visible=!1;Cn.findFrom=Cn.findGapCursorFrom;Ze.jsonID("gapcursor",Cn);class u2{constructor(e){this.pos=e}map(e){return new u2(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Cn.valid(n)?new Cn(n):Ze.near(n)}}function P6(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function nH(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||P6(i.type))return!0;if(i.inlineContent)return!1}}return!0}function rH(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||P6(i.type))return!0;if(i.inlineContent)return!1}}return!0}function iH(){return new dn({props:{decorations:lH,createSelectionBetween(t,e,n){return e.pos==n.pos&&Cn.valid(n)?new Cn(n):null},handleClick:oH,handleKeyDown:aH,handleDOMEvents:{beforeinput:sH}}})}const aH=Hy({ArrowLeft:kh("horiz",-1),ArrowRight:kh("horiz",1),ArrowUp:kh("vert",-1),ArrowDown:kh("vert",1)});function kh(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,a){let o=r.selection,s=e>0?o.$to:o.$from,c=o.empty;if(o instanceof Ge){if(!a.endOfTextblock(n)||s.depth==0)return!1;c=!1,s=r.doc.resolve(e>0?s.after():s.before())}let d=Cn.findGapCursorFrom(s,e,c);return d?(i&&i(r.tr.setSelection(new Cn(d))),!0):!1}}function oH(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Cn.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&$e.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Cn(r))),!0)}function sH(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Cn))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=be.empty;for(let o=r.length-1;o>=0;o--)i=be.from(r[o].createAndFill(null,i));let a=t.state.tr.replace(n.pos,n.pos,new Re(i,0,0));return a.setSelection(Ge.near(a.doc.resolve(n.pos+1))),t.dispatch(a),!1}function lH(t){if(!(t.selection instanceof Cn))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Jt.create(t.doc,[nr.widget(t.selection.head,e,{key:"gapcursor"})])}var c0=200,ar=function(){};ar.prototype.append=function(e){return e.length?(e=ar.from(e),!this.length&&e||e.length<c0&&this.leafAppend(e)||this.length<c0&&e.leafPrepend(this)||this.appendInner(e)):this};ar.prototype.prepend=function(e){return e.length?ar.from(e).append(this):this};ar.prototype.appendInner=function(e){return new cH(this,e)};ar.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?ar.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};ar.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ar.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};ar.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(a,o){return i.push(e(a,o))},n,r),i};ar.from=function(e){return e instanceof ar?e:e&&e.length?new B6(e):ar.empty};var B6=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new e(this.values.slice(i,a))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,a,o,s){for(var c=a;c<o;c++)if(i(this.values[c],s+c)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,o,s){for(var c=a-1;c>=o;c--)if(i(this.values[c],s+c)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=c0)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=c0)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(ar);ar.empty=new B6([]);var cH=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,a,o){var s=this.left.length;if(i<s&&this.left.forEachInner(r,i,Math.min(a,s),o)===!1||a>s&&this.right.forEachInner(r,Math.max(i-s,0),Math.min(this.length,a)-s,o+s)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,a,o){var s=this.left.length;if(i>s&&this.right.forEachInvertedInner(r,i-s,Math.max(a,s)-s,o+s)===!1||a<s&&this.left.forEachInvertedInner(r,Math.min(i,s),a,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(r,i):r>=a?this.right.slice(r-a,i-a):this.left.slice(r,a).append(this.right.slice(0,i-a))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(ar);const uH=500;class qi{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,a;n&&(i=this.remapping(r,this.items.length),a=i.maps.length);let o=e.tr,s,c,d=[],h=[];return this.items.forEach((p,x)=>{if(!p.step){i||(i=this.remapping(r,x+1),a=i.maps.length),a--,h.push(p);return}if(i){h.push(new pa(p.map));let v=p.step.map(i.slice(a)),b;v&&o.maybeStep(v).doc&&(b=o.mapping.maps[o.mapping.maps.length-1],d.push(new pa(b,void 0,void 0,d.length+h.length))),a--,b&&i.appendMap(b,a)}else o.maybeStep(p.step);if(p.selection)return s=i?p.selection.map(i.slice(a)):p.selection,c=new qi(this.items.slice(0,r).append(h.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:o,selection:s}}addTransform(e,n,r,i){let a=[],o=this.eventCount,s=this.items,c=!i&&s.length?s.get(s.length-1):null;for(let h=0;h<e.steps.length;h++){let p=e.steps[h].invert(e.docs[h]),x=new pa(e.mapping.maps[h],p,n),v;(v=c&&c.merge(x))&&(x=v,h?a.pop():s=s.slice(0,s.length-1)),a.push(x),n&&(o++,n=void 0),i||(c=x)}let d=o-r.depth;return d>fH&&(s=dH(s,d),o-=d),new qi(s.append(a),o)}remapping(e,n){let r=new Sd;return this.items.forEach((i,a)=>{let o=i.mirrorOffset!=null&&a-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new qi(this.items.append(e.map(n=>new pa(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),a=e.mapping,o=e.steps.length,s=this.eventCount;this.items.forEach(x=>{x.selection&&s--},i);let c=n;this.items.forEach(x=>{let v=a.getMirror(--c);if(v==null)return;o=Math.min(o,v);let b=a.maps[v];if(x.step){let C=e.steps[v].invert(e.docs[v]),E=x.selection&&x.selection.map(a.slice(c+1,v));E&&s++,r.push(new pa(b,C,E))}else r.push(new pa(b))},i);let d=[];for(let x=n;x<o;x++)d.push(new pa(a.maps[x]));let h=this.items.slice(0,i).append(d).append(r),p=new qi(h,s);return p.emptyItemCount()>uH&&(p=p.compress(this.items.length-r.length)),p}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],a=0;return this.items.forEach((o,s)=>{if(s>=e)i.push(o),o.selection&&a++;else if(o.step){let c=o.step.map(n.slice(r)),d=c&&c.getMap();if(r--,d&&n.appendMap(d,r),c){let h=o.selection&&o.selection.map(n.slice(r));h&&a++;let p=new pa(d.invert(),c,h),x,v=i.length-1;(x=i.length&&i[v].merge(p))?i[v]=x:i.push(p)}}else o.map&&r--},this.items.length,0),new qi(ar.from(i.reverse()),a)}}qi.empty=new qi(ar.empty,0);function dH(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class pa{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new pa(n.getMap().invert(),n,this.selection)}}}class Uo{constructor(e,n,r,i,a){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=a}}const fH=20;function hH(t,e,n,r){let i=n.getMeta(rl),a;if(i)return i.historyState;n.getMeta(gH)&&(t=new Uo(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(rl))return o.getMeta(rl).redo?new Uo(t.done.addTransform(n,void 0,r,Yh(e)),t.undone,FA(n.mapping.maps),t.prevTime,t.prevComposition):new Uo(t.done,t.undone.addTransform(n,void 0,r,Yh(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let s=n.getMeta("composition"),c=t.prevTime==0||!o&&t.prevComposition!=s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!pH(n,t.prevRanges)),d=o?ex(t.prevRanges,n.mapping):FA(n.mapping.maps);return new Uo(t.done.addTransform(n,c?e.selection.getBookmark():void 0,r,Yh(e)),qi.empty,d,n.time,s??t.prevComposition)}else return(a=n.getMeta("rebased"))?new Uo(t.done.rebased(n,a),t.undone.rebased(n,a),ex(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Uo(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),ex(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function pH(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let a=0;a<e.length;a+=2)r<=e[a+1]&&i>=e[a]&&(n=!0)}),n}function FA(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,a,o)=>e.push(a,o));return e}function ex(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),a=e.map(t[r+1],-1);i<=a&&n.push(i,a)}return n}function mH(t,e,n){let r=Yh(e),i=rl.get(e).spec.config,a=(n?t.undone:t.done).popEvent(e,r);if(!a)return null;let o=a.selection.resolve(a.transform.doc),s=(n?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),i,r),c=new Uo(n?s:a.remaining,n?a.remaining:s,null,0,-1);return a.transform.setSelection(o).setMeta(rl,{redo:n,historyState:c})}let tx=!1,zA=null;function Yh(t){let e=t.plugins;if(zA!=e){tx=!1,zA=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){tx=!0;break}}return tx}const rl=new Sn("history"),gH=new Sn("closeHistory");function xH(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new dn({key:rl,state:{init(){return new Uo(qi.empty,qi.empty,null,0,-1)},apply(e,n,r){return hH(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?z6:r=="historyRedo"?U6:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function F6(t,e){return(n,r)=>{let i=rl.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let a=mH(i,n,t);a&&r(e?a.scrollIntoView():a)}return!0}}const z6=F6(!1,!0),U6=F6(!0,!0);zt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new dn({key:new Sn("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const a=this.storage.characters({node:r.doc});if(a>i){const o=a-i,s=0,c=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const d=r.tr.deleteRange(s,c);return t=!0,d}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:n.doc}),a=this.storage.characters({node:e.doc});if(a<=r||i>r&&a>r&&a<=i)return!0;if(i>r&&a>r&&a>i||!e.getMeta("paste"))return!1;const s=e.selection.$head.pos,c=a-r,d=s-c,h=s;return e.deleteRange(d,h),!(this.storage.characters({node:e.doc})>r)}})]}});var vH=zt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[eH(this.options)]}});zt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new dn({key:new Sn("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:i}=e,a=[];if(!n||!r)return Jt.create(t,[]);let o=0;this.options.mode==="deepest"&&t.descendants((c,d)=>{if(c.isText)return;if(!(i>=d&&i<=d+c.nodeSize-1))return!1;o+=1});let s=0;return t.descendants((c,d)=>{if(c.isText||!(i>=d&&i<=d+c.nodeSize-1))return!1;if(s+=1,this.options.mode==="deepest"&&o-s>0||this.options.mode==="shallowest"&&s>1)return this.options.mode==="deepest";a.push(nr.node(d,d+c.nodeSize,{class:this.options.className}))}),Jt.create(t,a)}}})]}});var yH=zt.create({name:"gapCursor",addProseMirrorPlugins(){return[iH()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=It(He(t,"allowGapCursor",n)))!=null?e:null}}}),UA="placeholder";function bH(t){return t.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var wH=zt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:UA,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const t=this.options.dataAttribute?`data-${bH(this.options.dataAttribute)}`:`data-${UA}`;return[new dn({key:new Sn("placeholder"),props:{decorations:({doc:e,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=n,a=[];if(!r)return null;const o=this.editor.isEmpty;return e.descendants((s,c)=>{const d=i>=c&&i<=c+s.nodeSize,h=!s.isLeaf&&W0(s);if((d||!this.options.showOnlyCurrent)&&h){const p=[this.options.emptyNodeClass];o&&p.push(this.options.emptyEditorClass);const x=nr.node(c,c+s.nodeSize,{class:p.join(" "),[t]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:c,hasAnchor:d}):this.options.placeholder});a.push(x)}return this.options.includeChildren}),Jt.create(e,a)}}})]}});zt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new dn({key:new Sn("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||Gk(n.selection)||t.view.dragging?null:Jt.create(n.doc,[nr.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function HA({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var CH=zt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Sn(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(n).includes(i.name));return[new dn({key:e,appendTransaction:(i,a,o)=>{const{doc:s,tr:c,schema:d}=o,h=e.getState(o),p=s.content.size,x=d.nodes[n];if(h)return c.insert(p,x.create())},state:{init:(i,a)=>{const o=a.tr.doc.lastChild;return!HA({node:o,types:r})},apply:(i,a)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return a;const o=i.doc.lastChild;return!HA({node:o,types:r})}}})]}}),EH=zt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>z6(t,e),redo:()=>({state:t,dispatch:e})=>U6(t,e)}},addProseMirrorPlugins(){return[xH(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),SH=zt.create({name:"starterKit",addExtensions(){var t,e,n,r;const i=[];return this.options.bold!==!1&&i.push(Yz.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(Gz.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(S6.configure(this.options.bulletList)),this.options.code!==!1&&i.push(Qz.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(nU.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(rU.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(vH.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(yH.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(iU.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(aU.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(EH.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(oU.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(dU.configure(this.options.italic)),this.options.listItem!==!1&&i.push(A6.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(I6.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(jU.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(M6.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(XU.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(ZU.configure(this.options.strike)),this.options.text!==!1&&i.push(JU.configure(this.options.text)),this.options.underline!==!1&&i.push(j6.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&i.push(CH.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),AH=SH,_H=L6,NH=R6,kH=wH,TH=20,H6=(t,e=0)=>{const n=[];return!t.children.length||e>TH||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...H6(r,e+1))}),n},OH=t=>{if(!t.children.length)return;const e=H6(t);e&&e.forEach(n=>{var r,i;const a=n.getAttribute("style"),o=(i=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:i.getAttribute("style");n.setAttribute("style",`${o};${a}`)})},V6=hs.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&OH(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",un(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(a=>!!a))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),IH=zt.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const a=r[i].split(":");if(a.length>=2){const o=a[0].trim().toLowerCase(),s=a.slice(1).join(":").trim();if(o==="background-color")return s.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),$6=zt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const a=r[i].split(":");if(a.length>=2){const o=a[0].trim().toLowerCase(),s=a.slice(1).join(":").trim();if(o==="color")return s.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),DH=zt.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),MH=zt.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),RH=zt.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});zt.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(IH.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push($6.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(DH.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(MH.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(RH.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(V6.configure(this.options.textStyle)),t}});var LH=$6;let Tv,Ov;if(typeof WeakMap<"u"){let t=new WeakMap;Tv=e=>t.get(e),Ov=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Tv=r=>{for(let i=0;i<t.length;i+=2)if(t[i]==r)return t[i+1]},Ov=(r,i)=>(n==10&&(n=0),t[n++]=r,t[n++]=i)}var En=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,i=e/this.width|0;let a=r+1,o=i+1;for(let s=1;a<this.width&&this.map[e+s]==n;s++)a++;for(let s=1;o<this.height&&this.map[e+this.width*s]==n;s++)o++;return{left:r,top:i,right:a,bottom:o}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:i,top:a,bottom:o}=this.findCell(t);return e=="horiz"?(n<0?r==0:i==this.width)?null:this.map[a*this.width+(n<0?r-1:i)]:(n<0?a==0:o==this.height)?null:this.map[r+this.width*(n<0?a-1:o)]}rectBetween(t,e){const{left:n,right:r,top:i,bottom:a}=this.findCell(t),{left:o,right:s,top:c,bottom:d}=this.findCell(e);return{left:Math.min(n,o),top:Math.min(i,c),right:Math.max(r,s),bottom:Math.max(a,d)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let i=t.left;i<t.right;i++){const a=r*this.width+i,o=this.map[a];n[o]||(n[o]=!0,!(i==t.left&&i&&this.map[a-1]==o||r==t.top&&r&&this.map[a-this.width]==o)&&e.push(o))}return e}positionAt(t,e,n){for(let r=0,i=0;;r++){const a=i+n.child(r).nodeSize;if(r==t){let o=e+t*this.width;const s=(t+1)*this.width;for(;o<s&&this.map[o]<i;)o++;return o==s?a-1:this.map[o]}i=a}}static get(t){return Tv(t)||Ov(t,jH(t))}};function jH(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=PH(t),n=t.childCount,r=[];let i=0,a=null;const o=[];for(let d=0,h=e*n;d<h;d++)r[d]=0;for(let d=0,h=0;d<n;d++){const p=t.child(d);h++;for(let b=0;;b++){for(;i<r.length&&r[i]!=0;)i++;if(b==p.childCount)break;const C=p.child(b),{colspan:E,rowspan:S,colwidth:N}=C.attrs;for(let k=0;k<S;k++){if(k+d>=n){(a||(a=[])).push({type:"overlong_rowspan",pos:h,n:S-k});break}const I=i+k*e;for(let D=0;D<E;D++){r[I+D]==0?r[I+D]=h:(a||(a=[])).push({type:"collision",row:d,pos:h,n:E-D});const L=N&&N[D];if(L){const O=(I+D)%e*2,j=o[O];j==null||j!=L&&o[O+1]==1?(o[O]=L,o[O+1]=1):j==L&&o[O+1]++}}}i+=E,h+=C.nodeSize}const x=(d+1)*e;let v=0;for(;i<x;)r[i++]==0&&v++;v&&(a||(a=[])).push({type:"missing",row:d,n:v}),h++}(e===0||n===0)&&(a||(a=[])).push({type:"zero_sized"});const s=new En(e,n,r,a);let c=!1;for(let d=0;!c&&d<o.length;d+=2)o[d]!=null&&o[d+1]<n&&(c=!0);return c&&BH(s,o,t),s}function PH(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const i=t.child(r);let a=0;if(n)for(let o=0;o<r;o++){const s=t.child(o);for(let c=0;c<s.childCount;c++){const d=s.child(c);o+d.attrs.rowspan>r&&(a+=d.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const s=i.child(o);a+=s.attrs.colspan,s.attrs.rowspan>1&&(n=!0)}e==-1?e=a:e!=a&&(e=Math.max(e,a))}return e}function BH(t,e,n){t.problems||(t.problems=[]);const r={};for(let i=0;i<t.map.length;i++){const a=t.map[i];if(r[a])continue;r[a]=!0;const o=n.nodeAt(a);if(!o)throw new RangeError(`No cell with offset ${a} found`);let s=null;const c=o.attrs;for(let d=0;d<c.colspan;d++){const h=e[(i+d)%t.width*2];h!=null&&(!c.colwidth||c.colwidth[d]!=h)&&((s||(s=FH(c)))[d]=h)}s&&t.problems.unshift({type:"colwidth mismatch",pos:a,colwidth:s})}}function FH(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Or(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],i=r.spec.tableRole;i&&(e[i]=r)}}return e}const Go=new Sn("selectingCells");function fl(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function zH(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function ra(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function Y0(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=fl(e.$head)||UH(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function UH(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function Iv(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function HH(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function d2(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function G6(t,e,n){const r=t.node(-1),i=En.get(r),a=t.start(-1),o=i.nextCell(t.pos-a,e,n);return o==null?null:t.node(0).resolve(a+o)}function hl(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function W6(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<n;i++)r.colwidth.splice(e,0,0)}return r}function VH(t,e,n){const r=Or(e.type.schema).header_cell;for(let i=0;i<t.height;i++)if(e.nodeAt(t.map[n+i*t.width]).type!=r)return!1;return!0}var tn=class Wa extends Ze{constructor(e,n=e){const r=e.node(-1),i=En.get(r),a=e.start(-1),o=i.rectBetween(e.pos-a,n.pos-a),s=e.node(0),c=i.cellsInRect(o).filter(h=>h!=n.pos-a);c.unshift(n.pos-a);const d=c.map(h=>{const p=r.nodeAt(h);if(!p)throw new RangeError(`No cell with offset ${h} found`);const x=a+h+1;return new MN(s.resolve(x),s.resolve(x+p.content.size))});super(d[0].$from,d[0].$to,d),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),i=e.resolve(n.map(this.$headCell.pos));if(Iv(r)&&Iv(i)&&d2(r,i)){const a=this.$anchorCell.node(-1)!=r.node(-1);return a&&this.isRowSelection()?Wa.rowSelection(r,i):a&&this.isColSelection()?Wa.colSelection(r,i):new Wa(r,i)}return Ge.between(r,i)}content(){const e=this.$anchorCell.node(-1),n=En.get(e),r=this.$anchorCell.start(-1),i=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),a={},o=[];for(let c=i.top;c<i.bottom;c++){const d=[];for(let h=c*n.width+i.left,p=i.left;p<i.right;p++,h++){const x=n.map[h];if(a[x])continue;a[x]=!0;const v=n.findCell(x);let b=e.nodeAt(x);if(!b)throw new RangeError(`No cell with offset ${x} found`);const C=i.left-v.left,E=v.right-i.right;if(C>0||E>0){let S=b.attrs;if(C>0&&(S=hl(S,0,C)),E>0&&(S=hl(S,S.colspan-E,E)),v.left<i.left){if(b=b.type.createAndFill(S),!b)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(S)}`)}else b=b.type.create(S,b.content)}if(v.top<i.top||v.bottom>i.bottom){const S={...b.attrs,rowspan:Math.min(v.bottom,i.bottom)-Math.max(v.top,i.top)};v.top<i.top?b=b.type.createAndFill(S):b=b.type.create(S,b.content)}d.push(b)}o.push(e.child(c).copy(be.from(d)))}const s=this.isColSelection()&&this.isRowSelection()?e:o;return new Re(be.from(s),1,1)}replace(e,n=Re.empty){const r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:s,$to:c}=i[o],d=e.mapping.slice(r);e.replace(d.map(s.pos),d.map(c.pos),o?Re.empty:n)}const a=Ze.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);a&&e.setSelection(a)}replaceWith(e,n){this.replace(e,new Re(be.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=En.get(n),i=this.$anchorCell.start(-1),a=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<a.length;o++)e(n.nodeAt(a[o]),i+a[o])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),i=En.get(r),a=e.start(-1),o=i.findCell(e.pos-a),s=i.findCell(n.pos-a),c=e.node(0);return o.top<=s.top?(o.top>0&&(e=c.resolve(a+i.map[o.left])),s.bottom<i.height&&(n=c.resolve(a+i.map[i.width*(i.height-1)+s.right-1]))):(s.top>0&&(n=c.resolve(a+i.map[s.left])),o.bottom<i.height&&(e=c.resolve(a+i.map[i.width*(i.height-1)+o.right-1]))),new Wa(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=En.get(e),r=this.$anchorCell.start(-1),i=n.colCount(this.$anchorCell.pos-r),a=n.colCount(this.$headCell.pos-r);if(Math.min(i,a)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,s=a+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,s)==n.width}eq(e){return e instanceof Wa&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),i=En.get(r),a=e.start(-1),o=i.findCell(e.pos-a),s=i.findCell(n.pos-a),c=e.node(0);return o.left<=s.left?(o.left>0&&(e=c.resolve(a+i.map[o.top*i.width])),s.right<i.width&&(n=c.resolve(a+i.map[i.width*(s.top+1)-1]))):(s.left>0&&(n=c.resolve(a+i.map[s.top*i.width])),o.right<i.width&&(e=c.resolve(a+i.map[i.width*(o.top+1)-1]))),new Wa(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Wa(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Wa(e.resolve(n),e.resolve(r))}getBookmark(){return new $H(this.$anchorCell.pos,this.$headCell.pos)}};tn.prototype.visible=!1;Ze.jsonID("cell",tn);var $H=class q6{constructor(e,n){this.anchor=e,this.head=n}map(e){return new q6(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&d2(n,r)?new tn(n,r):Ze.near(r,1)}};function GH(t){if(!(t.selection instanceof tn))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(nr.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Jt.create(t.doc,e)}function WH({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(let a=e.depth;a>=0&&!(e.before(a+1)>e.start(a));a--,r--);return n==r&&/row|table/.test(t.node(i).type.spec.tableRole)}function qH({$from:t,$to:e}){let n,r;for(let i=t.depth;i>0;i--){const a=t.node(i);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){n=a;break}}for(let i=e.depth;i>0;i--){const a=e.node(i);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){r=a;break}}return n!==r&&e.parentOffset===0}function XH(t,e,n){const r=(e||t).selection,i=(e||t).doc;let a,o;if(r instanceof $e&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")a=tn.create(i,r.from);else if(o=="row"){const s=i.resolve(r.from+1);a=tn.rowSelection(s,s)}else if(!n){const s=En.get(r.node),c=r.from+1,d=c+s.map[s.width*s.height-1];a=tn.create(i,c+1,d)}}else r instanceof Ge&&WH(r)?a=Ge.create(i,r.from):r instanceof Ge&&qH(r)&&(a=Ge.create(i,r.$from.start(),r.$from.end()));return a&&(e||(e=t.tr)).setSelection(a),e}const KH=new Sn("fix-tables");function X6(t,e,n,r){const i=t.childCount,a=e.childCount;e:for(let o=0,s=0;o<a;o++){const c=e.child(o);for(let d=s,h=Math.min(i,o+3);d<h;d++)if(t.child(d)==c){s=d+1,n+=c.nodeSize;continue e}r(c,n),s<i&&t.child(s).sameMarkup(c)?X6(t.child(s),c,n+1,r):c.nodesBetween(0,c.content.size,r,n+1),n+=c.nodeSize}}function K6(t,e){let n;const r=(i,a)=>{i.type.spec.tableRole=="table"&&(n=YH(t,i,a,n))};return e?e.doc!=t.doc&&X6(e.doc,t.doc,0,r):t.doc.descendants(r),n}function YH(t,e,n,r){const i=En.get(e);if(!i.problems)return r;r||(r=t.tr);const a=[];for(let c=0;c<i.height;c++)a.push(0);for(let c=0;c<i.problems.length;c++){const d=i.problems[c];if(d.type=="collision"){const h=e.nodeAt(d.pos);if(!h)continue;const p=h.attrs;for(let x=0;x<p.rowspan;x++)a[d.row+x]+=d.n;r.setNodeMarkup(r.mapping.map(n+1+d.pos),null,hl(p,p.colspan-d.n,d.n))}else if(d.type=="missing")a[d.row]+=d.n;else if(d.type=="overlong_rowspan"){const h=e.nodeAt(d.pos);if(!h)continue;r.setNodeMarkup(r.mapping.map(n+1+d.pos),null,{...h.attrs,rowspan:h.attrs.rowspan-d.n})}else if(d.type=="colwidth mismatch"){const h=e.nodeAt(d.pos);if(!h)continue;r.setNodeMarkup(r.mapping.map(n+1+d.pos),null,{...h.attrs,colwidth:d.colwidth})}else if(d.type=="zero_sized"){const h=r.mapping.map(n);r.delete(h,h+e.nodeSize)}}let o,s;for(let c=0;c<a.length;c++)a[c]&&(o==null&&(o=c),s=c);for(let c=0,d=n+1;c<i.height;c++){const h=e.child(c),p=d+h.nodeSize,x=a[c];if(x>0){let v="cell";h.firstChild&&(v=h.firstChild.type.spec.tableRole);const b=[];for(let E=0;E<x;E++){const S=Or(t.schema)[v].createAndFill();S&&b.push(S)}const C=(c==0||o==c-1)&&s==c?d+1:p-1;r.insert(r.mapping.map(C),b)}d=p}return r.setMeta(KH,{fixTables:!0})}function Ea(t){const e=t.selection,n=Y0(t),r=n.node(-1),i=n.start(-1),a=En.get(r);return{...e instanceof tn?a.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):a.findCell(n.pos-i),tableStart:i,map:a,table:r}}function Y6(t,{map:e,tableStart:n,table:r},i){let a=i>0?-1:0;VH(e,r,i+a)&&(a=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){const s=o*e.width+i;if(i>0&&i<e.width&&e.map[s-1]==e.map[s]){const c=e.map[s],d=r.nodeAt(c);t.setNodeMarkup(t.mapping.map(n+c),null,W6(d.attrs,i-e.colCount(c))),o+=d.attrs.rowspan-1}else{const c=a==null?Or(r.type.schema).cell:r.nodeAt(e.map[s+a]).type,d=e.positionAt(o,i,r);t.insert(t.mapping.map(n+d),c.createAndFill())}}return t}function ZH(t,e){if(!ra(t))return!1;if(e){const n=Ea(t);e(Y6(t.tr,n,n.left))}return!0}function JH(t,e){if(!ra(t))return!1;if(e){const n=Ea(t);e(Y6(t.tr,n,n.right))}return!0}function QH(t,{map:e,table:n,tableStart:r},i){const a=t.mapping.maps.length;for(let o=0;o<e.height;){const s=o*e.width+i,c=e.map[s],d=n.nodeAt(c),h=d.attrs;if(i>0&&e.map[s-1]==c||i<e.width-1&&e.map[s+1]==c)t.setNodeMarkup(t.mapping.slice(a).map(r+c),null,hl(h,i-e.colCount(c)));else{const p=t.mapping.slice(a).map(r+c);t.delete(p,p+d.nodeSize)}o+=h.rowspan}}function eV(t,e){if(!ra(t))return!1;if(e){const n=Ea(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let i=n.right-1;QH(r,n,i),i!=n.left;i--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=En.get(a)}e(r)}return!0}function tV(t,e,n){var r;const i=Or(e.type.schema).header_cell;for(let a=0;a<t.width;a++)if(((r=e.nodeAt(t.map[a+n*t.width]))===null||r===void 0?void 0:r.type)!=i)return!1;return!0}function Z6(t,{map:e,tableStart:n,table:r},i){let a=n;for(let d=0;d<i;d++)a+=r.child(d).nodeSize;const o=[];let s=i>0?-1:0;tV(e,r,i+s)&&(s=i==0||i==e.height?null:0);for(let d=0,h=e.width*i;d<e.width;d++,h++)if(i>0&&i<e.height&&e.map[h]==e.map[h-e.width]){const p=e.map[h],x=r.nodeAt(p).attrs;t.setNodeMarkup(n+p,null,{...x,rowspan:x.rowspan+1}),d+=x.colspan-1}else{var c;const p=s==null?Or(r.type.schema).cell:(c=r.nodeAt(e.map[h+s*e.width]))===null||c===void 0?void 0:c.type,x=p==null?void 0:p.createAndFill();x&&o.push(x)}return t.insert(a,Or(r.type.schema).row.create(null,o)),t}function nV(t,e){if(!ra(t))return!1;if(e){const n=Ea(t);e(Z6(t.tr,n,n.top))}return!0}function rV(t,e){if(!ra(t))return!1;if(e){const n=Ea(t);e(Z6(t.tr,n,n.bottom))}return!0}function iV(t,{map:e,table:n,tableStart:r},i){let a=0;for(let d=0;d<i;d++)a+=n.child(d).nodeSize;const o=a+n.child(i).nodeSize,s=t.mapping.maps.length;t.delete(a+r,o+r);const c=new Set;for(let d=0,h=i*e.width;d<e.width;d++,h++){const p=e.map[h];if(!c.has(p)){if(c.add(p),i>0&&p==e.map[h-e.width]){const x=n.nodeAt(p).attrs;t.setNodeMarkup(t.mapping.slice(s).map(p+r),null,{...x,rowspan:x.rowspan-1}),d+=x.colspan-1}else if(i<e.height&&p==e.map[h+e.width]){const x=n.nodeAt(p),v=x.attrs,b=x.type.create({...v,rowspan:x.attrs.rowspan-1},x.content),C=e.positionAt(i+1,d,n);t.insert(t.mapping.slice(s).map(r+C),b),d+=v.colspan-1}}}}function aV(t,e){if(!ra(t))return!1;if(e){const n=Ea(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let i=n.bottom-1;iV(r,n,i),i!=n.top;i--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=En.get(n.table)}e(r)}return!0}function VA(t){const e=t.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function oV({width:t,height:e,map:n},r){let i=r.top*t+r.left,a=i,o=(r.bottom-1)*t+r.left,s=i+(r.right-r.left-1);for(let c=r.top;c<r.bottom;c++){if(r.left>0&&n[a]==n[a-1]||r.right<t&&n[s]==n[s+1])return!0;a+=t,s+=t}for(let c=r.left;c<r.right;c++){if(r.top>0&&n[i]==n[i-t]||r.bottom<e&&n[o]==n[o+t])return!0;i++,o++}return!1}function $A(t,e){const n=t.selection;if(!(n instanceof tn)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=Ea(t),{map:i}=r;if(oV(i,r))return!1;if(e){const a=t.tr,o={};let s=be.empty,c,d;for(let h=r.top;h<r.bottom;h++)for(let p=r.left;p<r.right;p++){const x=i.map[h*i.width+p],v=r.table.nodeAt(x);if(!(o[x]||!v))if(o[x]=!0,c==null)c=x,d=v;else{VA(v)||(s=s.append(v.content));const b=a.mapping.map(x+r.tableStart);a.delete(b,b+v.nodeSize)}}if(c==null||d==null)return!0;if(a.setNodeMarkup(c+r.tableStart,null,{...W6(d.attrs,d.attrs.colspan,r.right-r.left-d.attrs.colspan),rowspan:r.bottom-r.top}),s.size>0){const h=c+1+d.content.size,p=VA(d)?c+1:h;a.replaceWith(p+r.tableStart,h+r.tableStart,s)}a.setSelection(new tn(a.doc.resolve(c+r.tableStart))),e(a)}return!0}function GA(t,e){const n=Or(t.schema);return sV(({node:r})=>n[r.type.spec.tableRole])(t,e)}function sV(t){return(e,n)=>{const r=e.selection;let i,a;if(r instanceof tn){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;i=r.$anchorCell.nodeAfter,a=r.$anchorCell.pos}else{var o;if(i=zH(r.$from),!i)return!1;a=(o=fl(r.$from))===null||o===void 0?void 0:o.pos}if(i==null||a==null||i.attrs.colspan==1&&i.attrs.rowspan==1)return!1;if(n){let s=i.attrs;const c=[],d=s.colwidth;s.rowspan>1&&(s={...s,rowspan:1}),s.colspan>1&&(s={...s,colspan:1});const h=Ea(e),p=e.tr;for(let v=0;v<h.right-h.left;v++)c.push(d?{...s,colwidth:d&&d[v]?[d[v]]:null}:s);let x;for(let v=h.top;v<h.bottom;v++){let b=h.map.positionAt(v,h.left,h.table);v==h.top&&(b+=i.nodeSize);for(let C=h.left,E=0;C<h.right;C++,E++)C==h.left&&v==h.top||p.insert(x=p.mapping.map(b+h.tableStart,1),t({node:i,row:v,col:C}).createAndFill(c[E]))}p.setNodeMarkup(a,t({node:i,row:h.top,col:h.left}),c[0]),r instanceof tn&&p.setSelection(new tn(p.doc.resolve(r.$anchorCell.pos),x?p.doc.resolve(x):void 0)),n(p)}return!0}}function lV(t,e){return function(n,r){if(!ra(n))return!1;const i=Y0(n);if(i.nodeAfter.attrs[t]===e)return!1;if(r){const a=n.tr;n.selection instanceof tn?n.selection.forEachCell((o,s)=>{o.attrs[t]!==e&&a.setNodeMarkup(s,null,{...o.attrs,[t]:e})}):a.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[t]:e}),r(a)}return!0}}function cV(t){return function(e,n){if(!ra(e))return!1;if(n){const r=Or(e.schema),i=Ea(e),a=e.tr,o=i.map.cellsInRect(t=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:t=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),s=o.map(c=>i.table.nodeAt(c));for(let c=0;c<o.length;c++)s[c].type==r.header_cell&&a.setNodeMarkup(i.tableStart+o[c],r.cell,s[c].attrs);if(a.steps.length===0)for(let c=0;c<o.length;c++)a.setNodeMarkup(i.tableStart+o[c],r.header_cell,s[c].attrs);n(a)}return!0}}function WA(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const a=e.table.nodeAt(r[i]);if(a&&a.type!==n.header_cell)return!1}return!0}function Md(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?cV(t):function(n,r){if(!ra(n))return!1;if(r){const i=Or(n.schema),a=Ea(n),o=n.tr,s=WA("row",a,i),c=WA("column",a,i),d=(t==="column"?s:t==="row"&&c)?1:0,h=t=="column"?{left:0,top:d,right:1,bottom:a.map.height}:t=="row"?{left:d,top:0,right:a.map.width,bottom:1}:a,p=t=="column"?c?i.cell:i.header_cell:t=="row"?s?i.cell:i.header_cell:i.cell;a.map.cellsInRect(h).forEach(x=>{const v=x+a.tableStart,b=o.doc.nodeAt(v);b&&o.setNodeMarkup(v,p,b.attrs)}),r(o)}return!0}}Md("row",{useDeprecatedLogic:!0});Md("column",{useDeprecatedLogic:!0});const uV=Md("cell",{useDeprecatedLogic:!0});function dV(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,i=t.before();r>=0;r--){const a=t.node(-1).child(r),o=a.lastChild;if(o)return i-1-o.nodeSize;i-=a.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),i=t.after();r<n.childCount;r++){const a=n.child(r);if(a.childCount)return i+1;i+=a.nodeSize}}return null}function qA(t){return function(e,n){if(!ra(e))return!1;const r=dV(Y0(e),t);if(r==null)return!1;if(n){const i=e.doc.resolve(r);n(e.tr.setSelection(Ge.between(i,HH(i))).scrollIntoView())}return!0}}function fV(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function Th(t,e){const n=t.selection;if(!(n instanceof tn))return!1;if(e){const r=t.tr,i=Or(t.schema).cell.createAndFill().content;n.forEachCell((a,o)=>{a.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+a.nodeSize-1),new Re(i,0,0))}),r.docChanged&&e(r)}return!0}function hV(t){if(t.size===0)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const i=e.child(0),a=i.type.spec.tableRole,o=i.type.schema,s=[];if(a=="row")for(let c=0;c<e.childCount;c++){let d=e.child(c).content;const h=c?0:Math.max(0,n-1),p=c<e.childCount-1?0:Math.max(0,r-1);(h||p)&&(d=Dv(Or(o).row,new Re(d,h,p)).content),s.push(d)}else if(a=="cell"||a=="header_cell")s.push(n||r?Dv(Or(o).row,new Re(e,n,r)).content:e);else return null;return pV(o,s)}function pV(t,e){const n=[];for(let i=0;i<e.length;i++){const a=e[i];for(let o=a.childCount-1;o>=0;o--){const{rowspan:s,colspan:c}=a.child(o).attrs;for(let d=i;d<i+s;d++)n[d]=(n[d]||0)+c}}let r=0;for(let i=0;i<n.length;i++)r=Math.max(r,n[i]);for(let i=0;i<n.length;i++)if(i>=e.length&&e.push(be.empty),n[i]<r){const a=Or(t).cell.createAndFill(),o=[];for(let s=n[i];s<r;s++)o.push(a);e[i]=e[i].append(be.from(o))}return{height:e.length,width:r,rows:e}}function Dv(t,e){const n=t.createAndFill();return new _y(n).replace(0,n.content.size,e).doc}function mV({width:t,height:e,rows:n},r,i){if(t!=r){const a=[],o=[];for(let s=0;s<n.length;s++){const c=n[s],d=[];for(let h=a[s]||0,p=0;h<r;p++){let x=c.child(p%c.childCount);h+x.attrs.colspan>r&&(x=x.type.createChecked(hl(x.attrs,x.attrs.colspan,h+x.attrs.colspan-r),x.content)),d.push(x),h+=x.attrs.colspan;for(let v=1;v<x.attrs.rowspan;v++)a[s+v]=(a[s+v]||0)+x.attrs.colspan}o.push(be.from(d))}n=o,t=r}if(e!=i){const a=[];for(let o=0,s=0;o<i;o++,s++){const c=[],d=n[s%e];for(let h=0;h<d.childCount;h++){let p=d.child(h);o+p.attrs.rowspan>i&&(p=p.type.create({...p.attrs,rowspan:Math.max(1,i-p.attrs.rowspan)},p.content)),c.push(p)}a.push(be.from(c))}n=a,e=i}return{width:t,height:e,rows:n}}function gV(t,e,n,r,i,a,o){const s=t.doc.type.schema,c=Or(s);let d,h;if(i>e.width)for(let p=0,x=0;p<e.height;p++){const v=n.child(p);x+=v.nodeSize;const b=[];let C;v.lastChild==null||v.lastChild.type==c.cell?C=d||(d=c.cell.createAndFill()):C=h||(h=c.header_cell.createAndFill());for(let E=e.width;E<i;E++)b.push(C);t.insert(t.mapping.slice(o).map(x-1+r),b)}if(a>e.height){const p=[];for(let b=0,C=(e.height-1)*e.width;b<Math.max(e.width,i);b++){const E=b>=e.width?!1:n.nodeAt(e.map[C+b]).type==c.header_cell;p.push(E?h||(h=c.header_cell.createAndFill()):d||(d=c.cell.createAndFill()))}const x=c.row.create(null,be.from(p)),v=[];for(let b=e.height;b<a;b++)v.push(x);t.insert(t.mapping.slice(o).map(r+n.nodeSize-2),v)}return!!(d||h)}function XA(t,e,n,r,i,a,o,s){if(o==0||o==e.height)return!1;let c=!1;for(let d=i;d<a;d++){const h=o*e.width+d,p=e.map[h];if(e.map[h-e.width]==p){c=!0;const x=n.nodeAt(p),{top:v,left:b}=e.findCell(p);t.setNodeMarkup(t.mapping.slice(s).map(p+r),null,{...x.attrs,rowspan:o-v}),t.insert(t.mapping.slice(s).map(e.positionAt(o,b,n)),x.type.createAndFill({...x.attrs,rowspan:v+x.attrs.rowspan-o})),d+=x.attrs.colspan-1}}return c}function KA(t,e,n,r,i,a,o,s){if(o==0||o==e.width)return!1;let c=!1;for(let d=i;d<a;d++){const h=d*e.width+o,p=e.map[h];if(e.map[h-1]==p){c=!0;const x=n.nodeAt(p),v=e.colCount(p),b=t.mapping.slice(s).map(p+r);t.setNodeMarkup(b,null,hl(x.attrs,o-v,x.attrs.colspan-(o-v))),t.insert(b+x.nodeSize,x.type.createAndFill(hl(x.attrs,0,o-v))),d+=x.attrs.rowspan-1}}return c}function YA(t,e,n,r,i){let a=n?t.doc.nodeAt(n-1):t.doc;if(!a)throw new Error("No table found");let o=En.get(a);const{top:s,left:c}=r,d=c+i.width,h=s+i.height,p=t.tr;let x=0;function v(){if(a=n?p.doc.nodeAt(n-1):p.doc,!a)throw new Error("No table found");o=En.get(a),x=p.mapping.maps.length}gV(p,o,a,n,d,h,x)&&v(),XA(p,o,a,n,c,d,s,x)&&v(),XA(p,o,a,n,c,d,h,x)&&v(),KA(p,o,a,n,s,h,c,x)&&v(),KA(p,o,a,n,s,h,d,x)&&v();for(let b=s;b<h;b++){const C=o.positionAt(b,c,a),E=o.positionAt(b,d,a);p.replace(p.mapping.slice(x).map(C+n),p.mapping.slice(x).map(E+n),new Re(i.rows[b-s],0,0))}v(),p.setSelection(new tn(p.doc.resolve(n+o.positionAt(s,c,a)),p.doc.resolve(n+o.positionAt(h-1,d-1,a)))),e(p)}const xV=Hy({ArrowLeft:Oh("horiz",-1),ArrowRight:Oh("horiz",1),ArrowUp:Oh("vert",-1),ArrowDown:Oh("vert",1),"Shift-ArrowLeft":Ih("horiz",-1),"Shift-ArrowRight":Ih("horiz",1),"Shift-ArrowUp":Ih("vert",-1),"Shift-ArrowDown":Ih("vert",1),Backspace:Th,"Mod-Backspace":Th,Delete:Th,"Mod-Delete":Th});function Zh(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function Oh(t,e){return(n,r,i)=>{if(!i)return!1;const a=n.selection;if(a instanceof tn)return Zh(n,r,Ze.near(a.$headCell,e));if(t!="horiz"&&!a.empty)return!1;const o=J6(i,t,e);if(o==null)return!1;if(t=="horiz")return Zh(n,r,Ze.near(n.doc.resolve(a.head+e),e));{const s=n.doc.resolve(o),c=G6(s,t,e);let d;return c?d=Ze.near(c,1):e<0?d=Ze.near(n.doc.resolve(s.before(-1)),-1):d=Ze.near(n.doc.resolve(s.after(-1)),1),Zh(n,r,d)}}}function Ih(t,e){return(n,r,i)=>{if(!i)return!1;const a=n.selection;let o;if(a instanceof tn)o=a;else{const c=J6(i,t,e);if(c==null)return!1;o=new tn(n.doc.resolve(c))}const s=G6(o.$headCell,t,e);return s?Zh(n,r,new tn(o.$anchorCell,s)):!1}}function vV(t,e){const n=t.state.doc,r=fl(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new tn(r))),!0):!1}function yV(t,e,n){if(!ra(t.state))return!1;let r=hV(n);const i=t.state.selection;if(i instanceof tn){r||(r={width:1,height:1,rows:[be.from(Dv(Or(t.state.schema).cell,n))]});const a=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),s=En.get(a).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=mV(r,s.right-s.left,s.bottom-s.top),YA(t.state,t.dispatch,o,s,r),!0}else if(r){const a=Y0(t.state),o=a.start(-1);return YA(t.state,t.dispatch,o,En.get(a.node(-1)).findCell(a.pos-o),r),!0}else return!1}function bV(t,e){var n;if(e.button!=0||e.ctrlKey||e.metaKey)return;const r=ZA(t,e.target);let i;if(e.shiftKey&&t.state.selection instanceof tn)a(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=fl(t.state.selection.$anchor))!=null&&((n=nx(t,e))===null||n===void 0?void 0:n.pos)!=i.pos)a(i,e),e.preventDefault();else if(!r)return;function a(c,d){let h=nx(t,d);const p=Go.getState(t.state)==null;if(!h||!d2(c,h))if(p)h=c;else return;const x=new tn(c,h);if(p||!t.state.selection.eq(x)){const v=t.state.tr.setSelection(x);p&&v.setMeta(Go,c.pos),t.dispatch(v)}}function o(){t.root.removeEventListener("mouseup",o),t.root.removeEventListener("dragstart",o),t.root.removeEventListener("mousemove",s),Go.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Go,-1))}function s(c){const d=c,h=Go.getState(t.state);let p;if(h!=null)p=t.state.doc.resolve(h);else if(ZA(t,d.target)!=r&&(p=nx(t,e),!p))return o();p&&a(p,d)}t.root.addEventListener("mouseup",o),t.root.addEventListener("dragstart",o),t.root.addEventListener("mousemove",s)}function J6(t,e,n){if(!(t.state.selection instanceof Ge))return null;const{$head:r}=t.state.selection;for(let i=r.depth-1;i>=0;i--){const a=r.node(i);if((n<0?r.index(i):r.indexAfter(i))!=(n<0?0:a.childCount))return null;if(a.type.spec.tableRole=="cell"||a.type.spec.tableRole=="header_cell"){const o=r.before(i),s=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(s)?o:null}}return null}function ZA(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function nx(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});if(!n)return null;let{inside:r,pos:i}=n;return r>=0&&fl(t.state.doc.resolve(r))||fl(t.state.doc.resolve(i))}var wV=class{constructor(e,n){this.node=e,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Mv(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Mv(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Mv(t,e,n,r,i,a){let o=0,s=!0,c=e.firstChild;const d=t.firstChild;if(d){for(let p=0,x=0;p<d.childCount;p++){const{colspan:v,colwidth:b}=d.child(p).attrs;for(let C=0;C<v;C++,x++){const E=i==x?a:b&&b[C],S=E?E+"px":"";if(o+=E||r,E||(s=!1),c)c.style.width!=S&&(c.style.width=S),c=c.nextSibling;else{const N=document.createElement("col");N.style.width=S,e.appendChild(N)}}}for(;c;){var h;const p=c.nextSibling;(h=c.parentNode)===null||h===void 0||h.removeChild(c),c=p}s?(n.style.width=o+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=o+"px")}}const mi=new Sn("tableColumnResizing");function CV({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=wV,lastColumnResizable:i=!0}={}){const a=new dn({key:mi,state:{init(o,s){var c;const d=(c=a.spec)===null||c===void 0||(c=c.props)===null||c===void 0?void 0:c.nodeViews,h=Or(s.schema).table.name;return r&&d&&(d[h]=(p,x)=>new r(p,n,x)),new EV(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes:o=>{const s=mi.getState(o);return s&&s.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,s)=>{SV(o,s,t,i)},mouseleave:o=>{AV(o)},mousedown:(o,s)=>{_V(o,s,e,n)}},decorations:o=>{const s=mi.getState(o);if(s&&s.activeHandle>-1)return IV(o,s.activeHandle)},nodeViews:{}}});return a}var EV=class Jh{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(mi);if(r&&r.setHandle!=null)return new Jh(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Jh(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let i=e.mapping.map(n.activeHandle,-1);return Iv(e.doc.resolve(i))||(i=-1),new Jh(i,n.dragging)}return n}};function SV(t,e,n,r){if(!t.editable)return;const i=mi.getState(t.state);if(i&&!i.dragging){const a=kV(e.target);let o=-1;if(a){const{left:s,right:c}=a.getBoundingClientRect();e.clientX-s<=n?o=JA(t,e,"left",n):c-e.clientX<=n&&(o=JA(t,e,"right",n))}if(o!=i.activeHandle){if(!r&&o!==-1){const s=t.state.doc.resolve(o),c=s.node(-1),d=En.get(c),h=s.start(-1);if(d.colCount(s.pos-h)+s.nodeAfter.attrs.colspan-1==d.width-1)return}Q6(t,o)}}}function AV(t){if(!t.editable)return;const e=mi.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&Q6(t,-1)}function _V(t,e,n,r){var i;if(!t.editable)return!1;const a=(i=t.dom.ownerDocument.defaultView)!==null&&i!==void 0?i:window,o=mi.getState(t.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const s=t.state.doc.nodeAt(o.activeHandle),c=NV(t,o.activeHandle,s.attrs);t.dispatch(t.state.tr.setMeta(mi,{setDragging:{startX:e.clientX,startWidth:c}}));function d(p){a.removeEventListener("mouseup",d),a.removeEventListener("mousemove",h);const x=mi.getState(t.state);x!=null&&x.dragging&&(TV(t,x.activeHandle,QA(x.dragging,p,n)),t.dispatch(t.state.tr.setMeta(mi,{setDragging:null})))}function h(p){if(!p.which)return d(p);const x=mi.getState(t.state);if(x&&x.dragging){const v=QA(x.dragging,p,n);e3(t,x.activeHandle,v,r)}}return e3(t,o.activeHandle,c,r),a.addEventListener("mouseup",d),a.addEventListener("mousemove",h),e.preventDefault(),!0}function NV(t,e,{colspan:n,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const a=t.domAtPos(e);let o=a.node.childNodes[a.offset].offsetWidth,s=n;if(r)for(let c=0;c<n;c++)r[c]&&(o-=r[c],s--);return o/s}function kV(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function JA(t,e,n,r){const i=n=="right"?-r:r,a=t.posAtCoords({left:e.clientX+i,top:e.clientY});if(!a)return-1;const{pos:o}=a,s=fl(t.state.doc.resolve(o));if(!s)return-1;if(n=="right")return s.pos;const c=En.get(s.node(-1)),d=s.start(-1),h=c.map.indexOf(s.pos-d);return h%c.width==0?-1:d+c.map[h-1]}function QA(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function Q6(t,e){t.dispatch(t.state.tr.setMeta(mi,{setHandle:e}))}function TV(t,e,n){const r=t.state.doc.resolve(e),i=r.node(-1),a=En.get(i),o=r.start(-1),s=a.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,c=t.state.tr;for(let d=0;d<a.height;d++){const h=d*a.width+s;if(d&&a.map[h]==a.map[h-a.width])continue;const p=a.map[h],x=i.nodeAt(p).attrs,v=x.colspan==1?0:s-a.colCount(p);if(x.colwidth&&x.colwidth[v]==n)continue;const b=x.colwidth?x.colwidth.slice():OV(x.colspan);b[v]=n,c.setNodeMarkup(o+p,null,{...x,colwidth:b})}c.docChanged&&t.dispatch(c)}function e3(t,e,n,r){const i=t.state.doc.resolve(e),a=i.node(-1),o=i.start(-1),s=En.get(a).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let c=t.domAtPos(i.start(-1)).node;for(;c&&c.nodeName!="TABLE";)c=c.parentNode;c&&Mv(a,c.firstChild,c,r,s,n)}function OV(t){return Array(t).fill(0)}function IV(t,e){const n=[],r=t.doc.resolve(e),i=r.node(-1);if(!i)return Jt.empty;const a=En.get(i),o=r.start(-1),s=a.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1;for(let d=0;d<a.height;d++){const h=s+d*a.width;if((s==a.width-1||a.map[h]!=a.map[h+1])&&(d==0||a.map[h]!=a.map[h-a.width])){var c;const p=a.map[h],x=o+p+i.nodeAt(p).nodeSize-1,v=document.createElement("div");v.className="column-resize-handle",!((c=mi.getState(t))===null||c===void 0)&&c.dragging&&n.push(nr.node(o+p,o+p+i.nodeAt(p).nodeSize,{class:"column-resize-dragging"})),n.push(nr.widget(x,v))}}return Jt.create(t.doc,n)}function DV({allowTableNodeSelection:t=!1}={}){return new dn({key:Go,state:{init(){return null},apply(e,n){const r=e.getMeta(Go);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:i,pos:a}=e.mapping.mapResult(n);return i?null:a}},props:{decorations:GH,handleDOMEvents:{mousedown:bV},createSelectionBetween(e){return Go.getState(e.state)!=null?e.state.selection:null},handleTripleClick:vV,handleKeyDown:xV,handlePaste:yV},appendTransaction(e,n,r){return XH(r,K6(r,n),t)}})}var e5=Cr.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var e,n;const r=t.getAttribute("colwidth"),i=r?r.split(",").map(a=>parseInt(a,10)):null;if(!i){const a=(e=t.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),o=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(o&&o>-1&&a&&a[o]){const s=a[o].getAttribute("width");return s?[parseInt(s,10)]:null}}return i}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",un(this.options.HTMLAttributes,t),0]}}),t5=Cr.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",un(this.options.HTMLAttributes,t),0]}}),n5=Cr.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",un(this.options.HTMLAttributes,t),0]}});function Rv(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function t3(t,e,n,r,i,a){var o;let s=0,c=!0,d=e.firstChild;const h=t.firstChild;if(h!==null)for(let x=0,v=0;x<h.childCount;x+=1){const{colspan:b,colwidth:C}=h.child(x).attrs;for(let E=0;E<b;E+=1,v+=1){const S=i===v?a:C&&C[E],N=S?`${S}px`:"";if(s+=S||r,S||(c=!1),d){if(d.style.width!==N){const[k,I]=Rv(r,S);d.style.setProperty(k,I)}d=d.nextSibling}else{const k=document.createElement("col"),[I,D]=Rv(r,S);k.style.setProperty(I,D),e.appendChild(k)}}}for(;d;){const x=d.nextSibling;(o=d.parentNode)==null||o.removeChild(d),d=x}const p=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);c&&!p?(n.style.width=`${s}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${s}px`)}var MV=class{constructor(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),t3(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,t3(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(n&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function RV(t,e,n,r){let i=0,a=!0;const o=[],s=t.firstChild;if(!s)return{};for(let p=0,x=0;p<s.childCount;p+=1){const{colspan:v,colwidth:b}=s.child(p).attrs;for(let C=0;C<v;C+=1,x+=1){const E=n===x?r:b&&b[C];i+=E||e,E||(a=!1);const[S,N]=Rv(e,E);o.push(["col",{style:`${S}: ${N}`}])}}const c=a?`${i}px`:"",d=a?"":`${i}px`;return{colgroup:["colgroup",{},...o],tableWidth:c,tableMinWidth:d}}function n3(t,e){return t.createAndFill()}function LV(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function jV(t,e,n,r,i){const a=LV(t),o=[],s=[];for(let d=0;d<n;d+=1){const h=n3(a.cell);if(h&&s.push(h),r){const p=n3(a.header_cell);p&&o.push(p)}}const c=[];for(let d=0;d<e;d+=1)c.push(a.row.createChecked(null,r&&d===0?o:s));return a.table.createChecked(null,c)}function PV(t){return t instanceof tn}var Dh=({editor:t})=>{const{selection:e}=t.state;if(!PV(e))return!1;let n=0;const r=Pk(e.ranges[0].$from,a=>a.type.name==="table");return r==null||r.node.descendants(a=>{if(a.type.name==="table")return!1;["tableCell","tableHeader"].includes(a.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},BV="";function FV(t){return(t||"").replace(/\s+/g," ").trim()}function zV(t,e,n={}){var r;const i=(r=n.cellLineSeparator)!=null?r:BV;if(!t||!t.content||t.content.length===0)return"";const a=[];t.content.forEach(b=>{const C=[];b.content&&b.content.forEach(E=>{let S="";E.content&&Array.isArray(E.content)&&E.content.length>1?S=E.content.map(D=>e.renderChildren(D)).join(i):S=E.content?e.renderChildren(E.content):"";const N=FV(S),k=E.type==="tableHeader";C.push({text:N,isHeader:k})}),a.push(C)});const o=a.reduce((b,C)=>Math.max(b,C.length),0);if(o===0)return"";const s=new Array(o).fill(0);a.forEach(b=>{var C;for(let E=0;E<o;E+=1){const N=(((C=b[E])==null?void 0:C.text)||"").length;N>s[E]&&(s[E]=N),s[E]<3&&(s[E]=3)}});const c=(b,C)=>b+" ".repeat(Math.max(0,C-b.length)),d=a[0],h=d.some(b=>b.isHeader);let p=`
`;const x=new Array(o).fill(0).map((b,C)=>h&&d[C]&&d[C].text||"");return p+=`| ${x.map((b,C)=>c(b,s[C])).join(" | ")} |
`,p+=`| ${s.map(b=>"-".repeat(Math.max(3,b))).join(" | ")} |
`,(h?a.slice(1):a).forEach(b=>{p+=`| ${new Array(o).fill(0).map((C,E)=>c(b[E]&&b[E].text||"",s[E])).join(" | ")} |
`}),p}var UV=zV,r5=Cr.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:MV,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:i}=RV(t,this.options.cellMinWidth),a=e.style;function o(){return a||(r?`width: ${r}`:`min-width: ${i}`)}const s=["table",un(this.options.HTMLAttributes,e,{style:o()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},s]:s},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(i=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(i.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const i=[];r.forEach(a=>{i.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(a.tokens)}]))}),n.push(e.createNode("tableRow",{},i))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>UV(t,e),addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:i,editor:a})=>{const o=jV(a.schema,t,e,n);if(i){const s=r.selection.from+1;r.replaceSelectionWith(o).scrollIntoView().setSelection(Ge.near(r.doc.resolve(s)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>ZH(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>JH(t,e),deleteColumn:()=>({state:t,dispatch:e})=>eV(t,e),addRowBefore:()=>({state:t,dispatch:e})=>nV(t,e),addRowAfter:()=>({state:t,dispatch:e})=>rV(t,e),deleteRow:()=>({state:t,dispatch:e})=>aV(t,e),deleteTable:()=>({state:t,dispatch:e})=>fV(t,e),mergeCells:()=>({state:t,dispatch:e})=>$A(t,e),splitCell:()=>({state:t,dispatch:e})=>GA(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>Md("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>Md("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>uV(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>$A(t,e)?!0:GA(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>lV(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>qA(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>qA(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&K6(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=tn.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Dh,"Mod-Backspace":Dh,Delete:Dh,"Mod-Delete":Dh}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[CV({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],DV({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:It(He(t,"tableRole",e))}}});zt.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(r5.configure(this.options.table)),this.options.tableCell!==!1&&t.push(e5.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(t5.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(n5.configure(this.options.tableRow)),t}});var HV=n5,VV=t5,$V=e5;const GV=/<\/?[a-z][\s\S]*>/i,WV=t=>GV.test(t),r3=t=>t.trim()?WV(t)?t:Cy(t):"<p></p>",qV=[AH.configure({heading:{levels:[1,2]}}),QU,V6,LH,r5.configure({resizable:!0}),HV,VV,$V,_H,NH.configure({nested:!0})],Qr=({active:t=!1,onClick:e,title:n,children:r})=>m.jsx("button",{type:"button",onMouseDown:i=>i.preventDefault(),onClick:e,className:`p-1 md:p-1.5 rounded transition-colors ${t?"bg-[#CC561E]/15 text-[#CC561E]":"text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-800"}`,title:n,children:r}),i5=({value:t,onChange:e,autoFocus:n=!1,placeholder:r="Start writing... Use toolbar for lists, checklist, headings, and emphasis.",minHeight:i=220})=>{const[a,o]=A.useState("write"),[s,c]=A.useState("#0f172a"),d=A.useRef(!1),h={"--note-editor-min-height":`${i}px`},p=zz({extensions:A.useMemo(()=>[...qV,kH.configure({placeholder:r})],[r]),content:r3(t),autofocus:n?"end":!1,editorProps:{attributes:{class:"personal-note-prosemirror"}},onUpdate:({editor:v})=>{d.current||e(v.getHTML())}});A.useEffect(()=>{if(!p)return;const v=r3(t);p.getHTML()!==v&&(d.current=!0,p.commands.setContent(v,{emitUpdate:!1}),d.current=!1)},[p,t]);const x=A.useMemo(()=>Cy(t),[t]);return m.jsxs("div",{className:"rounded-xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-950 overflow-hidden",children:[m.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:flex-wrap px-2 md:px-3 py-1.5 md:py-2 border-b border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900 gap-2 md:gap-3",children:[m.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap",children:[m.jsx(Qr,{active:!!(p!=null&&p.isActive("heading",{level:1})),onClick:()=>p==null?void 0:p.chain().focus().toggleHeading({level:1}).run(),title:"Heading 1",children:m.jsx(kM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("heading",{level:2})),onClick:()=>p==null?void 0:p.chain().focus().toggleHeading({level:2}).run(),title:"Heading 2",children:m.jsx(OM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("bold")),onClick:()=>p==null?void 0:p.chain().focus().toggleBold().run(),title:"Bold",children:m.jsx(LD,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("italic")),onClick:()=>p==null?void 0:p.chain().focus().toggleItalic().run(),title:"Italic",children:m.jsx(LM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("underline")),onClick:()=>p==null?void 0:p.chain().focus().toggleUnderline().run(),title:"Underline",children:m.jsx(qR,{size:12,className:"md:w-3.5 md:h-3.5"})})]}),m.jsx("div",{className:"flex items-center justify-end md:justify-start gap-1",children:m.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 rounded-md border border-[#E6EAF2] dark:border-slate-700",children:[m.jsxs("button",{type:"button",onClick:()=>o("write"),className:`p-1 md:px-2 md:py-1 text-xs rounded-l-md transition-colors ${a==="write"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Write",children:[m.jsx("span",{className:"md:hidden",children:m.jsx(WE,{size:12})}),m.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[m.jsx(WE,{size:12})," Write"]})]}),m.jsxs("button",{type:"button",onClick:()=>o("preview"),className:`p-1 md:px-2 md:py-1 text-xs rounded-r-md transition-colors ${a==="preview"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Preview",children:[m.jsx("span",{className:"md:hidden",children:m.jsx(zE,{size:12})}),m.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[m.jsx(zE,{size:12})," Preview"]})]})]})}),m.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap md:flex-nowrap",children:[m.jsxs("div",{className:"inline-flex items-center gap-0.5 px-1 py-0.5 rounded border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-900",children:[m.jsx(rR,{size:11,className:"text-slate-500 md:w-3 md:h-3"}),m.jsx("input",{type:"color",value:s,onChange:v=>{const b=v.target.value;c(b),p==null||p.chain().focus().setColor(b).run()},className:"w-4 h-4 md:w-5 md:h-5 p-0 border-0 bg-transparent cursor-pointer",title:"Text Color"}),m.jsx(Qr,{active:!1,onClick:()=>p==null?void 0:p.chain().focus().unsetColor().run(),title:"Clear Text Color",children:m.jsx(uM,{size:10,className:"md:w-3 md:h-3"})})]}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("bulletList")),onClick:()=>p==null?void 0:p.chain().focus().toggleBulletList().run(),title:"Bullet List",children:m.jsx(GM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("orderedList")),onClick:()=>p==null?void 0:p.chain().focus().toggleOrderedList().run(),title:"Numbered List",children:m.jsx(VM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("taskList")),onClick:()=>p==null?void 0:p.chain().focus().toggleTaskList().run(),title:"Checklist",children:m.jsx(TR,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("blockquote")),onClick:()=>p==null?void 0:p.chain().focus().toggleBlockquote().run(),title:"Quote",children:m.jsx(yd,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!!(p!=null&&p.isActive("table")),onClick:()=>p==null?void 0:p.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),title:"Insert Table",children:m.jsx(PR,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!1,onClick:()=>p==null?void 0:p.chain().focus().addRowAfter().run(),title:"Add Row",children:m.jsx(pR,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!1,onClick:()=>p==null?void 0:p.chain().focus().addColumnAfter().run(),title:"Add Column",children:m.jsx(rM,{size:12,className:"md:w-3.5 md:h-3.5"})}),m.jsx(Qr,{active:!1,onClick:()=>p==null?void 0:p.chain().focus().deleteTable().run(),title:"Delete Table",children:m.jsx(Js,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]}),a==="write"?m.jsx("div",{className:"bg-white dark:bg-slate-950 text-slate-900 dark:text-white",style:h,children:m.jsx(u6,{editor:p})}):m.jsx("div",{className:"personal-note-render p-3 md:p-4 max-w-none text-slate-800 dark:text-slate-200",style:{minHeight:i},dangerouslySetInnerHTML:{__html:x}})]})},XV=Qe.lazy(()=>ol(()=>import("./KnowledgeDashboard-B8-xSdLX.js"),[]).then(t=>({default:t.KnowledgeDashboard}))),i3=t=>t.trim().toLowerCase(),Bs=10,ic=t=>t.toLocaleLowerCase("tr-TR").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"i").replace(/\s+/g," ").trim(),ei=(t,e)=>e?ic(t).includes(e):!0,a3=({id:t,children:e})=>{const{attributes:n,listeners:r,setNodeRef:i,transform:a,isDragging:o}=p9({id:t}),s={transform:wc.Transform.toString(a)};return m.jsx(m.Fragment,{children:e({setNodeRef:i,style:s,isDragging:o,attributes:n,listeners:r})})},rx=({id:t,children:e})=>{const{setNodeRef:n,isOver:r}=v9({id:t});return m.jsx("div",{ref:n,children:e(r)})},KV=Qe.memo(({books:t,personalNoteFolders:e=[],onAddBook:n,onAddPersonalNote:r,onQuickCreatePersonalNote:i,onCreatePersonalFolder:a,onRenamePersonalFolder:o,onDeletePersonalFolder:s,onMovePersonalNote:c,onMovePersonalFolder:d,onSelectBook:h,onSelectBookWithTab:p,activeTab:x,onMobileMenuClick:v,onDeleteBook:b,onDeleteMultiple:C,onToggleFavorite:E,onToggleHighlightFavorite:S,userId:N,categoryFilter:k,onCategoryFilterChange:I,onCategoryNavigate:D,onStatusNavigate:L,currentPage:O,onPageChange:j,searchQuery:U,onSearchChange:fe,statusFilter:le,onStatusFilterChange:q,sortOption:de,onSortOptionChange:ge,publisherFilter:xe,onPublisherFilterChange:H,onTabChange:ie})=>{const[K,B]=A.useState(!1),G={"To Read":"bg-[#94A3B8]/15 text-[#94A3B8] border border-[#94A3B8]/40",Reading:"bg-[#38BDF8]/15 text-[#38BDF8] border border-[#38BDF8]/40",Finished:"bg-[#22C55E]/15 text-[#22C55E] border border-[#22C55E]/40"},M=x==="DASHBOARD",V=x==="NOTES",Z=x==="PERSONAL_NOTE",[re,_e]=A.useState("ALL"),[J,we]=A.useState("ALL"),[z,ae]=A.useState("NONE"),[ce,Te]=A.useState(null),[Le,ot]=A.useState(!1),[Ke,ht]=A.useState({PRIVATE:!0,DAILY:!0,IDEAS:!0}),[Ut,Me]=A.useState({PRIVATE:Bs,DAILY:Bs,IDEAS:Bs}),[We,Pe]=A.useState(!1),[Se,fn]=A.useState(!1),[An,Mr]=A.useState("DAILY"),[rn,Fi]=A.useState(""),[or,sr]=A.useState(""),[St,Er]=A.useState(null),[zi,lr]=A.useState(null),[xi,Gr]=A.useState(null),[xn,cr]=A.useState(null);A.useEffect(()=>{Z||(_e("ALL"),we("ALL"),ae("NONE"),Te(null),ot(!1),ht({PRIVATE:!0,DAILY:!0,IDEAS:!0}),Me({PRIVATE:Bs,DAILY:Bs,IDEAS:Bs}),Mr("DAILY"),Pe(!1))},[Z]),A.useEffect(()=>{ce&&ot(!0)},[ce]);const Tn=f7(XE(by,{activationConstraint:{distance:8}}),XE(P4,{activationConstraint:{delay:120,tolerance:8}})),xs=Q=>{const P=Date.now();window.innerWidth<768&&(xn==null?void 0:xn.noteId)===Q.id&&P-xn.time<300?(cr(null),p?p(Q,"info"):h(Q)):(cr({noteId:Q.id,time:P}),h(Q))},On=A.useMemo(()=>{const Q=new Map;return e.forEach(P=>Q.set(P.id,P)),Q},[e]);A.useEffect(()=>{if(J==="ALL"||J==="__ROOT__")return;const Q=On.get(J);Q&&(An!==Q.category&&Mr(Q.category),ht(P=>({...P,[Q.category]:!1})))},[J,On,An]);const aa=A.useMemo(()=>{const Q=new Map;return e.forEach(P=>{Q.set(`${P.category}::${P.name.toLowerCase()}`,P.id)}),Q},[e]),Wr=Q=>{if(!gn(Q))return;if(Q.personalFolderId)return Q.personalFolderId;const P=(Q.folderPath||"").trim();if(P)return aa.get(`${Nr(Q)}::${P.toLowerCase()}`)},vi=Q=>{var Ie;const P=Wr(Q);return P?(Ie=On.get(P))==null?void 0:Ie.name:Q.folderPath||void 0},At=A.useMemo(()=>{switch(x){case"BOOK":return 24;case"ARTICLE":return 24;case"WEBSITE":return 24;case"PERSONAL_NOTE":return 30;case"NOTES":return 50;default:return 24}},[x]),[Ht,Kt]=A.useState(U);A.useEffect(()=>{if(Ht!==U){B(!0);const Q=setTimeout(()=>{fe(Ht),j(1),B(!1)},300);return()=>clearTimeout(Q)}},[Ht,U,fe,j]),A.useEffect(()=>{Kt(U)},[U]);const Vt=A.useMemo(()=>{if(V||M)return[];const Q=ic(U),P=Z&&z==="RECENT"?new Set(t.filter(Ne=>Ne.type==="PERSONAL_NOTE"&&Nr(Ne)!=="PRIVATE").sort((Ne,ut)=>ut.addedAt-Ne.addedAt).slice(0,20).map(Ne=>Ne.id)):null;return t.filter(Ne=>{if(Ne.type!==x)return!1;if(Z){const oi=Nr(Ne);if(re==="ALL"&&oi==="PRIVATE"||re!=="ALL"&&oi!==re)return!1;if(J!=="ALL"){const sa=Wr(Ne);if(J==="__ROOT__"){if(sa)return!1}else if(sa!==J)return!1}if(z==="FAVORITES"&&!Ne.isFavorite||z==="RECENT"&&!(P!=null&&P.has(Ne.id))||ce&&!new Set((Ne.tags||[]).map(vs=>i3(vs))).has(ce))return!1}if(k){const oi=ic(k);if(!(Ne.tags||[]).some(vs=>ic(vs)===oi))return!1}let ut=!0;return le!=="ALL"&&(le==="HIGHLIGHTS"?ut=Ne.highlights&&Ne.highlights.length>0:le==="FAVORITES"?ut=Ne.isFavorite===!0:["To Read","Reading","Finished"].includes(le)?ut=Ne.readingStatus===le:x==="BOOK"?ut=Ne.status===le:ut=!1),!ut||xe&&x!=="BOOK"&&!ei(Ne.publisher||"",ic(xe))?!1:!Q||ei(Ne.title||"",Q)||ei(Ne.author||"",Q)?!0:x==="BOOK"?!!(ei(Ne.isbn||"",Q)||ei(Ne.code||"",Q)):!!((Ne.tags||[]).some(oi=>ei(oi,Q))||ei(Cc(Ne.generalNotes||""),Q)||gn(Ne)&&(ei(Nr(Ne),Q)||ei(vi(Ne)||"",Q)))}).sort((Ne,ut)=>de==="title_asc"?Ne.title.localeCompare(ut.title):de==="date_asc"?Ne.addedAt-ut.addedAt:ut.addedAt-Ne.addedAt)},[t,U,le,xe,de,x,V,M,k,Z,re,J,z,ce,On,aa]),vt=A.useMemo(()=>t.filter(Q=>Q.type==="PERSONAL_NOTE"),[t]),Yt=A.useMemo(()=>vt.filter(Q=>Nr(Q)!=="PRIVATE"),[vt]),Xn=Yt.length,ur=A.useMemo(()=>Yt.filter(Q=>Q.isFavorite).length,[Yt]),Rr=A.useMemo(()=>[...Yt].sort((Q,P)=>P.addedAt-Q.addedAt).slice(0,20).map(Q=>Q.id),[Yt]).length,Kn=A.useMemo(()=>{const Q=new Map;return Yt.forEach(P=>{const Ie=new Set;(P.tags||[]).forEach(Ne=>{const ut=Ne.trim();if(!ut)return;const $t=i3(ut);if(Ie.has($t))return;Ie.add($t);const pn=Q.get($t);if(!pn){Q.set($t,{label:ut,noteIds:new Set([P.id])});return}pn.noteIds.add(P.id)})}),[...Q.entries()].map(([P,Ie])=>({key:P,label:Ie.label||P,count:Ie.noteIds.size})).sort((P,Ie)=>Ie.count-P.count||P.label.localeCompare(Ie.label)).slice(0,10)},[Yt]),Sr=A.useMemo(()=>{const Q={PRIVATE:0,DAILY:0,IDEAS:0};return vt.forEach(P=>{Q[Nr(P)]+=1}),Q},[vt]),In=A.useMemo(()=>{const Q={PRIVATE:[],DAILY:[],IDEAS:[]};return e.forEach(P=>{Q[P.category].push({id:P.id,name:P.name,order:P.order,count:vt.filter(Ie=>Wr(Ie)===P.id).length})}),["PRIVATE","DAILY","IDEAS"].forEach(P=>{Q[P].sort((Ie,Ne)=>Ie.order-Ne.order||Ie.name.localeCompare(Ne.name))}),Q},[vt,e,aa]),$=A.useMemo(()=>{const Q={PRIVATE:0,DAILY:0,IDEAS:0};return vt.forEach(P=>{const Ie=Nr(P);Wr(P)||(Q[Ie]+=1)}),Q},[vt,aa]);A.useEffect(()=>{if(J==="ALL"||J==="__ROOT__")return;const Q=["PRIVATE","DAILY","IDEAS"].find(Ie=>In[Ie].some(Ne=>Ne.id===J));if(!Q)return;const P=In[Q].findIndex(Ie=>Ie.id===J);P<0||Me(Ie=>{const Ne=P+1;return Ie[Q]>=Ne?Ie:{...Ie,[Q]:Ne}})},[J,In]);const X=A.useMemo(()=>{if(!V)return[];const Q=ic(U);return t.flatMap(P=>P.highlights.map(Ie=>({...Ie,source:P}))).filter(P=>le==="FAVORITES"&&!P.isFavorite?!1:Q?ei(P.text||"",Q)||ei(P.comment||"",Q)||ei(P.source.title||"",Q)||ei(P.source.author||"",Q)||!!(P.tags&&P.tags.some(Ie=>ei(Ie,Q))):!0).sort((P,Ie)=>Ie.createdAt-P.createdAt)},[t,V,U,le]),Ae=A.useMemo(()=>V?{total:X.length,reading:0,toRead:0}:{total:Vt.length,reading:Vt.filter(Q=>Q.readingStatus==="Reading").length,toRead:Vt.filter(Q=>Q.readingStatus==="To Read").length},[V,X.length,Vt]),Ce=Q=>{switch(Q){case"BOOK":return"Books";case"ARTICLE":return"Articles";case"WEBSITE":return"Websites";case"PERSONAL_NOTE":return"Personal Notes";case"NOTES":return"All Notes";case"DASHBOARD":return"Dashboard"}},se=()=>V?"Search quotes...":x==="PERSONAL_NOTE"?"Search notes...":x==="ARTICLE"?"Search title, author...":x==="WEBSITE"?"Search site, URL...":"Search title, author, ISBN...",me=Q=>{switch(Q){case"PRIVATE":return"Private";case"DAILY":return"Daily";case"IDEAS":return"Ideas";default:return Q}},Ee=async Q=>{const P=window.prompt(`${me(Q)} klasor adi:`),Ie=P==null?void 0:P.trim();if(!Ie)return;const Ne=await(a==null?void 0:a(Q,Ie));Ne&&(ae("NONE"),Te(null),_e(Q),we(Ne.id),j(1))},Ye=async(Q,P)=>{const Ie=window.prompt("Yeni klasor adi:",P),Ne=Ie==null?void 0:Ie.trim();!Ne||Ne===P||await(o==null?void 0:o(Q,Ne))},Fe=async Q=>{!window.confirm("Bu klasor silinsin mi? Icindeki notlar kategori kokune tasinacak.")||!await(s==null?void 0:s(Q))||J===Q&&(ae("NONE"),Te(null),we("__ROOT__"))},rt=(Q,P,Ie)=>{xi&&window.clearTimeout(xi.timeoutId);const Ne=window.setTimeout(()=>{Gr(null)},5e3);Gr({noteId:Q,category:P,folderId:Ie,timeoutId:Ne})},et=async(Q,P,Ie,Ne=!0)=>{const ut=vt.find(mn=>mn.id===Q);if(!ut)return;const $t=Nr(ut),pn=Wr(ut);await(c==null?void 0:c(Q,P,Ie))&&Ne&&rt(Q,$t,pn)},Zt=Q=>{var P;if(Q.startsWith("cat-root:"))return Q.replace("cat-root:","");if(Q.startsWith("cat-group:"))return Q.replace("cat-group:","");if(Q.startsWith("folder:")){const Ie=Q.replace("folder:","");return(P=On.get(Ie))==null?void 0:P.category}},bt=async(Q,P)=>{const Ie=On.get(Q);if(!Ie||Ie.category===P)return;await(d==null?void 0:d(Q,P))&&J===Q&&(_e(P),j(1))},Tt=Q=>{const P=String(Q.active.id);if(P.startsWith("note:")){Er(P.replace("note:","")),lr(null);return}P.startsWith("folder-item:")&&(lr(P.replace("folder-item:","")),Er(null))},Lr=()=>{Er(null),lr(null)},Ui=async Q=>{var Ne;Er(null),lr(null);const P=String(Q.active.id||""),Ie=String(((Ne=Q.over)==null?void 0:Ne.id)||"");if(Ie){if(P.startsWith("note:")){const ut=P.replace("note:",""),$t=Zt(Ie);if(!$t)return;const pn=Ie.startsWith("folder:")?Ie.replace("folder:",""):void 0;await et(ut,$t,pn,!0);return}if(P.startsWith("folder-item:")){const ut=P.replace("folder-item:",""),$t=Zt(Ie);if(!$t)return;await bt(ut,$t)}}},lo=()=>{var $t,pn;const Q=or;if(!yp(Q))return;const P=J==="ALL"||J==="__ROOT__"?void 0:J,Ne=(P?($t=On.get(P))==null?void 0:$t.category:void 0)||An,ut=P?(pn=On.get(P))==null?void 0:pn.name:void 0;i==null||i({title:rn.trim()||"Quick Note",content:Q,category:Ne,folderId:P,folderPath:ut}),Fi(""),sr("")},Dn=V?X.length:Vt.length,jr=Math.ceil(Dn/At),af=x==="ARTICLE"||x==="WEBSITE"?"dark:bg-slate-800":"dark:bg-slate-900",yi=A.useMemo(()=>{const Q=(O-1)*At;return Vt.slice(Q,Q+At)},[Vt,O,At]),Sa=A.useMemo(()=>{const Q=(O-1)*At;return X.slice(Q,Q+At)},[X,O,At]),Hc=A.useMemo(()=>St&&vt.find(Q=>Q.id===St)||null,[vt,St]),Vc=A.useMemo(()=>zi&&On.get(zi)||null,[On,zi]),$c=()=>{if(jr<=1)return null;const Q=()=>{const P=[];if(jr<=5)for(let Ne=1;Ne<=jr;Ne++)P.push(Ne);else O<=3?P.push(1,2,3,4,"...",jr):O>=jr-2?P.push(1,"...",jr-3,jr-2,jr-1,jr):P.push(1,"...",O-1,O,O+1,"...",jr);return P};return m.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4 md:mt-12 select-none",children:[m.jsx("button",{onClick:()=>j(Math.max(O-1,1)),disabled:O===1,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m.jsx(Qo,{size:20})}),m.jsx("div",{className:"flex items-center gap-1",children:Q().map((P,Ie)=>m.jsx(Qe.Fragment,{children:P==="..."?m.jsx("span",{className:"px-2 text-slate-400",children:"..."}):m.jsx("button",{onClick:()=>j(P),className:`w-8 h-8 md:w-10 md:h-10 rounded-lg text-sm font-medium transition-colors ${O===P?"bg-[#262D40]/40 text-white shadow-md shadow-[#262D40]/12 dark:shadow-none":"text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82"}`,children:P})},Ie))}),m.jsx("button",{onClick:()=>j(Math.min(O+1,jr)),disabled:O===jr,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m.jsx(m4,{size:20})})]})},o1=()=>{var Q;return M?m.jsx(Qe.Suspense,{fallback:m.jsx("div",{className:"flex justify-center items-center py-20",children:m.jsx(kn,{size:32,className:"animate-spin text-[#262D40]/90"})}),children:m.jsx(XV,{items:t,userId:N,onCategorySelect:P=>D==null?void 0:D(P),onStatusSelect:P=>L==null?void 0:L(P),onNavigateToTab:P=>ie==null?void 0:ie(P),onMobileMenuClick:v})}):K?m.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400 animate-in fade-in duration-200",children:[m.jsx(kn,{size:32,className:"animate-spin text-[#262D40]/90 mb-4"}),m.jsx("p",{children:"Searching library..."})]}):V?Sa.length===0?m.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[m.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:m.jsx(bc,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),m.jsx("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:"No highlights found"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:U?"Try a different search term.":"Highlights added to books appear here."})]}):m.jsxs("div",{className:"pb-10 md:pb-20",children:[m.jsx("div",{className:"columns-2 lg:columns-3 gap-2 md:gap-6 space-y-2 md:space-y-6",children:Sa.map((P,Ie)=>{var ut,$t;const Ne=q4(P.type);return m.jsxs("div",{onClick:()=>{p?p(P.source,"highlights",P.id):h(P.source)},className:"break-inside-avoid p-2.5 md:p-6 rounded-xl border hover:shadow-md transition-all group cursor-pointer relative flex flex-col bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/12 dark:hover:border-[#262D40]/30",children:[m.jsx("button",{onClick:pn=>{pn.stopPropagation(),S&&S(P.source.id,P.id)},className:`absolute top-2 right-2 p-1.5 rounded-full transition-all shadow-sm z-10 ${P.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:P.isFavorite?"Remove from Favorites":"Add to Favorites",children:m.jsx(Zl,{size:14,fill:P.isFavorite?"currentColor":"none"})}),m.jsx("div",{className:"mb-2 md:mb-3",children:Ne?m.jsx(bc,{className:"text-[#CC561E] fill-[#CC561E]/10 w-4 h-4 md:w-6 md:h-6"}):((ut=P.source)==null?void 0:ut.type)==="ARTICLE"?m.jsx($h,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):(($t=P.source)==null?void 0:$t.type)==="WEBSITE"?m.jsx(Gh,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):m.jsx(yd,{className:"text-[#262D40]/82 fill-[#262D40]/85 w-4 h-4 md:w-6 md:h-6"})}),m.jsx("p",{className:`text-xs md:text-base leading-relaxed mb-2 md:mb-4 whitespace-pre-wrap line-clamp-[8] md:line-clamp-none font-lora ${Ne?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-slate-200"}`,children:P.text}),P.tags&&P.tags.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 mb-2 md:mb-3",children:P.tags.map((pn,oa)=>m.jsxs("span",{className:"px-1.5 md:px-2 py-0.5 md:py-1 bg-[#F3F5FA] dark:bg-slate-700/50 border border-[#E6EAF2] dark:border-white/10 rounded text-[10px] md:text-xs text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[m.jsx(sp,{size:10,className:"md:w-3 md:h-3"})," ",pn]},oa))}),m.jsx("div",{className:`pt-2 md:pt-4 mt-auto flex items-center justify-between border-t ${Ne?"border-[#E6EAF2]":"border-[#262D40]/50"}`,children:m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h4",{className:"text-xs md:text-sm font-bold text-slate-900 dark:text-white truncate",children:P.source.title}),m.jsx("div",{className:"flex items-center gap-1 md:gap-2 text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:m.jsx("span",{className:"truncate max-w-[50%]",children:P.source.author})})]})})]},`${P.id}-${Ie}`)})}),$c()]}):yi.length===0&&!Z?m.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[m.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:x==="BOOK"?m.jsx(dy,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):x==="ARTICLE"?m.jsx(zd,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):x==="PERSONAL_NOTE"?m.jsx(lp,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):m.jsx(N0,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),m.jsxs("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:["No ",Ce(x).toLowerCase()," found"]}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:U?"Try a different search term.":"Adjust filters or add a new item."})]}):m.jsxs("div",{className:"pb-10 md:pb-20",children:[Z?m.jsxs(d9,{sensors:Tn,collisionDetection:v7,modifiers:[sS],onDragStart:Tt,onDragCancel:Lr,onDragEnd:Ui,children:[m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_minmax(0,1fr)] gap-4 md:gap-6",children:[m.jsxs("aside",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl p-3 md:p-4 h-fit ${We?"block":"hidden lg:block"}`,children:[m.jsxs("div",{className:"flex items-center justify-between mb-3",children:[m.jsxs("h3",{className:"text-xs font-bold uppercase tracking-[0.16em] text-slate-500 flex items-center gap-2",children:[m.jsx(GE,{size:14}),"Note Space"]}),m.jsx("button",{onClick:()=>Pe(!1),className:"lg:hidden text-slate-400 hover:text-slate-700",children:m.jsx(ta,{size:16})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("button",{onClick:()=>{ae("NONE"),Te(null),_e("ALL"),we("ALL"),j(1)},className:`w-full text-left px-2.5 py-2 rounded-lg text-sm transition-colors ${re==="ALL"&&J==="ALL"&&z==="NONE"&&!ce?"bg-[#262D40]/20 text-[#262D40] dark:text-white font-semibold":"hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300"}`,children:["All Notes (",Xn,")"]}),m.jsxs("div",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-800 p-2",children:[m.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 mb-1",children:"Smart Folders"}),m.jsxs("button",{onClick:()=>{ae("FAVORITES"),Te(null),_e("ALL"),we("ALL"),j(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${z==="FAVORITES"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[m.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[m.jsx(Zl,{size:12}),"Favorites"]}),m.jsx("span",{className:"text-[10px] opacity-70",children:ur})]}),m.jsxs("button",{onClick:()=>{ae("RECENT"),Te(null),_e("ALL"),we("ALL"),j(1)},className:`mt-1 w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${z==="RECENT"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[m.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[m.jsx(QD,{size:12}),"Recent Notes"]}),m.jsx("span",{className:"text-[10px] opacity-70",children:Rr})]}),m.jsxs("div",{className:"mt-2 border-t border-[#E6EAF2] dark:border-slate-800 pt-2",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("button",{onClick:()=>ot(P=>!P),className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 inline-flex items-center gap-1 hover:text-slate-700 dark:hover:text-slate-300",children:[m.jsx($s,{size:11,className:`transition-transform ${Le?"rotate-180":""}`}),"Top Tags"]}),ce&&m.jsx("button",{onClick:()=>{Te(null),j(1)},className:"text-[10px] text-[#CC561E] hover:underline",children:"Clear tag filter"})]}),Le&&(Kn.length===0?m.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No tags yet"}):m.jsx("div",{className:"space-y-1",children:Kn.map(P=>m.jsxs("button",{onClick:()=>{Te(P.key),j(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${ce===P.key?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[m.jsxs("span",{className:"truncate",children:["#",P.label]}),m.jsx("span",{className:"text-[10px] opacity-70",children:P.count})]},P.key))}))]})]}),["PRIVATE","DAILY","IDEAS"].map(P=>m.jsx(rx,{id:`cat-group:${P}`,children:Ie=>m.jsxs("div",{className:`rounded-lg border p-2 ${Ie?"border-[#CC561E]/40 bg-[#CC561E]/5":"border-[#E6EAF2] dark:border-slate-800"}`,children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("button",{onClick:()=>{ae("NONE"),Te(null),_e(P),we("ALL"),j(1)},className:`text-xs font-semibold uppercase tracking-wide ${re===P&&J==="ALL"&&z==="NONE"&&!ce?"text-[#CC561E]":"text-slate-600 dark:text-slate-300"}`,children:[me(P)," (",Sr[P],")"]}),m.jsxs("button",{onClick:()=>Ee(P),className:"text-[11px] text-[#CC561E] hover:underline inline-flex items-center gap-1",children:[m.jsx(vM,{size:11}),"Folder"]})]}),m.jsx(rx,{id:`cat-root:${P}`,children:Ne=>m.jsxs("button",{onClick:()=>{ae("NONE"),Te(null),_e(P),we("__ROOT__"),j(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors ${Ne?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${re===P&&J==="__ROOT__"&&z==="NONE"&&!ce?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:["Unfiled (",$[P],")"]})}),m.jsxs("div",{className:"mt-1",children:[m.jsxs("button",{onClick:()=>ht(Ne=>({...Ne,[P]:!Ne[P]})),className:"w-full text-left px-2 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 inline-flex items-center gap-1",children:[m.jsx($s,{size:11,className:`transition-transform ${Ke[P]?"":"rotate-180"}`}),"Folders (",In[P].length,")"]}),!Ke[P]&&m.jsxs("div",{className:"mt-1 space-y-1",children:[In[P].length===0?m.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No folders yet"}):In[P].slice(0,Ut[P]).map(Ne=>m.jsx(rx,{id:`folder:${Ne.id}`,children:ut=>m.jsx(a3,{id:`folder-item:${Ne.id}`,children:({setNodeRef:$t,style:pn,isDragging:oa,attributes:mn,listeners:oi})=>m.jsxs("div",{ref:$t,style:oa?void 0:pn,className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm flex items-center gap-2 ${ut?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${re===P&&J===Ne.id&&z==="NONE"&&!ce?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"} ${oa?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[m.jsx("button",{...mn,...oi,onClick:sa=>sa.stopPropagation(),className:"p-1 rounded text-slate-400 hover:text-slate-700 cursor-grab active:cursor-grabbing",title:"Move folder",children:m.jsx(HE,{size:12})}),m.jsxs("button",{onClick:()=>{ae("NONE"),Te(null),_e(P),we(Ne.id),j(1)},className:"flex items-center gap-2 flex-1 min-w-0",children:[m.jsx(UE,{size:12}),m.jsx("span",{className:"truncate",children:Ne.name})]}),m.jsx("span",{className:"text-[10px] opacity-70",children:Ne.count}),m.jsx("button",{onClick:()=>Ye(Ne.id,Ne.name),className:"text-slate-400 hover:text-slate-700",title:"Rename folder",children:m.jsx(lR,{size:12})}),m.jsx("button",{onClick:()=>Fe(Ne.id),className:"text-slate-400 hover:text-red-500",title:"Delete folder",children:m.jsx(Js,{size:12})})]})})},Ne.id)),In[P].length>Ut[P]&&m.jsxs("button",{onClick:()=>Me(Ne=>({...Ne,[P]:Ne[P]+Bs})),className:"w-full text-left px-2 py-1.5 rounded-md text-[11px] font-semibold text-[#CC561E] hover:bg-[#CC561E]/10",children:["Load more (",In[P].length-Ut[P]," left)"]})]})]})]})},P))]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"lg:hidden flex gap-2",children:[m.jsxs("button",{onClick:()=>Pe(P=>!P),className:"flex-1 px-3 py-2.5 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider text-slate-600 dark:text-slate-400 shadow-sm active:scale-95 transition-all",children:[m.jsx(GE,{size:14}),"Navigator"]}),m.jsxs("button",{onClick:()=>fn(!Se),className:`flex-1 px-3 py-2.5 border rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider transition-all shadow-sm active:scale-95 ${Se?"bg-[#CC561E]/10 border-[#CC561E]/30 text-[#CC561E]":"bg-white dark:bg-slate-900 border-[#E6EAF2] dark:border-slate-800 text-slate-600 dark:text-slate-400"}`,children:[m.jsx($s,{size:14,className:`transition-transform duration-200 ${Se?"rotate-180":""}`}),"Capture"]})]}),m.jsxs("div",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-2xl overflow-hidden ${Se?"block":"hidden lg:block"}`,children:[m.jsxs("div",{className:`w-full flex items-center justify-between p-4 md:p-5 transition-colors ${Se?"":"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,onClick:()=>!Se&&fn(!0),children:[m.jsxs("h4",{className:"hidden lg:flex text-sm md:text-base font-semibold uppercase tracking-[0.12em] text-slate-500 items-center gap-2 cursor-pointer",onClick:P=>{P.stopPropagation(),fn(!Se)},children:[m.jsx($s,{size:16,className:`transition-transform duration-200 ${Se?"rotate-180":""}`}),"Quick Capture"]}),(Se||window.innerWidth>=1024)&&m.jsxs("div",{className:`flex items-center gap-2 flex-1 lg:flex-none justify-between lg:justify-end ${Se?"flex":"hidden lg:flex"}`,onClick:P=>P.stopPropagation(),children:[m.jsx("span",{className:"lg:hidden text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Quick Capture"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("select",{value:An,onChange:P=>Mr(P.target.value),className:"text-[11px] border border-[#E6EAF2] dark:border-slate-700 rounded-md px-2 py-1 bg-white dark:bg-slate-950 text-slate-500 outline-none",children:[m.jsx("option",{value:"DAILY",children:"Daily"}),m.jsx("option",{value:"PRIVATE",children:"Private"}),m.jsx("option",{value:"IDEAS",children:"Ideas"})]}),z==="NONE"&&J!=="ALL"&&J!=="__ROOT__"&&m.jsxs("span",{className:"hidden sm:inline text-[11px] text-slate-400",children:["/ ",((Q=On.get(J))==null?void 0:Q.name)||J]})]})]})]}),Se&&m.jsxs("div",{className:"px-4 pb-4 md:px-5 md:pb-5 pt-0 animate-in slide-in-from-top-2 duration-200",children:[m.jsx("input",{value:rn,onChange:P=>Fi(P.target.value),placeholder:"Note title (optional)",className:"w-full mb-3 border border-[#E6EAF2] dark:border-slate-700 rounded-xl px-4 py-3 text-sm md:text-base bg-white dark:bg-slate-950 block"}),m.jsx("div",{className:"w-full",children:m.jsx(i5,{value:or,onChange:sr,autoFocus:Z,placeholder:"Start writing immediately...",minHeight:242},"quick-capture-editor")}),m.jsx("div",{className:"mt-3 flex justify-end w-full",children:m.jsx("button",{onClick:lo,disabled:!yp(or),className:"px-4 py-2 rounded-lg bg-[#262D40] text-white text-sm md:text-base disabled:opacity-40",children:"Save Quick Note"})})]})]}),yi.length===0?m.jsxs("div",{className:"text-center py-10 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[m.jsx(lp,{size:26,className:"mx-auto mb-2 text-slate-300"}),m.jsx("h3",{className:"text-base font-medium text-slate-900 dark:text-white",children:"No notes matched this filter"}),m.jsx("p",{className:"text-xs md:text-sm text-slate-500 mt-1",children:"Change category/folder filter or create a new note."})]}):m.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-2 md:gap-4",children:yi.map(P=>{const Ie=Cc(P.generalNotes||"");return m.jsx(a3,{id:`note:${P.id}`,children:({setNodeRef:Ne,style:ut,isDragging:$t,attributes:pn,listeners:oa})=>m.jsxs("div",{ref:Ne,style:$t?void 0:ut,onClick:()=>xs(P),className:`bg-white dark:bg-slate-800 p-2.5 md:p-5 rounded-xl border border-[#E6EAF2] dark:border-slate-800 hover:border-[#262D40]/20 dark:hover:border-[#262D40]/30 hover:shadow-md transition-all cursor-pointer flex flex-col group relative ${$t||St===P.id?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[m.jsx("div",{className:"absolute top-2 left-2 z-10",children:m.jsx("button",{...pn,...oa,onClick:mn=>mn.stopPropagation(),className:"p-1.5 rounded-full bg-white/85 dark:bg-slate-800/85 text-slate-400 hover:text-slate-700 shadow-sm",title:"Drag note",children:m.jsx(HE,{size:13})})}),m.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 z-10",children:[m.jsx("button",{onClick:mn=>{mn.stopPropagation(),E(P.id)},className:`p-1.5 rounded-full transition-all shadow-sm ${P.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:P.isFavorite?"Remove from Favorites":"Add to Favorites",children:m.jsx(Zl,{size:14,fill:P.isFavorite?"currentColor":"none"})}),m.jsx("button",{onClick:mn=>{mn.stopPropagation(),b(P.id)},className:"p-1.5 bg-white/80 dark:bg-slate-800/80 hover:bg-[#F3F5FA] dark:hover:bg-slate-700 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 shadow-sm",title:"Delete Note",children:m.jsx(Js,{size:14})})]}),m.jsx("h3",{className:"font-bold text-sm md:text-base text-slate-900 dark:text-white mb-2 leading-tight pl-8 pr-8",children:P.title}),m.jsxs("div",{className:"text-slate-600 dark:text-slate-300 text-xs md:text-sm whitespace-pre-wrap leading-relaxed max-h-[180px] overflow-hidden relative font-lora mb-3",children:[Ie||m.jsx("span",{className:"italic text-slate-400 dark:text-slate-500",children:"Empty"}),Ie.length>140&&m.jsx("div",{className:"absolute bottom-0 inset-x-0 h-8 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),m.jsxs("div",{className:"mt-auto pt-2 flex flex-wrap gap-1.5 border-t border-slate-100 dark:border-slate-800 items-center",children:[m.jsx("span",{className:"px-2 py-0.5 bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs rounded border border-[#CC561E]/20 font-semibold",children:Nr(P)}),vi(P)&&m.jsx("span",{className:"px-2 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700 truncate max-w-[150px]",children:vi(P)}),m.jsxs("span",{className:"ml-auto text-[10px] md:text-xs text-slate-400 flex items-center gap-1",children:[m.jsx(xc,{size:10,className:"md:w-3 md:h-3"}),new Date(P.addedAt).toLocaleDateString()]})]})]})},P.id)})})]})]}),m.jsx(I9,{modifiers:[sS],children:Hc?m.jsxs("div",{className:"w-[320px] max-w-[80vw] bg-white dark:bg-slate-800 p-3 rounded-xl border border-[#CC561E]/35 shadow-xl cursor-grabbing",children:[m.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:Hc.title}),m.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-300 truncate",children:me(Nr(Hc))})]}):Vc?m.jsxs("div",{className:"w-[220px] max-w-[70vw] bg-white dark:bg-slate-900 px-3 py-2 rounded-lg border border-[#CC561E]/35 shadow-xl cursor-grabbing flex items-center gap-2",children:[m.jsx(UE,{size:13,className:"text-slate-500"}),m.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 truncate",children:Vc.name})]}):null})]}):m.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 md:gap-6",children:yi.map(P=>m.jsxs("div",{onClick:()=>h(P),className:`bg-white ${af} rounded-xl border border-[#E6EAF2] dark:border-slate-800 overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all cursor-pointer group flex flex-col h-full relative`,children:[m.jsxs("div",{className:"h-[122px] md:h-40 bg-[#F3F5FA] dark:bg-slate-800 relative flex items-end justify-between overflow-hidden group-hover:opacity-95 transition-opacity",children:[m.jsxs("div",{className:"absolute top-2 right-2 z-40 flex gap-1",children:[m.jsx("button",{onClick:Ie=>{Ie.stopPropagation(),E(P.id)},className:`p-1.5 rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all ${P.isFavorite?"bg-amber-100/90 dark:bg-amber-900/80 text-amber-500 dark:text-amber-400 opacity-100":"bg-white/90 dark:bg-slate-900/90 text-slate-400 dark:text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:P.isFavorite?"Remove from Favorites":"Add to Favorites",children:m.jsx(Zl,{size:14,className:"md:w-4 md:h-4",fill:P.isFavorite?"currentColor":"none"})}),m.jsx("button",{onClick:Ie=>{Ie.stopPropagation(),b(P.id)},className:"p-1.5 bg-white/90 dark:bg-slate-900/90 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:"Delete Item",children:m.jsx(Js,{size:14,className:"md:w-4 md:h-4"})}),P.isIngested&&m.jsx("div",{className:"p-1.5 bg-[#262D40]/90 dark:bg-[#262D40]/90 text-white rounded-full shadow-sm backdrop-blur-sm border border-[#262D40]/50 dark:border-[#262D40]/50 transition-all z-40",title:"Added to AI Library",children:m.jsx(vd,{size:14,className:"md:w-4 md:h-4",fill:"currentColor"})})]}),m.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#F3F5FA] dark:bg-slate-800 transition-colors group-hover:bg-[#EDF1F8] dark:group-hover:bg-slate-700",children:m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute inset-0 bg-[#262D40]/20 blur-2xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),m.jsx("div",{className:"relative p-4 rounded-full",children:P.type==="BOOK"?m.jsx(Zx,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):P.type==="ARTICLE"?m.jsx($h,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):m.jsx(Gh,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"})})]})}),P.type==="BOOK"&&P.coverUrl&&m.jsxs(m.Fragment,{children:[m.jsx("img",{src:P.coverUrl,alt:P.title,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 z-10",onError:Ie=>{Ie.currentTarget.style.display="none";const Ne=Ie.currentTarget.nextElementSibling;Ne&&Ne.classList.add("hidden")}}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/80 via-slate-900/20 to-transparent z-20 pointer-events-none"})]}),P.type!=="BOOK"&&m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-transparent z-20 pointer-events-none"}),m.jsxs("div",{className:"relative z-30 p-1.5 md:p-4 w-full flex justify-between items-end",children:[m.jsx("div",{className:`text-[8px] md:text-xs font-bold px-1 md:px-2 py-0.5 md:py-1 rounded shadow-sm backdrop-blur-md ${P.type==="BOOK"&&P.coverUrl||P.type!=="BOOK"?"bg-white/90 dark:bg-slate-900/90 text-slate-900 dark:text-white border border-white/50 dark:border-slate-700":G[P.readingStatus]}`,children:P.readingStatus}),m.jsxs("div",{className:"flex gap-0.5 md:gap-1",children:[P.type==="BOOK"&&P.status==="Lent Out"&&m.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F59E0B] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lent Out",children:m.jsx(Ko,{size:10,className:"md:w-3 md:h-3"})}),P.type==="BOOK"&&P.status==="Lost"&&m.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F43F5E] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lost",children:m.jsx(Ko,{size:10,className:"md:w-3 md:h-3"})})]})]})]}),m.jsxs("div",{className:"p-2.5 md:p-5 flex-1 flex flex-col",children:[m.jsx("h3",{className:"font-bold text-sm md:text-lg text-slate-900 dark:text-white leading-tight mb-0.5 md:mb-1 line-clamp-2 group-hover:text-[#262D40] dark:group-hover:text-[#262D40] transition-colors",children:P.title}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mb-2 md:mb-4 line-clamp-1",children:P.author}),m.jsxs("div",{className:"mt-auto pt-2 md:pt-4 border-t border-slate-50 dark:border-slate-800 flex justify-between items-center text-[10px] md:text-xs text-slate-400 dark:text-slate-500",children:[m.jsx("span",{className:"truncate max-w-[70%]",children:P.type==="BOOK"?P.publisher||"":P.type==="ARTICLE"?P.publisher||"Journal":(()=>{try{return P.url?new URL(P.url).hostname:"Web"}catch{return"Web"}})()}),P.type==="ARTICLE"&&P.publicationYear&&m.jsx("span",{className:"bg-[#F3F5FA] dark:bg-slate-800 px-1.5 py-0.5 rounded text-slate-500 dark:text-slate-400 font-mono",children:P.publicationYear}),P.type==="WEBSITE"&&P.url&&m.jsx("a",{href:P.url,target:"_blank",rel:"noreferrer",className:"text-[#262D40]/70 hover:text-[#262D40]",onClick:Ie=>Ie.stopPropagation(),children:m.jsx(_0,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]})]},P.id))}),$c()]})},xl=(Q=>{switch(Q){case"DASHBOARD":return V4;case"NOTES":return $4;case"BOOK":return Zx;case"ARTICLE":return $h;case"WEBSITE":return Gh;case"PERSONAL_NOTE":return G4;default:return b4}})(x);return m.jsxs("div",{className:"max-w-6xl w-full mx-auto p-3 md:p-8 lg:p-10 animate-in fade-in duration-500",children:[!M&&m.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-8 gap-2",children:[m.jsxs("div",{className:"flex items-center gap-2 md:gap-4 overflow-hidden flex-1",children:[m.jsx("button",{onClick:v,className:"lg:hidden p-1 -ml-1 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 rounded-lg transition-colors shrink-0",children:m.jsx(JM,{size:18,className:"md:w-6 md:h-6"})}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"hidden md:flex p-2 bg-[#262D40] rounded-xl border border-[#262D40]/80 shadow-sm",children:m.jsx(xl,{size:24,className:"text-white"})}),m.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[m.jsx("h1",{className:"text-lg md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight leading-none truncate",children:Ce(x)}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-[10px] md:text-sm md:mt-1 font-medium truncate",children:V?`${Ae.total} Highlights`:Z?`${Ae.total} Notes`:`${Ae.total} Items  ${Ae.reading} Reading`})]})]})]}),m.jsx("div",{className:"flex gap-2",children:m.jsxs("button",{onClick:()=>{var Q;if(Z&&r){const P=re==="ALL"?"DAILY":re,Ie=J==="ALL"||J==="__ROOT__"?void 0:J;r({category:P,folderId:Ie,folderPath:Ie?(Q=On.get(Ie))==null?void 0:Q.name:void 0});return}n()},className:"bg-[#262D40] text-white px-2 py-1.5 md:px-5 md:py-2.5 rounded-lg hover:bg-[#1d2333] transition-all flex items-center gap-1 shadow-md shadow-[#262D40]/20 dark:shadow-none font-medium shrink-0 active:scale-95",children:[m.jsx(qx,{size:14,className:"md:w-5 md:h-5"}),m.jsxs("span",{className:"text-[10px] md:text-base",children:["Add ",x==="ARTICLE"?"Article":x==="WEBSITE"?"Web":x==="PERSONAL_NOTE"?"Note":"Book"]})]})})]}),!M&&m.jsxs("div",{className:"bg-white dark:bg-slate-900 p-1.5 md:p-4 rounded-xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 mb-2 md:mb-8 flex flex-col md:flex-row gap-2 md:gap-4 w-full",children:[m.jsxs("div",{className:"flex-1 relative",children:[m.jsx(Ka,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-5 md:h-5"}),m.jsx("input",{type:"text",placeholder:se(),value:Ht,onChange:Q=>Kt(Q.target.value),className:`w-full pl-7 md:pl-10 ${V||Z?"pr-10":"pr-4"} md:pr-4 py-1 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] focus:border-transparent outline-none transition-all text-[11px] md:text-base bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500`}),K&&m.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:m.jsx(kn,{size:16,className:"animate-spin text-[#CC561E]"})}),(V||Z)&&m.jsx("button",{onClick:()=>q(le==="FAVORITES"?"ALL":"FAVORITES"),className:`md:hidden absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-lg border transition-all flex items-center justify-center shrink-0 ${le==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500"}`,title:le==="FAVORITES"?"Show All":"Show Favorites Only",children:m.jsx(Zl,{size:14,fill:le==="FAVORITES"?"currentColor":"none"})})]}),(V||Z)&&m.jsx("button",{onClick:()=>q(le==="FAVORITES"?"ALL":"FAVORITES"),className:`hidden md:flex p-2 rounded-lg border transition-all items-center justify-center shrink-0 ${le==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-700"}`,title:le==="FAVORITES"?"Show All":"Show Favorites Only",children:m.jsx(Zl,{size:20,className:"md:w-5 md:h-5",fill:le==="FAVORITES"?"currentColor":"none"})}),!V&&!Z&&m.jsxs("div",{className:"grid grid-cols-2 md:flex gap-2 items-center",children:[m.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[m.jsx(wM,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),m.jsxs("select",{value:le,onChange:Q=>{q(Q.target.value),j(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[m.jsx("option",{value:"ALL",children:"All"}),m.jsx("option",{value:"FAVORITES",children:"Favorites"}),m.jsx("option",{value:"HIGHLIGHTS",children:"Highlight"}),m.jsxs("optgroup",{label:"Status",children:[m.jsx("option",{value:"To Read",children:"To Read"}),m.jsx("option",{value:"Reading",children:"Reading"}),m.jsx("option",{value:"Finished",children:"Finished"})]}),x==="BOOK"&&m.jsxs("optgroup",{label:"Inventory",children:[m.jsx("option",{value:"On Shelf",children:"On Shelf"}),m.jsx("option",{value:"Lent Out",children:"Lent Out"}),m.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),m.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[m.jsx(MD,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),m.jsxs("select",{value:de,onChange:Q=>{ge(Q.target.value),j(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[m.jsx("option",{value:"date_desc",children:"Newest"}),m.jsx("option",{value:"date_asc",children:"Oldest"}),m.jsx("option",{value:"title_asc",children:"A-Z"})]})]}),x==="BOOK"&&m.jsxs("div",{className:"relative min-w-[140px] md:min-w-[180px]",children:[m.jsx(sp,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),m.jsxs("select",{value:k||"",onChange:Q=>I==null?void 0:I(Q.target.value||null),className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[m.jsx("option",{value:"",children:"All categories"}),xp.map(Q=>m.jsx("option",{value:Q,children:Q},Q))]})]}),x==="ARTICLE"&&m.jsx("input",{type:"text",placeholder:"Journal...",value:xe,onChange:Q=>{H(Q.target.value),j(1)},className:"hidden md:block px-4 py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] text-sm min-w-[140px] bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500"})]})]}),x==="BOOK"&&!M&&k&&m.jsxs("div",{className:"flex items-center gap-2 mb-4 md:mb-6",children:[m.jsx("span",{className:"text-xs md:text-sm text-slate-500",children:"Category:"}),m.jsxs("button",{className:"flex items-center gap-2 px-3 py-1 bg-[rgba(204,86,30,0.1)] text-[#CC561E] rounded-full text-xs md:text-sm border border-[#CC561E]/20 shadow-sm",onClick:()=>I==null?void 0:I(null),children:[m.jsx("span",{className:"font-semibold",children:k}),m.jsx(ta,{size:14})]})]}),o1(),Z&&xi&&m.jsxs("div",{className:"fixed bottom-5 right-5 z-50 bg-[#262D40] text-white px-4 py-3 rounded-xl shadow-xl border border-white/10 flex items-center gap-3",children:[m.jsx("span",{className:"text-sm",children:"Note moved."}),m.jsx("button",{onClick:()=>{window.clearTimeout(xi.timeoutId);const Q=xi;Gr(null),et(Q.noteId,Q.category,Q.folderId,!1)},className:"text-sm font-semibold text-[#FFB58D] hover:text-white",children:"Undo"})]})]})});function YV(t,e){var n=Object.setPrototypeOf;n?n(t,e):t.__proto__=e}function ZV(t,e){e===void 0&&(e=t.constructor);var n=Error.captureStackTrace;n&&n(t,e)}var JV=(function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},t(n,r)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),QV=(function(t){JV(e,t);function e(n,r){var i=this.constructor,a=t.call(this,n,r)||this;return Object.defineProperty(a,"name",{value:i.name,enumerable:!1,configurable:!0}),YV(a,i.prototype),ZV(a),a}return e})(Error),e$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),ai=(function(t){e$(e,t);function e(n){n===void 0&&(n=void 0);var r=t.call(this,n)||this;return r.message=n,r}return e.prototype.getKind=function(){var n=this.constructor;return n.kind},e.kind="Exception",e})(QV),t$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Wi=(function(t){t$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e})(ai),n$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),qe=(function(t){n$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e})(ai),r$=(function(){function t(e){if(this.binarizer=e,e===null)throw new qe("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,n){return this.binarizer.getBlackRow(e,n)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,n,r,i){var a=this.binarizer.getLuminanceSource().crop(e,n,r,i);return new t(this.binarizer.createBinarizer(a))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t})(),i$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),tr=(function(t){i$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e})(ai),a$=(function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t})(),Qt=(function(){function t(){}return t.arraycopy=function(e,n,r,i,a){for(;a--;)r[i++]=e[n++]},t.currentTimeMillis=function(){return Date.now()},t})(),o$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),f2=(function(t){o$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e})(ai),s$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),o3=(function(t){s$(e,t);function e(n,r){n===void 0&&(n=void 0),r===void 0&&(r=void 0);var i=t.call(this,r)||this;return i.index=n,i.message=r,i}return e.kind="ArrayIndexOutOfBoundsException",e})(f2),l$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Gn=(function(){function t(){}return t.fill=function(e,n){for(var r=0,i=e.length;r<i;r++)e[r]=n},t.fillWithin=function(e,n,r,i){t.rangeCheck(e.length,n,r);for(var a=n;a<r;a++)e[a]=i},t.rangeCheck=function(e,n,r){if(n>r)throw new qe("fromIndex("+n+") > toIndex("+r+")");if(n<0)throw new o3(n);if(r>e)throw new o3(r)},t.asList=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e},t.create=function(e,n,r){var i=Array.from({length:e});return i.map(function(a){return Array.from({length:n}).fill(r)})},t.createInt32Array=function(e,n,r){var i=Array.from({length:e});return i.map(function(a){return Int32Array.from({length:n}).fill(r)})},t.equals=function(e,n){if(!e||!n||!e.length||!n.length||e.length!==n.length)return!1;for(var r=0,i=e.length;r<i;r++)if(e[r]!==n[r])return!1;return!0},t.hashCode=function(e){var n,r;if(e===null)return 0;var i=1;try{for(var a=l$(e),o=a.next();!o.done;o=a.next()){var s=o.value;i=31*i+s}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},t.fillUint8Array=function(e,n){for(var r=0;r!==e.length;r++)e[r]=n},t.copyOf=function(e,n){return e.slice(0,n)},t.copyOfUint8Array=function(e,n){if(e.length<=n){var r=new Uint8Array(n);return r.set(e),r}return e.slice(0,n)},t.copyOfRange=function(e,n,r){var i=r-n,a=new Int32Array(i);return Qt.arraycopy(e,n,a,0,i),a},t.binarySearch=function(e,n,r){r===void 0&&(r=t.numberComparator);for(var i=0,a=e.length-1;i<=a;){var o=a+i>>1,s=r(n,e[o]);if(s>0)i=o+1;else if(s<0)a=o-1;else return o}return-i-1},t.numberComparator=function(e,n){return e-n},t})(),lt=(function(){function t(){}return t.numberOfTrailingZeros=function(e){var n;if(e===0)return 32;var r=31;return n=e<<16,n!==0&&(r-=16,e=n),n=e<<8,n!==0&&(r-=8,e=n),n=e<<4,n!==0&&(r-=4,e=n),n=e<<2,n!==0&&(r-=2,e=n),r-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var n=1;return e>>>16||(n+=16,e<<=16),e>>>24||(n+=8,e<<=8),e>>>28||(n+=4,e<<=4),e>>>30||(n+=2,e<<=2),n-=e>>>31,n},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,n){return Math.trunc(e/n)},t.parseInt=function(e,n){return n===void 0&&(n=void 0),parseInt(e,n)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t})(),rr=(function(){function t(e,n){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,n==null?this.bits=t.makeArray(e):this.bits=n)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var n=t.makeArray(e);Qt.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var n=this.size;if(e>=n)return n;var r=this.bits,i=Math.floor(e/32),a=r[i];a&=~((1<<(e&31))-1);for(var o=r.length;a===0;){if(++i===o)return n;a=r[i]}var s=i*32+lt.numberOfTrailingZeros(a);return s>n?n:s},t.prototype.getNextUnset=function(e){var n=this.size;if(e>=n)return n;var r=this.bits,i=Math.floor(e/32),a=~r[i];a&=~((1<<(e&31))-1);for(var o=r.length;a===0;){if(++i===o)return n;a=~r[i]}var s=i*32+lt.numberOfTrailingZeros(a);return s>n?n:s},t.prototype.setBulk=function(e,n){this.bits[Math.floor(e/32)]=n},t.prototype.setRange=function(e,n){if(n<e||e<0||n>this.size)throw new qe;if(n!==e){n--;for(var r=Math.floor(e/32),i=Math.floor(n/32),a=this.bits,o=r;o<=i;o++){var s=o>r?0:e&31,c=o<i?31:n&31,d=(2<<c)-(1<<s);a[o]|=d}}},t.prototype.clear=function(){for(var e=this.bits.length,n=this.bits,r=0;r<e;r++)n[r]=0},t.prototype.isRange=function(e,n,r){if(n<e||e<0||n>this.size)throw new qe;if(n===e)return!0;n--;for(var i=Math.floor(e/32),a=Math.floor(n/32),o=this.bits,s=i;s<=a;s++){var c=s>i?0:e&31,d=s<a?31:n&31,h=(2<<d)-(1<<c)&4294967295;if((o[s]&h)!==(r?h:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,n){if(n<0||n>32)throw new qe("Num bits must be between 0 and 32");this.ensureCapacity(this.size+n);for(var r=n;r>0;r--)this.appendBit((e>>r-1&1)===1)},t.prototype.appendBitArray=function(e){var n=e.size;this.ensureCapacity(this.size+n);for(var r=0;r<n;r++)this.appendBit(e.get(r))},t.prototype.xor=function(e){if(this.size!==e.size)throw new qe("Sizes don't match");for(var n=this.bits,r=0,i=n.length;r<i;r++)n[r]^=e.bits[r]},t.prototype.toBytes=function(e,n,r,i){for(var a=0;a<i;a++){for(var o=0,s=0;s<8;s++)this.get(e)&&(o|=1<<7-s),e++;n[r+a]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),n=Math.floor((this.size-1)/32),r=n+1,i=this.bits,a=0;a<r;a++){var o=i[a];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[n-a]=o}if(this.size!==r*32){for(var s=r*32-this.size,c=e[0]>>>s,a=1;a<r;a++){var d=e[a];c|=d<<32-s,e[a-1]=c,c=d>>>s}e[r-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.size===n.size&&Gn.equals(this.bits,n.bits)},t.prototype.hashCode=function(){return 31*this.size+Gn.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",n=0,r=this.size;n<r;n++)(n&7)===0&&(e+=" "),e+=this.get(n)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],n=0,r=this.size;n<r;n++)e.push(this.get(n));return e},t})(),Lv;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(Lv||(Lv={}));const en=Lv;var c$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),De=(function(t){c$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e})(ai),u$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Rt;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(Rt||(Rt={}));var $n=(function(){function t(e,n,r){for(var i,a,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this.valueIdentifier=e,this.name=r,typeof n=="number"?this.values=Int32Array.from([n]):this.values=n,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(r,this);for(var c=this.values,d=0,h=c.length;d!==h;d++){var p=c[d];t.VALUES_TO_ECI.set(p,this)}try{for(var x=u$(o),v=x.next();!v.done;v=x.next()){var b=v.value;t.NAME_TO_ECI.set(b,this)}}catch(C){i={error:C}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new De("incorect value");var n=t.VALUES_TO_ECI.get(e);if(n===void 0)throw new De("incorect value");return n},t.getCharacterSetECIByName=function(e){var n=t.NAME_TO_ECI.get(e);if(n===void 0)throw new De("incorect value");return n},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.getName()===n.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(Rt.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(Rt.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(Rt.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(Rt.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(Rt.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(Rt.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(Rt.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(Rt.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(Rt.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(Rt.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(Rt.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(Rt.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(Rt.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(Rt.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(Rt.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(Rt.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(Rt.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(Rt.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(Rt.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(Rt.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(Rt.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(Rt.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(Rt.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(Rt.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(Rt.Big5,28,"Big5"),t.GB18030=new t(Rt.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(Rt.EUC_KR,30,"EUC_KR","EUC-KR"),t})(),d$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Qh=(function(t){d$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e})(ai),Pi=(function(){function t(){}return t.decode=function(e,n){var r=this.encodingName(n);return this.customDecoder?this.customDecoder(e,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(e,r):new TextDecoder(r).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,n){var r=this.encodingName(n);return this.customEncoder?this.customEncoder(e,r):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof $n?e:$n.getCharacterSetECIByName(e)},t.decodeFallback=function(e,n){var r=this.encodingCharacterSet(n);if(t.isDecodeFallbackSupported(r)){for(var i="",a=0,o=e.length;a<o;a++){var s=e[a].toString(16);s.length<2&&(s="0"+s),i+="%"+s}return decodeURIComponent(i)}if(r.equals($n.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Qh("Encoding "+this.encodingName(n)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals($n.UTF8)||e.equals($n.ISO8859_1)||e.equals($n.ASCII)},t.encodeFallback=function(e){for(var n=btoa(unescape(encodeURIComponent(e))),r=n.split(""),i=[],a=0;a<r.length;a++)i.push(r[a].charCodeAt(0));return new Uint8Array(i)},t})(),xt=(function(){function t(){}return t.castAsNonUtf8Char=function(e,n){n===void 0&&(n=null);var r=n?n.getName():this.ISO88591;return Pi.decode(new Uint8Array([e]),r)},t.guessEncoding=function(e,n){if(n!=null&&n.get(en.CHARACTER_SET)!==void 0)return n.get(en.CHARACTER_SET).toString();for(var r=e.length,i=!0,a=!0,o=!0,s=0,c=0,d=0,h=0,p=0,x=0,v=0,b=0,C=0,E=0,S=0,N=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,k=0;k<r&&(i||a||o);k++){var I=e[k]&255;o&&(s>0?(I&128)===0?o=!1:s--:(I&128)!==0&&((I&64)===0?o=!1:(s++,(I&32)===0?c++:(s++,(I&16)===0?d++:(s++,(I&8)===0?h++:o=!1))))),i&&(I>127&&I<160?i=!1:I>159&&(I<192||I===215||I===247)&&S++),a&&(p>0?I<64||I===127||I>252?a=!1:p--:I===128||I===160||I>239?a=!1:I>160&&I<224?(x++,b=0,v++,v>C&&(C=v)):I>127?(p++,v=0,b++,b>E&&(E=b)):(v=0,b=0))}return o&&s>0&&(o=!1),a&&p>0&&(a=!1),o&&(N||c+d+h>0)?t.UTF8:a&&(t.ASSUME_SHIFT_JIS||C>=3||E>=3)?t.SHIFT_JIS:i&&a?C===2&&x===2||S*10>=r?t.SHIFT_JIS:t.ISO88591:i?t.ISO88591:a?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=-1;function a(s,c,d,h,p,x){if(s==="%%")return"%";if(n[++i]!==void 0){s=h?parseInt(h.substr(1)):void 0;var v=p?parseInt(p.substr(1)):void 0,b;switch(x){case"s":b=n[i];break;case"c":b=n[i][0];break;case"f":b=parseFloat(n[i]).toFixed(s);break;case"p":b=parseFloat(n[i]).toPrecision(s);break;case"e":b=parseFloat(n[i]).toExponential(s);break;case"x":b=parseInt(n[i]).toString(v||16);break;case"d":b=parseFloat(parseInt(n[i],v||10).toPrecision(s)).toFixed(0);break}b=typeof b=="object"?JSON.stringify(b):(+b).toString(v);for(var C=parseInt(d),E=d&&d[0]+""=="0"?"0":" ";b.length<C;)b=c!==void 0?b+E:E+b;return b}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,a)},t.getBytes=function(e,n){return Pi.encode(e,n)},t.getCharCode=function(e,n){return n===void 0&&(n=0),e.charCodeAt(n)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=$n.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=$n.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=$n.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t})(),st=(function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=xt.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,n,r){for(var i=n;n<n+r;i++)this.append(e[i]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,n){this.value=this.value.substr(0,e)+n+this.value.substr(e+1)},t.prototype.substring=function(e,n){return this.value.substring(e,n)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,n){this.value=this.value.substring(0,e)+n+this.value.substring(e)},t})(),wa=(function(){function t(e,n,r,i){if(this.width=e,this.height=n,this.rowSize=r,this.bits=i,n==null&&(n=e),this.height=n,e<1||n<1)throw new qe("Both dimensions must be greater than 0");r==null&&(r=Math.floor((e+31)/32)),this.rowSize=r,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var n=e.length,r=e[0].length,i=new t(r,n),a=0;a<n;a++)for(var o=e[a],s=0;s<r;s++)o[s]&&i.set(s,a);return i},t.parseFromString=function(e,n,r){if(e===null)throw new qe("stringRepresentation cannot be null");for(var i=new Array(e.length),a=0,o=0,s=-1,c=0,d=0;d<e.length;)if(e.charAt(d)===`
`||e.charAt(d)==="\r"){if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new qe("row lengths do not match");o=a,c++}d++}else if(e.substring(d,d+n.length)===n)d+=n.length,i[a]=!0,a++;else if(e.substring(d,d+r.length)===r)d+=r.length,i[a]=!1,a++;else throw new qe("illegal character encountered: "+e.substring(d));if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new qe("row lengths do not match");c++}for(var h=new t(s,c),p=0;p<a;p++)i[p]&&h.set(Math.floor(p%s),Math.floor(p/s));return h},t.prototype.get=function(e,n){var r=n*this.rowSize+Math.floor(e/32);return(this.bits[r]>>>(e&31)&1)!==0},t.prototype.set=function(e,n){var r=n*this.rowSize+Math.floor(e/32);this.bits[r]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,n){var r=n*this.rowSize+Math.floor(e/32);this.bits[r]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,n){var r=n*this.rowSize+Math.floor(e/32);this.bits[r]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new qe("input matrix dimensions do not match");for(var n=new rr(Math.floor(this.width/32)+1),r=this.rowSize,i=this.bits,a=0,o=this.height;a<o;a++)for(var s=a*r,c=e.getRow(a,n).getBitArray(),d=0;d<r;d++)i[s+d]^=c[d]},t.prototype.clear=function(){for(var e=this.bits,n=e.length,r=0;r<n;r++)e[r]=0},t.prototype.setRegion=function(e,n,r,i){if(n<0||e<0)throw new qe("Left and top must be nonnegative");if(i<1||r<1)throw new qe("Height and width must be at least 1");var a=e+r,o=n+i;if(o>this.height||a>this.width)throw new qe("The region must fit inside the matrix");for(var s=this.rowSize,c=this.bits,d=n;d<o;d++)for(var h=d*s,p=e;p<a;p++)c[h+Math.floor(p/32)]|=1<<(p&31)&4294967295},t.prototype.getRow=function(e,n){n==null||n.getSize()<this.width?n=new rr(this.width):n.clear();for(var r=this.rowSize,i=this.bits,a=e*r,o=0;o<r;o++)n.setBulk(o*32,i[a+o]);return n},t.prototype.setRow=function(e,n){Qt.arraycopy(n.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),n=this.getHeight(),r=new rr(e),i=new rr(e),a=0,o=Math.floor((n+1)/2);a<o;a++)r=this.getRow(a,r),i=this.getRow(n-1-a,i),r.reverse(),i.reverse(),this.setRow(a,i),this.setRow(n-1-a,r)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,n=this.height,r=this.rowSize,i=this.bits,a=e,o=n,s=-1,c=-1,d=0;d<n;d++)for(var h=0;h<r;h++){var p=i[d*r+h];if(p!==0){if(d<o&&(o=d),d>c&&(c=d),h*32<a){for(var x=0;(p<<31-x&4294967295)===0;)x++;h*32+x<a&&(a=h*32+x)}if(h*32+31>s){for(var x=31;!(p>>>x);)x--;h*32+x>s&&(s=h*32+x)}}}return s<a||c<o?null:Int32Array.from([a,o,s-a+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,n=this.bits,r=0;r<n.length&&n[r]===0;)r++;if(r===n.length)return null;for(var i=r/e,a=r%e*32,o=n[r],s=0;(o<<31-s&4294967295)===0;)s++;return a+=s,Int32Array.from([a,i])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,n=this.bits,r=n.length-1;r>=0&&n[r]===0;)r--;if(r<0)return null;for(var i=Math.floor(r/e),a=Math.floor(r%e)*32,o=n[r],s=31;!(o>>>s);)s--;return a+=s,Int32Array.from([a,i])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&Gn.equals(this.bits,n.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Gn.hashCode(this.bits),e},t.prototype.toString=function(e,n,r){return e===void 0&&(e="X "),n===void 0&&(n="  "),r===void 0&&(r=`
`),this.buildToString(e,n,r)},t.prototype.buildToString=function(e,n,r){for(var i=new st,a=0,o=this.height;a<o;a++){for(var s=0,c=this.width;s<c;s++)i.append(this.get(s,a)?e:n);i.append(r)}return i.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t})(),f$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),he=(function(t){f$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e})(ai),h$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),p$=(function(t){h$(e,t);function e(n){var r=t.call(this,n)||this;return r.luminances=e.EMPTY,r.buckets=new Int32Array(e.LUMINANCE_BUCKETS),r}return e.prototype.getBlackRow=function(n,r){var i=this.getLuminanceSource(),a=i.getWidth();r==null||r.getSize()<a?r=new rr(a):r.clear(),this.initArrays(a);for(var o=i.getRow(n,this.luminances),s=this.buckets,c=0;c<a;c++)s[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var d=e.estimateBlackPoint(s);if(a<3)for(var c=0;c<a;c++)(o[c]&255)<d&&r.set(c);else for(var h=o[0]&255,p=o[1]&255,c=1;c<a-1;c++){var x=o[c+1]&255;(p*4-h-x)/2<d&&r.set(c),h=p,p=x}return r},e.prototype.getBlackMatrix=function(){var n=this.getLuminanceSource(),r=n.getWidth(),i=n.getHeight(),a=new wa(r,i);this.initArrays(r);for(var o=this.buckets,s=1;s<5;s++)for(var c=Math.floor(i*s/5),d=n.getRow(c,this.luminances),h=Math.floor(r*4/5),p=Math.floor(r/5);p<h;p++){var x=d[p]&255;o[x>>e.LUMINANCE_SHIFT]++}for(var v=e.estimateBlackPoint(o),b=n.getMatrix(),s=0;s<i;s++)for(var C=s*r,p=0;p<r;p++){var x=b[C+p]&255;x<v&&a.set(p,s)}return a},e.prototype.createBinarizer=function(n){return new e(n)},e.prototype.initArrays=function(n){this.luminances.length<n&&(this.luminances=new Uint8ClampedArray(n));for(var r=this.buckets,i=0;i<e.LUMINANCE_BUCKETS;i++)r[i]=0},e.estimateBlackPoint=function(n){for(var r=n.length,i=0,a=0,o=0,s=0;s<r;s++)n[s]>o&&(a=s,o=n[s]),n[s]>i&&(i=n[s]);for(var c=0,d=0,s=0;s<r;s++){var h=s-a,p=n[s]*h*h;p>d&&(c=s,d=p)}if(a>c){var x=a;a=c,c=x}if(c-a<=r/16)throw new he;for(var v=c-1,b=-1,s=c-1;s>a;s--){var C=s-a,p=C*C*(c-s)*(i-n[s]);p>b&&(v=s,b=p)}return v<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e})(a$),m$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),g$=(function(t){m$(e,t);function e(n){var r=t.call(this,n)||this;return r.matrix=null,r}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var n=this.getLuminanceSource(),r=n.getWidth(),i=n.getHeight();if(r>=e.MINIMUM_DIMENSION&&i>=e.MINIMUM_DIMENSION){var a=n.getMatrix(),o=r>>e.BLOCK_SIZE_POWER;(r&e.BLOCK_SIZE_MASK)!==0&&o++;var s=i>>e.BLOCK_SIZE_POWER;(i&e.BLOCK_SIZE_MASK)!==0&&s++;var c=e.calculateBlackPoints(a,o,s,r,i),d=new wa(r,i);e.calculateThresholdForBlock(a,o,s,r,i,c,d),this.matrix=d}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(n){return new e(n)},e.calculateThresholdForBlock=function(n,r,i,a,o,s,c){for(var d=o-e.BLOCK_SIZE,h=a-e.BLOCK_SIZE,p=0;p<i;p++){var x=p<<e.BLOCK_SIZE_POWER;x>d&&(x=d);for(var v=e.cap(p,2,i-3),b=0;b<r;b++){var C=b<<e.BLOCK_SIZE_POWER;C>h&&(C=h);for(var E=e.cap(b,2,r-3),S=0,N=-2;N<=2;N++){var k=s[v+N];S+=k[E-2]+k[E-1]+k[E]+k[E+1]+k[E+2]}var I=S/25;e.thresholdBlock(n,C,x,I,a,c)}}},e.cap=function(n,r,i){return n<r?r:n>i?i:n},e.thresholdBlock=function(n,r,i,a,o,s){for(var c=0,d=i*o+r;c<e.BLOCK_SIZE;c++,d+=o)for(var h=0;h<e.BLOCK_SIZE;h++)(n[d+h]&255)<=a&&s.set(r+h,i+c)},e.calculateBlackPoints=function(n,r,i,a,o){for(var s=o-e.BLOCK_SIZE,c=a-e.BLOCK_SIZE,d=new Array(i),h=0;h<i;h++){d[h]=new Int32Array(r);var p=h<<e.BLOCK_SIZE_POWER;p>s&&(p=s);for(var x=0;x<r;x++){var v=x<<e.BLOCK_SIZE_POWER;v>c&&(v=c);for(var b=0,C=255,E=0,S=0,N=p*a+v;S<e.BLOCK_SIZE;S++,N+=a){for(var k=0;k<e.BLOCK_SIZE;k++){var I=n[N+k]&255;b+=I,I<C&&(C=I),I>E&&(E=I)}if(E-C>e.MIN_DYNAMIC_RANGE)for(S++,N+=a;S<e.BLOCK_SIZE;S++,N+=a)for(var k=0;k<e.BLOCK_SIZE;k++)b+=n[N+k]&255}var D=b>>e.BLOCK_SIZE_POWER*2;if(E-C<=e.MIN_DYNAMIC_RANGE&&(D=C/2,h>0&&x>0)){var L=(d[h-1][x]+2*d[h][x-1]+d[h-1][x-1])/4;C<L&&(D=L)}d[h][x]=D}}return d},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e})(p$),Z0=(function(){function t(e,n){this.width=e,this.height=n}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,n,r,i){throw new Qh("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new Qh("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new Qh("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),n=new st,r=0;r<this.height;r++){for(var i=this.getRow(r,e),a=0;a<this.width;a++){var o=i[a]&255,s=void 0;o<64?s="#":o<128?s="+":o<192?s=".":s=" ",n.append(s)}n.append(`
`)}return n.toString()},t})(),x$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),h2=(function(t){x$(e,t);function e(n){var r=t.call(this,n.getWidth(),n.getHeight())||this;return r.delegate=n,r}return e.prototype.getRow=function(n,r){for(var i=this.delegate.getRow(n,r),a=this.getWidth(),o=0;o<a;o++)i[o]=255-(i[o]&255);return i},e.prototype.getMatrix=function(){for(var n=this.delegate.getMatrix(),r=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(r),a=0;a<r;a++)i[a]=255-(n[a]&255);return i},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(n,r,i,a){return new e(this.delegate.crop(n,r,i,a))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e})(Z0),v$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),y$=(function(t){v$(e,t);function e(n,r){r===void 0&&(r=!1);var i=t.call(this,n.width,n.height)||this;return i.canvas=n,i.tempCanvasElement=null,i.buffer=e.makeBufferFromCanvasImageData(n,r),i}return e.makeBufferFromCanvasImageData=function(n,r){r===void 0&&(r=!1);var i=n.getContext("2d").getImageData(0,0,n.width,n.height);return e.toGrayscaleBuffer(i.data,n.width,n.height,r)},e.toGrayscaleBuffer=function(n,r,i,a){a===void 0&&(a=!1);var o=new Uint8ClampedArray(r*i);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!a)for(var s=0,c=0,d=n.length;s<d;s+=4,c++){var h=void 0,p=n[s+3];if(p===0)h=255;else{var x=n[s],v=n[s+1],b=n[s+2];h=306*x+601*v+117*b+512>>10}o[c]=h}else for(var s=0,c=0,C=n.length;s<C;s+=4,c++){var h=void 0,p=n[s+3];if(p===0)h=255;else{var x=n[s],v=n[s+1],b=n[s+2];h=306*x+601*v+117*b+512>>10}o[c]=255-h}return o},e.prototype.getRow=function(n,r){if(n<0||n>=this.getHeight())throw new qe("Requested row is outside the image: "+n);var i=this.getWidth(),a=n*i;return r===null?r=this.buffer.slice(a,a+i):(r.length<i&&(r=new Uint8ClampedArray(i)),r.set(this.buffer.slice(a,a+i))),r},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(n,r,i,a){return t.prototype.crop.call(this,n,r,i,a),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var n=this.canvas.ownerDocument.createElement("canvas");n.width=this.canvas.width,n.height=this.canvas.height,this.tempCanvasElement=n}return this.tempCanvasElement},e.prototype.rotate=function(n){var r=this.getTempCanvasElement(),i=r.getContext("2d"),a=n*e.DEGREE_TO_RADIANS,o=this.canvas.width,s=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(a))*o+Math.abs(Math.sin(a))*s),d=Math.ceil(Math.abs(Math.sin(a))*o+Math.abs(Math.cos(a))*s);return r.width=c,r.height=d,i.translate(c/2,d/2),i.rotate(a),i.drawImage(this.canvas,o/-2,s/-2),this.buffer=e.makeBufferFromCanvasImageData(r),this},e.prototype.invert=function(){return new h2(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e})(Z0),b$=(function(){function t(e,n,r){this.deviceId=e,this.label=n,this.kind="videoinput",this.groupId=r||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t})(),Br=function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?a(h.value):i(h.value).then(s,c)}d((r=r.apply(t,e||[])).next())})},Fr=function(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(d){return function(h){return c([d,h])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,i=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){n.label=d[1];break}if(d[0]===6&&n.label<a[1]){n.label=a[1],a=d;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(d);break}a[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(h){d=[6,h],i=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},w$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fc=(function(){function t(e,n,r){n===void 0&&(n=500),this.reader=e,this.timeBetweenScansMillis=n,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return Br(this,void 0,void 0,function(){var e,n,r,i,a,o,s,c,d,h,p,x;return Fr(this,function(v){switch(v.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=v.sent(),n=[];try{for(r=w$(e),i=r.next();!i.done;i=r.next())a=i.value,o=a.kind==="video"?"videoinput":a.kind,o==="videoinput"&&(s=a.deviceId||a.id,c=a.label||"Video device "+(n.length+1),d=a.groupId,h={deviceId:s,label:c,kind:o,groupId:d},n.push(h))}catch(b){p={error:b}}finally{try{i&&!i.done&&(x=r.return)&&x.call(r)}finally{if(p)throw p.error}}return[2,n]}})})},t.prototype.getVideoInputDevices=function(){return Br(this,void 0,void 0,function(){var e;return Fr(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=n.sent(),[2,e.map(function(r){return new b$(r.deviceId,r.label)})]}})})},t.prototype.findDeviceById=function(e){return Br(this,void 0,void 0,function(){var n;return Fr(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return n=r.sent(),n?[2,n.find(function(i){return i.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,n){return Br(this,void 0,void 0,function(){return Fr(this,function(r){switch(r.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,n)];case 1:return[2,r.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,n){return Br(this,void 0,void 0,function(){var r,i;return Fr(this,function(a){switch(a.label){case 0:return this.reset(),e?r={deviceId:{exact:e}}:r={facingMode:"environment"},i={video:r},[4,this.decodeOnceFromConstraints(i,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,n){return Br(this,void 0,void 0,function(){var r;return Fr(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=i.sent(),[4,this.decodeOnceFromStream(r,n)];case 2:return[2,i.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,n){return Br(this,void 0,void 0,function(){var r,i;return Fr(this,function(a){switch(a.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,n)];case 1:return r=a.sent(),[4,this.decodeOnce(r)];case 2:return i=a.sent(),[2,i]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,n,r){return Br(this,void 0,void 0,function(){return Fr(this,function(i){switch(i.label){case 0:return[4,this.decodeFromVideoDevice(e,n,r)];case 1:return[2,i.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,n,r){return Br(this,void 0,void 0,function(){var i,a;return Fr(this,function(o){switch(o.label){case 0:return e?i={deviceId:{exact:e}}:i={facingMode:"environment"},a={video:i},[4,this.decodeFromConstraints(a,n,r)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,n,r){return Br(this,void 0,void 0,function(){var i;return Fr(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return i=a.sent(),[4,this.decodeFromStream(i,n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeFromStream=function(e,n,r){return Br(this,void 0,void 0,function(){var i;return Fr(this,function(a){switch(a.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,n)];case 1:return i=a.sent(),[4,this.decodeContinuously(i,r)];case 2:return[2,a.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,n){return Br(this,void 0,void 0,function(){var r;return Fr(this,function(i){switch(i.label){case 0:return r=this.prepareVideoElement(n),this.addVideoSource(r,e),this.videoElement=r,this.stream=e,[4,this.playVideoOnLoadAsync(r)];case 1:return i.sent(),[2,r]}})})},t.prototype.playVideoOnLoadAsync=function(e){var n=this;return new Promise(function(r,i){return n.playVideoOnLoad(e,function(){return r()})})},t.prototype.playVideoOnLoad=function(e,n){var r=this;this.videoEndedListener=function(){return r.stopStreams()},this.videoCanPlayListener=function(){return r.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",n),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return Br(this,void 0,void 0,function(){return Fr(this,function(n){switch(n.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[3,4];case 3:return n.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,n){var r=document.getElementById(e);if(!r)throw new Wi("element with id '"+e+"' not found");if(r.nodeName.toLowerCase()!==n.toLowerCase())throw new Wi("element with id '"+e+"' must be an "+n+" element");return r},t.prototype.decodeFromImage=function(e,n){if(!e&&!n)throw new Wi("either imageElement with a src set or an url must be provided");return n&&!e?this.decodeFromImageUrl(n):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,n){if(!e&&!n)throw new Wi("Either an element with a src set or an URL must be provided");return n&&!e?this.decodeFromVideoUrl(n):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,n,r){if(e===void 0&&n===void 0)throw new Wi("Either an element with a src set or an URL must be provided");return n&&!e?this.decodeFromVideoUrlContinuously(n,r):this.decodeFromVideoElementContinuously(e,r)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Wi("An image element must be provided.");this.reset();var n=this.prepareImageElement(e);this.imageElement=n;var r;return this.isImageLoaded(n)?r=this.decodeOnce(n,!1,!0):r=this._decodeOnLoadImage(n),r},t.prototype.decodeFromVideoElement=function(e){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(n)},t.prototype.decodeFromVideoElementContinuously=function(e,n){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(r,n)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Wi("A video element must be provided.");this.reset();var n=this.prepareVideoElement(e);return this.videoElement=n,n},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Wi("An URL must be provided.");this.reset();var n=this.prepareImageElement();this.imageElement=n;var r=this._decodeOnLoadImage(n);return n.src=e,r},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Wi("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),r=this.decodeFromVideoElement(n);return n.src=e,r},t.prototype.decodeFromVideoUrlContinuously=function(e,n){if(!e)throw new Wi("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),i=this.decodeFromVideoElementContinuously(r,n);return r.src=e,i},t.prototype._decodeOnLoadImage=function(e){var n=this;return new Promise(function(r,i){n.imageLoadedListener=function(){return n.decodeOnce(e,!1,!0).then(r,i)},e.addEventListener("load",n.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return Br(this,void 0,void 0,function(){return Fr(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),[4,this.decodeOnce(e)];case 2:return[2,n.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,n){return Br(this,void 0,void 0,function(){return Fr(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),this.decodeContinuously(e,n),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var n;return typeof e>"u"&&(n=document.createElement("img"),n.width=200,n.height=200),typeof e=="string"&&(n=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(n=e),n},t.prototype.prepareVideoElement=function(e){var n;return!e&&typeof document<"u"&&(n=document.createElement("video"),n.width=200,n.height=200),typeof e=="string"&&(n=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(n=e),n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),n.setAttribute("playsinline","true"),n},t.prototype.decodeOnce=function(e,n,r){var i=this;n===void 0&&(n=!0),r===void 0&&(r=!0),this._stopAsyncDecode=!1;var a=function(o,s){if(i._stopAsyncDecode){s(new he("Video stream has ended before any code could be detected.")),i._stopAsyncDecode=void 0;return}try{var c=i.decode(e);o(c)}catch(x){var d=n&&x instanceof he,h=x instanceof tr||x instanceof De,p=h&&r;if(d||p)return setTimeout(a,i._timeBetweenDecodingAttempts,o,s);s(x)}};return new Promise(function(o,s){return a(o,s)})},t.prototype.decodeContinuously=function(e,n){var r=this;this._stopContinuousDecode=!1;var i=function(){if(r._stopContinuousDecode){r._stopContinuousDecode=void 0;return}try{var a=r.decode(e);n(a,null),setTimeout(i,r.timeBetweenScansMillis)}catch(c){n(null,c);var o=c instanceof tr||c instanceof De,s=c instanceof he;(o||s)&&setTimeout(i,r._timeBetweenDecodingAttempts)}};i()},t.prototype.decode=function(e){var n=this.createBinaryBitmap(e);return this.decodeBitmap(n)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var n=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),n=!0):this.drawImageOnCanvas(e);var r=this.getCaptureCanvas(e),i=new y$(r,n),a=new g$(i);return new r$(a)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var n=this.getCaptureCanvas(e),r=void 0;try{r=n.getContext("2d",{willReadFrequently:!0})}catch{r=n.getContext("2d")}this.captureCanvasContext=r}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var n=this.createCaptureCanvas(e);this.captureCanvas=n}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,n,r){n===void 0&&(n={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),r===void 0&&(r=this.captureCanvasContext),r.drawImage(e,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)},t.prototype.drawImageOnCanvas=function(e,n,r){n===void 0&&(n={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),r===void 0&&(r=this.captureCanvasContext),r.drawImage(e,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var n=document.createElement("canvas"),r,i;return typeof e<"u"&&(e instanceof HTMLVideoElement?(r=e.videoWidth,i=e.videoHeight):e instanceof HTMLImageElement&&(r=e.naturalWidth||e.width,i=e.naturalHeight||e.height)),n.style.width=r+"px",n.style.height=i+"px",n.width=r,n.height=i,n},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,n){try{e.srcObject=n}catch{e.src=URL.createObjectURL(n)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t})(),Dr=(function(){function t(e,n,r,i,a,o){r===void 0&&(r=n==null?0:8*n.length),o===void 0&&(o=Qt.currentTimeMillis()),this.text=e,this.rawBytes=n,this.numBits=r,this.resultPoints=i,this.format=a,this.timestamp=o,this.text=e,this.rawBytes=n,r==null?this.numBits=n==null?0:8*n.length:this.numBits=r,this.resultPoints=i,this.format=a,this.resultMetadata=null,o==null?this.timestamp=Qt.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,n){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,n)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var n=this.resultPoints;if(n===null)this.resultPoints=e;else if(e!==null&&e.length>0){var r=new Array(n.length+e.length);Qt.arraycopy(n,0,r,0,n.length),Qt.arraycopy(e,0,r,n.length,e.length),this.resultPoints=r}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t})(),jv;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(jv||(jv={}));const Ue=jv;var Pv;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Pv||(Pv={}));const wr=Pv;var J0=(function(){function t(e,n,r,i,a,o){a===void 0&&(a=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=n,this.byteSegments=r,this.ecLevel=i,this.structuredAppendSequenceNumber=a,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t})(),Xu=(function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new qe;return this.logTable[e]},t.addOrSubtract=function(e,n){return e^n},t})(),rs=(function(){function t(e,n){if(n.length===0)throw new qe;this.field=e;var r=n.length;if(r>1&&n[0]===0){for(var i=1;i<r&&n[i]===0;)i++;i===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-i),Qt.arraycopy(n,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var n=this.coefficients,r;if(e===1){r=0;for(var i=0,a=n.length;i!==a;i++){var o=n[i];r=Xu.addOrSubtract(r,o)}return r}r=n[0];for(var s=n.length,c=this.field,i=1;i<s;i++)r=Xu.addOrSubtract(c.multiply(e,r),n[i]);return r},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new qe("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var n=this.coefficients,r=e.coefficients;if(n.length>r.length){var i=n;n=r,r=i}var a=new Int32Array(r.length),o=r.length-n.length;Qt.arraycopy(r,0,a,0,o);for(var s=o;s<r.length;s++)a[s]=Xu.addOrSubtract(n[s-o],r[s]);return new t(this.field,a)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new qe("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var n=this.coefficients,r=n.length,i=e.coefficients,a=i.length,o=new Int32Array(r+a-1),s=this.field,c=0;c<r;c++)for(var d=n[c],h=0;h<a;h++)o[c+h]=Xu.addOrSubtract(o[c+h],s.multiply(d,i[h]));return new t(s,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var n=this.coefficients.length,r=this.field,i=new Int32Array(n),a=this.coefficients,o=0;o<n;o++)i[o]=r.multiply(a[o],e);return new t(r,i)},t.prototype.multiplyByMonomial=function(e,n){if(e<0)throw new qe;if(n===0)return this.field.getZero();for(var r=this.coefficients,i=r.length,a=new Int32Array(i+e),o=this.field,s=0;s<i;s++)a[s]=o.multiply(r[s],n);return new t(o,a)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new qe("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new qe("Divide by 0");for(var n=this.field,r=n.getZero(),i=this,a=e.getCoefficient(e.getDegree()),o=n.inverse(a);i.getDegree()>=e.getDegree()&&!i.isZero();){var s=i.getDegree()-e.getDegree(),c=n.multiply(i.getCoefficient(i.getDegree()),o),d=e.multiplyByMonomial(s,c),h=n.buildMonomial(s,c);r=r.addOrSubtract(h),i=i.addOrSubtract(d)}return[r,i]},t.prototype.toString=function(){for(var e="",n=this.getDegree();n>=0;n--){var r=this.getCoefficient(n);if(r!==0){if(r<0?(e+=" - ",r=-r):e.length>0&&(e+=" + "),n===0||r!==1){var i=this.field.log(r);i===0?e+="1":i===1?e+="a":(e+="a^",e+=i)}n!==0&&(n===1?e+="x":(e+="x^",e+=n))}}return e},t})(),C$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),a5=(function(t){C$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e})(ai),E$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),ri=(function(t){E$(e,t);function e(n,r,i){var a=t.call(this)||this;a.primitive=n,a.size=r,a.generatorBase=i;for(var o=new Int32Array(r),s=1,c=0;c<r;c++)o[c]=s,s*=2,s>=r&&(s^=n,s&=r-1);a.expTable=o;for(var d=new Int32Array(r),c=0;c<r-1;c++)d[o[c]]=c;return a.logTable=d,a.zero=new rs(a,Int32Array.from([0])),a.one=new rs(a,Int32Array.from([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(n,r){if(n<0)throw new qe;if(r===0)return this.zero;var i=new Int32Array(n+1);return i[0]=r,new rs(this,i)},e.prototype.inverse=function(n){if(n===0)throw new a5;return this.expTable[this.size-this.logTable[n]-1]},e.prototype.multiply=function(n,r){return n===0||r===0?0:this.expTable[(this.logTable[n]+this.logTable[r])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+lt.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(n){return n===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e})(Xu),S$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Mh=(function(t){S$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e})(ai),A$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Kd=(function(t){A$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e})(ai),Q0=(function(){function t(e){this.field=e}return t.prototype.decode=function(e,n){for(var r=this.field,i=new rs(r,e),a=new Int32Array(n),o=!0,s=0;s<n;s++){var c=i.evaluateAt(r.exp(s+r.getGeneratorBase()));a[a.length-1-s]=c,c!==0&&(o=!1)}if(!o)for(var d=new rs(r,a),h=this.runEuclideanAlgorithm(r.buildMonomial(n,1),d,n),p=h[0],x=h[1],v=this.findErrorLocations(p),b=this.findErrorMagnitudes(x,v),s=0;s<v.length;s++){var C=e.length-1-r.log(v[s]);if(C<0)throw new Mh("Bad error location");e[C]=ri.addOrSubtract(e[C],b[s])}},t.prototype.runEuclideanAlgorithm=function(e,n,r){if(e.getDegree()<n.getDegree()){var i=e;e=n,n=i}for(var a=this.field,o=e,s=n,c=a.getZero(),d=a.getOne();s.getDegree()>=(r/2|0);){var h=o,p=c;if(o=s,c=d,o.isZero())throw new Mh("r_{i-1} was zero");s=h;for(var x=a.getZero(),v=o.getCoefficient(o.getDegree()),b=a.inverse(v);s.getDegree()>=o.getDegree()&&!s.isZero();){var C=s.getDegree()-o.getDegree(),E=a.multiply(s.getCoefficient(s.getDegree()),b);x=x.addOrSubtract(a.buildMonomial(C,E)),s=s.addOrSubtract(o.multiplyByMonomial(C,E))}if(d=x.multiply(c).addOrSubtract(p),s.getDegree()>=o.getDegree())throw new Kd("Division algorithm failed to reduce polynomial?")}var S=d.getCoefficient(0);if(S===0)throw new Mh("sigmaTilde(0) was zero");var N=a.inverse(S),k=d.multiplyScalar(N),I=s.multiplyScalar(N);return[k,I]},t.prototype.findErrorLocations=function(e){var n=e.getDegree();if(n===1)return Int32Array.from([e.getCoefficient(1)]);for(var r=new Int32Array(n),i=0,a=this.field,o=1;o<a.getSize()&&i<n;o++)e.evaluateAt(o)===0&&(r[i]=a.inverse(o),i++);if(i!==n)throw new Mh("Error locator degree does not match number of roots");return r},t.prototype.findErrorMagnitudes=function(e,n){for(var r=n.length,i=new Int32Array(r),a=this.field,o=0;o<r;o++){for(var s=a.inverse(n[o]),c=1,d=0;d<r;d++)if(o!==d){var h=a.multiply(n[d],s),p=(h&1)===0?h|1:h&-2;c=a.multiply(c,p)}i[o]=a.multiply(e.evaluateAt(s),a.inverse(c)),a.getGeneratorBase()!==0&&(i[o]=a.multiply(i[o],s))}return i},t})(),mr;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(mr||(mr={}));var s3=(function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var n=e.getBits(),r=this.extractBits(n),i=this.correctBits(r),a=t.convertBoolArrayToByteArray(i),o=t.getEncodedData(i),s=new J0(a,o,null,null);return s.setNumBits(i.length),s},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var n=e.length,r=mr.UPPER,i=mr.UPPER,a="",o=0;o<n;)if(i===mr.BINARY){if(n-o<5)break;var s=t.readCode(e,o,5);if(o+=5,s===0){if(n-o<11)break;s=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<s;c++){if(n-o<8){o=n;break}var d=t.readCode(e,o,8);a+=xt.castAsNonUtf8Char(d),o+=8}i=r}else{var h=i===mr.DIGIT?4:5;if(n-o<h)break;var d=t.readCode(e,o,h);o+=h;var p=t.getCharacter(i,d);p.startsWith("CTRL_")?(r=i,i=t.getTable(p.charAt(5)),p.charAt(6)==="L"&&(r=i)):(a+=p,i=r)}return a},t.getTable=function(e){switch(e){case"L":return mr.LOWER;case"P":return mr.PUNCT;case"M":return mr.MIXED;case"D":return mr.DIGIT;case"B":return mr.BINARY;case"U":default:return mr.UPPER}},t.getCharacter=function(e,n){switch(e){case mr.UPPER:return t.UPPER_TABLE[n];case mr.LOWER:return t.LOWER_TABLE[n];case mr.MIXED:return t.MIXED_TABLE[n];case mr.PUNCT:return t.PUNCT_TABLE[n];case mr.DIGIT:return t.DIGIT_TABLE[n];default:throw new Kd("Bad table")}},t.prototype.correctBits=function(e){var n,r;this.ddata.getNbLayers()<=2?(r=6,n=ri.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,n=ri.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,n=ri.AZTEC_DATA_10):(r=12,n=ri.AZTEC_DATA_12);var i=this.ddata.getNbDatablocks(),a=e.length/r;if(a<i)throw new De;for(var o=e.length%r,s=new Int32Array(a),c=0;c<a;c++,o+=r)s[c]=t.readCode(e,o,r);try{var d=new Q0(n);d.decode(s,a-i)}catch(E){throw new De(E)}for(var h=(1<<r)-1,p=0,c=0;c<i;c++){var x=s[c];if(x===0||x===h)throw new De;(x===1||x===h-1)&&p++}for(var v=new Array(i*r-p),b=0,c=0;c<i;c++){var x=s[c];if(x===1||x===h-1)v.fill(x>1,b,b+r-1),b+=r-1;else for(var C=r-1;C>=0;--C)v[b++]=(x&1<<C)!==0}return v},t.prototype.extractBits=function(e){var n=this.ddata.isCompact(),r=this.ddata.getNbLayers(),i=(n?11:14)+r*4,a=new Int32Array(i),o=new Array(this.totalBitsInLayer(r,n));if(n)for(var s=0;s<a.length;s++)a[s]=s;else for(var c=i+1+2*lt.truncDivision(lt.truncDivision(i,2)-1,15),d=i/2,h=lt.truncDivision(c,2),s=0;s<d;s++){var p=s+lt.truncDivision(s,15);a[d-s-1]=h-p-1,a[d+s]=h+p+1}for(var s=0,x=0;s<r;s++){for(var v=(r-s)*4+(n?9:12),b=s*2,C=i-1-b,E=0;E<v;E++)for(var S=E*2,N=0;N<2;N++)o[x+S+N]=e.get(a[b+N],a[b+E]),o[x+2*v+S+N]=e.get(a[b+E],a[C-N]),o[x+4*v+S+N]=e.get(a[C-N],a[C-E]),o[x+6*v+S+N]=e.get(a[C-E],a[b+N]);x+=v*8}return o},t.readCode=function(e,n,r){for(var i=0,a=n;a<n+r;a++)i<<=1,e[a]&&(i|=1);return i},t.readByte=function(e,n){var r=e.length-n;return r>=8?t.readCode(e,n,8):t.readCode(e,n,r)<<8-r},t.convertBoolArrayToByteArray=function(e){for(var n=new Uint8Array((e.length+7)/8),r=0;r<n.length;r++)n[r]=t.readByte(e,8*r);return n},t.prototype.totalBitsInLayer=function(e,n){return((n?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t})(),Et=(function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,n,r,i){var a=e-r,o=n-i;return Math.sqrt(a*a+o*o)},t.sum=function(e){for(var n=0,r=0,i=e.length;r!==i;r++){var a=e[r];n+=a}return n},t})(),Bv=(function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t})(),Be=(function(){function t(e,n){this.x=e,this.y=n}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var n=e;return this.x===n.x&&this.y===n.y}return!1},t.prototype.hashCode=function(){return 31*Bv.floatToIntBits(this.x)+Bv.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var n=this.distance(e[0],e[1]),r=this.distance(e[1],e[2]),i=this.distance(e[0],e[2]),a,o,s;if(r>=n&&r>=i?(o=e[0],a=e[1],s=e[2]):i>=r&&i>=n?(o=e[1],a=e[0],s=e[2]):(o=e[2],a=e[0],s=e[1]),this.crossProductZ(a,o,s)<0){var c=a;a=s,s=c}e[0]=a,e[1]=o,e[2]=s},t.distance=function(e,n){return Et.distance(e.x,e.y,n.x,n.y)},t.crossProductZ=function(e,n,r){var i=n.x,a=n.y;return(r.x-i)*(e.y-a)-(r.y-a)*(e.x-i)},t})(),p2=(function(){function t(e,n){this.bits=e,this.points=n}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t})(),_$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),N$=(function(t){_$(e,t);function e(n,r,i,a,o){var s=t.call(this,n,r)||this;return s.compact=i,s.nbDatablocks=a,s.nbLayers=o,s}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e})(p2),Fv=(function(){function t(e,n,r,i){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),n==null&&(n=t.INIT_SIZE),r==null&&(r=e.getWidth()/2|0),i==null&&(i=e.getHeight()/2|0);var a=n/2|0;if(this.leftInit=r-a,this.rightInit=r+a,this.upInit=i-a,this.downInit=i+a,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new he}return t.prototype.detect=function(){for(var e=this.leftInit,n=this.rightInit,r=this.upInit,i=this.downInit,a=!1,o=!0,s=!1,c=!1,d=!1,h=!1,p=!1,x=this.width,v=this.height;o;){o=!1;for(var b=!0;(b||!c)&&n<x;)b=this.containsBlackPoint(r,i,n,!1),b?(n++,o=!0,c=!0):c||n++;if(n>=x){a=!0;break}for(var C=!0;(C||!d)&&i<v;)C=this.containsBlackPoint(e,n,i,!0),C?(i++,o=!0,d=!0):d||i++;if(i>=v){a=!0;break}for(var E=!0;(E||!h)&&e>=0;)E=this.containsBlackPoint(r,i,e,!1),E?(e--,o=!0,h=!0):h||e--;if(e<0){a=!0;break}for(var S=!0;(S||!p)&&r>=0;)S=this.containsBlackPoint(e,n,r,!0),S?(r--,o=!0,p=!0):p||r--;if(r<0){a=!0;break}o&&(s=!0)}if(!a&&s){for(var N=n-e,k=null,I=1;k===null&&I<N;I++)k=this.getBlackPointOnSegment(e,i-I,e+I,i);if(k==null)throw new he;for(var D=null,I=1;D===null&&I<N;I++)D=this.getBlackPointOnSegment(e,r+I,e+I,r);if(D==null)throw new he;for(var L=null,I=1;L===null&&I<N;I++)L=this.getBlackPointOnSegment(n,r+I,n-I,r);if(L==null)throw new he;for(var O=null,I=1;O===null&&I<N;I++)O=this.getBlackPointOnSegment(n,i-I,n-I,i);if(O==null)throw new he;return this.centerEdges(O,k,L,D)}else throw new he},t.prototype.getBlackPointOnSegment=function(e,n,r,i){for(var a=Et.round(Et.distance(e,n,r,i)),o=(r-e)/a,s=(i-n)/a,c=this.image,d=0;d<a;d++){var h=Et.round(e+d*o),p=Et.round(n+d*s);if(c.get(h,p))return new Be(h,p)}return null},t.prototype.centerEdges=function(e,n,r,i){var a=e.getX(),o=e.getY(),s=n.getX(),c=n.getY(),d=r.getX(),h=r.getY(),p=i.getX(),x=i.getY(),v=t.CORR;return a<this.width/2?[new Be(p-v,x+v),new Be(s+v,c+v),new Be(d-v,h-v),new Be(a+v,o-v)]:[new Be(p+v,x+v),new Be(s+v,c-v),new Be(d-v,h+v),new Be(a-v,o-v)]},t.prototype.containsBlackPoint=function(e,n,r,i){var a=this.image;if(i){for(var o=e;o<=n;o++)if(a.get(o,r))return!0}else for(var s=e;s<=n;s++)if(a.get(r,s))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t})(),l3=(function(){function t(){}return t.checkAndNudgePoints=function(e,n){for(var r=e.getWidth(),i=e.getHeight(),a=!0,o=0;o<n.length&&a;o+=2){var s=Math.floor(n[o]),c=Math.floor(n[o+1]);if(s<-1||s>r||c<-1||c>i)throw new he;a=!1,s===-1?(n[o]=0,a=!0):s===r&&(n[o]=r-1,a=!0),c===-1?(n[o+1]=0,a=!0):c===i&&(n[o+1]=i-1,a=!0)}a=!0;for(var o=n.length-2;o>=0&&a;o-=2){var s=Math.floor(n[o]),c=Math.floor(n[o+1]);if(s<-1||s>r||c<-1||c>i)throw new he;a=!1,s===-1?(n[o]=0,a=!0):s===r&&(n[o]=r-1,a=!0),c===-1?(n[o+1]=0,a=!0):c===i&&(n[o+1]=i-1,a=!0)}},t})(),o5=(function(){function t(e,n,r,i,a,o,s,c,d){this.a11=e,this.a21=n,this.a31=r,this.a12=i,this.a22=a,this.a32=o,this.a13=s,this.a23=c,this.a33=d}return t.quadrilateralToQuadrilateral=function(e,n,r,i,a,o,s,c,d,h,p,x,v,b,C,E){var S=t.quadrilateralToSquare(e,n,r,i,a,o,s,c),N=t.squareToQuadrilateral(d,h,p,x,v,b,C,E);return N.times(S)},t.prototype.transformPoints=function(e){for(var n=e.length,r=this.a11,i=this.a12,a=this.a13,o=this.a21,s=this.a22,c=this.a23,d=this.a31,h=this.a32,p=this.a33,x=0;x<n;x+=2){var v=e[x],b=e[x+1],C=a*v+c*b+p;e[x]=(r*v+o*b+d)/C,e[x+1]=(i*v+s*b+h)/C}},t.prototype.transformPointsWithValues=function(e,n){for(var r=this.a11,i=this.a12,a=this.a13,o=this.a21,s=this.a22,c=this.a23,d=this.a31,h=this.a32,p=this.a33,x=e.length,v=0;v<x;v++){var b=e[v],C=n[v],E=a*b+c*C+p;e[v]=(r*b+o*C+d)/E,n[v]=(i*b+s*C+h)/E}},t.squareToQuadrilateral=function(e,n,r,i,a,o,s,c){var d=e-r+a-s,h=n-i+o-c;if(d===0&&h===0)return new t(r-e,a-r,e,i-n,o-i,n,0,0,1);var p=r-a,x=s-a,v=i-o,b=c-o,C=p*b-x*v,E=(d*b-x*h)/C,S=(p*h-d*v)/C;return new t(r-e+E*r,s-e+S*s,e,i-n+E*i,c-n+S*c,n,E,S,1)},t.quadrilateralToSquare=function(e,n,r,i,a,o,s,c){return t.squareToQuadrilateral(e,n,r,i,a,o,s,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t})(),k$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),T$=(function(t){k$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(n,r,i,a,o,s,c,d,h,p,x,v,b,C,E,S,N,k,I){var D=o5.quadrilateralToQuadrilateral(a,o,s,c,d,h,p,x,v,b,C,E,S,N,k,I);return this.sampleGridWithTransform(n,r,i,D)},e.prototype.sampleGridWithTransform=function(n,r,i,a){if(r<=0||i<=0)throw new he;for(var o=new wa(r,i),s=new Float32Array(2*r),c=0;c<i;c++){for(var d=s.length,h=c+.5,p=0;p<d;p+=2)s[p]=p/2+.5,s[p+1]=h;a.transformPoints(s),l3.checkAndNudgePoints(n,s);try{for(var p=0;p<d;p+=2)n.get(Math.floor(s[p]),Math.floor(s[p+1]))&&o.set(p/2,c)}catch{throw new he}}return o},e})(l3),m2=(function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new T$,t})(),ti=(function(){function t(e,n){this.x=e,this.y=n}return t.prototype.toResultPoint=function(){return new Be(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t})(),O$=(function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var n=this.getMatrixCenter(),r=this.getBullsEyeCorners(n);if(e){var i=r[0];r[0]=r[2],r[2]=i}this.extractParameters(r);var a=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),o=this.getMatrixCornerPoints(r);return new N$(a,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new he;var n=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(e[0],e[1],n),this.sampleLine(e[1],e[2],n),this.sampleLine(e[2],e[3],n),this.sampleLine(e[3],e[0],n)]);this.shift=this.getRotation(r,n);for(var i=0,a=0;a<4;a++){var o=r[(this.shift+a)%4];this.compact?(i<<=7,i+=o>>1&127):(i<<=10,i+=(o>>2&992)+(o>>1&31))}var s=this.getCorrectedParameterData(i,this.compact);this.compact?(this.nbLayers=(s>>6)+1,this.nbDataBlocks=(s&63)+1):(this.nbLayers=(s>>11)+1,this.nbDataBlocks=(s&2047)+1)},t.prototype.getRotation=function(e,n){var r=0;e.forEach(function(a,o,s){var c=(a>>n-2<<1)+(a&1);r=(r<<3)+c}),r=((r&1)<<11)+(r>>1);for(var i=0;i<4;i++)if(lt.bitCount(r^this.EXPECTED_CORNER_BITS[i])<=2)return i;throw new he},t.prototype.getCorrectedParameterData=function(e,n){var r,i;n?(r=7,i=2):(r=10,i=4);for(var a=r-i,o=new Int32Array(r),s=r-1;s>=0;--s)o[s]=e&15,e>>=4;try{var c=new Q0(ri.AZTEC_PARAM);c.decode(o,a)}catch{throw new he}for(var d=0,s=0;s<i;s++)d=(d<<4)+o[s];return d},t.prototype.getBullsEyeCorners=function(e){var n=e,r=e,i=e,a=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var s=this.getFirstDifferent(n,o,1,-1),c=this.getFirstDifferent(r,o,1,1),d=this.getFirstDifferent(i,o,-1,1),h=this.getFirstDifferent(a,o,-1,-1);if(this.nbCenterLayers>2){var p=this.distancePoint(h,s)*this.nbCenterLayers/(this.distancePoint(a,n)*(this.nbCenterLayers+2));if(p<.75||p>1.25||!this.isWhiteOrBlackRectangle(s,c,d,h))break}n=s,r=c,i=d,a=h,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new he;this.compact=this.nbCenterLayers===5;var x=new Be(n.getX()+.5,n.getY()-.5),v=new Be(r.getX()+.5,r.getY()+.5),b=new Be(i.getX()-.5,i.getY()+.5),C=new Be(a.getX()-.5,a.getY()-.5);return this.expandSquare([x,v,b,C],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,n,r,i;try{var a=new Fv(this.image).detect();e=a[0],n=a[1],r=a[2],i=a[3]}catch{var o=this.image.getWidth()/2,s=this.image.getHeight()/2;e=this.getFirstDifferent(new ti(o+7,s-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new ti(o+7,s+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ti(o-7,s+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new ti(o-7,s-7),!1,-1,-1).toResultPoint()}var c=Et.round((e.getX()+i.getX()+n.getX()+r.getX())/4),d=Et.round((e.getY()+i.getY()+n.getY()+r.getY())/4);try{var a=new Fv(this.image,15,c,d).detect();e=a[0],n=a[1],r=a[2],i=a[3]}catch{e=this.getFirstDifferent(new ti(c+7,d-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new ti(c+7,d+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ti(c-7,d+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new ti(c-7,d-7),!1,-1,-1).toResultPoint()}return c=Et.round((e.getX()+i.getX()+n.getX()+r.getX())/4),d=Et.round((e.getY()+i.getY()+n.getY()+r.getY())/4),new ti(c,d)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,n,r,i,a){var o=m2.getInstance(),s=this.getDimension(),c=s/2-this.nbCenterLayers,d=s/2+this.nbCenterLayers;return o.sampleGrid(e,s,s,c,c,d,c,d,d,c,d,n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY(),a.getX(),a.getY())},t.prototype.sampleLine=function(e,n,r){for(var i=0,a=this.distanceResultPoint(e,n),o=a/r,s=e.getX(),c=e.getY(),d=o*(n.getX()-e.getX())/a,h=o*(n.getY()-e.getY())/a,p=0;p<r;p++)this.image.get(Et.round(s+p*d),Et.round(c+p*h))&&(i|=1<<r-p-1);return i},t.prototype.isWhiteOrBlackRectangle=function(e,n,r,i){var a=3;e=new ti(e.getX()-a,e.getY()+a),n=new ti(n.getX()-a,n.getY()-a),r=new ti(r.getX()+a,r.getY()-a),i=new ti(i.getX()+a,i.getY()+a);var o=this.getColor(i,e);if(o===0)return!1;var s=this.getColor(e,n);return s!==o||(s=this.getColor(n,r),s!==o)?!1:(s=this.getColor(r,i),s===o)},t.prototype.getColor=function(e,n){for(var r=this.distancePoint(e,n),i=(n.getX()-e.getX())/r,a=(n.getY()-e.getY())/r,o=0,s=e.getX(),c=e.getY(),d=this.image.get(e.getX(),e.getY()),h=Math.ceil(r),p=0;p<h;p++)s+=i,c+=a,this.image.get(Et.round(s),Et.round(c))!==d&&o++;var x=o/r;return x>.1&&x<.9?0:x<=.1===d?1:-1},t.prototype.getFirstDifferent=function(e,n,r,i){for(var a=e.getX()+r,o=e.getY()+i;this.isValid(a,o)&&this.image.get(a,o)===n;)a+=r,o+=i;for(a-=r,o-=i;this.isValid(a,o)&&this.image.get(a,o)===n;)a+=r;for(a-=r;this.isValid(a,o)&&this.image.get(a,o)===n;)o+=i;return o-=i,new ti(a,o)},t.prototype.expandSquare=function(e,n,r){var i=r/(2*n),a=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),s=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,d=new Be(s+i*a,c+i*o),h=new Be(s-i*a,c-i*o);a=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),s=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var p=new Be(s+i*a,c+i*o),x=new Be(s-i*a,c-i*o),v=[d,p,h,x];return v},t.prototype.isValid=function(e,n){return e>=0&&e<this.image.getWidth()&&n>0&&n<this.image.getHeight()},t.prototype.isValidPoint=function(e){var n=Et.round(e.getX()),r=Et.round(e.getY());return this.isValid(n,r)},t.prototype.distancePoint=function(e,n){return Et.distance(e.getX(),e.getY(),n.getX(),n.getY())},t.prototype.distanceResultPoint=function(e,n){return Et.distance(e.getX(),e.getY(),n.getX(),n.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(lt.truncDivision(this.nbLayers-4,8)+1)+15},t})(),zv=(function(){function t(){}return t.prototype.decode=function(e,n){n===void 0&&(n=null);var r=null,i=new O$(e.getBlackMatrix()),a=null,o=null;try{var s=i.detectMirror(!1);a=s.getPoints(),this.reportFoundResultPoints(n,a),o=new s3().decode(s)}catch(p){r=p}if(o==null)try{var s=i.detectMirror(!0);a=s.getPoints(),this.reportFoundResultPoints(n,a),o=new s3().decode(s)}catch(p){throw r??p}var c=new Dr(o.getText(),o.getRawBytes(),o.getNumBits(),a,Ue.AZTEC,Qt.currentTimeMillis()),d=o.getByteSegments();d!=null&&c.putMetadata(wr.BYTE_SEGMENTS,d);var h=o.getECLevel();return h!=null&&c.putMetadata(wr.ERROR_CORRECTION_LEVEL,h),c},t.prototype.reportFoundResultPoints=function(e,n){if(e!=null){var r=e.get(en.NEED_RESULT_POINT_CALLBACK);r!=null&&n.forEach(function(i,a,o){r.foundPossibleResultPoint(i)})}},t.prototype.reset=function(){},t})(),I$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){I$(e,t);function e(n){return n===void 0&&(n=500),t.call(this,new zv,n)||this}return e})(Fc);var Wn=(function(){function t(){}return t.prototype.decode=function(e,n){try{return this.doDecode(e,n)}catch{var r=n&&n.get(en.TRY_HARDER)===!0;if(r&&e.isRotateSupported()){var i=e.rotateCounterClockwise(),a=this.doDecode(i,n),o=a.getResultMetadata(),s=270;o!==null&&o.get(wr.ORIENTATION)===!0&&(s=s+o.get(wr.ORIENTATION)%360),a.putMetadata(wr.ORIENTATION,s);var c=a.getResultPoints();if(c!==null)for(var d=i.getHeight(),h=0;h<c.length;h++)c[h]=new Be(d-c[h].getY()-1,c[h].getX());return a}else throw new he}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,n){var r=e.getWidth(),i=e.getHeight(),a=new rr(r),o=n&&n.get(en.TRY_HARDER)===!0,s=Math.max(1,i>>(o?8:5)),c;o?c=i:c=15;for(var d=Math.trunc(i/2),h=0;h<c;h++){var p=Math.trunc((h+1)/2),x=(h&1)===0,v=d+s*(x?p:-p);if(v<0||v>=i)break;try{a=e.getBlackRow(v,a)}catch{continue}for(var b=function(N){if(N===1&&(a.reverse(),n&&n.get(en.NEED_RESULT_POINT_CALLBACK)===!0)){var k=new Map;n.forEach(function(L,O){return k.set(O,L)}),k.delete(en.NEED_RESULT_POINT_CALLBACK),n=k}try{var I=C.decodeRow(v,a,n);if(N===1){I.putMetadata(wr.ORIENTATION,180);var D=I.getResultPoints();D!==null&&(D[0]=new Be(r-D[0].getX()-1,D[0].getY()),D[1]=new Be(r-D[1].getX()-1,D[1].getY()))}return{value:I}}catch{}},C=this,E=0;E<2;E++){var S=b(E);if(typeof S=="object")return S.value}}throw new he},t.recordPattern=function(e,n,r){for(var i=r.length,a=0;a<i;a++)r[a]=0;var o=e.getSize();if(n>=o)throw new he;for(var s=!e.get(n),c=0,d=n;d<o;){if(e.get(d)!==s)r[c]++;else{if(++c===i)break;r[c]=1,s=!s}d++}if(!(c===i||c===i-1&&d===o))throw new he},t.recordPatternInReverse=function(e,n,r){for(var i=r.length,a=e.get(n);n>0&&i>=0;)e.get(--n)!==a&&(i--,a=!a);if(i>=0)throw new he;t.recordPattern(e,n+1,r)},t.patternMatchVariance=function(e,n,r){for(var i=e.length,a=0,o=0,s=0;s<i;s++)a+=e[s],o+=n[s];if(a<o)return Number.POSITIVE_INFINITY;var c=a/o;r*=c;for(var d=0,h=0;h<i;h++){var p=e[h],x=n[h]*c,v=p>x?p-x:x-p;if(v>r)return Number.POSITIVE_INFINITY;d+=v}return d/a},t})(),D$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),c3=(function(t){D$(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(n){for(var r=n.getSize(),i=n.getNextSet(0),a=0,o=Int32Array.from([0,0,0,0,0,0]),s=i,c=!1,d=6,h=i;h<r;h++)if(n.get(h)!==c)o[a]++;else{if(a===d-1){for(var p=e.MAX_AVG_VARIANCE,x=-1,v=e.CODE_START_A;v<=e.CODE_START_C;v++){var b=Wn.patternMatchVariance(o,e.CODE_PATTERNS[v],e.MAX_INDIVIDUAL_VARIANCE);b<p&&(p=b,x=v)}if(x>=0&&n.isRange(Math.max(0,s-(h-s)/2),s,!1))return Int32Array.from([s,h,x]);s+=o[0]+o[1],o=o.slice(2,o.length),o[a-1]=0,o[a]=0,a--}else a++;o[a]=1,c=!c}throw new he},e.decodeCode=function(n,r,i){Wn.recordPattern(n,i,r);for(var a=e.MAX_AVG_VARIANCE,o=-1,s=0;s<e.CODE_PATTERNS.length;s++){var c=e.CODE_PATTERNS[s],d=this.patternMatchVariance(r,c,e.MAX_INDIVIDUAL_VARIANCE);d<a&&(a=d,o=s)}if(o>=0)return o;throw new he},e.prototype.decodeRow=function(n,r,i){var a=i&&i.get(en.ASSUME_GS1)===!0,o=e.findStartPattern(r),s=o[2],c=0,d=new Uint8Array(20);d[c++]=s;var h;switch(s){case e.CODE_START_A:h=e.CODE_CODE_A;break;case e.CODE_START_B:h=e.CODE_CODE_B;break;case e.CODE_START_C:h=e.CODE_CODE_C;break;default:throw new De}for(var p=!1,x=!1,v="",b=o[0],C=o[1],E=Int32Array.from([0,0,0,0,0,0]),S=0,N=0,k=s,I=0,D=!0,L=!1,O=!1;!p;){var j=x;switch(x=!1,S=N,N=e.decodeCode(r,E,C),d[c++]=N,N!==e.CODE_STOP&&(D=!0),N!==e.CODE_STOP&&(I++,k+=I*N),b=C,C+=E.reduce(function(ie,K){return ie+K},0),N){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new De}switch(h){case e.CODE_CODE_A:if(N<64)O===L?v+=String.fromCharCode(32+N):v+=String.fromCharCode(32+N+128),O=!1;else if(N<96)O===L?v+=String.fromCharCode(N-64):v+=String.fromCharCode(N+64),O=!1;else switch(N!==e.CODE_STOP&&(D=!1),N){case e.CODE_FNC_1:a&&(v.length===0?v+="]C1":v+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!L&&O?(L=!0,O=!1):L&&O?(L=!1,O=!1):O=!0;break;case e.CODE_SHIFT:x=!0,h=e.CODE_CODE_B;break;case e.CODE_CODE_B:h=e.CODE_CODE_B;break;case e.CODE_CODE_C:h=e.CODE_CODE_C;break;case e.CODE_STOP:p=!0;break}break;case e.CODE_CODE_B:if(N<96)O===L?v+=String.fromCharCode(32+N):v+=String.fromCharCode(32+N+128),O=!1;else switch(N!==e.CODE_STOP&&(D=!1),N){case e.CODE_FNC_1:a&&(v.length===0?v+="]C1":v+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!L&&O?(L=!0,O=!1):L&&O?(L=!1,O=!1):O=!0;break;case e.CODE_SHIFT:x=!0,h=e.CODE_CODE_A;break;case e.CODE_CODE_A:h=e.CODE_CODE_A;break;case e.CODE_CODE_C:h=e.CODE_CODE_C;break;case e.CODE_STOP:p=!0;break}break;case e.CODE_CODE_C:if(N<100)N<10&&(v+="0"),v+=N;else switch(N!==e.CODE_STOP&&(D=!1),N){case e.CODE_FNC_1:a&&(v.length===0?v+="]C1":v+="");break;case e.CODE_CODE_A:h=e.CODE_CODE_A;break;case e.CODE_CODE_B:h=e.CODE_CODE_B;break;case e.CODE_STOP:p=!0;break}break}j&&(h=h===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var U=C-b;if(C=r.getNextUnset(C),!r.isRange(C,Math.min(r.getSize(),C+(C-b)/2),!1))throw new he;if(k-=I*S,k%103!==S)throw new tr;var fe=v.length;if(fe===0)throw new he;fe>0&&D&&(h===e.CODE_CODE_C?v=v.substring(0,fe-2):v=v.substring(0,fe-1));for(var le=(o[1]+o[0])/2,q=b+U/2,de=d.length,ge=new Uint8Array(de),xe=0;xe<de;xe++)ge[xe]=d[xe];var H=[new Be(le,n),new Be(q,n)];return new Dr(v,ge,0,H,Ue.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e})(Wn),M$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),ix=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u3=(function(t){M$(e,t);function e(n,r){n===void 0&&(n=!1),r===void 0&&(r=!1);var i=t.call(this)||this;return i.usingCheckDigit=n,i.extendedMode=r,i.decodeRowResult="",i.counters=new Int32Array(9),i}return e.prototype.decodeRow=function(n,r,i){var a,o,s,c,d=this.counters;d.fill(0),this.decodeRowResult="";var h=e.findAsteriskPattern(r,d),p=r.getNextSet(h[1]),x=r.getSize(),v,b;do{e.recordPattern(r,p,d);var C=e.toNarrowWidePattern(d);if(C<0)throw new he;v=e.patternToChar(C),this.decodeRowResult+=v,b=p;try{for(var E=(a=void 0,ix(d)),S=E.next();!S.done;S=E.next()){var N=S.value;p+=N}}catch(de){a={error:de}}finally{try{S&&!S.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}p=r.getNextSet(p)}while(v!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var k=0;try{for(var I=ix(d),D=I.next();!D.done;D=I.next()){var N=D.value;k+=N}}catch(de){s={error:de}}finally{try{D&&!D.done&&(c=I.return)&&c.call(I)}finally{if(s)throw s.error}}var L=p-b-k;if(p!==x&&L*2<k)throw new he;if(this.usingCheckDigit){for(var O=this.decodeRowResult.length-1,j=0,U=0;U<O;U++)j+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(U));if(this.decodeRowResult.charAt(O)!==e.ALPHABET_STRING.charAt(j%43))throw new tr;this.decodeRowResult=this.decodeRowResult.substring(0,O)}if(this.decodeRowResult.length===0)throw new he;var fe;this.extendedMode?fe=e.decodeExtended(this.decodeRowResult):fe=this.decodeRowResult;var le=(h[1]+h[0])/2,q=b+k/2;return new Dr(fe,null,0,[new Be(le,n),new Be(q,n)],Ue.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(n,r){for(var i=n.getSize(),a=n.getNextSet(0),o=0,s=a,c=!1,d=r.length,h=a;h<i;h++)if(n.get(h)!==c)r[o]++;else{if(o===d-1){if(this.toNarrowWidePattern(r)===e.ASTERISK_ENCODING&&n.isRange(Math.max(0,s-Math.floor((h-s)/2)),s,!1))return[s,h];s+=r[0]+r[1],r.copyWithin(0,2,2+o-1),r[o-1]=0,r[o]=0,o--}else o++;r[o]=1,c=!c}throw new he},e.toNarrowWidePattern=function(n){var r,i,a=n.length,o=0,s;do{var c=2147483647;try{for(var d=(r=void 0,ix(n)),h=d.next();!h.done;h=d.next()){var p=h.value;p<c&&p>o&&(c=p)}}catch(C){r={error:C}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}o=c,s=0;for(var x=0,v=0,b=0;b<a;b++){var p=n[b];p>o&&(v|=1<<a-1-b,s++,x+=p)}if(s===3){for(var b=0;b<a&&s>0;b++){var p=n[b];if(p>o&&(s--,p*2>=x))return-1}return v}}while(s>3);return-1},e.patternToChar=function(n){for(var r=0;r<e.CHARACTER_ENCODINGS.length;r++)if(e.CHARACTER_ENCODINGS[r]===n)return e.ALPHABET_STRING.charAt(r);if(n===e.ASTERISK_ENCODING)return"*";throw new he},e.decodeExtended=function(n){for(var r=n.length,i="",a=0;a<r;a++){var o=n.charAt(a);if(o==="+"||o==="$"||o==="%"||o==="/"){var s=n.charAt(a+1),c="\0";switch(o){case"+":if(s>="A"&&s<="Z")c=String.fromCharCode(s.charCodeAt(0)+32);else throw new De;break;case"$":if(s>="A"&&s<="Z")c=String.fromCharCode(s.charCodeAt(0)-64);else throw new De;break;case"%":if(s>="A"&&s<="E")c=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")c=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")c=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")c=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")c="\0";else if(s==="V")c="@";else if(s==="W")c="`";else if(s==="X"||s==="Y"||s==="Z")c="";else throw new De;break;case"/":if(s>="A"&&s<="O")c=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")c=":";else throw new De;break}i+=c,a++}else i+=o}return i},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e})(Wn),R$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),ax=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d3=(function(t){R$(e,t);function e(){var n=t.call(this)||this;return n.decodeRowResult="",n.counters=new Int32Array(6),n}return e.prototype.decodeRow=function(n,r,i){var a,o,s,c,d=this.findAsteriskPattern(r),h=r.getNextSet(d[1]),p=r.getSize(),x=this.counters;x.fill(0),this.decodeRowResult="";var v,b;do{e.recordPattern(r,h,x);var C=this.toPattern(x);if(C<0)throw new he;v=this.patternToChar(C),this.decodeRowResult+=v,b=h;try{for(var E=(a=void 0,ax(x)),S=E.next();!S.done;S=E.next()){var N=S.value;h+=N}}catch(U){a={error:U}}finally{try{S&&!S.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}h=r.getNextSet(h)}while(v!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var k=0;try{for(var I=ax(x),D=I.next();!D.done;D=I.next()){var N=D.value;k+=N}}catch(U){s={error:U}}finally{try{D&&!D.done&&(c=I.return)&&c.call(I)}finally{if(s)throw s.error}}if(h===p||!r.get(h))throw new he;if(this.decodeRowResult.length<2)throw new he;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var L=this.decodeExtended(this.decodeRowResult),O=(d[1]+d[0])/2,j=b+k/2;return new Dr(L,null,0,[new Be(O,n),new Be(j,n)],Ue.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(n){var r=n.getSize(),i=n.getNextSet(0);this.counters.fill(0);for(var a=this.counters,o=i,s=!1,c=a.length,d=0,h=i;h<r;h++)if(n.get(h)!==s)a[d]++;else{if(d===c-1){if(this.toPattern(a)===e.ASTERISK_ENCODING)return new Int32Array([o,h]);o+=a[0]+a[1],a.copyWithin(0,2,2+d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,s=!s}throw new he},e.prototype.toPattern=function(n){var r,i,a=0;try{for(var o=ax(n),s=o.next();!s.done;s=o.next()){var c=s.value;a+=c}}catch(b){r={error:b}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}for(var d=0,h=n.length,p=0;p<h;p++){var x=Math.round(n[p]*9/a);if(x<1||x>4)return-1;if((p&1)===0)for(var v=0;v<x;v++)d=d<<1|1;else d<<=x}return d},e.prototype.patternToChar=function(n){for(var r=0;r<e.CHARACTER_ENCODINGS.length;r++)if(e.CHARACTER_ENCODINGS[r]===n)return e.ALPHABET_STRING.charAt(r);throw new he},e.prototype.decodeExtended=function(n){for(var r=n.length,i="",a=0;a<r;a++){var o=n.charAt(a);if(o>="a"&&o<="d"){if(a>=r-1)throw new De;var s=n.charAt(a+1),c="\0";switch(o){case"d":if(s>="A"&&s<="Z")c=String.fromCharCode(s.charCodeAt(0)+32);else throw new De;break;case"a":if(s>="A"&&s<="Z")c=String.fromCharCode(s.charCodeAt(0)-64);else throw new De;break;case"b":if(s>="A"&&s<="E")c=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")c=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")c=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")c=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")c="\0";else if(s==="V")c="@";else if(s==="W")c="`";else if(s>="X"&&s<="Z")c="";else throw new De;break;case"c":if(s>="A"&&s<="O")c=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")c=":";else throw new De;break}i+=c,a++}else i+=o}return i},e.prototype.checkChecksums=function(n){var r=n.length;this.checkOneChecksum(n,r-2,20),this.checkOneChecksum(n,r-1,15)},e.prototype.checkOneChecksum=function(n,r,i){for(var a=1,o=0,s=r-1;s>=0;s--)o+=a*e.ALPHABET_STRING.indexOf(n.charAt(s)),++a>i&&(a=1);if(n.charAt(r)!==e.ALPHABET_STRING[o%47])throw new tr},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e})(Wn),L$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),j$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f3=(function(t){L$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.narrowLineWidth=-1,n}return e.prototype.decodeRow=function(n,r,i){var a,o,s=this.decodeStart(r),c=this.decodeEnd(r),d=new st;e.decodeMiddle(r,s[1],c[0],d);var h=d.toString(),p=null;i!=null&&(p=i.get(en.ALLOWED_LENGTHS)),p==null&&(p=e.DEFAULT_ALLOWED_LENGTHS);var x=h.length,v=!1,b=0;try{for(var C=j$(p),E=C.next();!E.done;E=C.next()){var S=E.value;if(x===S){v=!0;break}S>b&&(b=S)}}catch(I){a={error:I}}finally{try{E&&!E.done&&(o=C.return)&&o.call(C)}finally{if(a)throw a.error}}if(!v&&x>b&&(v=!0),!v)throw new De;var N=[new Be(s[1],n),new Be(c[0],n)],k=new Dr(h,null,0,N,Ue.ITF,new Date().getTime());return k},e.decodeMiddle=function(n,r,i,a){var o=new Int32Array(10),s=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),s.fill(0),c.fill(0);r<i;){Wn.recordPattern(n,r,o);for(var d=0;d<5;d++){var h=2*d;s[d]=o[h],c[d]=o[h+1]}var p=e.decodeDigit(s);a.append(p.toString()),p=this.decodeDigit(c),a.append(p.toString()),o.forEach(function(x){r+=x})}},e.prototype.decodeStart=function(n){var r=e.skipWhiteSpace(n),i=e.findGuardPattern(n,r,e.START_PATTERN);return this.narrowLineWidth=(i[1]-i[0])/4,this.validateQuietZone(n,i[0]),i},e.prototype.validateQuietZone=function(n,r){var i=this.narrowLineWidth*10;i=i<r?i:r;for(var a=r-1;i>0&&a>=0&&!n.get(a);a--)i--;if(i!==0)throw new he},e.skipWhiteSpace=function(n){var r=n.getSize(),i=n.getNextSet(0);if(i===r)throw new he;return i},e.prototype.decodeEnd=function(n){n.reverse();try{var r=e.skipWhiteSpace(n),i=void 0;try{i=e.findGuardPattern(n,r,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof he&&(i=e.findGuardPattern(n,r,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(n,i[0]);var a=i[0];return i[0]=n.getSize()-i[1],i[1]=n.getSize()-a,i}finally{n.reverse()}},e.findGuardPattern=function(n,r,i){var a=i.length,o=new Int32Array(a),s=n.getSize(),c=!1,d=0,h=r;o.fill(0);for(var p=r;p<s;p++)if(n.get(p)!==c)o[d]++;else{if(d===a-1){if(Wn.patternMatchVariance(o,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[h,p];h+=o[0]+o[1],Qt.arraycopy(o,2,o,0,d-1),o[d-1]=0,o[d]=0,d--}else d++;o[d]=1,c=!c}throw new he},e.decodeDigit=function(n){for(var r=e.MAX_AVG_VARIANCE,i=-1,a=e.PATTERNS.length,o=0;o<a;o++){var s=e.PATTERNS[o],c=Wn.patternMatchVariance(n,s,e.MAX_INDIVIDUAL_VARIANCE);c<r?(r=c,i=o):c===r&&(i=-1)}if(i>=0)return i%10;throw new he},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e})(Wn),P$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Oc=(function(t){P$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.decodeRowStringBuffer="",n}return e.findStartGuardPattern=function(n){for(var r=!1,i,a=0,o=Int32Array.from([0,0,0]);!r;){o=Int32Array.from([0,0,0]),i=e.findGuardPattern(n,a,!1,this.START_END_PATTERN,o);var s=i[0];a=i[1];var c=s-(a-s);c>=0&&(r=n.isRange(c,s,!1))}return i},e.checkChecksum=function(n){return e.checkStandardUPCEANChecksum(n)},e.checkStandardUPCEANChecksum=function(n){var r=n.length;if(r===0)return!1;var i=parseInt(n.charAt(r-1),10);return e.getStandardUPCEANChecksum(n.substring(0,r-1))===i},e.getStandardUPCEANChecksum=function(n){for(var r=n.length,i=0,a=r-1;a>=0;a-=2){var o=n.charAt(a).charCodeAt(0)-48;if(o<0||o>9)throw new De;i+=o}i*=3;for(var a=r-2;a>=0;a-=2){var o=n.charAt(a).charCodeAt(0)-48;if(o<0||o>9)throw new De;i+=o}return(1e3-i)%10},e.decodeEnd=function(n,r){return e.findGuardPattern(n,r,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(n,r,i,a){return this.findGuardPattern(n,r,i,a,new Int32Array(a.length))},e.findGuardPattern=function(n,r,i,a,o){var s=n.getSize();r=i?n.getNextUnset(r):n.getNextSet(r);for(var c=0,d=r,h=a.length,p=i,x=r;x<s;x++)if(n.get(x)!==p)o[c]++;else{if(c===h-1){if(Wn.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([d,x]);d+=o[0]+o[1];for(var v=o.slice(2,o.length),b=0;b<c-1;b++)o[b]=v[b];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,p=!p}throw new he},e.decodeDigit=function(n,r,i,a){this.recordPattern(n,i,r);for(var o=this.MAX_AVG_VARIANCE,s=-1,c=a.length,d=0;d<c;d++){var h=a[d],p=Wn.patternMatchVariance(r,h,e.MAX_INDIVIDUAL_VARIANCE);p<o&&(o=p,s=d)}if(s>=0)return s;throw new he},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e})(Wn),B$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},F$=(function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,n,r){var i=this.decodeRowStringBuffer,a=this.decodeMiddle(n,r,i),o=i.toString(),s=t.parseExtensionString(o),c=[new Be((r[0]+r[1])/2,e),new Be(a,e)],d=new Dr(o,null,0,c,Ue.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&d.putAllMetadata(s),d},t.prototype.decodeMiddle=function(e,n,r){var i,a,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),c=n[1],d=0,h=0;h<5&&c<s;h++){var p=Oc.decodeDigit(e,o,c,Oc.L_AND_G_PATTERNS);r+=String.fromCharCode(48+p%10);try{for(var x=(i=void 0,B$(o)),v=x.next();!v.done;v=x.next()){var b=v.value;c+=b}}catch(E){i={error:E}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}p>=10&&(d|=1<<4-h),h!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(r.length!==5)throw new he;var C=this.determineCheckDigit(d);if(t.extensionChecksum(r.toString())!==C)throw new he;return c},t.extensionChecksum=function(e){for(var n=e.length,r=0,i=n-2;i>=0;i-=2)r+=e.charAt(i).charCodeAt(0)-48;r*=3;for(var i=n-1;i>=0;i-=2)r+=e.charAt(i).charCodeAt(0)-48;return r*=3,r%10},t.prototype.determineCheckDigit=function(e){for(var n=0;n<10;n++)if(e===this.CHECK_DIGIT_ENCODINGS[n])return n;throw new he},t.parseExtensionString=function(e){if(e.length!==5)return null;var n=t.parseExtension5String(e);return n==null?null:new Map([[wr.SUGGESTED_PRICE,n]])},t.parseExtension5String=function(e){var n;switch(e.charAt(0)){case"0":n="";break;case"5":n="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}n="";break;default:n="";break}var r=parseInt(e.substring(1)),i=(r/100).toString(),a=r%100,o=a<10?"0"+a:a.toString();return n+i+"."+o},t})(),z$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},U$=(function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,n,r){var i=this.decodeRowStringBuffer,a=this.decodeMiddle(n,r,i),o=i.toString(),s=t.parseExtensionString(o),c=[new Be((r[0]+r[1])/2,e),new Be(a,e)],d=new Dr(o,null,0,c,Ue.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&d.putAllMetadata(s),d},t.prototype.decodeMiddle=function(e,n,r){var i,a,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),c=n[1],d=0,h=0;h<2&&c<s;h++){var p=Oc.decodeDigit(e,o,c,Oc.L_AND_G_PATTERNS);r+=String.fromCharCode(48+p%10);try{for(var x=(i=void 0,z$(o)),v=x.next();!v.done;v=x.next()){var b=v.value;c+=b}}catch(C){i={error:C}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}p>=10&&(d|=1<<1-h),h!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(r.length!==2)throw new he;if(parseInt(r.toString())%4!==d)throw new he;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[wr.ISSUE_NUMBER,parseInt(e)]])},t})(),H$=(function(){function t(){}return t.decodeRow=function(e,n,r){var i=Oc.findGuardPattern(n,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var a=new F$;return a.decodeRow(e,n,i)}catch{var o=new U$;return o.decodeRow(e,n,i)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t})(),V$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Hn=(function(t){V$(e,t);function e(){var n=t.call(this)||this;n.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(s){return Int32Array.from(s)});for(var r=10;r<20;r++){for(var i=e.L_PATTERNS[r-10],a=new Int32Array(i.length),o=0;o<i.length;o++)a[o]=i[i.length-o-1];e.L_AND_G_PATTERNS[r]=a}return n}return e.prototype.decodeRow=function(n,r,i){var a=e.findStartGuardPattern(r),o=i==null?null:i.get(en.NEED_RESULT_POINT_CALLBACK);if(o!=null){var s=new Be((a[0]+a[1])/2,n);o.foundPossibleResultPoint(s)}var c=this.decodeMiddle(r,a,this.decodeRowStringBuffer),d=c.rowOffset,h=c.resultString;if(o!=null){var p=new Be(d,n);o.foundPossibleResultPoint(p)}var x=e.decodeEnd(r,d);if(o!=null){var v=new Be((x[0]+x[1])/2,n);o.foundPossibleResultPoint(v)}var b=x[1],C=b+(b-x[0]);if(C>=r.getSize()||!r.isRange(b,C,!1))throw new he;var E=h.toString();if(E.length<8)throw new De;if(!e.checkChecksum(E))throw new tr;var S=(a[1]+a[0])/2,N=(x[1]+x[0])/2,k=this.getBarcodeFormat(),I=[new Be(S,n),new Be(N,n)],D=new Dr(E,null,0,I,k,new Date().getTime()),L=0;try{var O=H$.decodeRow(n,r,x[1]);D.putMetadata(wr.UPC_EAN_EXTENSION,O.getText()),D.putAllMetadata(O.getResultMetadata()),D.addResultPoints(O.getResultPoints()),L=O.getText().length}catch{}var j=i==null?null:i.get(en.ALLOWED_EAN_EXTENSIONS);if(j!=null){var U=!1;for(var fe in j)if(L.toString()===fe){U=!0;break}if(!U)throw new he}return k===Ue.EAN_13||Ue.UPC_A,D},e.checkChecksum=function(n){return e.checkStandardUPCEANChecksum(n)},e.checkStandardUPCEANChecksum=function(n){var r=n.length;if(r===0)return!1;var i=parseInt(n.charAt(r-1),10);return e.getStandardUPCEANChecksum(n.substring(0,r-1))===i},e.getStandardUPCEANChecksum=function(n){for(var r=n.length,i=0,a=r-1;a>=0;a-=2){var o=n.charAt(a).charCodeAt(0)-48;if(o<0||o>9)throw new De;i+=o}i*=3;for(var a=r-2;a>=0;a-=2){var o=n.charAt(a).charCodeAt(0)-48;if(o<0||o>9)throw new De;i+=o}return(1e3-i)%10},e.decodeEnd=function(n,r){return e.findGuardPattern(n,r,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e})(Oc),$$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),h3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Uv=(function(t){$$(e,t);function e(){var n=t.call(this)||this;return n.decodeMiddleCounters=Int32Array.from([0,0,0,0]),n}return e.prototype.decodeMiddle=function(n,r,i){var a,o,s,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var h=n.getSize(),p=r[1],x=0,v=0;v<6&&p<h;v++){var b=Hn.decodeDigit(n,d,p,Hn.L_AND_G_PATTERNS);i+=String.fromCharCode(48+b%10);try{for(var C=(a=void 0,h3(d)),E=C.next();!E.done;E=C.next()){var S=E.value;p+=S}}catch(D){a={error:D}}finally{try{E&&!E.done&&(o=C.return)&&o.call(C)}finally{if(a)throw a.error}}b>=10&&(x|=1<<5-v)}i=e.determineFirstDigit(i,x);var N=Hn.findGuardPattern(n,p,!0,Hn.MIDDLE_PATTERN,new Int32Array(Hn.MIDDLE_PATTERN.length).fill(0));p=N[1];for(var v=0;v<6&&p<h;v++){var b=Hn.decodeDigit(n,d,p,Hn.L_PATTERNS);i+=String.fromCharCode(48+b);try{for(var k=(s=void 0,h3(d)),I=k.next();!I.done;I=k.next()){var S=I.value;p+=S}}catch(O){s={error:O}}finally{try{I&&!I.done&&(c=k.return)&&c.call(k)}finally{if(s)throw s.error}}}return{rowOffset:p,resultString:i}},e.prototype.getBarcodeFormat=function(){return Ue.EAN_13},e.determineFirstDigit=function(n,r){for(var i=0;i<10;i++)if(r===this.FIRST_DIGIT_ENCODINGS[i])return n=String.fromCharCode(48+i)+n,n;throw new he},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e})(Hn),G$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),p3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m3=(function(t){G$(e,t);function e(){var n=t.call(this)||this;return n.decodeMiddleCounters=Int32Array.from([0,0,0,0]),n}return e.prototype.decodeMiddle=function(n,r,i){var a,o,s,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var h=n.getSize(),p=r[1],x=0;x<4&&p<h;x++){var v=Hn.decodeDigit(n,d,p,Hn.L_PATTERNS);i+=String.fromCharCode(48+v);try{for(var b=(a=void 0,p3(d)),C=b.next();!C.done;C=b.next()){var E=C.value;p+=E}}catch(I){a={error:I}}finally{try{C&&!C.done&&(o=b.return)&&o.call(b)}finally{if(a)throw a.error}}}var S=Hn.findGuardPattern(n,p,!0,Hn.MIDDLE_PATTERN,new Int32Array(Hn.MIDDLE_PATTERN.length).fill(0));p=S[1];for(var x=0;x<4&&p<h;x++){var v=Hn.decodeDigit(n,d,p,Hn.L_PATTERNS);i+=String.fromCharCode(48+v);try{for(var N=(s=void 0,p3(d)),k=N.next();!k.done;k=N.next()){var E=k.value;p+=E}}catch(L){s={error:L}}finally{try{k&&!k.done&&(c=N.return)&&c.call(N)}finally{if(s)throw s.error}}}return{rowOffset:p,resultString:i}},e.prototype.getBarcodeFormat=function(){return Ue.EAN_8},e})(Hn),W$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),g3=(function(t){W$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.ean13Reader=new Uv,n}return e.prototype.getBarcodeFormat=function(){return Ue.UPC_A},e.prototype.decode=function(n,r){return this.maybeReturnResult(this.ean13Reader.decode(n))},e.prototype.decodeRow=function(n,r,i){return this.maybeReturnResult(this.ean13Reader.decodeRow(n,r,i))},e.prototype.decodeMiddle=function(n,r,i){return this.ean13Reader.decodeMiddle(n,r,i)},e.prototype.maybeReturnResult=function(n){var r=n.getText();if(r.charAt(0)==="0"){var i=new Dr(r.substring(1),null,null,n.getResultPoints(),Ue.UPC_A);return n.getResultMetadata()!=null&&i.putAllMetadata(n.getResultMetadata()),i}else throw new he},e.prototype.reset=function(){this.ean13Reader.reset()},e})(Hn),q$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),X$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},x3=(function(t){q$(e,t);function e(){var n=t.call(this)||this;return n.decodeMiddleCounters=new Int32Array(4),n}return e.prototype.decodeMiddle=function(n,r,i){var a,o,s=this.decodeMiddleCounters.map(function(E){return E});s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var c=n.getSize(),d=r[1],h=0,p=0;p<6&&d<c;p++){var x=e.decodeDigit(n,s,d,e.L_AND_G_PATTERNS);i+=String.fromCharCode(48+x%10);try{for(var v=(a=void 0,X$(s)),b=v.next();!b.done;b=v.next()){var C=b.value;d+=C}}catch(E){a={error:E}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}x>=10&&(h|=1<<5-p)}return e.determineNumSysAndCheckDigit(new st(i),h),d},e.prototype.decodeEnd=function(n,r){return e.findGuardPatternWithoutCounters(n,r,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(n){return Hn.checkChecksum(e.convertUPCEtoUPCA(n))},e.determineNumSysAndCheckDigit=function(n,r){for(var i=0;i<=1;i++)for(var a=0;a<10;a++)if(r===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[i][a]){n.insert(0,"0"+i),n.append("0"+a);return}throw he.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return Ue.UPC_E},e.convertUPCEtoUPCA=function(n){var r=n.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),i=new st;i.append(n.charAt(0));var a=r[5];switch(a){case 0:case 1:case 2:i.appendChars(r,0,2),i.append(a),i.append("0000"),i.appendChars(r,2,3);break;case 3:i.appendChars(r,0,3),i.append("00000"),i.appendChars(r,3,2);break;case 4:i.appendChars(r,0,4),i.append("00000"),i.append(r[4]);break;default:i.appendChars(r,0,5),i.append("0000"),i.append(a);break}return n.length>=8&&i.append(n.charAt(7)),i.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e})(Hn),K$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),v3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ox=(function(t){K$(e,t);function e(n){var r=t.call(this)||this,i=n==null?null:n.get(en.POSSIBLE_FORMATS),a=[];return i!=null&&(i.indexOf(Ue.EAN_13)>-1&&a.push(new Uv),i.indexOf(Ue.UPC_A)>-1&&a.push(new g3),i.indexOf(Ue.EAN_8)>-1&&a.push(new m3),i.indexOf(Ue.UPC_E)>-1&&a.push(new x3)),a.length===0&&(a.push(new Uv),a.push(new g3),a.push(new m3),a.push(new x3)),r.readers=a,r}return e.prototype.decodeRow=function(n,r,i){var a,o;try{for(var s=v3(this.readers),c=s.next();!c.done;c=s.next()){var d=c.value;try{var h=d.decodeRow(n,r,i),p=h.getBarcodeFormat()===Ue.EAN_13&&h.getText().charAt(0)==="0",x=i==null?null:i.get(en.POSSIBLE_FORMATS),v=x==null||x.includes(Ue.UPC_A);if(p&&v){var b=h.getRawBytes(),C=new Dr(h.getText().substring(1),b,b?b.length:null,h.getResultPoints(),Ue.UPC_A);return C.putAllMetadata(h.getResultMetadata()),C}return h}catch{}}}catch(E){a={error:E}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}throw new he},e.prototype.reset=function(){var n,r;try{for(var i=v3(this.readers),a=i.next();!a.done;a=i.next()){var o=a.value;o.reset()}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e})(Wn),Y$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Z$=(function(t){Y$(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},n}return e.prototype.decodeRow=function(n,r,i){var a=this.getValidRowData(r);if(!a)throw new he;var o=this.codaBarDecodeRow(a.row);if(!o)throw new he;return new Dr(o,null,0,[new Be(a.left,n),new Be(a.right,n)],Ue.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(n){var r=n.toArray(),i=r.indexOf(!0);if(i===-1)return null;var a=r.lastIndexOf(!0);if(a<=i)return null;r=r.slice(i,a+1);for(var o=[],s=r[0],c=1,d=1;d<r.length;d++)r[d]===s?c++:(s=r[d],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:i,right:a}},e.prototype.codaBarDecodeRow=function(n){for(var r=[],i=Math.ceil(n.reduce(function(c,d){return(c+d)/2},0));n.length>0;){var a=n.splice(0,8).splice(0,7),o=a.map(function(c){return c<i?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;r.push(this.CODA_BAR_CHAR_SET[o])}var s=r.join("");return this.validCodaBarString(s)?s:null},e.prototype.validCodaBarString=function(n){var r=/^[A-D].{1,}[A-D]$/;return r.test(n)},e})(Wn),J$=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Q$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Us=(function(t){J$(e,t);function e(){var n=t.call(this)||this;return n.decodeFinderCounters=new Int32Array(4),n.dataCharacterCounters=new Int32Array(8),n.oddRoundingErrors=new Array(4),n.evenRoundingErrors=new Array(4),n.oddCounts=new Array(n.dataCharacterCounters.length/2),n.evenCounts=new Array(n.dataCharacterCounters.length/2),n}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(n,r){for(var i=0;i<r.length;i++)if(Wn.patternMatchVariance(n,r[i],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return i;throw new he},e.count=function(n){return Et.sum(new Int32Array(n))},e.increment=function(n,r){for(var i=0,a=r[0],o=1;o<n.length;o++)r[o]>a&&(a=r[o],i=o);n[i]++},e.decrement=function(n,r){for(var i=0,a=r[0],o=1;o<n.length;o++)r[o]<a&&(a=r[o],i=o);n[i]--},e.isFinderPattern=function(n){var r,i,a=n[0]+n[1],o=a+n[2]+n[3],s=a/o;if(s>=e.MIN_FINDER_PATTERN_RATIO&&s<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;try{for(var h=Q$(n),p=h.next();!p.done;p=h.next()){var x=p.value;x>d&&(d=x),x<c&&(c=x)}}catch(v){r={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return d<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e})(Wn),u0=(function(){function t(e,n){this.value=e,this.checksumPortion=n}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value&&this.checksumPortion===n.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t})(),s5=(function(){function t(e,n,r,i,a){this.value=e,this.startEnd=n,this.value=e,this.startEnd=n,this.resultPoints=new Array,this.resultPoints.push(new Be(r,a)),this.resultPoints.push(new Be(i,a))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value},t.prototype.hashCode=function(){return this.value},t})(),eG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},sc=(function(){function t(){}return t.getRSSvalue=function(e,n,r){var i,a,o=0;try{for(var s=eG(e),c=s.next();!c.done;c=s.next()){var d=c.value;o+=d}}catch(N){i={error:N}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}for(var h=0,p=0,x=e.length,v=0;v<x-1;v++){var b=void 0;for(b=1,p|=1<<v;b<e[v];b++,p&=~(1<<v)){var C=t.combins(o-b-1,x-v-2);if(r&&p===0&&o-b-(x-v-1)>=x-v-1&&(C-=t.combins(o-b-(x-v),x-v-2)),x-v-1>1){for(var E=0,S=o-b-(x-v-2);S>n;S--)E+=t.combins(o-b-S-1,x-v-3);C-=E*(x-1-v)}else o-b>n&&C--;h+=C}o-=b}return h},t.combins=function(e,n){var r,i;e-n>n?(i=n,r=e-n):(i=e-n,r=n);for(var a=1,o=1,s=e;s>r;s--)a*=s,o<=i&&(a/=o,o++);for(;o<=i;)a/=o,o++;return a},t})(),tG=(function(){function t(){}return t.buildBitArray=function(e){var n=e.length*2-1;e[e.length-1].getRightChar()==null&&(n-=1);for(var r=12*n,i=new rr(r),a=0,o=e[0],s=o.getRightChar().getValue(),c=11;c>=0;--c)(s&1<<c)!==0&&i.set(a),a++;for(var c=1;c<e.length;++c){for(var d=e[c],h=d.getLeftChar().getValue(),p=11;p>=0;--p)(h&1<<p)!==0&&i.set(a),a++;if(d.getRightChar()!==null)for(var x=d.getRightChar().getValue(),p=11;p>=0;--p)(x&1<<p)!==0&&i.set(a),a++}return i},t})(),Fs=(function(){function t(e,n){n?this.decodedInformation=null:(this.finished=e,this.decodedInformation=n)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t})(),g2=(function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t})(),nG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Gi=(function(t){nG(e,t);function e(n,r){var i=t.call(this,n)||this;return i.value=r,i}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e})(g2),rG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),zs=(function(t){rG(e,t);function e(n,r,i){var a=t.call(this,n)||this;return i?(a.remaining=!0,a.remainingValue=a.remainingValue):(a.remaining=!1,a.remainingValue=0),a.newString=r,a}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e})(g2),iG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),ec=(function(t){iG(e,t);function e(n,r,i){var a=t.call(this,n)||this;if(r<0||r>10||i<0||i>10)throw new De;return a.firstDigit=r,a.secondDigit=i,a}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e})(g2),Rh=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aG=(function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var n,r,i,a,o,s,c,d;if(!e)return null;if(e.length<2)throw new he;var h=e.substring(0,2);try{for(var p=Rh(t.TWO_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var v=x.value;if(v[0]===h)return v[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,v[2],e):t.processFixedAI(2,v[1],e)}}catch(L){n={error:L}}finally{try{x&&!x.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}if(e.length<3)throw new he;var b=e.substring(0,3);try{for(var C=Rh(t.THREE_DIGIT_DATA_LENGTH),E=C.next();!E.done;E=C.next()){var v=E.value;if(v[0]===b)return v[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,v[2],e):t.processFixedAI(3,v[1],e)}}catch(L){i={error:L}}finally{try{E&&!E.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}try{for(var S=Rh(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),N=S.next();!N.done;N=S.next()){var v=N.value;if(v[0]===b)return v[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,v[2],e):t.processFixedAI(4,v[1],e)}}catch(L){o={error:L}}finally{try{N&&!N.done&&(s=S.return)&&s.call(S)}finally{if(o)throw o.error}}if(e.length<4)throw new he;var k=e.substring(0,4);try{for(var I=Rh(t.FOUR_DIGIT_DATA_LENGTH),D=I.next();!D.done;D=I.next()){var v=D.value;if(v[0]===k)return v[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,v[2],e):t.processFixedAI(4,v[1],e)}}catch(L){c={error:L}}finally{try{D&&!D.done&&(d=I.return)&&d.call(I)}finally{if(c)throw c.error}}throw new he},t.processFixedAI=function(e,n,r){if(r.length<e)throw new he;var i=r.substring(0,e);if(r.length<e+n)throw new he;var a=r.substring(e,e+n),o=r.substring(e+n),s="("+i+")"+a,c=t.parseFieldsInGeneralPurpose(o);return c==null?s:s+c},t.processVariableAI=function(e,n,r){var i=r.substring(0,e),a;r.length<e+n?a=r.length:a=e+n;var o=r.substring(e,a),s=r.substring(a),c="("+i+")"+o,d=t.parseFieldsInGeneralPurpose(s);return d==null?c:c+d},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t})(),ep=(function(){function t(e){this.buffer=new st,this.information=e}return t.prototype.decodeAllCodes=function(e,n){var r=n,i=null;do{var a=this.decodeGeneralPurposeField(r,i),o=aG.parseFieldsInGeneralPurpose(a.getNewString());if(o!=null&&e.append(o),a.isRemaining()?i=""+a.getRemainingValue():i=null,r===a.getNewPosition())break;r=a.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var n=e;n<e+3;++n)if(this.information.get(n))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var n=this.extractNumericValueFromBitArray(e,4);return n===0?new ec(this.information.getSize(),ec.FNC1,ec.FNC1):new ec(this.information.getSize(),n-1,ec.FNC1)}var r=this.extractNumericValueFromBitArray(e,7),i=(r-8)/11,a=(r-8)%11;return new ec(e+7,i,a)},t.prototype.extractNumericValueFromBitArray=function(e,n){return t.extractNumericValueFromBitArray(this.information,e,n)},t.extractNumericValueFromBitArray=function(e,n,r){for(var i=0,a=0;a<r;++a)e.get(n+a)&&(i|=1<<r-a-1);return i},t.prototype.decodeGeneralPurposeField=function(e,n){this.buffer.setLengthToZero(),n!=null&&this.buffer.append(n),this.current.setPosition(e);var r=this.parseBlocks();return r!=null&&r.isRemaining()?new zs(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new zs(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,n;do{var r=this.current.getPosition();this.current.isAlpha()?(n=this.parseAlphaBlock(),e=n.isFinished()):this.current.isIsoIec646()?(n=this.parseIsoIec646Block(),e=n.isFinished()):(n=this.parseNumericBlock(),e=n.isFinished());var i=r!==this.current.getPosition();if(!i&&!e)break}while(!e);return n.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var n=void 0;return e.isSecondDigitFNC1()?n=new zs(this.current.getPosition(),this.buffer.toString()):n=new zs(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Fs(!0,n)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var n=new zs(this.current.getPosition(),this.buffer.toString());return new Fs(!0,n)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Fs(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var n=new zs(this.current.getPosition(),this.buffer.toString());return new Fs(!0,n)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Fs(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var n=new zs(this.current.getPosition(),this.buffer.toString());return new Fs(!0,n)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Fs(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,5);if(n>=5&&n<16)return!0;if(e+7>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<116)return!0;if(e+8>this.information.getSize())return!1;var i=this.extractNumericValueFromBitArray(e,8);return i>=232&&i<253},t.prototype.decodeIsoIec646=function(e){var n=this.extractNumericValueFromBitArray(e,5);if(n===15)return new Gi(e+5,Gi.FNC1);if(n>=5&&n<15)return new Gi(e+5,"0"+(n-5));var r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<90)return new Gi(e+7,""+(r+1));if(r>=90&&r<116)return new Gi(e+7,""+(r+7));var i=this.extractNumericValueFromBitArray(e,8),a;switch(i){case 232:a="!";break;case 233:a='"';break;case 234:a="%";break;case 235:a="&";break;case 236:a="'";break;case 237:a="(";break;case 238:a=")";break;case 239:a="*";break;case 240:a="+";break;case 241:a=",";break;case 242:a="-";break;case 243:a=".";break;case 244:a="/";break;case 245:a=":";break;case 246:a=";";break;case 247:a="<";break;case 248:a="=";break;case 249:a=">";break;case 250:a="?";break;case 251:a="_";break;case 252:a=" ";break;default:throw new De}return new Gi(e+8,a)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,5);if(n>=5&&n<16)return!0;if(e+6>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,6);return r>=16&&r<63},t.prototype.decodeAlphanumeric=function(e){var n=this.extractNumericValueFromBitArray(e,5);if(n===15)return new Gi(e+5,Gi.FNC1);if(n>=5&&n<15)return new Gi(e+5,"0"+(n-5));var r=this.extractNumericValueFromBitArray(e,6);if(r>=32&&r<58)return new Gi(e+6,""+(r+33));var i;switch(r){case 58:i="*";break;case 59:i=",";break;case 60:i="-";break;case 61:i=".";break;case 62:i="/";break;default:throw new Kd("Decoding invalid alphanumeric value: "+r)}return new Gi(e+6,i)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var n=0;n<5&&n+e<this.information.getSize();++n)if(n===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+n))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var n=e;n<e+3;++n)if(this.information.get(n))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var n=0;n<4&&n+e<this.information.getSize();++n)if(this.information.get(e+n))return!1;return!0},t})(),l5=(function(){function t(e){this.information=e,this.generalDecoder=new ep(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t})(),oG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Xi=(function(t){oG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.encodeCompressedGtin=function(n,r){n.append("(01)");var i=n.length();n.append("9"),this.encodeCompressedGtinWithoutAI(n,r,i)},e.prototype.encodeCompressedGtinWithoutAI=function(n,r,i){for(var a=0;a<4;++a){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(r+10*a,10);o/100===0&&n.append("0"),o/10===0&&n.append("0"),n.append(o)}e.appendCheckDigit(n,i)},e.appendCheckDigit=function(n,r){for(var i=0,a=0;a<13;a++){var o=n.charAt(a+r).charCodeAt(0)-48;i+=(a&1)===0?3*o:o}i=10-i%10,i===10&&(i=0),n.append(i)},e.GTIN_SIZE=40,e})(l5),sG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),lG=(function(t){sG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.parseInformation=function(){var n=new st;n.append("(01)");var r=n.length(),i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return n.append(i),this.encodeCompressedGtinWithoutAI(n,e.HEADER_SIZE+4,r),this.getGeneralDecoder().decodeAllCodes(n,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e})(Xi),cG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),uG=(function(t){cG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.parseInformation=function(){var n=new st;return this.getGeneralDecoder().decodeAllCodes(n,e.HEADER_SIZE)},e.HEADER_SIZE=5,e})(l5),dG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),tp=(function(t){dG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.encodeCompressedWeight=function(n,r,i){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(r,i);this.addWeightCode(n,a);for(var o=this.checkWeight(a),s=1e5,c=0;c<5;++c)o/s===0&&n.append("0"),s/=10;n.append(o)},e})(Xi),fG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),c5=(function(t){fG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+tp.GTIN_SIZE+e.WEIGHT_SIZE)throw new he;var n=new st;return this.encodeCompressedGtin(n,e.HEADER_SIZE),this.encodeCompressedWeight(n,e.HEADER_SIZE+tp.GTIN_SIZE,e.WEIGHT_SIZE),n.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e})(tp),hG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),pG=(function(t){hG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.addWeightCode=function(n,r){n.append("(3103)")},e.prototype.checkWeight=function(n){return n},e})(c5),mG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),gG=(function(t){mG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.addWeightCode=function(n,r){r<1e4?n.append("(3202)"):n.append("(3203)")},e.prototype.checkWeight=function(n){return n<1e4?n:n-1e4},e})(c5),xG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),vG=(function(t){xG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Xi.GTIN_SIZE)throw new he;var n=new st;this.encodeCompressedGtin(n,e.HEADER_SIZE);var r=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Xi.GTIN_SIZE,e.LAST_DIGIT_SIZE);n.append("(392"),n.append(r),n.append(")");var i=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Xi.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return n.append(i.getNewString()),n.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e})(Xi),yG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),bG=(function(t){yG(e,t);function e(n){return t.call(this,n)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+Xi.GTIN_SIZE)throw new he;var n=new st;this.encodeCompressedGtin(n,e.HEADER_SIZE);var r=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Xi.GTIN_SIZE,e.LAST_DIGIT_SIZE);n.append("(393"),n.append(r),n.append(")");var i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+Xi.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);i/100===0&&n.append("0"),i/10===0&&n.append("0"),n.append(i);var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+Xi.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return n.append(a.getNewString()),n.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e})(Xi),wG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Ro=(function(t){wG(e,t);function e(n,r,i){var a=t.call(this,n)||this;return a.dateCode=i,a.firstAIdigits=r,a}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new he;var n=new st;return this.encodeCompressedGtin(n,e.HEADER_SIZE),this.encodeCompressedWeight(n,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(n,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),n.toString()},e.prototype.encodeCompressedDate=function(n,r){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(r,e.DATE_SIZE);if(i!==38400){n.append("("),n.append(this.dateCode),n.append(")");var a=i%32;i/=32;var o=i%12+1;i/=12;var s=i;s/10===0&&n.append("0"),n.append(s),o/10===0&&n.append("0"),n.append(o),a/10===0&&n.append("0"),n.append(a)}},e.prototype.addWeightCode=function(n,r){n.append("("),n.append(this.firstAIdigits),n.append(r/1e5),n.append(")")},e.prototype.checkWeight=function(n){return n%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e})(tp);function CG(t){try{if(t.get(1))return new lG(t);if(!t.get(2))return new uG(t);var e=ep.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new pG(t);case 5:return new gG(t)}var n=ep.extractNumericValueFromBitArray(t,1,5);switch(n){case 12:return new vG(t);case 13:return new bG(t)}var r=ep.extractNumericValueFromBitArray(t,1,7);switch(r){case 56:return new Ro(t,"310","11");case 57:return new Ro(t,"320","11");case 58:return new Ro(t,"310","13");case 59:return new Ro(t,"320","13");case 60:return new Ro(t,"310","15");case 61:return new Ro(t,"320","15");case 62:return new Ro(t,"310","17");case 63:return new Ro(t,"320","17")}}catch(i){throw console.log(i),new Kd("unknown decoder: "+t)}}var y3=(function(){function t(e,n,r,i){this.leftchar=e,this.rightchar=n,this.finderpattern=r,this.maybeLast=i}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,n){return e instanceof t?t.equalsOrNull(e.leftchar,n.leftchar)&&t.equalsOrNull(e.rightchar,n.rightchar)&&t.equalsOrNull(e.finderpattern,n.finderpattern):!1},t.equalsOrNull=function(e,n){return e===null?n===null:t.equals(e,n)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t})(),EG=(function(){function t(e,n,r){this.pairs=e,this.rowNumber=n,this.wasReversed=r}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,n){return e instanceof t?this.checkEqualitity(e,n)&&e.wasReversed===n.wasReversed:!1},t.prototype.checkEqualitity=function(e,n){if(!(!e||!n)){var r;return e.forEach(function(i,a){n.forEach(function(o){i.getLeftChar().getValue()===o.getLeftChar().getValue()&&i.getRightChar().getValue()===o.getRightChar().getValue()&&i.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(r=!0)})}),r}},t})(),SG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Lo=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},AG=(function(t){SG(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.pairs=new Array(e.MAX_PAIRS),n.rows=new Array,n.startEnd=[2],n}return e.prototype.decodeRow=function(n,r,i){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(n,r))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(n,r))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(n,r){for(var i=!1;!i;)try{this.pairs.push(this.retrieveNextPair(r,this.pairs,n))}catch(s){if(s instanceof he){if(!this.pairs.length)throw new he;i=!0}}if(this.checkChecksum())return this.pairs;var a;if(this.rows.length?a=!0:a=!1,this.storeRow(n,!1),a){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new he},e.prototype.checkRowsBoolean=function(n){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,n&&(this.rows=this.rows.reverse());var r=null;try{r=this.checkRows(new Array,0)}catch(i){console.log(i)}return n&&(this.rows=this.rows.reverse()),r},e.prototype.checkRows=function(n,r){for(var i,a,o=r;o<this.rows.length;o++){var s=this.rows[o];this.pairs.length=0;try{for(var c=(i=void 0,Lo(n)),d=c.next();!d.done;d=c.next()){var h=d.value;this.pairs.push(h.getPairs())}}catch(x){i={error:x}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}if(this.pairs.push(s.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var p=new Array(n);p.push(s);try{return this.checkRows(p,o+1)}catch(x){console.log(x)}}}throw new he},e.isValidSequence=function(n){var r,i;try{for(var a=Lo(e.FINDER_PATTERN_SEQUENCES),o=a.next();!o.done;o=a.next()){var s=o.value;if(!(n.length>s.length)){for(var c=!0,d=0;d<n.length;d++)if(n[d].getFinderPattern().getValue()!==s[d]){c=!1;break}if(c)return!0}}}catch(h){r={error:h}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return!1},e.prototype.storeRow=function(n,r){for(var i=0,a=!1,o=!1;i<this.rows.length;){var s=this.rows[i];if(s.getRowNumber()>n){o=s.isEquivalent(this.pairs);break}a=s.isEquivalent(this.pairs),i++}o||a||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(i,new EG(this.pairs,n,r)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(n,r){var i,a,o,s,c,d;try{for(var h=Lo(r),p=h.next();!p.done;p=h.next()){var x=p.value;if(x.getPairs().length!==n.length){var v=!0;try{for(var b=(o=void 0,Lo(x.getPairs())),C=b.next();!C.done;C=b.next()){var E=C.value,S=!1;try{for(var N=(c=void 0,Lo(n)),k=N.next();!k.done;k=N.next()){var I=k.value;if(y3.equals(E,I)){S=!0;break}}}catch(D){c={error:D}}finally{try{k&&!k.done&&(d=N.return)&&d.call(N)}finally{if(c)throw c.error}}S||(v=!1)}}catch(D){o={error:D}}finally{try{C&&!C.done&&(s=b.return)&&s.call(b)}finally{if(o)throw o.error}}}}}catch(D){i={error:D}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}},e.isPartialRow=function(n,r){var i,a,o,s,c,d;try{for(var h=Lo(r),p=h.next();!p.done;p=h.next()){var x=p.value,v=!0;try{for(var b=(o=void 0,Lo(n)),C=b.next();!C.done;C=b.next()){var E=C.value,S=!1;try{for(var N=(c=void 0,Lo(x.getPairs())),k=N.next();!k.done;k=N.next()){var I=k.value;if(E.equals(I)){S=!0;break}}}catch(D){c={error:D}}finally{try{k&&!k.done&&(d=N.return)&&d.call(N)}finally{if(c)throw c.error}}if(!S){v=!1;break}}}catch(D){o={error:D}}finally{try{C&&!C.done&&(s=b.return)&&s.call(b)}finally{if(o)throw o.error}}if(v)return!0}}catch(D){i={error:D}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(n){var r=tG.buildBitArray(n),i=CG(r),a=i.parseInformation(),o=n[0].getFinderPattern().getResultPoints(),s=n[n.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],s[0],s[1]];return new Dr(a,null,null,c,Ue.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var n=this.pairs.get(0),r=n.getLeftChar(),i=n.getRightChar();if(i===null)return!1;for(var a=i.getChecksumPortion(),o=2,s=1;s<this.pairs.size();++s){var c=this.pairs.get(s);a+=c.getLeftChar().getChecksumPortion(),o++;var d=c.getRightChar();d!=null&&(a+=d.getChecksumPortion(),o++)}a%=211;var h=211*(o-4)+a;return h===r.getValue()},e.getNextSecondBar=function(n,r){var i;return n.get(r)?(i=n.getNextUnset(r),i=n.getNextSet(i)):(i=n.getNextSet(r),i=n.getNextUnset(i)),i},e.prototype.retrieveNextPair=function(n,r,i){var a=r.length%2===0;this.startFromEven&&(a=!a);var o,s=!0,c=-1;do this.findNextPair(n,r,c),o=this.parseFoundFinderPattern(n,i,a),o===null?c=e.getNextSecondBar(n,this.startEnd[0]):s=!1;while(s);var d=this.decodeDataCharacter(n,o,a,!0);if(!this.isEmptyPair(r)&&r[r.length-1].mustBeLast())throw new he;var h;try{h=this.decodeDataCharacter(n,o,a,!1)}catch(p){h=null,console.log(p)}return new y3(d,h,o,!0)},e.prototype.isEmptyPair=function(n){return n.length===0},e.prototype.findNextPair=function(n,r,i){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;var o=n.getSize(),s;if(i>=0)s=i;else if(this.isEmptyPair(r))s=0;else{var c=r[r.length-1];s=c.getFinderPattern().getStartEnd()[1]}var d=r.length%2!==0;this.startFromEven&&(d=!d);for(var h=!1;s<o&&(h=!n.get(s),!!h);)s++;for(var p=0,x=s,v=s;v<o;v++)if(n.get(v)!==h)a[p]++;else{if(p===3){if(d&&e.reverseCounters(a),e.isFinderPattern(a)){this.startEnd[0]=x,this.startEnd[1]=v;return}d&&e.reverseCounters(a),x+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,p--}else p++;a[p]=1,h=!h}throw new he},e.reverseCounters=function(n){for(var r=n.length,i=0;i<r/2;++i){var a=n[i];n[i]=n[r-i-1],n[r-i-1]=a}},e.prototype.parseFoundFinderPattern=function(n,r,i){var a,o,s;if(i){for(var c=this.startEnd[0]-1;c>=0&&!n.get(c);)c--;c++,a=this.startEnd[0]-c,o=c,s=this.startEnd[1]}else o=this.startEnd[0],s=n.getNextUnset(this.startEnd[1]+1),a=s-this.startEnd[1];var d=this.getDecodeFinderCounters();Qt.arraycopy(d,0,d,1,d.length-1),d[0]=a;var h;try{h=this.parseFinderValue(d,e.FINDER_PATTERNS)}catch{return null}return new s5(h,[o,s],o,s,r)},e.prototype.decodeDataCharacter=function(n,r,i,a){for(var o=this.getDataCharacterCounters(),s=0;s<o.length;s++)o[s]=0;if(a)e.recordPatternInReverse(n,r.getStartEnd()[0],o);else{e.recordPattern(n,r.getStartEnd()[1],o);for(var c=0,d=o.length-1;c<d;c++,d--){var h=o[c];o[c]=o[d],o[d]=h}}var p=17,x=Et.sum(new Int32Array(o))/p,v=(r.getStartEnd()[1]-r.getStartEnd()[0])/15;if(Math.abs(x-v)/v>.3)throw new he;for(var b=this.getOddCounts(),C=this.getEvenCounts(),E=this.getOddRoundingErrors(),S=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var N=1*o[c]/x,k=N+.5;if(k<1){if(N<.3)throw new he;k=1}else if(k>8){if(N>8.7)throw new he;k=8}var I=c/2;(c&1)===0?(b[I]=k,E[I]=N-k):(C[I]=k,S[I]=N-k)}this.adjustOddEvenCounts(p);for(var D=4*r.getValue()+(i?0:2)+(a?0:1)-1,L=0,O=0,c=b.length-1;c>=0;c--){if(e.isNotA1left(r,i,a)){var j=e.WEIGHTS[D][2*c];O+=b[c]*j}L+=b[c]}for(var U=0,c=C.length-1;c>=0;c--)if(e.isNotA1left(r,i,a)){var j=e.WEIGHTS[D][2*c+1];U+=C[c]*j}var fe=O+U;if((L&1)!==0||L>13||L<4)throw new he;var le=(13-L)/2,q=e.SYMBOL_WIDEST[le],de=9-q,ge=sc.getRSSvalue(b,q,!0),xe=sc.getRSSvalue(C,de,!1),H=e.EVEN_TOTAL_SUBSET[le],ie=e.GSUM[le],K=ge*H+xe+ie;return new u0(K,fe)},e.isNotA1left=function(n,r,i){return!(n.getValue()===0&&r&&i)},e.prototype.adjustOddEvenCounts=function(n){var r=Et.sum(new Int32Array(this.getOddCounts())),i=Et.sum(new Int32Array(this.getEvenCounts())),a=!1,o=!1;r>13?o=!0:r<4&&(a=!0);var s=!1,c=!1;i>13?c=!0:i<4&&(s=!0);var d=r+i-n,h=(r&1)===1,p=(i&1)===0;if(d===1)if(h){if(p)throw new he;o=!0}else{if(!p)throw new he;c=!0}else if(d===-1)if(h){if(p)throw new he;a=!0}else{if(!p)throw new he;s=!0}else if(d===0){if(h){if(!p)throw new he;r<i?(a=!0,c=!0):(o=!0,s=!0)}else if(p)throw new he}else throw new he;if(a){if(o)throw new he;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(c)throw new he;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e})(Us),_G=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),NG=(function(t){_G(e,t);function e(n,r,i){var a=t.call(this,n,r)||this;return a.count=0,a.finderPattern=i,a}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e})(u0),kG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),sx=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},b3=(function(t){kG(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.possibleLeftPairs=[],n.possibleRightPairs=[],n}return e.prototype.decodeRow=function(n,r,i){var a,o,s,c,d=this.decodePair(r,!1,n,i);e.addOrTally(this.possibleLeftPairs,d),r.reverse();var h=this.decodePair(r,!0,n,i);e.addOrTally(this.possibleRightPairs,h),r.reverse();try{for(var p=sx(this.possibleLeftPairs),x=p.next();!x.done;x=p.next()){var v=x.value;if(v.getCount()>1)try{for(var b=(s=void 0,sx(this.possibleRightPairs)),C=b.next();!C.done;C=b.next()){var E=C.value;if(E.getCount()>1&&e.checkChecksum(v,E))return e.constructResult(v,E)}}catch(S){s={error:S}}finally{try{C&&!C.done&&(c=b.return)&&c.call(b)}finally{if(s)throw s.error}}}}catch(S){a={error:S}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(a)throw a.error}}throw new he},e.addOrTally=function(n,r){var i,a;if(r!=null){var o=!1;try{for(var s=sx(n),c=s.next();!c.done;c=s.next()){var d=c.value;if(d.getValue()===r.getValue()){d.incrementCount(),o=!0;break}}}catch(h){i={error:h}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}o||n.push(r)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(n,r){for(var i=4537077*n.getValue()+r.getValue(),a=new String(i).toString(),o=new st,s=13-a.length;s>0;s--)o.append("0");o.append(a);for(var c=0,s=0;s<13;s++){var d=o.charAt(s).charCodeAt(0)-48;c+=(s&1)===0?3*d:d}c=10-c%10,c===10&&(c=0),o.append(c.toString());var h=n.getFinderPattern().getResultPoints(),p=r.getFinderPattern().getResultPoints();return new Dr(o.toString(),null,0,[h[0],h[1],p[0],p[1]],Ue.RSS_14,new Date().getTime())},e.checkChecksum=function(n,r){var i=(n.getChecksumPortion()+16*r.getChecksumPortion())%79,a=9*n.getFinderPattern().getValue()+r.getFinderPattern().getValue();return a>72&&a--,a>8&&a--,i===a},e.prototype.decodePair=function(n,r,i,a){try{var o=this.findFinderPattern(n,r),s=this.parseFoundFinderPattern(n,i,r,o),c=a==null?null:a.get(en.NEED_RESULT_POINT_CALLBACK);if(c!=null){var d=(o[0]+o[1])/2;r&&(d=n.getSize()-1-d),c.foundPossibleResultPoint(new Be(d,i))}var h=this.decodeDataCharacter(n,s,!0),p=this.decodeDataCharacter(n,s,!1);return new NG(1597*h.getValue()+p.getValue(),h.getChecksumPortion()+4*p.getChecksumPortion(),s)}catch{return null}},e.prototype.decodeDataCharacter=function(n,r,i){for(var a=this.getDataCharacterCounters(),o=0;o<a.length;o++)a[o]=0;if(i)Wn.recordPatternInReverse(n,r.getStartEnd()[0],a);else{Wn.recordPattern(n,r.getStartEnd()[1]+1,a);for(var s=0,c=a.length-1;s<c;s++,c--){var d=a[s];a[s]=a[c],a[c]=d}}for(var h=i?16:15,p=Et.sum(new Int32Array(a))/h,x=this.getOddCounts(),v=this.getEvenCounts(),b=this.getOddRoundingErrors(),C=this.getEvenRoundingErrors(),s=0;s<a.length;s++){var E=a[s]/p,S=Math.floor(E+.5);S<1?S=1:S>8&&(S=8);var N=Math.floor(s/2);(s&1)===0?(x[N]=S,b[N]=E-S):(v[N]=S,C[N]=E-S)}this.adjustOddEvenCounts(i,h);for(var k=0,I=0,s=x.length-1;s>=0;s--)I*=9,I+=x[s],k+=x[s];for(var D=0,L=0,s=v.length-1;s>=0;s--)D*=9,D+=v[s],L+=v[s];var O=I+3*D;if(i){if((k&1)!==0||k>12||k<4)throw new he;var j=(12-k)/2,U=e.OUTSIDE_ODD_WIDEST[j],fe=9-U,le=sc.getRSSvalue(x,U,!1),q=sc.getRSSvalue(v,fe,!0),de=e.OUTSIDE_EVEN_TOTAL_SUBSET[j],ge=e.OUTSIDE_GSUM[j];return new u0(le*de+q+ge,O)}else{if((L&1)!==0||L>10||L<4)throw new he;var j=(10-L)/2,U=e.INSIDE_ODD_WIDEST[j],fe=9-U,le=sc.getRSSvalue(x,U,!0),q=sc.getRSSvalue(v,fe,!1),xe=e.INSIDE_ODD_TOTAL_SUBSET[j],ge=e.INSIDE_GSUM[j];return new u0(q*xe+le+ge,O)}},e.prototype.findFinderPattern=function(n,r){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;for(var a=n.getSize(),o=!1,s=0;s<a&&(o=!n.get(s),r!==o);)s++;for(var c=0,d=s,h=s;h<a;h++)if(n.get(h)!==o)i[c]++;else{if(c===3){if(Us.isFinderPattern(i))return[d,h];d+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,c--}else c++;i[c]=1,o=!o}throw new he},e.prototype.parseFoundFinderPattern=function(n,r,i,a){for(var o=n.get(a[0]),s=a[0]-1;s>=0&&o!==n.get(s);)s--;s++;var c=a[0]-s,d=this.getDecodeFinderCounters(),h=new Int32Array(d.length);Qt.arraycopy(d,0,h,1,d.length-1),h[0]=c;var p=this.parseFinderValue(h,e.FINDER_PATTERNS),x=s,v=a[1];return i&&(x=n.getSize()-1-x,v=n.getSize()-1-v),new s5(p,[s,a[1]],x,v,r)},e.prototype.adjustOddEvenCounts=function(n,r){var i=Et.sum(new Int32Array(this.getOddCounts())),a=Et.sum(new Int32Array(this.getEvenCounts())),o=!1,s=!1,c=!1,d=!1;n?(i>12?s=!0:i<4&&(o=!0),a>12?d=!0:a<4&&(c=!0)):(i>11?s=!0:i<5&&(o=!0),a>10?d=!0:a<4&&(c=!0));var h=i+a-r,p=(i&1)===(n?1:0),x=(a&1)===1;if(h===1)if(p){if(x)throw new he;s=!0}else{if(!x)throw new he;d=!0}else if(h===-1)if(p){if(x)throw new he;o=!0}else{if(!x)throw new he;c=!0}else if(h===0){if(p){if(!x)throw new he;i<a?(o=!0,d=!0):(s=!0,c=!0)}else if(x)throw new he}else throw new he;if(o){if(s)throw new he;Us.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&Us.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(d)throw new he;Us.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&Us.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e})(Us),TG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Ku=(function(t){TG(e,t);function e(n){var r=t.call(this)||this;r.readers=[];var i=n?n.get(en.POSSIBLE_FORMATS):null,a=n&&n.get(en.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=n&&n.get(en.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return i&&((i.includes(Ue.EAN_13)||i.includes(Ue.UPC_A)||i.includes(Ue.EAN_8)||i.includes(Ue.UPC_E))&&r.readers.push(new ox(n)),i.includes(Ue.CODE_39)&&r.readers.push(new u3(a,o)),i.includes(Ue.CODE_93)&&r.readers.push(new d3),i.includes(Ue.CODE_128)&&r.readers.push(new c3),i.includes(Ue.ITF)&&r.readers.push(new f3),i.includes(Ue.CODABAR)&&r.readers.push(new Z$),i.includes(Ue.RSS_14)&&r.readers.push(new b3),i.includes(Ue.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),r.readers.push(new AG))),r.readers.length===0&&(r.readers.push(new ox(n)),r.readers.push(new u3),r.readers.push(new d3),r.readers.push(new ox(n)),r.readers.push(new c3),r.readers.push(new f3),r.readers.push(new b3)),r}return e.prototype.decodeRow=function(n,r,i){for(var a=0;a<this.readers.length;a++)try{return this.readers[a].decodeRow(n,r,i)}catch{}throw new he},e.prototype.reset=function(){this.readers.forEach(function(n){return n.reset()})},e})(Wn),OG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){OG(e,t);function e(n,r){return n===void 0&&(n=500),t.call(this,new Ku(r),n,r)||this}return e})(Fc);var w3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ot=(function(){function t(e,n,r){this.ecCodewords=e,this.ecBlocks=[n],r&&this.ecBlocks.push(r)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t})(),Nt=(function(){function t(e,n){this.count=e,this.dataCodewords=n}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t})(),IG=(function(){function t(e,n,r,i,a,o){var s,c;this.versionNumber=e,this.symbolSizeRows=n,this.symbolSizeColumns=r,this.dataRegionSizeRows=i,this.dataRegionSizeColumns=a,this.ecBlocks=o;var d=0,h=o.getECCodewords(),p=o.getECBlocks();try{for(var x=w3(p),v=x.next();!v.done;v=x.next()){var b=v.value;d+=b.getCount()*(b.getDataCodewords()+h)}}catch(C){s={error:C}}finally{try{v&&!v.done&&(c=x.return)&&c.call(x)}finally{if(s)throw s.error}}this.totalCodewords=d}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,n){var r,i;if((e&1)!==0||(n&1)!==0)throw new De;try{for(var a=w3(t.VERSIONS),o=a.next();!o.done;o=a.next()){var s=o.value;if(s.symbolSizeRows===e&&s.symbolSizeColumns===n)return s}}catch(c){r={error:c}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}throw new De},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new Ot(5,new Nt(1,3))),new t(2,12,12,10,10,new Ot(7,new Nt(1,5))),new t(3,14,14,12,12,new Ot(10,new Nt(1,8))),new t(4,16,16,14,14,new Ot(12,new Nt(1,12))),new t(5,18,18,16,16,new Ot(14,new Nt(1,18))),new t(6,20,20,18,18,new Ot(18,new Nt(1,22))),new t(7,22,22,20,20,new Ot(20,new Nt(1,30))),new t(8,24,24,22,22,new Ot(24,new Nt(1,36))),new t(9,26,26,24,24,new Ot(28,new Nt(1,44))),new t(10,32,32,14,14,new Ot(36,new Nt(1,62))),new t(11,36,36,16,16,new Ot(42,new Nt(1,86))),new t(12,40,40,18,18,new Ot(48,new Nt(1,114))),new t(13,44,44,20,20,new Ot(56,new Nt(1,144))),new t(14,48,48,22,22,new Ot(68,new Nt(1,174))),new t(15,52,52,24,24,new Ot(42,new Nt(2,102))),new t(16,64,64,14,14,new Ot(56,new Nt(2,140))),new t(17,72,72,16,16,new Ot(36,new Nt(4,92))),new t(18,80,80,18,18,new Ot(48,new Nt(4,114))),new t(19,88,88,20,20,new Ot(56,new Nt(4,144))),new t(20,96,96,22,22,new Ot(68,new Nt(4,174))),new t(21,104,104,24,24,new Ot(56,new Nt(6,136))),new t(22,120,120,18,18,new Ot(68,new Nt(6,175))),new t(23,132,132,20,20,new Ot(62,new Nt(8,163))),new t(24,144,144,22,22,new Ot(62,new Nt(8,156),new Nt(2,155))),new t(25,8,18,6,16,new Ot(7,new Nt(1,5))),new t(26,8,32,6,14,new Ot(11,new Nt(1,10))),new t(27,12,26,10,24,new Ot(14,new Nt(1,16))),new t(28,12,36,10,16,new Ot(18,new Nt(1,22))),new t(29,16,36,14,16,new Ot(24,new Nt(1,32))),new t(30,16,48,14,22,new Ot(28,new Nt(1,49)))]},t.VERSIONS=t.buildVersions(),t})(),DG=(function(){function t(e){var n=e.getHeight();if(n<8||n>144||(n&1)!==0)throw new De;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new wa(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var n=e.getHeight(),r=e.getWidth();return IG.getVersionForDimensions(n,r)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),n=0,r=4,i=0,a=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),s=!1,c=!1,d=!1,h=!1;do if(r===a&&i===0&&!s)e[n++]=this.readCorner1(a,o)&255,r-=2,i+=2,s=!0;else if(r===a-2&&i===0&&(o&3)!==0&&!c)e[n++]=this.readCorner2(a,o)&255,r-=2,i+=2,c=!0;else if(r===a+4&&i===2&&(o&7)===0&&!d)e[n++]=this.readCorner3(a,o)&255,r-=2,i+=2,d=!0;else if(r===a-2&&i===0&&(o&7)===4&&!h)e[n++]=this.readCorner4(a,o)&255,r-=2,i+=2,h=!0;else{do r<a&&i>=0&&!this.readMappingMatrix.get(i,r)&&(e[n++]=this.readUtah(r,i,a,o)&255),r-=2,i+=2;while(r>=0&&i<o);r+=1,i+=3;do r>=0&&i<o&&!this.readMappingMatrix.get(i,r)&&(e[n++]=this.readUtah(r,i,a,o)&255),r+=2,i-=2;while(r<a&&i>=0);r+=3,i+=1}while(r<a||i<o);if(n!==this.version.getTotalCodewords())throw new De;return e},t.prototype.readModule=function(e,n,r,i){return e<0&&(e+=r,n+=4-(r+4&7)),n<0&&(n+=i,e+=4-(i+4&7)),this.readMappingMatrix.set(n,e),this.mappingBitMatrix.get(n,e)},t.prototype.readUtah=function(e,n,r,i){var a=0;return this.readModule(e-2,n-2,r,i)&&(a|=1),a<<=1,this.readModule(e-2,n-1,r,i)&&(a|=1),a<<=1,this.readModule(e-1,n-2,r,i)&&(a|=1),a<<=1,this.readModule(e-1,n-1,r,i)&&(a|=1),a<<=1,this.readModule(e-1,n,r,i)&&(a|=1),a<<=1,this.readModule(e,n-2,r,i)&&(a|=1),a<<=1,this.readModule(e,n-1,r,i)&&(a|=1),a<<=1,this.readModule(e,n,r,i)&&(a|=1),a},t.prototype.readCorner1=function(e,n){var r=0;return this.readModule(e-1,0,e,n)&&(r|=1),r<<=1,this.readModule(e-1,1,e,n)&&(r|=1),r<<=1,this.readModule(e-1,2,e,n)&&(r|=1),r<<=1,this.readModule(0,n-2,e,n)&&(r|=1),r<<=1,this.readModule(0,n-1,e,n)&&(r|=1),r<<=1,this.readModule(1,n-1,e,n)&&(r|=1),r<<=1,this.readModule(2,n-1,e,n)&&(r|=1),r<<=1,this.readModule(3,n-1,e,n)&&(r|=1),r},t.prototype.readCorner2=function(e,n){var r=0;return this.readModule(e-3,0,e,n)&&(r|=1),r<<=1,this.readModule(e-2,0,e,n)&&(r|=1),r<<=1,this.readModule(e-1,0,e,n)&&(r|=1),r<<=1,this.readModule(0,n-4,e,n)&&(r|=1),r<<=1,this.readModule(0,n-3,e,n)&&(r|=1),r<<=1,this.readModule(0,n-2,e,n)&&(r|=1),r<<=1,this.readModule(0,n-1,e,n)&&(r|=1),r<<=1,this.readModule(1,n-1,e,n)&&(r|=1),r},t.prototype.readCorner3=function(e,n){var r=0;return this.readModule(e-1,0,e,n)&&(r|=1),r<<=1,this.readModule(e-1,n-1,e,n)&&(r|=1),r<<=1,this.readModule(0,n-3,e,n)&&(r|=1),r<<=1,this.readModule(0,n-2,e,n)&&(r|=1),r<<=1,this.readModule(0,n-1,e,n)&&(r|=1),r<<=1,this.readModule(1,n-3,e,n)&&(r|=1),r<<=1,this.readModule(1,n-2,e,n)&&(r|=1),r<<=1,this.readModule(1,n-1,e,n)&&(r|=1),r},t.prototype.readCorner4=function(e,n){var r=0;return this.readModule(e-3,0,e,n)&&(r|=1),r<<=1,this.readModule(e-2,0,e,n)&&(r|=1),r<<=1,this.readModule(e-1,0,e,n)&&(r|=1),r<<=1,this.readModule(0,n-2,e,n)&&(r|=1),r<<=1,this.readModule(0,n-1,e,n)&&(r|=1),r<<=1,this.readModule(1,n-1,e,n)&&(r|=1),r<<=1,this.readModule(2,n-1,e,n)&&(r|=1),r<<=1,this.readModule(3,n-1,e,n)&&(r|=1),r},t.prototype.extractDataRegion=function(e){var n=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(e.getHeight()!==n)throw new qe("Dimension of bitMatrix must match the version size");for(var i=this.version.getDataRegionSizeRows(),a=this.version.getDataRegionSizeColumns(),o=n/i|0,s=r/a|0,c=o*i,d=s*a,h=new wa(d,c),p=0;p<o;++p)for(var x=p*i,v=0;v<s;++v)for(var b=v*a,C=0;C<i;++C)for(var E=p*(i+2)+1+C,S=x+C,N=0;N<a;++N){var k=v*(a+2)+1+N;if(e.get(k,E)){var I=b+N;h.set(I,S)}}return h},t})(),C3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},MG=(function(){function t(e,n){this.numDataCodewords=e,this.codewords=n}return t.getDataBlocks=function(e,n){var r,i,a,o,s=n.getECBlocks(),c=0,d=s.getECBlocks();try{for(var h=C3(d),p=h.next();!p.done;p=h.next()){var x=p.value;c+=x.getCount()}}catch(ge){r={error:ge}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}var v=new Array(c),b=0;try{for(var C=C3(d),E=C.next();!E.done;E=C.next())for(var x=E.value,S=0;S<x.getCount();S++){var N=x.getDataCodewords(),k=s.getECCodewords()+N;v[b++]=new t(N,new Uint8Array(k))}}catch(ge){a={error:ge}}finally{try{E&&!E.done&&(o=C.return)&&o.call(C)}finally{if(a)throw a.error}}for(var I=v[0].codewords.length,D=I-s.getECCodewords(),L=D-1,O=0,S=0;S<L;S++)for(var j=0;j<b;j++)v[j].codewords[S]=e[O++];for(var U=n.getVersionNumber()===24,fe=U?8:b,j=0;j<fe;j++)v[j].codewords[D-1]=e[O++];for(var le=v[0].codewords.length,S=D;S<le;S++)for(var j=0;j<b;j++){var q=U?(j+8)%b:j,de=U&&q>7?S-1:S;v[q].codewords[de]=e[O++]}if(O!==e.length)throw new qe;return v},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t})(),u5=(function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new qe(""+e);var n=0,r=this.bitOffset,i=this.byteOffset,a=this.bytes;if(r>0){var o=8-r,s=e<o?e:o,c=o-s,d=255>>8-s<<c;n=(a[i]&d)>>c,e-=s,r+=s,r===8&&(r=0,i++)}if(e>0){for(;e>=8;)n=n<<8|a[i]&255,i++,e-=8;if(e>0){var c=8-e,d=255>>c<<c;n=n<<e|(a[i]&d)>>c,r+=e}}return this.bitOffset=r,this.byteOffset=i,n},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t})(),zn;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(zn||(zn={}));var RG=(function(){function t(){}return t.decode=function(e){var n=new u5(e),r=new st,i=new st,a=new Array,o=zn.ASCII_ENCODE;do if(o===zn.ASCII_ENCODE)o=this.decodeAsciiSegment(n,r,i);else{switch(o){case zn.C40_ENCODE:this.decodeC40Segment(n,r);break;case zn.TEXT_ENCODE:this.decodeTextSegment(n,r);break;case zn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(n,r);break;case zn.EDIFACT_ENCODE:this.decodeEdifactSegment(n,r);break;case zn.BASE256_ENCODE:this.decodeBase256Segment(n,r,a);break;default:throw new De}o=zn.ASCII_ENCODE}while(o!==zn.PAD_ENCODE&&n.available()>0);return i.length()>0&&r.append(i.toString()),new J0(e,r.toString(),a.length===0?null:a,null)},t.decodeAsciiSegment=function(e,n,r){var i=!1;do{var a=e.readBits(8);if(a===0)throw new De;if(a<=128)return i&&(a+=128),n.append(String.fromCharCode(a-1)),zn.ASCII_ENCODE;if(a===129)return zn.PAD_ENCODE;if(a<=229){var o=a-130;o<10&&n.append("0"),n.append(""+o)}else switch(a){case 230:return zn.C40_ENCODE;case 231:return zn.BASE256_ENCODE;case 232:n.append("");break;case 233:case 234:break;case 235:i=!0;break;case 236:n.append("[)>05"),r.insert(0,"");break;case 237:n.append("[)>06"),r.insert(0,"");break;case 238:return zn.ANSIX12_ENCODE;case 239:return zn.TEXT_ENCODE;case 240:return zn.EDIFACT_ENCODE;case 241:break;default:if(a!==254||e.available()!==0)throw new De;break}}while(e.available()>0);return zn.ASCII_ENCODE},t.decodeC40Segment=function(e,n){var r=!1,i=[],a=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),i);for(var s=0;s<3;s++){var c=i[s];switch(a){case 0:if(c<3)a=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var d=this.C40_BASIC_SET_CHARS[c];r?(n.append(String.fromCharCode(d.charCodeAt(0)+128)),r=!1):n.append(d)}else throw new De;break;case 1:r?(n.append(String.fromCharCode(c+128)),r=!1):n.append(String.fromCharCode(c)),a=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var d=this.C40_SHIFT2_SET_CHARS[c];r?(n.append(String.fromCharCode(d.charCodeAt(0)+128)),r=!1):n.append(d)}else switch(c){case 27:n.append("");break;case 30:r=!0;break;default:throw new De}a=0;break;case 3:r?(n.append(String.fromCharCode(c+224)),r=!1):n.append(String.fromCharCode(c+96)),a=0;break;default:throw new De}}}while(e.available()>0)},t.decodeTextSegment=function(e,n){var r=!1,i=[],a=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),i);for(var s=0;s<3;s++){var c=i[s];switch(a){case 0:if(c<3)a=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var d=this.TEXT_BASIC_SET_CHARS[c];r?(n.append(String.fromCharCode(d.charCodeAt(0)+128)),r=!1):n.append(d)}else throw new De;break;case 1:r?(n.append(String.fromCharCode(c+128)),r=!1):n.append(String.fromCharCode(c)),a=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var d=this.TEXT_SHIFT2_SET_CHARS[c];r?(n.append(String.fromCharCode(d.charCodeAt(0)+128)),r=!1):n.append(d)}else switch(c){case 27:n.append("");break;case 30:r=!0;break;default:throw new De}a=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var d=this.TEXT_SHIFT3_SET_CHARS[c];r?(n.append(String.fromCharCode(d.charCodeAt(0)+128)),r=!1):n.append(d),a=0}else throw new De;break;default:throw new De}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,n){var r=[];do{if(e.available()===8)return;var i=e.readBits(8);if(i===254)return;this.parseTwoBytes(i,e.readBits(8),r);for(var a=0;a<3;a++){var o=r[a];switch(o){case 0:n.append("\r");break;case 1:n.append("*");break;case 2:n.append(">");break;case 3:n.append(" ");break;default:if(o<14)n.append(String.fromCharCode(o+44));else if(o<40)n.append(String.fromCharCode(o+51));else throw new De;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,n,r){var i=(e<<8)+n-1,a=Math.floor(i/1600);r[0]=a,i-=a*1600,a=Math.floor(i/40),r[1]=a,r[2]=i-a*40},t.decodeEdifactSegment=function(e,n){do{if(e.available()<=16)return;for(var r=0;r<4;r++){var i=e.readBits(6);if(i===31){var a=8-e.getBitOffset();a!==8&&e.readBits(a);return}(i&32)===0&&(i|=64),n.append(String.fromCharCode(i))}}while(e.available()>0)},t.decodeBase256Segment=function(e,n,r){var i=1+e.getByteOffset(),a=this.unrandomize255State(e.readBits(8),i++),o;if(a===0?o=e.available()/8|0:a<250?o=a:o=250*(a-249)+this.unrandomize255State(e.readBits(8),i++),o<0)throw new De;for(var s=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new De;s[c]=this.unrandomize255State(e.readBits(8),i++)}r.push(s);try{n.append(Pi.decode(s,xt.ISO88591))}catch(d){throw new Kd("Platform does not support required encoding: "+d.message)}},t.unrandomize255State=function(e,n){var r=149*n%255+1,i=e-r;return i>=0?i:i+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t})(),LG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jG=(function(){function t(){this.rsDecoder=new Q0(ri.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var n,r,i=new DG(e),a=i.getVersion(),o=i.readCodewords(),s=MG.getDataBlocks(o,a),c=0;try{for(var d=LG(s),h=d.next();!h.done;h=d.next()){var p=h.value;c+=p.getNumDataCodewords()}}catch(k){n={error:k}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}for(var x=new Uint8Array(c),v=s.length,b=0;b<v;b++){var C=s[b],E=C.getCodewords(),S=C.getNumDataCodewords();this.correctErrors(E,S);for(var N=0;N<S;N++)x[N*v+b]=E[N]}return RG.decode(x)},t.prototype.correctErrors=function(e,n){var r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-n)}catch{throw new tr}for(var i=0;i<n;i++)e[i]=r[i]},t})(),PG=(function(){function t(e){this.image=e,this.rectangleDetector=new Fv(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),n=this.detectSolid1(e);if(n=this.detectSolid2(n),n[3]=this.correctTopRight(n),!n[3])throw new he;n=this.shiftToModuleCenter(n);var r=n[0],i=n[1],a=n[2],o=n[3],s=this.transitionsBetween(r,o)+1,c=this.transitionsBetween(a,o)+1;(s&1)===1&&(s+=1),(c&1)===1&&(c+=1),4*s<7*c&&4*c<7*s&&(s=c=Math.max(s,c));var d=t.sampleGrid(this.image,r,i,a,o,s,c);return new p2(d,[r,i,a,o])},t.shiftPoint=function(e,n,r){var i=(n.getX()-e.getX())/(r+1),a=(n.getY()-e.getY())/(r+1);return new Be(e.getX()+i,e.getY()+a)},t.moveAway=function(e,n,r){var i=e.getX(),a=e.getY();return i<n?i-=1:i+=1,a<r?a-=1:a+=1,new Be(i,a)},t.prototype.detectSolid1=function(e){var n=e[0],r=e[1],i=e[3],a=e[2],o=this.transitionsBetween(n,r),s=this.transitionsBetween(r,i),c=this.transitionsBetween(i,a),d=this.transitionsBetween(a,n),h=o,p=[a,n,r,i];return h>s&&(h=s,p[0]=n,p[1]=r,p[2]=i,p[3]=a),h>c&&(h=c,p[0]=r,p[1]=i,p[2]=a,p[3]=n),h>d&&(p[0]=i,p[1]=a,p[2]=n,p[3]=r),p},t.prototype.detectSolid2=function(e){var n=e[0],r=e[1],i=e[2],a=e[3],o=this.transitionsBetween(n,a),s=t.shiftPoint(r,i,(o+1)*4),c=t.shiftPoint(i,r,(o+1)*4),d=this.transitionsBetween(s,n),h=this.transitionsBetween(c,a);return d<h?(e[0]=n,e[1]=r,e[2]=i,e[3]=a):(e[0]=r,e[1]=i,e[2]=a,e[3]=n),e},t.prototype.correctTopRight=function(e){var n=e[0],r=e[1],i=e[2],a=e[3],o=this.transitionsBetween(n,a),s=this.transitionsBetween(r,a),c=t.shiftPoint(n,r,(s+1)*4),d=t.shiftPoint(i,r,(o+1)*4);o=this.transitionsBetween(c,a),s=this.transitionsBetween(d,a);var h=new Be(a.getX()+(i.getX()-r.getX())/(o+1),a.getY()+(i.getY()-r.getY())/(o+1)),p=new Be(a.getX()+(n.getX()-r.getX())/(s+1),a.getY()+(n.getY()-r.getY())/(s+1));if(!this.isValid(h))return this.isValid(p)?p:null;if(!this.isValid(p))return h;var x=this.transitionsBetween(c,h)+this.transitionsBetween(d,h),v=this.transitionsBetween(c,p)+this.transitionsBetween(d,p);return x>v?h:p},t.prototype.shiftToModuleCenter=function(e){var n=e[0],r=e[1],i=e[2],a=e[3],o=this.transitionsBetween(n,a)+1,s=this.transitionsBetween(i,a)+1,c=t.shiftPoint(n,r,s*4),d=t.shiftPoint(i,r,o*4);o=this.transitionsBetween(c,a)+1,s=this.transitionsBetween(d,a)+1,(o&1)===1&&(o+=1),(s&1)===1&&(s+=1);var h=(n.getX()+r.getX()+i.getX()+a.getX())/4,p=(n.getY()+r.getY()+i.getY()+a.getY())/4;n=t.moveAway(n,h,p),r=t.moveAway(r,h,p),i=t.moveAway(i,h,p),a=t.moveAway(a,h,p);var x,v;return c=t.shiftPoint(n,r,s*4),c=t.shiftPoint(c,a,o*4),x=t.shiftPoint(r,n,s*4),x=t.shiftPoint(x,i,o*4),d=t.shiftPoint(i,a,s*4),d=t.shiftPoint(d,r,o*4),v=t.shiftPoint(a,i,s*4),v=t.shiftPoint(v,n,o*4),[c,x,d,v]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,n,r,i,a,o,s){var c=m2.getInstance();return c.sampleGrid(e,o,s,.5,.5,o-.5,.5,o-.5,s-.5,.5,s-.5,n.getX(),n.getY(),a.getX(),a.getY(),i.getX(),i.getY(),r.getX(),r.getY())},t.prototype.transitionsBetween=function(e,n){var r=Math.trunc(e.getX()),i=Math.trunc(e.getY()),a=Math.trunc(n.getX()),o=Math.trunc(n.getY()),s=Math.abs(o-i)>Math.abs(a-r);if(s){var c=r;r=i,i=c,c=a,a=o,o=c}for(var d=Math.abs(a-r),h=Math.abs(o-i),p=-d/2,x=i<o?1:-1,v=r<a?1:-1,b=0,C=this.image.get(s?i:r,s?r:i),E=r,S=i;E!==a;E+=v){var N=this.image.get(s?S:E,s?E:S);if(N!==C&&(b++,C=N),p+=h,p>0){if(S===o)break;S+=x,p-=d}}return b},t})(),Hv=(function(){function t(){this.decoder=new jG}return t.prototype.decode=function(e,n){n===void 0&&(n=null);var r,i;if(n!=null&&n.has(en.PURE_BARCODE)){var a=t.extractPureBits(e.getBlackMatrix());r=this.decoder.decode(a),i=t.NO_POINTS}else{var o=new PG(e.getBlackMatrix()).detect();r=this.decoder.decode(o.getBits()),i=o.getPoints()}var s=r.getRawBytes(),c=new Dr(r.getText(),s,8*s.length,i,Ue.DATA_MATRIX,Qt.currentTimeMillis()),d=r.getByteSegments();d!=null&&c.putMetadata(wr.BYTE_SEGMENTS,d);var h=r.getECLevel();return h!=null&&c.putMetadata(wr.ERROR_CORRECTION_LEVEL,h),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var n=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(n==null||r==null)throw new he;var i=this.moduleSize(n,e),a=n[1],o=r[1],s=n[0],c=r[0],d=(c-s+1)/i,h=(o-a+1)/i;if(d<=0||h<=0)throw new he;var p=i/2;a+=p,s+=p;for(var x=new wa(d,h),v=0;v<h;v++)for(var b=a+v*i,C=0;C<d;C++)e.get(s+C*i,b)&&x.set(C,v);return x},t.moduleSize=function(e,n){for(var r=n.getWidth(),i=e[0],a=e[1];i<r&&n.get(i,a);)i++;if(i===r)throw new he;var o=i-e[0];if(o===0)throw new he;return o},t.NO_POINTS=[],t})(),BG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){BG(e,t);function e(n){return n===void 0&&(n=500),t.call(this,new Hv,n)||this}return e})(Fc);var lc;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(lc||(lc={}));var FG=(function(){function t(e,n,r){this.value=e,this.stringValue=n,this.bits=r,t.FOR_BITS.set(r,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Wi(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new qe;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(lc.L,"L",1),t.M=new t(lc.M,"M",0),t.Q=new t(lc.Q,"Q",3),t.H=new t(lc.H,"H",2),t})(),zG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d5=(function(){function t(e){this.errorCorrectionLevel=FG.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,n){return lt.bitCount(e^n)},t.decodeFormatInformation=function(e,n){var r=t.doDecodeFormatInformation(e,n);return r!==null?r:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,n^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,n){var r,i,a=Number.MAX_SAFE_INTEGER,o=0;try{for(var s=zG(t.FORMAT_INFO_DECODE_LOOKUP),c=s.next();!c.done;c=s.next()){var d=c.value,h=d[0];if(h===e||h===n)return new t(d[1]);var p=t.numBitsDiffering(e,h);p<a&&(o=d[1],a=p),e!==n&&(p=t.numBitsDiffering(n,h),p<a&&(o=d[1],a=p))}}catch(x){r={error:x}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t})(),UG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ee=(function(){function t(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.ecCodewordsPerBlock=e,this.ecBlocks=n}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,n,r=0,i=this.ecBlocks;try{for(var a=UG(i),o=a.next();!o.done;o=a.next()){var s=o.value;r+=s.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return r},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t})(),R=(function(){function t(e,n){this.count=e,this.dataCodewords=n}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t})(),HG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},il=(function(){function t(e,n){for(var r,i,a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=n,this.ecBlocks=a;var s=0,c=a[0].getECCodewordsPerBlock(),d=a[0].getECBlocks();try{for(var h=HG(d),p=h.next();!p.done;p=h.next()){var x=p.value;s+=x.getCount()*(x.getDataCodewords()+c)}}catch(v){r={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}this.totalCodewords=s}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new De;try{return this.getVersionForNumber((e-17)/4)}catch{throw new De}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new qe;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var n=Number.MAX_SAFE_INTEGER,r=0,i=0;i<t.VERSION_DECODE_INFO.length;i++){var a=t.VERSION_DECODE_INFO[i];if(a===e)return t.getVersionForNumber(i+7);var o=d5.numBitsDiffering(e,a);o<n&&(r=i+7,n=o)}return n<=3?t.getVersionForNumber(r):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),n=new wa(e);n.setRegion(0,0,9,9),n.setRegion(e-8,0,8,9),n.setRegion(0,e-8,9,8);for(var r=this.alignmentPatternCenters.length,i=0;i<r;i++)for(var a=this.alignmentPatternCenters[i]-2,o=0;o<r;o++)i===0&&(o===0||o===r-1)||i===r-1&&o===0||n.setRegion(this.alignmentPatternCenters[o]-2,a,5,5);return n.setRegion(6,9,1,e-17),n.setRegion(9,6,e-17,1),this.versionNumber>6&&(n.setRegion(e-11,0,3,6),n.setRegion(0,e-11,6,3)),n},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new ee(7,new R(1,19)),new ee(10,new R(1,16)),new ee(13,new R(1,13)),new ee(17,new R(1,9))),new t(2,Int32Array.from([6,18]),new ee(10,new R(1,34)),new ee(16,new R(1,28)),new ee(22,new R(1,22)),new ee(28,new R(1,16))),new t(3,Int32Array.from([6,22]),new ee(15,new R(1,55)),new ee(26,new R(1,44)),new ee(18,new R(2,17)),new ee(22,new R(2,13))),new t(4,Int32Array.from([6,26]),new ee(20,new R(1,80)),new ee(18,new R(2,32)),new ee(26,new R(2,24)),new ee(16,new R(4,9))),new t(5,Int32Array.from([6,30]),new ee(26,new R(1,108)),new ee(24,new R(2,43)),new ee(18,new R(2,15),new R(2,16)),new ee(22,new R(2,11),new R(2,12))),new t(6,Int32Array.from([6,34]),new ee(18,new R(2,68)),new ee(16,new R(4,27)),new ee(24,new R(4,19)),new ee(28,new R(4,15))),new t(7,Int32Array.from([6,22,38]),new ee(20,new R(2,78)),new ee(18,new R(4,31)),new ee(18,new R(2,14),new R(4,15)),new ee(26,new R(4,13),new R(1,14))),new t(8,Int32Array.from([6,24,42]),new ee(24,new R(2,97)),new ee(22,new R(2,38),new R(2,39)),new ee(22,new R(4,18),new R(2,19)),new ee(26,new R(4,14),new R(2,15))),new t(9,Int32Array.from([6,26,46]),new ee(30,new R(2,116)),new ee(22,new R(3,36),new R(2,37)),new ee(20,new R(4,16),new R(4,17)),new ee(24,new R(4,12),new R(4,13))),new t(10,Int32Array.from([6,28,50]),new ee(18,new R(2,68),new R(2,69)),new ee(26,new R(4,43),new R(1,44)),new ee(24,new R(6,19),new R(2,20)),new ee(28,new R(6,15),new R(2,16))),new t(11,Int32Array.from([6,30,54]),new ee(20,new R(4,81)),new ee(30,new R(1,50),new R(4,51)),new ee(28,new R(4,22),new R(4,23)),new ee(24,new R(3,12),new R(8,13))),new t(12,Int32Array.from([6,32,58]),new ee(24,new R(2,92),new R(2,93)),new ee(22,new R(6,36),new R(2,37)),new ee(26,new R(4,20),new R(6,21)),new ee(28,new R(7,14),new R(4,15))),new t(13,Int32Array.from([6,34,62]),new ee(26,new R(4,107)),new ee(22,new R(8,37),new R(1,38)),new ee(24,new R(8,20),new R(4,21)),new ee(22,new R(12,11),new R(4,12))),new t(14,Int32Array.from([6,26,46,66]),new ee(30,new R(3,115),new R(1,116)),new ee(24,new R(4,40),new R(5,41)),new ee(20,new R(11,16),new R(5,17)),new ee(24,new R(11,12),new R(5,13))),new t(15,Int32Array.from([6,26,48,70]),new ee(22,new R(5,87),new R(1,88)),new ee(24,new R(5,41),new R(5,42)),new ee(30,new R(5,24),new R(7,25)),new ee(24,new R(11,12),new R(7,13))),new t(16,Int32Array.from([6,26,50,74]),new ee(24,new R(5,98),new R(1,99)),new ee(28,new R(7,45),new R(3,46)),new ee(24,new R(15,19),new R(2,20)),new ee(30,new R(3,15),new R(13,16))),new t(17,Int32Array.from([6,30,54,78]),new ee(28,new R(1,107),new R(5,108)),new ee(28,new R(10,46),new R(1,47)),new ee(28,new R(1,22),new R(15,23)),new ee(28,new R(2,14),new R(17,15))),new t(18,Int32Array.from([6,30,56,82]),new ee(30,new R(5,120),new R(1,121)),new ee(26,new R(9,43),new R(4,44)),new ee(28,new R(17,22),new R(1,23)),new ee(28,new R(2,14),new R(19,15))),new t(19,Int32Array.from([6,30,58,86]),new ee(28,new R(3,113),new R(4,114)),new ee(26,new R(3,44),new R(11,45)),new ee(26,new R(17,21),new R(4,22)),new ee(26,new R(9,13),new R(16,14))),new t(20,Int32Array.from([6,34,62,90]),new ee(28,new R(3,107),new R(5,108)),new ee(26,new R(3,41),new R(13,42)),new ee(30,new R(15,24),new R(5,25)),new ee(28,new R(15,15),new R(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new ee(28,new R(4,116),new R(4,117)),new ee(26,new R(17,42)),new ee(28,new R(17,22),new R(6,23)),new ee(30,new R(19,16),new R(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new ee(28,new R(2,111),new R(7,112)),new ee(28,new R(17,46)),new ee(30,new R(7,24),new R(16,25)),new ee(24,new R(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new ee(30,new R(4,121),new R(5,122)),new ee(28,new R(4,47),new R(14,48)),new ee(30,new R(11,24),new R(14,25)),new ee(30,new R(16,15),new R(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new ee(30,new R(6,117),new R(4,118)),new ee(28,new R(6,45),new R(14,46)),new ee(30,new R(11,24),new R(16,25)),new ee(30,new R(30,16),new R(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new ee(26,new R(8,106),new R(4,107)),new ee(28,new R(8,47),new R(13,48)),new ee(30,new R(7,24),new R(22,25)),new ee(30,new R(22,15),new R(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new ee(28,new R(10,114),new R(2,115)),new ee(28,new R(19,46),new R(4,47)),new ee(28,new R(28,22),new R(6,23)),new ee(30,new R(33,16),new R(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new ee(30,new R(8,122),new R(4,123)),new ee(28,new R(22,45),new R(3,46)),new ee(30,new R(8,23),new R(26,24)),new ee(30,new R(12,15),new R(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new ee(30,new R(3,117),new R(10,118)),new ee(28,new R(3,45),new R(23,46)),new ee(30,new R(4,24),new R(31,25)),new ee(30,new R(11,15),new R(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new ee(30,new R(7,116),new R(7,117)),new ee(28,new R(21,45),new R(7,46)),new ee(30,new R(1,23),new R(37,24)),new ee(30,new R(19,15),new R(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new ee(30,new R(5,115),new R(10,116)),new ee(28,new R(19,47),new R(10,48)),new ee(30,new R(15,24),new R(25,25)),new ee(30,new R(23,15),new R(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new ee(30,new R(13,115),new R(3,116)),new ee(28,new R(2,46),new R(29,47)),new ee(30,new R(42,24),new R(1,25)),new ee(30,new R(23,15),new R(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new ee(30,new R(17,115)),new ee(28,new R(10,46),new R(23,47)),new ee(30,new R(10,24),new R(35,25)),new ee(30,new R(19,15),new R(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new ee(30,new R(17,115),new R(1,116)),new ee(28,new R(14,46),new R(21,47)),new ee(30,new R(29,24),new R(19,25)),new ee(30,new R(11,15),new R(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new ee(30,new R(13,115),new R(6,116)),new ee(28,new R(14,46),new R(23,47)),new ee(30,new R(44,24),new R(7,25)),new ee(30,new R(59,16),new R(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new ee(30,new R(12,121),new R(7,122)),new ee(28,new R(12,47),new R(26,48)),new ee(30,new R(39,24),new R(14,25)),new ee(30,new R(22,15),new R(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new ee(30,new R(6,121),new R(14,122)),new ee(28,new R(6,47),new R(34,48)),new ee(30,new R(46,24),new R(10,25)),new ee(30,new R(2,15),new R(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new ee(30,new R(17,122),new R(4,123)),new ee(28,new R(29,46),new R(14,47)),new ee(30,new R(49,24),new R(10,25)),new ee(30,new R(24,15),new R(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new ee(30,new R(4,122),new R(18,123)),new ee(28,new R(13,46),new R(32,47)),new ee(30,new R(48,24),new R(14,25)),new ee(30,new R(42,15),new R(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new ee(30,new R(20,117),new R(4,118)),new ee(28,new R(40,47),new R(7,48)),new ee(30,new R(43,24),new R(22,25)),new ee(30,new R(10,15),new R(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new ee(30,new R(19,118),new R(6,119)),new ee(28,new R(18,47),new R(31,48)),new ee(30,new R(34,24),new R(34,25)),new ee(30,new R(20,15),new R(61,16)))],t})(),Zn;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})(Zn||(Zn={}));var E3=(function(){function t(e,n){this.value=e,this.isMasked=n}return t.prototype.unmaskBitMatrix=function(e,n){for(var r=0;r<n;r++)for(var i=0;i<n;i++)this.isMasked(r,i)&&e.flip(i,r)},t.values=new Map([[Zn.DATA_MASK_000,new t(Zn.DATA_MASK_000,function(e,n){return(e+n&1)===0})],[Zn.DATA_MASK_001,new t(Zn.DATA_MASK_001,function(e,n){return(e&1)===0})],[Zn.DATA_MASK_010,new t(Zn.DATA_MASK_010,function(e,n){return n%3===0})],[Zn.DATA_MASK_011,new t(Zn.DATA_MASK_011,function(e,n){return(e+n)%3===0})],[Zn.DATA_MASK_100,new t(Zn.DATA_MASK_100,function(e,n){return(Math.floor(e/2)+Math.floor(n/3)&1)===0})],[Zn.DATA_MASK_101,new t(Zn.DATA_MASK_101,function(e,n){return e*n%6===0})],[Zn.DATA_MASK_110,new t(Zn.DATA_MASK_110,function(e,n){return e*n%6<3})],[Zn.DATA_MASK_111,new t(Zn.DATA_MASK_111,function(e,n){return(e+n+e*n%3&1)===0})]]),t})(),VG=(function(){function t(e){var n=e.getHeight();if(n<21||(n&3)!==1)throw new De;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,n=0;n<6;n++)e=this.copyBit(n,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var r=5;r>=0;r--)e=this.copyBit(8,r,e);for(var i=this.bitMatrix.getHeight(),a=0,o=i-7,r=i-1;r>=o;r--)a=this.copyBit(8,r,a);for(var n=i-8;n<i;n++)a=this.copyBit(n,8,a);if(this.parsedFormatInfo=d5.decodeFormatInformation(e,a),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new De},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),n=Math.floor((e-17)/4);if(n<=6)return il.getVersionForNumber(n);for(var r=0,i=e-11,a=5;a>=0;a--)for(var o=e-9;o>=i;o--)r=this.copyBit(o,a,r);var s=il.decodeVersionInformation(r);if(s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;r=0;for(var o=5;o>=0;o--)for(var a=e-9;a>=i;a--)r=this.copyBit(o,a,r);if(s=il.decodeVersionInformation(r),s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;throw new De},t.prototype.copyBit=function(e,n,r){var i=this.isMirror?this.bitMatrix.get(n,e):this.bitMatrix.get(e,n);return i?r<<1|1:r<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),n=this.readVersion(),r=E3.values.get(e.getDataMask()),i=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,i);for(var a=n.buildFunctionPattern(),o=!0,s=new Uint8Array(n.getTotalCodewords()),c=0,d=0,h=0,p=i-1;p>0;p-=2){p===6&&p--;for(var x=0;x<i;x++)for(var v=o?i-1-x:x,b=0;b<2;b++)a.get(p-b,v)||(h++,d<<=1,this.bitMatrix.get(p-b,v)&&(d|=1),h===8&&(s[c++]=d,h=0,d=0));o=!o}if(c!==n.getTotalCodewords())throw new De;return s},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=E3.values.get(this.parsedFormatInfo.getDataMask()),n=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,n)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,n=0,r=e.getWidth();n<r;n++)for(var i=n+1,a=e.getHeight();i<a;i++)e.get(n,i)!==e.get(i,n)&&(e.flip(i,n),e.flip(n,i))},t})(),S3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$G=(function(){function t(e,n){this.numDataCodewords=e,this.codewords=n}return t.getDataBlocks=function(e,n,r){var i,a,o,s;if(e.length!==n.getTotalCodewords())throw new qe;var c=n.getECBlocksForLevel(r),d=0,h=c.getECBlocks();try{for(var p=S3(h),x=p.next();!x.done;x=p.next()){var v=x.value;d+=v.getCount()}}catch(de){i={error:de}}finally{try{x&&!x.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}var b=new Array(d),C=0;try{for(var E=S3(h),S=E.next();!S.done;S=E.next())for(var v=S.value,N=0;N<v.getCount();N++){var k=v.getDataCodewords(),I=c.getECCodewordsPerBlock()+k;b[C++]=new t(k,new Uint8Array(I))}}catch(de){o={error:de}}finally{try{S&&!S.done&&(s=E.return)&&s.call(E)}finally{if(o)throw o.error}}for(var D=b[0].codewords.length,L=b.length-1;L>=0;){var O=b[L].codewords.length;if(O===D)break;L--}L++;for(var j=D-c.getECCodewordsPerBlock(),U=0,N=0;N<j;N++)for(var fe=0;fe<C;fe++)b[fe].codewords[N]=e[U++];for(var fe=L;fe<C;fe++)b[fe].codewords[j]=e[U++];for(var le=b[0].codewords.length,N=j;N<le;N++)for(var fe=0;fe<C;fe++){var q=fe<L?N:N+1;b[fe].codewords[q]=e[U++]}return b},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t})(),Oi;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(Oi||(Oi={}));var cn=(function(){function t(e,n,r,i){this.value=e,this.stringValue=n,this.characterCountBitsForVersions=r,this.bits=i,t.FOR_BITS.set(i,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var n=t.FOR_BITS.get(e);if(n===void 0)throw new qe;return n},t.prototype.getCharacterCountBits=function(e){var n=e.getVersionNumber(),r;return n<=9?r=0:n<=26?r=1:r=2,this.characterCountBitsForVersions[r]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(Oi.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(Oi.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(Oi.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(Oi.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(Oi.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(Oi.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(Oi.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(Oi.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(Oi.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(Oi.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t})(),GG=(function(){function t(){}return t.decode=function(e,n,r,i){var a=new u5(e),o=new st,s=new Array,c=-1,d=-1;try{var h=null,p=!1,x=void 0;do{if(a.available()<4)x=cn.TERMINATOR;else{var v=a.readBits(4);x=cn.forBits(v)}switch(x){case cn.TERMINATOR:break;case cn.FNC1_FIRST_POSITION:case cn.FNC1_SECOND_POSITION:p=!0;break;case cn.STRUCTURED_APPEND:if(a.available()<16)throw new De;c=a.readBits(8),d=a.readBits(8);break;case cn.ECI:var b=t.parseECIValue(a);if(h=$n.getCharacterSetECIByValue(b),h===null)throw new De;break;case cn.HANZI:var C=a.readBits(4),E=a.readBits(x.getCharacterCountBits(n));C===t.GB2312_SUBSET&&t.decodeHanziSegment(a,o,E);break;default:var S=a.readBits(x.getCharacterCountBits(n));switch(x){case cn.NUMERIC:t.decodeNumericSegment(a,o,S);break;case cn.ALPHANUMERIC:t.decodeAlphanumericSegment(a,o,S,p);break;case cn.BYTE:t.decodeByteSegment(a,o,S,h,s,i);break;case cn.KANJI:t.decodeKanjiSegment(a,o,S);break;default:throw new De}break}}while(x!==cn.TERMINATOR)}catch{throw new De}return new J0(e,o.toString(),s.length===0?null:s,r===null?null:r.toString(),c,d)},t.decodeHanziSegment=function(e,n,r){if(r*13>e.available())throw new De;for(var i=new Uint8Array(2*r),a=0;r>0;){var o=e.readBits(13),s=o/96<<8&4294967295|o%96;s<959?s+=41377:s+=42657,i[a]=s>>8&255,i[a+1]=s&255,a+=2,r--}try{n.append(Pi.decode(i,xt.GB2312))}catch(c){throw new De(c)}},t.decodeKanjiSegment=function(e,n,r){if(r*13>e.available())throw new De;for(var i=new Uint8Array(2*r),a=0;r>0;){var o=e.readBits(13),s=o/192<<8&4294967295|o%192;s<7936?s+=33088:s+=49472,i[a]=s>>8,i[a+1]=s,a+=2,r--}try{n.append(Pi.decode(i,xt.SHIFT_JIS))}catch(c){throw new De(c)}},t.decodeByteSegment=function(e,n,r,i,a,o){if(8*r>e.available())throw new De;for(var s=new Uint8Array(r),c=0;c<r;c++)s[c]=e.readBits(8);var d;i===null?d=xt.guessEncoding(s,o):d=i.getName();try{n.append(Pi.decode(s,d))}catch(h){throw new De(h)}a.push(s)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new De;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,n,r,i){for(var a=n.length();r>1;){if(e.available()<11)throw new De;var o=e.readBits(11);n.append(t.toAlphaNumericChar(Math.floor(o/45))),n.append(t.toAlphaNumericChar(o%45)),r-=2}if(r===1){if(e.available()<6)throw new De;n.append(t.toAlphaNumericChar(e.readBits(6)))}if(i)for(var s=a;s<n.length();s++)n.charAt(s)==="%"&&(s<n.length()-1&&n.charAt(s+1)==="%"?n.deleteCharAt(s+1):n.setCharAt(s,""))},t.decodeNumericSegment=function(e,n,r){for(;r>=3;){if(e.available()<10)throw new De;var i=e.readBits(10);if(i>=1e3)throw new De;n.append(t.toAlphaNumericChar(Math.floor(i/100))),n.append(t.toAlphaNumericChar(Math.floor(i/10)%10)),n.append(t.toAlphaNumericChar(i%10)),r-=3}if(r===2){if(e.available()<7)throw new De;var a=e.readBits(7);if(a>=100)throw new De;n.append(t.toAlphaNumericChar(Math.floor(a/10))),n.append(t.toAlphaNumericChar(a%10))}else if(r===1){if(e.available()<4)throw new De;var o=e.readBits(4);if(o>=10)throw new De;n.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var n=e.readBits(8);if((n&128)===0)return n&127;if((n&192)===128){var r=e.readBits(8);return(n&63)<<8&4294967295|r}if((n&224)===192){var i=e.readBits(16);return(n&31)<<16&4294967295|i}throw new De},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t})(),f5=(function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var n=e[0];e[0]=e[2],e[2]=n}},t})(),A3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},WG=(function(){function t(){this.rsDecoder=new Q0(ri.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,n){return this.decodeBitMatrix(wa.parseFromBooleanArray(e),n)},t.prototype.decodeBitMatrix=function(e,n){var r=new VG(e),i=null;try{return this.decodeBitMatrixParser(r,n)}catch(o){i=o}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();var a=this.decodeBitMatrixParser(r,n);return a.setOther(new f5(!0)),a}catch(o){throw i!==null?i:o}},t.prototype.decodeBitMatrixParser=function(e,n){var r,i,a,o,s=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),d=e.readCodewords(),h=$G.getDataBlocks(d,s,c),p=0;try{for(var x=A3(h),v=x.next();!v.done;v=x.next()){var b=v.value;p+=b.getNumDataCodewords()}}catch(L){r={error:L}}finally{try{v&&!v.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}var C=new Uint8Array(p),E=0;try{for(var S=A3(h),N=S.next();!N.done;N=S.next()){var b=N.value,k=b.getCodewords(),I=b.getNumDataCodewords();this.correctErrors(k,I);for(var D=0;D<I;D++)C[E++]=k[D]}}catch(L){a={error:L}}finally{try{N&&!N.done&&(o=S.return)&&o.call(S)}finally{if(a)throw a.error}}return GG.decode(C,s,c,n)},t.prototype.correctErrors=function(e,n){var r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-n)}catch{throw new tr}for(var i=0;i<n;i++)e[i]=r[i]},t})(),qG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),XG=(function(t){qG(e,t);function e(n,r,i){var a=t.call(this,n,r)||this;return a.estimatedModuleSize=i,a}return e.prototype.aboutEquals=function(n,r,i){if(Math.abs(r-this.getY())<=n&&Math.abs(i-this.getX())<=n){var a=Math.abs(n-this.estimatedModuleSize);return a<=1||a<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(n,r,i){var a=(this.getX()+r)/2,o=(this.getY()+n)/2,s=(this.estimatedModuleSize+i)/2;return new e(a,o,s)},e})(Be),KG=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},YG=(function(){function t(e,n,r,i,a,o,s){this.image=e,this.startX=n,this.startY=r,this.width=i,this.height=a,this.moduleSize=o,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,n=this.height,r=this.width,i=e+r,a=this.startY+n/2,o=new Int32Array(3),s=this.image,c=0;c<n;c++){var d=a+((c&1)===0?Math.floor((c+1)/2):-Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var h=e;h<i&&!s.get(h,d);)h++;for(var p=0;h<i;){if(s.get(h,d))if(p===1)o[1]++;else if(p===2){if(this.foundPatternCross(o)){var x=this.handlePossibleCenter(o,d,h);if(x!==null)return x}o[0]=o[2],o[1]=1,o[2]=0,p=1}else o[++p]++;else p===1&&p++,o[p]++;h++}if(this.foundPatternCross(o)){var x=this.handlePossibleCenter(o,d,i);if(x!==null)return x}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new he},t.centerFromEnd=function(e,n){return n-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var n=this.moduleSize,r=n/2,i=0;i<3;i++)if(Math.abs(n-e[i])>=r)return!1;return!0},t.prototype.crossCheckVertical=function(e,n,r,i){var a=this.image,o=a.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var c=e;c>=0&&a.get(n,c)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&!a.get(n,c)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<o&&a.get(n,c)&&s[1]<=r;)s[1]++,c++;if(c===o||s[1]>r)return NaN;for(;c<o&&!a.get(n,c)&&s[2]<=r;)s[2]++,c++;if(s[2]>r)return NaN;var d=s[0]+s[1]+s[2];return 5*Math.abs(d-i)>=2*i?NaN:this.foundPatternCross(s)?t.centerFromEnd(s,c):NaN},t.prototype.handlePossibleCenter=function(e,n,r){var i,a,o=e[0]+e[1]+e[2],s=t.centerFromEnd(e,r),c=this.crossCheckVertical(n,s,2*e[1],o);if(!isNaN(c)){var d=(e[0]+e[1]+e[2])/3;try{for(var h=KG(this.possibleCenters),p=h.next();!p.done;p=h.next()){var x=p.value;if(x.aboutEquals(d,c,s))return x.combineEstimate(c,s,d)}}catch(b){i={error:b}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}var v=new XG(s,c,d);this.possibleCenters.push(v),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(v)}return null},t})(),ZG=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),JG=(function(t){ZG(e,t);function e(n,r,i,a){var o=t.call(this,n,r)||this;return o.estimatedModuleSize=i,o.count=a,a===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(n,r,i){if(Math.abs(r-this.getY())<=n&&Math.abs(i-this.getX())<=n){var a=Math.abs(n-this.estimatedModuleSize);return a<=1||a<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(n,r,i){var a=this.count+1,o=(this.count*this.getX()+r)/a,s=(this.count*this.getY()+n)/a,c=(this.count*this.estimatedModuleSize+i)/a;return new e(o,s,c,a)},e})(Be),QG=(function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t})(),Fu=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eW=(function(){function t(e,n){this.image=e,this.resultPointCallback=n,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=n}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var n=e!=null&&e.get(en.TRY_HARDER)!==void 0,r=e!=null&&e.get(en.PURE_BARCODE)!==void 0,i=this.image,a=i.getHeight(),o=i.getWidth(),s=Math.floor(3*a/(4*t.MAX_MODULES));(s<t.MIN_SKIP||n)&&(s=t.MIN_SKIP);for(var c=!1,d=new Int32Array(5),h=s-1;h<a&&!c;h+=s){d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0;for(var p=0,x=0;x<o;x++)if(i.get(x,h))(p&1)===1&&p++,d[p]++;else if((p&1)===0)if(p===4)if(t.foundPatternCross(d)){var v=this.handlePossibleCenter(d,h,x,r);if(v===!0)if(s=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var b=this.findRowSkip();b>d[2]&&(h+=b-d[2]-s,x=o-1)}else{d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,p=3;continue}p=0,d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0}else d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,p=3;else d[++p]++;else d[p]++;if(t.foundPatternCross(d)){var v=this.handlePossibleCenter(d,h,o,r);v===!0&&(s=d[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var C=this.selectBestPatterns();return Be.orderBestPatterns(C),new QG(C)},t.centerFromEnd=function(e,n){return n-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var n=0,r=0;r<5;r++){var i=e[r];if(i===0)return!1;n+=i}if(n<7)return!1;var a=n/7,o=a/2;return Math.abs(a-e[0])<o&&Math.abs(a-e[1])<o&&Math.abs(3*a-e[2])<3*o&&Math.abs(a-e[3])<o&&Math.abs(a-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,n,r,i){for(var a=this.getCrossCheckStateCount(),o=0,s=this.image;e>=o&&n>=o&&s.get(n-o,e-o);)a[2]++,o++;if(e<o||n<o)return!1;for(;e>=o&&n>=o&&!s.get(n-o,e-o)&&a[1]<=r;)a[1]++,o++;if(e<o||n<o||a[1]>r)return!1;for(;e>=o&&n>=o&&s.get(n-o,e-o)&&a[0]<=r;)a[0]++,o++;if(a[0]>r)return!1;var c=s.getHeight(),d=s.getWidth();for(o=1;e+o<c&&n+o<d&&s.get(n+o,e+o);)a[2]++,o++;if(e+o>=c||n+o>=d)return!1;for(;e+o<c&&n+o<d&&!s.get(n+o,e+o)&&a[3]<r;)a[3]++,o++;if(e+o>=c||n+o>=d||a[3]>=r)return!1;for(;e+o<c&&n+o<d&&s.get(n+o,e+o)&&a[4]<r;)a[4]++,o++;if(a[4]>=r)return!1;var h=a[0]+a[1]+a[2]+a[3]+a[4];return Math.abs(h-i)<2*i&&t.foundPatternCross(a)},t.prototype.crossCheckVertical=function(e,n,r,i){for(var a=this.image,o=a.getHeight(),s=this.getCrossCheckStateCount(),c=e;c>=0&&a.get(n,c);)s[2]++,c--;if(c<0)return NaN;for(;c>=0&&!a.get(n,c)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&a.get(n,c)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<o&&a.get(n,c);)s[2]++,c++;if(c===o)return NaN;for(;c<o&&!a.get(n,c)&&s[3]<r;)s[3]++,c++;if(c===o||s[3]>=r)return NaN;for(;c<o&&a.get(n,c)&&s[4]<r;)s[4]++,c++;if(s[4]>=r)return NaN;var d=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(d-i)>=2*i?NaN:t.foundPatternCross(s)?t.centerFromEnd(s,c):NaN},t.prototype.crossCheckHorizontal=function(e,n,r,i){for(var a=this.image,o=a.getWidth(),s=this.getCrossCheckStateCount(),c=e;c>=0&&a.get(c,n);)s[2]++,c--;if(c<0)return NaN;for(;c>=0&&!a.get(c,n)&&s[1]<=r;)s[1]++,c--;if(c<0||s[1]>r)return NaN;for(;c>=0&&a.get(c,n)&&s[0]<=r;)s[0]++,c--;if(s[0]>r)return NaN;for(c=e+1;c<o&&a.get(c,n);)s[2]++,c++;if(c===o)return NaN;for(;c<o&&!a.get(c,n)&&s[3]<r;)s[3]++,c++;if(c===o||s[3]>=r)return NaN;for(;c<o&&a.get(c,n)&&s[4]<r;)s[4]++,c++;if(s[4]>=r)return NaN;var d=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(d-i)>=i?NaN:t.foundPatternCross(s)?t.centerFromEnd(s,c):NaN},t.prototype.handlePossibleCenter=function(e,n,r,i){var a=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,r),s=this.crossCheckVertical(n,Math.floor(o),e[2],a);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),e[2],a),!isNaN(o)&&(!i||this.crossCheckDiagonal(Math.floor(s),Math.floor(o),e[2],a)))){for(var c=a/7,d=!1,h=this.possibleCenters,p=0,x=h.length;p<x;p++){var v=h[p];if(v.aboutEquals(c,s,o)){h[p]=v.combineEstimate(s,o,c),d=!0;break}}if(!d){var b=new JG(o,s,c);h.push(b),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(b)}return!0}return!1},t.prototype.findRowSkip=function(){var e,n,r=this.possibleCenters.length;if(r<=1)return 0;var i=null;try{for(var a=Fu(this.possibleCenters),o=a.next();!o.done;o=a.next()){var s=o.value;if(s.getCount()>=t.CENTER_QUORUM)if(i==null)i=s;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-s.getX())-Math.abs(i.getY()-s.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,n,r,i,a=0,o=0,s=this.possibleCenters.length;try{for(var c=Fu(this.possibleCenters),d=c.next();!d.done;d=c.next()){var h=d.value;h.getCount()>=t.CENTER_QUORUM&&(a++,o+=h.getEstimatedModuleSize())}}catch(C){e={error:C}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}if(a<3)return!1;var p=o/s,x=0;try{for(var v=Fu(this.possibleCenters),b=v.next();!b.done;b=v.next()){var h=b.value;x+=Math.abs(h.getEstimatedModuleSize()-p)}}catch(C){r={error:C}}finally{try{b&&!b.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}return x<=.05*o},t.prototype.selectBestPatterns=function(){var e,n,r,i,a=this.possibleCenters.length;if(a<3)throw new he;var o=this.possibleCenters,s;if(a>3){var c=0,d=0;try{for(var h=Fu(this.possibleCenters),p=h.next();!p.done;p=h.next()){var x=p.value,v=x.getEstimatedModuleSize();c+=v,d+=v*v}}catch(D){e={error:D}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}s=c/a;var b=Math.sqrt(d/a-s*s);o.sort(function(D,L){var O=Math.abs(L.getEstimatedModuleSize()-s),j=Math.abs(D.getEstimatedModuleSize()-s);return O<j?-1:O>j?1:0});for(var C=Math.max(.2*s,b),E=0;E<o.length&&o.length>3;E++){var S=o[E];Math.abs(S.getEstimatedModuleSize()-s)>C&&(o.splice(E,1),E--)}}if(o.length>3){var c=0;try{for(var N=Fu(o),k=N.next();!k.done;k=N.next()){var I=k.value;c+=I.getEstimatedModuleSize()}}catch(L){r={error:L}}finally{try{k&&!k.done&&(i=N.return)&&i.call(N)}finally{if(r)throw r.error}}s=c/o.length,o.sort(function(L,O){if(O.getCount()===L.getCount()){var j=Math.abs(O.getEstimatedModuleSize()-s),U=Math.abs(L.getEstimatedModuleSize()-s);return j<U?1:j>U?-1:0}else return O.getCount()-L.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t})(),tW=(function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(en.NEED_RESULT_POINT_CALLBACK);var n=new eW(this.image,this.resultPointCallback),r=n.find(e);return this.processFinderPatternInfo(r)},t.prototype.processFinderPatternInfo=function(e){var n=e.getTopLeft(),r=e.getTopRight(),i=e.getBottomLeft(),a=this.calculateModuleSize(n,r,i);if(a<1)throw new he("No pattern found in proccess finder.");var o=t.computeDimension(n,r,i,a),s=il.getProvisionalVersionForDimension(o),c=s.getDimensionForVersion()-7,d=null;if(s.getAlignmentPatternCenters().length>0)for(var h=r.getX()-n.getX()+i.getX(),p=r.getY()-n.getY()+i.getY(),x=1-3/c,v=Math.floor(n.getX()+x*(h-n.getX())),b=Math.floor(n.getY()+x*(p-n.getY())),C=4;C<=16;C<<=1)try{d=this.findAlignmentInRegion(a,v,b,C);break}catch(k){if(!(k instanceof he))throw k}var E=t.createTransform(n,r,i,d,o),S=t.sampleGrid(this.image,E,o),N;return d===null?N=[i,n,r]:N=[i,n,r,d],new p2(S,N)},t.createTransform=function(e,n,r,i,a){var o=a-3.5,s,c,d,h;return i!==null?(s=i.getX(),c=i.getY(),d=o-3,h=d):(s=n.getX()-e.getX()+r.getX(),c=n.getY()-e.getY()+r.getY(),d=o,h=o),o5.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,d,h,3.5,o,e.getX(),e.getY(),n.getX(),n.getY(),s,c,r.getX(),r.getY())},t.sampleGrid=function(e,n,r){var i=m2.getInstance();return i.sampleGridWithTransform(e,r,r,n)},t.computeDimension=function(e,n,r,i){var a=Et.round(Be.distance(e,n)/i),o=Et.round(Be.distance(e,r)/i),s=Math.floor((a+o)/2)+7;switch(s&3){case 0:s++;break;case 2:s--;break;case 3:throw new he("Dimensions could be not found.")}return s},t.prototype.calculateModuleSize=function(e,n,r){return(this.calculateModuleSizeOneWay(e,n)+this.calculateModuleSizeOneWay(e,r))/2},t.prototype.calculateModuleSizeOneWay=function(e,n){var r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(n.getX()),Math.floor(n.getY())),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(r)?i/7:isNaN(i)?r/7:(r+i)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,n,r,i){var a=this.sizeOfBlackWhiteBlackRun(e,n,r,i),o=1,s=e-(r-e);s<0?(o=e/(e-s),s=0):s>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(s-e),s=this.image.getWidth()-1);var c=Math.floor(n-(i-n)*o);return o=1,c<0?(o=n/(n-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-n)/(c-n),c=this.image.getHeight()-1),s=Math.floor(e+(s-e)*o),a+=this.sizeOfBlackWhiteBlackRun(e,n,s,c),a-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,n,r,i){var a=Math.abs(i-n)>Math.abs(r-e);if(a){var o=e;e=n,n=o,o=r,r=i,i=o}for(var s=Math.abs(r-e),c=Math.abs(i-n),d=-s/2,h=e<r?1:-1,p=n<i?1:-1,x=0,v=r+h,b=e,C=n;b!==v;b+=h){var E=a?C:b,S=a?b:C;if(x===1===this.image.get(E,S)){if(x===2)return Et.distance(b,C,e,n);x++}if(d+=c,d>0){if(C===i)break;C+=p,d-=s}}return x===2?Et.distance(r+h,i,e,n):NaN},t.prototype.findAlignmentInRegion=function(e,n,r,i){var a=Math.floor(i*e),o=Math.max(0,n-a),s=Math.min(this.image.getWidth()-1,n+a);if(s-o<e*3)throw new he("Alignment top exceeds estimated module size.");var c=Math.max(0,r-a),d=Math.min(this.image.getHeight()-1,r+a);if(d-c<e*3)throw new he("Alignment bottom exceeds estimated module size.");var h=new YG(this.image,o,c,s-o,d-c,e,this.resultPointCallback);return h.find()},t})(),Vv=(function(){function t(){this.decoder=new WG}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,n){var r,i;if(n!=null&&n.get(en.PURE_BARCODE)!==void 0){var a=t.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(a,n),i=t.NO_POINTS}else{var o=new tW(e.getBlackMatrix()).detect(n);r=this.decoder.decodeBitMatrix(o.getBits(),n),i=o.getPoints()}r.getOther()instanceof f5&&r.getOther().applyMirroredCorrection(i);var s=new Dr(r.getText(),r.getRawBytes(),void 0,i,Ue.QR_CODE,void 0),c=r.getByteSegments();c!==null&&s.putMetadata(wr.BYTE_SEGMENTS,c);var d=r.getECLevel();return d!==null&&s.putMetadata(wr.ERROR_CORRECTION_LEVEL,d),r.hasStructuredAppend()&&(s.putMetadata(wr.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),s.putMetadata(wr.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),s},t.prototype.reset=function(){},t.extractPureBits=function(e){var n=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(n===null||r===null)throw new he;var i=this.moduleSize(n,e),a=n[1],o=r[1],s=n[0],c=r[0];if(s>=c||a>=o)throw new he;if(o-a!==c-s&&(c=s+(o-a),c>=e.getWidth()))throw new he;var d=Math.round((c-s+1)/i),h=Math.round((o-a+1)/i);if(d<=0||h<=0)throw new he;if(h!==d)throw new he;var p=Math.floor(i/2);a+=p,s+=p;var x=s+Math.floor((d-1)*i)-c;if(x>0){if(x>p)throw new he;s-=x}var v=a+Math.floor((h-1)*i)-o;if(v>0){if(v>p)throw new he;a-=v}for(var b=new wa(d,h),C=0;C<h;C++)for(var E=a+Math.floor(C*i),S=0;S<d;S++)e.get(s+Math.floor(S*i),E)&&b.set(S,C);return b},t.moduleSize=function(e,n){for(var r=n.getHeight(),i=n.getWidth(),a=e[0],o=e[1],s=!0,c=0;a<i&&o<r;){if(s!==n.get(a,o)){if(++c===5)break;s=!s}a++,o++}if(a===i||o===r)throw new he;return(a-e[0])/7},t.NO_POINTS=new Array,t})(),nW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},yt=(function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return Et.sum(e)},t.toIntArray=function(e){var n,r;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var i=new Int32Array(e.length),a=0;try{for(var o=nW(e),s=o.next();!s.done;s=o.next()){var c=s.value;i[a++]=c}}catch(d){n={error:d}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.getCodeword=function(e){var n=Gn.binarySearch(t.SYMBOL_TABLE,e&262143);return n<0?-1:(t.CODEWORD_TABLE[n]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t})(),rW=(function(){function t(e,n){this.bits=e,this.points=n}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t})(),iW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aW=(function(){function t(){}return t.detectMultiple=function(e,n,r){var i=e.getBlackMatrix(),a=t.detect(r,i);return a.length||(i=i.clone(),i.rotate180(),a=t.detect(r,i)),new rW(i,a)},t.detect=function(e,n){for(var r,i,a=new Array,o=0,s=0,c=!1;o<n.getHeight();){var d=t.findVertices(n,o,s);if(d[0]==null&&d[3]==null){if(!c)break;c=!1,s=0;try{for(var h=(r=void 0,iW(a)),p=h.next();!p.done;p=h.next()){var x=p.value;x[1]!=null&&(o=Math.trunc(Math.max(o,x[1].getY()))),x[3]!=null&&(o=Math.max(o,Math.trunc(x[3].getY())))}}catch(v){r={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}o+=t.ROW_STEP;continue}if(c=!0,a.push(d),!e)break;d[2]!=null?(s=Math.trunc(d[2].getX()),o=Math.trunc(d[2].getY())):(s=Math.trunc(d[4].getX()),o=Math.trunc(d[4].getY()))}return a},t.findVertices=function(e,n,r){var i=e.getHeight(),a=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,i,a,n,r,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(r=Math.trunc(o[4].getX()),n=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,i,a,n,r,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,n,r){for(var i=0;i<r.length;i++)e[r[i]]=n[i]},t.findRowsWithPattern=function(e,n,r,i,a,o){for(var s=new Array(4),c=!1,d=new Int32Array(o.length);i<n;i+=t.ROW_STEP){var h=t.findGuardPattern(e,a,i,r,!1,o,d);if(h!=null){for(;i>0;){var p=t.findGuardPattern(e,a,--i,r,!1,o,d);if(p!=null)h=p;else{i++;break}}s[0]=new Be(h[0],i),s[1]=new Be(h[1],i),c=!0;break}}var x=i+1;if(c){for(var v=0,p=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);x<n;x++){var h=t.findGuardPattern(e,p[0],x,r,!1,o,d);if(h!=null&&Math.abs(p[0]-h[0])<t.MAX_PATTERN_DRIFT&&Math.abs(p[1]-h[1])<t.MAX_PATTERN_DRIFT)p=h,v=0;else{if(v>t.SKIPPED_ROW_COUNT_MAX)break;v++}}x-=v+1,s[2]=new Be(p[0],x),s[3]=new Be(p[1],x)}return x-i<t.BARCODE_MIN_HEIGHT&&Gn.fill(s,null),s},t.findGuardPattern=function(e,n,r,i,a,o,s){Gn.fillWithin(s,0,s.length,0);for(var c=n,d=0;e.get(c,r)&&c>0&&d++<t.MAX_PIXEL_DRIFT;)c--;for(var h=c,p=0,x=o.length,v=a;h<i;h++){var b=e.get(h,r);if(b!==v)s[p]++;else{if(p===x-1){if(t.patternMatchVariance(s,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,h]);c+=s[0]+s[1],Qt.arraycopy(s,2,s,0,p-1),s[p-1]=0,s[p]=0,p--}else p++;s[p]=1,v=!v}}return p===x-1&&t.patternMatchVariance(s,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,h-1]):null},t.patternMatchVariance=function(e,n,r){for(var i=e.length,a=0,o=0,s=0;s<i;s++)a+=e[s],o+=n[s];if(a<o)return 1/0;var c=a/o;r*=c;for(var d=0,h=0;h<i;h++){var p=e[h],x=n[h]*c,v=p>x?p-x:x-p;if(v>r)return 1/0;d+=v}return d/a},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t})(),oW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ks=(function(){function t(e,n){if(n.length===0)throw new qe;this.field=e;var r=n.length;if(r>1&&n[0]===0){for(var i=1;i<r&&n[i]===0;)i++;i===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-i),Qt.arraycopy(n,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var n,r;if(e===0)return this.getCoefficient(0);if(e===1){var i=0;try{for(var a=oW(this.coefficients),o=a.next();!o.done;o=a.next()){var s=o.value;i=this.field.add(i,s)}}catch(p){n={error:p}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}for(var c=this.coefficients[0],d=this.coefficients.length,h=1;h<d;h++)c=this.field.add(this.field.multiply(e,c),this.coefficients[h]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new qe("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var n=this.coefficients,r=e.coefficients;if(n.length>r.length){var i=n;n=r,r=i}var a=new Int32Array(r.length),o=r.length-n.length;Qt.arraycopy(r,0,a,0,o);for(var s=o;s<r.length;s++)a[s]=this.field.add(n[s-o],r[s]);return new t(this.field,a)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new qe("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new qe("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var n=this.coefficients,r=n.length,i=e.coefficients,a=i.length,o=new Int32Array(r+a-1),s=0;s<r;s++)for(var c=n[s],d=0;d<a;d++)o[s+d]=this.field.add(o[s+d],this.field.multiply(c,i[d]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,n=new Int32Array(e),r=0;r<e;r++)n[r]=this.field.subtract(0,this.coefficients[r]);return new t(this.field,n)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var n=this.coefficients.length,r=new Int32Array(n),i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],e);return new t(this.field,r)},t.prototype.multiplyByMonomial=function(e,n){if(e<0)throw new qe;if(n===0)return new t(this.field,new Int32Array([0]));for(var r=this.coefficients.length,i=new Int32Array(r+e),a=0;a<r;a++)i[a]=this.field.multiply(this.coefficients[a],n);return new t(this.field,i)},t.prototype.toString=function(){for(var e=new st,n=this.getDegree();n>=0;n--){var r=this.getCoefficient(n);r!==0&&(r<0?(e.append(" - "),r=-r):e.length()>0&&e.append(" + "),(n===0||r!==1)&&e.append(r),n!==0&&(n===1?e.append("x"):(e.append("x^"),e.append(n))))}return e.toString()},t})(),sW=(function(){function t(){}return t.prototype.add=function(e,n){return(e+n)%this.modulus},t.prototype.subtract=function(e,n){return(this.modulus+e-n)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new qe;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new a5;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,n){return e===0||n===0?0:this.expTable[(this.logTable[e]+this.logTable[n])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t})(),lW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),cW=(function(t){lW(e,t);function e(n,r){var i=t.call(this)||this;i.modulus=n,i.expTable=new Int32Array(n),i.logTable=new Int32Array(n);for(var a=1,o=0;o<n;o++)i.expTable[o]=a,a=a*r%n;for(var o=0;o<n-1;o++)i.logTable[i.expTable[o]]=o;return i.zero=new Ks(i,new Int32Array([0])),i.one=new Ks(i,new Int32Array([1])),i}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(n,r){if(n<0)throw new qe;if(r===0)return this.zero;var i=new Int32Array(n+1);return i[0]=r,new Ks(this,i)},e.PDF417_GF=new e(yt.NUMBER_OF_CODEWORDS,3),e})(sW),uW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dW=(function(){function t(){this.field=cW.PDF417_GF}return t.prototype.decode=function(e,n,r){for(var i,a,o=new Ks(this.field,e),s=new Int32Array(n),c=!1,d=n;d>0;d--){var h=o.evaluateAt(this.field.exp(d));s[n-d]=h,h!==0&&(c=!0)}if(!c)return 0;var p=this.field.getOne();if(r!=null)try{for(var x=uW(r),v=x.next();!v.done;v=x.next()){var b=v.value,C=this.field.exp(e.length-1-b),E=new Ks(this.field,new Int32Array([this.field.subtract(0,C),1]));p=p.multiply(E)}}catch(j){i={error:j}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}for(var S=new Ks(this.field,s),N=this.runEuclideanAlgorithm(this.field.buildMonomial(n,1),S,n),k=N[0],I=N[1],D=this.findErrorLocations(k),L=this.findErrorMagnitudes(I,k,D),d=0;d<D.length;d++){var O=e.length-1-this.field.log(D[d]);if(O<0)throw tr.getChecksumInstance();e[O]=this.field.subtract(e[O],L[d])}return D.length},t.prototype.runEuclideanAlgorithm=function(e,n,r){if(e.getDegree()<n.getDegree()){var i=e;e=n,n=i}for(var a=e,o=n,s=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(r/2);){var d=a,h=s;if(a=o,s=c,a.isZero())throw tr.getChecksumInstance();o=d;for(var p=this.field.getZero(),x=a.getCoefficient(a.getDegree()),v=this.field.inverse(x);o.getDegree()>=a.getDegree()&&!o.isZero();){var b=o.getDegree()-a.getDegree(),C=this.field.multiply(o.getCoefficient(o.getDegree()),v);p=p.add(this.field.buildMonomial(b,C)),o=o.subtract(a.multiplyByMonomial(b,C))}c=p.multiply(s).subtract(h).negative()}var E=c.getCoefficient(0);if(E===0)throw tr.getChecksumInstance();var S=this.field.inverse(E),N=c.multiply(S),k=o.multiply(S);return[N,k]},t.prototype.findErrorLocations=function(e){for(var n=e.getDegree(),r=new Int32Array(n),i=0,a=1;a<this.field.getSize()&&i<n;a++)e.evaluateAt(a)===0&&(r[i]=this.field.inverse(a),i++);if(i!==n)throw tr.getChecksumInstance();return r},t.prototype.findErrorMagnitudes=function(e,n,r){for(var i=n.getDegree(),a=new Int32Array(i),o=1;o<=i;o++)a[i-o]=this.field.multiply(o,n.getCoefficient(o));for(var s=new Ks(this.field,a),c=r.length,d=new Int32Array(c),o=0;o<c;o++){var h=this.field.inverse(r[o]),p=this.field.subtract(0,e.evaluateAt(h)),x=this.field.inverse(s.evaluateAt(h));d[o]=this.field.multiply(p,x)}return d},t})(),$v=(function(){function t(e,n,r,i,a){e instanceof t?this.constructor_2(e):this.constructor_1(e,n,r,i,a)}return t.prototype.constructor_1=function(e,n,r,i,a){var o=n==null||r==null,s=i==null||a==null;if(o&&s)throw new he;o?(n=new Be(0,i.getY()),r=new Be(0,a.getY())):s&&(i=new Be(e.getWidth()-1,n.getY()),a=new Be(e.getWidth()-1,r.getY())),this.image=e,this.topLeft=n,this.bottomLeft=r,this.topRight=i,this.bottomRight=a,this.minX=Math.trunc(Math.min(n.getX(),r.getX())),this.maxX=Math.trunc(Math.max(i.getX(),a.getX())),this.minY=Math.trunc(Math.min(n.getY(),i.getY())),this.maxY=Math.trunc(Math.max(r.getY(),a.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,n){return e==null?n:n==null?e:new t(e.image,e.topLeft,e.bottomLeft,n.topRight,n.bottomRight)},t.prototype.addMissingRows=function(e,n,r){var i=this.topLeft,a=this.bottomLeft,o=this.topRight,s=this.bottomRight;if(e>0){var c=r?this.topLeft:this.topRight,d=Math.trunc(c.getY()-e);d<0&&(d=0);var h=new Be(c.getX(),d);r?i=h:o=h}if(n>0){var p=r?this.bottomLeft:this.bottomRight,x=Math.trunc(p.getY()+n);x>=this.image.getHeight()&&(x=this.image.getHeight()-1);var v=new Be(p.getX(),x);r?a=v:s=v}return new t(this.image,i,a,o,s)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t})(),fW=(function(){function t(e,n,r,i){this.columnCount=e,this.errorCorrectionLevel=i,this.rowCountUpperPart=n,this.rowCountLowerPart=r,this.rowCount=n+r}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t})(),x2=(function(){function t(){this.buffer=""}return t.form=function(e,n){var r=-1;function i(o,s,c,d,h,p){if(o==="%%")return"%";if(n[++r]!==void 0){o=d?parseInt(d.substr(1)):void 0;var x=h?parseInt(h.substr(1)):void 0,v;switch(p){case"s":v=n[r];break;case"c":v=n[r][0];break;case"f":v=parseFloat(n[r]).toFixed(o);break;case"p":v=parseFloat(n[r]).toPrecision(o);break;case"e":v=parseFloat(n[r]).toExponential(o);break;case"x":v=parseInt(n[r]).toString(x||16);break;case"d":v=parseFloat(parseInt(n[r],x||10).toPrecision(o)).toFixed(0);break}v=typeof v=="object"?JSON.stringify(v):(+v).toString(x);for(var b=parseInt(c),C=c&&c[0]+""=="0"?"0":" ";v.length<b;)v=s!==void 0?v+C:C+v;return v}}var a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,i)},t.prototype.format=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.buffer+=t.form(e,n)},t.prototype.toString=function(){return this.buffer},t})(),hW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h5=(function(){function t(e){this.boundingBox=new $v(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var n=this.getCodeword(e);if(n!=null)return n;for(var r=1;r<t.MAX_NEARBY_DISTANCE;r++){var i=this.imageRowToCodewordIndex(e)-r;if(i>=0&&(n=this.codewords[i],n!=null)||(i=this.imageRowToCodewordIndex(e)+r,i<this.codewords.length&&(n=this.codewords[i],n!=null)))return n}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,n){this.codewords[this.imageRowToCodewordIndex(e)]=n},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,n,r=new x2,i=0;try{for(var a=hW(this.codewords),o=a.next();!o.done;o=a.next()){var s=o.value;if(s==null){r.format("%3d:    |   %n",i++);continue}r.format("%3d: %3d|%3d%n",i++,s.getRowNumber(),s.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return r.toString()},t.MAX_NEARBY_DISTANCE=5,t})(),pW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mW=function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a},Yu=(function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var n=this.values.get(e);n==null&&(n=0),n++,this.values.set(e,n)},t.prototype.getValue=function(){var e,n,r=-1,i=new Array,a=function(p,x){var v={getKey:function(){return p},getValue:function(){return x}};v.getValue()>r?(r=v.getValue(),i=[],i.push(v.getKey())):v.getValue()===r&&i.push(v.getKey())};try{for(var o=pW(this.values.entries()),s=o.next();!s.done;s=o.next()){var c=mW(s.value,2),d=c[0],h=c[1];a(d,h)}}catch(p){e={error:p}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return yt.toIntArray(i)},t.prototype.getConfidence=function(e){return this.values.get(e)},t})(),gW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),lx=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_3=(function(t){gW(e,t);function e(n,r){var i=t.call(this,n)||this;return i._isLeft=r,i}return e.prototype.setRowNumbers=function(){var n,r;try{for(var i=lx(this.getCodewords()),a=i.next();!a.done;a=i.next()){var o=a.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(n){var r=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(r,n);for(var i=this.getBoundingBox(),a=this._isLeft?i.getTopLeft():i.getTopRight(),o=this._isLeft?i.getBottomLeft():i.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(a.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=-1,h=1,p=0,x=s;x<c;x++)if(r[x]!=null){var v=r[x],b=v.getRowNumber()-d;if(b===0)p++;else if(b===1)h=Math.max(h,p),p=1,d=v.getRowNumber();else if(b<0||v.getRowNumber()>=n.getRowCount()||b>x)r[x]=null;else{var C=void 0;h>2?C=(h-2)*b:C=b;for(var E=C>=x,S=1;S<=C&&!E;S++)E=r[x-S]!=null;E?r[x]=null:(d=v.getRowNumber(),p=1)}}},e.prototype.getRowHeights=function(){var n,r,i=this.getBarcodeMetadata();if(i==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(i);var a=new Int32Array(i.getRowCount());try{for(var o=lx(this.getCodewords()),s=o.next();!s.done;s=o.next()){var c=s.value;if(c!=null){var d=c.getRowNumber();if(d>=a.length)continue;a[d]++}}}catch(h){n={error:h}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(n){for(var r=this.getBoundingBox(),i=this._isLeft?r.getTopLeft():r.getTopRight(),a=this._isLeft?r.getBottomLeft():r.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(i.getY())),s=this.imageRowToCodewordIndex(Math.trunc(a.getY())),c=this.getCodewords(),d=-1,h=o;h<s;h++)if(c[h]!=null){var p=c[h];p.setRowNumberAsRowIndicatorColumn();var x=p.getRowNumber()-d;x===0||(x===1?d=p.getRowNumber():p.getRowNumber()>=n.getRowCount()?c[h]=null:d=p.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var n,r,i=this.getCodewords(),a=new Yu,o=new Yu,s=new Yu,c=new Yu;try{for(var d=lx(i),h=d.next();!h.done;h=d.next()){var p=h.value;if(p!=null){p.setRowNumberAsRowIndicatorColumn();var x=p.getValue()%30,v=p.getRowNumber();switch(this._isLeft||(v+=2),v%3){case 0:o.setValue(x*3+1);break;case 1:c.setValue(x/3),s.setValue(x%3);break;case 2:a.setValue(x+1);break}}}}catch(C){n={error:C}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(a.getValue().length===0||o.getValue().length===0||s.getValue().length===0||c.getValue().length===0||a.getValue()[0]<1||o.getValue()[0]+s.getValue()[0]<yt.MIN_ROWS_IN_BARCODE||o.getValue()[0]+s.getValue()[0]>yt.MAX_ROWS_IN_BARCODE)return null;var b=new fW(a.getValue()[0],o.getValue()[0],s.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(i,b),b},e.prototype.removeIncorrectCodewords=function(n,r){for(var i=0;i<n.length;i++){var a=n[i];if(n[i]!=null){var o=a.getValue()%30,s=a.getRowNumber();if(s>r.getRowCount()){n[i]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:o*3+1!==r.getRowCountUpperPart()&&(n[i]=null);break;case 1:(Math.trunc(o/3)!==r.getErrorCorrectionLevel()||o%3!==r.getRowCountLowerPart())&&(n[i]=null);break;case 2:o+1!==r.getColumnCount()&&(n[i]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e})(h5),xW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vW=(function(){function t(e,n){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=n,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=yt.MAX_CODEWORDS_IN_BARCODE,n;do n=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<n);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var n=1;n<this.barcodeColumnCount+1;n++)for(var r=this.detectionResultColumns[n].getCodewords(),i=0;i<r.length;i++)r[i]!=null&&(r[i].hasValidRowNumber()||this.adjustRowNumbers(n,i,r));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),r=0;r<e.length;r++)if(e[r]!=null&&n[r]!=null&&e[r].getRowNumber()===n[r].getRowNumber())for(var i=1;i<=this.barcodeColumnCount;i++){var a=this.detectionResultColumns[i].getCodewords()[r];a!=null&&(a.setRowNumber(e[r].getRowNumber()),a.hasValidRowNumber()||(this.detectionResultColumns[i].getCodewords()[r]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),r=0;r<n.length;r++)if(n[r]!=null)for(var i=n[r].getRowNumber(),a=0,o=this.barcodeColumnCount+1;o>0&&a<this.ADJUST_ROW_NUMBER_SKIP;o--){var s=this.detectionResultColumns[o].getCodewords()[r];s!=null&&(a=t.adjustRowNumberIfValid(i,a,s),s.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,n=this.detectionResultColumns[0].getCodewords(),r=0;r<n.length;r++)if(n[r]!=null)for(var i=n[r].getRowNumber(),a=0,o=1;o<this.barcodeColumnCount+1&&a<this.ADJUST_ROW_NUMBER_SKIP;o++){var s=this.detectionResultColumns[o].getCodewords()[r];s!=null&&(a=t.adjustRowNumberIfValid(i,a,s),s.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,n,r){return r==null||r.hasValidRowNumber()||(r.isValidRowNumber(e)?(r.setRowNumber(e),n=0):++n),n},t.prototype.adjustRowNumbers=function(e,n,r){var i,a;if(this.detectionResultColumns[e-1]!=null){var o=r[n],s=this.detectionResultColumns[e-1].getCodewords(),c=s;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var d=new Array(14);d[2]=s[n],d[3]=c[n],n>0&&(d[0]=r[n-1],d[4]=s[n-1],d[5]=c[n-1]),n>1&&(d[8]=r[n-2],d[10]=s[n-2],d[11]=c[n-2]),n<r.length-1&&(d[1]=r[n+1],d[6]=s[n+1],d[7]=c[n+1]),n<r.length-2&&(d[9]=r[n+2],d[12]=s[n+2],d[13]=c[n+2]);try{for(var h=xW(d),p=h.next();!p.done;p=h.next()){var x=p.value;if(t.adjustRowNumber(o,x))return}}catch(v){i={error:v}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}}},t.adjustRowNumber=function(e,n){return n==null?!1:n.hasValidRowNumber()&&n.getBucket()===e.getBucket()?(e.setRowNumber(n.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,n){this.detectionResultColumns[e]=n},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var n=new x2,r=0;r<e.getCodewords().length;r++){n.format("CW %3d:",r);for(var i=0;i<this.barcodeColumnCount+2;i++){if(this.detectionResultColumns[i]==null){n.format("    |   ");continue}var a=this.detectionResultColumns[i].getCodewords()[r];if(a==null){n.format("    |   ");continue}n.format(" %3d|%3d",a.getRowNumber(),a.getValue())}n.format("%n")}return n.toString()},t})(),yW=(function(){function t(e,n,r,i){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(n),this.bucket=Math.trunc(r),this.value=Math.trunc(i)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t})(),bW=(function(){function t(){}return t.initialize=function(){for(var e=0;e<yt.SYMBOL_TABLE.length;e++)for(var n=yt.SYMBOL_TABLE[e],r=n&1,i=0;i<yt.BARS_IN_MODULE;i++){for(var a=0;(n&1)===r;)a+=1,n>>=1;r=n&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(yt.BARS_IN_MODULE)),t.RATIOS_TABLE[e][yt.BARS_IN_MODULE-i-1]=Math.fround(a/yt.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var n=t.getDecodedCodewordValue(t.sampleBitCounts(e));return n!==-1?n:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var n=Et.sum(e),r=new Int32Array(yt.BARS_IN_MODULE),i=0,a=0,o=0;o<yt.MODULES_IN_CODEWORD;o++){var s=n/(2*yt.MODULES_IN_CODEWORD)+o*n/yt.MODULES_IN_CODEWORD;a+e[i]<=s&&(a+=e[i],i++),r[i]++}return r},t.getDecodedCodewordValue=function(e){var n=t.getBitValue(e);return yt.getCodeword(n)===-1?-1:n},t.getBitValue=function(e){for(var n=0,r=0;r<e.length;r++)for(var i=0;i<e[r];i++)n=n<<1|(r%2===0?1:0);return Math.trunc(n)},t.getClosestDecodedValue=function(e){var n=Et.sum(e),r=new Array(yt.BARS_IN_MODULE);if(n>1)for(var i=0;i<r.length;i++)r[i]=Math.fround(e[i]/n);var a=Bv.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var s=0;s<t.RATIOS_TABLE.length;s++){for(var c=0,d=t.RATIOS_TABLE[s],h=0;h<yt.BARS_IN_MODULE;h++){var p=Math.fround(d[h]-r[h]);if(c+=Math.fround(p*p),c>=a)break}c<a&&(a=c,o=yt.SYMBOL_TABLE[s])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(yt.SYMBOL_TABLE.length).map(function(e){return new Array(yt.BARS_IN_MODULE)}),t})(),wW=(function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t})(),N3=(function(){function t(){}return t.parseLong=function(e,n){return n===void 0&&(n=void 0),parseInt(e,n)},t})(),CW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),EW=(function(t){CW(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e})(ai),SW=(function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,n,r){if(e==null)throw new EW;if(n<0||n>e.length||r<0||n+r>e.length||n+r<0)throw new f2;if(r===0)return;for(var i=0;i<r;i++)this.write(e[n+i])},t.prototype.flush=function(){},t.prototype.close=function(){},t})(),AW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),_W=(function(t){AW(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(ai),NW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),kW=(function(t){NW(e,t);function e(n){n===void 0&&(n=32);var r=t.call(this)||this;if(r.count=0,n<0)throw new qe("Negative initial size: "+n);return r.buf=new Uint8Array(n),r}return e.prototype.ensureCapacity=function(n){n-this.buf.length>0&&this.grow(n)},e.prototype.grow=function(n){var r=this.buf.length,i=r<<1;if(i-n<0&&(i=n),i<0){if(n<0)throw new _W;i=lt.MAX_VALUE}this.buf=Gn.copyOfUint8Array(this.buf,i)},e.prototype.write=function(n){this.ensureCapacity(this.count+1),this.buf[this.count]=n,this.count+=1},e.prototype.writeBytesOffset=function(n,r,i){if(r<0||r>n.length||i<0||r+i-n.length>0)throw new f2;this.ensureCapacity(this.count+i),Qt.arraycopy(n,r,this.buf,this.count,i),this.count+=i},e.prototype.writeTo=function(n){n.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Gn.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(n){return n?typeof n=="string"?this.toString_string(n):this.toString_number(n):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(n){return new String(this.buf).toString()},e.prototype.toString_number=function(n){return new String(this.buf).toString()},e.prototype.close=function(){},e})(SW),Ft;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Ft||(Ft={}));function p5(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var Lh;function Ho(t){if(typeof Lh>"u"&&(Lh=p5()),Lh===null)throw new Error("BigInt is not supported!");return Lh(t)}function TW(){var t=[];t[0]=Ho(1);var e=Ho(900);t[1]=e;for(var n=2;n<16;n++)t[n]=t[n-1]*e;return t}var OW=(function(){function t(){}return t.decode=function(e,n){var r=new st(""),i=$n.ISO8859_1;r.enableDecoding(i);for(var a=1,o=e[a++],s=new wW;a<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:a=t.textCompaction(e,a,r);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:a=t.byteCompaction(o,e,i,a,r);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:a=t.numericCompaction(e,a,r);break;case t.ECI_CHARSET:$n.getCharacterSetECIByValue(e[a++]);break;case t.ECI_GENERAL_PURPOSE:a+=2;break;case t.ECI_USER_DEFINED:a++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:a=t.decodeMacroBlock(e,a,s);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new De;default:a--,a=t.textCompaction(e,a,r);break}if(a<e.length)o=e[a++];else throw De.getFormatInstance()}if(r.length()===0)throw De.getFormatInstance();var c=new J0(null,r.toString(),null,n);return c.setOther(s),c},t.decodeMacroBlock=function(e,n,r){if(n+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw De.getFormatInstance();for(var i=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),a=0;a<t.NUMBER_OF_SEQUENCE_CODEWORDS;a++,n++)i[a]=e[n];r.setSegmentIndex(lt.parseInt(t.decodeBase900toBase10(i,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new st;n=t.textCompaction(e,n,o),r.setFileId(o.toString());var s=-1;for(e[n]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=n+1);n<e[0];)switch(e[n]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(n++,e[n]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new st;n=t.textCompaction(e,n+1,c),r.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var d=new st;n=t.textCompaction(e,n+1,d),r.setSender(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var h=new st;n=t.textCompaction(e,n+1,h),r.setAddressee(h.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var p=new st;n=t.numericCompaction(e,n+1,p),r.setSegmentCount(lt.parseInt(p.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var x=new st;n=t.numericCompaction(e,n+1,x),r.setTimestamp(N3.parseLong(x.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var v=new st;n=t.numericCompaction(e,n+1,v),r.setChecksum(lt.parseInt(v.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var b=new st;n=t.numericCompaction(e,n+1,b),r.setFileSize(N3.parseLong(b.toString()));break;default:throw De.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:n++,r.setLastSegment(!0);break;default:throw De.getFormatInstance()}if(s!==-1){var C=n-s;r.isLastSegment()&&C--,r.setOptionalData(Gn.copyOfRange(e,s,s+C))}return n},t.textCompaction=function(e,n,r){for(var i=new Int32Array((e[0]-n)*2),a=new Int32Array((e[0]-n)*2),o=0,s=!1;n<e[0]&&!s;){var c=e[n++];if(c<t.TEXT_COMPACTION_MODE_LATCH)i[o]=c/30,i[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:i[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:n--,s=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[n++],a[o]=c,o++;break}}return t.decodeTextCompaction(i,a,o,r),n},t.decodeTextCompaction=function(e,n,r,i){for(var a=Ft.ALPHA,o=Ft.ALPHA,s=0;s<r;){var c=e[s],d="";switch(a){case Ft.ALPHA:if(c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case t.LL:a=Ft.LOWER;break;case t.ML:a=Ft.MIXED;break;case t.PS:o=a,a=Ft.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(n[s]);break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break;case Ft.LOWER:if(c<26)d=String.fromCharCode(97+c);else switch(c){case 26:d=" ";break;case t.AS:o=a,a=Ft.ALPHA_SHIFT;break;case t.ML:a=Ft.MIXED;break;case t.PS:o=a,a=Ft.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(n[s]);break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break;case Ft.MIXED:if(c<t.PL)d=t.MIXED_CHARS[c];else switch(c){case t.PL:a=Ft.PUNCT;break;case 26:d=" ";break;case t.LL:a=Ft.LOWER;break;case t.AL:a=Ft.ALPHA;break;case t.PS:o=a,a=Ft.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(n[s]);break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break;case Ft.PUNCT:if(c<t.PAL)d=t.PUNCT_CHARS[c];else switch(c){case t.PAL:a=Ft.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(n[s]);break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break;case Ft.ALPHA_SHIFT:if(a=o,c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break;case Ft.PUNCT_SHIFT:if(a=o,c<t.PAL)d=t.PUNCT_CHARS[c];else switch(c){case t.PAL:a=Ft.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(n[s]);break;case t.TEXT_COMPACTION_MODE_LATCH:a=Ft.ALPHA;break}break}d!==""&&i.append(d),s++}},t.byteCompaction=function(e,n,r,i,a){var o=new kW,s=0,c=0,d=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var h=new Int32Array(6),p=n[i++];i<n[0]&&!d;)switch(h[s++]=p,c=900*c+p,p=n[i++],p){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:i--,d=!0;break;default:if(s%5===0&&s>0){for(var x=0;x<6;++x)o.write(Number(Ho(c)>>Ho(8*(5-x))));c=0,s=0}break}i===n[0]&&p<t.TEXT_COMPACTION_MODE_LATCH&&(h[s++]=p);for(var v=0;v<s;v++)o.write(h[v]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;i<n[0]&&!d;){var b=n[i++];if(b<t.TEXT_COMPACTION_MODE_LATCH)s++,c=900*c+b;else switch(b){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:i--,d=!0;break}if(s%5===0&&s>0){for(var x=0;x<6;++x)o.write(Number(Ho(c)>>Ho(8*(5-x))));c=0,s=0}}break}return a.append(Pi.decode(o.toByteArray(),r)),i},t.numericCompaction=function(e,n,r){for(var i=0,a=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);n<e[0]&&!a;){var s=e[n++];if(n===e[0]&&(a=!0),s<t.TEXT_COMPACTION_MODE_LATCH)o[i]=s,i++;else switch(s){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:n--,a=!0;break}(i%t.MAX_NUMERIC_CODEWORDS===0||s===t.NUMERIC_COMPACTION_MODE_LATCH||a)&&i>0&&(r.append(t.decodeBase900toBase10(o,i)),i=0)}return n},t.decodeBase900toBase10=function(e,n){for(var r=Ho(0),i=0;i<n;i++)r+=t.EXP900[n-i-1]*Ho(e[i]);var a=r.toString();if(a.charAt(0)!=="1")throw new De;return a.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=p5()?TW():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t})(),zu=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},IW=(function(){function t(){}return t.decode=function(e,n,r,i,a,o,s){for(var c=new $v(e,n,r,i,a),d=null,h=null,p,x=!0;;x=!1){if(n!=null&&(d=t.getRowIndicatorColumn(e,c,n,!0,o,s)),i!=null&&(h=t.getRowIndicatorColumn(e,c,i,!1,o,s)),p=t.merge(d,h),p==null)throw he.getNotFoundInstance();var v=p.getBoundingBox();if(x&&v!=null&&(v.getMinY()<c.getMinY()||v.getMaxY()>c.getMaxY()))c=v;else break}p.setBoundingBox(c);var b=p.getBarcodeColumnCount()+1;p.setDetectionResultColumn(0,d),p.setDetectionResultColumn(b,h);for(var C=d!=null,E=1;E<=b;E++){var S=C?E:b-E;if(p.getDetectionResultColumn(S)===void 0){var N=void 0;S===0||S===b?N=new _3(c,S===0):N=new h5(c),p.setDetectionResultColumn(S,N);for(var k=-1,I=k,D=c.getMinY();D<=c.getMaxY();D++){if(k=t.getStartColumn(p,S,D,C),k<0||k>c.getMaxX()){if(I===-1)continue;k=I}var L=t.detectCodeword(e,c.getMinX(),c.getMaxX(),C,k,D,o,s);L!=null&&(N.setCodeword(D,L),I=k,o=Math.min(o,L.getWidth()),s=Math.max(s,L.getWidth()))}}}return t.createDecoderResult(p)},t.merge=function(e,n){if(e==null&&n==null)return null;var r=t.getBarcodeMetadata(e,n);if(r==null)return null;var i=$v.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(n));return new vW(r,i)},t.adjustBoundingBox=function(e){var n,r;if(e==null)return null;var i=e.getRowHeights();if(i==null)return null;var a=t.getMax(i),o=0;try{for(var s=zu(i),c=s.next();!c.done;c=s.next()){var d=c.value;if(o+=a-d,d>0)break}}catch(v){n={error:v}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}for(var h=e.getCodewords(),p=0;o>0&&h[p]==null;p++)o--;for(var x=0,p=i.length-1;p>=0&&(x+=a-i[p],!(i[p]>0));p--);for(var p=h.length-1;x>0&&h[p]==null;p--)x--;return e.getBoundingBox().addMissingRows(o,x,e.isLeft())},t.getMax=function(e){var n,r,i=-1;try{for(var a=zu(e),o=a.next();!o.done;o=a.next()){var s=o.value;i=Math.max(i,s)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},t.getBarcodeMetadata=function(e,n){var r;if(e==null||(r=e.getBarcodeMetadata())==null)return n==null?null:n.getBarcodeMetadata();var i;return n==null||(i=n.getBarcodeMetadata())==null?r:r.getColumnCount()!==i.getColumnCount()&&r.getErrorCorrectionLevel()!==i.getErrorCorrectionLevel()&&r.getRowCount()!==i.getRowCount()?null:r},t.getRowIndicatorColumn=function(e,n,r,i,a,o){for(var s=new _3(n,i),c=0;c<2;c++)for(var d=c===0?1:-1,h=Math.trunc(Math.trunc(r.getX())),p=Math.trunc(Math.trunc(r.getY()));p<=n.getMaxY()&&p>=n.getMinY();p+=d){var x=t.detectCodeword(e,0,e.getWidth(),i,h,p,a,o);x!=null&&(s.setCodeword(p,x),i?h=x.getStartX():h=x.getEndX())}return s},t.adjustCodewordCount=function(e,n){var r=n[0][1],i=r.getValue(),a=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(i.length===0){if(a<1||a>yt.MAX_CODEWORDS_IN_BARCODE)throw he.getNotFoundInstance();r.setValue(a)}else i[0]!==a&&r.setValue(a)},t.createDecoderResult=function(e){var n=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,n);for(var r=new Array,i=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),a=[],o=new Array,s=0;s<e.getBarcodeRowCount();s++)for(var c=0;c<e.getBarcodeColumnCount();c++){var d=n[s][c+1].getValue(),h=s*e.getBarcodeColumnCount()+c;d.length===0?r.push(h):d.length===1?i[h]=d[0]:(o.push(h),a.push(d))}for(var p=new Array(a.length),x=0;x<p.length;x++)p[x]=a[x];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),i,yt.toIntArray(r),yt.toIntArray(o),p)},t.createDecoderResultFromAmbiguousValues=function(e,n,r,i,a){for(var o=new Int32Array(i.length),s=100;s-- >0;){for(var c=0;c<o.length;c++)n[i[c]]=a[c][o[c]];try{return t.decodeCodewords(n,e,r)}catch(h){var d=h instanceof tr;if(!d)throw h}if(o.length===0)throw tr.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<a[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw tr.getChecksumInstance()}throw tr.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var n,r,i,a,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),s=0;s<o.length;s++)for(var c=0;c<o[s].length;c++)o[s][c]=new Yu;var d=0;try{for(var h=zu(e.getDetectionResultColumns()),p=h.next();!p.done;p=h.next()){var x=p.value;if(x!=null)try{for(var v=(i=void 0,zu(x.getCodewords())),b=v.next();!b.done;b=v.next()){var C=b.value;if(C!=null){var E=C.getRowNumber();if(E>=0){if(E>=o.length)continue;o[E][d].setValue(C.getValue())}}}}catch(S){i={error:S}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}d++}}catch(S){n={error:S}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return o},t.isValidBarcodeColumn=function(e,n){return n>=0&&n<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,n,r,i){var a,o,s=i?1:-1,c=null;if(t.isValidBarcodeColumn(e,n-s)&&(c=e.getDetectionResultColumn(n-s).getCodeword(r)),c!=null)return i?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(n).getCodewordNearby(r),c!=null)return i?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,n-s)&&(c=e.getDetectionResultColumn(n-s).getCodewordNearby(r)),c!=null)return i?c.getEndX():c.getStartX();for(var d=0;t.isValidBarcodeColumn(e,n-s);){n-=s;try{for(var h=(a=void 0,zu(e.getDetectionResultColumn(n).getCodewords())),p=h.next();!p.done;p=h.next()){var x=p.value;if(x!=null)return(i?x.getEndX():x.getStartX())+s*d*(x.getEndX()-x.getStartX())}}catch(v){a={error:v}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}d++}return i?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,n,r,i,a,o,s,c){a=t.adjustCodewordStartColumn(e,n,r,i,a,o);var d=t.getModuleBitCount(e,n,r,i,a,o);if(d==null)return null;var h,p=Et.sum(d);if(i)h=a+p;else{for(var x=0;x<d.length/2;x++){var v=d[x];d[x]=d[d.length-1-x],d[d.length-1-x]=v}h=a,a=h-p}if(!t.checkCodewordSkew(p,s,c))return null;var b=bW.getDecodedValue(d),C=yt.getCodeword(b);return C===-1?null:new yW(a,h,t.getCodewordBucketNumber(b),C)},t.getModuleBitCount=function(e,n,r,i,a,o){for(var s=a,c=new Int32Array(8),d=0,h=i?1:-1,p=i;(i?s<r:s>=n)&&d<c.length;)e.get(s,o)===p?(c[d]++,s+=h):(d++,p=!p);return d===c.length||s===(i?r:n)&&d===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,n,r,i,a,o){for(var s=a,c=i?-1:1,d=0;d<2;d++){for(;(i?s>=n:s<r)&&i===e.get(s,o);){if(Math.abs(a-s)>t.CODEWORD_SKEW_SIZE)return a;s+=c}c=-c,i=!i}return s},t.checkCodewordSkew=function(e,n,r){return n-t.CODEWORD_SKEW_SIZE<=e&&e<=r+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,n,r){if(e.length===0)throw De.getFormatInstance();var i=1<<n+1,a=t.correctErrors(e,r,i);t.verifyCodewordCount(e,i);var o=OW.decode(e,""+n);return o.setErrorsCorrected(a),o.setErasures(r.length),o},t.correctErrors=function(e,n,r){if(n!=null&&n.length>r/2+t.MAX_ERRORS||r<0||r>t.MAX_EC_CODEWORDS)throw tr.getChecksumInstance();return t.errorCorrection.decode(e,r,n)},t.verifyCodewordCount=function(e,n){if(e.length<4)throw De.getFormatInstance();var r=e[0];if(r>e.length)throw De.getFormatInstance();if(r===0)if(n<e.length)e[0]=e.length-n;else throw De.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var n=new Int32Array(8),r=0,i=n.length-1;!((e&1)!==r&&(r=e&1,i--,i<0));)n[i]++,e>>=1;return n},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var n=new x2,r=0;r<e.length;r++){n.format("Row %2d: ",r);for(var i=0;i<e[r].length;i++){var a=e[r][i];a.getValue().length===0?n.format("        ",null):n.format("%4d(%2d)",a.getValue()[0],a.getConfidence(a.getValue()[0]))}n.format("%n")}return n.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new dW,t})(),DW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Gv=(function(){function t(){}return t.prototype.decode=function(e,n){n===void 0&&(n=null);var r=t.decode(e,n,!1);if(r==null||r.length===0||r[0]==null)throw he.getNotFoundInstance();return r[0]},t.prototype.decodeMultiple=function(e,n){n===void 0&&(n=null);try{return t.decode(e,n,!0)}catch(r){throw r instanceof De||r instanceof tr?he.getNotFoundInstance():r}},t.decode=function(e,n,r){var i,a,o=new Array,s=aW.detectMultiple(e,n,r);try{for(var c=DW(s.getPoints()),d=c.next();!d.done;d=c.next()){var h=d.value,p=IW.decode(s.getBits(),h[4],h[5],h[6],h[7],t.getMinCodewordWidth(h),t.getMaxCodewordWidth(h)),x=new Dr(p.getText(),p.getRawBytes(),void 0,h,Ue.PDF_417);x.putMetadata(wr.ERROR_CORRECTION_LEVEL,p.getECLevel());var v=p.getOther();v!=null&&x.putMetadata(wr.PDF417_EXTRA_METADATA,v),o.push(x)}}catch(b){i={error:b}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}return o.map(function(b){return b})},t.getMaxWidth=function(e,n){return e==null||n==null?0:Math.trunc(Math.abs(e.getX()-n.getX()))},t.getMinWidth=function(e,n){return e==null||n==null?lt.MAX_VALUE:Math.trunc(Math.abs(e.getX()-n.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t})(),MW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),k3=(function(t){MW(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e})(ai),T3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},RW=(function(){function t(){}return t.prototype.decode=function(e,n){return this.setHints(n),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var n=e!=null&&e.get(en.TRY_HARDER)!==void 0,r=e==null?null:e.get(en.POSSIBLE_FORMATS),i=new Array;if(r!=null){var a=r.some(function(o){return o===Ue.UPC_A||o===Ue.UPC_E||o===Ue.EAN_13||o===Ue.EAN_8||o===Ue.CODABAR||o===Ue.CODE_39||o===Ue.CODE_93||o===Ue.CODE_128||o===Ue.ITF||o===Ue.RSS_14||o===Ue.RSS_EXPANDED});a&&!n&&i.push(new Ku(e)),r.includes(Ue.QR_CODE)&&i.push(new Vv),r.includes(Ue.DATA_MATRIX)&&i.push(new Hv),r.includes(Ue.AZTEC)&&i.push(new zv),r.includes(Ue.PDF_417)&&i.push(new Gv),a&&n&&i.push(new Ku(e))}i.length===0&&(n||i.push(new Ku(e)),i.push(new Vv),i.push(new Hv),i.push(new zv),i.push(new Gv),n&&i.push(new Ku(e))),this.readers=i},t.prototype.reset=function(){var e,n;if(this.readers!==null)try{for(var r=T3(this.readers),i=r.next();!i.done;i=r.next()){var a=i.value;a.reset()}}catch(o){e={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var n,r;if(this.readers===null)throw new k3("No readers where selected, nothing can be read.");try{for(var i=T3(this.readers),a=i.next();!a.done;a=i.next()){var o=a.value;try{return o.decode(e,this.hints)}catch(s){if(s instanceof k3)continue}}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}throw new he("No MultiFormat Readers were able to detect the code.")},t})(),LW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),jW=(function(t){LW(e,t);function e(n,r){n===void 0&&(n=null),r===void 0&&(r=500);var i=this,a=new RW;return a.setHints(n),i=t.call(this,a,r)||this,i}return e.prototype.decodeBitmap=function(n){return this.reader.decodeWithState(n)},e})(Fc),PW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){PW(e,t);function e(n){return n===void 0&&(n=500),t.call(this,new Gv,n)||this}return e})(Fc);var BW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){BW(e,t);function e(n){return n===void 0&&(n=500),t.call(this,new Vv,n)||this}return e})(Fc);var Wv;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(Wv||(Wv={}));const jh=Wv;var m5=(function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new rs(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var n=this.cachedGenerators;if(e>=n.length)for(var r=n[n.length-1],i=this.field,a=n.length;a<=e;a++){var o=r.multiply(new rs(i,Int32Array.from([1,i.exp(a-1+i.getGeneratorBase())])));n.push(o),r=o}return n[e]},t.prototype.encode=function(e,n){if(n===0)throw new qe("No error correction bytes");var r=e.length-n;if(r<=0)throw new qe("No data bytes provided");var i=this.buildGenerator(n),a=new Int32Array(r);Qt.arraycopy(e,0,a,0,r);var o=new rs(this.field,a);o=o.multiplyByMonomial(n,1);for(var s=o.divide(i)[1],c=s.getCoefficients(),d=n-c.length,h=0;h<d;h++)e[r+h]=0;Qt.arraycopy(c,0,e,r+d,c.length)},t})(),Zu=(function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a-1;o++)for(var s=r[o],c=0;c<i-1;c++){var d=s[c];d===s[c+1]&&d===r[o+1][c]&&d===r[o+1][c+1]&&n++}return t.N2*n},t.applyMaskPenaltyRule3=function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a;o++)for(var s=0;s<i;s++){var c=r[o];s+6<i&&c[s]===1&&c[s+1]===0&&c[s+2]===1&&c[s+3]===1&&c[s+4]===1&&c[s+5]===0&&c[s+6]===1&&(t.isWhiteHorizontal(c,s-4,s)||t.isWhiteHorizontal(c,s+7,s+11))&&n++,o+6<a&&r[o][s]===1&&r[o+1][s]===0&&r[o+2][s]===1&&r[o+3][s]===1&&r[o+4][s]===1&&r[o+5][s]===0&&r[o+6][s]===1&&(t.isWhiteVertical(r,s,o-4,o)||t.isWhiteVertical(r,s,o+7,o+11))&&n++}return n*t.N3},t.isWhiteHorizontal=function(e,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(var i=n;i<r;i++)if(e[i]===1)return!1;return!0},t.isWhiteVertical=function(e,n,r,i){r=Math.max(r,0),i=Math.min(i,e.length);for(var a=r;a<i;a++)if(e[a][n]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a;o++)for(var s=r[o],c=0;c<i;c++)s[c]===1&&n++;var d=e.getHeight()*e.getWidth(),h=Math.floor(Math.abs(n*2-d)*10/d);return h*t.N4},t.getDataMaskBit=function(e,n,r){var i,a;switch(e){case 0:i=r+n&1;break;case 1:i=r&1;break;case 2:i=n%3;break;case 3:i=(r+n)%3;break;case 4:i=Math.floor(r/2)+Math.floor(n/3)&1;break;case 5:a=r*n,i=(a&1)+a%3;break;case 6:a=r*n,i=(a&1)+a%3&1;break;case 7:a=r*n,i=a%3+(r+n&1)&1;break;default:throw new qe("Invalid mask pattern: "+e)}return i===0},t.applyMaskPenaltyRule1Internal=function(e,n){for(var r=0,i=n?e.getHeight():e.getWidth(),a=n?e.getWidth():e.getHeight(),o=e.getArray(),s=0;s<i;s++){for(var c=0,d=-1,h=0;h<a;h++){var p=n?o[s][h]:o[h][s];p===d?c++:(c>=5&&(r+=t.N1+(c-5)),c=1,d=p)}c>=5&&(r+=t.N1+(c-5))}return r},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t})(),FW=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zW=(function(){function t(e,n){this.width=e,this.height=n;for(var r=new Array(n),i=0;i!==n;i++)r[i]=new Uint8Array(e);this.bytes=r}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,n){return this.bytes[n][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,n,r){this.bytes[n][e]=r},t.prototype.setBoolean=function(e,n,r){this.bytes[n][e]=r?1:0},t.prototype.clear=function(e){var n,r;try{for(var i=FW(this.bytes),a=i.next();!a.done;a=i.next()){var o=a.value;Gn.fill(o,e)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var n=e;if(this.width!==n.width||this.height!==n.height)return!1;for(var r=0,i=this.height;r<i;++r)for(var a=this.bytes[r],o=n.bytes[r],s=0,c=this.width;s<c;++s)if(a[s]!==o[s])return!1;return!0},t.prototype.toString=function(){for(var e=new st,n=0,r=this.height;n<r;++n){for(var i=this.bytes[n],a=0,o=this.width;a<o;++a)switch(i[a]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t})(),qv=(function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new st;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t})(),UW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),sn=(function(t){UW(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e})(ai),O3=(function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,n,r,i,a){t.clearMatrix(a),t.embedBasicPatterns(r,a),t.embedTypeInfo(n,i,a),t.maybeEmbedVersionInfo(r,a),t.embedDataBits(e,i,a)},t.embedBasicPatterns=function(e,n){t.embedPositionDetectionPatternsAndSeparators(n),t.embedDarkDotAtLeftBottomCorner(n),t.maybeEmbedPositionAdjustmentPatterns(e,n),t.embedTimingPatterns(n)},t.embedTypeInfo=function(e,n,r){var i=new rr;t.makeTypeInfoBits(e,n,i);for(var a=0,o=i.getSize();a<o;++a){var s=i.get(i.getSize()-1-a),c=t.TYPE_INFO_COORDINATES[a],d=c[0],h=c[1];if(r.setBoolean(d,h,s),a<8){var p=r.getWidth()-a-1,x=8;r.setBoolean(p,x,s)}else{var p=8,x=r.getHeight()-7+(a-8);r.setBoolean(p,x,s)}}},t.maybeEmbedVersionInfo=function(e,n){if(!(e.getVersionNumber()<7)){var r=new rr;t.makeVersionInfoBits(e,r);for(var i=17,a=0;a<6;++a)for(var o=0;o<3;++o){var s=r.get(i);i--,n.setBoolean(a,n.getHeight()-11+o,s),n.setBoolean(n.getHeight()-11+o,a,s)}}},t.embedDataBits=function(e,n,r){for(var i=0,a=-1,o=r.getWidth()-1,s=r.getHeight()-1;o>0;){for(o===6&&(o-=1);s>=0&&s<r.getHeight();){for(var c=0;c<2;++c){var d=o-c;if(t.isEmpty(r.get(d,s))){var h=void 0;i<e.getSize()?(h=e.get(i),++i):h=!1,n!==255&&Zu.getDataMaskBit(n,d,s)&&(h=!h),r.setBoolean(d,s,h)}}s+=a}a=-a,s+=a,o-=2}if(i!==e.getSize())throw new sn("Not all bits consumed: "+i+"/"+e.getSize())},t.findMSBSet=function(e){return 32-lt.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,n){if(n===0)throw new qe("0 polynomial");var r=t.findMSBSet(n);for(e<<=r-1;t.findMSBSet(e)>=r;)e^=n<<t.findMSBSet(e)-r;return e},t.makeTypeInfoBits=function(e,n,r){if(!qv.isValidMaskPattern(n))throw new sn("Invalid mask pattern");var i=e.getBits()<<3|n;r.appendBits(i,5);var a=t.calculateBCHCode(i,t.TYPE_INFO_POLY);r.appendBits(a,10);var o=new rr;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),r.xor(o),r.getSize()!==15)throw new sn("should not happen but we got: "+r.getSize())},t.makeVersionInfoBits=function(e,n){n.appendBits(e.getVersionNumber(),6);var r=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(n.appendBits(r,12),n.getSize()!==18)throw new sn("should not happen but we got: "+n.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var n=8;n<e.getWidth()-8;++n){var r=(n+1)%2;t.isEmpty(e.get(n,6))&&e.setNumber(n,6,r),t.isEmpty(e.get(6,n))&&e.setNumber(6,n,r)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new sn;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,n,r){for(var i=0;i<8;++i){if(!t.isEmpty(r.get(e+i,n)))throw new sn;r.setNumber(e+i,n,0)}},t.embedVerticalSeparationPattern=function(e,n,r){for(var i=0;i<7;++i){if(!t.isEmpty(r.get(e,n+i)))throw new sn;r.setNumber(e,n+i,0)}},t.embedPositionAdjustmentPattern=function(e,n,r){for(var i=0;i<5;++i)for(var a=t.POSITION_ADJUSTMENT_PATTERN[i],o=0;o<5;++o)r.setNumber(e+o,n+i,a[o])},t.embedPositionDetectionPattern=function(e,n,r){for(var i=0;i<7;++i)for(var a=t.POSITION_DETECTION_PATTERN[i],o=0;o<7;++o)r.setNumber(e+o,n+i,a[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var n=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-n,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-n,e);var r=8;t.embedHorizontalSeparationPattern(0,r-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-r,r-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-r,e);var i=7;t.embedVerticalSeparationPattern(i,0,e),t.embedVerticalSeparationPattern(e.getHeight()-i-1,0,e),t.embedVerticalSeparationPattern(i,e.getHeight()-i,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,n){if(!(e.getVersionNumber()<2))for(var r=e.getVersionNumber()-1,i=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r],a=0,o=i.length;a!==o;a++){var s=i[a];if(s>=0)for(var c=0;c!==o;c++){var d=i[c];d>=0&&t.isEmpty(n.get(d,s))&&t.embedPositionAdjustmentPattern(d-2,s-2,n)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t})(),HW=(function(){function t(e,n){this.dataBytes=e,this.errorCorrectionBytes=n}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t})(),I3=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return Zu.applyMaskPenaltyRule1(e)+Zu.applyMaskPenaltyRule2(e)+Zu.applyMaskPenaltyRule3(e)+Zu.applyMaskPenaltyRule4(e)},t.encode=function(e,n,r){r===void 0&&(r=null);var i=t.DEFAULT_BYTE_MODE_ENCODING,a=r!==null&&r.get(jh.CHARACTER_SET)!==void 0;a&&(i=r.get(jh.CHARACTER_SET).toString());var o=this.chooseMode(e,i),s=new rr;if(o===cn.BYTE&&(a||t.DEFAULT_BYTE_MODE_ENCODING!==i)){var c=$n.getCharacterSetECIByName(i);c!==void 0&&this.appendECI(c,s)}this.appendModeInfo(o,s);var d=new rr;this.appendBytes(e,o,d,i);var h;if(r!==null&&r.get(jh.QR_VERSION)!==void 0){var p=Number.parseInt(r.get(jh.QR_VERSION).toString(),10);h=il.getVersionForNumber(p);var x=this.calculateBitsNeeded(o,s,d,h);if(!this.willFit(x,h,n))throw new sn("Data too big for requested version")}else h=this.recommendVersion(n,o,s,d);var v=new rr;v.appendBitArray(s);var b=o===cn.BYTE?d.getSizeInBytes():e.length;this.appendLengthInfo(b,h,o,v),v.appendBitArray(d);var C=h.getECBlocksForLevel(n),E=h.getTotalCodewords()-C.getTotalECCodewords();this.terminateBits(E,v);var S=this.interleaveWithECBytes(v,h.getTotalCodewords(),E,C.getNumBlocks()),N=new qv;N.setECLevel(n),N.setMode(o),N.setVersion(h);var k=h.getDimensionForVersion(),I=new zW(k,k),D=this.chooseMaskPattern(S,n,h,I);return N.setMaskPattern(D),O3.buildMatrix(S,n,h,D,I),N.setMatrix(I),N},t.recommendVersion=function(e,n,r,i){var a=this.calculateBitsNeeded(n,r,i,il.getVersionForNumber(1)),o=this.chooseVersion(a,e),s=this.calculateBitsNeeded(n,r,i,o);return this.chooseVersion(s,e)},t.calculateBitsNeeded=function(e,n,r,i){return n.getSize()+e.getCharacterCountBits(i)+r.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,n){if(n===void 0&&(n=null),$n.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(e))return cn.KANJI;for(var r=!1,i=!1,a=0,o=e.length;a<o;++a){var s=e.charAt(a);if(t.isDigit(s))r=!0;else if(this.getAlphanumericCode(s.charCodeAt(0))!==-1)i=!0;else return cn.BYTE}return i?cn.ALPHANUMERIC:r?cn.NUMERIC:cn.BYTE},t.isOnlyDoubleByteKanji=function(e){var n;try{n=Pi.encode(e,$n.SJIS)}catch{return!1}var r=n.length;if(r%2!==0)return!1;for(var i=0;i<r;i+=2){var a=n[i]&255;if((a<129||a>159)&&(a<224||a>235))return!1}return!0},t.chooseMaskPattern=function(e,n,r,i){for(var a=Number.MAX_SAFE_INTEGER,o=-1,s=0;s<qv.NUM_MASK_PATTERNS;s++){O3.buildMatrix(e,n,r,s,i);var c=this.calculateMaskPenalty(i);c<a&&(a=c,o=s)}return o},t.chooseVersion=function(e,n){for(var r=1;r<=40;r++){var i=il.getVersionForNumber(r);if(t.willFit(e,i,n))return i}throw new sn("Data too big")},t.willFit=function(e,n,r){var i=n.getTotalCodewords(),a=n.getECBlocksForLevel(r),o=a.getTotalECCodewords(),s=i-o,c=(e+7)/8;return s>=c},t.terminateBits=function(e,n){var r=e*8;if(n.getSize()>r)throw new sn("data bits cannot fit in the QR Code"+n.getSize()+" > "+r);for(var i=0;i<4&&n.getSize()<r;++i)n.appendBit(!1);var a=n.getSize()&7;if(a>0)for(var i=a;i<8;i++)n.appendBit(!1);for(var o=e-n.getSizeInBytes(),i=0;i<o;++i)n.appendBits((i&1)===0?236:17,8);if(n.getSize()!==r)throw new sn("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,n,r,i,a,o){if(i>=r)throw new sn("Block ID too large");var s=e%r,c=r-s,d=Math.floor(e/r),h=d+1,p=Math.floor(n/r),x=p+1,v=d-p,b=h-x;if(v!==b)throw new sn("EC bytes mismatch");if(r!==c+s)throw new sn("RS blocks mismatch");if(e!==(p+v)*c+(x+b)*s)throw new sn("Total bytes mismatch");i<c?(a[0]=p,o[0]=v):(a[0]=x,o[0]=b)},t.interleaveWithECBytes=function(e,n,r,i){var a,o,s,c;if(e.getSizeInBytes()!==r)throw new sn("Number of bits and data bytes does not match");for(var d=0,h=0,p=0,x=new Array,v=0;v<i;++v){var b=new Int32Array(1),C=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(n,r,i,v,b,C);var E=b[0],S=new Uint8Array(E);e.toBytes(8*d,S,0,E);var N=t.generateECBytes(S,C[0]);x.push(new HW(S,N)),h=Math.max(h,E),p=Math.max(p,N.length),d+=b[0]}if(r!==d)throw new sn("Data bytes does not match offset");for(var k=new rr,v=0;v<h;++v)try{for(var I=(a=void 0,I3(x)),D=I.next();!D.done;D=I.next()){var L=D.value,S=L.getDataBytes();v<S.length&&k.appendBits(S[v],8)}}catch(fe){a={error:fe}}finally{try{D&&!D.done&&(o=I.return)&&o.call(I)}finally{if(a)throw a.error}}for(var v=0;v<p;++v)try{for(var O=(s=void 0,I3(x)),j=O.next();!j.done;j=O.next()){var L=j.value,N=L.getErrorCorrectionBytes();v<N.length&&k.appendBits(N[v],8)}}catch(fe){s={error:fe}}finally{try{j&&!j.done&&(c=O.return)&&c.call(O)}finally{if(s)throw s.error}}if(n!==k.getSizeInBytes())throw new sn("Interleaving error: "+n+" and "+k.getSizeInBytes()+" differ.");return k},t.generateECBytes=function(e,n){for(var r=e.length,i=new Int32Array(r+n),a=0;a<r;a++)i[a]=e[a]&255;new m5(ri.QR_CODE_FIELD_256).encode(i,n);for(var o=new Uint8Array(n),a=0;a<n;a++)o[a]=i[r+a];return o},t.appendModeInfo=function(e,n){n.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,n,r,i){var a=r.getCharacterCountBits(n);if(e>=1<<a)throw new sn(e+" is bigger than "+((1<<a)-1));i.appendBits(e,a)},t.appendBytes=function(e,n,r,i){switch(n){case cn.NUMERIC:t.appendNumericBytes(e,r);break;case cn.ALPHANUMERIC:t.appendAlphanumericBytes(e,r);break;case cn.BYTE:t.append8BitBytes(e,r,i);break;case cn.KANJI:t.appendKanjiBytes(e,r);break;default:throw new sn("Invalid mode: "+n)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var n=t.getDigit(e);return n>=0&&n<=9},t.appendNumericBytes=function(e,n){for(var r=e.length,i=0;i<r;){var a=t.getDigit(e.charAt(i));if(i+2<r){var o=t.getDigit(e.charAt(i+1)),s=t.getDigit(e.charAt(i+2));n.appendBits(a*100+o*10+s,10),i+=3}else if(i+1<r){var o=t.getDigit(e.charAt(i+1));n.appendBits(a*10+o,7),i+=2}else n.appendBits(a,4),i++}},t.appendAlphanumericBytes=function(e,n){for(var r=e.length,i=0;i<r;){var a=t.getAlphanumericCode(e.charCodeAt(i));if(a===-1)throw new sn;if(i+1<r){var o=t.getAlphanumericCode(e.charCodeAt(i+1));if(o===-1)throw new sn;n.appendBits(a*45+o,11),i+=2}else n.appendBits(a,6),i++}},t.append8BitBytes=function(e,n,r){var i;try{i=Pi.encode(e,r)}catch(c){throw new sn(c)}for(var a=0,o=i.length;a!==o;a++){var s=i[a];n.appendBits(s,8)}},t.appendKanjiBytes=function(e,n){var r;try{r=Pi.encode(e,$n.SJIS)}catch(p){throw new sn(p)}for(var i=r.length,a=0;a<i;a+=2){var o=r[a]&255,s=r[a+1]&255,c=o<<8&4294967295|s,d=-1;if(c>=33088&&c<=40956?d=c-33088:c>=57408&&c<=60351&&(d=c-49472),d===-1)throw new sn("Invalid byte sequence");var h=(d>>8)*192+(d&255);n.appendBits(h,13)}},t.appendECI=function(e,n){n.appendBits(cn.ECI.getBits(),4),n.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=$n.UTF8.getName(),t})();var VW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){VW(e,t);function e(n,r,i,a,o,s,c,d){var h=t.call(this,s,c)||this;if(h.yuvData=n,h.dataWidth=r,h.dataHeight=i,h.left=a,h.top=o,a+s>r||o+c>i)throw new qe("Crop rectangle does not fit within image data.");return d&&h.reverseHorizontal(s,c),h}return e.prototype.getRow=function(n,r){if(n<0||n>=this.getHeight())throw new qe("Requested row is outside the image: "+n);var i=this.getWidth();(r==null||r.length<i)&&(r=new Uint8ClampedArray(i));var a=(n+this.top)*this.dataWidth+this.left;return Qt.arraycopy(this.yuvData,a,r,0,i),r},e.prototype.getMatrix=function(){var n=this.getWidth(),r=this.getHeight();if(n===this.dataWidth&&r===this.dataHeight)return this.yuvData;var i=n*r,a=new Uint8ClampedArray(i),o=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return Qt.arraycopy(this.yuvData,o,a,0,i),a;for(var s=0;s<r;s++){var c=s*n;Qt.arraycopy(this.yuvData,o,a,c,n),o+=this.dataWidth}return a},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(n,r,i,a){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+n,this.top+r,i,a,!1)},e.prototype.renderThumbnail=function(){for(var n=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,r=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,i=new Int32Array(n*r),a=this.yuvData,o=this.top*this.dataWidth+this.left,s=0;s<r;s++){for(var c=s*n,d=0;d<n;d++){var h=a[o+d*e.THUMBNAIL_SCALE_FACTOR]&255;i[c+d]=4278190080|h*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return i},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(n,r){for(var i=this.yuvData,a=0,o=this.top*this.dataWidth+this.left;a<r;a++,o+=this.dataWidth)for(var s=o+n/2,c=o,d=o+n-1;c<s;c++,d--){var h=i[c];i[c]=i[d],i[d]=h}},e.prototype.invert=function(){return new h2(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Z0);var $W=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();(function(t){$W(e,t);function e(n,r,i,a,o,s,c){var d=t.call(this,r,i)||this;if(d.dataWidth=a,d.dataHeight=o,d.left=s,d.top=c,n.BYTES_PER_ELEMENT===4){for(var h=r*i,p=new Uint8ClampedArray(h),x=0;x<h;x++){var v=n[x],b=v>>16&255,C=v>>7&510,E=v&255;p[x]=(b+C+E)/4&255}d.luminances=p}else d.luminances=n;if(a===void 0&&(d.dataWidth=r),o===void 0&&(d.dataHeight=i),s===void 0&&(d.left=0),c===void 0&&(d.top=0),d.left+r>d.dataWidth||d.top+i>d.dataHeight)throw new qe("Crop rectangle does not fit within image data.");return d}return e.prototype.getRow=function(n,r){if(n<0||n>=this.getHeight())throw new qe("Requested row is outside the image: "+n);var i=this.getWidth();(r==null||r.length<i)&&(r=new Uint8ClampedArray(i));var a=(n+this.top)*this.dataWidth+this.left;return Qt.arraycopy(this.luminances,a,r,0,i),r},e.prototype.getMatrix=function(){var n=this.getWidth(),r=this.getHeight();if(n===this.dataWidth&&r===this.dataHeight)return this.luminances;var i=n*r,a=new Uint8ClampedArray(i),o=this.top*this.dataWidth+this.left;if(n===this.dataWidth)return Qt.arraycopy(this.luminances,o,a,0,i),a;for(var s=0;s<r;s++){var c=s*n;Qt.arraycopy(this.luminances,o,a,c,n),o+=this.dataWidth}return a},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(n,r,i,a){return new e(this.luminances,i,a,this.dataWidth,this.dataHeight,this.left+n,this.top+r)},e.prototype.invert=function(){return new h2(this)},e})(Z0);var GW=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),WW=(function(t){GW(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(n){return this.getCharacterSetECIByName(n)},e})($n),qW=(function(){function t(){}return t.ISO_8859_1=$n.ISO8859_1,t})(),Xv,XW=301,KW=function(t,e){for(var n=1,r=0;r<255;r++)e[r]=n,t[n]=r,n*=2,n>=256&&(n^=XW);return{LOG:t,ALOG:e}};Xv=KW([],[]),Xv.LOG;Xv.ALOG;var D3;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(D3||(D3={}));var M3=129,g5=230,YW=231,ZW=235,JW=236,QW=237,eq=238,tq=239,nq=240,cx=254,rq=254,R3="[)>05",L3="[)>06",j3="",Lt=0,gr=1,zr=2,Un=3,Jn=4,_r=5,iq=(function(){function t(){}return t.prototype.getEncodingMode=function(){return Lt},t.prototype.encode=function(e){var n=Ki.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(n>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var r=e.getCurrentChar(),i=Ki.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(i!==this.getEncodingMode())switch(i){case _r:e.writeCodeword(YW),e.signalEncoderChange(_r);return;case gr:e.writeCodeword(g5),e.signalEncoderChange(gr);return;case Un:e.writeCodeword(eq),e.signalEncoderChange(Un);break;case zr:e.writeCodeword(tq),e.signalEncoderChange(zr);break;case Jn:e.writeCodeword(nq),e.signalEncoderChange(Jn);break;default:throw new Error("Illegal mode: "+i)}else Ki.isExtendedASCII(r)?(e.writeCodeword(ZW),e.writeCodeword(r-128+1),e.pos++):(e.writeCodeword(r+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,n){if(Ki.isDigit(e)&&Ki.isDigit(n)){var r=(e-48)*10+(n-48);return r+130}throw new Error("not digits: "+e+n)},t})(),aq=(function(){function t(){}return t.prototype.getEncodingMode=function(){return _r},t.prototype.encode=function(e){var n=new st;for(n.append(0);e.hasMoreCharacters();){var r=e.getCurrentChar();n.append(r),e.pos++;var i=Ki.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(i!==this.getEncodingMode()){e.signalEncoderChange(Lt);break}}var a=n.length()-1,o=1,s=e.getCodewordCount()+a+o;e.updateSymbolInfo(s);var c=e.getSymbolInfo().getDataCapacity()-s>0;if(e.hasMoreCharacters()||c)if(a<=249)n.setCharAt(0,xt.getCharAt(a));else if(a<=1555)n.setCharAt(0,xt.getCharAt(Math.floor(a/250)+249)),n.insert(1,xt.getCharAt(a%250));else throw new Error("Message length not in valid ranges: "+a);for(var d=0,r=n.length();d<r;d++)e.writeCodeword(this.randomize255State(n.charAt(d).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,n){var r=149*n%255+1,i=e+r;return i<=255?i:i-256},t})(),v2=(function(){function t(){}return t.prototype.getEncodingMode=function(){return gr},t.prototype.encodeMaximal=function(e){for(var n=new st,r=0,i=e.pos,a=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,r=this.encodeChar(o,n),n.length()%3===0&&(i=e.pos,a=n.length())}if(a!==n.length()){var s=Math.floor(n.length()/3*2),c=Math.floor(e.getCodewordCount()+s+1);e.updateSymbolInfo(c);var d=e.getSymbolInfo().getDataCapacity()-c,h=Math.floor(n.length()%3);(h===2&&d!==2||h===1&&(r>3||d!==1))&&(e.pos=i)}n.length()>0&&e.writeCodeword(g5),this.handleEOD(e,n)},t.prototype.encode=function(e){for(var n=new st;e.hasMoreCharacters();){var r=e.getCurrentChar();e.pos++;var i=this.encodeChar(r,n),a=Math.floor(n.length()/3)*2,o=e.getCodewordCount()+a;e.updateSymbolInfo(o);var s=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new st;for(n.length()%3===2&&s!==2&&(i=this.backtrackOneCharacter(e,n,c,i));n.length()%3===1&&(i>3||s!==1);)i=this.backtrackOneCharacter(e,n,c,i);break}var d=n.length();if(d%3===0){var h=Ki.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(h!==this.getEncodingMode()){e.signalEncoderChange(Lt);break}}}this.handleEOD(e,n)},t.prototype.backtrackOneCharacter=function(e,n,r,i){var a=n.length(),o=n.toString().substring(0,a-i);n.setLengthToZero(),n.append(o),e.pos--;var s=e.getCurrentChar();return i=this.encodeChar(s,r),e.resetSymbolInfo(),i},t.prototype.writeNextTriplet=function(e,n){e.writeCodewords(this.encodeToCodewords(n.toString()));var r=n.toString().substring(3);n.setLengthToZero(),n.append(r)},t.prototype.handleEOD=function(e,n){var r=Math.floor(n.length()/3*2),i=n.length()%3,a=e.getCodewordCount()+r;e.updateSymbolInfo(a);var o=e.getSymbolInfo().getDataCapacity()-a;if(i===2){for(n.append("\0");n.length()>=3;)this.writeNextTriplet(e,n);e.hasMoreCharacters()&&e.writeCodeword(cx)}else if(o===1&&i===1){for(;n.length()>=3;)this.writeNextTriplet(e,n);e.hasMoreCharacters()&&e.writeCodeword(cx),e.pos--}else if(i===0){for(;n.length()>=3;)this.writeNextTriplet(e,n);(o>0||e.hasMoreCharacters())&&e.writeCodeword(cx)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Lt)},t.prototype.encodeChar=function(e,n){if(e===32)return n.append(3),1;if(e>=48&&e<=57)return n.append(e-48+4),1;if(e>=65&&e<=90)return n.append(e-65+14),1;if(e<32)return n.append(0),n.append(e),2;if(e<=47)return n.append(1),n.append(e-33),2;if(e<=64)return n.append(1),n.append(e-58+15),2;if(e<=95)return n.append(1),n.append(e-91+22),2;if(e<=127)return n.append(2),n.append(e-96),2;n.append("1");var r=2;return r+=this.encodeChar(e-128,n),r},t.prototype.encodeToCodewords=function(e){var n=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,r=n/256,i=n%256,a=new st;return a.append(r),a.append(i),a.toString()},t})(),oq=(function(){function t(){}return t.prototype.getEncodingMode=function(){return Jn},t.prototype.encode=function(e){for(var n=new st;e.hasMoreCharacters();){var r=e.getCurrentChar();this.encodeChar(r,n),e.pos++;var i=n.length();if(i>=4){e.writeCodewords(this.encodeToCodewords(n.toString()));var a=n.toString().substring(4);n.setLengthToZero(),n.append(a);var o=Ki.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Lt);break}}}n.append(xt.getCharAt(31)),this.handleEOD(e,n)},t.prototype.handleEOD=function(e,n){try{var r=n.length();if(r===0)return;if(r===1){e.updateSymbolInfo();var i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),a=e.getRemainingCharacters();if(a>i&&(e.updateSymbolInfo(e.getCodewordCount()+1),i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),a<=i&&i<=2)return}if(r>4)throw new Error("Count must not exceed 4");var o=r-1,s=this.encodeToCodewords(n.toString()),c=!e.hasMoreCharacters(),d=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();i>=3&&(d=!1,e.updateSymbolInfo(e.getCodewordCount()+s.length))}d?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(s)}finally{e.signalEncoderChange(Lt)}},t.prototype.encodeChar=function(e,n){e>=32&&e<=63?n.append(e):e>=64&&e<=94?n.append(xt.getCharAt(e-64)):Ki.illegalCharacter(xt.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var n=e.length;if(n===0)throw new Error("StringBuilder must not be empty");var r=e.charAt(0).charCodeAt(0),i=n>=2?e.charAt(1).charCodeAt(0):0,a=n>=3?e.charAt(2).charCodeAt(0):0,o=n>=4?e.charAt(3).charCodeAt(0):0,s=(r<<18)+(i<<12)+(a<<6)+o,c=s>>16&255,d=s>>8&255,h=s&255,p=new st;return p.append(c),n>=2&&p.append(d),n>=3&&p.append(h),p.toString()},t})(),sq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),lq=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kt=(function(){function t(e,n,r,i,a,o,s,c){s===void 0&&(s=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=n,this.errorCodewords=r,this.matrixWidth=i,this.matrixHeight=a,this.dataRegions=o,this.rsBlockData=s,this.rsBlockError=c}return t.lookup=function(e,n,r,i,a){var o,s;n===void 0&&(n=0),r===void 0&&(r=null),i===void 0&&(i=null),a===void 0&&(a=!0);try{for(var c=lq(uq),d=c.next();!d.done;d=c.next()){var h=d.value;if(!(n===1&&h.rectangular)&&!(n===2&&!h.rectangular)&&!(r!=null&&(h.getSymbolWidth()<r.getWidth()||h.getSymbolHeight()<r.getHeight()))&&!(i!=null&&(h.getSymbolWidth()>i.getWidth()||h.getSymbolHeight()>i.getHeight()))&&e<=h.dataCapacity)return h}}catch(p){o={error:p}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}if(a)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t})(),cq=(function(t){sq(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(n){return n<=8?156:155},e})(kt),uq=[new kt(!1,3,5,8,8,1),new kt(!1,5,7,10,10,1),new kt(!0,5,7,16,6,1),new kt(!1,8,10,12,12,1),new kt(!0,10,11,14,6,2),new kt(!1,12,12,14,14,1),new kt(!0,16,14,24,10,1),new kt(!1,18,14,16,16,1),new kt(!1,22,18,18,18,1),new kt(!0,22,18,16,10,2),new kt(!1,30,20,20,20,1),new kt(!0,32,24,16,14,2),new kt(!1,36,24,22,22,1),new kt(!1,44,28,24,24,1),new kt(!0,49,28,22,14,2),new kt(!1,62,36,14,14,4),new kt(!1,86,42,16,16,4),new kt(!1,114,48,18,18,4),new kt(!1,144,56,20,20,4),new kt(!1,174,68,22,22,4),new kt(!1,204,84,24,24,4,102,42),new kt(!1,280,112,14,14,16,140,56),new kt(!1,368,144,16,16,16,92,36),new kt(!1,456,192,18,18,16,114,48),new kt(!1,576,224,20,20,16,144,56),new kt(!1,696,272,22,22,16,174,68),new kt(!1,816,336,24,24,16,136,56),new kt(!1,1050,408,18,18,36,175,68),new kt(!1,1304,496,20,20,36,163,62),new cq],dq=(function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var n=e.split("").map(function(s){return s.charCodeAt(0)}),r=new st,i=0,a=n.length;i<a;i++){var o=String.fromCharCode(n[i]&255);if(o==="?"&&e.charAt(i)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");r.append(o)}this.msg=r.toString(),this.shape=0,this.codewords=new st,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,n){this.minSize=e,this.maxSize=n},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=kt.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t})(),fq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),hq=(function(t){fq(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return Un},e.prototype.encode=function(n){for(var r=new st;n.hasMoreCharacters();){var i=n.getCurrentChar();n.pos++,this.encodeChar(i,r);var a=r.length();if(a%3===0){this.writeNextTriplet(n,r);var o=Ki.lookAheadTest(n.getMessage(),n.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){n.signalEncoderChange(Lt);break}}}this.handleEOD(n,r)},e.prototype.encodeChar=function(n,r){switch(n){case 13:r.append(0);break;case 42:r.append(1);break;case 62:r.append(2);break;case 32:r.append(3);break;default:n>=48&&n<=57?r.append(n-48+4):n>=65&&n<=90?r.append(n-65+14):Ki.illegalCharacter(xt.getCharAt(n));break}return 1},e.prototype.handleEOD=function(n,r){n.updateSymbolInfo();var i=n.getSymbolInfo().getDataCapacity()-n.getCodewordCount(),a=r.length();n.pos-=a,(n.getRemainingCharacters()>1||i>1||n.getRemainingCharacters()!==i)&&n.writeCodeword(rq),n.getNewEncoding()<0&&n.signalEncoderChange(Lt)},e})(v2),pq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),mq=(function(t){pq(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return zr},e.prototype.encodeChar=function(n,r){if(n===32)return r.append(3),1;if(n>=48&&n<=57)return r.append(n-48+4),1;if(n>=97&&n<=122)return r.append(n-97+14),1;if(n<32)return r.append(0),r.append(n),2;if(n<=47)return r.append(1),r.append(n-33),2;if(n<=64)return r.append(1),r.append(n-58+15),2;if(n>=91&&n<=95)return r.append(1),r.append(n-91+22),2;if(n===96)return r.append(2),r.append(0),2;if(n<=90)return r.append(2),r.append(n-65+1),2;if(n<=127)return r.append(2),r.append(n-123+27),2;r.append("1");var i=2;return i+=this.encodeChar(n-128,r),i},e})(v2),Ki=(function(){function t(){}return t.randomize253State=function(e){var n=149*e%253+1,r=M3+n;return r<=254?r:r-254},t.encodeHighLevel=function(e,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=null),i===void 0&&(i=null),a===void 0&&(a=!1);var o=new v2,s=[new iq,o,new mq,new hq,new oq,new aq],c=new dq(e);c.setSymbolShape(n),c.setSizeConstraints(r,i),e.startsWith(R3)&&e.endsWith(j3)?(c.writeCodeword(JW),c.setSkipAtEnd(2),c.pos+=R3.length):e.startsWith(L3)&&e.endsWith(j3)&&(c.writeCodeword(QW),c.setSkipAtEnd(2),c.pos+=L3.length);var d=Lt;for(a&&(o.encodeMaximal(c),d=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)s[d].encode(c),c.getNewEncoding()>=0&&(d=c.getNewEncoding(),c.resetEncoderSignal());var h=c.getCodewordCount();c.updateSymbolInfo();var p=c.getSymbolInfo().getDataCapacity();h<p&&d!==Lt&&d!==_r&&d!==Jn&&c.writeCodeword("");var x=c.getCodewords();for(x.length()<p&&x.append(M3);x.length()<p;)x.append(this.randomize253State(x.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,n,r){var i=this.lookAheadTestIntern(e,n,r);if(r===Un&&i===Un){for(var a=Math.min(n+3,e.length),o=n;o<a;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Lt}else if(r===Jn&&i===Jn){for(var a=Math.min(n+4,e.length),o=n;o<a;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Lt}return i},t.lookAheadTestIntern=function(e,n,r){if(n>=e.length)return r;var i;r===Lt?i=[0,1,1,1,1,1.25]:(i=[1,2,2,2,2,2.25],i[r]=0);for(var a=0,o=new Uint8Array(6),s=[];;){if(n+a===e.length){Gn.fill(o,0),Gn.fill(s,0);var c=this.findMinimums(i,s,lt.MAX_VALUE,o),d=this.getMinimumCount(o);if(s[Lt]===c)return Lt;if(d===1){if(o[_r]>0)return _r;if(o[Jn]>0)return Jn;if(o[zr]>0)return zr;if(o[Un]>0)return Un}return gr}var h=e.charCodeAt(n+a);if(a++,this.isDigit(h)?i[Lt]+=.5:this.isExtendedASCII(h)?(i[Lt]=Math.ceil(i[Lt]),i[Lt]+=2):(i[Lt]=Math.ceil(i[Lt]),i[Lt]++),this.isNativeC40(h)?i[gr]+=2/3:this.isExtendedASCII(h)?i[gr]+=8/3:i[gr]+=4/3,this.isNativeText(h)?i[zr]+=2/3:this.isExtendedASCII(h)?i[zr]+=8/3:i[zr]+=4/3,this.isNativeX12(h)?i[Un]+=2/3:this.isExtendedASCII(h)?i[Un]+=13/3:i[Un]+=10/3,this.isNativeEDIFACT(h)?i[Jn]+=3/4:this.isExtendedASCII(h)?i[Jn]+=17/4:i[Jn]+=13/4,this.isSpecialB256(h)?i[_r]+=4:i[_r]++,a>=4){if(Gn.fill(o,0),Gn.fill(s,0),this.findMinimums(i,s,lt.MAX_VALUE,o),s[Lt]<this.min(s[_r],s[gr],s[zr],s[Un],s[Jn]))return Lt;if(s[_r]<s[Lt]||s[_r]+1<this.min(s[gr],s[zr],s[Un],s[Jn]))return _r;if(s[Jn]+1<this.min(s[_r],s[gr],s[zr],s[Un],s[Lt]))return Jn;if(s[zr]+1<this.min(s[_r],s[gr],s[Jn],s[Un],s[Lt]))return zr;if(s[Un]+1<this.min(s[_r],s[gr],s[Jn],s[zr],s[Lt]))return Un;if(s[gr]+1<this.min(s[Lt],s[_r],s[Jn],s[zr])){if(s[gr]<s[Un])return gr;if(s[gr]===s[Un]){for(var p=n+a+1;p<e.length;){var x=e.charCodeAt(p);if(this.isX12TermSep(x))return Un;if(!this.isNativeX12(x))break;p++}return gr}}}}},t.min=function(e,n,r,i,a){var o=Math.min(e,Math.min(n,Math.min(r,i)));return a===void 0?o:Math.min(o,a)},t.findMinimums=function(e,n,r,i){for(var a=0;a<6;a++){var o=n[a]=Math.ceil(e[a]);r>o&&(r=o,Gn.fill(i,0)),r===o&&(i[a]=i[a]+1)}return r},t.getMinimumCount=function(e){for(var n=0,r=0;r<6;r++)n+=e[r];return n||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,n){n===void 0&&(n=0);for(var r=e.length,i=n;i<r&&this.isDigit(e.charCodeAt(i));)i++;return i-n},t.illegalCharacter=function(e){var n=lt.toHexString(e.charCodeAt(0));throw n="0000".substring(0,4-n.length)+n,new Error("Illegal character: "+e+" (0x"+n+")")},t})(),ux=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P3=(function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Pi.encode(e,this.charset)!=null}catch{return!1}},t})(),gq=(function(){function t(e,n,r){var i,a,o,s,c,d;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(U){return new P3(WW.forName(U))}),this.encoders=[];var h=[];h.push(new P3(qW.ISO_8859_1));for(var p=n!=null&&n.name.startsWith("UTF"),x=0;x<e.length;x++){var v=!1;try{for(var b=(i=void 0,ux(h)),C=b.next();!C.done;C=b.next()){var E=C.value,S=e.charAt(x),N=S.charCodeAt(0);if(N===r||E.canEncode(S)){v=!0;break}}}catch(U){i={error:U}}finally{try{C&&!C.done&&(a=b.return)&&a.call(b)}finally{if(i)throw i.error}}if(!v)try{for(var k=(o=void 0,ux(this.ENCODERS)),I=k.next();!I.done;I=k.next()){var E=I.value;if(E.canEncode(e.charAt(x))){h.push(E),v=!0;break}}}catch(U){o={error:U}}finally{try{I&&!I.done&&(s=k.return)&&s.call(k)}finally{if(o)throw o.error}}v||(p=!0)}if(h.length===1&&!p)this.encoders=[h[0]];else{this.encoders=[];var D=0;try{for(var L=ux(h),O=L.next();!O.done;O=L.next()){var E=O.value;this.encoders[D++]=E}}catch(U){c={error:U}}finally{try{O&&!O.done&&(d=L.return)&&d.call(L)}finally{if(c)throw c.error}}}var j=-1;if(n!=null){for(var x=0;x<this.encoders.length;x++)if(this.encoders[x]!=null&&n.name===this.encoders[x].name){j=x;break}}this.priorityEncoderIndex=j}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,n){if(!(n<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,n){if(!(n<this.length()))throw new Error("index must be less than length");return Pi.encode(xt.getCharAt(e),this.encoders[n].name)},t})(),xq=3,vq=(function(){function t(e,n,r){this.fnc1=r;var i=new gq(e,n,r);if(i.length()===1)for(var a=0;a<this.bytes.length;a++){var o=e.charAt(a).charCodeAt(0);this.bytes[a]=o===r?1e3:o}else this.bytes=this.encodeMinimally(e,i,r)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,n){if(e+n-1>=this.bytes.length)return!1;for(var r=0;r<n;r++)if(this.isECI(e+r))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,n){if(e<0||e>n||n>this.length())throw new Error(""+e);for(var r=new st,i=e;i<n;i++){if(this.isECI(i))throw new Error("value at "+i+" is not a character but an ECI");r.append(this.charAt(i))}return r.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,n,r){(e[n][r.encoderIndex]==null||e[n][r.encoderIndex].cachedTotalSize>r.cachedTotalSize)&&(e[n][r.encoderIndex]=r)},t.prototype.addEdges=function(e,n,r,i,a,o){var s=e.charAt(i).charCodeAt(0),c=0,d=n.length();n.getPriorityEncoderIndex()>=0&&(s===o||n.canEncode(s,n.getPriorityEncoderIndex()))&&(c=n.getPriorityEncoderIndex(),d=c+1);for(var h=c;h<d;h++)(s===o||n.canEncode(s,h))&&this.addEdge(r,i+1,new B3(s,n,h,a,o))},t.prototype.encodeMinimally=function(e,n,r){var i=e.length,a=new B3[i+1][n.length()];this.addEdges(e,n,a,0,null,r);for(var o=1;o<=i;o++){for(var s=0;s<n.length();s++)a[o][s]!=null&&o<i&&this.addEdges(e,n,a,o,a[o][s],r);for(var s=0;s<n.length();s++)a[o-1][s]=null}for(var c=-1,d=lt.MAX_VALUE,s=0;s<n.length();s++)if(a[i][s]!=null){var h=a[i][s];h.cachedTotalSize<d&&(d=h.cachedTotalSize,c=s)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var p=[],x=a[i][c];x!=null;){if(x.isFNC1())p.unshift(1e3);else for(var v=n.encode(x.c,x.encoderIndex),o=v.length-1;o>=0;o--)p.unshift(v[o]&255);var b=x.previous===null?0:x.previous.encoderIndex;b!==x.encoderIndex&&p.unshift(256+n.getECIValue(x.encoderIndex)),x=x.previous}for(var C=[],o=0;o<C.length;o++)C[o]=p[o];return C},t})(),B3=(function(){function t(e,n,r,i,a){this.c=e,this.encoderSet=n,this.encoderIndex=r,this.previous=i,this.fnc1=a,this.c=e===a?1e3:e;var o=this.isFNC1()?1:n.encode(e,r).length,s=i===null?0:i.encoderIndex;s!==r&&(o+=xq),i!=null&&(o+=i.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t})(),yq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})();var F3;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(F3||(F3={}));(function(t){yq(e,t);function e(n,r,i,a,o){var s=t.call(this,n,r,i)||this;return s.shape=a,s.macroId=o,s}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(vq);var bq=(function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t})(),z3=(function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,n){return e.sort(n)[0]},t})(),wq=(function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t})(),Cq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),y2=(function(t){Cq(e,t);function e(n,r,i){var a=t.call(this,n)||this;return a.value=r,a.bitCount=i,a}return e.prototype.appendTo=function(n,r){n.appendBits(this.value,this.bitCount)},e.prototype.add=function(n,r){return new e(this,n,r)},e.prototype.addBinaryShift=function(n,r){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,n,r)},e.prototype.toString=function(){var n=this.value&(1<<this.bitCount)-1;return n|=1<<this.bitCount,"<"+lt.toBinaryString(n|1<<this.bitCount).substring(1)+">"},e})(wq),Eq=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Sq=(function(t){Eq(e,t);function e(n,r,i){var a=t.call(this,n,0,0)||this;return a.binaryShiftStart=r,a.binaryShiftByteCount=i,a}return e.prototype.appendTo=function(n,r){for(var i=0;i<this.binaryShiftByteCount;i++)(i===0||i===31&&this.binaryShiftByteCount<=62)&&(n.appendBits(31,5),this.binaryShiftByteCount>62?n.appendBits(this.binaryShiftByteCount-31,16):i===0?n.appendBits(Math.min(this.binaryShiftByteCount,31),5):n.appendBits(this.binaryShiftByteCount-31,5)),n.appendBits(r[this.binaryShiftStart+i],8)},e.prototype.addBinaryShift=function(n,r){return new e(this,n,r)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e})(y2);function Aq(t,e,n){return new Sq(t,e,n)}function Uu(t,e,n){return new y2(t,e,n)}var _q=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],is=0,d0=1,Ri=2,x5=3,ga=4,Nq=new y2(null,0,0),dx=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],kq=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Tq(t){var e,n;try{for(var r=kq(t),i=r.next();!i.done;i=r.next()){var a=i.value;Gn.fill(a,-1)}}catch(o){e={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return t[is][ga]=0,t[d0][ga]=0,t[d0][is]=28,t[x5][ga]=0,t[Ri][ga]=0,t[Ri][is]=15,t}var v5=Tq(Gn.createInt32Array(6,6)),Oq=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Iq=(function(){function t(e,n,r,i){this.token=e,this.mode=n,this.binaryShiftByteCount=r,this.bitCount=i}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,n){var r=this.bitCount,i=this.token;if(e!==this.mode){var a=dx[this.mode][e];i=Uu(i,a&65535,a>>16),r+=a>>16}var o=e===Ri?4:5;return i=Uu(i,n,o),new t(i,e,0,r+o)},t.prototype.shiftAndAppend=function(e,n){var r=this.token,i=this.mode===Ri?4:5;return r=Uu(r,v5[this.mode][e],i),r=Uu(r,n,5),new t(r,this.mode,0,this.bitCount+i+5)},t.prototype.addBinaryShiftChar=function(e){var n=this.token,r=this.mode,i=this.bitCount;if(this.mode===ga||this.mode===Ri){var a=dx[r][is];n=Uu(n,a&65535,a>>16),i+=a>>16,r=is}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new t(n,r,this.binaryShiftByteCount+1,i+o);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var n=this.token;return n=Aq(n,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(n,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var n=this.bitCount+(dx[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?n+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(n+=10),n<=e.bitCount},t.prototype.toBitArray=function(e){for(var n,r,i=[],a=this.endBinaryShift(e.length).token;a!==null;a=a.getPrevious())i.unshift(a);var o=new rr;try{for(var s=Oq(i),c=s.next();!c.done;c=s.next()){var d=c.value;d.appendTo(o,e)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},t.prototype.toString=function(){return xt.format("%s bits=%d bytes=%d",_q[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(Nq,is,0,0),t})();function Dq(t){var e=xt.getCharCode(" "),n=xt.getCharCode("."),r=xt.getCharCode(",");t[is][e]=1;for(var i=xt.getCharCode("Z"),a=xt.getCharCode("A"),o=a;o<=i;o++)t[is][o]=o-a+2;t[d0][e]=1;for(var s=xt.getCharCode("z"),c=xt.getCharCode("a"),o=c;o<=s;o++)t[d0][o]=o-c+2;t[Ri][e]=1;for(var d=xt.getCharCode("9"),h=xt.getCharCode("0"),o=h;o<=d;o++)t[Ri][o]=o-h+2;t[Ri][r]=12,t[Ri][n]=13;for(var p=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],x=0;x<p.length;x++)t[x5][xt.getCharCode(p[x])]=x;for(var v=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],x=0;x<v.length;x++)xt.getCharCode(v[x])>0&&(t[ga][xt.getCharCode(v[x])]=x);return t}var fx=Dq(Gn.createInt32Array(5,256)),Ph=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Mq=(function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=xt.getCharCode(" "),n=xt.getCharCode(`
`),r=z3.singletonList(Iq.INITIAL_STATE),i=0;i<this.text.length;i++){var a=void 0,o=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case xt.getCharCode("\r"):a=o===n?2:0;break;case xt.getCharCode("."):a=o===e?3:0;break;case xt.getCharCode(","):a=o===e?4:0;break;case xt.getCharCode(":"):a=o===e?5:0;break;default:a=0}a>0?(r=t.updateStateListForPair(r,i,a),i++):r=this.updateStateListForChar(r,i)}var s=z3.min(r,function(c,d){return c.getBitCount()-d.getBitCount()});return s.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,n){var r,i,a=[];try{for(var o=Ph(e),s=o.next();!s.done;s=o.next()){var c=s.value;this.updateStateForChar(c,n,a)}}catch(d){r={error:d}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return t.simplifyStates(a)},t.prototype.updateStateForChar=function(e,n,r){for(var i=this.text[n]&255,a=fx[e.getMode()][i]>0,o=null,s=0;s<=ga;s++){var c=fx[s][i];if(c>0){if(o==null&&(o=e.endBinaryShift(n)),!a||s===e.getMode()||s===Ri){var d=o.latchAndAppend(s,c);r.push(d)}if(!a&&v5[e.getMode()][s]>=0){var h=o.shiftAndAppend(s,c);r.push(h)}}}if(e.getBinaryShiftByteCount()>0||fx[e.getMode()][i]===0){var p=e.addBinaryShiftChar(n);r.push(p)}},t.updateStateListForPair=function(e,n,r){var i,a,o=[];try{for(var s=Ph(e),c=s.next();!c.done;c=s.next()){var d=c.value;this.updateStateForPair(d,n,r,o)}}catch(h){i={error:h}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,n,r,i){var a=e.endBinaryShift(n);if(i.push(a.latchAndAppend(ga,r)),e.getMode()!==ga&&i.push(a.shiftAndAppend(ga,r)),r===3||r===4){var o=a.latchAndAppend(Ri,16-r).latchAndAppend(Ri,1);i.push(o)}if(e.getBinaryShiftByteCount()>0){var s=e.addBinaryShiftChar(n).addBinaryShiftChar(n+1);i.push(s)}},t.simplifyStates=function(e){var n,r,i,a,o=[];try{for(var s=Ph(e),c=s.next();!c.done;c=s.next()){var d=c.value,h=!0,p=function(E){if(E.isBetterThanOrEqualTo(d))return h=!1,"break";d.isBetterThanOrEqualTo(E)&&(o=o.filter(function(S){return S!==E}))};try{for(var x=(i=void 0,Ph(o)),v=x.next();!v.done;v=x.next()){var b=v.value,C=p(b);if(C==="break")break}}catch(E){i={error:E}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}h&&o.push(d)}}catch(E){n={error:E}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},t})(),Rq=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,n,r){var i=new Mq(e).encode(),a=lt.truncDivision(i.getSize()*n,100)+11,o=i.getSize()+a,s,c,d,h,p;if(r!==t.DEFAULT_AZTEC_LAYERS){if(s=r<0,c=Math.abs(r),c>(s?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new qe(xt.format("Illegal value %s for layers",r));d=t.totalBitsInLayer(c,s),h=t.WORD_SIZE[c];var x=d-d%h;if(p=t.stuffBits(i,h),p.getSize()+a>x)throw new qe("Data to large for user specified layer");if(s&&p.getSize()>h*64)throw new qe("Data to large for user specified layer")}else{h=0,p=null;for(var v=0;;v++){if(v>t.MAX_NB_BITS)throw new qe("Data too large for an Aztec code");if(s=v<=3,c=s?v+1:v,d=t.totalBitsInLayer(c,s),!(o>d)){(p==null||h!==t.WORD_SIZE[c])&&(h=t.WORD_SIZE[c],p=t.stuffBits(i,h));var x=d-d%h;if(!(s&&p.getSize()>h*64)&&p.getSize()+a<=x)break}}}var b=t.generateCheckWords(p,d,h),C=p.getSize()/h,E=t.generateModeMessage(s,c,C),S=(s?11:14)+c*4,N=new Int32Array(S),k;if(s){k=S;for(var v=0;v<N.length;v++)N[v]=v}else{k=S+1+2*lt.truncDivision(lt.truncDivision(S,2)-1,15);for(var I=lt.truncDivision(S,2),D=lt.truncDivision(k,2),v=0;v<I;v++){var L=v+lt.truncDivision(v,15);N[I-v-1]=D-L-1,N[I+v]=D+L+1}}for(var O=new wa(k),v=0,j=0;v<c;v++){for(var U=(c-v)*4+(s?9:12),fe=0;fe<U;fe++)for(var le=fe*2,q=0;q<2;q++)b.get(j+le+q)&&O.set(N[v*2+q],N[v*2+fe]),b.get(j+U*2+le+q)&&O.set(N[v*2+fe],N[S-1-v*2-q]),b.get(j+U*4+le+q)&&O.set(N[S-1-v*2-q],N[S-1-v*2-fe]),b.get(j+U*6+le+q)&&O.set(N[S-1-v*2-fe],N[v*2+q]);j+=U*8}if(t.drawModeMessage(O,s,k,E),s)t.drawBullsEye(O,lt.truncDivision(k,2),5);else{t.drawBullsEye(O,lt.truncDivision(k,2),7);for(var v=0,fe=0;v<lt.truncDivision(S,2)-1;v+=15,fe+=16)for(var q=lt.truncDivision(k,2)&1;q<k;q+=2)O.set(lt.truncDivision(k,2)-fe,q),O.set(lt.truncDivision(k,2)+fe,q),O.set(q,lt.truncDivision(k,2)-fe),O.set(q,lt.truncDivision(k,2)+fe)}var de=new bq;return de.setCompact(s),de.setSize(k),de.setLayers(c),de.setCodeWords(C),de.setMatrix(O),de},t.drawBullsEye=function(e,n,r){for(var i=0;i<r;i+=2)for(var a=n-i;a<=n+i;a++)e.set(a,n-i),e.set(a,n+i),e.set(n-i,a),e.set(n+i,a);e.set(n-r,n-r),e.set(n-r+1,n-r),e.set(n-r,n-r+1),e.set(n+r,n-r),e.set(n+r,n-r+1),e.set(n+r,n+r-1)},t.generateModeMessage=function(e,n,r){var i=new rr;return e?(i.appendBits(n-1,2),i.appendBits(r-1,6),i=t.generateCheckWords(i,28,4)):(i.appendBits(n-1,5),i.appendBits(r-1,11),i=t.generateCheckWords(i,40,4)),i},t.drawModeMessage=function(e,n,r,i){var a=lt.truncDivision(r,2);if(n)for(var o=0;o<7;o++){var s=a-3+o;i.get(o)&&e.set(s,a-5),i.get(o+7)&&e.set(a+5,s),i.get(20-o)&&e.set(s,a+5),i.get(27-o)&&e.set(a-5,s)}else for(var o=0;o<10;o++){var s=a-5+o+lt.truncDivision(o,5);i.get(o)&&e.set(s,a-7),i.get(o+10)&&e.set(a+7,s),i.get(29-o)&&e.set(s,a+7),i.get(39-o)&&e.set(a-7,s)}},t.generateCheckWords=function(e,n,r){var i,a,o=e.getSize()/r,s=new m5(t.getGF(r)),c=lt.truncDivision(n,r),d=t.bitsToWords(e,r,c);s.encode(d,c-o);var h=n%r,p=new rr;p.appendBits(0,h);try{for(var x=Rq(Array.from(d)),v=x.next();!v.done;v=x.next()){var b=v.value;p.appendBits(b,r)}}catch(C){i={error:C}}finally{try{v&&!v.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}return p},t.bitsToWords=function(e,n,r){var i=new Int32Array(r),a,o;for(a=0,o=e.getSize()/n;a<o;a++){for(var s=0,c=0;c<n;c++)s|=e.get(a*n+c)?1<<n-c-1:0;i[a]=s}return i},t.getGF=function(e){switch(e){case 4:return ri.AZTEC_PARAM;case 6:return ri.AZTEC_DATA_6;case 8:return ri.AZTEC_DATA_8;case 10:return ri.AZTEC_DATA_10;case 12:return ri.AZTEC_DATA_12;default:throw new qe("Unsupported word size "+e)}},t.stuffBits=function(e,n){for(var r=new rr,i=e.getSize(),a=(1<<n)-2,o=0;o<i;o+=n){for(var s=0,c=0;c<n;c++)(o+c>=i||e.get(o+c))&&(s|=1<<n-1-c);(s&a)===a?(r.appendBits(s&a,n),o--):(s&a)===0?(r.appendBits(s|1,n),o--):r.appendBits(s,n)}return r},t.totalBitsInLayer=function(e,n){return((n?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();const y5=new Set(["localhost","127.0.0.1"]),Lq="http://localhost:8000",jq="https://api.tomehub.nl",Pq="https://api.tomehub.nl".trim(),Bq=y5.has(window.location.hostname)?Lq:jq,ct=(Pq||Bq).replace(/\/+$/,""),Fq="Backend baglantisi kurulamadi. `apps/backend` klasorunde `python app.py` calistirin (port 8000).";async function zq(){const{auth:t}=await ol(async()=>{const{auth:n}=await Promise.resolve().then(()=>xT);return{auth:n}},void 0),e=t.currentUser;if(!e)throw new Error("Oturum dogrulamasi bulunamadi. Lutfen tekrar giris yapin.");return e.getIdToken()}async function nn(t,e={}){var a;const n=await zq(),{auth:r}=await ol(async()=>{const{auth:o}=await Promise.resolve().then(()=>xT);return{auth:o}},void 0),i=new Headers(e.headers||{});if(i.has("Authorization")||i.set("Authorization",`Bearer ${n}`),y5.has(window.location.hostname)&&!i.has("X-Firebase-UID")){const o=(a=r.currentUser)==null?void 0:a.uid;o&&i.set("X-Firebase-UID",o)}return fetch(t,{...e,headers:i})}async function ia(t,e){try{const n=await t.json(),r=(n==null?void 0:n.detail)||(n==null?void 0:n.details)||(n==null?void 0:n.error);if(typeof r=="string"&&r.trim())return r}catch{}return e}function cc(t){return t instanceof TypeError&&/fetch/i.test(t.message)?`${Fq} (API: ${ct})`:t instanceof Error&&t.message?t.message:"Beklenmeyen API hatasi"}const b5=t=>{const e=(t||"").trim().toUpperCase();return e==="NOTE"||e==="PERSONAL"?"PERSONAL_NOTE":e==="NOTES"?"HIGHLIGHT":e==="INSIGHTS"?"INSIGHT":e||"PERSONAL_NOTE"};async function Uq(t,e,n="STANDARD",r,i="AUTO",a){if(!e)throw new Error("User must be authenticated to search");const o=await nn(`${ct}/api/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,firebase_uid:e,mode:n,book_id:r,context_book_id:a,scope_mode:i})});if(!o.ok){const s=await o.json();throw new Error(s.details||s.error||"Search failed")}return o.json()}async function Hq(t,e,n=null,r="EXPLORER",i=null,a=20,o="AUTO",s=null,c=null){if(!e)throw new Error("User must be authenticated to chat");const d=await nn(`${ct}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,firebase_uid:e,session_id:n,mode:r,resource_type:i,scope_mode:o,book_id:s,context_book_id:c,limit:a})});if(!d.ok){const h=await d.json();throw new Error(h.details||h.error||"Chat failed")}return d.json()}async function w5(t,e,n,r,i,a){if(!r)throw new Error("User must be authenticated to ingest documents");const o=new FormData;o.append("file",t),o.append("title",e),o.append("author",n),o.append("firebase_uid",r),i&&o.append("book_id",i),a&&o.append("tags",a);const s=await nn(`${ct}/api/ingest`,{method:"POST",body:o});if(!s.ok){const c=await s.json();throw new Error(c.details||c.error||"Ingestion failed")}return s.json()}async function Vq(t){const e=await nn(`${ct}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.details||n.error||"Feedback failed")}return e.json()}async function $q(t,e,n){if(!e)throw new Error("User must be authenticated to fetch ingestion status");const r=new URLSearchParams;r.set("firebase_uid",e),n&&n.trim()&&r.set("title",n.trim());const i=await nn(`${ct}/api/books/${encodeURIComponent(t)}/ingestion-status?${r.toString()}`,{method:"GET",headers:{"Content-Type":"application/json","X-Firebase-UID":e}});if(!i.ok){const a=await i.json();throw new Error(a.details||a.error||"Failed to fetch ingestion status")}return i.json()}async function Gq(t){const e=new FormData;e.append("file",t);const n=await nn(`${ct}/api/extract-metadata`,{method:"POST",body:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Metadata extraction failed")}return n.json()}async function C5(t,e,n,r,i,a){const o=b5(r),s=await nn(`${ct}/api/add-item`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,title:e,author:n,type:o,firebase_uid:i,...a})});if(!s.ok)throw new Error("Failed to add item");return s.json()}async function Wq(t,e){const n=t.map(i=>({...i,type:b5(i.type)})),r=await nn(`${ct}/api/migrate_bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n,firebase_uid:e})});if(!r.ok)throw new Error("Failed to migrate batch");return r.json()}async function Kv(t,e,n,r,i){const a=i.map(s=>({...s,type:M0(s.type)})),o=await nn(`${ct}/api/books/${encodeURIComponent(e)}/sync-highlights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,title:n,author:r,highlights:a})});if(!o.ok){const s=await o.text();throw new Error(s||"Failed to sync highlights")}return o.json()}async function qq(t,e,n){const r=await nn(`${ct}/api/notes/${encodeURIComponent(e)}/sync-personal-note`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,...n})});if(!r.ok){const i=await r.text();throw new Error(i||"Failed to sync personal note")}return r.json()}async function U3(t,e){const n=await nn(`${ct}/api/resources/${encodeURIComponent(e)}/purge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t})});if(!n.ok)throw new Error("Failed to purge resource content");return n.json()}async function Xq(t,e,n,r=50,i=0){const a=new URL(`${ct}/api/analytics/concordance`);a.searchParams.append("book_id",e),a.searchParams.append("term",n),a.searchParams.append("limit",r.toString()),a.searchParams.append("offset",i.toString()),a.searchParams.append("firebase_uid",t);const o=await nn(a.toString(),{headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch concordance");return o.json()}async function Kq(t,e,n){const r=new URL(`${ct}/api/analytics/distribution`);r.searchParams.append("book_id",e),r.searchParams.append("term",n),r.searchParams.append("firebase_uid",t);const i=await nn(r.toString(),{headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to fetch distribution");return i.json()}async function Yq(t,e=0,n=100){if(!t)throw new Error("User must be authenticated for realtime polling");const r=new URL(`${ct}/api/realtime/poll`);r.searchParams.append("firebase_uid",t),r.searchParams.append("since_ms",String(Math.max(0,Math.floor(e||0)))),r.searchParams.append("limit",String(Math.min(300,Math.max(1,Math.floor(n||100)))));const i=await nn(r.toString(),{headers:{"Content-Type":"application/json"}});if(i.status===404)throw new Error("REALTIME_ENDPOINT_NOT_FOUND");if(!i.ok){let a="Realtime polling failed";try{const o=await i.json();a=o.details||o.error||a}catch{}throw new Error(a)}return i.json()}async function Zq(t){const e=new FormData;e.append("file",t);const n=await nn(`${ct}/api/scan-isbn`,{method:"POST",body:e});if(n.status===404)throw new Error("NO_BARCODE_FOUND");if(!n.ok){const i=await n.json().catch(()=>({error:"Scan failed"}));throw new Error(i.details||i.error||"Barcode scan failed")}return(await n.json()).isbn}const Jq=[Ue.EAN_13,Ue.EAN_8,Ue.UPC_A,Ue.UPC_E,Ue.CODE_128],H3=["ean_13","ean_8","upc_a","upc_e","code_128"],V3=t=>{var a,o;const e=String(t||"").replace(/[\s-]/g,"").trim(),n=e.replace(/[^0-9Xx]/g,"").toUpperCase();if(n.length===13||n.length===10)return n;const r=(a=n.match(/97[89]\d{10}/))==null?void 0:a[0];if(r)return r;const i=(o=n.match(/\d{9}[0-9X]/))==null?void 0:o[0];return i||e},Qq=t=>{var i,a;if(!t)return null;const e=t.toUpperCase().replace(/[^0-9X]/g,""),n=(i=e.match(/97[89]\d{10}/))==null?void 0:i[0];if(n)return n;const r=(a=e.match(/\d{9}[0-9X]/))==null?void 0:a[0];return r||null},$3=()=>{const t=new Map;return t.set(en.POSSIBLE_FORMATS,Jq),t.set(en.TRY_HARDER,!0),new jW(t,160)},eX=t=>new Promise((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=()=>n(new Error("Image could not be loaded")),r.src=t}),tX=(t,e,n)=>{const r=document.createElement("canvas"),i=e===90||e===270;r.width=i?t.naturalHeight:t.naturalWidth,r.height=i?t.naturalWidth:t.naturalHeight;const a=r.getContext("2d",{willReadFrequently:!0});return a&&(a.save(),a.translate(r.width/2,r.height/2),a.rotate(e*Math.PI/180),a.filter=n,a.drawImage(t,-t.naturalWidth/2,-t.naturalHeight/2),a.restore()),r},hx=t=>{var e;return!t||t.length===0?null:((e=t.find(n=>!!(n!=null&&n.rawValue)))==null?void 0:e.rawValue)||null},G3=({onDetected:t,onClose:e})=>{const n=A.useRef(null),r=A.useRef(null),i=A.useRef(null),a=A.useRef(null),o=A.useRef(null),s=A.useRef(null),c=A.useRef(!1),[d,h]=A.useState(null),[p,x]=A.useState(!0),[v,b]=A.useState(!1),[C,E]=A.useState(""),S=A.useRef(t);S.current=t;const N=A.useRef(e);N.current=e;const k=A.useCallback(()=>{if(o.current!==null&&(window.clearTimeout(o.current),o.current=null),s.current=null,a.current){try{a.current.reset()}catch{}a.current=null}i.current&&(i.current.getTracks().forEach(le=>le.stop()),i.current=null),n.current&&(n.current.srcObject=null)},[]),I=A.useCallback(le=>{const q=V3(le);!q||c.current||(c.current=!0,k(),S.current(q))},[k]),D=A.useCallback(async le=>{var de;const q=$3();try{const ge=await q.decodeFromImageUrl(le);return((de=ge==null?void 0:ge.getText)==null?void 0:de.call(ge))||null}catch{return null}finally{try{q.reset()}catch{}}},[]),L=A.useCallback(async le=>{var q;try{const{createWorker:de}=await ol(async()=>{const{createWorker:xe}=await Promise.resolve().then(()=>mJ);return{createWorker:xe}},void 0),ge=await de("eng");try{const xe=await ge.recognize(le),H=((q=xe==null?void 0:xe.data)==null?void 0:q.text)||"";return Qq(H)}finally{await ge.terminate()}}catch{return null}},[]),O=A.useCallback(async le=>{const q=window.BarcodeDetector,de=q?new q({formats:H3}):null;let ge=null;try{if(ge=await createImageBitmap(le),de){const H=hx(await de.detect(ge));if(H)return H}}catch{}finally{ge&&ge.close()}const xe=URL.createObjectURL(le);try{const H=await D(xe);if(H)return H;const ie=await eX(xe),K=[0,90,180,270],B=["none","grayscale(1) contrast(1.9) brightness(1.1)"];for(const M of K)for(const V of B){const Z=tX(ie,M,V);if(de)try{const J=hx(await de.detect(Z));if(J)return J}catch{}const re=Z.toDataURL("image/jpeg",.95),_e=await D(re);if(_e)return _e}const G=await L(le);return G||null}finally{URL.revokeObjectURL(xe)}},[L,D]);A.useEffect(()=>{let le=!0;return(async()=>{try{const de=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"},width:{ideal:1920,min:640},height:{ideal:1080,min:480}},audio:!1});if(!le){de.getTracks().forEach(ie=>ie.stop());return}i.current=de;const ge=n.current;if(!ge||(ge.srcObject=de,ge.setAttribute("playsinline","true"),ge.setAttribute("autoplay","true"),ge.muted=!0,await ge.play(),!le))return;x(!1);const xe=window.BarcodeDetector;if(xe)try{s.current=new xe({formats:H3});const ie=async()=>{if(!le||c.current)return;const K=s.current;if(K){try{const B=await K.detect(ge),G=hx(B);if(G){I(G);return}}catch{}o.current=window.setTimeout(ie,120)}};ie()}catch{s.current=null}const H=$3();a.current=H,H.decodeFromVideoElementContinuously(ge,(ie,K)=>{if(!(!le||c.current)){if(ie){I(ie.getText());return}K&&K instanceof he}})}catch(de){if(!le)return;const ge=de instanceof Error?de.message:String(de);ge.includes("NotAllowed")||ge.includes("Permission")||ge.includes("denied")?h("Camera permission denied. Please allow camera access and try again."):ge.includes("NotFound")||ge.includes("Overconstrained")?h("No suitable camera found on this device."):h(`Camera error: ${ge}`),x(!1)}})(),()=>{le=!1,k()}},[k,I]);const j=A.useCallback(()=>{k(),N.current()},[k]),U=A.useCallback(()=>{const le=V3(C);le&&(k(),S.current(le))},[C,k]),fe=A.useCallback(async le=>{var de;const q=(de=le.target.files)==null?void 0:de[0];if(q){h(null),b(!0);try{const ge=await Zq(q);I(ge)}catch(ge){if((ge instanceof Error?ge.message:"")==="NO_BARCODE_FOUND"){h("Could not read barcode from photo. Try better lighting or a flatter angle.");return}try{const H=await O(q);if(!H){h("Could not read barcode from photo. Try another angle, better light, or use manual ISBN.");return}I(H)}catch(H){const ie=H instanceof Error?H.message:String(H);h(`Photo decode failed: ${ie}`)}}finally{b(!1),le.target.value=""}}},[O,I]);return m.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[60] p-4",children:m.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden",children:[m.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[m.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[m.jsx(vc,{className:"text-[#CC561E]",size:20}),"Scan ISBN Barcode"]}),m.jsx("button",{onClick:j,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:m.jsx(ta,{size:20})})]}),m.jsxs("div",{className:"p-4",children:[m.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-black min-h-[320px]",children:[m.jsx("video",{ref:n,className:"w-full h-[320px] object-cover",playsInline:!0,autoPlay:!0,muted:!0}),m.jsx("div",{className:"absolute inset-0 pointer-events-none",children:m.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:m.jsxs("div",{className:"w-[280px] h-[90px] relative",children:[m.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-l-2 border-t-2 border-white"}),m.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-r-2 border-t-2 border-white"}),m.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-l-2 border-b-2 border-white"}),m.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-r-2 border-b-2 border-white"}),m.jsx("div",{className:"absolute top-1/2 left-2 right-2 h-0.5 bg-[#CC561E]/70 animate-pulse"})]})})}),p&&m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/50",children:[m.jsx(kn,{className:"animate-spin text-[#CC561E]",size:32}),m.jsx("p",{className:"text-sm text-slate-200",children:"Starting camera..."})]})]}),m.jsx("p",{className:"text-center text-xs text-slate-400 dark:text-slate-500 mt-3",children:"Align the barcode in the frame and keep the phone steady."}),d&&m.jsx("p",{className:"mt-2 text-center text-xs text-red-500 dark:text-red-400",children:d}),m.jsxs("div",{className:"mt-3",children:[m.jsx("input",{ref:r,type:"file",accept:"image/*",capture:"environment",onChange:fe,className:"hidden"}),m.jsx("button",{type:"button",onClick:()=>{var le;return(le=r.current)==null?void 0:le.click()},disabled:v,className:"w-full px-3 py-2 rounded-lg text-sm font-medium border border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:border-[#CC561E]/50 hover:text-[#CC561E] disabled:opacity-60 transition-colors",children:v?"Reading photo...":"Scan From Photo"})]}),m.jsxs("div",{className:"mt-4 flex gap-2",children:[m.jsx("input",{value:C,onChange:le=>E(le.target.value),placeholder:"Type or paste ISBN",className:"flex-1 border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 text-sm font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),m.jsx("button",{type:"button",onClick:U,disabled:!C.trim(),className:"px-3 py-2 rounded-lg text-sm font-medium bg-[#CC561E] text-white disabled:opacity-50",children:"Use ISBN"})]})]})]})})},nX=()=>{};var W3={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},rX=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[n++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[n++],o=t[n++],s=t[n++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const a=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},S5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,s=o?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,h=a>>2,p=(a&3)<<4|s>>4;let x=(s&15)<<2|d>>6,v=d&63;c||(v=64,o||(x=64)),r.push(n[h],n[p],n[x],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(E5(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):rX(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const a=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,a==null||s==null||d==null||p==null)throw new iX;const x=a<<2|s>>4;if(r.push(x),d!==64){const v=s<<4&240|d>>2;if(r.push(v),p!==64){const b=d<<6&192|p;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class iX extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aX=function(t){const e=E5(t);return S5.encodeByteArray(e,!0)},A5=function(t){return aX(t).replace(/\./g,"")},_5=function(t){try{return S5.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sX=()=>oX().__FIREBASE_DEFAULTS__,lX=()=>{if(typeof process>"u"||typeof W3>"u")return;const t=W3.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cX=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_5(t[1]);return e&&JSON.parse(e)},b2=()=>{try{return nX()||sX()||lX()||cX()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},uX=t=>{var e,n;return(n=(e=b2())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},N5=()=>{var t;return(t=b2())==null?void 0:t.config},k5=t=>{var e;return(e=b2())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dX{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fX(t){return(await fetch(t,{credentials:"include"})).ok}const pd={};function hX(){const t={prod:[],emulator:[]};for(const e of Object.keys(pd))pd[e]?t.emulator.push(e):t.prod.push(e);return t}function pX(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let q3=!1;function mX(t,e){if(typeof window>"u"||typeof document>"u"||!e1(window.location.host)||pd[t]===e||pd[t]||q3)return;pd[t]=e;function n(x){return`__firebase__banner__${x}`}const r="__firebase__banner",a=hX().prod.length>0;function o(){const x=document.getElementById(r);x&&x.remove()}function s(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function c(x,v){x.setAttribute("width","24"),x.setAttribute("id",v),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function d(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{q3=!0,o()},x}function h(x,v){x.setAttribute("id",v),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function p(){const x=pX(r),v=n("text"),b=document.getElementById(v)||document.createElement("span"),C=n("learnmore"),E=document.getElementById(C)||document.createElement("a"),S=n("preprendIcon"),N=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const k=x.element;s(k),h(E,C);const I=d();c(N,S),k.append(N,b,E,I),document.body.appendChild(k)}a?(b.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gX(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vr())}function xX(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vX(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yX(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bX(){const t=Vr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wX(){try{return typeof indexedDB=="object"}catch{return!1}}function CX(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var a;e(((a=i.error)==null?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EX="FirebaseError";class ms extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=EX,Object.setPrototypeOf(this,ms.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yd.prototype.create)}}class Yd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?SX(a,r):"Error",s=`${this.serviceName}: ${o} (${i}).`;return new ms(i,s,r)}}function SX(t,e){return t.replace(AX,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const AX=/\{\$([^}]+)}/g;function _X(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ic(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const a=t[i],o=e[i];if(X3(a)&&X3(o)){if(!Ic(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function X3(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function NX(t,e){const n=new kX(t,e);return n.subscribe.bind(n)}class kX{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");TX(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=px),i.error===void 0&&(i.error=px),i.complete===void 0&&(i.complete=px);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TX(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function px(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(t){return t&&t._delegate?t._delegate:t}class Dc{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OX{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new dX;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DX(e))try{this.getOrInitializeService({instanceIdentifier:Hs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Hs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Hs){return this.instances.has(e)}getOptions(e=Hs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,o]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(a);r===s&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:IX(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Hs){return this.component?this.component.multipleInstances?e:Hs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IX(t){return t===Hs?void 0:t}function DX(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MX{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OX(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(qt||(qt={}));const RX={debug:qt.DEBUG,verbose:qt.VERBOSE,info:qt.INFO,warn:qt.WARN,error:qt.ERROR,silent:qt.SILENT},LX=qt.INFO,jX={[qt.DEBUG]:"log",[qt.VERBOSE]:"log",[qt.INFO]:"info",[qt.WARN]:"warn",[qt.ERROR]:"error"},PX=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=jX[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class T5{constructor(e){this.name=e,this._logLevel=LX,this._logHandler=PX,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qt.DEBUG,...e),this._logHandler(this,qt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qt.VERBOSE,...e),this._logHandler(this,qt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qt.INFO,...e),this._logHandler(this,qt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qt.WARN,...e),this._logHandler(this,qt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qt.ERROR,...e),this._logHandler(this,qt.ERROR,...e)}}const BX=(t,e)=>e.some(n=>t instanceof n);let K3,Y3;function FX(){return K3||(K3=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zX(){return Y3||(Y3=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const O5=new WeakMap,Yv=new WeakMap,I5=new WeakMap,mx=new WeakMap,w2=new WeakMap;function UX(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{n(as(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&O5.set(n,t)}).catch(()=>{}),w2.set(e,t),e}function HX(t){if(Yv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});Yv.set(t,e)}let Zv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Yv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||I5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return as(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function VX(t){Zv=t(Zv)}function $X(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gx(this),e,...n);return I5.set(r,e.sort?e.sort():[e]),as(r)}:zX().includes(t)?function(...e){return t.apply(gx(this),e),as(O5.get(this))}:function(...e){return as(t.apply(gx(this),e))}}function GX(t){return typeof t=="function"?$X(t):(t instanceof IDBTransaction&&HX(t),BX(t,FX())?new Proxy(t,Zv):t)}function as(t){if(t instanceof IDBRequest)return UX(t);if(mx.has(t))return mx.get(t);const e=GX(t);return e!==t&&(mx.set(t,e),w2.set(e,t)),e}const gx=t=>w2.get(t);function WX(t,e,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),s=as(o);return r&&o.addEventListener("upgradeneeded",c=>{r(as(o.result),c.oldVersion,c.newVersion,as(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),s.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),s}const qX=["get","getKey","getAll","getAllKeys","count"],XX=["put","add","delete","clear"],xx=new Map;function Z3(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xx.get(e))return xx.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=XX.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qX.includes(n)))return;const a=async function(o,...s){const c=this.transaction(o,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(s.shift())),(await Promise.all([d[n](...s),i&&c.done]))[0]};return xx.set(e,a),a}VX(t=>({...t,get:(e,n,r)=>Z3(e,n)||t.get(e,n,r),has:(e,n)=>!!Z3(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KX{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(YX(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function YX(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Jv="@firebase/app",J3="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new T5("@firebase/app"),ZX="@firebase/app-compat",JX="@firebase/analytics-compat",QX="@firebase/analytics",eK="@firebase/app-check-compat",tK="@firebase/app-check",nK="@firebase/auth",rK="@firebase/auth-compat",iK="@firebase/database",aK="@firebase/data-connect",oK="@firebase/database-compat",sK="@firebase/functions",lK="@firebase/functions-compat",cK="@firebase/installations",uK="@firebase/installations-compat",dK="@firebase/messaging",fK="@firebase/messaging-compat",hK="@firebase/performance",pK="@firebase/performance-compat",mK="@firebase/remote-config",gK="@firebase/remote-config-compat",xK="@firebase/storage",vK="@firebase/storage-compat",yK="@firebase/firestore",bK="@firebase/ai",wK="@firebase/firestore-compat",CK="firebase",EK="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv="[DEFAULT]",SK={[Jv]:"fire-core",[ZX]:"fire-core-compat",[QX]:"fire-analytics",[JX]:"fire-analytics-compat",[tK]:"fire-app-check",[eK]:"fire-app-check-compat",[nK]:"fire-auth",[rK]:"fire-auth-compat",[iK]:"fire-rtdb",[aK]:"fire-data-connect",[oK]:"fire-rtdb-compat",[sK]:"fire-fn",[lK]:"fire-fn-compat",[cK]:"fire-iid",[uK]:"fire-iid-compat",[dK]:"fire-fcm",[fK]:"fire-fcm-compat",[hK]:"fire-perf",[pK]:"fire-perf-compat",[mK]:"fire-rc",[gK]:"fire-rc-compat",[xK]:"fire-gcs",[vK]:"fire-gcs-compat",[yK]:"fire-fst",[wK]:"fire-fst-compat",[bK]:"fire-vertex","fire-js":"fire-js",[CK]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0=new Map,AK=new Map,ey=new Map;function Q3(t,e){try{t.container.addComponent(e)}catch(n){io.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Rd(t){const e=t.name;if(ey.has(e))return io.debug(`There were multiple attempts to register component ${e}.`),!1;ey.set(e,t);for(const n of f0.values())Q3(n,t);for(const n of AK.values())Q3(n,t);return!0}function D5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ma(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ss=new Yd("app","Firebase",_K);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NK{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ss.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=EK;function M5(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Qv,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ss.create("bad-app-name",{appName:String(i)});if(n||(n=N5()),!n)throw ss.create("no-options");const a=f0.get(i);if(a){if(Ic(n,a.options)&&Ic(r,a.config))return a;throw ss.create("duplicate-app",{appName:i})}const o=new MX(i);for(const c of ey.values())o.addComponent(c);const s=new NK(n,r,o);return f0.set(i,s),s}function kK(t=Qv){const e=f0.get(t);if(!e&&t===Qv&&N5())return M5();if(!e)throw ss.create("no-app",{appName:t});return e}function hc(t,e,n){let r=SK[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),io.warn(o.join(" "));return}Rd(new Dc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TK="firebase-heartbeat-database",OK=1,Ld="firebase-heartbeat-store";let vx=null;function R5(){return vx||(vx=WX(TK,OK,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ld)}catch(n){console.warn(n)}}}}).catch(t=>{throw ss.create("idb-open",{originalErrorMessage:t.message})})),vx}async function IK(t){try{const n=(await R5()).transaction(Ld),r=await n.objectStore(Ld).get(L5(t));return await n.done,r}catch(e){if(e instanceof ms)io.warn(e.message);else{const n=ss.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});io.warn(n.message)}}}async function e_(t,e){try{const r=(await R5()).transaction(Ld,"readwrite");await r.objectStore(Ld).put(e,L5(t)),await r.done}catch(n){if(n instanceof ms)io.warn(n.message);else{const r=ss.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});io.warn(r.message)}}}function L5(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DK=1024,MK=30;class RK{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jK(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=t_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>MK){const o=PK(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){io.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=t_(),{heartbeatsToSend:r,unsentEntries:i}=LK(this._heartbeatsCache.heartbeats),a=A5(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return io.warn(n),""}}}function t_(){return new Date().toISOString().substring(0,10)}function LK(t,e=DK){const n=[];let r=t.slice();for(const i of t){const a=n.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),n_(n)>e){a.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),n_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jK{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wX()?CX().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await IK(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return e_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return e_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function n_(t){return A5(JSON.stringify({version:2,heartbeats:t})).length}function PK(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BK(t){Rd(new Dc("platform-logger",e=>new KX(e),"PRIVATE")),Rd(new Dc("heartbeat",e=>new RK(e),"PRIVATE")),hc(Jv,J3,t),hc(Jv,J3,"esm2020"),hc("fire-js","")}BK("");function j5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FK=j5,P5=new Yd("auth","Firebase",j5());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0=new T5("@firebase/auth");function zK(t,...e){h0.logLevel<=qt.WARN&&h0.warn(`Auth (${Jd}): ${t}`,...e)}function np(t,...e){h0.logLevel<=qt.ERROR&&h0.error(`Auth (${Jd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ca(t,...e){throw E2(t,...e)}function Qi(t,...e){return E2(t,...e)}function C2(t,e,n){const r={...FK(),[e]:n};return new Yd("auth","Firebase",r).create(e,{appName:t.name})}function al(t){return C2(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function UK(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ca(t,"argument-error"),C2(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function E2(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return P5.create(t,...e)}function Je(t,e,...n){if(!t)throw E2(e,...n)}function Za(t){const e="INTERNAL ASSERTION FAILED: "+t;throw np(e),new Error(e)}function ao(t,e){t||Za(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function HK(){return r_()==="http:"||r_()==="https:"}function r_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VK(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HK()||vX()||"connection"in navigator)?navigator.onLine:!0}function $K(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,n){this.shortDelay=e,this.longDelay=n,ao(n>e,"Short delay should be less than long delay!"),this.isMobile=gX()||yX()}get(){return VK()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(t,e){ao(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Za("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Za("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Za("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GK={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WK=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qK=new Qd(3e4,6e4);function A2(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zc(t,e,n,r,i={}){return F5(t,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const s=Zd({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...a};return xX()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&e1(t.emulatorConfig.host)&&(d.credentials="include"),B5.fetch()(await z5(t,t.config.apiHost,n,s),d)})}async function F5(t,e,n){t._canInitEmulator=!1;const r={...GK,...e};try{const i=new KK(t),a=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Bh(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const s=a.ok?o.errorMessage:o.error.message,[c,d]=s.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bh(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Bh(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Bh(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw C2(t,h,d);Ca(t,h)}}catch(i){if(i instanceof ms)throw i;Ca(t,"network-request-failed",{message:String(i)})}}async function XK(t,e,n,r,i={}){const a=await zc(t,e,n,r,i);return"mfaPendingCredential"in a&&Ca(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function z5(t,e,n,r){const i=`${e}${n}?${r}`,a=t,o=a.config.emulator?S2(t.config,i):`${t.config.apiScheme}://${i}`;return WK.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}class KK{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Qi(this.auth,"network-request-failed")),qK.get())})}}function Bh(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Qi(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YK(t,e){return zc(t,"POST","/v1/accounts:delete",e)}async function p0(t,e){return zc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZK(t,e=!1){const n=gs(t),r=await n.getIdToken(e),i=_2(r);Je(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:md(yx(i.auth_time)),issuedAtTime:md(yx(i.iat)),expirationTime:md(yx(i.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function yx(t){return Number(t)*1e3}function _2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return np("JWT malformed, contained fewer than 3 sections"),null;try{const i=_5(n);return i?JSON.parse(i):(np("Failed to decode base64 JWT payload"),null)}catch(i){return np("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function i_(t){const e=_2(t);return Je(e,"internal-error"),Je(typeof e.exp<"u","internal-error"),Je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jd(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ms&&JK(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function JK({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QK{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=md(this.lastLoginAt),this.creationTime=md(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m0(t){var p;const e=t.auth,n=await t.getIdToken(),r=await jd(t,p0(e,{idToken:n}));Je(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const a=(p=i.providerUserInfo)!=null&&p.length?U5(i.providerUserInfo):[],o=tY(t.providerData,a),s=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=s?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ny(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function eY(t){const e=gs(t);await m0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tY(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function U5(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nY(t,e){const n=await F5(t,{},async()=>{const r=Zd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await z5(t,i,"/v1/token",`key=${a}`),s=await t._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:s,body:r};return t.emulatorConfig&&e1(t.emulatorConfig.host)&&(c.credentials="include"),B5.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function rY(t,e){return zc(t,"POST","/v2/accounts:revokeToken",A2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Je(e.idToken,"internal-error"),Je(typeof e.idToken<"u","internal-error"),Je(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):i_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Je(e.length!==0,"internal-error");const n=i_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:a}=await nY(e,n);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new pc;return r&&(Je(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Je(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(Je(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new pc,this.toJSON())}_performRefresh(){return Za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(t,e){Je(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zi{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new QK(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ny(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await jd(this,this.stsTokenManager.getToken(this.auth,e));return Je(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return ZK(this,e)}reload(){return eY(this)}_assign(e){this!==e&&(Je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Zi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await m0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ma(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await jd(this,YK(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,s=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:x,isAnonymous:v,providerData:b,stsTokenManager:C}=n;Je(p&&C,e,"internal-error");const E=pc.fromJSON(this.name,C);Je(typeof p=="string",e,"internal-error"),jo(r,e.name),jo(i,e.name),Je(typeof x=="boolean",e,"internal-error"),Je(typeof v=="boolean",e,"internal-error"),jo(a,e.name),jo(o,e.name),jo(s,e.name),jo(c,e.name),jo(d,e.name),jo(h,e.name);const S=new Zi({uid:p,auth:e,email:i,emailVerified:x,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:a,tenantId:s,stsTokenManager:E,createdAt:d,lastLoginAt:h});return b&&Array.isArray(b)&&(S.providerData=b.map(N=>({...N}))),c&&(S._redirectEventId=c),S}static async _fromIdTokenResponse(e,n,r=!1){const i=new pc;i.updateFromServerResponse(n);const a=new Zi({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await m0(a),a}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Je(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?U5(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),s=new pc;s.updateFromIdToken(r);const c=new Zi({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ny(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=new Map;function Ja(t){ao(t instanceof Function,"Expected a class definition");let e=a_.get(t);return e?(ao(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,a_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}H5.type="NONE";const o_=H5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(t,e,n){return`firebase:${t}:${e}:${n}`}class mc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=rp(this.userKey,i.apiKey,a),this.fullPersistenceKey=rp("persistence",i.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await p0(this.auth,{idToken:e}).catch(()=>{});return n?Zi._fromGetAccountInfoResponse(this.auth,n,e):null}return Zi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new mc(Ja(o_),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Ja(o_);const o=rp(r,e.config.apiKey,e.name);let s=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const x=await p0(e,{idToken:h}).catch(()=>{});if(!x)break;p=await Zi._fromGetAccountInfoResponse(e,x,h)}else p=Zi._fromJSON(e,h);d!==a&&(s=p),a=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new mc(a,e,r):(a=c[0],s&&await a._set(o,s.toJSON()),await Promise.all(n.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new mc(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(W5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(V5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X5(e))return"Blackberry";if(K5(e))return"Webos";if($5(e))return"Safari";if((e.includes("chrome/")||G5(e))&&!e.includes("edge/"))return"Chrome";if(q5(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function V5(t=Vr()){return/firefox\//i.test(t)}function $5(t=Vr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function G5(t=Vr()){return/crios\//i.test(t)}function W5(t=Vr()){return/iemobile/i.test(t)}function q5(t=Vr()){return/android/i.test(t)}function X5(t=Vr()){return/blackberry/i.test(t)}function K5(t=Vr()){return/webos/i.test(t)}function N2(t=Vr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iY(t=Vr()){var e;return N2(t)&&!!((e=window.navigator)!=null&&e.standalone)}function aY(){return bX()&&document.documentMode===10}function Y5(t=Vr()){return N2(t)||q5(t)||K5(t)||X5(t)||/windows phone/i.test(t)||W5(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(t,e=[]){let n;switch(t){case"Browser":n=s_(Vr());break;case"Worker":n=`${s_(Vr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Jd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((o,s)=>{try{const c=e(a);o(c)}catch(c){s(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sY(t,e={}){return zc(t,"GET","/v2/passwordPolicy",A2(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lY=6;class cY{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??lY,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uY{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l_(this),this.idTokenSubscription=new l_(this),this.beforeStateQueue=new oY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=P5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ja(n)),this._initializationPromise=this.queue(async()=>{var r,i,a;if(!this._deleted&&(this.persistenceManager=await mc.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await p0(this,{idToken:e}),r=await Zi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(ma(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(a=this.redirectUser)==null?void 0:a._redirectEventId,s=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===s)&&(c!=null&&c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await m0(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$K()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ma(this.app))return Promise.reject(al(this));const n=e?gs(e):null;return n&&Je(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ma(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ma(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ja(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sY(this),n=new cY(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await rY(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ja(e)||this._popupRedirectResolver;Je(n,this,"argument-error"),this.redirectPersistenceManager=await mc.create(this,[Ja(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Je(s,this,"internal-error"),s.then(()=>{o||a(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Z5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(ma(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&zK(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ef(t){return gs(t)}class l_{constructor(e){this.auth=e,this.observer=null,this.addObserver=NX(n=>this.observer=n)}get next(){return Je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dY(t){k2=t}function fY(t){return k2.loadJS(t)}function hY(){return k2.gapiScript}function pY(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mY(t,e){const n=D5(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),a=n.getOptions();if(Ic(a,e??{}))return i;Ca(i,"already-initialized")}return n.initialize({options:e})}function gY(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ja);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xY(t,e,n){const r=ef(t);Je(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=J5(e),{host:o,port:s}=vY(e),c=s===null?"":`:${s}`,d={url:`${a}//${o}${c}/`},h=Object.freeze({host:o,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Je(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Je(Ic(d,r.config.emulator)&&Ic(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,e1(o)?(fX(`${a}//${o}${c}`),mX("Auth",!0)):yY()}function J5(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vY(t){const e=J5(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:c_(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:c_(o)}}}function c_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function yY(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Za("not implemented")}_getIdTokenResponse(e){return Za("not implemented")}_linkToIdToken(e,n){return Za("not implemented")}_getReauthenticationResolver(e){return Za("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gc(t,e){return XK(t,"POST","/v1/accounts:signInWithIdp",A2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bY="http://localhost";class pl extends Q5{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new pl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ca("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=n;if(!r||!i)return null;const o=new pl(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return gc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,gc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,gc(e,n)}buildRequest(){const e={requestUri:bY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Zd(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends T2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends tf{constructor(){super("facebook.com")}static credential(e){return pl._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wo.credential(e.oauthAccessToken)}catch{return null}}}Wo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa extends tf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return pl._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Xa.credential(n,r)}catch{return null}}}Xa.GOOGLE_SIGN_IN_METHOD="google.com";Xa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends tf{constructor(){super("github.com")}static credential(e){return pl._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qo.credential(e.oauthAccessToken)}catch{return null}}}qo.GITHUB_SIGN_IN_METHOD="github.com";qo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo extends tf{constructor(){super("twitter.com")}static credential(e,n){return pl._fromParams({providerId:Xo.PROVIDER_ID,signInMethod:Xo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Xo.credentialFromTaggedObject(e)}static credentialFromError(e){return Xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Xo.credential(n,r)}catch{return null}}}Xo.TWITTER_SIGN_IN_METHOD="twitter.com";Xo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const a=await Zi._fromIdTokenResponse(e,r,i),o=u_(r);return new Mc({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=u_(r);return new Mc({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function u_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0 extends ms{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,g0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new g0(e,n,r,i)}}function eT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?g0._fromErrorAndOperation(t,a,e,r):a})}async function wY(t,e,n=!1){const r=await jd(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Mc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CY(t,e,n=!1){const{auth:r}=t;if(ma(r.app))return Promise.reject(al(r));const i="reauthenticate";try{const a=await jd(t,eT(r,i,e,t),n);Je(a.idToken,r,"internal-error");const o=_2(a.idToken);Je(o,r,"internal-error");const{sub:s}=o;return Je(t.uid===s,r,"user-mismatch"),Mc._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ca(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EY(t,e,n=!1){if(ma(t.app))return Promise.reject(al(t));const r="signIn",i=await eT(t,r,e),a=await Mc._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(a.user),a}function SY(t,e,n,r){return gs(t).onIdTokenChanged(e,n,r)}function AY(t,e,n){return gs(t).beforeAuthStateChanged(e,n)}function _Y(t,e,n,r){return gs(t).onAuthStateChanged(e,n,r)}function NY(t){return gs(t).signOut()}const x0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(x0,"1"),this.storage.removeItem(x0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kY=1e3,TY=10;class nT extends tT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Y5(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,s,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);aY()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,TY):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},kY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nT.type="LOCAL";const OY=nT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT extends tT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}rT.type="SESSION";const iT=rT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IY(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new t1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:a}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const s=Array.from(o).map(async d=>d(n.origin,a)),c=await IY(s);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((s,c)=>{const d=O2("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const x=p;if(x.data.eventId===d)switch(x.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),s(x.data.response);break;default:clearTimeout(h),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(){return window}function MY(t){va().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(){return typeof va().WorkerGlobalScope<"u"&&typeof va().importScripts=="function"}async function RY(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LY(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function jY(){return aT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="firebaseLocalStorageDb",PY=1,v0="firebaseLocalStorage",sT="fbase_key";class nf{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function n1(t,e){return t.transaction([v0],e?"readwrite":"readonly").objectStore(v0)}function BY(){const t=indexedDB.deleteDatabase(oT);return new nf(t).toPromise()}function ry(){const t=indexedDB.open(oT,PY);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(v0,{keyPath:sT})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(v0)?e(r):(r.close(),await BY(),e(await ry()))})})}async function d_(t,e,n){const r=n1(t,!0).put({[sT]:e,value:n});return new nf(r).toPromise()}async function FY(t,e){const n=n1(t,!1).get(e),r=await new nf(n).toPromise();return r===void 0?null:r.value}function f_(t,e){const n=n1(t,!0).delete(e);return new nf(n).toPromise()}const zY=800,UY=3;class lT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ry(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>UY)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return aT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=t1._getInstance(jY()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await RY(),!this.activeServiceWorker)return;this.sender=new DY(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LY()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ry();return await d_(e,x0,"1"),await f_(e,x0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>d_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>FY(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>f_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=n1(i,!1).getAll();return new nf(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lT.type="LOCAL";const HY=lT;new Qd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(t,e){return e?Ja(e):(Je(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2 extends Q5{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return gc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return gc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function VY(t){return EY(t.auth,new I2(t),t.bypassAuthState)}function $Y(t){const{auth:e,user:n}=t;return Je(n,e,"internal-error"),CY(n,new I2(t),t.bypassAuthState)}async function GY(t){const{auth:e,user:n}=t;return Je(n,e,"internal-error"),wY(n,new I2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,n,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:a,error:o,type:s}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VY;case"linkViaPopup":case"linkViaRedirect":return GY;case"reauthViaPopup":case"reauthViaRedirect":return $Y;default:Ca(this.auth,"internal-error")}}resolve(e){ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ao(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WY=new Qd(2e3,1e4);async function qY(t,e,n){if(ma(t.app))return Promise.reject(Qi(t,"operation-not-supported-in-this-environment"));const r=ef(t);UK(t,e,T2);const i=cT(r,n);return new Ys(r,"signInViaPopup",e,i).executeNotNull()}class Ys extends uT{constructor(e,n,r,i,a){super(e,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Ys.currentPopupAction&&Ys.currentPopupAction.cancel(),Ys.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Je(e,this.auth,"internal-error"),e}async onExecution(){ao(this.filter.length===1,"Popup operations only handle one event");const e=O2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Qi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ys.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,WY.get())};e()}}Ys.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XY="pendingRedirect",ip=new Map;class KY extends uT{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ip.get(this.auth._key());if(!e){try{const r=await YY(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ip.set(this.auth._key(),e)}return this.bypassAuthState||ip.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function YY(t,e){const n=QY(e),r=JY(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function ZY(t,e){ip.set(t._key(),e)}function JY(t){return Ja(t._redirectPersistence)}function QY(t){return rp(XY,t.config.apiKey,t.name)}async function eZ(t,e){return await ef(t)._initializationPromise,dT(t,e,!1)}async function dT(t,e,n=!1){if(ma(t.app))return Promise.reject(al(t));const r=ef(t),i=cT(r,e),o=await new KY(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tZ=600*1e3;class nZ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rZ(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!fT(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Qi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tZ&&this.cachedEventUids.clear(),this.cachedEventUids.has(h_(e))}saveEventToCache(e){this.cachedEventUids.add(h_(e)),this.lastProcessedEventTime=Date.now()}}function h_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rZ(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iZ(t,e={}){return zc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aZ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oZ=/^https?/;async function sZ(t){if(t.config.emulator)return;const{authorizedDomains:e}=await iZ(t);for(const n of e)try{if(lZ(n))return}catch{}Ca(t,"unauthorized-domain")}function lZ(t){const e=ty(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!oZ.test(n))return!1;if(aZ.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cZ=new Qd(3e4,6e4);function p_(){const t=va().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function uZ(t){return new Promise((e,n)=>{var i,a,o;function r(){p_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{p_(),n(Qi(t,"network-request-failed"))},timeout:cZ.get()})}if((a=(i=va().gapi)==null?void 0:i.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((o=va().gapi)!=null&&o.load)r();else{const s=pY("iframefcb");return va()[s]=()=>{gapi.load?r():n(Qi(t,"network-request-failed"))},fY(`${hY()}?onload=${s}`).catch(c=>n(c))}}).catch(e=>{throw ap=null,e})}let ap=null;function dZ(t){return ap=ap||uZ(t),ap}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fZ=new Qd(5e3,15e3),hZ="__/auth/iframe",pZ="emulator/auth/iframe",mZ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gZ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xZ(t){const e=t.config;Je(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?S2(e,pZ):`https://${t.config.authDomain}/${hZ}`,r={apiKey:e.apiKey,appName:t.name,v:Jd},i=gZ.get(t.config.apiHost);i&&(r.eid=i);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${Zd(r).slice(1)}`}async function vZ(t){const e=await dZ(t),n=va().gapi;return Je(n,t,"internal-error"),e.open({where:document.body,url:xZ(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mZ,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Qi(t,"network-request-failed"),s=va().setTimeout(()=>{a(o)},fZ.get());function c(){va().clearTimeout(s),i(r)}r.ping(c).then(c,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yZ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bZ=500,wZ=600,CZ="_blank",EZ="http://localhost";class m_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SZ(t,e,n,r=bZ,i=wZ){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const c={...yZ,width:r.toString(),height:i.toString(),top:a,left:o},d=Vr().toLowerCase();n&&(s=G5(d)?CZ:n),V5(d)&&(e=e||EZ,c.scrollbars="yes");const h=Object.entries(c).reduce((x,[v,b])=>`${x}${v}=${b},`,"");if(iY(d)&&s!=="_self")return AZ(e||"",s),new m_(null);const p=window.open(e||"",s,h);Je(p,t,"popup-blocked");try{p.focus()}catch{}return new m_(p)}function AZ(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Z="__/auth/handler",NZ="emulator/auth/handler",kZ=encodeURIComponent("fac");async function g_(t,e,n,r,i,a){Je(t.config.authDomain,t,"auth-domain-config-required"),Je(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Jd,eventId:i};if(e instanceof T2){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",_X(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof tf){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const s=o;for(const h of Object.keys(s))s[h]===void 0&&delete s[h];const c=await t._getAppCheckToken(),d=c?`#${kZ}=${encodeURIComponent(c)}`:"";return`${TZ(t)}?${Zd(s).slice(1)}${d}`}function TZ({config:t}){return t.emulator?S2(t,NZ):`https://${t.authDomain}/${_Z}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="webStorageSupport";class OZ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iT,this._completeRedirectFn=dT,this._overrideRedirectResult=ZY}async _openPopup(e,n,r,i){var o;ao((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await g_(e,n,r,ty(),i);return SZ(e,a,O2())}async _openRedirect(e,n,r,i){await this._originValidation(e);const a=await g_(e,n,r,ty(),i);return MY(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:a}=this.eventManagers[n];return i?Promise.resolve(i):(ao(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await vZ(e),r=new nZ(e);return n.register("authEvent",i=>(Je(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bx,{type:bx},i=>{var o;const a=(o=i==null?void 0:i[0])==null?void 0:o[bx];a!==void 0&&n(!!a),Ca(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=sZ(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Y5()||$5()||N2()}}const IZ=OZ;var x_="@firebase/auth",v_="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DZ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MZ(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RZ(t){Rd(new Dc("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=r.options;Je(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:s,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Z5(t)},d=new uY(r,i,a,c);return gY(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Rd(new Dc("auth-internal",e=>{const n=ef(e.getProvider("auth").getImmediate());return(r=>new DZ(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),hc(x_,v_,MZ(t)),hc(x_,v_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LZ=300,jZ=k5("authIdTokenMaxAge")||LZ;let y_=null;const PZ=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>jZ)return;const i=n==null?void 0:n.token;y_!==i&&(y_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function D2(t=kK()){const e=D5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=mY(t,{popupRedirectResolver:IZ,persistence:[HY,OY,iT]}),r=k5("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=PZ(a.toString());AY(n,o,()=>o(n.currentUser)),SY(n,s=>o(s))}}const i=uX("auth");return i&&xY(n,`http://${i}`),n}function BZ(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}dY({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const a=Qi("internal-error");a.customData=i,n(a)},r.type="text/javascript",r.charset="UTF-8",BZ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RZ("Browser");const Uc=async()=>{const e=D2().currentUser;return e?await e.getIdToken():""},y0=t=>{const e=(t||"").toLowerCase().trim();if(e==="tr"||e==="turkish"||e==="turkce"||e==="trke")return"tr";if(e==="en"||e==="english"||e==="ingilizce")return"en"},r1=t=>({title:t.title,author:t.author,publisher:t.publisher,isbn:t.isbn,translator:t.translator,tags:t.tags,summary:t.summaryText||t.generalNotes||t.summary||"",publishedDate:t.publicationYear?String(t.publicationYear):t.publishedDate||"",url:t.url,coverUrl:t.coverUrl??null,pageCount:t.pageCount||void 0,contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved,sourceLanguageHint:y0(t.sourceLanguageHint)}),i1=(t,e)=>{const n=(e.content_language_resolved||e.contentLanguageResolved||"").toString().toLowerCase(),r=n==="tr"||n==="en"?n:t.contentLanguageResolved,i=Number(e.language_decision_confidence??e.languageDecisionConfidence??t.languageDecisionConfidence??NaN),a=Number.isFinite(i)?i:t.languageDecisionConfidence;return{...t,summaryText:e.summary&&e.summary.trim().length>0?e.summary:t.summaryText,tags:e.tags&&e.tags.length>0?e.tags:t.tags,publisher:e.publisher||t.publisher,isbn:t.isbn,author:e.author||t.author,translator:e.translator||t.translator,publicationYear:e.publishedDate?String(Number(e.publishedDate)||t.publicationYear||""):t.publicationYear,coverUrl:e.coverUrl??t.coverUrl,pageCount:e.pageCount||t.pageCount||void 0,contentLanguageMode:e.contentLanguageMode||t.contentLanguageMode||"AUTO",contentLanguageResolved:r,sourceLanguageHint:y0(e.sourceLanguageHint||t.sourceLanguageHint),languageDecisionReason:e.language_decision_reason||e.languageDecisionReason||t.languageDecisionReason,languageDecisionConfidence:a}},FZ=async t=>{if(!t.trim())return[];const e=[];try{const n=`https://api.crossref.org/works?query=${encodeURIComponent(t)}&rows=5&select=title,author,publisher,published,DOI,abstract,URL`,i=await fetch(n).then(a=>a.ok?a.json():null).then(a=>{var o;return(o=a==null?void 0:a.message)!=null&&o.items?a.message.items.map(s=>{var c,d,h,p,x,v,b,C,E;return{title:Array.isArray(s.title)?s.title[0]:s.title||"",author:(d=(c=s.author)==null?void 0:c[0])!=null&&d.family?`${s.author[0].given||""} ${s.author[0].family}`.trim():((p=(h=s.author)==null?void 0:h[0])==null?void 0:p.name)||"Unknown",publisher:s.publisher||((x=s["container-title"])==null?void 0:x[0])||"",isbn:"",translator:"",tags:s.subject||[],summary:s.abstract||`DOI: ${s.DOI||""}`,publishedDate:((E=(C=(b=(v=s.published)==null?void 0:v["date-parts"])==null?void 0:b[0])==null?void 0:C[0])==null?void 0:E.toString())||"",url:s.URL||(s.DOI?`https://doi.org/${s.DOI}`:""),coverUrl:null}}):[]}).catch(()=>[]);return e.push(...i),e}catch(n){return console.error("Article search error:",n),[]}},iy=async(t,e)=>{const n=t.trim();if(!n)return[];if(e==="BOOK"){const{searchBooks:r}=await ol(async()=>{const{searchBooks:a}=await import("./bookSearchService-CElDoF7Q.js");return{searchBooks:a}},[]),i=await r(n);if(i.results.length>0)return console.log(` Results from bookSearchService (${i.source}, cached: ${i.cached})`),i.results}if(e==="ARTICLE"){const r=await FZ(n);if(r.length>0)return console.log(" Results from CrossRef (fast)"),r}try{const r=await Uc(),i=await fetch(`${ct}/api/ai/search-resources`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({query:n,type:e})});if(!i.ok){const o=await i.json();throw new Error(o.detail||"Search failed")}return(await i.json()).results.map(o=>({...o,isbn:"",coverUrl:null,sourceLanguageHint:y0(o.sourceLanguageHint||o.source_language_hint),contentLanguageResolved:y0(o.contentLanguageResolved||o.content_language_resolved)}))}catch(r){return console.error("Error searching with Gemini (Backend):",r),[]}},hT=async t=>{if(t.length===0)return null;try{const e=await Uc(),n=await fetch(`${ct}/api/ai/analyze-highlights`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({highlights:t})});return n.ok&&(await n.json()).summary||null}catch(e){return console.error("Gemini error (Backend):",e),null}},M2=async t=>{if(!t)return[];try{const e=await Uc(),n=await fetch(`${ct}/api/ai/generate-tags`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({note_content:t})});return n.ok?(await n.json()).tags||[]:[]}catch(e){return console.error("Gemini tag generation error (Backend):",e),[]}},wx=async(t,e)=>{var o,s;const n=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${t}&maxResults=1`,{signal:e});if(!n.ok)throw new Error(`Google Books Error: ${n.status}`);const i=(o=(await n.json()).items)==null?void 0:o[0],a=(s=i==null?void 0:i.volumeInfo)==null?void 0:s.imageLinks;if(a!=null&&a.thumbnail||a!=null&&a.smallThumbnail){let c=a.thumbnail||a.smallThumbnail;return c=c.replace(/^http:\/\//i,"https://").replace("&edge=curl",""),c}throw new Error("No cover in Google Books result")},zZ=async(t,e,n,r)=>{var s;if(n){const d=`https://covers.openlibrary.org/b/isbn/${n.replace(/[^0-9X]/gi,"")}-L.jpg`;if((await fetch(d,{method:"HEAD",signal:r})).ok)return console.log(" Cover found via OpenLibrary ISBN"),d}const i=e?`${t} ${e}`:t,a=`https://openlibrary.org/search.json?q=${encodeURIComponent(i)}&limit=1`,o=await fetch(a,{signal:r});if(o.ok){const d=(s=(await o.json()).docs)==null?void 0:s[0];if(d!=null&&d.cover_i){const h=`https://covers.openlibrary.org/b/id/${d.cover_i}-L.jpg`;return console.log(" Cover found via OpenLibrary search"),h}}throw new Error("No cover found in OpenLibrary")},UZ=async(t,e,n)=>{try{const r=await Uc(),i=new AbortController,a=setTimeout(()=>i.abort(),3e4),o=await fetch(`${ct}/api/ai/verify-cover`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({title:t,author:e,isbn:n}),signal:i.signal});return clearTimeout(a),o.ok&&(await o.json()).url||null}catch(r){return r.name==="AbortError"?console.warn("AI Cover Verification timed out"):console.error("AI cover verification error (Backend):",r),null}},HZ=async(t,e,n)=>{const r=n?n.replace(/[^0-9X]/gi,""):"",i=new AbortController,a=i.signal,o=[];if(r&&o.push(wx(`isbn:${r}`,a)),t&&e){const s=`intitle:${encodeURIComponent(t)}+inauthor:${encodeURIComponent(e)}`;o.push(wx(s,a))}o.push(zZ(t,e,r,a)),t&&!e&&o.push(wx(`intitle:${encodeURIComponent(t)}`,a));try{const s=await Promise.any(o);return i.abort(),s}catch{console.warn("Fast cover fetch failed (all sources). Falling back to AI...");const c=await UZ(t,e,n);if(c)return console.log(" Cover found via AI verification"),c}return console.log(" No verified cover found"),null},R2=async(t,e)=>{if(!((e==null?void 0:e.forceRegenerate)||pT(t)))return t;try{const r=await Uc(),i={...t,content_language_mode:t.contentLanguageMode||"AUTO",source_language_hint:t.sourceLanguageHint||void 0,force_regenerate:!!(e!=null&&e.forceRegenerate)},a=await fetch(`${ct}/api/ai/enrich-book`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)});if(!a.ok){const s=await a.text();return console.error(`Enrichment failed with status ${a.status}: ${s}`),t}return await a.json()}catch(r){return console.error("Enrich error (Backend):",r),t}},pT=t=>{const e=!t.summary||t.summary.trim().length<40,n=!t.tags||t.tags.length<2,r=(t.contentLanguageMode||"AUTO").toUpperCase(),i=(t.contentLanguageResolved||"").toLowerCase(),a=r==="TR"&&i!=="tr"||r==="EN"&&i!=="en"||!!t.sourceLanguageHint&&!i;return e||n||a},mT=async t=>{if(t.length===0)return[];try{const e=await Uc(),n=await fetch(`${ct}/api/ai/enrich-batch`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({books:t})});if(!n.ok||!n.body)return console.error("Batch response failed"),t;const r=n.body.getReader(),i=new TextDecoder,a=[];let o="";for(;;){const{value:s,done:c}=await r.read();if(c)break;const d=i.decode(s,{stream:!0});o+=d;const h=o.split(`
`);o=h.pop()||"";for(const p of h)if(p.trim())try{const x=JSON.parse(p);a.push(x)}catch(x){console.error("Error parsing NDJSON line:",x)}}if(o.trim())try{const s=JSON.parse(o);a.push(s)}catch(s){console.error("Error parsing final buffer:",s)}return a.length>0?a:t}catch(e){return console.error("Batch enrich error (Backend):",e),t}},b_=Object.freeze(Object.defineProperty({__proto__:null,analyzeHighlightsAI:hT,enrichBookWithAI:R2,enrichBooksBatch:mT,fetchBookCover:HZ,generateTagsForNote:M2,libraryItemToDraft:r1,mergeEnrichedDraftIntoItem:i1,needsBookEnrichment:pT,searchResourcesAI:iy},Symbol.toStringTag,{value:"Module"}));var VZ="firebase",$Z="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hc(VZ,$Z,"app");const GZ={apiKey:"AIzaSyDwvjdmQGhwIgAKgaVmOkOnFdMgzaJ4heA",authDomain:"tomehub.firebaseapp.com",projectId:"tomehub",storageBucket:"tomehub.firebasestorage.app",messagingSenderId:"407093539608",appId:"1:407093539608:web:dfd1e04346b49060d2246d"},WZ=M5(GZ),Ju=D2(WZ),gT=new Xa,xT=Object.freeze(Object.defineProperty({__proto__:null,auth:Ju,googleProvider:gT},Symbol.toStringTag,{value:"Module"})),vT=A.createContext(void 0),qZ=({children:t})=>{const[e,n]=A.useState(null),[r,i]=A.useState(!0);A.useEffect(()=>{eZ(Ju).then(d=>{d&&console.log("Successfully signed in with redirect")}).catch(d=>{console.error("Redirect login error:",d)});const c=_Y(Ju,d=>{n(d),i(!1)});return()=>c()},[]);const s={user:e,loading:r,loginWithGoogle:async()=>{try{await qY(Ju,gT)}catch(c){console.error("Login with Google failed:",c),c.code==="auth/popup-blocked"?alert("Giri penceresi engellendi. Ltfen Safari veya Chrome gibi bir taraycda an veya pop-uplara izin verin."):c.code==="auth/cancelled-popup-request"||alert("Giri hatas: "+(c.message||"Bilinmeyen bir hata olutu."))}},logout:async()=>{await NY(Ju)}};return m.jsx(vT.Provider,{value:s,children:t})},a1=()=>{const t=A.useContext(vT);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},XZ=({initialData:t,initialType:e,noteDefaults:n,onSave:r,onCancel:i})=>{const[a,o]=A.useState(t||e==="WEBSITE"||e==="PERSONAL_NOTE"?"edit":"search"),[s,c]=A.useState(""),[d,h]=A.useState([]),[p,x]=A.useState(!1),[v,b]=A.useState(!1),[C,E]=A.useState(!1),[S,N]=A.useState(!1),[k,I]=A.useState(!1),[D,L]=A.useState(!1),[O,j]=A.useState(null),[U,fe]=A.useState(!1),{user:le}=a1(),[q,de]=A.useState({title:"",author:"",translator:"",publisher:"",publicationYear:"",isbn:"",url:"",code:"",status:"On Shelf",readingStatus:"To Read",tags:"",generalNotes:"",summaryText:"",coverUrl:"",lentToName:"",lentDate:"",addedAt:new Date().toISOString().split("T")[0],pageCount:"",contentLanguageMode:"AUTO",contentLanguageResolved:"",sourceLanguageHint:"",personalNoteCategory:"DAILY",personalFolderId:"",folderPath:""});A.useEffect(()=>{var z,ae,ce;t?de({title:t.title,author:t.author,translator:t.translator||"",publisher:t.publisher||"",publicationYear:t.publicationYear||"",isbn:t.isbn||"",url:t.url||"",code:t.code||"",status:t.status,readingStatus:t.readingStatus,tags:t.tags.join(", "),generalNotes:t.generalNotes||"",summaryText:t.summaryText||"",coverUrl:t.coverUrl||"",lentToName:((z=t.lentInfo)==null?void 0:z.borrowerName)||"",lentDate:((ae=t.lentInfo)==null?void 0:ae.lentDate)||"",addedAt:new Date(t.addedAt).toISOString().split("T")[0],pageCount:((ce=t.pageCount)==null?void 0:ce.toString())||"",contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved||"",sourceLanguageHint:t.sourceLanguageHint||"",personalNoteCategory:t.personalNoteCategory||"DAILY",personalFolderId:t.personalFolderId||"",folderPath:t.folderPath||""}):e==="PERSONAL_NOTE"&&de(Te=>({...Te,author:"Self",status:"On Shelf",readingStatus:"Finished",personalNoteCategory:(n==null?void 0:n.personalNoteCategory)||"DAILY",personalFolderId:(n==null?void 0:n.personalFolderId)||"",folderPath:(n==null?void 0:n.folderPath)||""}))},[t,e,n]);const ge=async z=>{if(z.preventDefault(),!!s.trim()){x(!0),h([]);try{const ae=await iy(s,e);h(ae),e==="BOOK"&&console.log(` Search completed for book: "${s}"`)}catch(ae){console.error("Search failed:",ae)}finally{x(!1)}}},xe=async()=>{const z=Cc(q.generalNotes);if(!z)return;N(!0);const ae=await M2(z);ae.length>0&&de(ce=>({...ce,tags:ae.join(", ")})),N(!1)},H=async(z,ae,ce)=>{b(!0);try{const{fetchBookCover:Te}=await ol(async()=>{const{fetchBookCover:ot}=await Promise.resolve().then(()=>b_);return{fetchBookCover:ot}},void 0),Le=await Te(z,ae,ce);Le&&de(ot=>({...ot,coverUrl:Le}))}catch(Te){console.error("Cover fetch failed:",Te)}finally{b(!1)}},ie=async(z,ae=!1)=>{E(!0);try{const{enrichBookWithAI:ce}=await ol(async()=>{const{enrichBookWithAI:Le}=await Promise.resolve().then(()=>b_);return{enrichBookWithAI:Le}},void 0),Te=await ce({...z,contentLanguageMode:q.contentLanguageMode,sourceLanguageHint:q.sourceLanguageHint||z.sourceLanguageHint},{forceRegenerate:ae});de(Le=>({...Le,tags:Te.tags&&Te.tags.length>0?Te.tags.join(", "):Le.tags,summaryText:Te.summary&&Te.summary.length>0?Te.summary:Le.summaryText,publisher:Te.publisher||Le.publisher,publicationYear:Te.publishedDate?String(Te.publishedDate):Le.publicationYear,isbn:Le.isbn,pageCount:Te.pageCount?String(Te.pageCount):Le.pageCount,translator:Te.translator||Le.translator,contentLanguageResolved:Te.content_language_resolved||Te.contentLanguageResolved||Le.contentLanguageResolved||""}))}catch(ce){console.error("Enrichment failed",ce)}finally{E(!1)}},K=async z=>{de(ae=>{var ce;return{...ae,title:z.title,author:z.author,publisher:z.publisher||"",isbn:z.isbn||"",publicationYear:z.publishedDate||"",translator:z.translator||"",tags:z.tags?z.tags.join(", "):"",summaryText:z.summary||"",coverUrl:z.coverUrl||"",url:(e==="WEBSITE"||e==="ARTICLE")&&z.url||"",pageCount:((ce=z.pageCount)==null?void 0:ce.toString())||"",contentLanguageMode:z.contentLanguageMode||q.contentLanguageMode||"AUTO",contentLanguageResolved:(z.contentLanguageResolved||"").toLowerCase()==="tr"?"tr":(z.contentLanguageResolved||"").toLowerCase()==="en"?"en":"",sourceLanguageHint:(z.sourceLanguageHint||"").toLowerCase()==="tr"?"tr":(z.sourceLanguageHint||"").toLowerCase()==="en"?"en":""}}),o("edit"),e==="BOOK"&&(H(z.title,z.author,z.isbn||""),(!z.summary||!z.tags||z.tags.length===0||z.sourceLanguageHint)&&ie(z))},B=z=>{const{name:ae,value:ce}=z.target;de(Te=>ae==="contentLanguageMode"?{...Te,[ae]:ce,contentLanguageResolved:""}:{...Te,[ae]:ce})},G=async z=>{if(z.target.files&&z.target.files[0]){const ae=z.target.files[0];if(ae.type==="application/pdf"){j(ae),L(!0);try{const ce=await Gq(ae);de(Te=>{var Le;return{...Te,title:Te.title||ce.title||"",author:Te.author||ce.author||"",pageCount:Te.pageCount||((Le=ce.page_count)==null?void 0:Le.toString())||""}}),!q.title&&ce.title&&e==="BOOK"&&!q.coverUrl&&H(ce.title,ce.author||"","")}catch(ce){console.error("Failed to extract PDF metadata:",ce)}finally{L(!1)}}else alert("Please select a PDF file"),z.target.value=""}},M=async z=>{z.preventDefault();const ae=t?t.id:Date.now().toString();if(O&&le){I(!0);try{await w5(O,q.title,q.author,le.uid,ae,q.tags)}catch(Le){console.error("PDF Ingestion failed:",Le)}finally{I(!1)}}const ce=e==="BOOK"&&q.status==="Lent Out"&&q.lentToName?{borrowerName:q.lentToName,lentDate:q.lentDate||new Date().toISOString().split("T")[0]}:void 0,Te=q.addedAt?new Date(q.addedAt).getTime():Date.now();r({id:ae,type:e,title:q.title,author:q.author,translator:q.translator,publisher:q.publisher,publicationYear:q.publicationYear,isbn:q.isbn,url:e==="WEBSITE"||e==="ARTICLE"?q.url:"",code:q.code,status:q.status,readingStatus:q.readingStatus,tags:q.tags.split(",").map(Le=>Le.trim()).filter(Le=>Le.length>0),generalNotes:re?q.generalNotes:"",summaryText:re?"":q.summaryText,contentLanguageMode:q.contentLanguageMode,contentLanguageResolved:q.contentLanguageResolved||void 0,sourceLanguageHint:q.sourceLanguageHint||void 0,personalNoteCategory:re?q.personalNoteCategory:void 0,personalFolderId:re&&q.personalFolderId.trim()||void 0,folderPath:re&&q.folderPath.trim()||void 0,coverUrl:q.coverUrl,lentInfo:ce,addedAt:Te,pageCount:q.pageCount?parseInt(q.pageCount):void 0})},V=()=>{switch(e){case"ARTICLE":return m.jsx(zd,{className:"text-[#CC561E]",size:24});case"WEBSITE":return m.jsx(N0,{className:"text-[#CC561E]",size:24});case"PERSONAL_NOTE":return m.jsx(lp,{className:"text-[#CC561E]",size:24});default:return m.jsx(dy,{className:"text-[#CC561E]",size:24})}},Z=()=>{if(t)return"Edit Details";switch(e){case"ARTICLE":return"New Article";case"WEBSITE":return"New Website Resource";case"PERSONAL_NOTE":return"New Note";default:return"New Book"}},re=e==="PERSONAL_NOTE",_e=re?"text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300",J=re?"text-slate-800 dark:text-slate-200":"text-slate-700 dark:text-slate-300",we=re?"text-slate-700 dark:text-slate-400":"text-slate-500 dark:text-slate-400";return m.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:m.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full overflow-hidden flex flex-col ${re?"max-w-3xl max-h-[94vh]":"max-w-2xl max-h-[90vh]"}`,children:[m.jsxs("div",{className:`${re?"p-4":"p-5"} border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white dark:bg-slate-900 z-10`,children:[m.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:a==="search"?m.jsxs(m.Fragment,{children:[m.jsx(Ka,{className:"text-[#CC561E]",size:24}),"Find ",e==="ARTICLE"?"Article":"Book"]}):m.jsxs(m.Fragment,{children:[V(),Z()]})}),m.jsx("button",{onClick:i,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:m.jsx(ta,{size:24})})]}),a==="search"&&m.jsxs("div",{className:"p-6 flex flex-col h-full overflow-y-auto",children:[m.jsxs("form",{onSubmit:ge,className:"relative mb-4",children:[m.jsx("input",{autoFocus:!0,type:"text",value:s,onChange:z=>c(z.target.value),placeholder:e==="ARTICLE"?"Enter Title, DOI, Author...":"Enter Title, ISBN, Author...",className:"w-full pl-5 pr-28 py-4 text-lg border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:border-[#CC561E] dark:focus:border-[#CC561E] focus:ring-4 focus:ring-[#CC561E]/10 outline-none transition-all placeholder:text-slate-400 dark:placeholder:text-slate-500 bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),m.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1.5",children:[e==="BOOK"&&m.jsx("button",{type:"button",onClick:()=>fe(!0),className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 p-2 rounded-lg hover:bg-[#CC561E]/10 hover:text-[#CC561E] dark:hover:bg-[#CC561E]/20 dark:hover:text-[#f3a47b] transition-colors",title:"Scan ISBN barcode with camera",children:m.jsx(vc,{size:20})}),m.jsx("button",{type:"submit",disabled:p||!s.trim(),className:"bg-[#CC561E] text-white p-2 rounded-lg hover:bg-[#b34b1a] disabled:opacity-50 disabled:hover:bg-[#CC561E] transition-colors",children:p?m.jsx(kn,{className:"animate-spin",size:20}):m.jsx(Ka,{size:20})})]})]}),U&&m.jsx(G3,{onDetected:z=>{fe(!1),c(z),x(!0),h([]),iy(z,e).then(ae=>h(ae)).catch(ae=>console.error("Barcode search failed:",ae)).finally(()=>x(!1))},onClose:()=>fe(!1)}),m.jsx("div",{className:"space-y-3 flex-1 mt-6",children:d.length>0?m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"Matches Found"}),d.map((z,ae)=>m.jsxs("button",{onClick:()=>K(z),className:"w-full text-left p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 dark:hover:border-[#CC561E]/50 hover:shadow-md hover:bg-[rgba(204,86,30,0.05)] dark:hover:bg-[rgba(204,86,30,0.1)] transition-all group flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:z.title}),m.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:z.author}),m.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-slate-400",children:[z.publisher&&m.jsx("span",{children:z.publisher}),z.publishedDate&&m.jsx("span",{children:z.publishedDate}),z.isbn&&m.jsxs("span",{className:"font-mono tracking-tight",children:["ISBN: ",z.isbn]})]})]}),m.jsx(m4,{className:"text-slate-300 dark:text-slate-600 group-hover:text-[#CC561E]",size:20})]},ae))]}):!p&&s&&m.jsxs("div",{className:"text-center py-10 text-slate-500",children:[m.jsxs("p",{children:['No AI results found matching "',s,'".']}),m.jsx("p",{className:"text-sm mt-2",children:"Try entering details manually."})]})}),m.jsx("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:m.jsxs("button",{onClick:()=>o("edit"),className:"text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] text-sm font-medium flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[m.jsx("span",{children:"Don't see it? Enter details manually"}),m.jsx(SR,{size:16})]})})]}),a==="edit"&&m.jsxs("form",{onSubmit:M,className:`${re?"p-4 md:p-5":"p-6"} overflow-y-auto flex-1`,children:[m.jsxs("div",{className:re?"space-y-3":"space-y-5",children:[m.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${re?"gap-3":"gap-4"}`,children:[m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("label",{className:`block text-sm font-medium mb-1 ${_e}`,children:"Title *"}),m.jsx("input",{required:!0,name:"title",value:q.title,onChange:B,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${re?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:re?"Note Title":e==="WEBSITE"?"Page Title or Site Name":"e.g. The Stranger"})]}),!re&&m.jsxs("div",{className:e==="WEBSITE"?"md:col-span-2":"",children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="WEBSITE"?"Author / Organization":"Author *"}),m.jsx("input",{required:e!=="WEBSITE",name:"author",value:q.author,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Albert Camus"})]}),re&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{children:[m.jsxs("label",{className:`block text-[13px] font-medium mb-1 flex items-center gap-1 ${J}`,children:[m.jsx(xc,{size:14,className:"text-slate-400"}),"Date"]}),m.jsx("input",{type:"date",name:"addedAt",value:q.addedAt,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:`block text-[13px] font-medium mb-1 ${J}`,children:"Category"}),m.jsxs("select",{name:"personalNoteCategory",value:q.personalNoteCategory,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[m.jsx("option",{value:"PRIVATE",children:"Private"}),m.jsx("option",{value:"DAILY",children:"Daily"}),m.jsx("option",{value:"IDEAS",children:"Ideas"})]}),m.jsx("p",{className:`mt-0.5 text-[10px] leading-tight ${we}`,children:"Private/Daily sadece local aramada kalir. Ideas AI aramalara da katilir."})]})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Translator"}),m.jsx("input",{name:"translator",value:q.translator,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Content Language"}),m.jsxs("select",{name:"contentLanguageMode",value:q.contentLanguageMode,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[m.jsx("option",{value:"AUTO",children:"AUTO (Recommended)"}),m.jsx("option",{value:"TR",children:"TR"}),m.jsx("option",{value:"EN",children:"EN"})]}),(q.contentLanguageResolved||q.sourceLanguageHint)&&m.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:["Resolved: ",q.contentLanguageResolved||"-"," | Source Hint: ",q.sourceLanguageHint||"-"]})]})]}),!re&&m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e!=="WEBSITE"&&m.jsxs("div",{className:e==="ARTICLE"?"md:col-span-2":"",children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="ARTICLE"?"Journal / Publisher":"Publisher"}),m.jsx("input",{name:"publisher",value:q.publisher,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ISBN"}),m.jsxs("div",{className:"flex gap-1.5",children:[m.jsx("input",{name:"isbn",value:q.isbn,onChange:B,className:"flex-1 border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),m.jsx("button",{type:"button",onClick:()=>fe(!0),className:"px-2.5 border border-slate-300 dark:border-slate-700 rounded-lg text-slate-500 dark:text-slate-400 hover:text-[#CC561E] hover:border-[#CC561E]/50 dark:hover:text-[#f3a47b] dark:hover:border-[#CC561E]/50 transition-colors",title:"Scan ISBN barcode",children:m.jsx(vc,{size:18})})]}),U&&m.jsx(G3,{onDetected:z=>{fe(!1),de(ae=>({...ae,isbn:z}))},onClose:()=>fe(!1)})]}),e==="ARTICLE"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Year"}),m.jsx("input",{name:"publicationYear",value:q.publicationYear,onChange:B,placeholder:"YYYY",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Page Count"}),m.jsx("input",{type:"number",name:"pageCount",value:q.pageCount,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. 250"})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Shelf Code"}),m.jsx("input",{name:"code",value:q.code,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. A-12"})]})]}),(e==="WEBSITE"||e==="ARTICLE")&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"URL"}),m.jsx("input",{name:"url",value:q.url,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-[#CC561E] dark:text-[#f3a47b] bg-white dark:bg-slate-950",placeholder:"https://..."})]}),re&&m.jsxs("div",{children:[m.jsx("label",{className:`block text-sm font-medium mb-1 ${_e}`,children:"Sub-file (optional)"}),m.jsx("input",{name:"folderPath",value:q.folderPath,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Sermon Ideas or Journal-2026-Week1"})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 flex items-center justify-between",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(VE,{size:16}),"Cover Image URL"]})}),m.jsxs("div",{className:"flex gap-4 items-start",children:[m.jsxs("div",{className:"flex-1 relative",children:[m.jsx("input",{name:"coverUrl",value:q.coverUrl,onChange:B,placeholder:"Paste image URL or Auto-Find ->",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg pl-3 pr-24 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-sm text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-950"}),m.jsxs("button",{type:"button",onClick:()=>H(q.title,q.author,q.isbn),disabled:v||!q.title&&!q.isbn,className:"absolute right-1 top-1 bottom-1 px-3 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] hover:bg-[rgba(204,86,30,0.15)] dark:hover:bg-[rgba(204,86,30,0.25)] text-[#CC561E] dark:text-[#f3a47b] rounded text-xs font-semibold flex items-center gap-1 transition-colors",title:"Auto-find cover based on Title/ISBN",children:[v?m.jsx(kn,{size:14,className:"animate-spin"}):m.jsx(ZR,{size:14}),"Auto-Find"]})]}),m.jsxs("div",{className:"w-16 h-20 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0 shadow-sm relative group",children:[q.coverUrl?m.jsx("img",{src:q.coverUrl,alt:"Preview",className:"w-full h-full object-cover",onError:z=>z.currentTarget.style.display="none"}):m.jsx(VE,{className:"text-slate-300",size:20}),v&&m.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center backdrop-blur-[1px]",children:m.jsx(kn,{size:16,className:"animate-spin text-[#CC561E]"})}),!v&&!q.coverUrl&&m.jsx("div",{className:"absolute inset-0 bg-black/5 hidden group-hover:flex items-center justify-center",children:m.jsx(Ka,{size:12,className:"text-slate-500"})})]})]}),m.jsx("div",{className:"mt-1 flex justify-end",children:m.jsxs("a",{href:`https://www.google.com/search?tbm=isch&q=book+cover+${encodeURIComponent(q.title+" "+q.author)}`,target:"_blank",rel:"noreferrer",className:"text-xs text-slate-400 dark:text-slate-500 hover:text-[#CC561E] dark:hover:text-[#f3a47b] hover:underline flex items-center gap-1",children:["Manual Search on Google Images ",m.jsx(Ka,{size:10})]})})]}),(e==="BOOK"||e==="ARTICLE")&&m.jsxs("div",{className:"bg-[rgba(204,86,30,0.05)] dark:bg-[rgba(204,86,30,0.1)] p-4 rounded-xl border border-[#CC561E]/10 dark:border-[#CC561E]/20",children:[m.jsxs("label",{className:"block text-sm font-semibold text-[#CC561E] dark:text-[#f3a47b] mb-2 flex items-center gap-2",children:[m.jsx(up,{size:16}),"Upload PDF Document to Library"]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("input",{type:"file",accept:".pdf",onChange:G,className:"flex-1 text-sm text-slate-600 dark:text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[#CC561E] file:text-white hover:file:bg-[#b34b1a] transition-all cursor-pointer"}),O&&m.jsx("button",{type:"button",onClick:()=>j(null),className:"text-red-500 hover:text-red-600 p-2",title:"Remove PDF",children:m.jsx(ta,{size:18})}),D&&m.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[#CC561E] font-medium animate-pulse",children:[m.jsx(kn,{size:14,className:"animate-spin"}),"Verifying metadata..."]})]}),m.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-2",children:"PDF content will be vectorized and added to your searchable AI library."})]})]}),m.jsx("hr",{className:`${re?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),re&&m.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[m.jsx("label",{className:`block text-sm font-medium mb-1 ${_e}`,children:"Content"}),m.jsx(i5,{value:q.generalNotes,onChange:z=>de(ae=>({...ae,generalNotes:z})),minHeight:420}),m.jsx("p",{className:`mt-1 text-[10px] ${we}`,children:"Toolbar supports heading, bold, underline, bullet list, numbered list and checklist."})]}),m.jsxs("div",{className:re?"space-y-3":"space-y-5",children:[!re&&m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Reading Status *"}),m.jsxs("select",{name:"readingStatus",value:q.readingStatus,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[m.jsx("option",{value:"To Read",children:"To Read"}),m.jsx("option",{value:"Reading",children:"Reading"}),m.jsx("option",{value:"Finished",children:"Finished"})]})]}),e==="BOOK"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Inventory Status *"}),m.jsxs("select",{name:"status",value:q.status,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[m.jsx("option",{value:"On Shelf",children:"On Shelf"}),m.jsx("option",{value:"Lent Out",children:"Lent Out"}),m.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("label",{className:`block text-sm font-medium mb-1 flex justify-between ${_e}`,children:[m.jsxs("div",{className:"flex items-center gap-2",children:["Tags (comma separated)",C&&m.jsxs("span",{className:"text-xs text-[#CC561E] animate-pulse flex items-center gap-1",children:[m.jsx(Qa,{size:10})," AI Enriching..."]})]}),re&&m.jsxs("button",{type:"button",onClick:xe,disabled:S||!yp(q.generalNotes),className:"text-xs text-[#CC561E] dark:text-[#f3a47b] hover:text-[#b34b1a] dark:hover:text-white flex items-center gap-1 disabled:opacity-50",children:[S?m.jsx(kn,{size:12,className:"animate-spin"}):m.jsx(Qa,{size:12}),"AI Auto-Tag"]})]}),m.jsx("input",{name:"tags",value:q.tags,onChange:B,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${re?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:re?"Use AI to generate tags...":"Ideas, Todo, Research"})]}),e==="BOOK"&&q.status==="Lent Out"&&m.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 grid grid-cols-1 md:grid-cols-2 gap-4 animate-in slide-in-from-top-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Lent To (Name) *"}),m.jsx("input",{required:!0,name:"lentToName",value:q.lentToName,onChange:B,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Date"}),m.jsx("input",{type:"date",name:"lentDate",value:q.lentDate,onChange:B,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]})]})]}),m.jsx("hr",{className:`${re?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),!re&&m.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Summary"}),m.jsx("textarea",{name:"summaryText",rows:4,value:q.summaryText,onChange:B,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] resize-none leading-relaxed flex-1 bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:e==="WEBSITE"?"Why did you save this website?":"Your thoughts..."})]}),m.jsxs("div",{className:`flex justify-between items-center ${re?"pt-1":"pt-2"} mt-auto`,children:[!t&&e!=="WEBSITE"&&!re&&m.jsx("button",{type:"button",onClick:()=>o("search"),className:"text-sm text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] underline decoration-[#CC561E]/30 dark:decoration-[#CC561E]/50 hover:decoration-[#CC561E] dark:hover:decoration-[#CC561E]",children:"Back to Search"}),m.jsxs("div",{className:"flex gap-3 ml-auto",children:[m.jsx("button",{type:"button",onClick:i,className:"px-5 py-2 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium",children:"Cancel"}),m.jsx("button",{type:"submit",disabled:k,className:"px-5 py-2 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg shadow-lg shadow-[#CC561E]/20 transition-all font-medium flex items-center gap-2 active:scale-95",children:k?m.jsxs(m.Fragment,{children:[m.jsx(kn,{size:18,className:"animate-spin"}),"Ingesting PDF..."]}):m.jsxs(m.Fragment,{children:["Save ",e==="ARTICLE"?"Article":e==="WEBSITE"?"Website":e==="PERSONAL_NOTE"?"Note":"Book"]})})]})]})]})]})})};var Cx={exports:{}},w_;function KZ(){return w_||(w_=1,(function(t){var e=(function(n){var r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(B,G,M){B[G]=M.value},o,s=typeof Symbol=="function"?Symbol:{},c=s.iterator||"@@iterator",d=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function p(B,G,M){return Object.defineProperty(B,G,{value:M,enumerable:!0,configurable:!0,writable:!0}),B[G]}try{p({},"")}catch{p=function(G,M,V){return G[M]=V}}function x(B,G,M,V){var Z=G&&G.prototype instanceof k?G:k,re=Object.create(Z.prototype),_e=new H(V||[]);return a(re,"_invoke",{value:q(B,M,_e)}),re}n.wrap=x;function v(B,G,M){try{return{type:"normal",arg:B.call(G,M)}}catch(V){return{type:"throw",arg:V}}}var b="suspendedStart",C="suspendedYield",E="executing",S="completed",N={};function k(){}function I(){}function D(){}var L={};p(L,c,function(){return this});var O=Object.getPrototypeOf,j=O&&O(O(ie([])));j&&j!==r&&i.call(j,c)&&(L=j);var U=D.prototype=k.prototype=Object.create(L);I.prototype=D,a(U,"constructor",{value:D,configurable:!0}),a(D,"constructor",{value:I,configurable:!0}),I.displayName=p(D,h,"GeneratorFunction");function fe(B){["next","throw","return"].forEach(function(G){p(B,G,function(M){return this._invoke(G,M)})})}n.isGeneratorFunction=function(B){var G=typeof B=="function"&&B.constructor;return G?G===I||(G.displayName||G.name)==="GeneratorFunction":!1},n.mark=function(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,D):(B.__proto__=D,p(B,h,"GeneratorFunction")),B.prototype=Object.create(U),B},n.awrap=function(B){return{__await:B}};function le(B,G){function M(re,_e,J,we){var z=v(B[re],B,_e);if(z.type==="throw")we(z.arg);else{var ae=z.arg,ce=ae.value;return ce&&typeof ce=="object"&&i.call(ce,"__await")?G.resolve(ce.__await).then(function(Te){M("next",Te,J,we)},function(Te){M("throw",Te,J,we)}):G.resolve(ce).then(function(Te){ae.value=Te,J(ae)},function(Te){return M("throw",Te,J,we)})}}var V;function Z(re,_e){function J(){return new G(function(we,z){M(re,_e,we,z)})}return V=V?V.then(J,J):J()}a(this,"_invoke",{value:Z})}fe(le.prototype),p(le.prototype,d,function(){return this}),n.AsyncIterator=le,n.async=function(B,G,M,V,Z){Z===void 0&&(Z=Promise);var re=new le(x(B,G,M,V),Z);return n.isGeneratorFunction(G)?re:re.next().then(function(_e){return _e.done?_e.value:re.next()})};function q(B,G,M){var V=b;return function(re,_e){if(V===E)throw new Error("Generator is already running");if(V===S){if(re==="throw")throw _e;return K()}for(M.method=re,M.arg=_e;;){var J=M.delegate;if(J){var we=de(J,M);if(we){if(we===N)continue;return we}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(V===b)throw V=S,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);V=E;var z=v(B,G,M);if(z.type==="normal"){if(V=M.done?S:C,z.arg===N)continue;return{value:z.arg,done:M.done}}else z.type==="throw"&&(V=S,M.method="throw",M.arg=z.arg)}}}function de(B,G){var M=G.method,V=B.iterator[M];if(V===o)return G.delegate=null,M==="throw"&&B.iterator.return&&(G.method="return",G.arg=o,de(B,G),G.method==="throw")||M!=="return"&&(G.method="throw",G.arg=new TypeError("The iterator does not provide a '"+M+"' method")),N;var Z=v(V,B.iterator,G.arg);if(Z.type==="throw")return G.method="throw",G.arg=Z.arg,G.delegate=null,N;var re=Z.arg;if(!re)return G.method="throw",G.arg=new TypeError("iterator result is not an object"),G.delegate=null,N;if(re.done)G[B.resultName]=re.value,G.next=B.nextLoc,G.method!=="return"&&(G.method="next",G.arg=o);else return re;return G.delegate=null,N}fe(U),p(U,h,"Generator"),p(U,c,function(){return this}),p(U,"toString",function(){return"[object Generator]"});function ge(B){var G={tryLoc:B[0]};1 in B&&(G.catchLoc=B[1]),2 in B&&(G.finallyLoc=B[2],G.afterLoc=B[3]),this.tryEntries.push(G)}function xe(B){var G=B.completion||{};G.type="normal",delete G.arg,B.completion=G}function H(B){this.tryEntries=[{tryLoc:"root"}],B.forEach(ge,this),this.reset(!0)}n.keys=function(B){var G=Object(B),M=[];for(var V in G)M.push(V);return M.reverse(),function Z(){for(;M.length;){var re=M.pop();if(re in G)return Z.value=re,Z.done=!1,Z}return Z.done=!0,Z}};function ie(B){if(B){var G=B[c];if(G)return G.call(B);if(typeof B.next=="function")return B;if(!isNaN(B.length)){var M=-1,V=function Z(){for(;++M<B.length;)if(i.call(B,M))return Z.value=B[M],Z.done=!1,Z;return Z.value=o,Z.done=!0,Z};return V.next=V}}return{next:K}}n.values=ie;function K(){return{value:o,done:!0}}return H.prototype={constructor:H,reset:function(B){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(xe),!B)for(var G in this)G.charAt(0)==="t"&&i.call(this,G)&&!isNaN(+G.slice(1))&&(this[G]=o)},stop:function(){this.done=!0;var B=this.tryEntries[0],G=B.completion;if(G.type==="throw")throw G.arg;return this.rval},dispatchException:function(B){if(this.done)throw B;var G=this;function M(we,z){return re.type="throw",re.arg=B,G.next=we,z&&(G.method="next",G.arg=o),!!z}for(var V=this.tryEntries.length-1;V>=0;--V){var Z=this.tryEntries[V],re=Z.completion;if(Z.tryLoc==="root")return M("end");if(Z.tryLoc<=this.prev){var _e=i.call(Z,"catchLoc"),J=i.call(Z,"finallyLoc");if(_e&&J){if(this.prev<Z.catchLoc)return M(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return M(Z.finallyLoc)}else if(_e){if(this.prev<Z.catchLoc)return M(Z.catchLoc,!0)}else if(J){if(this.prev<Z.finallyLoc)return M(Z.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(B,G){for(var M=this.tryEntries.length-1;M>=0;--M){var V=this.tryEntries[M];if(V.tryLoc<=this.prev&&i.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var Z=V;break}}Z&&(B==="break"||B==="continue")&&Z.tryLoc<=G&&G<=Z.finallyLoc&&(Z=null);var re=Z?Z.completion:{};return re.type=B,re.arg=G,Z?(this.method="next",this.next=Z.finallyLoc,N):this.complete(re)},complete:function(B,G){if(B.type==="throw")throw B.arg;return B.type==="break"||B.type==="continue"?this.next=B.arg:B.type==="return"?(this.rval=this.arg=B.arg,this.method="return",this.next="end"):B.type==="normal"&&G&&(this.next=G),N},finish:function(B){for(var G=this.tryEntries.length-1;G>=0;--G){var M=this.tryEntries[G];if(M.finallyLoc===B)return this.complete(M.completion,M.afterLoc),xe(M),N}},catch:function(B){for(var G=this.tryEntries.length-1;G>=0;--G){var M=this.tryEntries[G];if(M.tryLoc===B){var V=M.completion;if(V.type==="throw"){var Z=V.arg;xe(M)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(B,G,M){return this.delegate={iterator:ie(B),resultName:G,nextLoc:M},this.method==="next"&&(this.arg=o),N}},n})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(Cx)),Cx.exports}var Ex,C_;function L2(){return C_||(C_=1,Ex=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),Ex}var Sx,E_;function yT(){if(E_)return Sx;E_=1;const t=L2();let e=0;return Sx=({id:n,action:r,payload:i={}})=>{let a=n;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:r,payload:i}},Sx}var Hu={},S_;function j2(){if(S_)return Hu;S_=1;let t=!1;return Hu.logging=t,Hu.setLogging=e=>{t=e},Hu.log=(...e)=>t?console.log.apply(this,e):null,Hu}var Ax,A_;function YZ(){if(A_)return Ax;A_=1;const t=yT(),{log:e}=j2(),n=L2();let r=0;return Ax=()=>{const i=n("Scheduler",r),a={},o={};let s=[];r+=1;const c=()=>s.length,d=()=>Object.keys(a).length,h=()=>{if(s.length!==0){const C=Object.keys(a);for(let E=0;E<C.length;E+=1)if(typeof o[C[E]]>"u"){s[0](a[C[E]]);break}}},p=(C,E)=>new Promise((S,N)=>{const k=t({action:C,payload:E});s.push(async I=>{s.shift(),o[I.id]=k;try{S(await I[C].apply(this,[...E,k.id]))}catch(D){N(D)}finally{delete o[I.id],h()}}),e(`[${i}]: Add ${k.id} to JobQueue`),e(`[${i}]: JobQueue length=${s.length}`),h()});return{addWorker:C=>(a[C.id]=C,e(`[${i}]: Add ${C.id}`),e(`[${i}]: Number of workers=${d()}`),h(),C.id),addJob:async(C,...E)=>{if(d()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(C,E)},terminate:async()=>{Object.keys(a).forEach(async C=>{await a[C].terminate()}),s=[]},getQueueLen:c,getNumWorkers:d}},Ax}function ZZ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _x,__;function JZ(){return __||(__=1,_x=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof ZZ=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),_x}var Nx,N_;function QZ(){if(N_)return Nx;N_=1;const e=JZ()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return Nx=n=>{const r={...n};return["corePath","workerPath","langPath"].forEach(i=>{n[i]&&(r[i]=e(r[i]))}),r},Nx}var kx,k_;function bT(){return k_||(k_=1,kx={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),kx}const eJ="7.0.0",tJ={version:eJ};var Tx,T_;function nJ(){return T_||(T_=1,Tx={workerBlobURL:!0,logger:()=>{}}),Tx}var Ox,O_;function rJ(){if(O_)return Ox;O_=1;const t=tJ.version;return Ox={...nJ(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},Ox}var Ix,I_;function iJ(){return I_||(I_=1,Ix=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n}),Ix}var Dx,D_;function aJ(){return D_||(D_=1,Dx=t=>{t.terminate()}),Dx}var Mx,M_;function oJ(){return M_||(M_=1,Mx=(t,e)=>{t.onmessage=({data:n})=>{e(n)}}),Mx}var Rx,R_;function sJ(){return R_||(R_=1,Rx=async(t,e)=>{t.postMessage(e)}),Rx}var Lx,L_;function lJ(){if(L_)return Lx;L_=1;const t=n=>new Promise((r,i)=>{const a=new FileReader;a.onload=()=>{r(a.result)},a.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},a.readAsArrayBuffer(n)}),e=async n=>{let r=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?r=atob(n.split(",")[1]).split("").map(i=>i.charCodeAt(0)):r=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(r=await e(n.src)),n.tagName==="VIDEO"&&(r=await e(n.poster)),n.tagName==="CANVAS"&&await new Promise(i=>{n.toBlob(async a=>{r=await t(a),i()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const i=await n.convertToBlob();r=await t(i)}else(n instanceof File||n instanceof Blob)&&(r=await t(n));return new Uint8Array(r)};return Lx=e,Lx}var jx,j_;function cJ(){if(j_)return jx;j_=1;const t=rJ(),e=iJ(),n=aJ(),r=oJ(),i=sJ(),a=lJ();return jx={defaultOptions:t,spawnWorker:e,terminateWorker:n,onMessage:r,send:i,loadImage:a},jx}var Px,P_;function wT(){if(P_)return Px;P_=1;const t=QZ(),e=yT(),{log:n}=j2(),r=L2(),i=bT(),{defaultOptions:a,spawnWorker:o,terminateWorker:s,onMessage:c,loadImage:d,send:h}=cJ();let p=0;return Px=async(x="eng",v=i.LSTM_ONLY,b={},C={})=>{const E=r("Worker",p),{logger:S,errorHandler:N,...k}=t({...a,...b}),I={},D=typeof x=="string"?x.split("+"):x;let L=v,O=C;const j=[i.DEFAULT,i.LSTM_ONLY].includes(v)&&!k.legacyCore;let U,fe;const le=new Promise((ae,ce)=>{fe=ae,U=ce}),q=ae=>{U(ae.message)};let de=o(k);de.onerror=q,p+=1;const ge=({id:ae,action:ce,payload:Te})=>new Promise((Le,ot)=>{n(`[${E}]: Start ${ae}, action=${ce}`);const Ke=`${ce}-${ae}`;I[Ke]={resolve:Le,reject:ot},h(de,{workerId:E,jobId:ae,action:ce,payload:Te})}),xe=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),H=ae=>ge(e({id:ae,action:"load",payload:{options:{lstmOnly:j,corePath:k.corePath,logging:k.logging}}})),ie=(ae,ce,Te)=>ge(e({id:Te,action:"FS",payload:{method:"writeFile",args:[ae,ce]}})),K=(ae,ce)=>ge(e({id:ce,action:"FS",payload:{method:"readFile",args:[ae,{encoding:"utf8"}]}})),B=(ae,ce)=>ge(e({id:ce,action:"FS",payload:{method:"unlink",args:[ae]}})),G=(ae,ce,Te)=>ge(e({id:Te,action:"FS",payload:{method:ae,args:ce}})),M=(ae,ce)=>ge(e({id:ce,action:"loadLanguage",payload:{langs:ae,options:{langPath:k.langPath,dataPath:k.dataPath,cachePath:k.cachePath,cacheMethod:k.cacheMethod,gzip:k.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(L)&&!k.legacyLang}}})),V=(ae,ce,Te,Le)=>ge(e({id:Le,action:"initialize",payload:{langs:ae,oem:ce,config:Te}})),Z=(ae="eng",ce,Te,Le)=>{if(j&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(ce))throw Error("Legacy model requested but code missing.");const ot=ce||L;L=ot;const Ke=Te||O;O=Ke;const Ut=(typeof ae=="string"?ae.split("+"):ae).filter(Me=>!D.includes(Me));return D.push(...Ut),Ut.length>0?M(Ut,Le).then(()=>V(ae,ot,Ke,Le)):V(ae,ot,Ke,Le)},re=(ae={},ce)=>ge(e({id:ce,action:"setParameters",payload:{params:ae}})),_e=async(ae,ce={},Te={text:!0},Le)=>ge(e({id:Le,action:"recognize",payload:{image:await d(ae),options:ce,output:Te}})),J=async(ae,ce)=>{if(j)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return ge(e({id:ce,action:"detect",payload:{image:await d(ae)}}))},we=async()=>(de!==null&&(s(de),de=null),Promise.resolve());c(de,({workerId:ae,jobId:ce,status:Te,action:Le,data:ot})=>{const Ke=`${Le}-${ce}`;if(Te==="resolve")n(`[${ae}]: Complete ${ce}`),I[Ke].resolve({jobId:ce,data:ot}),delete I[Ke];else if(Te==="reject")if(I[Ke].reject(ot),delete I[Ke],Le==="load"&&U(ot),N)N(ot);else throw Error(ot);else Te==="progress"&&S({...ot,userJobId:ce})});const z={id:E,worker:de,load:xe,writeText:ie,readText:K,removeFile:B,FS:G,reinitialize:Z,setParameters:re,recognize:_e,detect:J,terminate:we};return H().then(()=>M(x)).then(()=>V(x,v,C)).then(()=>fe(z)).catch(()=>{}),le},Px}var Bx,B_;function uJ(){if(B_)return Bx;B_=1;const t=wT();return Bx={recognize:async(r,i,a)=>{const o=await t(i,1,a);return o.recognize(r).finally(async()=>{await o.terminate()})},detect:async(r,i)=>{const a=await t("osd",0,i);return a.detect(r).finally(async()=>{await a.terminate()})}},Bx}var Fx,F_;function dJ(){return F_||(F_=1,Fx={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Fx}var zx,z_;function fJ(){return z_||(z_=1,zx={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),zx}var Ux,U_;function hJ(){if(U_)return Ux;U_=1,KZ();const t=YZ(),e=wT(),n=uJ(),r=dJ(),i=bT(),a=fJ(),{setLogging:o}=j2();return Ux={languages:r,OEM:i,PSM:a,createScheduler:t,createWorker:e,setLogging:o,...n},Ux}var P2=hJ();const pJ=C0(P2),mJ=jO({__proto__:null,default:pJ},[P2]),gJ=async(t,e)=>{const n=await P2.createWorker("tur+eng",1,{logger:r=>{r.status==="recognizing text"&&e&&e(Math.round(r.progress*100))}});try{const{data:{text:r,confidence:i}}=await n.recognize(t);return{text:r,confidence:i}}finally{await n.terminate()}},xJ=1600,vJ=.85;function yJ(t){const e=t.maxTouchPoints>0||t.hasCoarsePointer,n=t.viewportWidth<=1024;return e&&n}function bJ(t,e){const n=(t||"").trim(),r=(e||"").trim();return r?n?`${n}

${r}`:r:n}async function wJ(t,e={}){const n=e.maxWidth??xJ,r=e.quality??vJ,i=await createImageBitmap(t);try{const a=i.width,o=i.height;if(!a||!o)throw new Error("Invalid image dimensions");const s=a>n?n/a:1,c=Math.max(1,Math.round(a*s)),d=Math.max(1,Math.round(o*s)),h=document.createElement("canvas");h.width=c,h.height=d;const p=h.getContext("2d");if(!p)throw new Error("Canvas context is unavailable");return p.drawImage(i,0,0,c,d),await new Promise(v=>{h.toBlob(v,"image/jpeg",r)})||t}finally{i.close()}}const H_=.02,CJ=({open:t,onClose:e,onApply:n,onProcessingChange:r,onErrorChange:i,onDraftChange:a})=>{const[o,s]=A.useState(null),[c,d]=A.useState(null),[h,p]=A.useState(null),[x,v]=A.useState(!1),[b,C]=A.useState(!1),[E,S]=A.useState(0),[N,k]=A.useState(""),I=A.useRef(null),D=A.useRef(null),L=A.useRef(null),O=A.useRef(null),j=(K,B,G)=>Math.min(G,Math.max(B,K));if(A.useEffect(()=>{t&&(s(null),d(null),p(null),k(""),S(0),v(!1),C(!1),r(!1),i(null),a(""),setTimeout(()=>{var K;(K=I.current)==null||K.click()},100))},[t,a,i,r]),A.useEffect(()=>{O.current=h},[h]),!t)return null;const U=K=>{var M;const B=(M=K.target.files)==null?void 0:M[0];if(!B)return;d(B),p(null),k(""),a(""),i(null);const G=new FileReader;G.onload=V=>{var Z;s((Z=V.target)==null?void 0:Z.result)},G.readAsDataURL(B)},fe=K=>{if(!D.current)return null;const B=D.current.getBoundingClientRect();return B.width<=0||B.height<=0?null:{x:j((K.clientX-B.left)/B.width,0,1),y:j((K.clientY-B.top)/B.height,0,1)}},le=K=>{if(x)return;const B=fe(K);B&&(K.currentTarget.setPointerCapture(K.pointerId),L.current=B,p({x:B.x,y:B.y,width:0,height:0}),C(!0))},q=K=>{if(!b||!L.current)return;const B=fe(K);if(!B)return;const G=L.current,M=Math.min(G.x,B.x),V=Math.min(G.y,B.y),Z=Math.abs(B.x-G.x),re=Math.abs(B.y-G.y);p({x:M,y:V,width:Z,height:re})},de=K=>{if(!b)return;K.currentTarget.hasPointerCapture(K.pointerId)&&K.currentTarget.releasePointerCapture(K.pointerId),C(!1);const B=O.current;(!B||B.width<H_||B.height<H_)&&p(null)},ge=async(K,B)=>{const G=await createImageBitmap(K);try{const M=j(Math.round(B.x*G.width),0,G.width-1),V=j(Math.round(B.y*G.height),0,G.height-1),Z=Math.max(1,Math.round(B.width*G.width)),re=Math.max(1,Math.round(B.height*G.height)),_e=Math.min(Z,G.width-M),J=Math.min(re,G.height-V),we=document.createElement("canvas");we.width=_e,we.height=J;const z=we.getContext("2d");if(!z)throw new Error("Canvas context is unavailable");return z.drawImage(G,M,V,_e,J,0,0,_e,J),await new Promise(ce=>{we.toBlob(ce,"image/jpeg",.92)})||K}finally{G.close()}},xe=async K=>{if(c){v(!0),r(!0),i(null),S(0);try{const B=K&&h?await ge(c,h):c,G=await wJ(B),V=((await gJ(G,Z=>S(Z))).text||"").trim();k(V),a(V),V||i("Secilen alanda okunabilir metin bulunamadi. Alani degistirip tekrar deneyin.")}catch(B){console.error("OCR Error:",B);const G="Metin okunamadi. Isigi ve aciyi duzeltip tekrar deneyin.";i(G),alert(G)}finally{v(!1),r(!1)}}},H=()=>{s(null),d(null),p(null),k(""),S(0),C(!1),a(""),i(null),I.current&&(I.current.value="",I.current.click())},ie=()=>{n(N),e()};return m.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[m.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-white/10",children:[m.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[m.jsx(vc,{size:20,className:"text-primary dark:text-orange-500"}),"Metin Tara (OCR)"]}),m.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 dark:hover:bg-white/5 rounded-full transition-colors","aria-label":"Kapat",children:m.jsx(ta,{size:20,className:"text-slate-500"})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!o&&m.jsxs("div",{onClick:()=>{var K;return(K=I.current)==null?void 0:K.click()},className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-12 flex flex-col items-center justify-center gap-4 cursor-pointer hover:border-primary/50 dark:hover:border-orange-500/50 transition-colors",children:[m.jsx("div",{className:"w-16 h-16 bg-primary/10 dark:bg-orange-500/10 rounded-full flex items-center justify-center text-primary dark:text-orange-500",children:m.jsx(vc,{size:32})}),m.jsxs("div",{className:"text-center",children:[m.jsx("p",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Kamerayi Ac"}),m.jsx("p",{className:"text-sm text-slate-500",children:"Sayfayi cekin, sonra metin alanini secin"})]})]}),o&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"relative bg-black rounded-lg border border-slate-200 dark:border-white/10 shadow-inner p-2",children:[m.jsxs("div",{className:"relative mx-auto w-fit max-w-full touch-none",children:[m.jsx("img",{src:o,alt:"Captured",className:"block max-h-[58vh] w-auto max-w-full rounded-md"}),!x&&m.jsx("div",{ref:D,className:"absolute inset-0 cursor-crosshair",onPointerDown:le,onPointerMove:q,onPointerUp:de,onPointerCancel:de,children:h&&m.jsx("div",{className:"absolute border-2 border-emerald-400 bg-emerald-400/12",style:{left:`${h.x*100}%`,top:`${h.y*100}%`,width:`${h.width*100}%`,height:`${h.height*100}%`}})})]}),x&&m.jsxs("div",{className:"absolute inset-0 bg-black/60 flex flex-col items-center justify-center text-white p-6 text-center backdrop-blur-[2px]",children:[m.jsx(kn,{size:48,className:"animate-spin mb-4 text-primary dark:text-orange-500"}),m.jsx("p",{className:"font-bold text-lg mb-2",children:"Metin Isleniyor..."}),m.jsx("div",{className:"w-full max-w-xs bg-white/20 h-2 rounded-full overflow-hidden",children:m.jsx("div",{className:"bg-primary dark:bg-orange-500 h-full transition-all duration-300",style:{width:`${E}%`}})}),m.jsxs("p",{className:"mt-2 text-sm font-medium",children:["%",E]}),m.jsx("p",{className:"mt-4 text-[10px] text-white/60",children:"Bu islem cihaz hizina gore 5-10 saniye surebilir."})]})]}),!x&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Metin bolgesini secmek icin gorsel uzerinde surukleyin."}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[m.jsxs("button",{type:"button",onClick:()=>xe(!0),disabled:!h,className:"py-2 px-3 rounded-lg bg-emerald-600 text-white text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center gap-2",children:[m.jsx(vR,{size:16}),"Secili Alani Tara"]}),m.jsx("button",{type:"button",onClick:()=>xe(!1),className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:"Tum Sayfayi Tara"}),m.jsxs("button",{type:"button",onClick:H,className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:[m.jsx(C4,{size:16}),"Tekrar Cek"]})]})]}),!x&&N&&m.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[m.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Okunan Metin"}),m.jsx("textarea",{value:N,onChange:K=>{k(K.target.value),a(K.target.value)},className:"w-full h-40 border border-slate-200 dark:border-white/10 rounded-xl p-3 text-sm bg-slate-50 dark:bg-white/5 text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/20 outline-none resize-none font-lora"}),m.jsx("p",{className:"text-[10px] text-slate-400 italic text-right",children:"* Hatalari buradan duzeltebilirsiniz."})]})]})]}),m.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-white/10 flex gap-3",children:[o&&!x&&m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 border border-slate-200 dark:border-white/10 rounded-xl text-slate-600 dark:text-slate-300 font-semibold hover:bg-slate-50 dark:hover:bg-white/5 transition-colors",children:"Kapat"}),m.jsxs("button",{onClick:ie,disabled:!N,className:"flex-[1.5] py-3 px-4 bg-primary dark:bg-orange-600 text-white rounded-xl font-bold hover:opacity-90 transition-all shadow-lg shadow-primary/20 dark:shadow-orange-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:[m.jsx(fy,{size:18}),"Highlight'a Ekle"]})]}),!o&&m.jsx("button",{onClick:e,className:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 dark:hover:text-slate-300 transition-colors",children:"Vazgec"})]})]}),m.jsx("input",{ref:I,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:U})]})},EJ=({highlights:t,onUpdate:e,autoEditHighlightId:n})=>{const[r,i]=A.useState(!1),[a,o]=A.useState(null),[s,c]=A.useState({}),[d,h]=A.useState("highlight"),[p,x]=A.useState(!1),[v,b]=A.useState(!1),[C,E]=A.useState(!1),[S,N]=A.useState(""),[k,I]=A.useState(null),[D,L]=A.useState(""),[O,j]=A.useState(""),[U,fe]=A.useState(!1);Qe.useEffect(()=>{if(n){const K=t.find(B=>B.id===n);K&&q(K)}},[n]),Qe.useEffect(()=>{const K=()=>{if(typeof window>"u"){b(!1);return}const B=typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches,G=typeof navigator<"u"?Number(navigator.maxTouchPoints||0):0;b(yJ({viewportWidth:window.innerWidth||0,maxTouchPoints:G,hasCoarsePointer:B}))};return K(),window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const le=()=>{o(null),c({}),h("highlight"),L(new Date().toISOString().split("T")[0]),j(""),x(!1),I(null),N(""),i(!0)},q=K=>{o(K.id),c({...K}),h(M0(K.type)),L(new Date(K.createdAt).toISOString().split("T")[0]),j(K.tags?K.tags.join(", "):""),x(!1),I(null),N(""),i(!0)},de=()=>{i(!1),o(null),c({}),j(""),L(""),x(!1),I(null),N(""),E(!1)},ge=Qe.useCallback(K=>{c(B=>({...B,text:bJ(String(B.text||""),K)})),N(K),I(null),x(!1)},[]),xe=async()=>{if(!s.text)return;fe(!0);const K=`"${s.text}"
${s.comment?`Context: ${s.comment}`:""}`,B=await M2(K);if(B.length>0){const G=O?O.split(",").map(V=>V.trim()).filter(Boolean):[],M=Array.from(new Set([...G,...B]));j(M.join(", "))}fe(!1)},H=()=>{if(!s.text)return;const K=O.split(",").map(M=>M.trim()).filter(M=>M.length>0),B=D?new Date(D).getTime():Date.now(),G={id:a||Date.now().toString(),text:s.text,type:d,pageNumber:s.pageNumber,paragraphNumber:s.paragraphNumber,chapterTitle:s.chapterTitle,comment:s.comment,createdAt:B,tags:K};if(a){const M=t.map(V=>V.id===a?G:V);e(M)}else e([G,...t]);de()},ie=K=>{window.confirm("Delete this item?")&&e(t.filter(B=>B.id!==K))};return m.jsxs("div",{className:"space-y-4 md:space-y-6",children:[!r&&m.jsxs("button",{onClick:le,className:"w-full py-3 md:py-4 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl text-slate-500 dark:text-slate-400 hover:border-[#262D40]/24 hover:text-[#262D40] hover:bg-[#262D40]/30 dark:hover:bg-white/5 transition-all flex flex-col items-center gap-1 md:gap-2",children:[m.jsx(qx,{size:20,className:"md:w-6 md:h-6"}),m.jsx("span",{className:"text-sm md:text-base font-medium",children:"Add Highlight or Insights"})]}),r&&m.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl shadow-lg border border-[#262D40]/8 dark:border-white/10 animate-in fade-in zoom-in-95 duration-200 relative ring-1 ring-[#262D40]/5 dark:ring-white/5",children:[m.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[m.jsxs("h4",{className:"font-semibold text-slate-800 dark:text-white flex items-center gap-2 text-sm md:text-base",children:[a?m.jsx(cp,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}):m.jsx(qx,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}),a?d==="highlight"?"Edit Highlight":"Edit Note":"New Entry"]}),m.jsxs("div",{className:"flex items-center gap-2",children:[d==="highlight"&&v&&m.jsxs("button",{type:"button",onClick:()=>{I(null),N(""),x(!0)},disabled:C,className:"inline-flex items-center gap-1 rounded-md border border-sky-200 bg-sky-50 px-2 py-1 text-[11px] font-semibold text-sky-700 transition-colors hover:bg-sky-100 disabled:cursor-not-allowed disabled:opacity-60 dark:border-sky-700 dark:bg-sky-950/35 dark:text-sky-200 dark:hover:bg-sky-950/55",title:"Kamera ile metin tara",children:[C?m.jsx(kn,{size:12,className:"animate-spin"}):m.jsx(vc,{size:12}),"Tara"]}),m.jsx("button",{onClick:de,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:m.jsx(ta,{size:18,className:"md:w-5 md:h-5"})})]})]}),m.jsxs("div",{className:"flex bg-[#F3F5FA] dark:bg-white/5 p-1 rounded-lg mb-4 md:mb-5",children:[m.jsxs("button",{type:"button",onClick:()=>{d!=="highlight"&&(h("highlight"),c({}),j(""),I(null),N(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${d==="highlight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[m.jsx(yd,{size:14,className:"md:w-4 md:h-4"}),"Highlight"]}),m.jsxs("button",{type:"button",onClick:()=>{d!=="insight"&&(h("insight"),c({}),j(""),x(!1),I(null),N(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${d==="insight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[m.jsx(bc,{size:14,className:"md:w-4 md:h-4"}),"Insights"]})]}),m.jsxs("div",{className:"space-y-2 md:space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:d==="highlight"?"Highlight Text *":"Insight Content *"}),m.jsx("textarea",{autoFocus:!0,rows:12,className:"w-full border rounded-lg p-2 md:p-3 text-sm md:text-base text-slate-800 dark:text-white focus:ring-2 focus:ring-[#262D40]/30 dark:focus:ring-orange-500/30 focus:border-[#262D40]/30 dark:focus:border-orange-500/30 font-lora bg-[#F3F5FA] border-[#E6EAF2] dark:bg-slate-800/50 dark:border-white/10",placeholder:d==="highlight"?"Type the text exactly as it appears...":"Write your thoughts, summary, or key takeaway...",value:s.text||"",onChange:K=>c(B=>({...B,text:K.target.value}))}),d==="highlight"&&S&&m.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-sky-700 dark:text-sky-300",children:"OCR metni eklendi. Kaydetmeden once metni kontrol edebilirsiniz."}),d==="highlight"&&k&&m.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-red-600 dark:text-red-400",children:k})]}),d==="highlight"&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Comment"}),m.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Why is this quote important?",value:s.comment||"",onChange:K=>c(B=>({...B,comment:K.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Page #"}),m.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:s.pageNumber||"",onChange:K=>c(B=>({...B,pageNumber:parseInt(K.target.value)||void 0}))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Paragraph #"}),m.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:s.paragraphNumber||"",onChange:K=>c(B=>({...B,paragraphNumber:parseInt(K.target.value)||void 0}))})]}),m.jsxs("div",{className:"col-span-2 md:col-span-1",children:[m.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Chapter"}),m.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Title or No.",value:s.chapterTitle||"",onChange:K=>c(B=>({...B,chapterTitle:K.target.value}))})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4 pt-2 border-t border-slate-50 dark:border-white/5",children:[m.jsxs("div",{className:"md:col-span-1",children:[m.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center gap-1",children:[m.jsx(xc,{size:10,className:"md:w-3 md:h-3"})," Date"]}),m.jsx("input",{type:"date",value:D,onChange:K=>L(K.target.value),className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]}),m.jsxs("div",{className:"md:col-span-2",children:[m.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center justify-between",children:[m.jsx("span",{children:"Tags"}),m.jsxs("button",{type:"button",onClick:xe,disabled:U||!s.text,className:"text-[#262D40] dark:text-orange-500 hover:text-[#262D40] dark:hover:text-orange-400 flex items-center gap-1 disabled:opacity-50 text-[10px] font-bold tracking-wide",children:[U?m.jsx(kn,{size:10,className:"animate-spin"}):m.jsx(Qa,{size:10}),"AI AUTO-TAG"]})]}),m.jsx("input",{type:"text",value:O,onChange:K=>j(K.target.value),placeholder:"Separate with commas...",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2 mt-2",children:[m.jsx("button",{onClick:de,className:"px-3 md:px-4 py-2 text-xs md:text-sm text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-white/5 rounded-lg flex items-center gap-2",children:"Cancel"}),m.jsxs("button",{onClick:H,disabled:!s.text,className:"px-3 md:px-4 py-2 text-xs md:text-sm bg-[#262D40]/40 dark:bg-orange-600/40 text-white rounded-lg hover:bg-[#262D40]/55 dark:hover:bg-orange-600/60 disabled:opacity-50 shadow-sm flex items-center gap-2",children:[m.jsx(gR,{size:14,className:"md:w-4 md:h-4"}),a?"Update Entry":"Save Entry"]})]})]})]}),m.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.map(K=>{const B=q4(K.type);return m.jsxs("div",{className:"p-3 md:p-6 rounded-xl border transition-all relative group bg-white dark:bg-slate-900/50 border-[#E6EAF2] dark:border-white/10 hover:border-[#262D40]/12 dark:hover:border-orange-500/30 hover:shadow-md",children:[m.jsxs("div",{className:"absolute top-1 right-1 md:top-4 md:right-4 flex gap-0.5 md:gap-2 md:bg-white/80 md:dark:bg-slate-800/90 md:backdrop-blur-sm p-0 md:p-1 rounded-lg md:shadow-sm md:border md:border-[#E6EAF2] md:dark:border-white/10 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity z-10",children:[m.jsx("button",{type:"button",onClick:G=>{G.stopPropagation(),q(K)},className:"p-1.5 text-slate-400/70 dark:text-slate-500/70 hover:text-[#262D40] dark:hover:text-orange-500 hover:bg-[#262D40]/5 dark:hover:bg-white/5 rounded-md transition-colors",title:"Edit",children:m.jsx(cp,{size:14,className:"md:w-4 md:h-4"})}),m.jsx("button",{type:"button",onClick:G=>{G.stopPropagation(),ie(K.id)},className:"p-1.5 text-slate-400/70 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:m.jsx(Js,{size:14,className:"md:w-4 md:h-4"})})]}),m.jsxs("div",{className:"flex gap-3 md:gap-4",children:[m.jsx("div",{className:"flex-shrink-0 mt-0.5 md:mt-1",children:B?m.jsx(bc,{size:16,className:"text-[#262D40]/82 fill-[#262D40]/85 md:w-5 md:h-5"}):m.jsx(yd,{size:16,className:"text-yellow-400 fill-yellow-200 md:w-5 md:h-5"})}),m.jsxs("div",{className:"flex-1",children:[m.jsx("p",{className:`text-sm md:text-lg leading-relaxed mb-2 md:mb-3 pr-0 md:pr-16 whitespace-pre-wrap font-lora ${B?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-white"}`,children:K.text}),m.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mb-2",children:[(K.pageNumber||K.paragraphNumber)&&m.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 md:px-2 md:py-1 rounded border bg-[#F3F5FA] dark:bg-white/5 border-[#E6EAF2] dark:border-white/10 text-slate-600 dark:text-slate-400",children:[m.jsx(YM,{size:10,className:"md:w-3 md:h-3"}),K.pageNumber&&m.jsxs("span",{children:["Pg ",K.pageNumber]}),K.pageNumber&&K.paragraphNumber&&m.jsx("span",{children:""}),K.paragraphNumber&&m.jsxs("span",{children:["Para ",K.paragraphNumber]})]}),K.chapterTitle&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(zd,{size:10,className:"md:w-3 md:h-3"}),m.jsx("span",{children:K.chapterTitle})]}),m.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[m.jsx(xc,{size:10,className:"md:w-3 md:h-3"}),m.jsx("span",{children:new Date(K.createdAt).toLocaleDateString()})]})]}),K.tags&&K.tags.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-2",children:K.tags.map((G,M)=>m.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-white/5 border border-[#E6EAF2] dark:border-white/10 rounded text-[9px] md:text-[10px] text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[m.jsx(sp,{size:8})," ",G]},M))}),K.comment&&m.jsx("div",{className:"mt-2 md:mt-3 pl-3 md:pl-4 border-l-2 border-[#E6EAF2] dark:border-white/10 py-0.5 md:py-1",children:m.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 italic",children:K.comment})})]})]})]},K.id)}),t.length===0&&!r&&m.jsx("div",{className:"text-center py-8 md:py-12 text-slate-400",children:m.jsx("p",{className:"text-xs md:text-base",children:"No highlights or insights added yet."})})]}),m.jsx(CJ,{open:p,onClose:()=>x(!1),onApply:ge,onProcessingChange:E,onErrorChange:I,onDraftChange:N})]})},b0=(t,e)=>{if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=Date.parse(t);if(Number.isFinite(n))return n}return e},SJ=t=>{const e=String(t||"AUTO").trim().toUpperCase();return e==="TR"||e==="EN"?e:"AUTO"},V_=t=>{const e=String(t||"").trim().toLowerCase();if(e==="tr"||e==="en")return e},AJ=(t,e)=>{const n=b0(t.createdAt,Date.now());return{id:typeof t.id=="string"&&t.id.trim()?t.id:`${n}-${e}`,text:t.text||"",type:M0(t.type),pageNumber:t.pageNumber,paragraphNumber:t.paragraphNumber,chapterTitle:t.chapterTitle,comment:t.comment,createdAt:n,tags:Array.isArray(t.tags)?t.tags:[],isFavorite:!!t.isFavorite}},CT=t=>({...t,addedAt:b0(t.addedAt,Date.now()),tags:Array.isArray(t.tags)?t.tags:[],contentLanguageMode:SJ(t.contentLanguageMode),contentLanguageResolved:V_(t.contentLanguageResolved),sourceLanguageHint:V_(t.sourceLanguageHint),highlights:Array.isArray(t.highlights)?t.highlights.map((e,n)=>AJ(e,n)):[],personalNoteCategory:t.type==="PERSONAL_NOTE"?R0(t.personalNoteCategory):void 0,personalFolderId:t.type==="PERSONAL_NOTE"?J4(t.personalFolderId):void 0,folderPath:t.type==="PERSONAL_NOTE"?Z4(t.folderPath):void 0,status:t.status||"On Shelf",readingStatus:t.readingStatus||"To Read",author:(t.author||"Unknown Author").trim()||"Unknown Author",title:(t.title||"Untitled").trim()||"Untitled",summaryText:typeof t.summaryText=="string"?t.summaryText:void 0}),ET=t=>({...t,category:R0(t.category),name:(t.name||"").trim(),order:Number.isFinite(t.order)?t.order:0,createdAt:b0(t.createdAt,Date.now()),updatedAt:b0(t.updatedAt,Date.now())});function _J(t){return t?{__oracleCursor:t}:null}function NJ(t){return t?t.__oracleCursor:void 0}const Fh=async(t,e=2e3,n)=>{const r=new URL(`${ct}/api/library/items`);r.searchParams.set("limit",String(e));const i=NJ(n);i&&r.searchParams.set("cursor",i);const a=await nn(r.toString());if(!a.ok)throw new Error(await ia(a,"Failed to fetch library items from Oracle"));const o=await a.json(),c=(Array.isArray(o==null?void 0:o.items)?o.items:[]).map(h=>CT(h)),d=_J(typeof(o==null?void 0:o.next_cursor)=="string"?o.next_cursor:null);return{items:c,lastDoc:d}},w0=async(t,e)=>{const n=CT(e),r=await nn(`${ct}/api/library/items/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await ia(r,"Failed to save library item to Oracle"))},Qu=async(t,e,n)=>{const r=await nn(`${ct}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:n})});if(!r.ok)throw new Error(await ia(r,"Failed to patch library item in Oracle"))},kJ=async(t,e)=>{const n=await nn(`${ct}/api/library/items/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await ia(n,"Failed to delete library item from Oracle"))},TJ=async(t,e)=>{if(e.length===0)return;const n=await nn(`${ct}/api/library/items/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:e})});if(!n.ok)throw new Error(await ia(n,"Failed to bulk delete library items from Oracle"))},Hx=async t=>{const e=await nn(`${ct}/api/library/personal-note-folders`);if(!e.ok)throw new Error(await ia(e,"Failed to fetch personal note folders from Oracle"));const n=await e.json();return(Array.isArray(n==null?void 0:n.folders)?n.folders:[]).map(i=>ET(i)).sort((i,a)=>i.category!==a.category?i.category.localeCompare(a.category):i.order!==a.order?i.order-a.order:i.name.localeCompare(a.name))},$_=async(t,e)=>{const n=ET(e),r=await nn(`${ct}/api/library/personal-note-folders/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await ia(r,"Failed to save personal note folder to Oracle"))},G_=async(t,e,n)=>{const r=await nn(`${ct}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await ia(r,"Failed to update personal note folder in Oracle"))},OJ=async(t,e)=>{const n=await nn(`${ct}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await ia(n,"Failed to delete personal note folder from Oracle"))},zh=async(t,e,n,r,i)=>{const a=await nn(`${ct}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:{personalNoteCategory:R0(n),personalFolderId:J4(r)||null,folderPath:Z4(i)||null}})});if(!a.ok)throw new Error(await ia(a,"Failed to move personal note in Oracle"))},IJ=Qe.memo(({book:t,onBack:e,onEdit:n,onDelete:r,onUpdateHighlights:i,initialTab:a="info",autoEditHighlightId:o,onIngestSuccess:s,onBookUpdated:c})=>{const[d,h]=A.useState(a),[p,x]=A.useState(null),[v,b]=A.useState(!1),[C,E]=A.useState(!1),[S,N]=A.useState(!1),[k,I]=A.useState(null),[D,L]=A.useState(null),[O,j]=A.useState(null),[U,fe]=A.useState(null),[le,q]=A.useState(null),[de,ge]=A.useState(0),[xe,H]=A.useState(0),{user:ie}=a1(),K=Qe.useRef(null),B=Qe.useRef(null),G=t.type==="PERSONAL_NOTE",M=Me=>{if(!Me)return"";const We=Me.replace(/_/g," ").replace(/\s+/g," ").trim(),Pe=24;return We.length<=Pe?We:`${We.slice(0,Pe).trimEnd()}...`},V=async Me=>{var Pe;const We=(Pe=Me.target.files)==null?void 0:Pe[0];if(!(!We||!ie)){if(We.type!=="application/pdf"){j("Please select a PDF file");return}E(!0),j(null),L(null),fe({status:"PROCESSING",file_name:We.name,chunk_count:null,embedding_count:null,updated_at:new Date().toISOString()}),ge(Se=>Se+1);try{const Se=await w5(We,t.title,t.author,ie.uid,t.id);L(Se),setTimeout(()=>L(null),5e3)}catch(Se){j(Se instanceof Error?Se.message:"Ingestion failed")}finally{E(!1),K.current&&(K.current.value="")}}},Z=Me=>{switch(Me){case"Reading":return{icon:Zs,color:"text-[#38BDF8]",bg:"bg-[#38BDF8]/12",border:"border-[#38BDF8]/45"};case"Finished":return{icon:vd,color:"text-[#22C55E]",bg:"bg-[#22C55E]/12",border:"border-[#22C55E]/45"};case"To Read":return{icon:tM,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"};default:return{icon:Zs,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"}}},re=Me=>{switch(Me){case"Lent Out":return{icon:Ko,color:"text-[#F59E0B]",bg:"bg-[#F59E0B]/15",border:"border-[#F59E0B]/45"};case"Lost":return{icon:Ko,color:"text-[#F43F5E]",bg:"bg-[#F43F5E]/15",border:"border-[#F43F5E]/45"};case"On Shelf":default:return{icon:b4,color:"text-[#14B8A6]",bg:"bg-[#14B8A6]/15",border:"border-[#14B8A6]/45"}}},_e=async()=>{if(t.highlights.length===0)return;b(!0);const Me=t.highlights.map(Pe=>Pe.text),We=await hT(Me);x(We),b(!1)},J=async()=>{if(!(!(ie!=null&&ie.uid)||S)){N(!0),I(null);try{const Me=r1(t),We=await R2(Me,{forceRegenerate:!0}),Pe=i1(t,We),Se={};Pe.summaryText!==t.summaryText&&(Se.summaryText=Pe.summaryText),JSON.stringify(Pe.tags||[])!==JSON.stringify(t.tags||[])&&(Se.tags=Pe.tags),Pe.publisher!==t.publisher&&(Se.publisher=Pe.publisher),Pe.translator!==t.translator&&(Se.translator=Pe.translator),Pe.publicationYear!==t.publicationYear&&(Se.publicationYear=Pe.publicationYear),Pe.isbn!==t.isbn&&(Se.isbn=Pe.isbn),Pe.coverUrl!==t.coverUrl&&(Se.coverUrl=Pe.coverUrl),Pe.pageCount!==t.pageCount&&(Se.pageCount=Pe.pageCount),Pe.contentLanguageMode!==t.contentLanguageMode&&(Se.contentLanguageMode=Pe.contentLanguageMode),Pe.contentLanguageResolved!==t.contentLanguageResolved&&(Se.contentLanguageResolved=Pe.contentLanguageResolved),Pe.sourceLanguageHint!==t.sourceLanguageHint&&(Se.sourceLanguageHint=Pe.sourceLanguageHint),Pe.languageDecisionReason!==t.languageDecisionReason&&(Se.languageDecisionReason=Pe.languageDecisionReason),Pe.languageDecisionConfidence!==t.languageDecisionConfidence&&(Se.languageDecisionConfidence=Pe.languageDecisionConfidence),Object.keys(Se).length>0&&await Qu(ie.uid,t.id,Se),c==null||c({...t,...Se}),(Pe.summaryText||Pe.generalNotes)&&x(Pe.summaryText||Pe.generalNotes||null)}catch(Me){console.error("Enrich failed",Me),I(Me instanceof Error?Me.message:"Failed to generate with AI")}finally{N(!1)}}},we=G?null:Z(t.readingStatus),z=G?null:re(t.status),ae=!!((U==null?void 0:U.status)==="COMPLETED"&&(U!=null&&U.matched_by_title)&&(U!=null&&U.resolved_book_id)&&String(U.resolved_book_id)!==String(t.id)),ce=(U==null?void 0:U.status)==="COMPLETED"&&!ae,Te=(U==null?void 0:U.status)==="PROCESSING",Le=(U==null?void 0:U.status)==="FAILED",ot=ce||Te||C,Ke=Math.min(95,Math.max(12,12+xe*3)),ht=Qe.useCallback(()=>{ge(Me=>Me+1)},[]);Qe.useEffect(()=>{if(!(ie!=null&&ie.uid)||!(t!=null&&t.id)||G){fe(null),q(null),H(0),B.current&&(clearTimeout(B.current),B.current=null);return}let Me=!1;const We=60,Pe=async()=>{try{const Se=await $q(t.id,ie.uid,t.title);if(Me)return;fe(Se),q(null);const fn=!!(Se.status==="COMPLETED"&&Se.matched_by_title&&Se.resolved_book_id&&String(Se.resolved_book_id)!==String(t.id)),An=Se.status==="COMPLETED"&&!fn;if(t.isIngested!==An){const Mr={...t,isIngested:An};c==null||c(Mr)}Se.status==="COMPLETED"&&!fn&&(s==null||s()),Se.status==="PROCESSING"&&H(Mr=>{const rn=Mr+1;return rn<We&&!Me&&(B.current=setTimeout(Pe,1e4)),rn})}catch(Se){if(Me)return;q(Se instanceof Error?Se.message:"Failed to fetch ingestion status"),H(fn=>{const An=fn+1;return An<We&&!Me&&(B.current=setTimeout(Pe,1e4)),An})}};return H(0),Pe(),()=>{Me=!0,B.current&&(clearTimeout(B.current),B.current=null)}},[t.id,ie==null?void 0:ie.uid,G,de]);const Ut=(Me,We,Pe)=>m.jsxs("div",{className:`p-2 md:p-4 rounded-lg md:rounded-xl border-2 ${Me.bg} ${Me.border} flex items-center gap-2 md:gap-3 shadow-sm h-full`,children:[m.jsx("div",{className:`p-1.5 md:p-2 rounded-full bg-white/50 dark:bg-black/20 ${Me.color} flex-shrink-0`,children:m.jsx(Me.icon,{size:16,className:"md:w-5 md:h-5"})}),m.jsxs("div",{className:"min-w-0 flex-1",children:[m.jsx("span",{className:"block text-[9px] md:text-[10px] uppercase tracking-wider font-bold text-[#111827] dark:text-white/60 truncate",children:We}),m.jsx("span",{className:"font-bold text-xs md:text-base leading-tight text-[#111827] dark:text-white truncate block",children:Pe})]})]});return m.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-3 md:p-4 pb-20 animate-in fade-in duration-300",children:[m.jsxs("button",{onClick:e,className:"mb-2 md:mb-6 flex items-center text-slate-500 dark:text-slate-400 hover:text-[#262D40] dark:hover:text-white transition-colors group text-base md:text-base",children:[m.jsx(p4,{size:18,className:"mr-1.5 md:mr-1 md:w-5 md:h-5 group-hover:-translate-x-1 transition-transform"}),"Back to ",G?"Notes":"Library"]}),m.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 overflow-hidden",children:[m.jsx("div",{className:"p-4 md:p-8 border-b border-[#E6EAF2] dark:border-slate-800",children:G?m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2 md:mb-4 text-[#262D40]/90 dark:text-white/85",children:[m.jsx(lp,{size:18,className:"md:w-6 md:h-6"}),m.jsx("span",{className:"text-xs md:text-sm font-bold tracking-wide uppercase text-[#262D40]/80 dark:text-white",children:"Personal Note"}),m.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs font-bold tracking-wide",children:Nr(t)}),t.folderPath&&m.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs border border-[#E6EAF2] dark:border-slate-700",children:t.folderPath})]}),m.jsx("h1",{className:"text-xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 md:mb-4 leading-tight",children:t.title}),m.jsxs("div",{className:"flex flex-wrap gap-1.5 md:gap-2 mb-2",children:[t.tags.map((Me,We)=>m.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},We)),m.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 text-slate-400 dark:text-slate-500 text-[10px] md:text-xs flex items-center gap-1",children:[m.jsx(xc,{size:10,className:"md:w-3 md:h-3"}),new Date(t.addedAt).toLocaleDateString()]})]})]}),m.jsxs("div",{className:"flex gap-1 md:gap-2 ml-2 md:ml-4 flex-shrink-0",children:[m.jsx("input",{type:"file",ref:K,className:"hidden",accept:".pdf",onChange:V}),m.jsx("button",{type:"button",onClick:()=>{var Me;return(Me=K.current)==null?void 0:Me.click()},disabled:ot,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors relative",title:ce?`PDF already indexed: ${(U==null?void 0:U.file_name)||""}`:"Upload PDF",children:C?m.jsx(kn,{size:18,className:"md:w-5 md:h-5 animate-spin text-[#262D40]/90"}):m.jsx(up,{size:18,className:"md:w-5 md:h-5"})}),m.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors",title:"Edit Note",children:m.jsx(cp,{size:18,className:"md:w-5 md:h-5"})}),m.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-full transition-colors",title:"Delete Note",children:m.jsx(Js,{size:18,className:"md:w-5 md:h-5"})})]})]}):m.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[m.jsxs("div",{className:"flex gap-4 md:block md:shrink-0",children:[m.jsx("div",{className:"w-20 h-32 md:w-34 md:h-52 bg-slate-200 dark:bg-slate-800 rounded-lg shadow-inner flex-shrink-0 flex items-center justify-center text-slate-400 dark:text-slate-600 self-center md:self-start overflow-hidden relative border border-[#E6EAF2] dark:border-slate-700",children:t.type==="BOOK"&&t.coverUrl?m.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-full h-full object-cover"}):t.type==="BOOK"?m.jsx(Zs,{size:32,className:"md:w-12 md:h-12"}):t.type==="ARTICLE"?m.jsx(zd,{size:32,className:"md:w-12 md:h-12"}):m.jsx(N0,{size:32,className:"md:w-12 md:h-12"})}),m.jsxs("div",{className:"md:hidden flex-1 flex justify-between items-start min-w-0 py-1 gap-2",children:[m.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[m.jsx("h1",{className:"text-[16px] font-bold text-slate-900 dark:text-white mb-1 leading-snug line-clamp-3",children:t.title}),m.jsx("p",{className:"text-[13px] text-slate-600 dark:text-slate-400 mb-2 line-clamp-2",children:t.author}),t.url&&t.type!=="BOOK"&&m.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 text-[#262D40] dark:text-slate-400 hover:underline max-w-full",children:[m.jsx($E,{size:12}),m.jsx("span",{className:"text-xs truncate",children:new URL(t.url).hostname})]})]}),m.jsxs("div",{className:"flex flex-col gap-1.5 flex-shrink-0 pt-0.5",children:[we&&m.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${we.bg} ${we.border} ${we.color}`,children:[m.jsx(we.icon,{size:10}),m.jsx("span",{children:t.readingStatus})]}),z&&t.type==="BOOK"&&m.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${z.bg} ${z.border} ${z.color}`,children:[m.jsx(z.icon,{size:10}),m.jsx("span",{children:t.status})]})]})]})]}),m.jsxs("div",{className:"hidden md:block flex-1 min-w-0",children:[m.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 leading-tight",children:t.title}),m.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 mb-4",children:t.author}),m.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.tags.map((Me,We)=>m.jsxs("span",{className:"px-2 py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},We))}),t.url&&t.type!=="BOOK"&&m.jsx("div",{className:"mb-6",children:m.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[#262D40] dark:text-[#262D40]/82 hover:underline",children:[m.jsx($E,{size:16}),m.jsx("span",{className:"text-sm",children:t.url})]})})]}),m.jsx("div",{className:"md:hidden flex flex-wrap gap-1.5 -mt-1 mb-1",children:t.tags.map((Me,We)=>m.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},We))}),m.jsxs("div",{className:"w-full md:w-64 flex-shrink-0 flex flex-col gap-2 md:gap-3",children:[m.jsxs("div",{className:"hidden md:flex md:flex-col gap-2 md:gap-3",children:[we&&m.jsx("div",{className:!z||t.type!=="BOOK"?"col-span-2 md:col-span-1":"col-span-1",children:Ut(we,"Status",t.readingStatus)}),z&&t.type==="BOOK"&&m.jsx("div",{className:"col-span-1",children:Ut(z,"Inventory",t.status)})]}),m.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1 md:mt-2",children:[m.jsx("input",{type:"file",ref:K,className:"hidden",accept:".pdf",onChange:V}),m.jsxs("button",{type:"button",onClick:()=>{var Me;return(Me=K.current)==null?void 0:Me.click()},disabled:ot,className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium disabled:opacity-50",title:ce?`PDF already indexed: ${(U==null?void 0:U.file_name)||""}`:"Upload PDF",children:[C?m.jsx(kn,{size:14,className:"animate-spin"}):m.jsx(up,{size:14}),m.jsx("span",{className:"hidden lg:inline",children:"PDF"})]}),m.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[m.jsx(cp,{size:14})," ",m.jsx("span",{className:"hidden lg:inline",children:"Edit"})]}),m.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-red-300 dark:hover:border-red-500 hover:text-red-600 dark:hover:text-red-400 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[m.jsx(Js,{size:14})," ",m.jsx("span",{className:"hidden lg:inline",children:"Delete"})]})]}),(D||ce)&&m.jsxs("div",{className:"mt-2 text-[10px] text-emerald-600 dark:text-emerald-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[m.jsx(vd,{size:10}),(U==null?void 0:U.chunk_count)!=null?`PDF indexlendi (${U.chunk_count} chunk)`:"PDF indexlendi"]}),ae&&m.jsxs("div",{className:"mt-2 text-[10px] text-amber-600 dark:text-amber-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[m.jsx(Ko,{size:10})," Ayni baslikta baska bir kaydin PDF'i bulundu; bu kayit icin indexli sayilmadi."]}),O&&m.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[m.jsx(yc,{size:10})," ",O]}),Le&&m.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[m.jsx(Ko,{size:10})," PDF islenemedi. Lutfen farkli bir PDF ile tekrar deneyin."]})]})]})}),!G&&m.jsxs("div",{className:"flex border-b border-[#E6EAF2] dark:border-slate-800",children:[m.jsx("button",{onClick:()=>h("info"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${d==="info"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:"Details"}),m.jsxs("button",{onClick:()=>h("highlights"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${d==="highlights"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:["Highlights (",t.highlights.length,")"]})]}),m.jsxs("div",{className:"p-4 md:p-8 bg-[#F7F8FB] dark:bg-slate-900/50 min-h-[400px]",children:[(d==="info"||G)&&m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8",children:[m.jsx("div",{className:G?"md:col-span-3":"md:col-span-2 space-y-6",children:m.jsxs("div",{className:`bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm ${G?"min-h-[300px]":""}`,children:[!G&&m.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 md:mb-4",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(bc,{size:18,className:"text-[#262D40]/90 dark:text-[#262D40]/82 md:w-5 md:h-5"}),m.jsx("h3",{className:"text-base md:text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Summary"})]}),m.jsxs("button",{type:"button",onClick:J,disabled:S,className:"flex items-center gap-1.5 text-[11px] md:text-xs font-semibold text-white px-2 py-1 rounded-lg border border-[#262D40] bg-[#262D40] hover:bg-[#1d2333] disabled:opacity-60",children:[S?m.jsx(kn,{size:14,className:"animate-spin"}):m.jsx(Qa,{size:14}),S?"Generating...":"Generate with AI"]})]}),(G?t.generalNotes:t.summaryText||t.generalNotes)?G?m.jsx("div",{className:"personal-note-render text-slate-700 dark:text-slate-300 leading-relaxed text-sm md:text-base max-w-none",dangerouslySetInnerHTML:{__html:Cy(t.generalNotes)}}):m.jsx("p",{className:"text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed text-sm md:text-lg",children:t.summaryText||t.generalNotes}):m.jsx("p",{className:"text-slate-400 dark:text-slate-500 italic text-sm",children:"No content added."}),k&&m.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2 flex items-center gap-1",children:[m.jsx(yc,{size:12})," ",k]})]})}),!G&&m.jsx("div",{className:"space-y-4 md:space-y-6",children:m.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm space-y-4",children:[m.jsx("h3",{className:"text-xs md:text-sm font-semibold text-slate-900 dark:text-white uppercase tracking-wider mb-2 md:mb-4",children:"Information"}),t.publisher&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:t.type==="ARTICLE"?"Journal":"Publisher"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publisher})]}),t.publicationYear&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Year"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publicationYear})]}),t.translator&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Translator"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.translator})]}),t.isbn&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"ISBN"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 font-mono",children:t.isbn})]}),t.pageCount&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Page Count"}),m.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[t.pageCount," pages"]})]}),U&&U.status!=="NOT_FOUND"&&!ae&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"PDF"}),m.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[Te&&"Processing...",Le&&"Failed - please re-upload",ce&&m.jsxs(m.Fragment,{children:[U.file_name?m.jsx("span",{title:U.file_name,children:`Indexed: ${M(U.file_name)}`}):"Indexed",U.chunk_count!==null?` (${U.chunk_count} chunks)`:""]})]}),(Te||C)&&m.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[m.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700 overflow-hidden",children:m.jsx("div",{className:"h-full rounded-full bg-sky-500 transition-all duration-500",style:{width:`${Ke}%`}})}),m.jsx("button",{type:"button",onClick:ht,className:"text-[10px] md:text-xs text-sky-600 dark:text-sky-400 underline underline-offset-2",children:"Yenile"})]}),le&&m.jsx("span",{className:"text-[10px] md:text-xs text-red-600 dark:text-red-400",children:le})]}),t.code&&m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Shelf Code"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(sp,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.code})]})]}),m.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[m.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Added"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(xc,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),m.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:new Date(t.addedAt).toLocaleDateString()})]})]})]})})]}),!G&&d==="highlights"&&m.jsxs("div",{className:"space-y-6",children:[t.highlights.length>0&&m.jsx("div",{className:"flex justify-end",children:m.jsxs("button",{onClick:_e,disabled:v,className:"text-xs md:text-sm text-[#262D40] dark:text-[#262D40]/82 hover:text-[#262D40] dark:hover:text-[#262D40]/78 flex items-center gap-2 disabled:opacity-50",children:[m.jsx(Qa,{size:14,className:"md:w-4 md:h-4"}),v?"Analyzing...":"Analyze Highlights with AI"]})}),p&&m.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 border border-[#262D40]/8 dark:border-[#262D40]/70 p-3 md:p-4 rounded-lg mb-4 animate-in fade-in slide-in-from-top-2",children:[m.jsxs("h4",{className:"text-[#262D40] dark:text-[#262D40]/78 font-semibold text-xs md:text-sm mb-2 flex items-center gap-2",children:[m.jsx(Qa,{size:14})," AI Analysis"]}),m.jsxs("p",{className:"text-[#262D40] dark:text-[#262D40]/75 text-xs md:text-sm leading-relaxed italic",children:['"',p,'"']})]}),m.jsx(EJ,{highlights:t.highlights,onUpdate:i,autoEditHighlightId:o})]})]})]})]})}),ST="/assets/logo_v9-D75hAm-V.png",AT=A.createContext(void 0),DJ=({children:t})=>{const[e,n]=A.useState("light");A.useEffect(()=>{const i=localStorage.getItem("theme");i?n(i):window.matchMedia("(prefers-color-scheme: dark)").matches&&n("dark")},[]),A.useEffect(()=>{const i=window.document.documentElement;e==="dark"?i.classList.add("dark"):i.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const r=()=>{n(i=>i==="light"?"dark":"light")};return m.jsx(AT.Provider,{value:{theme:e,toggleTheme:r},children:t})},MJ=()=>{const t=A.useContext(AT);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},RJ=({activeTab:t,onTabChange:e,isOpen:n,onClose:r})=>{const{theme:i,toggleTheme:a}=MJ(),o=[{id:"DASHBOARD",label:"Dashboard",icon:V4},{id:"SMART_SEARCH",label:"Search (Layer 2)",icon:vp},{id:"RAG_SEARCH",label:"LogosChat (Layer 3)",icon:W4},{id:"FLOW",label:"Flux (Layer 4)",icon:R9},{id:"BOOK",label:"Books",icon:Zx},{id:"ARTICLE",label:"Articles",icon:$h},{id:"WEBSITE",label:"Websites",icon:Gh},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:G4},{id:"NOTES",label:"All Notes",icon:$4}];return m.jsxs(m.Fragment,{children:[n&&m.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-40 lg:hidden backdrop-blur-sm",onClick:r}),m.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50 w-[269px] bg-[#262D40] border-r border-white/10 transform transition-transform duration-300 ease-in-out flex flex-col shadow-xl lg:shadow-none h-full
        ${n?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:[m.jsxs("div",{className:"px-3 pt-0 pb-3 flex flex-col items-center border-b border-white/10 bg-[#262D40] gap-2 relative",children:[m.jsx("img",{src:ST,alt:"TomeHub Icon",className:"h-[68px] lg:h-[77px] w-auto object-contain brightness-110 drop-shadow-md"}),m.jsx("button",{onClick:r,className:"lg:hidden absolute top-2 right-3 p-1 hover:bg-white/10 rounded-full text-white/70 hover:text-white transition-colors",children:m.jsx(ta,{size:20})})]}),m.jsx("nav",{className:"flex-1 px-3 pt-2 pb-6 space-y-1 overflow-y-auto",children:o.map(s=>{const c=s.icon,d=t===s.id;return m.jsxs("button",{onClick:()=>{e(s.id),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${d?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[m.jsx(c,{className:`w-[18px] h-[18px] lg:w-5 lg:h-5 transition-colors ${d?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),s.label]},s.id)})}),m.jsxs("div",{className:"p-3 border-t border-white/10",children:[m.jsxs("button",{onClick:()=>{e("PROFILE"),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${t==="PROFILE"?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[m.jsx(hy,{className:`w-[17px] h-[17px] lg:w-5 lg:h-5 transition-colors ${t==="PROFILE"?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),"Profile"]}),m.jsx("button",{onClick:a,className:"w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium text-white/70 hover:bg-white/5 hover:text-white transition-all duration-200 group mt-1",children:i==="light"?m.jsxs(m.Fragment,{children:[m.jsx(tR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-white/60 group-hover:text-white"}),"Dark Mode"]}):m.jsxs(m.Fragment,{children:[m.jsx(LR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-amber-400"}),"Light Mode"]})})]}),m.jsx("div",{className:"p-4 border-t border-white/10",children:m.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[m.jsx("p",{className:"text-[13px] text-white/70 font-medium mb-1",children:"My Personal Library"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CC561E] animate-pulse"}),m.jsx("p",{className:"text-[11px] text-white/50 uppercase tracking-wider font-semibold",children:"Online"})]})]})})]})]})},LJ=({books:t,userId:e})=>{const[n,r]=A.useState(!1),[i,a]=A.useState(0),[o,s]=A.useState({success:0,failed:0,total:0}),[c,d]=A.useState(""),[h,p]=A.useState(null),[x,v]=A.useState(!1),b=async()=>{if(!e)return;r(!0),p(null),v(!1);let C=0,E=0;s({success:0,failed:0,total:t.length});const S=t.map(O=>{if(gn(O)&&!K4(O))return null;let j="";return O.type==="PERSONAL_NOTE"?(j=Cc(O.generalNotes||"")||O.title,O.highlights&&O.highlights.length>0&&(j+=`

`+O.highlights.map(U=>U.text).join(`

`))):(j=`Title: ${O.title}
Author: ${O.author}
`,O.generalNotes&&(j+=`
Summary/Notes: ${Cc(O.generalNotes)}`),O.tags&&O.tags.length>0&&(j+=`
Tags: ${O.tags.join(", ")}`)),{text:j,title:O.title,author:O.author,type:gn(O)?Y4(O):O.type,book_id:O.id,tags:O.tags}}).filter(O=>!!O&&O.text.length>20),N=S.length,k=20,I=[];for(let O=0;O<S.length;O+=k)I.push(S.slice(O,O+k));let D=0;for(let O=0;O<I.length;O++){const j=I[O];d(`Batch ${O+1}/${I.length} (${j.length} items)`);try{const U=await Wq(j,e);U.success&&U.results&&(C+=U.results.success,E+=U.results.failed)}catch(U){console.error(`Batch ${O+1} failed:`,U),E+=j.length}D+=j.length,a(Math.round(D/N*100)),s(U=>({...U,success:C,failed:E+(t.length-N)}))}const L=t.filter(O=>O.highlights&&O.highlights.length>0);if(L.length>0){d("Syncing highlights...");for(const O of L)try{await Kv(e,O.id,O.title,O.author,O.highlights||[])}catch(j){console.error(`Highlight sync failed for ${O.title}:`,j)}}r(!1),v(!0),d("")};return m.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-slate-50 dark:from-[#262D40]/20 dark:to-slate-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:m.jsxs("div",{className:"p-6 md:p-8",children:[m.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[m.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:m.jsx(oM,{size:24})}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Migrate to AI Library"}),m.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Sync your existing books and notes to the new AI backend to make them searchable."})]})]}),m.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[m.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:n?"Migration in Progress...":"Ready to Sync"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:x?m.jsxs("span",{className:"text-[#262D40] font-medium",children:["Migration Complete! ",o.success," items synced."]}):n?m.jsxs("span",{children:["Syncing: ",m.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:c})]}):m.jsxs("span",{children:["Sync ",t.length," items to Oracle AI Vector Database."]})})]}),!n&&!x&&m.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-6 py-3 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg font-medium transition-colors shadow-md shadow-[#CC561E]/20 dark:shadow-none",children:[m.jsx(w4,{size:18,fill:"currentColor"}),"Start Migration"]}),n&&m.jsxs("div",{className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-slate-500 rounded-lg border border-slate-200 dark:border-slate-700",children:[m.jsx(kn,{size:18,className:"animate-spin"}),"Processing..."]})]}),(n||x)&&m.jsxs("div",{className:"mt-6",children:[m.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[m.jsx("span",{children:"Progress"}),m.jsxs("span",{children:[i,"%"]})]}),m.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:m.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:`${i}%`}})}),m.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[m.jsxs("span",{children:[o.success+o.failed,"/",o.total," items"]}),m.jsxs("span",{children:["Success: ",o.success,"  Failed: ",o.failed]})]})]})]})]})})},jJ=()=>{const{user:t}=a1(),[e,n]=A.useState(!1),[r,i]=A.useState(0),[a,o]=A.useState(0),[s,c]=A.useState(!1),[d,h]=A.useState(null),p=A.useRef(null),x=async C=>{var N;const E=(N=C.target.files)==null?void 0:N[0];if(!E)return;if(!E.name.toLowerCase().endsWith(".json")){h("Please upload a valid JSON file.");return}const S=new FileReader;S.onload=async k=>{var I;try{const D=(I=k.target)==null?void 0:I.result,L=JSON.parse(D);if(!Array.isArray(L))throw new Error("JSON must be an array of books.");await v(L)}catch(D){console.error("File parsing error:",D),h("Failed to parse JSON file. Make sure it's a valid list of books.")}},S.onerror=()=>{h("Error reading file.")},S.readAsText(E)},v=async C=>{if(!t)return;n(!0),h(null),c(!1),o(C.length),i(0);let E=0;try{for(const S of C){const N={id:Date.now().toString()+Math.random().toString(36).substr(2,9),type:"BOOK",title:S.title||"Untitled",author:S.author||"Unknown Author",status:"On Shelf",readingStatus:"To Read",tags:[],highlights:[],addedAt:Date.now(),coverUrl:S.coverUrl||void 0};await w0(t.uid,N);try{const k=`Title: ${N.title}
Author: ${N.author}`;await C5(k,N.title,N.author,N.type,t.uid,{book_id:N.id,tags:N.tags||[]})}catch(k){console.error("Import sync to AI backend failed:",k)}E++,i(E),await new Promise(k=>setTimeout(k,50))}c(!0),p.current&&(p.current.value="")}catch(S){console.error("Import failed:",S),h("Failed to import books. Please try again.")}finally{n(!1)}},b=()=>{var C;(C=p.current)==null||C.click()};return m.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 md:p-8 mt-6",children:[m.jsxs("div",{className:"flex items-start justify-between mb-4",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Import Books"}),m.jsx("p",{className:"text-slate-500 mt-1",children:"Upload a JSON file to add books to your library."})]}),m.jsx("div",{className:"p-3 bg-[#262D40]/5 text-[#262D40] rounded-lg",children:m.jsx(v4,{size:24})})]}),d&&m.jsxs("div",{className:"mb-4 p-4 bg-red-50 text-red-700 rounded-lg flex items-center gap-2",children:[m.jsx(yc,{size:20}),d]}),s?m.jsxs("div",{className:"mb-4 p-4 bg-green-50 text-green-700 rounded-lg flex items-center gap-2",children:[m.jsx(fy,{size:20}),"Successfully imported ",a," books!"]}):null,e?m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[m.jsx("span",{children:"Importing..."}),m.jsxs("span",{children:[Math.round(r/a*100),"%"]})]}),m.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2.5 overflow-hidden",children:m.jsx("div",{className:"bg-[#262D40]/40 h-2.5 rounded-full transition-all duration-300",style:{width:`${r/a*100}%`}})}),m.jsxs("p",{className:"text-xs text-slate-400 text-center mt-2",children:[r," / ",a," books processed"]})]}):m.jsxs(m.Fragment,{children:[m.jsx("input",{type:"file",ref:p,onChange:x,accept:".json",className:"hidden"}),m.jsxs("button",{onClick:b,disabled:e,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white shadow-md hover:shadow-lg",children:[m.jsx(up,{size:20}),"Select JSON File"]})]})]})},PJ=({books:t})=>{const[e,n]=A.useState(!1),[r,i]=A.useState(!1),[a,o]=A.useState(null),s=()=>{try{n(!0),o(null),i(!1);const c=t.map(b=>({...b,id:b.id,type:b.type,title:b.title,author:b.author,status:b.status,readingStatus:b.readingStatus,tags:b.tags,highlights:b.highlights,addedAt:b.addedAt,generalNotes:b.generalNotes,coverUrl:b.coverUrl,isbn:b.isbn,publisher:b.publisher,publicationYear:b.publicationYear,translator:b.translator,code:b.code,url:b.url,lentTo:b.lentTo,lentDate:b.lentDate})),d=JSON.stringify(c,null,2),h=new Blob([d],{type:"application/json"}),p=URL.createObjectURL(h),x=document.createElement("a");x.href=p;const v=new Date().toISOString().split("T")[0];x.download=`tomehub-export-${v}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(p),i(!0),n(!1),setTimeout(()=>{i(!1)},3e3)}catch(c){console.error("Export failed:",c),o("Failed to export library. Please try again."),n(!1)}};return m.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 md:p-8 mt-6",children:[m.jsxs("div",{className:"flex items-start justify-between mb-4",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Export Library"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Download your entire library as a JSON file."})]}),m.jsx("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg",children:m.jsx(v4,{size:24})})]}),a&&m.jsxs("div",{className:"mb-4 p-4 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg flex items-center gap-2 border border-[#262D40]/8 dark:border-[#262D40]/30",children:[m.jsx(yc,{size:20}),a]}),r&&m.jsxs("div",{className:"mb-4 p-4 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 rounded-lg flex items-center gap-2 border border-orange-100 dark:border-orange-900/30",children:[m.jsx(fy,{size:20}),"Successfully exported ",t.length," items!"]}),m.jsxs("button",{onClick:s,disabled:e||t.length===0,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#CC561E] dark:bg-[#CC561E] hover:bg-[#b34b1a] text-white shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(lM,{size:20}),t.length===0?"No Items to Export":`Export ${t.length} Items`]}),m.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 text-center mt-3",children:"Exports all books, articles, websites, and notes with highlights"})]})},BJ=({userId:t,email:e,onLogout:n,onBack:r,books:i,onStartEnrichment:a,onStopEnrichment:o,isEnriching:s,enrichmentStats:c})=>{const d=i.filter(h=>h.type==="BOOK"&&(!h.generalNotes||h.generalNotes.length<10)&&(!h.tags||h.tags.length===0)).length;return m.jsxs("div",{className:"p-6 md:p-10 max-w-[1100px] w-full mx-auto animate-in fade-in slide-in-from-bottom-4",children:[m.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white mb-6 transition-colors group",children:[m.jsx(p4,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),m.jsx("span",{className:"font-medium",children:"Back"})]}),m.jsxs("div",{className:"mb-8",children:[m.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Profile"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Manage your account settings"})]}),m.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden mb-8",children:[m.jsxs("div",{className:"p-6 md:p-8 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-start md:items-center gap-6",children:[m.jsx("div",{className:"w-20 h-20 bg-[#262D40]/8 dark:bg-[#262D40]/30 rounded-full flex items-center justify-center text-[#262D40] dark:text-[#262D40]/82",children:m.jsx(hy,{size:40})}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Account Information"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Signed in as"}),m.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-slate-200 mt-1",children:e||"No email available"})]})]}),m.jsx("div",{className:"p-6 md:p-8 bg-slate-50/50 dark:bg-slate-900/50",children:m.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30",children:[m.jsx(XM,{size:20}),"Log Out"]})})]}),m.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-purple-50 dark:from-[#262D40]/20 dark:to-purple-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:m.jsxs("div",{className:"p-6 md:p-8",children:[m.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[m.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:m.jsx(Qa,{size:24})}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"AI Library Assistant"}),m.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Automatically fill in missing summaries and tags for your imported books."})]})]}),m.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[m.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:s?"Enrichment in Progress...":"Library Status"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:s?m.jsxs("span",{children:["Processing: ",m.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:c.currentBookTitle||"Initializing..."})]}):m.jsxs("span",{children:[m.jsx("span",{className:"font-bold text-[#262D40] dark:text-[#262D40]/82",children:d})," books are missing details."]})})]}),s?m.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30 shadow-sm",children:[m.jsx(IR,{size:18,fill:"currentColor"}),"Stop"]}):m.jsxs("button",{onClick:()=>a(i),disabled:d===0,className:"flex items-center gap-2 px-6 py-3 bg-[#262D40]/40 dark:bg-[#262D40]/30 text-white hover:bg-[#262D40]/55 dark:hover:bg-[#262D40]/40 rounded-lg font-medium transition-colors shadow-md shadow-[#262D40]/12 dark:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(w4,{size:18,fill:"currentColor"}),"Auto-fill Missing Info"]})]}),s&&m.jsxs("div",{className:"mt-6",children:[m.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[m.jsx("span",{children:"Progress"}),m.jsxs("span",{children:[Math.round(c.processed/c.total*100),"%"]})]}),m.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:m.jsx("div",{className:"h-full bg-[#262D40]/30 dark:bg-[#262D40]/24 transition-all duration-500 ease-out",style:{width:`${c.processed/c.total*100}%`}})}),m.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[m.jsxs("span",{children:["Processed: ",c.processed,"/",c.total]}),m.jsxs("span",{children:["Success: ",c.success,"  Failed: ",c.failed]})]})]})]})]})}),m.jsx(LJ,{books:i,userId:t}),m.jsx(jJ,{}),m.jsx(PJ,{books:i})]})},FJ=({data:t,onBarClick:e,currentStartPage:n,currentEndPage:r})=>{const{maxPage:i,maxCount:a,bars:o}=A.useMemo(()=>{if(!t||t.length===0)return{maxPage:0,maxCount:0,bars:[]};const s=Math.max(...t.map(d=>d.page_number)),c=Math.max(...t.map(d=>d.count));return{maxPage:s,maxCount:c,bars:t}},[t]);return o.length===0?null:m.jsxs("div",{className:"w-full space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-mono uppercase tracking-wider",children:[m.jsx("span",{children:"Page 1"}),m.jsx("span",{children:"Distribution Timeline"}),m.jsxs("span",{children:["Page ",i]})]}),m.jsxs("div",{className:"relative w-full h-[60px] bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden flex items-end",children:[m.jsxs("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none p-[1px]",children:[m.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"}),m.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"})]}),o.map(s=>{const c=(s.page_number-1)/i*100,d=s.count/a*100,h=s.count>a*.7;return m.jsxs("div",{onClick:()=>e&&e(s.page_number),className:"absolute bottom-0 cursor-pointer transition-all hover:opacity-80 group",style:{left:`${c}%`,height:`${d}%`,width:`max(2px, ${100/i}%)`,minHeight:"4px"},children:[m.jsx("div",{className:`w-full h-full rounded-t-sm ${h?"bg-[#262D40]/30 dark:bg-[#262D40]/24":"bg-[#262D40]/18 dark:bg-[#262D40]/40"}`}),m.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block z-20 whitespace-nowrap",children:m.jsxs("div",{className:"bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg",children:["Page ",s.page_number,": ",s.count," hits"]})})]},s.page_number)})]})]})},_T=({bookId:t,term:e,initialContexts:n=[],firebaseUid:r,onClose:i})=>{const[a,o]=Qe.useState(n||[]),[s,c]=Qe.useState(!1),[d,h]=Qe.useState((a==null?void 0:a.length)||0),[p,x]=Qe.useState(((a==null?void 0:a.length)||0)>=10),[v,b]=Qe.useState([]);A.useEffect(()=>{(async()=>{try{const N=await Kq(r,t,e);b(N.distribution||[])}catch(N){console.error("Dist fetch failed",N)}})()},[t,e,r]);const C=async()=>{if(!s){c(!0);try{const S=await Xq(r,t,e,50,d);S.contexts.length>0?(o(N=>[...N,...S.contexts]),h(N=>N+S.contexts.length)):x(!1)}catch(S){console.error("Failed to load more contexts:",S)}finally{c(!1)}}},E=(S,N)=>{if(!N)return S;const k=S.split(new RegExp(`(${N})`,"gi"));return m.jsx(m.Fragment,{children:k.map((I,D)=>I.toLowerCase()===N.toLowerCase()?m.jsx("mark",{className:"bg-yellow-200 text-slate-900 font-semibold rounded-sm px-0.5",children:I},D):I)})};return m.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-950 border-l border-slate-200 dark:border-slate-800 shadow-xl animate-in slide-in-from-right duration-300",children:[m.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-900 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:['"',e,'" Balamlar']}),m.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total occurrences found"})]}),m.jsx("button",{onClick:i,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-500",children:m.jsx(ta,{size:20})})]}),m.jsxs("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 m-4 rounded-lg border border-[#262D40]/8 dark:border-[#262D40]/70 flex gap-3 text-xs text-[#262D40] dark:text-[#262D40]/78",children:[m.jsx(MM,{size:16,className:"shrink-0 mt-0.5"}),m.jsx("p",{children:"Bu liste, kelimenin kitaptaki farkl formlarn (ekim ekleri, kk formlar) ve getii orijinal pasajlar gsterir."})]}),m.jsx("div",{className:"px-4 pb-2",children:m.jsx(FJ,{data:v})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[a.map((S,N)=>m.jsxs("div",{className:"group relative",children:[m.jsxs("div",{className:"flex justify-between items-start mb-1 text-[10px] items-center",children:[m.jsxs("span",{className:"font-semibold text-[#262D40] dark:text-[#262D40]/82 bg-[#262D40]/5 dark:bg-[#262D40]/40 px-1.5 py-0.5 rounded uppercase tracking-wider",children:["Sayfa ",S.page_number]}),m.jsxs("button",{className:"text-slate-300 group-hover:text-slate-500 dark:text-slate-700 dark:group-hover:text-slate-400 flex items-center gap-1 transition-colors",children:[m.jsx("span",{className:"text-[9px]",children:"GRNTLE"}),m.jsx(_0,{size:10})]})]}),m.jsx("div",{className:"text-sm md:text-base text-slate-700 dark:text-slate-300 leading-relaxed font-lora border-l-2 border-slate-100 dark:border-slate-800 pl-4 py-1 italic hover:border-[#262D40]/18 dark:hover:border-[#262D40]/55 transition-colors",children:E(S.snippet,S.keyword_found)})]},N)),p&&m.jsx("button",{onClick:C,disabled:s,className:"w-full py-4 text-sm font-medium text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-xl hover:border-[#262D40]/12 dark:hover:border-[#262D40]/70 hover:bg-slate-50 dark:hover:bg-slate-900 transition-all flex items-center justify-center gap-2",children:s?m.jsxs(m.Fragment,{children:[m.jsx(kn,{size:16,className:"animate-spin"}),"Ykleniyor..."]}):"Daha Fazla Balam Ykle"})]})]})},zJ=new Set(["ve","veya","ile","ama","fakat","ancak","lakin","ki","de","da","gibi","icin","iin","gore","gre","kadar","hem","ya","yada","yahut","mi","mu","m","m"]);function UJ({userId:t,onBack:e,books:n=[]}){const[r,i]=A.useState(""),[a,o]=A.useState([]),[s,c]=A.useState(!1),[d,h]=A.useState(null),[p,x]=A.useState(!1),[v,b]=A.useState(null),[C,E]=A.useState(!1),[S,N]=A.useState(0),[k,I]=A.useState(0),D=20,L=(j,U)=>{if(!U||!j)return j;const fe={i:"[iI]",:"[iI]",s:"[sS]",:"[sS]",c:"[cC]",:"[cC]",g:"[gG]",:"[gG]",o:"[oO]",:"[oO]",u:"[uU]",:"[uU]"},le=U.toLowerCase().split(/\s+/).map(q=>q.trim()).filter(q=>q.length>=2&&!zJ.has(q));if(le.length===0)return j;try{const q=le.map(xe=>xe.split("").map(H=>fe[H]||H).join("")),de=new RegExp(`((?<![\\p{L}\\p{N}])(?:${q.join("|")})[\\p{L}\\p{N}]*(?![\\p{L}\\p{N}]))`,"giu");return j.split(de).map((xe,H)=>H%2===1?m.jsx("mark",{className:"bg-[rgba(204,86,30,0.12)] dark:bg-[rgba(204,86,30,0.25)] text-[#111827] dark:text-white px-0.5 rounded font-medium shadow-sm transition-colors duration-200",children:xe},H):m.jsx("span",{children:xe},H))}catch{return j}},O=async(j,U=0)=>{var fe,le,q;if(j&&j.preventDefault(),!!r.trim()){c(!0),h(null),U===0&&(o([]),x(!0)),N(U);try{const de=`${ct}/api/smart-search`;console.log("[SmartSearch] Calling:",de,"Offset:",U);const ge=await nn(de,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:r,firebase_uid:t,limit:D,offset:U})});if(!ge.ok)throw new Error(await ia(ge,"Search failed"));const xe=await ge.json();((fe=xe.metadata)==null?void 0:fe.status)==="analytic"&&((le=xe.metadata)!=null&&le.analytics)?(b({...xe.metadata.analytics,answer:xe.answer}),o([]),I(0)):(o(xe.results||[]),I(xe.total||((q=xe.results)==null?void 0:q.length)||0),b(null))}catch(de){console.error("[SmartSearch] Error:",de),h(cc(de))}finally{c(!1)}}};return m.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${p?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[m.jsxs("div",{className:"relative flex items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[m.jsx("div",{className:"flex-shrink-0 z-10",children:e&&m.jsxs("button",{onClick:e,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(Qo,{size:16})}),m.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),p&&m.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[m.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:m.jsx(vp,{className:"w-5 h-5 md:w-8 md:h-8"})}),m.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"Search"})]}),m.jsx("div",{className:"w-20 hidden sm:block"})," "]}),m.jsx("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${p?"pt-4 md:pt-6":"justify-center items-center"}`,children:m.jsxs("form",{onSubmit:O,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${p?"max-w-none":"max-w-2xl text-center"}`,children:[!p&&m.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[m.jsxs("div",{className:"flex items-center justify-center gap-3",children:[m.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0",children:m.jsx(vp,{className:"w-6 h-6 md:w-10 md:h-10"})}),m.jsx("h1",{className:"text-2xl md:text-5xl font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight",children:"Search"})]}),m.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 md:gap-4 mt-4 opacity-80",children:[m.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[m.jsx(Qa,{className:"w-3 h-3 text-[#CC561E]"})," AI Query Expansion"]}),m.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[m.jsx(GR,{className:"w-3 h-3"})," Typo Correction"]}),m.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[m.jsx(Zs,{className:"w-3 h-3"})," Hybrid Retrieval"]})]})]}),m.jsxs("div",{className:"relative group",children:[m.jsx(Ka,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),m.jsx("input",{type:"text",value:r,onChange:j=>i(j.target.value),placeholder:"Search your library intelligently...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400"})]}),m.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${p?"text-left":"text-center"}`,children:["Tip: ",m.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search."]})]})}),d&&m.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/78 p-5 rounded-2xl flex items-center gap-4 border border-[#262D40]/8 dark:border-[#262D40]/50 shadow-sm",children:[m.jsx(yc,{className:"w-6 h-6 shrink-0"}),m.jsx("p",{className:"font-medium",children:d})]}),m.jsx("div",{className:"space-y-6 pb-12 mt-6",children:a.length>0?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"flex items-center justify-between px-2",children:m.jsxs("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider",children:["Found ",k," relevant items"]})}),m.jsx("div",{className:"grid gap-5",children:a.map((j,U)=>m.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 border border-[#E6EAF2] dark:border-gray-700 transition-all duration-300",children:[m.jsxs("div",{className:"flex justify-between items-start mb-4",children:[m.jsxs("h3",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 flex items-center gap-3 group-hover:text-[#CC561E] transition-colors",children:[m.jsx(Zs,{className:"w-5 h-5 text-[#CC561E]"}),L(j.title,r)]}),m.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[j.match_type==="content_exact"&&m.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Match"}),j.match_type==="semantic"&&m.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Semantic"}),m.jsxs("span",{className:"bg-[#262D40] text-white text-xs px-3 py-1 rounded-full font-mono font-medium ring-1 ring-white/10",children:["p.",j.page_number]})]})]}),m.jsx("div",{className:"pl-5 border-l-4 border-[#262D40]/10 group-hover:border-[#CC561E]/30 transition-colors",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-200 leading-relaxed text-base whitespace-pre-wrap font-serif",children:L(j.content_chunk,r)})}),(j.comment||j.personal_comment)&&m.jsxs("div",{className:"mt-4 pt-4 border-t border-[#E6EAF2] dark:border-gray-700 bg-[rgba(204,86,30,0.08)] dark:bg-[rgba(204,86,30,0.1)] -mx-6 px-6 py-4 rounded-b-2xl",children:[m.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#CC561E] block mb-1",children:"Comment:"}),m.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 italic border-l-2 border-[#CC561E]/30 pl-3",children:L(j.comment||j.personal_comment||"",r)})]})]},U))}),k>D&&m.jsxs("div",{className:"flex items-center justify-between mt-10 pt-6 border-t border-[#E6EAF2] dark:border-gray-700",children:[m.jsxs("button",{onClick:()=>O(void 0,Math.max(0,S-D)),disabled:s||S===0,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:[m.jsx(Qo,{size:20}),"Previous"]}),m.jsxs("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:["Page ",Math.floor(S/D)+1," of ",Math.ceil(k/D)]}),m.jsxs("button",{onClick:()=>O(void 0,S+D),disabled:s||S+D>=k,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:["Next",m.jsx(Qo,{size:20,className:"rotate-180"})]})]})]}):p&&!s&&!d?m.jsxs("div",{className:"text-center py-24 opacity-60",children:[m.jsx("div",{className:"bg-[#F3F5FA] dark:bg-gray-800 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6",children:m.jsx(Ka,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),m.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"No results found"})]}):null}),v&&m.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-xl border-t-4 border-[#CC561E] animate-in zoom-in duration-300 relative overflow-hidden",children:[m.jsx("div",{className:"absolute right-[-20px] top-[-20px] opacity-[0.03] dark:opacity-[0.05] pointer-events-none",children:m.jsx(mM,{size:220})}),m.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] text-xs font-bold uppercase tracking-widest",children:[m.jsx(Qa,{size:12}),"Deterministic Analytics"]}),m.jsx("h3",{className:"text-3xl font-extrabold text-slate-900 dark:text-white leading-tight",children:v.answer})]}),v.contexts&&v.contexts.length>0&&m.jsxs("button",{onClick:()=>E(!0),className:"group flex items-center gap-3 bg-[#CC561E] hover:bg-[#b34b1a] text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-[#CC561E]/30 transition-all hover:scale-[1.02] active:scale-[0.98]",children:[m.jsx(y4,{size:20,className:"group-hover:rotate-12 transition-transform"}),"See Contexts"]})]})]}),C&&v&&m.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[m.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>E(!1)}),m.jsx("div",{className:"relative w-full max-w-lg h-full overflow-hidden",children:m.jsx(_T,{bookId:v.resolved_book_id||"",term:v.term,initialContexts:v.contexts,firebaseUid:t,onClose:()=>E(!1)})})]})]})}const HJ=(t,e)=>{const[n,r]=A.useState(!1),[i,a]=A.useState({total:0,processed:0,success:0,failed:0}),o=A.useRef(!1),s=A.useCallback(async d=>{const h=d.filter(x=>x.type==="BOOK"&&(!(x.summaryText||x.generalNotes)||(x.summaryText||x.generalNotes||"").length<10)&&(!x.tags||x.tags.length===0));if(h.length===0){alert("No books found that need enrichment!");return}r(!0),o.current=!1,a({total:h.length,processed:0,success:0,failed:0,currentBookTitle:""});const p=5;for(let x=0;x<h.length&&!o.current;x+=p){const v=h.slice(x,x+p),b=v.map(C=>C.title).join(", ");a(C=>({...C,currentBookTitle:`Batch: ${b.substring(0,30)}...`}));try{x>0&&await new Promise(S=>setTimeout(S,2e3));const C=v.map(S=>r1(S)),E=await mT(C);for(let S=0;S<v.length;S++){const N=v[S],k=E.find(I=>I.title===N.title)||E[S];if(k){const I=i1(N,k);await w0(t,I),e(I),a(D=>({...D,processed:D.processed+1,success:D.success+1}))}else a(I=>({...I,processed:I.processed+1,failed:I.failed+1}))}}catch(C){console.error(`Failed to enrich batch starting at ${x}:`,C),a(E=>({...E,processed:E.processed+v.length,failed:E.failed+v.length}))}}r(!1),a(x=>({...x,currentBookTitle:void 0}))},[t,e]),c=A.useCallback(()=>{o.current=!0},[]);return{isEnriching:n,stats:i,startEnrichment:s,stopEnrichment:c}},VJ=({state:t})=>{const[e,n]=A.useState(!1);return!t.active_topic&&(!t.assumptions||t.assumptions.length===0)?null:m.jsx("div",{className:"sticky top-0 z-10 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border-b border-[#CC561E]/10 dark:border-slate-700 shadow-sm transition-all",children:m.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-2 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>n(!e),children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[m.jsx("div",{className:"p-1.5 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-md flex-shrink-0",children:m.jsx(x4,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),m.jsxs("div",{className:"min-w-0",children:[m.jsx("p",{className:"text-[10px] font-bold text-[#CC561E] dark:text-[#f3a47b] uppercase tracking-widest",children:"Current Topic"}),m.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:t.active_topic||"Initializing exploration..."})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[t.assumptions&&t.assumptions.length>0&&m.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 text-xs px-2 py-1 rounded-full bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border border-amber-100 dark:border-amber-800/50",children:[m.jsx(Ko,{className:"w-3 h-3"}),t.assumptions.length," Assumptions"]}),e?m.jsx(g4,{className:"w-4 h-4 text-slate-400"}):m.jsx($s,{className:"w-4 h-4 text-slate-400"})]})]}),e&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-700 space-y-4 pb-2 animate-fade-in-down",children:[t.assumptions&&t.assumptions.length>0&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[m.jsx(Ko,{className:"w-3 h-3"})," Working Assumptions"]}),m.jsx("div",{className:"grid gap-2",children:t.assumptions.map((r,i)=>m.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 bg-amber-50/50 dark:bg-amber-900/10 p-2 rounded border-l-2 border-amber-400",children:[r.text,m.jsxs("span",{className:"ml-2 text-xs text-amber-600 dark:text-amber-500 font-medium opacity-75",children:["(",r.confidence,")"]})]},i))})]}),t.open_questions&&t.open_questions.length>0&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[m.jsx(ZD,{className:"w-3 h-3"})," Open Questions"]}),m.jsx("ul",{className:"space-y-1",children:t.open_questions.map((r,i)=>m.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[m.jsx("span",{className:"text-slate-400 mt-1.5",children:""}),r]},i))})]}),t.established_facts&&t.established_facts.length>0&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[m.jsx(vd,{className:"w-3 h-3"})," Validated Facts"]}),m.jsx("ul",{className:"space-y-1",children:t.established_facts.map((r,i)=>m.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[m.jsx(vd,{className:"w-3 h-3 text-green-500 mt-0.5 flex-shrink-0"}),m.jsxs("span",{children:[r.text,m.jsxs("span",{className:"ml-1 text-xs text-slate-400",children:["[",r.source,"]"]})]})]},i))})]})]})]})})},$J=({userId:t,onBack:e})=>{var H,ie,K,B,G,M,V,Z,re,_e,J,we;const[n,r]=A.useState([]),[i,a]=A.useState(""),[o,s]=A.useState(!1),[c,d]=A.useState(null),[h,p]=A.useState(null),[x,v]=A.useState(new Set),[b,C]=A.useState(new Set),[E,S]=A.useState(null),[N,k]=A.useState("AUTO"),[I,D]=A.useState({}),L=A.useRef(null),O=A.useRef(null);A.useEffect(()=>{var z;(z=L.current)==null||z.scrollIntoView({behavior:"smooth"})},[n]),A.useEffect(()=>{var z;(z=O.current)==null||z.focus()},[]);const j=async()=>{var ae;if(!i.trim()||o)return;if(!t||t.includes("@")){p("Authentication error. Please refresh the page.");return}const z={id:Date.now(),role:"user",content:i.trim(),timestamp:new Date().toISOString()};r(ce=>[...ce,z]),a(""),s(!0),p(null);try{const ce=await Hq(z.content,t,c,"EXPLORER",null,20,N);ce.session_id&&d(ce.session_id),ce.conversation_state&&D(ce.conversation_state);const Te={id:Date.now()+1,role:"assistant",content:ce.answer||"",sources:ce.sources||[],thinkingHistory:ce.thinking_history||[],timestamp:ce.timestamp||new Date().toISOString()};r(Le=>[...Le,Te])}catch(ce){p(ce instanceof Error?ce.message:"Failed to send message")}finally{s(!1),(ae=O.current)==null||ae.focus()}},U=z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),j())},fe=z=>{C(ae=>{const ce=new Set(ae);return ce.has(z)?ce.delete(z):ce.add(z),ce})},le=z=>{v(ae=>{const ce=new Set(ae);return ce.has(z)?ce.delete(z):ce.add(z),ce})},q=()=>{var z;r([]),d(null),p(null),D({}),(z=O.current)==null||z.focus()},de=z=>z.replace(/\[DNCE SREC\][\s\S]*?\[\/DNCE SREC\]/,"").replace(/## AAMA 0:[\s\S]*?(?=##)/,"").trim(),ge=(z,ae,ce)=>ae?z.split(/(\[ID: \d+\])/g).map((Le,ot)=>{const Ke=Le.match(/\[ID: (\d+)\]/);if(Ke){const ht=parseInt(Ke[1]);if(ae.find(Me=>Me.id===ht))return m.jsx("button",{onMouseEnter:Me=>{const We=Me.currentTarget.getBoundingClientRect();S({id:ht,messageId:ce||0,x:We.left,y:We.top-10})},onMouseLeave:()=>S(null),className:"inline-flex items-center justify-center w-5 h-5 mx-0.5 text-[10px] font-bold bg-[#CC561E]/10 dark:bg-[#CC561E]/20 text-[#CC561E] dark:text-[#f3a47b] rounded-md border border-[#CC561E]/20 dark:border-[#CC561E]/30 hover:bg-[#CC561E] hover:text-white transition-all transform hover:-translate-y-0.5 cursor-help",children:ht},ot)}return Le}):z,xe=(z,ae,ce)=>{const Te=de(z);let Le=!1;return Te.split(`
`).map((ot,Ke)=>{const ht=ot.trim();if(ht.toLowerCase().includes("keif nerileri")||ht.toLowerCase().includes("exploration paths"))return Le=!0,m.jsxs("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 mt-6 mb-3 flex items-center gap-2",children:[m.jsx(x4,{className:"w-4 h-4 text-[#CC561E]"}),ht]},Ke);if(ht.startsWith("## ")||ht.startsWith("### ")&&!Le)return m.jsx("h3",{className:"text-base font-bold text-[#CC561E] dark:text-[#f3a47b] mt-5 mb-2",children:ht.replace(/^#+\s+/,"")},Ke);if(ht==="")return m.jsx("div",{className:"h-2"},Ke);if(Le&&(ht.startsWith("-")||ht.startsWith("")||/^\d+\./.test(ht))){const Ut=ht.replace(/^[-\d.]+\s+/,"");return m.jsx("div",{onClick:()=>{o||a(Ut)},className:"ml-2 mb-2 p-3 bg-white dark:bg-slate-800/50 border border-[#CC561E]/10 dark:border-[#CC561E]/20 rounded-xl shadow-sm hover:shadow-md hover:border-[#CC561E]/40 dark:hover:border-[#CC561E]/60 transition-all cursor-pointer group active:scale-[0.98]",children:m.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-200 flex items-center gap-3",children:[m.jsxs("span",{className:"w-6 h-6 flex-shrink-0 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full flex items-center justify-center text-[10px] font-bold text-[#CC561E] group-hover:bg-[#CC561E] group-hover:text-white transition-colors",children:[Ke-10," "]}),Ut]})},Ke)}else return m.jsx("p",{className:`text-sm leading-relaxed mb-2 ${Le?"text-slate-500 dark:text-slate-400 italic":"text-slate-700 dark:text-slate-300"}`,children:ge(ot,ae,ce)},Ke)})};return m.jsx("div",{className:"flex h-[calc(100vh-120px)] w-full gap-4",children:m.jsxs("div",{className:"flex flex-col flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-t-xl",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"p-2 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-lg",children:m.jsx(Wx,{className:"w-5 h-5 text-[#CC561E] dark:text-[#f3a47b]"})}),m.jsxs("div",{children:[m.jsx("h2",{className:"font-semibold text-slate-900 dark:text-white",children:"Explorer Mode"}),m.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:c?`Session #${c}  ${n.length} messages`:"New conversation"})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("label",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-slate-200 dark:border-slate-700 text-xs text-slate-600 dark:text-slate-300 bg-slate-50 dark:bg-slate-800",children:[m.jsx("input",{type:"checkbox",checked:N==="BOOK_FIRST",onChange:z=>k(z.target.checked?"BOOK_FIRST":"AUTO"),className:"w-3.5 h-3.5 rounded border-slate-300 text-[#CC561E] focus:ring-[#CC561E]/40","aria-label":"Bu kitapla snrla"}),"Bu kitapla snrla"]}),m.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Start new conversation",children:[m.jsx(C4,{className:"w-4 h-4"}),"New"]}),e&&m.jsx("button",{onClick:e,className:"px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Back"})]})]}),m.jsx(VJ,{state:I}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 dark:bg-slate-900",children:[n.length===0&&!o&&m.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[m.jsx("div",{className:"p-4 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full mb-4",children:m.jsx(Zs,{className:"w-8 h-8 text-[#CC561E] dark:text-[#f3a47b]"})}),m.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"Explorer Mode"}),m.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-md",children:"Ask deep, philosophical questions. I'll analyze your notes dialectically, identify gaps, and expand with general knowledge when needed."}),m.jsx("div",{className:"mt-6 space-y-2",children:["What is the relationship between consciousness and reality?","How do different philosophers define virtue?","Analyze the concept of free will in my notes"].map((z,ae)=>m.jsx("button",{onClick:()=>a(z),className:"block w-full text-left px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300 hover:bg-[#CC561E]/5 dark:hover:bg-[#CC561E]/10 transition-colors",children:z},ae))})]}),n.map(z=>m.jsxs("div",{className:`flex gap-3 ${z.role==="user"?"justify-end":"justify-start"}`,children:[z.role==="assistant"&&m.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:m.jsx(FE,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),m.jsxs("div",{className:`max-w-[80%] ${z.role==="user"?"order-first":""}`,children:[z.role==="assistant"&&z.thinkingHistory&&z.thinkingHistory.length>0&&m.jsxs("div",{className:"mb-2",children:[m.jsxs("button",{onClick:()=>fe(z.id),className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-400 hover:text-[#CC561E] transition-colors",children:[m.jsx(zD,{className:"w-3 h-3"}),b.has(z.id)?"Hide Reflection":"Show Reflection",m.jsxs("span",{className:"opacity-50",children:[" ",z.thinkingHistory.length," Iterations"]})]}),b.has(z.id)&&m.jsx("div",{className:"mt-2 mb-3 space-y-3 bg-slate-100/50 dark:bg-slate-800/50 p-3 rounded-xl border border-dashed border-slate-200 dark:border-slate-700 animate-fade-in",children:z.thinkingHistory.map((ae,ce)=>m.jsxs("div",{className:"space-y-1",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ae.evaluation.verdict==="PASSED"?"bg-green-500":ae.evaluation.verdict==="DECLINE"?"bg-red-500":"bg-amber-500"}`}),m.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:["STEP ",ae.attempt,": ",ae.evaluation.verdict]})]}),m.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:[m.jsx(EM,{className:"w-2.5 h-2.5"}),(ae.latency/1e3).toFixed(1),"s"]})]}),m.jsx("div",{className:"h-1 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:m.jsx("div",{className:`h-full transition-all duration-1000 ${ae.evaluation.overall_score>.7?"bg-green-500":ae.evaluation.overall_score>.4?"bg-amber-500":"bg-red-500"}`,style:{width:`${ae.evaluation.overall_score*100}%`}})}),m.jsx("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-snug",children:ae.evaluation.explanation})]},ce))})]}),m.jsx("div",{className:`rounded-2xl px-4 py-3 ${z.role==="user"?"bg-[#CC561E] text-white rounded-br-md shadow-lg shadow-[#CC561E]/20":"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-bl-md"}`,children:z.role==="user"?m.jsx("p",{className:"text-sm",children:z.content}):m.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:xe(z.content,z.sources,z.id)})}),z.role==="assistant"&&z.sources&&z.sources.length>0&&m.jsxs("div",{className:"mt-2",children:[m.jsxs("button",{onClick:()=>le(z.id),className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] transition-colors",children:[x.has(z.id)?m.jsx(g4,{className:"w-3 h-3"}):m.jsx($s,{className:"w-3 h-3"}),z.sources.length," sources"]}),x.has(z.id)&&m.jsx("div",{className:"mt-2 space-y-1 pl-2 border-l-2 border-[#CC561E]/30 dark:border-[#CC561E]/50",children:z.sources.map((ae,ce)=>m.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 py-1 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800/50 rounded px-1",children:[m.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[9px] font-bold",children:ae.id||ce+1}),m.jsx("span",{className:"font-medium",children:ae.title}),m.jsxs("span",{className:"ml-2 text-slate-400 text-[10px]",children:["p.",ae.page_number]})]},ce))})]})]}),z.role==="user"&&m.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E] flex items-center justify-center",children:m.jsx(hy,{className:"w-4 h-4 text-white"})})]},z.id)),E&&m.jsx("div",{className:"fixed z-50 pointer-events-none",style:{left:E.x,top:E.y-120},children:m.jsxs("div",{className:"w-64 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl p-4 animate-in fade-in zoom-in duration-200 origin-bottom",children:[(ie=(H=n.find(z=>z.id===E.messageId))==null?void 0:H.sources)!=null&&ie.find(z=>z.id===E.id)?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2 text-[#CC561E]",children:[m.jsx(yd,{className:"w-3 h-3"}),m.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Source Snippet"})]}),m.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-300 leading-relaxed italic mb-3",children:['"...',(M=(G=(B=(K=n.find(z=>z.id===E.messageId))==null?void 0:K.sources)==null?void 0:B.find(z=>z.id===E.id))==null?void 0:G.content)==null?void 0:M.slice(0,200),'..."']}),m.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 dark:border-slate-700 pt-2 text-[10px] text-slate-400",children:[m.jsx("span",{className:"font-medium truncate max-w-[120px]",children:(re=(Z=(V=n.find(z=>z.id===E.messageId))==null?void 0:V.sources)==null?void 0:Z.find(z=>z.id===E.id))==null?void 0:re.title}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(_0,{className:"w-2.5 h-2.5"}),"p.",(we=(J=(_e=n.find(z=>z.id===E.messageId))==null?void 0:_e.sources)==null?void 0:J.find(z=>z.id===E.id))==null?void 0:we.page_number]})]})]}):m.jsx("p",{className:"text-xs text-slate-400",children:"Loading source info..."}),m.jsx("div",{className:"absolute -bottom-1 left-4 w-2 h-2 bg-white dark:bg-slate-800 border-r border-b border-slate-200 dark:border-slate-700 rotate-45"})]})}),o&&m.jsxs("div",{className:"flex gap-3",children:[m.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:m.jsx(FE,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),m.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:m.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[m.jsx(kn,{className:"w-4 h-4 animate-spin"}),"Analyzing deeply..."]})})]}),h&&m.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-300",children:h}),m.jsx("div",{ref:L})]}),m.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-b-xl",children:m.jsxs("div",{className:"flex gap-3",children:[m.jsx("input",{ref:O,type:"text",value:i,onChange:z=>a(z.target.value),onKeyPress:U,placeholder:"Ask a deep question...",disabled:o,className:"flex-1 px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#CC561E] focus:border-transparent disabled:opacity-50"}),m.jsx("button",{onClick:j,disabled:!i.trim()||o,className:"px-4 py-3 bg-[#CC561E] hover:bg-[#b34b1a] disabled:bg-slate-300 dark:disabled:bg-slate-800 disabled:text-slate-500 dark:disabled:text-slate-500 disabled:opacity-50 text-white rounded-xl transition-all shadow-lg shadow-[#CC561E]/20 flex items-center gap-2",children:o?m.jsx(kn,{className:"w-5 h-5 animate-spin"}):m.jsx(wR,{className:"w-5 h-5"})})]})})]})})},GJ=({userId:t,userEmail:e,onBack:n,books:r=[]})=>{var le,q,de,ge;const[i,a]=A.useState(""),[o,s]=A.useState(!1),[c,d]=A.useState(null),[h,p]=A.useState(null),[x,v]=A.useState("none"),[b,C]=A.useState(!1),[E,S]=A.useState("STANDARD"),[N,k]=A.useState(""),[I,D]=A.useState(!1);if(E==="EXPLORER")return m.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-6 animate-fade-in space-y-4",children:[m.jsx("div",{className:"flex justify-start",children:m.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(Qo,{size:16})}),m.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]})}),m.jsx("div",{className:"flex justify-center mb-2 md:mb-4",children:m.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center",children:[m.jsx("button",{type:"button",onClick:()=>S("STANDARD"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-500 hover:text-slate-700 dark:text-slate-400",children:"Standard"}),m.jsxs("button",{type:"button",className:"px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:[m.jsx(Wx,{className:"w-4 h-4 text-[#CC561E]"})," Explorer"]})]})}),m.jsx($J,{userId:t,onBack:()=>S("STANDARD")})]});const L=async xe=>{if(xe.preventDefault(),!i.trim()){p("Please enter a question");return}if(!t||t.includes("@")){p("Authentication is still loading. Please wait a moment and try again.");return}s(!0),p(null),d(null),v("none");try{const H=await Uq(i,t,"STANDARD");d(H),k(i)}catch(H){p(cc(H))}finally{s(!1)}},O=async xe=>{var H;if(!(!c||b)){C(!0);try{await Vq({firebase_uid:t,query:N||i,answer:c.answer,rating:xe,search_log_id:(H=c.metadata)==null?void 0:H.search_log_id}),v(xe===1?"liked":"disliked")}catch(ie){console.error("Feedback failed:",ie)}finally{C(!1)}}},j=(c==null?void 0:c.answer)||"",U=Array.from(j.matchAll(/<think>([\s\S]*?)<\/think>/gi)).map(xe=>(xe[1]||"").trim()).filter(Boolean).join(`

`),fe=j.replace(/<think>[\s\S]*?<\/think>/gi,"").replace(/## AAMA 0:[\s\S]*?(?=##|$)/i,"").trim();return m.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${c?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[m.jsxs("div",{className:"relative flex flex-row items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[m.jsx("div",{className:"flex items-center gap-3 md:gap-5 z-10",children:m.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(Qo,{size:16})}),m.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),c&&m.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[m.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:m.jsx(vp,{className:"w-5 h-5 md:w-8 md:h-8"})}),m.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"LogosChat"})]}),m.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center z-10",children:[m.jsx("button",{type:"button",className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:"Standard"}),m.jsxs("button",{type:"button",onClick:()=>S("EXPLORER"),className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all flex items-center gap-1.5 md:gap-2 text-slate-500 hover:text-slate-700 dark:text-slate-400",children:[m.jsx(Wx,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})," Explorer"]})]})]}),m.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${c?"pt-4 md:pt-6":"justify-center items-center"}`,children:[!c&&!o&&m.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-full pointer-events-none -z-10 animate-fade-in",children:[m.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-[#CC561E]/5 dark:bg-[#CC561E]/10 rounded-full blur-[80px] md:blur-[120px]"}),m.jsx("div",{className:"absolute top-1/3 left-1/4 w-[200px] h-[200px] bg-blue-500/5 dark:bg-blue-500/5 rounded-full blur-[100px]"})]}),m.jsxs("form",{onSubmit:L,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${c?"max-w-none":"max-w-2xl text-center"}`,children:[!c&&!o&&m.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[m.jsxs("div",{className:"flex items-center justify-center gap-3",children:[m.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-xl shrink-0",children:m.jsx(W4,{className:"w-5 h-5 md:w-8 md:h-8"})}),m.jsxs("h1",{className:"text-2xl md:text-4xl font-black text-slate-900 dark:text-white tracking-tight",children:["Logos",m.jsx("span",{className:"text-[#CC561E]",children:"Chat"})]})]}),m.jsx("p",{className:"text-sm md:text-base text-slate-500 dark:text-slate-400 max-w-lg mx-auto leading-relaxed",children:"Analyze your library with intelligence. Ask anything."})]}),m.jsxs("div",{className:"relative group flex items-center",children:[m.jsxs("div",{className:"relative flex-1 group",children:[m.jsx(Ka,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),m.jsx("input",{type:"text",value:i,onChange:xe=>a(xe.target.value),placeholder:"Type your question here...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400",disabled:o})]}),m.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"ml-2 md:ml-3 p-3.5 md:p-5 rounded-2xl bg-[#CC561E] text-white shadow-lg shadow-[#CC561E]/20 hover:bg-[#b04a1a] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed group/btn",children:o?m.jsx(kn,{className:"w-5 h-5 md:w-6 md:h-6 animate-spin"}):m.jsx(Ka,{className:"w-5 h-5 md:w-6 md:h-6 group-hover/btn:scale-110 transition-transform"})})]}),m.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${c?"text-left":"text-center"}`,children:["Tip: ",m.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search. Mention ",m.jsx("span",{className:"font-bold text-[#CC561E]",children:"@book"})," for focus."]})]})]}),h&&m.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 flex items-start gap-3",children:[m.jsx(yc,{className:"w-5 h-5 text-red-600 shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-red-900 dark:text-red-100",children:"Search Failed"}),m.jsx("p",{className:"text-sm text-red-700 mt-1",children:h})]})]}),c&&m.jsxs("div",{className:"space-y-4 md:space-y-6",children:[m.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[m.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[m.jsx(Zs,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Answer"]}),m.jsx("div",{className:"max-w-none",children:fe.split(`
`).map((xe,H)=>{const ie=xe.trim();return ie.startsWith("## ")?m.jsx("h3",{className:"text-base md:text-lg font-bold underline decoration-[#CC561E]/50 underline-offset-4 mt-2.5 md:mt-6 mb-1 md:mb-2.5 text-slate-900 dark:text-white",children:ie.replace(/^##\s+/,"")},H):ie===""?m.jsx("div",{className:"h-1 md:h-2"},H):m.jsx("p",{className:"text-justify text-[14px] md:text-base leading-[1.55] md:leading-relaxed text-slate-700 dark:text-slate-300 mb-1.5 md:mb-2",children:xe},H)})}),U&&m.jsxs("details",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900/40",children:[m.jsx("summary",{className:"cursor-pointer select-none px-3 md:px-4 py-2.5 text-xs md:text-sm font-medium text-slate-600 dark:text-slate-300",children:"Internal Notes (Optional)"}),m.jsx("div",{className:"px-3 md:px-4 pb-3 md:pb-4 border-t border-[#E6EAF2] dark:border-slate-700",children:m.jsx("pre",{className:"mt-3 whitespace-pre-wrap break-words text-xs md:text-sm leading-relaxed text-slate-600 dark:text-slate-300 font-sans",children:U})})]}),m.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2.5 md:gap-4 pt-2.5 md:pt-4 border-t border-[#E6EAF2] dark:border-slate-700",children:[m.jsxs("div",{className:"flex items-center gap-2.5 md:gap-4",children:[m.jsx("span",{className:"text-xs md:text-sm text-slate-500 dark:text-slate-400",children:"Was this answer helpful?"}),m.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[m.jsx("button",{onClick:()=>O(1),disabled:x!=="none"||b,className:`p-1.5 md:p-2 rounded-lg transition-colors ${x==="liked"?"bg-green-100 text-green-600":"text-slate-400 hover:text-green-600"}`,children:m.jsx(UR,{className:"w-4 h-4 md:w-5 md:h-5"})}),m.jsx("button",{onClick:()=>O(0),disabled:x!=="none"||b,className:`p-1.5 md:p-2 rounded-lg transition-colors ${x==="disliked"?"bg-red-100 text-red-600":"text-slate-400 hover:text-red-600"}`,children:m.jsx(FR,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),((le=c.metadata)==null?void 0:le.status)==="analytic"&&((de=(q=c.metadata)==null?void 0:q.analytics)==null?void 0:de.contexts)&&c.metadata.analytics.contexts.length>0&&m.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-1.5 md:gap-2 text-[#CC561E] hover:text-[#b34b1a] font-bold text-xs md:text-sm transition-colors py-1.5 md:py-2 px-2.5 md:px-3 hover:bg-orange-50 dark:hover:bg-orange-900/10 rounded-lg",children:[m.jsx(y4,{size:14,className:"md:w-4 md:h-4"}),"See Contexts"]})]})]}),c.sources&&c.sources.length>0&&m.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[m.jsxs("h3",{className:"text-base md:text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[m.jsx(_0,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Sources (",c.sources.length,")"]}),m.jsx("div",{className:"space-y-1.5 md:space-y-2",children:c.sources.map((xe,H)=>m.jsxs("div",{className:"flex items-start gap-2 md:gap-3 p-2 md:p-3 rounded-lg bg-[#F3F5FA] dark:bg-slate-700/50 hover:bg-[#F3F5FA] transition-colors",children:[m.jsx("div",{className:"flex-shrink-0 w-5 h-5 md:w-6 md:h-6 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] flex items-center justify-center text-xs md:text-sm font-medium",children:H+1}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"text-sm md:text-base font-medium text-slate-900 dark:text-white truncate",children:xe.title}),m.jsxs("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:["Page ",xe.page_number]})]})]},H))})]})]}),I&&((ge=c==null?void 0:c.metadata)==null?void 0:ge.analytics)&&m.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[m.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>D(!1)}),m.jsx("div",{className:"relative w-full max-w-2xl h-full bg-white dark:bg-gray-900 shadow-2xl flex flex-col",children:m.jsx(_T,{term:c.metadata.analytics.term,bookId:c.metadata.analytics.resolved_book_id,initialContexts:c.metadata.analytics.contexts,firebaseUid:t,onClose:()=>D(!1)})})]})]})},rf=async()=>{const e=D2().currentUser;if(!e)throw new Error("User must be logged in to use Knowledge Stream");return await e.getIdToken()},WJ=12e4,gd=new Map,Vx=new Map,NT=t=>{const e=t.anchor_type||"note",n=t.anchor_id||"",r=t.mode||"FOCUS",i=Number(t.horizon_value??.25).toFixed(2),a=(t.resource_type||"").toUpperCase(),o=(t.category||"").toUpperCase();return[t.firebase_uid,e,n,r,i,a,o].join("|")},kT=t=>t?Date.now()-t.createdAt<=WJ:!1;async function qJ(t){const e=NT(t),n=gd.get(e);if(kT(n))return;const r=Vx.get(e);if(r){await r;return}const i=(async()=>{const a=await TT(t);return gd.set(e,{response:a,createdAt:Date.now()}),a})();Vx.set(e,i);try{await i}finally{Vx.delete(e)}}function XJ(t){const e=NT(t),n=gd.get(e);return kT(n)?(gd.delete(e),n.response):(gd.delete(e),null)}async function TT(t){if(!t.firebase_uid)throw new Error("User must be authenticated");const e=await rf(),n=await fetch(`${ct}/api/flow/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to start flow session")}return n.json()}async function $x(t){const e=await rf(),n=await fetch(`${ct}/api/flow/next`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to get next batch")}return n.json()}async function KJ(t){const e=await rf(),n=await fetch(`${ct}/api/flow/feedback`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to send feedback")}return n.json()}async function YJ(t,e,n){const r=await rf(),i=await fetch(`${ct}/api/flow/adjust`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({session_id:t,horizon_value:e,firebase_uid:n})});if(!i.ok){const a=await i.json();throw new Error(a.detail||"Failed to adjust horizon")}return i.json()}async function W_(t,e,n,r,i,a){const o=await rf(),s=await fetch(`${ct}/api/flow/reset-anchor`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({session_id:t,anchor_type:e,anchor_id:n,firebase_uid:r,resource_type:i,category:a})});if(!s.ok){const c=await s.json();throw new Error(c.detail||"Failed to reset anchor")}return s.json()}const q_={1:{color:"#CC561E",label:"Tight Context",icon:""},2:{color:"#e66a2e",label:"Author's Mind",icon:""},3:{color:"#b34b1a",label:"Syntopic Debate",icon:""},4:{color:"#CC561E",label:"Keif Kprs",icon:""}},ZJ=({card:t,sessionId:e,firebaseUid:n,onFeedback:r})=>{const[i,a]=A.useState(!1),[o,s]=A.useState(null),c=q_[t.zone]||q_[1],d=async h=>{try{await KJ({firebase_uid:n,session_id:e,chunk_id:t.chunk_id,action:h}),s(h),r==null||r(h)}catch(p){console.error("Feedback failed:",p)}};return m.jsxs("div",{className:"flow-card",style:{"--zone-color":c.color},children:[m.jsxs("div",{className:"flow-card__top-bar",children:[m.jsxs("div",{className:"flow-card__zone-indicator",children:[m.jsx("span",{className:"zone-dot",style:{backgroundColor:c.color}}),m.jsx("span",{className:"zone-label",children:c.label})]}),t.page_number!==void 0&&t.page_number!==null&&t.page_number>0&&m.jsxs("div",{className:"flow-card__meta-item",children:[m.jsx("span",{className:"text-slate-500 mr-1.5 opacity-50",children:"#"}),m.jsxs("span",{children:["Page ",t.page_number]})]})]}),m.jsxs("div",{className:"flow-card__header",children:[m.jsx("h3",{className:"flow-card__title",children:t.title}),t.author&&m.jsxs("div",{className:"flow-card__author-pill",children:[m.jsx("span",{className:"opacity-60 italic",children:"by"})," ",t.author]})]}),m.jsx("div",{className:`flow-card__content ${i?"expanded":""}`,children:m.jsx("p",{children:t.content})}),m.jsxs("div",{className:"flow-card__footer",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("div",{className:"flow-card__feedback",children:[m.jsx("button",{className:`feedback-btn ${o==="like"?"active like":""}`,onClick:()=>d("like"),disabled:!!o,title:"Relevant",children:m.jsx("span",{className:"btn-icon",children:""})}),m.jsx("button",{className:`feedback-btn ${o==="dislike"?"active dislike":""}`,onClick:()=>d("dislike"),disabled:!!o,title:"Not relevant",children:m.jsx("span",{className:"btn-icon",children:""})}),m.jsx("button",{className:`feedback-btn ${o==="save"?"active save":""}`,onClick:()=>d("save"),disabled:!!o,title:"Keep in Library",children:m.jsx("span",{className:"btn-icon",children:""})})]}),t.reason&&m.jsx("div",{className:"flow-card__footer-reason",children:t.reason})]}),m.jsx("button",{className:`expand-toggle ${i?"is-expanded":""}`,onClick:()=>a(!i),children:i?"Collapse":"Read More"})]}),m.jsx("style",{children:`
                .flow-card {
                    background: #ffffff;
                    border: 1px solid #E6EAF2;
                    border-left: 3px solid var(--zone-color);
                    border-radius: 20px;
                    padding: 20px;
                    margin-bottom: 12px;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                    overflow: hidden;
                }

                @media (max-width: 768px) {
                    .flow-card {
                        padding: 16px;
                        margin-bottom: 8px;
                        border-radius: 16px;
                    }
                }

                @media (min-width: 769px) {
                    .flow-card {
                            margin-bottom: 10px;
                    }
                }
                
                .dark .flow-card {
                    background: rgba(15, 23, 42, 0.5);
                    border-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    right: 0;
                    width: 150px;
                    height: 150px;
                    background: radial-gradient(circle at top right, var(--zone-color), transparent 70%);
                    opacity: 0.04;
                    pointer-events: none;
                }

                .flow-card:hover {
                    background: #ffffff;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    box-shadow: 0 12px 40px rgba(15, 23, 42, 0.08);
                }

                .dark .flow-card:hover {
                    background: rgba(15, 23, 42, 0.7);
                    border-color: rgba(204, 86, 30, 0.3);
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
                }

                .flow-card__top-bar {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 16px;
                }

                .flow-card__zone-indicator {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .zone-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 50%;
                    box-shadow: 0 0 10px var(--zone-color);
                }

                .zone-label {
                    font-size: 11px;
                    font-weight: 700;
                    letter-spacing: 0.05em;
                    text-transform: uppercase;
                    color: var(--zone-color);
                    opacity: 0.9;
                }

                @media (max-width: 768px) {
                    .zone-label {
                        font-size: 9px;
                    }
                }

                .flow-card__meta-item {
                    font-size: 12px;
                    font-weight: 600;
                    color: #64748b;
                }

                @media (max-width: 768px) {
                    .flow-card__meta-item {
                        font-size: 10px;
                    }
                }

                .flow-card__header {
                    margin-bottom: 12px;
                }

                .flow-card__title {
                    font-family: 'Outfit', 'Inter', sans-serif;
                    font-size: 17px;
                    font-weight: 700;
                    color: #1e293b;
                    line-height: 1.3;
                    margin: 0 0 8px 0;
                }

                @media (max-width: 768px) {
                    .flow-card__title {
                        font-size: 15px;
                    }
                }

                .dark .flow-card__title {
                    color: #f1f5f9;
                }

                .flow-card__author-pill {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 4px 12px;
                    background: #F3F5FA;
                    border: 1px solid #E6EAF2;
                    border-radius: 100px;
                    font-size: 12px;
                    color: #475569;
                    font-weight: 500;
                }

                .dark .flow-card__author-pill {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .flow-card__content {
                    color: #475569;
                    font-size: 15px;
                    line-height: 1.7;
                    max-height: 120px;
                    overflow: hidden;
                    position: relative;
                    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                }

                .dark .flow-card__content {
                    color: #94a3b8;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.95));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-card__content.expanded {
                    max-height: 2000px;
                    color: #111827;
                }

                .dark .flow-card__content.expanded {
                    color: #f1f5f9;
                }

                .flow-card__footer-reason {
                    font-size: 12px;
                    line-height: 1.5;
                    color: rgba(204, 86, 30, 0.7);
                    font-weight: 600;
                    font-style: italic;
                    letter-spacing: 0.02em;
                }

                @media (max-width: 768px) {
                    .flow-card__footer-reason {
                        font-size: 10px;
                    }
                }

                .flow-card__footer {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-top: 16px;
                    padding-top: 14px;
                    border-top: 1px solid #E6EAF2;
                }

                .dark .flow-card__footer {
                    border-top-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card__feedback {
                    display: flex;
                    gap: 8px;
                }

                .feedback-btn {
                    width: 38px;
                    height: 38px;
                    border-radius: 10px;
                    border: 1px solid #E6EAF2;
                    background: #ffffff;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    color: #64748b;
                }

                .dark .feedback-btn {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .feedback-btn:hover:not(:disabled) {
                    background: #F3F5FA;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    color: #1e293b;
                }

                .dark .feedback-btn:hover:not(:disabled) {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(204, 86, 30, 0.4);
                    color: #f1f5f9;
                }

                .feedback-btn.active.like { background: rgba(34, 197, 94, 0.1); color: #22c55e; border-color: rgba(34, 197, 94, 0.2); }
                .feedback-btn.active.dislike { background: rgba(239, 68, 68, 0.1); color: #ef4444; border-color: rgba(239, 68, 68, 0.2); }
                .feedback-btn.active.save { background: rgba(204, 86, 30, 0.1); color: #CC561E; border-color: rgba(204, 86, 30, 0.2); }

                .expand-toggle {
                    background: transparent;
                    border: none;
                    color: #CC561E;
                    font-size: 13px;
                    font-weight: 700;
                    cursor: pointer;
                    padding: 8px 16px;
                    border-radius: 8px;
                    transition: all 0.2s ease;
                }

                @media (max-width: 768px) {
                    .expand-toggle {
                        font-size: 11px;
                        padding: 6px 12px;
                    }
                }

                .expand-toggle:hover {
                    background: rgba(204, 86, 30, 0.1);
                    transform: translateX(4px);
                }
            `})]})},JJ=[{label:" Focus",description:"Deep context & related works"},{label:" Syntopic",description:"Similar ideas across different authors"},{label:" Discovery",description:"Unexpected connections & serendipity"}],QJ=({value:t,onChange:e,disabled:n=!1})=>{const i=(a=>a<.33?0:a<.66?1:2)(t);return m.jsxs("div",{className:"horizon-slider",children:[m.jsxs("div",{className:"horizon-slider__header",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"horizon-slider__title",children:"Epistemic Horizon"}),m.jsx("span",{className:"text-[10px] text-card-foreground/70 font-medium tracking-tight",children:"Search Breadth Control"})]}),m.jsxs("div",{className:"horizon-slider__value-badge",children:[Math.round(t*100),"%"]})]}),m.jsxs("div",{className:"horizon-slider__track-container",children:[m.jsx("input",{type:"range",min:"0",max:"100",value:t*100,onChange:a=>e(parseInt(a.target.value)/100),disabled:n,className:"horizon-slider__input"}),m.jsx("div",{className:"horizon-slider__progress",style:{width:`${t*100}%`}})]}),m.jsx("div",{className:"horizon-slider__zones",children:JJ.map((a,o)=>{const s=o===i,c=a.label.split(" ")[0],d=a.label.split(" ")[1];return m.jsxs("div",{className:`horizon-slider__zone ${s?"active":""}`,onClick:()=>e(o*.333+.165),children:[m.jsx("span",{className:"zone-emoji",children:c}),m.jsx("span",{className:"zone-text",children:d}),s&&m.jsx("div",{className:"active-indicator"})]},o)})}),m.jsx("style",{children:`
                .horizon-slider {
                    background: hsl(var(--card));
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    padding: 12px;
                }

                .horizon-slider__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    margin-bottom: 12px;
                }

                .horizon-slider__title {
                    font-size: 11px;
                    font-weight: 700;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    color: hsl(var(--card-foreground));
                    opacity: 0.8;
                    font-family: 'Outfit', sans-serif;
                }

                .horizon-slider__value-badge {
                    padding: 2px 8px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 11px;
                    font-weight: 800;
                    border-radius: 6px;
                    font-family: 'JetBrains Mono', monospace;
                }

                .horizon-slider__track-container {
                    position: relative;
                    height: 4px;
                    background: rgba(255, 255, 255, 0.08);
                    border-radius: 100px;
                    margin-bottom: 12px;
                    overflow: visible;
                }

                .horizon-slider__input {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    -webkit-appearance: none;
                    appearance: none;
                    background: transparent;
                    cursor: pointer;
                    z-index: 5;
                    margin: 0;
                    padding: 0;
                }

                .horizon-slider__input::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #fff;
                    box-shadow: 0 0 10px rgba(204, 86, 30, 0.5);
                    cursor: grab;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                    border: 3px solid #CC561E;
                }

                .horizon-slider__input::-webkit-slider-thumb:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 20px rgba(204, 86, 30, 0.7);
                }

                .horizon-slider__progress {
                    position: absolute;
                    top: 0;
                    left: 0;
                    height: 100%;
                    background: linear-gradient(90deg, #CC561E 0%, #e66a2e 100%);
                    border-radius: 100px;
                    pointer-events: none;
                    z-index: 1;
                }

                .horizon-slider__zones {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 2px;
                }

                .horizon-slider__zone {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 2px;
                    padding: 8px 2px;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    position: relative;
                }

                .horizon-slider__zone:hover {
                    background: rgba(255, 255, 255, 0.06);
                }

                .horizon-slider__zone.active {
                    background: rgba(204, 86, 30, 0.08);
                }

                .zone-emoji {
                    font-size: 14px;
                    filter: grayscale(1) opacity(0.55);
                    transition: all 0.3s ease;
                }

                .horizon-slider__zone.active .zone-emoji {
                    filter: grayscale(0) opacity(1);
                    transform: scale(1.1);
                }

                .zone-text {
                    font-size: 9px;
                    font-weight: 700;
                    color: rgba(255, 255, 255, 0.7);
                    text-transform: uppercase;
                    letter-spacing: 0.02em;
                    transition: all 0.3s ease;
                    text-align: center;
                }

                .horizon-slider__zone.active .zone-text {
                    color: rgba(255, 255, 255, 0.95);
                }

                .active-indicator {
                    position: absolute;
                    bottom: 0;
                    width: 3px;
                    height: 3px;
                    background: #CC561E;
                    border-radius: 50%;
                    box-shadow: 0 0 8px #CC561E;
                }
            `})]})},eQ=({activeFilter:t,onFilterChange:e})=>{const n=[{id:"ALL",label:"All Notes",icon:PM,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"BOOK",label:"Books",icon:dy,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"ARTICLE",label:"Articles",icon:zd,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"WEBSITE",label:"Websites",icon:N0,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:bc,color:"text-slate-400",bg:"bg-slate-500/10"}];return m.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[m.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[m.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Source Navigator"]}),m.jsx("div",{className:"space-y-1",children:n.map(r=>{const i=r.icon,a=t===r.id;return m.jsxs("button",{onClick:()=>e(r.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl transition-all duration-300 group relative overflow-hidden border bg-card text-card-foreground ${a?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[m.jsxs("div",{className:"flex items-center gap-2.5 relative z-10",children:[m.jsx("div",{className:`p-1.5 rounded-lg transition-all duration-300 ${a?"text-[#CC561E]":"text-card-foreground/70 group-hover:text-card-foreground"}`,children:m.jsx(i,{size:18})}),m.jsx("span",{className:`text-xs font-medium tracking-tight ${a?"text-card-foreground":"text-card-foreground/80 group-hover:text-card-foreground"}`,children:r.label})]}),a&&m.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r.id)})})]})},tQ=({firebaseUid:t,anchorType:e,anchorId:n,anchorLabel:r,categoryOptions:i,onClose:a})=>{const[o,s]=A.useState(null),[c,d]=A.useState([]),[h,p]=A.useState(r||"Flux"),[x,v]=A.useState(null),[b,C]=A.useState(.25),[E,S]=A.useState(!1),[N,k]=A.useState(!0),[I,D]=A.useState(null),[L,O]=A.useState(!1),[j,U]=A.useState(!1),[fe,le]=A.useState(!1),[q,de]=A.useState(null),[ge,xe]=A.useState(!1),[H,ie]=A.useState("ALL"),K=A.useRef(null);A.useRef(null),A.useRef(null);const B=A.useCallback(J=>J==="ALL"?"ALL_NOTES":J,[]),G=A.useCallback(async(J,we=null,z=.25)=>{if(t){S(!0),D(null),d([]),k(!0);try{const ae=B(J),ce={firebase_uid:t,anchor_type:e,anchor_id:n,mode:"FOCUS",horizon_value:z,resource_type:ae,category:we||void 0},Le=XJ(ce)??await TT(ce);s(Le.session_id),d(Le.initial_cards),p(Le.topic_label),de(null)}catch(ae){D(cc(ae))}finally{S(!1)}}},[t,e,n,B]);A.useEffect(()=>{t&&(L||O(!0))},[t,L]),A.useEffect(()=>{L&&G(H,x,b)},[L,H,x,G]);const M=A.useCallback(async()=>{if(!(o===null||E||!N)){S(!0);try{const J=await $x({firebase_uid:t,session_id:o,batch_size:5});d(we=>[...we,...J.cards]),k(J.has_more),J.pivot_info&&de(J.pivot_info)}catch(J){console.error("Failed to load more:",J)}finally{S(!1)}}},[o,t,E,N]),V=async J=>{if(C(J),!L){O(!0);return}if(o!==null)try{await YJ(o,J,t)}catch(we){console.error("Failed to adjust horizon:",we)}},Z=async()=>{if(!L){O(!0);return}if(o!==null){S(!0),xe(!0),D(null),de(null);try{const J=await W_(o,"topic","General Discovery",t,B(H),x||void 0);p(J.topic_label),J.pivot_info&&de(J.pivot_info),d([]),k(!0);const we=await $x({session_id:o,firebase_uid:t,batch_size:5});d(we.cards),k(we.has_more),we.pivot_info&&de(we.pivot_info)}catch(J){D(cc(J))}finally{S(!1),xe(!1)}}},re=J=>{if(J!==x){if(v(J),!L){O(!0);return}o!==null&&(S(!0),W_(o,"topic","General Discovery",t||"",B(H),J||void 0).then(we=>{d([]),p(we.topic_label),de(we.pivot_info||null),k(!0),$x({session_id:o,firebase_uid:t,batch_size:5}).then(z=>{d(z.cards),k(z.has_more),z.pivot_info&&de(z.pivot_info)}).catch(z=>{console.error("Failed to load initial batch after category pivot:",z),D(cc(z))}).finally(()=>{S(!1)})}).catch(we=>{console.error("Failed to pivot category:",we),D(cc(we)),S(!1)}))}},_e=J=>{J!==H&&(ie(J),L||O(!0))};return m.jsxs("div",{className:"flow-container",ref:K,children:[m.jsxs("div",{className:"flow-layout",children:[m.jsxs("aside",{className:"flow-left",children:[a&&m.jsxs("button",{onClick:a,className:"flow-left__back group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(Qo,{size:16})}),m.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]}),(H==="ALL"||H==="BOOK")&&m.jsx(lS,{activeCategory:x,onCategoryChange:re,categories:i})]}),m.jsxs("div",{className:"flow-main",children:[m.jsx("div",{className:"flow-container__header lg:hidden",children:m.jsx("div",{className:"flow-container__title-section",children:m.jsxs("div",{className:"flow-container__mobile-actions relative flex items-center justify-between",children:[m.jsxs("div",{className:"lg:hidden flex items-center gap-2 z-10 w-1/3",children:[a&&m.jsx("button",{onClick:a,className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300","aria-label":"Back",children:m.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(Qo,{size:16})})}),m.jsxs("button",{onClick:()=>le(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(bg,{size:16})}),m.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Explore"})]})]}),m.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none",children:m.jsx("span",{className:"text-[10px] font-extrabold uppercase tracking-[0.2em] text-[#CC561E] bg-[#CC561E]/10 px-3 py-1 rounded-md",children:"FLUX"})}),m.jsx("div",{className:"lg:hidden flex items-center justify-end gap-2 z-10 w-1/3",children:m.jsxs("button",{onClick:()=>U(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[m.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Filters"}),m.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:m.jsx(_R,{size:16})})]})})]})})}),L&&I&&m.jsxs("div",{className:"flow-container__error",children:[m.jsxs("p",{children:[" ",I]}),m.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),L&&q&&m.jsxs("div",{className:"flow-container__pivot",children:[m.jsx("span",{className:"pivot-icon",children:""}),m.jsx("p",{children:q.message})]}),m.jsxs("div",{className:"flow-container__cards",children:[L?m.jsxs(m.Fragment,{children:[c.map(J=>m.jsx(ZJ,{card:J,sessionId:o??"",firebaseUid:t},J.flow_id)),!E&&!I&&c.length===0&&m.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[m.jsx("div",{className:"text-6xl mb-6 opacity-80",children:""}),m.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-2",children:H==="PERSONAL_NOTE"?"No Personal Notes Found":"Library Empty"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-8",children:H==="PERSONAL_NOTE"?"We couldn't find any personal notes or highlights. Try adding some content or switching to 'All Notes'.":"Your knowledge stream is waiting for content. Upload books or add notes to get started."}),m.jsx("button",{onClick:a,className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Go to Dashboard"})]})]}):m.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[m.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-3",children:"Flux session not started"}),m.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-6",children:"Select a filter to begin or click the button below."}),m.jsx("button",{onClick:()=>O(!0),className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Start Flux"})]}),L&&(c.length>0||E)&&m.jsxs("div",{className:"flow-container__load-more py-8 flex justify-center",children:[E?m.jsxs("div",{className:"flex items-center gap-3 text-slate-500 dark:text-slate-400",children:[m.jsx("div",{className:"w-5 h-5 border-2 border-[#CC561E] border-t-transparent rounded-full animate-spin"}),m.jsx("span",{className:"text-sm font-medium",children:ge?"Topic is shifting...":"Loading more thoughts..."})]}):N&&m.jsxs("button",{onClick:M,className:"px-8 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 text-slate-700 dark:text-slate-300 hover:text-[#CC561E] dark:hover:text-[#CC561E] font-medium rounded-full shadow-sm hover:shadow-md transition-all duration-300 flex items-center gap-2 group",children:[m.jsx("span",{children:"Load More"}),m.jsx($s,{className:"w-4 h-4 group-hover:translate-y-0.5 transition-transform"})]}),!N&&c.length>0&&m.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:m.jsx("span",{children:" You've explored all related thoughts"})})]})]})]}),m.jsxs("div",{className:`flow-category-container ${fe?"is-open":""}`,children:[m.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>le(!1)}),m.jsx("aside",{className:"flow-category-sidebar",children:m.jsxs("div",{className:"flow-sidebar__sticky",children:[m.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-6 pb-4 border-bottom border-slate-100 dark:border-slate-800",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:m.jsx(bg,{size:20})}),m.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Discovery Areas"})]}),m.jsx("button",{onClick:()=>le(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:m.jsx(ta,{size:20})})]}),(H==="ALL"||H==="BOOK")&&m.jsx(lS,{activeCategory:x,onCategoryChange:J=>{re(J),le(!1)},categories:i})]})})]}),m.jsxs("div",{className:`flow-sidebar-container ${j?"is-open":""}`,children:[m.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>U(!1)}),m.jsx("aside",{className:"flow-sidebar",children:m.jsxs("div",{className:"flow-sidebar__sticky",children:[m.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-4 md:mb-0 pb-4 md:pb-0 border-bottom border-slate-100 dark:border-slate-800",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:m.jsx(bg,{size:20})}),m.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Controls"})]}),m.jsx("button",{onClick:()=>U(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:m.jsx(ta,{size:20})})]}),m.jsx(eQ,{activeFilter:H,onFilterChange:_e}),m.jsx(QJ,{value:b,onChange:V,disabled:E}),m.jsxs("button",{className:"flow-sidebar__pivot-button",onClick:Z,disabled:E,children:[m.jsx("span",{className:"icon",children:""}),"Change Topic"]})]})})]})]}),m.jsx("style",{children:`
                .flow-container {
                    max-width: 1280px;
                    margin: 0 auto;
                    width: 100%;
                    display: flex;
                    flex-direction: column;
                    height: 100%;
                    background: transparent;
                    position: relative;
                    padding: 24px;
                }

                @media (max-width: 768px) {
                    .flow-container {
                        padding: 12px;
                    }
                }

                .flow-container::before {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: 
                        radial-gradient(circle at 10% 20%, rgba(204, 86, 30, 0.03) 0%, transparent 40%),
                        radial-gradient(circle at 90% 80%, rgba(204, 86, 30, 0.03) 0%, transparent 40%);
                    pointer-events: none;
                    z-index: -1;
                }

                .flow-layout {
                    display: grid;
                    grid-template-columns: 210px 1fr 210px;
                    gap: 24px;
                    align-items: flex-start;
                    padding-top: 20px;
                    max-width: 1280px;
                    margin: 0 auto;
                }

                @media (max-width: 1024px) {
                    .flow-layout {
                        grid-template-columns: 1fr;
                        gap: 12px;
                        padding-top: 4px;
                    }

                    .flow-left {
                        display: none;
                    }

                    .flow-main {
                        padding-top: 48px;
                    }

                    .flow-sidebar-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-end;
                    }

                    .flow-category-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-start;
                    }

                    .flow-sidebar-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-category-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-sidebar-backdrop {
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0, 0, 0, 0.5);
                        backdrop-filter: blur(4px);
                        opacity: 0;
                        transition: opacity 0.4s ease;
                        pointer-events: none;
                    }

                    .is-open .flow-sidebar-backdrop {
                        opacity: 1;
                        pointer-events: auto;
                    }

                    .flow-sidebar {
                        width: 55%;
                        min-width: 250px;
                        max-width: 400px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-sidebar {
                        background: #0f172a;
                    }

                    .flow-category-sidebar {
                        width: 25%;
                        min-width: 150px;
                        max-width: 340px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(-100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-category-sidebar {
                        background: #0f172a;
                    }

                    .is-open .flow-sidebar {
                        transform: translateX(0);
                    }

                    .is-open .flow-category-sidebar {
                        transform: translateX(0);
                    }

                    .flow-sidebar__sticky {
                        height: 100%;
                        max-height: 100vh;
                        padding: 12px;
                        overflow-y: auto;
                        position: relative;
                        top: 0 !important;
                    }

                    .flow-container__mobile-actions {
                        position: sticky;
                        top: 0;
                        z-index: 100;
                        background: rgba(255, 255, 255, 0.85);
                        backdrop-filter: blur(16px);
                        margin: -20px -20px 20px -20px;
                        padding: 12px 20px;
                        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
                        width: calc(100% + 40px);
                    }

                    .flow-mobile-actions-row {
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 8px;
                        width: 100%;
                    }

                    .flow-mobile-actions-right {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-left: auto;
                    }

                    .flow-mobile-action-btn {
                        padding: 6px 10px;
                        border-radius: 10px;
                        border: 1px solid rgba(148, 163, 184, 0.22);
                        background: rgba(255, 255, 255, 0.9);
                    }

                    .dark .flow-mobile-action-btn {
                        background: rgba(15, 23, 42, 0.9);
                        border-color: rgba(255, 255, 255, 0.12);
                    }

                    .flow-badge--title {
                        display: table;
                        margin: 4px auto 0 auto;
                        text-align: center;
                        font-size: 11px;
                        padding: 6px 14px;
                        letter-spacing: 0.14em;
                    }

                    .dark .flow-container__mobile-actions {
                        background: rgba(15, 23, 42, 0.85);
                        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
                    }
                }

                @media (min-width: 1025px) {
                    .flow-container__mobile-actions {
                        display: none;
                    }

                    .flow-category-container {
                        display: none;
                    }
                }

                .flow-sidebar__sticky {
                    position: sticky;
                    top: 24px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                }

                .flow-main {
                    padding-top: 0;
                }

                @media (min-width: 1025px) {
                    .flow-main {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                    .flow-sidebar__sticky {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                }

                .flow-left {
                    position: sticky;
                    top: 24px;
                    align-self: flex-start;
                }

                .flow-sidebar-container {
                    align-self: flex-start;
                }

                .flow-sidebar {
                    align-self: flex-start;
                }

                .flow-left__back {
                    margin-bottom: 24px;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(248, 250, 252, 0.9));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-sidebar__pivot-button {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                    width: 100%;
                    padding: 12px;
                    background: #262D40;
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-weight: 700;
                    font-size: 13px;
                    cursor: pointer;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 4px 15px rgba(38, 45, 64, 0.25);
                }

                .flow-sidebar__pivot-button:hover:not(:disabled) {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(38, 45, 64, 0.35);
                    filter: brightness(1.08);
                }

                .flow-sidebar__pivot-button:disabled {
                    opacity: 0.4;
                    cursor: not-allowed;
                    filter: grayscale(0.5);
                }

                .flow-sidebar__stats {
                    padding: 16px;
                    background: hsl(var(--card));
                    border-radius: 16px;
                    border: 1px solid rgba(255, 255, 255, 0.08);
                }

                .stat-item {
                    display: flex;
                    justify-content: space-between;
                    font-size: 11px;
                    margin-bottom: 8px;
                }

                .stat-label { color: rgba(255, 255, 255, 0.65); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
                .stat-value { color: rgba(255, 255, 255, 0.95); font-family: 'JetBrains Mono', monospace; }

                .flow-container__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-end;
                    margin-bottom: 24px;
                    padding-bottom: 12px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }

                @media (min-width: 1025px) {
                    .flow-container__header {
                        display: none;
                    }
                }

                .flow-badge {
                    display: inline-block;
                    padding: 4px 10px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 10px;
                    font-weight: 800;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    border-radius: 6px;
                    margin-bottom: 12px;
                }

                .flow-container__title {
                    margin: 0 0 8px 0;
                    font-size: 28px;
                    font-weight: 800;
                    color: #0f172a;
                    letter-spacing: -0.02em;
                    font-family: 'Outfit', sans-serif;
                }

                .dark .flow-container__title {
                    color: #fff;
                }

                .flow-container__meta {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .meta-dot {
                    width: 4px;
                    height: 4px;
                    background: #CC561E;
                    border-radius: 50%;
                }

                .flow-container__subtitle {
                    font-size: 14px;
                    color: #64748b;
                    font-weight: 500;
                }

                .flow-container__close {
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    width: 40px;
                    height: 40px;
                    font-size: 14px;
                    color: #64748b;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .flow-container__close:hover {
                    background: rgba(239, 68, 68, 0.1);
                    color: #f87171;
                    border-color: rgba(239, 68, 68, 0.2);
                }

                .flow-container__pivot {
                    background: rgba(204, 86, 30, 0.05);
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(204, 86, 30, 0.1);
                    padding: 20px 24px;
                    border-radius: 16px;
                    margin-bottom: 32px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    animation: slideInDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
                }

                @keyframes slideInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .pivot-icon {
                    font-size: 24px;
                }

                .flow-container__pivot p {
                    margin: 0;
                    color: rgba(204, 86, 30, 0.8);
                    font-size: 14px;
                    line-height: 1.6;
                    font-weight: 500;
                }

                .flow-container__cards {
                    display: flex;
                    flex-direction: column;
                    gap: 24px;
                }

                .flow-container__loader {
                    padding: 60px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 16px;
                    color: #64748b;
                    font-size: 14px;
                    font-weight: 500;
                }

                .spinner {
                    width: 24px;
                    height: 24px;
                    border: 2px solid rgba(204, 86, 30, 0.1);
                    border-top-color: #CC561E;
                    border-radius: 50%;
                    animation: spin 0.8s linear infinite;
                }

                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            `})]})},nQ=({userId:t,userEmail:e,onLogout:n})=>{const[r,i]=A.useState([]),a=A.useRef([]),[o,s]=A.useState("list"),[c,d]=A.useState(null),[h,p]=A.useState(!1),[x,v]=A.useState(null),[b,C]=A.useState(!1),[E,S]=A.useState(null),[N,k]=A.useState("DASHBOARD"),[I,D]=A.useState(!1),[L,O]=A.useState(!0),[j,U]=A.useState(null),[fe,le]=A.useState(!0),[q,de]=A.useState(null),[ge,xe]=A.useState(1),[H,ie]=A.useState(""),[K,B]=A.useState("ALL"),[G,M]=A.useState("date_desc"),[V,Z]=A.useState(""),[re,_e]=A.useState({}),[J,we]=A.useState([]),[z,ae]=A.useState(!1),ce=A.useRef(!1),Te=A.useRef(0),Le=A.useRef(new Set),ot=A.useRef(!1),Ke=A.useRef(new Map),ht=A.useRef(0),Ut=A.useMemo(()=>{const $=Ce=>Ce.trim().toLocaleLowerCase("tr-TR"),X=new Map(xp.map(Ce=>[$(Ce),Ce])),Ae=new Map;return r.filter(Ce=>Ce.type==="BOOK").forEach(Ce=>{(Ce.tags||[]).forEach(se=>{const me=X.get($(se));me&&Ae.set(me,(Ae.get(me)||0)+1)})}),xp.filter(Ce=>(Ae.get(Ce)||0)>=M9)},[r]);A.useEffect(()=>{a.current=r},[r]);const Me=A.useCallback($=>{const X=Ke.current.get($);X&&(window.clearTimeout(X.timerId),Ke.current.delete($))},[]),We=A.useCallback(async $=>{ht.current+=1;try{return await $()}finally{ht.current=Math.max(0,ht.current-1)}},[]),Pe=A.useCallback(($,X)=>{Me(X.id);const Ae=window.setTimeout(()=>{Ke.current.delete(X.id)},45e3);Ke.current.set(X.id,{mode:$,snapshot:X,timerId:Ae})},[Me]),Se=$=>typeof $=="string"?$.trim():"",fn=$=>{if(typeof $=="number"&&Number.isFinite($))return $;if(typeof $=="string"&&$.trim()!==""){const X=Number($);return Number.isFinite(X)?X:null}return null},An=$=>Array.isArray($)?$.map(X=>String(X||"").trim()).filter(Boolean).sort():[],Mr=($=[])=>$.map(X=>({text:Se(X.text),type:String(X.type||"highlight").trim().toLowerCase(),comment:Se(X.comment),pageNumber:fn(X.pageNumber),paragraphNumber:fn(X.paragraphNumber),chapterTitle:Se(X.chapterTitle),tags:An(X.tags)})).sort((X,Ae)=>JSON.stringify(X).localeCompare(JSON.stringify(Ae))),rn=A.useCallback(($,X)=>{if($.mode==="HIGHLIGHTS")return JSON.stringify(Mr($.snapshot.highlights||[]))===JSON.stringify(Mr(X.highlights||[]));const Ae=Se(X.title)===Se($.snapshot.title)&&Se(X.author)===Se($.snapshot.author)&&Se(X.translator)===Se($.snapshot.translator)&&Se(X.publisher)===Se($.snapshot.publisher)&&Se(X.publicationYear)===Se($.snapshot.publicationYear)&&Se(X.isbn)===Se($.snapshot.isbn)&&Se(X.url)===Se($.snapshot.url)&&Se(X.status)===Se($.snapshot.status)&&Se(X.readingStatus)===Se($.snapshot.readingStatus)&&JSON.stringify(An(X.tags))===JSON.stringify(An($.snapshot.tags))&&Se(X.generalNotes)===Se($.snapshot.generalNotes)&&Se(X.summaryText)===Se($.snapshot.summaryText)&&Se(X.coverUrl)===Se($.snapshot.coverUrl)&&fn(X.pageCount)===fn($.snapshot.pageCount)&&Se(X.contentLanguageMode)===Se($.snapshot.contentLanguageMode)&&Se(X.contentLanguageResolved)===Se($.snapshot.contentLanguageResolved)&&Se(X.sourceLanguageHint)===Se($.snapshot.sourceLanguageHint)&&Se(X.languageDecisionReason)===Se($.snapshot.languageDecisionReason)&&fn(X.languageDecisionConfidence)===fn($.snapshot.languageDecisionConfidence);return $.mode==="ITEM"?Ae:Ae&&Se(X.personalNoteCategory)===Se($.snapshot.personalNoteCategory)&&Se(X.personalFolderId)===Se($.snapshot.personalFolderId)&&Se(X.folderPath)===Se($.snapshot.folderPath)},[]),Fi=A.useCallback($=>{if(Ke.current.size===0)return $;const X=[],Ae=$.map(Ce=>{const se=Ke.current.get(Ce.id);if(!se)return Ce;if(rn(se,Ce))return X.push(Ce.id),Ce;if(se.mode==="HIGHLIGHTS")return{...Ce,highlights:se.snapshot.highlights};const me={...Ce,title:se.snapshot.title,author:se.snapshot.author,translator:se.snapshot.translator,publisher:se.snapshot.publisher,publicationYear:se.snapshot.publicationYear,isbn:se.snapshot.isbn,url:se.snapshot.url,status:se.snapshot.status,readingStatus:se.snapshot.readingStatus,tags:se.snapshot.tags,generalNotes:se.snapshot.generalNotes,summaryText:se.snapshot.summaryText,coverUrl:se.snapshot.coverUrl,pageCount:se.snapshot.pageCount,contentLanguageMode:se.snapshot.contentLanguageMode,contentLanguageResolved:se.snapshot.contentLanguageResolved,sourceLanguageHint:se.snapshot.sourceLanguageHint,languageDecisionReason:se.snapshot.languageDecisionReason,languageDecisionConfidence:se.snapshot.languageDecisionConfidence};return se.mode==="ITEM"?me:{...me,personalNoteCategory:se.snapshot.personalNoteCategory,personalFolderId:se.snapshot.personalFolderId,folderPath:se.snapshot.folderPath}});return X.length>0&&X.forEach(Ce=>Me(Ce)),Ae},[Me,rn]);A.useEffect(()=>()=>{for(const $ of Ke.current.values())window.clearTimeout($.timerId);Ke.current.clear()},[]),A.useEffect(()=>{let $=!0;async function X(){if(!t){O(!1);return}try{const[{items:Ae,lastDoc:Ce},se]=await Promise.all([Fh(t),Hx(t)]);$&&(i(Ae),we(se),U(Ce),le(!!Ce),ae(!1))}catch(Ae){console.error("Failed to load items:",Ae)}finally{$&&O(!1)}}return X(),()=>{$=!1}},[t]),A.useEffect(()=>{if(!t)return;let $=!1,X=null,Ae=!1;Te.current=Date.now(),ot.current=!1;const Ce=()=>{if($)return;const Ye=typeof document<"u"&&document.visibilityState==="hidden"?5e3:2500;X=window.setTimeout(()=>{se()},Ye)},se=async()=>{if($||ot.current){Ce();return}if(ht.current>0){Ce();return}ot.current=!0;try{const Ee=await Yq(t,Te.current,100),Ye=Ee.events||[],Fe=Ye.reduce((rt,et)=>{const Zt=Number(et.updated_at_ms||0);return Zt>rt?Zt:rt},0);if(Te.current=Math.max(Te.current,Number(Ee.server_time_ms||0),Fe),Ye.length>0){const[{items:rt,lastDoc:et},Zt]=await Promise.all([Fh(t),Hx(t)]);if(!$){const bt=Le.current,Tt=bt.size>0?rt.filter(Lr=>!bt.has(Lr.id)):rt;i(Fi(Tt)),we(Zt),U(et),le(!!et)}}}catch(Ee){if(Ee instanceof Error&&Ee.message==="REALTIME_ENDPOINT_NOT_FOUND"){Ae=!0,console.warn("Realtime polling disabled: endpoint is not available on current backend.");return}console.warn("Realtime polling failed (non-critical):",Ee)}finally{if(ot.current=!1,Ae)return;Ce()}},me=()=>{X!==null&&window.clearTimeout(X),Ce()};return Ce(),document.addEventListener("visibilitychange",me),()=>{$=!0,X!==null&&window.clearTimeout(X),document.removeEventListener("visibilitychange",me)}},[Fi,t]),A.useEffect(()=>{},[t]),A.useEffect(()=>{const $=()=>{setTimeout(()=>{window.scrollTo(0,0),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},100)},X=document.querySelectorAll("input, textarea");return X.forEach(Ae=>{Ae.addEventListener("blur",$)}),()=>{X.forEach(Ae=>{Ae.removeEventListener("blur",$)})}},[]),A.useEffect(()=>{if(!t||ce.current)return;ce.current=!0;let $=!1,X=null,Ae=null;const Ce=()=>{$||qJ({firebase_uid:t,anchor_type:"topic",anchor_id:"General Discovery",mode:"FOCUS",horizon_value:.25,resource_type:"ALL_NOTES"}).catch(se=>{console.warn("Flow prewarm failed (non-critical):",se)})};return typeof window<"u"&&typeof window.requestIdleCallback=="function"?Ae=window.requestIdleCallback(()=>Ce(),{timeout:2500}):X=window.setTimeout(Ce,1200),()=>{$=!0,X!==null&&window.clearTimeout(X),Ae!==null&&typeof window<"u"&&typeof window.cancelIdleCallback=="function"&&window.cancelIdleCallback(Ae)}},[t]);const or=A.useCallback(async($,X=!1)=>{if(!gn($))return!0;try{return await qq(t,$.id,{title:$.title,author:$.author,content:$.generalNotes||"",tags:$.tags||[],category:Nr($),delete_only:X}),!0}catch(Ae){return console.error("Failed to sync personal note to AI Backend:",Ae),!1}},[t]),sr=A.useCallback($=>{if(!$)return;const X=J.find(Ae=>Ae.id===$);return X==null?void 0:X.name},[J]),St=A.useCallback(async()=>{const[{items:$,lastDoc:X},Ae]=await Promise.all([Fh(),Hx()]),Ce=Le.current,se=Ce.size>0?$.filter(me=>!Ce.has(me.id)):$;i(Fi(se)),we(Ae),U(X),le(!!X)},[Fi,t]),Er=A.useCallback(async $=>{const X={...$,id:$.id||Date.now().toString(),addedAt:$.addedAt||Date.now(),highlights:[]};i(se=>[X,...se]),p(!1),_e({});let Ae=!1,Ce="";try{await We(async()=>{await w0(t,X)}),Ae=!0}catch(se){Ce=se instanceof Error?se.message:String(se),console.error("Failed to save item to Oracle:",se)}if(!Ae){i(se=>se.filter(me=>me.id!==X.id)),window.alert(`Item kaydedilemedi: ${Ce||"Bilinmeyen hata"}`);return}try{await St()}catch(se){console.warn("Post-create refresh failed:",se)}(async()=>{try{if(gn(X)){await or(X,!1);return}const se=[];se.push(`Title: ${X.title}`),se.push(`Author: ${X.author}`),gn(X)&&X.personalNoteCategory&&se.push(`Category: ${X.personalNoteCategory}`),gn(X)&&X.folderPath&&se.push(`SubFile: ${X.folderPath}`),X.publisher&&se.push(`Publisher: ${X.publisher}`),X.tags&&X.tags.length>0&&se.push(`Tags: ${X.tags.join(", ")}`);const me=gn(X)?X.generalNotes:X.summaryText||X.generalNotes;me&&se.push(`
Content/Notes:
${me}`);const Ee=se.join(`
`);Ee.length>20&&(await C5(Ee,X.title,X.author,gn(X)?Y4(X):X.type,t,{book_id:X.id,tags:X.tags||[]}),console.log("Synced new item to AI Backend:",X.title))}catch(se){console.error("Failed to sync item to AI Backend:",se)}})(),$.type!=="PERSONAL_NOTE"&&(async()=>{try{const se=r1(X),me=await R2(se),Ee=i1(X,me),Ye=a.current.find(bt=>bt.id===X.id);if(!Ye)return;const Fe=(bt,Tt)=>JSON.stringify(Array.isArray(bt)?bt:[])===JSON.stringify(Array.isArray(Tt)?Tt:[]),rt={},et=bt=>{const Tt=X[bt],Lr=Ye[bt],Ui=Ee[bt];Ui!==void 0&&Ui!==Tt&&Lr===Tt&&(rt[bt]=Ui)};if((()=>{const bt=X.tags||[],Tt=Ye.tags||[],Lr=Ee.tags||[];Fe(Lr,bt)||Fe(Tt,bt)&&(rt.tags=Lr)})(),et("summaryText"),et("publisher"),et("translator"),et("publicationYear"),et("isbn"),et("coverUrl"),et("pageCount"),et("contentLanguageMode"),et("contentLanguageResolved"),et("sourceLanguageHint"),et("languageDecisionReason"),et("languageDecisionConfidence"),Object.keys(rt).length===0)return;i(bt=>bt.map(Tt=>Tt.id===X.id?{...Tt,...rt}:Tt));try{await Qu(t,X.id,rt)}catch(bt){console.error("Failed to patch enriched item in Oracle:",bt)}}catch(se){console.error("Background enrichment failed:",se)}})()},[Qu,St,We,or,t]),zi=A.useCallback($=>{_e({personalNoteCategory:($==null?void 0:$.category)||"DAILY",personalFolderId:$==null?void 0:$.folderId,folderPath:($==null?void 0:$.folderPath)||sr($==null?void 0:$.folderId)}),v(null),p(!0)},[sr]),lr=A.useCallback($=>{Er({type:"PERSONAL_NOTE",title:$.title,author:"Self",status:"On Shelf",readingStatus:"Finished",tags:[],generalNotes:$.content,addedAt:Date.now(),personalNoteCategory:$.category,personalFolderId:$.folderId,folderPath:$.folderPath||sr($.folderId)})},[sr,Er]),xi=A.useCallback(async $=>{if(!x)return;let X=null,Ae=null;if(i(Ce=>Ce.map(se=>se.id===x?(Ae=se,X={...se,...$},X):se)),p(!1),v(null),X){const Ce=gn(X);Pe(Ce?"PERSONAL_NOTE":"ITEM",X);let se=!1,me="";try{await We(async()=>{await w0(t,X)}),se=!0}catch(Fe){me=Fe instanceof Error?Fe.message:String(Fe),console.error("Failed to update item in Oracle:",Fe)}let Ee=!0,Ye="";if(Ce)try{Ee=await We(async()=>or(X,!1))}catch(Fe){Ee=!1,Ye=Fe instanceof Error?Fe.message:String(Fe)}if(se)try{await St()}catch(Fe){console.warn("Post-update refresh failed:",Fe)}if(!se||!Ee){Me(X.id),Ae&&i(rt=>rt.map(et=>et.id===Ae.id?Ae:et));const Fe=[me,Ye].filter(Boolean).join(" | ");window.alert(`Changes could not be saved. Previous version was restored.${Fe?`
${Fe}`:""}`)}}},[Me,x,Pe,St,We,or,t]),Gr=A.useCallback(async $=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const X=r.find(se=>se.id===$);if(!X)return;Me($),Le.current.add($),setTimeout(()=>Le.current.delete($),1e4),i(se=>se.filter(me=>me.id!==$)),c===$&&(d(null),s("list"));let Ae=!1,Ce="";try{await We(async()=>{await kJ(t,$)}),Ae=!0}catch(se){Ce=se instanceof Error?se.message:String(se),console.error("Failed to delete item from Oracle:",se)}if(!Ae){Le.current.delete($),i(se=>[X,...se]),window.alert(`Delete failed: ${Ce||"Unknown error"}`);return}try{await We(async()=>{await U3(t,X.id)})}catch(se){console.error("Failed to purge item from AI Backend:",se)}try{await St()}catch(se){console.warn("Post-delete refresh failed:",se)}},[r,Me,St,We,c,t]),xn=A.useCallback(async $=>{if(!window.confirm(`Are you sure you want to delete ${$.length} items?`))return;const X=r.filter(me=>$.includes(me.id));if(X.length===0)return;$.forEach(me=>{Me(me),Le.current.add(me),setTimeout(()=>Le.current.delete(me),1e4)}),i(me=>me.filter(Ee=>!$.includes(Ee.id))),c&&$.includes(c)&&(d(null),s("list"));let Ae=!1,Ce="";try{await We(async()=>{await TJ(t,$)}),Ae=!0}catch(me){Ce=me instanceof Error?me.message:String(me),console.error("Failed to delete items from Oracle:",me)}if(!Ae){$.forEach(me=>Le.current.delete(me)),i(me=>[...X,...me]),window.alert(`Bulk delete failed: ${Ce||"Unknown error"}`);return}(await Promise.allSettled(X.map(me=>We(async()=>U3(t,me.id))))).forEach((me,Ee)=>{me.status==="rejected"&&console.error(`Failed to purge item ${X[Ee].id} from AI Backend:`,me.reason)});try{await St()}catch(me){console.warn("Post-bulk-delete refresh failed:",me)}},[r,Me,St,We,c,t]),cr=A.useCallback(async $=>{if(!c)return;let X=null,Ae=[];if(i(Ce=>Ce.map(se=>se.id===c?(Ae=se.highlights||[],X={...se,highlights:$},X):se)),X){Pe("HIGHLIGHTS",X);let Ce=!1,se="";try{await We(async()=>{await Kv(t,X.id,X.title,X.author,X.highlights||[])}),Ce=!0}catch(me){se=me instanceof Error?me.message:String(me),console.error("Failed to sync highlights to AI Backend:",me)}if(!Ce)Me(X.id),i(me=>me.map(Ee=>Ee.id===X.id?{...Ee,highlights:Ae}:Ee)),window.alert(`Highlight changes could not be saved. Previous version was restored.${se?`
${se}`:""}`);else try{await St()}catch(me){console.warn("Post-highlight refresh failed:",me)}}},[Me,Pe,St,We,c,t]),Tn=A.useCallback(async $=>{const X=r.findIndex(se=>se.id===$);if(X===-1)return;const Ae=r[X],Ce={...Ae,isFavorite:!Ae.isFavorite};i(se=>{const me=[...se];return me[X]=Ce,me}),Pe("ITEM",Ce);try{await We(async()=>{await Qu(t,Ce.id,{isFavorite:Ce.isFavorite})}),await St()}catch(se){console.error("Failed to update favorite status in Oracle:",se),Me(Ce.id),i(Ee=>{const Ye=[...Ee],Fe=Ye.findIndex(rt=>rt.id===$);return Fe!==-1&&(Ye[Fe]=Ae),Ye});const me=se instanceof Error?se.message:String(se);window.alert(`Favorite update failed. Previous value was restored.
${me}`)}},[r,Me,Pe,Qu,St,We,t]),xs=A.useCallback(async($,X)=>{const Ae=r.findIndex(Ee=>Ee.id===$);if(Ae===-1)return;const Ce=r[Ae],se=Ce.highlights.map(Ee=>Ee.id===X?{...Ee,isFavorite:!Ee.isFavorite}:Ee),me={...Ce,highlights:se};i(Ee=>{const Ye=[...Ee];return Ye[Ae]=me,Ye});try{await We(async()=>{await Kv(t,me.id,me.title,me.author,me.highlights||[])}),await St()}catch(Ee){console.error("Failed to update highlight favorite status in backend:",Ee),i(Fe=>{const rt=[...Fe],et=rt.findIndex(Zt=>Zt.id===$);return et!==-1&&(rt[et]=Ce),rt});const Ye=Ee instanceof Error?Ee.message:String(Ee);window.alert(`Highlight favorite update failed. Previous value was restored.
${Ye}`)}},[r,St,We,t]),On=A.useCallback($=>{i(X=>X.map(Ae=>Ae.id===$.id?$:Ae))},[]),{isEnriching:aa,stats:Wr,startEnrichment:vi,stopEnrichment:At}=HJ(t,On),Kt=r.find($=>$.id===c)||void 0,Vt=r.find($=>$.id===x),vt=A.useCallback($=>{k($),s("list"),d(null),xe(1),ie(""),B("ALL"),Z(""),$!=="BOOK"&&de(null)},[]),Yt=A.useCallback($=>{de($),B("ALL"),k("BOOK"),s("list"),d(null),xe(1),ie(""),Z(""),C(!1),S(null)},[]),Xn=A.useCallback($=>{B($),de(null),k("BOOK"),s("list"),d(null),xe(1),ie(""),Z(""),C(!1),S(null)},[]);A.useCallback(async()=>{if(j)try{const{items:$,lastDoc:X}=await Fh(t,1e3,j);i(Ae=>[...Ae,...$]),U(X),le(!!X)}catch($){console.error("Error loading more items:",$)}},[t,j]);const ur=()=>`folder-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,vn=A.useCallback(async($,X)=>{const Ae=X.trim();if(!Ae)return null;const Ce=Date.now(),se=J.filter(Ee=>Ee.category===$).reduce((Ee,Ye)=>Math.max(Ee,Ye.order),0)+1,me={id:ur(),category:$,name:Ae,order:se,createdAt:Ce,updatedAt:Ce};we(Ee=>[...Ee,me]);try{return await $_(t,me),me}catch(Ee){return console.error("Failed to create personal note folder:",Ee),we(Ye=>Ye.filter(Fe=>Fe.id!==me.id)),null}},[J,t]),Rr=A.useCallback(async($,X)=>{const Ae=X.trim();if(!Ae)return!1;const Ce=J,se=Date.now();we(me=>me.map(Ee=>Ee.id===$?{...Ee,name:Ae,updatedAt:se}:Ee));try{return await G_(t,$,{name:Ae,updatedAt:se}),i(me=>me.map(Ee=>!gn(Ee)||Ee.personalFolderId!==$?Ee:{...Ee,folderPath:Ae})),!0}catch(me){return console.error("Failed to rename personal note folder:",me),we(Ce),!1}},[J,t]),Kn=A.useCallback(async $=>{if(!J.find(me=>me.id===$))return!1;const Ae=J,Ce=r,se=r.filter(me=>gn(me)&&me.personalFolderId===$);we(me=>me.filter(Ee=>Ee.id!==$)),i(me=>me.map(Ee=>!gn(Ee)||Ee.personalFolderId!==$?Ee:{...Ee,personalFolderId:void 0,folderPath:void 0}));try{return await Promise.all([...se.map(me=>zh(t,me.id,Nr(me),void 0,void 0)),OJ(t,$)]),!0}catch(me){return console.error("Failed to delete personal note folder:",me),we(Ae),i(Ce),!1}},[r,J,t]),Sr=A.useCallback(async($,X)=>{const Ae=J.find(Fe=>Fe.id===$);if(!Ae)return!1;if(Ae.category===X)return!0;const Ce=J,se=r,me=Date.now(),Ee=J.filter(Fe=>Fe.category===X&&Fe.id!==$).reduce((Fe,rt)=>Math.max(Fe,rt.order),0)+1,Ye=r.filter(Fe=>gn(Fe)&&Fe.personalFolderId===$);we(Fe=>Fe.map(rt=>rt.id!==$?rt:{...rt,category:X,order:Ee,updatedAt:me})),i(Fe=>Fe.map(rt=>!gn(rt)||rt.personalFolderId!==$?rt:{...rt,personalNoteCategory:X,personalFolderId:$,folderPath:Ae.name}));try{return await Promise.all([G_(t,$,{category:X,order:Ee,updatedAt:me}),...Ye.map(Fe=>zh(t,Fe.id,X,$,Ae.name))]),await Promise.all(Ye.map(Fe=>or({...Fe,personalNoteCategory:X,personalFolderId:$,folderPath:Ae.name},!1))),!0}catch(Fe){return console.error("Failed to move personal note folder:",Fe),we(Ce),i(se),!1}},[r,J,or,t]),In=A.useCallback(async($,X,Ae)=>{const Ce=r.find(et=>et.id===$);if(!Ce||!gn(Ce))return!1;const se=Ae?J.find(et=>et.id===Ae):void 0,me=se==null?void 0:se.id,Ee=se==null?void 0:se.name,Ye=Nr(Ce),Fe=Ce.personalFolderId,rt=Ce.folderPath;if(Ye===X&&(Fe||void 0)===(me||void 0))return!0;i(et=>et.map(Zt=>Zt.id!==$||!gn(Zt)?Zt:{...Zt,personalNoteCategory:X,personalFolderId:me,folderPath:Ee}));try{return await zh(t,$,X,me,Ee),await or({...Ce,personalNoteCategory:X,personalFolderId:me,folderPath:Ee},!1),!0}catch(et){return console.error("Failed to move personal note:",et),i(Zt=>Zt.map(bt=>bt.id!==$||!gn(bt)?bt:{...bt,personalNoteCategory:Ye,personalFolderId:Fe,folderPath:rt})),!1}},[r,J,or,t]);return A.useEffect(()=>{if(L||z)return;const $=r.filter(Ce=>gn(Ce)&&!!Ce.folderPath&&!Ce.personalFolderId);if($.length===0){ae(!0);return}let X=!1;return(async()=>{const Ce=new Map;J.forEach(Ee=>{const Ye=`${Ee.category}::${Ee.name.toLowerCase()}`;Ce.set(Ye,Ee)});const se=[],me=[];if($.forEach(Ee=>{const Ye=Nr(Ee),Fe=(Ee.folderPath||"").trim();if(!Fe)return;const rt=`${Ye}::${Fe.toLowerCase()}`;let et=Ce.get(rt);if(!et){const Zt=Date.now(),bt=Math.max(...J.filter(Tt=>Tt.category===Ye).map(Tt=>Tt.order),...se.filter(Tt=>Tt.category===Ye).map(Tt=>Tt.order),0)+1;et={id:ur(),category:Ye,name:Fe,order:bt,createdAt:Zt,updatedAt:Zt},se.push(et),Ce.set(rt,et)}me.push({noteId:Ee.id,category:Ye,folderId:et.id,folderPath:et.name})}),!X){se.length>0&&we(Ee=>[...Ee,...se]),me.length>0&&i(Ee=>Ee.map(Ye=>{const Fe=me.find(rt=>rt.noteId===Ye.id);return!Fe||!gn(Ye)?Ye:{...Ye,personalNoteCategory:Fe.category,personalFolderId:Fe.folderId,folderPath:Fe.folderPath}}));try{await Promise.all([...se.map(Ee=>$_(t,Ee)),...me.map(Ee=>zh(t,Ee.noteId,Ee.category,Ee.folderId,Ee.folderPath))])}catch(Ee){console.error("Legacy personal note folder migration failed:",Ee)}finally{X||ae(!0)}}})(),()=>{X=!0}},[r,z,L,J,t]),L&&r.length===0?m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 text-slate-500",children:"Loading your library from cloud..."}):m.jsxs("div",{className:"flex h-screen bg-[#F7F8FB] dark:bg-[#0b0e14] overflow-hidden",children:[m.jsx(RJ,{activeTab:N,onTabChange:vt,isOpen:I,onClose:()=>D(!1)}),m.jsx("main",{className:`flex-1 flex flex-col h-full w-full relative overflow-y-auto transition-all duration-300 bg-[#F7F8FB] dark:bg-[#0b0e14] noise-bg\r
`,children:N==="PROFILE"?m.jsx(BJ,{email:e,userId:t,onLogout:n,onBack:()=>vt("DASHBOARD"),books:r,onStartEnrichment:vi,onStopEnrichment:At,isEnriching:aa,enrichmentStats:Wr}):N==="SMART_SEARCH"?m.jsx(UJ,{userId:t,onBack:()=>vt("DASHBOARD"),books:r}):N==="RAG_SEARCH"?m.jsx(GJ,{userId:t,userEmail:e,onBack:()=>vt("DASHBOARD"),books:r}):N==="FLOW"?m.jsx(tQ,{firebaseUid:t,anchorType:"topic",anchorId:"General Discovery",categoryOptions:Ut,onClose:()=>vt("DASHBOARD")}):o==="list"?m.jsx(KV,{books:r,activeTab:N,userId:t,categoryFilter:q,onCategoryFilterChange:de,onCategoryNavigate:Yt,onStatusNavigate:Xn,onSelectBook:$=>{d($.id),C(!1),s("detail")},onSelectBookWithTab:($,X,Ae)=>{d($.id),C(X==="highlights"),S(Ae||null),s("detail")},onAddBook:()=>{_e({}),v(null),p(!0)},personalNoteFolders:J,onCreatePersonalFolder:vn,onRenamePersonalFolder:Rr,onDeletePersonalFolder:Kn,onMovePersonalFolder:Sr,onMovePersonalNote:In,onAddPersonalNote:({category:$,folderId:X,folderPath:Ae})=>{zi({category:$,folderId:X,folderPath:Ae})},onQuickCreatePersonalNote:lr,onMobileMenuClick:()=>D(!0),onDeleteBook:Gr,onDeleteMultiple:xn,onToggleFavorite:Tn,onToggleHighlightFavorite:xs,currentPage:ge,onPageChange:xe,searchQuery:H,onSearchChange:ie,statusFilter:K,onStatusFilterChange:B,sortOption:G,onSortOptionChange:M,publisherFilter:V,onPublisherFilterChange:Z,onTabChange:vt}):Kt&&m.jsx(IJ,{book:Kt,initialTab:b?"highlights":"info",autoEditHighlightId:E||void 0,onBack:()=>{d(null),C(!1),S(null),s("list")},onEdit:()=>{v(Kt.id),p(!0)},onDelete:()=>Gr(Kt.id),onUpdateHighlights:cr,onBookUpdated:On})}),h&&m.jsx(XZ,{initialType:Vt?Vt.type:N==="NOTES"||N==="DASHBOARD"||N==="PROFILE"||N==="RAG_SEARCH"||N==="SMART_SEARCH"||N==="FLOW"?"BOOK":N,initialData:Vt,noteDefaults:!Vt&&N==="PERSONAL_NOTE"?re:void 0,onSave:x?xi:Er,onCancel:()=>{p(!1),v(null),_e({})}})]})},rQ=()=>{const{user:t,loading:e,loginWithGoogle:n,logout:r}=a1();return e?m.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-500",children:"Loading..."}):t?m.jsx(hD,{children:m.jsx(nQ,{userId:t.uid,userEmail:t.email,onLogout:r})}):m.jsx("div",{className:`min-h-screen flex items-center justify-center bg-[#F7F8FB] dark:bg-[#0b0e14] transition-colors duration-300\r
`,children:m.jsxs("div",{className:"bg-white dark:bg-slate-900 shadow-lg rounded-2xl px-8 py-10 flex flex-col items-center gap-4 border border-slate-100 dark:border-slate-800",children:[m.jsx("div",{className:"flex flex-col items-center gap-6 mb-12",children:m.jsx("img",{src:ST,alt:"TomeHub Icon",className:"h-[156px] w-auto object-contain brightness-110 drop-shadow-xl"})}),m.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center max-w-xs",children:"Sign in with your Google account to access your library across all devices."}),m.jsx("button",{onClick:n,className:"mt-2 bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white px-5 py-2 rounded-lg text-sm font-medium shadow-md transition-colors",children:"Continue with Google"})]})})},iQ=()=>m.jsx(qZ,{children:m.jsx(DJ,{children:m.jsx(rQ,{})})}),OT=document.getElementById("root");if(!OT)throw new Error("Could not find root element to mount to");const aQ=WO.createRoot(OT);aQ.render(m.jsx(Qe.StrictMode,{children:m.jsx(iQ,{})}));export{$h as A,Zx as B,xp as C,lQ as F,$4 as H,cQ as I,V4 as K,JM as M,G4 as N,oQ as P,sQ as S,Gh as W,M9 as a,vd as b,Oe as c,tM as d,Qa as e,g4 as f,$s as g,Ka as h,m as j,A as r};
