(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function Jx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ng={exports:{}},xc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n2;function gj(){if(n2)return xc;n2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var c in s)c!=="key"&&(a[c]=s[c])}else a=s;return s=a.ref,{$$typeof:t,type:r,key:l,ref:s!==void 0?s:null,props:a}}return xc.Fragment=e,xc.jsx=n,xc.jsxs=n,xc}var r2;function xj(){return r2||(r2=1,Ng.exports=gj()),Ng.exports}var h=xj(),Tg={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2;function bj(){if(s2)return Ke;s2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),b=Symbol.iterator;function v(A){return A===null||typeof A!="object"?null:(A=b&&A[b]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,k={};function N(A,R,W){this.props=A,this.context=R,this.refs=k,this.updater=W||w}N.prototype.isReactComponent={},N.prototype.setState=function(A,R){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,R,"setState")},N.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function M(){}M.prototype=N.prototype;function _(A,R,W){this.props=A,this.context=R,this.refs=k,this.updater=W||w}var P=_.prototype=new M;P.constructor=_,C(P,N.prototype),P.isPureReactComponent=!0;var z=Array.isArray;function K(){}var O={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function V(A,R,W){var oe=W.ref;return{$$typeof:t,type:A,key:R,ref:oe!==void 0?oe:null,props:W}}function Z(A,R){return V(A.type,R,A.props)}function he(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function Te(A){var R={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(W){return R[W]})}var ve=/\/+/g;function Se(A,R){return typeof A=="object"&&A!==null&&A.key!=null?Te(""+A.key):R.toString(36)}function Ee(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(K,K):(A.status="pending",A.then(function(R){A.status==="pending"&&(A.status="fulfilled",A.value=R)},function(R){A.status==="pending"&&(A.status="rejected",A.reason=R)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function q(A,R,W,oe,xe){var L=typeof A;(L==="undefined"||L==="boolean")&&(A=null);var ae=!1;if(A===null)ae=!0;else switch(L){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(A.$$typeof){case t:case e:ae=!0;break;case m:return ae=A._init,q(ae(A._payload),R,W,oe,xe)}}if(ae)return xe=xe(A),ae=oe===""?"."+Se(A,0):oe,z(xe)?(W="",ae!=null&&(W=ae.replace(ve,"$&/")+"/"),q(xe,R,W,"",function(ie){return ie})):xe!=null&&(he(xe)&&(xe=Z(xe,W+(xe.key==null||A&&A.key===xe.key?"":(""+xe.key).replace(ve,"$&/")+"/")+ae)),R.push(xe)),1;ae=0;var U=oe===""?".":oe+":";if(z(A))for(var ne=0;ne<A.length;ne++)oe=A[ne],L=U+Se(oe,ne),ae+=q(oe,R,W,L,xe);else if(ne=v(A),typeof ne=="function")for(A=ne.call(A),ne=0;!(oe=A.next()).done;)oe=oe.value,L=U+Se(oe,ne++),ae+=q(oe,R,W,L,xe);else if(L==="object"){if(typeof A.then=="function")return q(Ee(A),R,W,oe,xe);throw R=String(A),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.")}return ae}function te(A,R,W){if(A==null)return A;var oe=[],xe=0;return q(A,oe,"","",function(L){return R.call(W,L,xe++)}),oe}function G(A){if(A._status===-1){var R=A._result;R=R(),R.then(function(W){(A._status===0||A._status===-1)&&(A._status=1,A._result=W)},function(W){(A._status===0||A._status===-1)&&(A._status=2,A._result=W)}),A._status===-1&&(A._status=0,A._result=R)}if(A._status===1)return A._result.default;throw A._result}var I=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(R))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},H={map:te,forEach:function(A,R,W){te(A,function(){R.apply(this,arguments)},W)},count:function(A){var R=0;return te(A,function(){R++}),R},toArray:function(A){return te(A,function(R){return R})||[]},only:function(A){if(!he(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Ke.Activity=g,Ke.Children=H,Ke.Component=N,Ke.Fragment=n,Ke.Profiler=s,Ke.PureComponent=_,Ke.StrictMode=r,Ke.Suspense=d,Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ke.__COMPILER_RUNTIME={__proto__:null,c:function(A){return O.H.useMemoCache(A)}},Ke.cache=function(A){return function(){return A.apply(null,arguments)}},Ke.cacheSignal=function(){return null},Ke.cloneElement=function(A,R,W){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var oe=C({},A.props),xe=A.key;if(R!=null)for(L in R.key!==void 0&&(xe=""+R.key),R)!F.call(R,L)||L==="key"||L==="__self"||L==="__source"||L==="ref"&&R.ref===void 0||(oe[L]=R[L]);var L=arguments.length-2;if(L===1)oe.children=W;else if(1<L){for(var ae=Array(L),U=0;U<L;U++)ae[U]=arguments[U+2];oe.children=ae}return V(A.type,xe,oe)},Ke.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:a,_context:A},A},Ke.createElement=function(A,R,W){var oe,xe={},L=null;if(R!=null)for(oe in R.key!==void 0&&(L=""+R.key),R)F.call(R,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(xe[oe]=R[oe]);var ae=arguments.length-2;if(ae===1)xe.children=W;else if(1<ae){for(var U=Array(ae),ne=0;ne<ae;ne++)U[ne]=arguments[ne+2];xe.children=U}if(A&&A.defaultProps)for(oe in ae=A.defaultProps,ae)xe[oe]===void 0&&(xe[oe]=ae[oe]);return V(A,L,xe)},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(A){return{$$typeof:c,render:A}},Ke.isValidElement=he,Ke.lazy=function(A){return{$$typeof:m,_payload:{_status:-1,_result:A},_init:G}},Ke.memo=function(A,R){return{$$typeof:p,type:A,compare:R===void 0?null:R}},Ke.startTransition=function(A){var R=O.T,W={};O.T=W;try{var oe=A(),xe=O.S;xe!==null&&xe(W,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(K,I)}catch(L){I(L)}finally{R!==null&&W.types!==null&&(R.types=W.types),O.T=R}},Ke.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ke.use=function(A){return O.H.use(A)},Ke.useActionState=function(A,R,W){return O.H.useActionState(A,R,W)},Ke.useCallback=function(A,R){return O.H.useCallback(A,R)},Ke.useContext=function(A){return O.H.useContext(A)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(A,R){return O.H.useDeferredValue(A,R)},Ke.useEffect=function(A,R){return O.H.useEffect(A,R)},Ke.useEffectEvent=function(A){return O.H.useEffectEvent(A)},Ke.useId=function(){return O.H.useId()},Ke.useImperativeHandle=function(A,R,W){return O.H.useImperativeHandle(A,R,W)},Ke.useInsertionEffect=function(A,R){return O.H.useInsertionEffect(A,R)},Ke.useLayoutEffect=function(A,R){return O.H.useLayoutEffect(A,R)},Ke.useMemo=function(A,R){return O.H.useMemo(A,R)},Ke.useOptimistic=function(A,R){return O.H.useOptimistic(A,R)},Ke.useReducer=function(A,R,W){return O.H.useReducer(A,R,W)},Ke.useRef=function(A){return O.H.useRef(A)},Ke.useState=function(A){return O.H.useState(A)},Ke.useSyncExternalStore=function(A,R,W){return O.H.useSyncExternalStore(A,R,W)},Ke.useTransition=function(){return O.H.useTransition()},Ke.version="19.2.0",Ke}var i2;function pu(){return i2||(i2=1,Tg.exports=bj()),Tg.exports}var E=pu();const We=Jx(E);var Ag={exports:{}},bc={},Mg={exports:{}},Og={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a2;function yj(){return a2||(a2=1,(function(t){function e(q,te){var G=q.length;q.push(te);e:for(;0<G;){var I=G-1>>>1,H=q[I];if(0<s(H,te))q[I]=te,q[G]=H,G=I;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var te=q[0],G=q.pop();if(G!==te){q[0]=G;e:for(var I=0,H=q.length,A=H>>>1;I<A;){var R=2*(I+1)-1,W=q[R],oe=R+1,xe=q[oe];if(0>s(W,G))oe<H&&0>s(xe,W)?(q[I]=xe,q[oe]=G,I=oe):(q[I]=W,q[R]=G,I=R);else if(oe<H&&0>s(xe,G))q[I]=xe,q[oe]=G,I=oe;else break e}}return te}function s(q,te){var G=q.sortIndex-te.sortIndex;return G!==0?G:q.id-te.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],p=[],m=1,g=null,b=3,v=!1,w=!1,C=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function P(q){for(var te=n(p);te!==null;){if(te.callback===null)r(p);else if(te.startTime<=q)r(p),te.sortIndex=te.expirationTime,e(d,te);else break;te=n(p)}}function z(q){if(C=!1,P(q),!w)if(n(d)!==null)w=!0,K||(K=!0,Te());else{var te=n(p);te!==null&&Ee(z,te.startTime-q)}}var K=!1,O=-1,F=5,V=-1;function Z(){return k?!0:!(t.unstable_now()-V<F)}function he(){if(k=!1,K){var q=t.unstable_now();V=q;var te=!0;try{e:{w=!1,C&&(C=!1,M(O),O=-1),v=!0;var G=b;try{t:{for(P(q),g=n(d);g!==null&&!(g.expirationTime>q&&Z());){var I=g.callback;if(typeof I=="function"){g.callback=null,b=g.priorityLevel;var H=I(g.expirationTime<=q);if(q=t.unstable_now(),typeof H=="function"){g.callback=H,P(q),te=!0;break t}g===n(d)&&r(d),P(q)}else r(d);g=n(d)}if(g!==null)te=!0;else{var A=n(p);A!==null&&Ee(z,A.startTime-q),te=!1}}break e}finally{g=null,b=G,v=!1}te=void 0}}finally{te?Te():K=!1}}}var Te;if(typeof _=="function")Te=function(){_(he)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Se=ve.port2;ve.port1.onmessage=he,Te=function(){Se.postMessage(null)}}else Te=function(){N(he,0)};function Ee(q,te){O=N(function(){q(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(q){switch(b){case 1:case 2:case 3:var te=3;break;default:te=b}var G=b;b=te;try{return q()}finally{b=G}},t.unstable_requestPaint=function(){k=!0},t.unstable_runWithPriority=function(q,te){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var G=b;b=q;try{return te()}finally{b=G}},t.unstable_scheduleCallback=function(q,te,G){var I=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?I+G:I):G=I,q){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=G+H,q={id:m++,callback:te,priorityLevel:q,startTime:G,expirationTime:H,sortIndex:-1},G>I?(q.sortIndex=G,e(p,q),n(d)===null&&q===n(p)&&(C?(M(O),O=-1):C=!0,Ee(z,G-I))):(q.sortIndex=H,e(d,q),w||v||(w=!0,K||(K=!0,Te()))),q},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(q){var te=b;return function(){var G=b;b=te;try{return q.apply(this,arguments)}finally{b=G}}}})(Og)),Og}var o2;function vj(){return o2||(o2=1,Mg.exports=yj()),Mg.exports}var jg={exports:{}},Rn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l2;function wj(){if(l2)return Rn;l2=1;var t=pu();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,p,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:d,containerInfo:p,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Rn.createPortal=function(d,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(d,p,null,m)},Rn.flushSync=function(d){var p=l.T,m=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=p,r.p=m,r.d.f()}},Rn.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(d,p))},Rn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Rn.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var m=p.as,g=c(m,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,v=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?r.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):m==="script"&&r.d.X(d,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Rn.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=c(p.as,p.crossOrigin);r.d.M(d,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(d)},Rn.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,g=c(m,p.crossOrigin);r.d.L(d,m,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Rn.preloadModule=function(d,p){if(typeof d=="string")if(p){var m=c(p.as,p.crossOrigin);r.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(d)},Rn.requestFormReset=function(d){r.d.r(d)},Rn.unstable_batchedUpdates=function(d,p){return d(p)},Rn.useFormState=function(d,p,m){return l.H.useFormState(d,p,m)},Rn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Rn.version="19.2.0",Rn}var c2;function qS(){if(c2)return jg.exports;c2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),jg.exports=wj(),jg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2;function kj(){if(u2)return bc;u2=1;var t=vj(),e=pu(),n=qS();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function c(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function d(i){if(a(i)!==i)throw Error(r(188))}function p(i){var o=i.alternate;if(!o){if(o=a(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,f=o;;){var x=u.return;if(x===null)break;var y=x.alternate;if(y===null){if(f=x.return,f!==null){u=f;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===u)return d(x),i;if(y===f)return d(x),o;y=y.sibling}throw Error(r(188))}if(u.return!==f.return)u=x,f=y;else{for(var S=!1,T=x.child;T;){if(T===u){S=!0,u=x,f=y;break}if(T===f){S=!0,f=x,u=y;break}T=T.sibling}if(!S){for(T=y.child;T;){if(T===u){S=!0,u=y,f=x;break}if(T===f){S=!0,f=y,u=x;break}T=T.sibling}if(!S)throw Error(r(189))}}if(u.alternate!==f)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function m(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=m(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),_=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),he=Symbol.iterator;function Te(i){return i===null||typeof i!="object"?null:(i=he&&i[he]||i["@@iterator"],typeof i=="function"?i:null)}var ve=Symbol.for("react.client.reference");function Se(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ve?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case N:return"Profiler";case k:return"StrictMode";case z:return"Suspense";case K:return"SuspenseList";case V:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case _:return i.displayName||"Context";case M:return(i._context.displayName||"Context")+".Consumer";case P:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case O:return o=i.displayName||null,o!==null?o:Se(i.type)||"Memo";case F:o=i._payload,i=i._init;try{return Se(i(o))}catch{}}return null}var Ee=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G={pending:!1,data:null,method:null,action:null},I=[],H=-1;function A(i){return{current:i}}function R(i){0>H||(i.current=I[H],I[H]=null,H--)}function W(i,o){H++,I[H]=i.current,i.current=o}var oe=A(null),xe=A(null),L=A(null),ae=A(null);function U(i,o){switch(W(L,o),W(xe,i),W(oe,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?Ew(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=Ew(o),i=Nw(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}R(oe),W(oe,i)}function ne(){R(oe),R(xe),R(L)}function ie(i){i.memoizedState!==null&&W(ae,i);var o=oe.current,u=Nw(o,i.type);o!==u&&(W(xe,i),W(oe,u))}function je(i){xe.current===i&&(R(oe),R(xe)),ae.current===i&&(R(ae),hc._currentValue=G)}var Ue,lt;function Fe(i){if(Ue===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Ue=o&&o[1]||"",lt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ue+i+lt}var nt=!1;function pt(i,o){if(!i||nt)return"";nt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(se){var ee=se}Reflect.construct(i,[],de)}else{try{de.call()}catch(se){ee=se}i.call(de.prototype)}}else{try{throw Error()}catch(se){ee=se}(de=i())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(se){if(se&&ee&&typeof se.stack=="string")return[se.stack,ee.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),S=y[0],T=y[1];if(S&&T){var D=S.split(`
`),X=T.split(`
`);for(x=f=0;f<D.length&&!D[f].includes("DetermineComponentFrameRoot");)f++;for(;x<X.length&&!X[x].includes("DetermineComponentFrameRoot");)x++;if(f===D.length||x===X.length)for(f=D.length-1,x=X.length-1;1<=f&&0<=x&&D[f]!==X[x];)x--;for(;1<=f&&0<=x;f--,x--)if(D[f]!==X[x]){if(f!==1||x!==1)do if(f--,x--,0>x||D[f]!==X[x]){var le=`
`+D[f].replace(" at new "," at ");return i.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",i.displayName)),le}while(1<=f&&0<=x);break}}}finally{nt=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?Fe(u):""}function Me(i,o){switch(i.tag){case 26:case 27:case 5:return Fe(i.type);case 16:return Fe("Lazy");case 13:return i.child!==o&&o!==null?Fe("Suspense Fallback"):Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 15:return pt(i.type,!1);case 11:return pt(i.type.render,!1);case 1:return pt(i.type,!0);case 31:return Fe("Activity");default:return""}}function rt(i){try{var o="",u=null;do o+=Me(i,u),u=i,i=i.return;while(i);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var De=Object.prototype.hasOwnProperty,_e=t.unstable_scheduleCallback,an=t.unstable_cancelCallback,on=t.unstable_shouldYield,Kn=t.unstable_requestPaint,Dt=t.unstable_now,ms=t.unstable_getCurrentPriorityLevel,Gr=t.unstable_ImmediatePriority,Gn=t.unstable_UserBlockingPriority,hn=t.unstable_NormalPriority,Yn=t.unstable_LowPriority,Yr=t.unstable_IdlePriority,Xt=t.log,Pn=t.unstable_setDisableYieldValue,pn=null,Ht=null;function kn(i){if(typeof Xt=="function"&&Pn(i),Ht&&typeof Ht.setStrictMode=="function")try{Ht.setStrictMode(pn,i)}catch{}}var Kt=Math.clz32?Math.clz32:Jr,aa=Math.log,ln=Math.LN2;function Jr(i){return i>>>=0,i===0?32:31-(aa(i)/ln|0)|0}var Jn=256,yr=262144,Q=4194304;function re(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ue(i,o,u){var f=i.pendingLanes;if(f===0)return 0;var x=0,y=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var T=f&134217727;return T!==0?(f=T&~y,f!==0?x=re(f):(S&=T,S!==0?x=re(S):u||(u=T&~i,u!==0&&(x=re(u))))):(T=f&~y,T!==0?x=re(T):S!==0?x=re(S):u||(u=f&~i,u!==0&&(x=re(u)))),x===0?0:o!==0&&o!==x&&(o&y)===0&&(y=x&-x,u=o&-o,y>=u||y===32&&(u&4194048)!==0)?o:x}function me(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function ke(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var i=Q;return Q<<=1,(Q&62914560)===0&&(Q=4194304),i}function be(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Ve(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ae(i,o,u,f,x,y){var S=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var T=i.entanglements,D=i.expirationTimes,X=i.hiddenUpdates;for(u=S&~u;0<u;){var le=31-Kt(u),de=1<<le;T[le]=0,D[le]=-1;var ee=X[le];if(ee!==null)for(X[le]=null,le=0;le<ee.length;le++){var se=ee[le];se!==null&&(se.lane&=-536870913)}u&=~de}f!==0&&Qe(i,f,0),y!==0&&x===0&&i.tag!==0&&(i.suspendedLanes|=y&~(S&~o))}function Qe(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var f=31-Kt(o);i.entangledLanes|=o,i.entanglements[f]=i.entanglements[f]|1073741824|u&261930}function Pe(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var f=31-Kt(u),x=1<<f;x&o|i[f]&o&&(i[f]|=o),u&=~x}}function st(i,o){var u=o&-o;return u=(u&42)!==0?1:ft(u),(u&(i.suspendedLanes|o))!==0?0:u}function ft(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function It(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Cn(){var i=te.p;return i!==0?i:(i=window.event,i===void 0?32:Yw(i.type))}function or(i,o){var u=te.p;try{return te.p=i,o()}finally{te.p=u}}var Hn=Math.random().toString(36).slice(2),cn="__reactFiber$"+Hn,mn="__reactProps$"+Hn,ni="__reactContainer$"+Hn,Cl="__reactEvents$"+Hn,yp="__reactListeners$"+Hn,vp="__reactHandles$"+Hn,Sl="__reactResources$"+Hn,ri="__reactMarker$"+Hn;function El(i){delete i[cn],delete i[mn],delete i[Cl],delete i[yp],delete i[vp]}function si(i){var o=i[cn];if(o)return o;for(var u=i.parentNode;u;){if(o=u[ni]||u[cn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=Rw(i);i!==null;){if(u=i[cn])return u;i=Rw(i)}return o}i=u,u=i.parentNode}return null}function ii(i){if(i=i[cn]||i[ni]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function oa(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function ai(i){var o=i[Sl];return o||(o=i[Sl]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Qt(i){i[ri]=!0}var Fn=new Set,Du={};function vr(i,o){gs(i,o),gs(i+"Capture",o)}function gs(i,o){for(Du[i]=o,i=0;i<o.length;i++)Fn.add(o[i])}var Nl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Tl={},Al={};function wp(i){return De.call(Al,i)?!0:De.call(Tl,i)?!1:Nl.test(i)?Al[i]=!0:(Tl[i]=!0,!1)}function Ml(i,o,u){if(wp(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function so(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Y(i,o,u,f){if(f===null)i.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+f)}}function j(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ce(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function pe(i,o,u){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,y=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return x.call(this)},set:function(S){u=""+S,y.call(this,S)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ze(i){if(!i._valueTracker){var o=Ce(i)?"checked":"value";i._valueTracker=pe(i,o,""+i[o])}}function wt(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return i&&(f=Ce(i)?i.checked?"true":"false":i.value),i=f,i!==u?(o.setValue(i),!0):!1}function zt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Xr=/[\n"\\]/g;function Bt(i){return i.replace(Xr,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function lr(i,o,u,f,x,y,S,T){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),o!=null?S==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+j(o)):i.value!==""+j(o)&&(i.value=""+j(o)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),o!=null?la(i,S,j(o)):u!=null?la(i,S,j(u)):f!=null&&i.removeAttribute("value"),x==null&&y!=null&&(i.defaultChecked=!!y),x!=null&&(i.checked=x&&typeof x!="function"&&typeof x!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+j(T):i.removeAttribute("name")}function Qr(i,o,u,f,x,y,S,T){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),o!=null||u!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){Ze(i);return}u=u!=null?""+j(u):"",o=o!=null?""+j(o):u,T||o===i.value||(i.value=o),i.defaultValue=o}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=T?i.checked:!!f,i.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S),Ze(i)}function la(i,o,u){o==="number"&&zt(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function io(i,o,u,f){if(i=i.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<i.length;u++)x=o.hasOwnProperty("$"+i[u].value),i[u].selected!==x&&(i[u].selected=x),x&&f&&(i[u].defaultSelected=!0)}else{for(u=""+j(u),o=null,x=0;x<i.length;x++){if(i[x].value===u){i[x].selected=!0,f&&(i[x].defaultSelected=!0);return}o!==null||i[x].disabled||(o=i[x])}o!==null&&(o.selected=!0)}}function vy(i,o,u){if(o!=null&&(o=""+j(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+j(u):""}function wy(i,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(r(92));if(Ee(f)){if(1<f.length)throw Error(r(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=j(o),i.defaultValue=u,f=i.textContent,f===u&&f!==""&&f!==null&&(i.value=f),Ze(i)}function ao(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var dM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ky(i,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":f?i.setProperty(o,u):typeof u!="number"||u===0||dM.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function Cy(i,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var x in o)f=o[x],o.hasOwnProperty(x)&&u[x]!==f&&ky(i,x,f)}else for(var y in o)o.hasOwnProperty(y)&&ky(i,y,o[y])}function kp(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lu(i){return hM.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function xs(){}var Cp=null;function Sp(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var oo=null,lo=null;function Sy(i){var o=ii(i);if(o&&(i=o.stateNode)){var u=i[mn]||null;e:switch(i=o.stateNode,o.type){case"input":if(lr(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Bt(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==i&&f.form===i.form){var x=f[mn]||null;if(!x)throw Error(r(90));lr(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===i.form&&wt(f)}break e;case"textarea":vy(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&io(i,!!u.multiple,o,!1)}}}var Ep=!1;function Ey(i,o,u){if(Ep)return i(o,u);Ep=!0;try{var f=i(o);return f}finally{if(Ep=!1,(oo!==null||lo!==null)&&(kd(),oo&&(o=oo,i=lo,lo=oo=null,Sy(o),i)))for(o=0;o<i.length;o++)Sy(i[o])}}function Ol(i,o){var u=i.stateNode;if(u===null)return null;var f=u[mn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Np=!1;if(bs)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){Np=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{Np=!1}var oi=null,Tp=null,Iu=null;function Ny(){if(Iu)return Iu;var i,o=Tp,u=o.length,f,x="value"in oi?oi.value:oi.textContent,y=x.length;for(i=0;i<u&&o[i]===x[i];i++);var S=u-i;for(f=1;f<=S&&o[u-f]===x[y-f];f++);return Iu=x.slice(i,1<f?1-f:void 0)}function zu(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Bu(){return!0}function Ty(){return!1}function Xn(i){function o(u,f,x,y,S){this._reactName=u,this._targetInst=x,this.type=f,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(u=i[T],this[T]=u?u(y):y[T]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Bu:Ty,this.isPropagationStopped=Ty,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Bu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Bu)},persist:function(){},isPersistent:Bu}),o}var ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pu=Xn(ca),_l=g({},ca,{view:0,detail:0}),pM=Xn(_l),Ap,Mp,Rl,Hu=g({},_l,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jp,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Rl&&(Rl&&i.type==="mousemove"?(Ap=i.screenX-Rl.screenX,Mp=i.screenY-Rl.screenY):Mp=Ap=0,Rl=i),Ap)},movementY:function(i){return"movementY"in i?i.movementY:Mp}}),Ay=Xn(Hu),mM=g({},Hu,{dataTransfer:0}),gM=Xn(mM),xM=g({},_l,{relatedTarget:0}),Op=Xn(xM),bM=g({},ca,{animationName:0,elapsedTime:0,pseudoElement:0}),yM=Xn(bM),vM=g({},ca,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),wM=Xn(vM),kM=g({},ca,{data:0}),My=Xn(kM),CM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NM(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=EM[i])?!!o[i]:!1}function jp(){return NM}var TM=g({},_l,{key:function(i){if(i.key){var o=CM[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=zu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?SM[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jp,charCode:function(i){return i.type==="keypress"?zu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?zu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),AM=Xn(TM),MM=g({},Hu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oy=Xn(MM),OM=g({},_l,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jp}),jM=Xn(OM),_M=g({},ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),RM=Xn(_M),DM=g({},Hu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),LM=Xn(DM),IM=g({},ca,{newState:0,oldState:0}),zM=Xn(IM),BM=[9,13,27,32],_p=bs&&"CompositionEvent"in window,Dl=null;bs&&"documentMode"in document&&(Dl=document.documentMode);var PM=bs&&"TextEvent"in window&&!Dl,jy=bs&&(!_p||Dl&&8<Dl&&11>=Dl),_y=" ",Ry=!1;function Dy(i,o){switch(i){case"keyup":return BM.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ly(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var co=!1;function HM(i,o){switch(i){case"compositionend":return Ly(o);case"keypress":return o.which!==32?null:(Ry=!0,_y);case"textInput":return i=o.data,i===_y&&Ry?null:i;default:return null}}function FM(i,o){if(co)return i==="compositionend"||!_p&&Dy(i,o)?(i=Ny(),Iu=Tp=oi=null,co=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return jy&&o.locale!=="ko"?null:o.data;default:return null}}var UM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iy(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!UM[i.type]:o==="textarea"}function zy(i,o,u,f){oo?lo?lo.push(f):lo=[f]:oo=f,o=Md(o,"onChange"),0<o.length&&(u=new Pu("onChange","change",null,u,f),i.push({event:u,listeners:o}))}var Ll=null,Il=null;function $M(i){yw(i,0)}function Fu(i){var o=oa(i);if(wt(o))return i}function By(i,o){if(i==="change")return o}var Py=!1;if(bs){var Rp;if(bs){var Dp="oninput"in document;if(!Dp){var Hy=document.createElement("div");Hy.setAttribute("oninput","return;"),Dp=typeof Hy.oninput=="function"}Rp=Dp}else Rp=!1;Py=Rp&&(!document.documentMode||9<document.documentMode)}function Fy(){Ll&&(Ll.detachEvent("onpropertychange",Uy),Il=Ll=null)}function Uy(i){if(i.propertyName==="value"&&Fu(Il)){var o=[];zy(o,Il,i,Sp(i)),Ey($M,o)}}function VM(i,o,u){i==="focusin"?(Fy(),Ll=o,Il=u,Ll.attachEvent("onpropertychange",Uy)):i==="focusout"&&Fy()}function qM(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Fu(Il)}function WM(i,o){if(i==="click")return Fu(o)}function KM(i,o){if(i==="input"||i==="change")return Fu(o)}function GM(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var cr=typeof Object.is=="function"?Object.is:GM;function zl(i,o){if(cr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var x=u[f];if(!De.call(o,x)||!cr(i[x],o[x]))return!1}return!0}function $y(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Vy(i,o){var u=$y(i);i=0;for(var f;u;){if(u.nodeType===3){if(f=i+u.textContent.length,i<=o&&f>=o)return{node:u,offset:o-i};i=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=$y(u)}}function qy(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?qy(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Wy(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=zt(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=zt(i.document)}return o}function Lp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var YM=bs&&"documentMode"in document&&11>=document.documentMode,uo=null,Ip=null,Bl=null,zp=!1;function Ky(i,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;zp||uo==null||uo!==zt(f)||(f=uo,"selectionStart"in f&&Lp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Bl&&zl(Bl,f)||(Bl=f,f=Md(Ip,"onSelect"),0<f.length&&(o=new Pu("onSelect","select",null,o,u),i.push({event:o,listeners:f}),o.target=uo)))}function ua(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var fo={animationend:ua("Animation","AnimationEnd"),animationiteration:ua("Animation","AnimationIteration"),animationstart:ua("Animation","AnimationStart"),transitionrun:ua("Transition","TransitionRun"),transitionstart:ua("Transition","TransitionStart"),transitioncancel:ua("Transition","TransitionCancel"),transitionend:ua("Transition","TransitionEnd")},Bp={},Gy={};bs&&(Gy=document.createElement("div").style,"AnimationEvent"in window||(delete fo.animationend.animation,delete fo.animationiteration.animation,delete fo.animationstart.animation),"TransitionEvent"in window||delete fo.transitionend.transition);function da(i){if(Bp[i])return Bp[i];if(!fo[i])return i;var o=fo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in Gy)return Bp[i]=o[u];return i}var Yy=da("animationend"),Jy=da("animationiteration"),Xy=da("animationstart"),JM=da("transitionrun"),XM=da("transitionstart"),QM=da("transitioncancel"),Qy=da("transitionend"),Zy=new Map,Pp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pp.push("scrollEnd");function zr(i,o){Zy.set(i,o),vr(o,[i])}var Uu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},wr=[],ho=0,Hp=0;function $u(){for(var i=ho,o=Hp=ho=0;o<i;){var u=wr[o];wr[o++]=null;var f=wr[o];wr[o++]=null;var x=wr[o];wr[o++]=null;var y=wr[o];if(wr[o++]=null,f!==null&&x!==null){var S=f.pending;S===null?x.next=x:(x.next=S.next,S.next=x),f.pending=x}y!==0&&e1(u,x,y)}}function Vu(i,o,u,f){wr[ho++]=i,wr[ho++]=o,wr[ho++]=u,wr[ho++]=f,Hp|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function Fp(i,o,u,f){return Vu(i,o,u,f),qu(i)}function fa(i,o){return Vu(i,null,null,o),qu(i)}function e1(i,o,u){i.lanes|=u;var f=i.alternate;f!==null&&(f.lanes|=u);for(var x=!1,y=i.return;y!==null;)y.childLanes|=u,f=y.alternate,f!==null&&(f.childLanes|=u),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(x=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,x&&o!==null&&(x=31-Kt(u),i=y.hiddenUpdates,f=i[x],f===null?i[x]=[o]:f.push(o),o.lane=u|536870912),y):null}function qu(i){if(50<ac)throw ac=0,Jm=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var po={};function ZM(i,o,u,f){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(i,o,u,f){return new ZM(i,o,u,f)}function Up(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ys(i,o){var u=i.alternate;return u===null?(u=ur(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function t1(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Wu(i,o,u,f,x,y){var S=0;if(f=i,typeof i=="function")Up(i)&&(S=1);else if(typeof i=="string")S=sj(i,u,oe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case V:return i=ur(31,u,o,x),i.elementType=V,i.lanes=y,i;case C:return ha(u.children,x,y,o);case k:S=8,x|=24;break;case N:return i=ur(12,u,o,x|2),i.elementType=N,i.lanes=y,i;case z:return i=ur(13,u,o,x),i.elementType=z,i.lanes=y,i;case K:return i=ur(19,u,o,x),i.elementType=K,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case _:S=10;break e;case M:S=9;break e;case P:S=11;break e;case O:S=14;break e;case F:S=16,f=null;break e}S=29,u=Error(r(130,i===null?"null":typeof i,"")),f=null}return o=ur(S,u,o,x),o.elementType=i,o.type=f,o.lanes=y,o}function ha(i,o,u,f){return i=ur(7,i,f,o),i.lanes=u,i}function $p(i,o,u){return i=ur(6,i,null,o),i.lanes=u,i}function n1(i){var o=ur(18,null,null,0);return o.stateNode=i,o}function Vp(i,o,u){return o=ur(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var r1=new WeakMap;function kr(i,o){if(typeof i=="object"&&i!==null){var u=r1.get(i);return u!==void 0?u:(o={value:i,source:o,stack:rt(o)},r1.set(i,o),o)}return{value:i,source:o,stack:rt(o)}}var mo=[],go=0,Ku=null,Pl=0,Cr=[],Sr=0,li=null,Zr=1,es="";function vs(i,o){mo[go++]=Pl,mo[go++]=Ku,Ku=i,Pl=o}function s1(i,o,u){Cr[Sr++]=Zr,Cr[Sr++]=es,Cr[Sr++]=li,li=i;var f=Zr;i=es;var x=32-Kt(f)-1;f&=~(1<<x),u+=1;var y=32-Kt(o)+x;if(30<y){var S=x-x%5;y=(f&(1<<S)-1).toString(32),f>>=S,x-=S,Zr=1<<32-Kt(o)+x|u<<x|f,es=y+i}else Zr=1<<y|u<<x|f,es=i}function qp(i){i.return!==null&&(vs(i,1),s1(i,1,0))}function Wp(i){for(;i===Ku;)Ku=mo[--go],mo[go]=null,Pl=mo[--go],mo[go]=null;for(;i===li;)li=Cr[--Sr],Cr[Sr]=null,es=Cr[--Sr],Cr[Sr]=null,Zr=Cr[--Sr],Cr[Sr]=null}function i1(i,o){Cr[Sr++]=Zr,Cr[Sr++]=es,Cr[Sr++]=li,Zr=o.id,es=o.overflow,li=i}var Sn=null,Mt=null,ot=!1,ci=null,Er=!1,Kp=Error(r(519));function ui(i){var o=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hl(kr(o,i)),Kp}function a1(i){var o=i.stateNode,u=i.type,f=i.memoizedProps;switch(o[cn]=i,o[mn]=f,u){case"dialog":tt("cancel",o),tt("close",o);break;case"iframe":case"object":case"embed":tt("load",o);break;case"video":case"audio":for(u=0;u<lc.length;u++)tt(lc[u],o);break;case"source":tt("error",o);break;case"img":case"image":case"link":tt("error",o),tt("load",o);break;case"details":tt("toggle",o);break;case"input":tt("invalid",o),Qr(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":tt("invalid",o);break;case"textarea":tt("invalid",o),wy(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||Cw(o.textContent,u)?(f.popover!=null&&(tt("beforetoggle",o),tt("toggle",o)),f.onScroll!=null&&tt("scroll",o),f.onScrollEnd!=null&&tt("scrollend",o),f.onClick!=null&&(o.onclick=xs),o=!0):o=!1,o||ui(i,!0)}function o1(i){for(Sn=i.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:Er=!1;return;case 27:case 3:Er=!0;return;default:Sn=Sn.return}}function xo(i){if(i!==Sn)return!1;if(!ot)return o1(i),ot=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||dg(i.type,i.memoizedProps)),u=!u),u&&Mt&&ui(i),o1(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Mt=_w(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Mt=_w(i)}else o===27?(o=Mt,Si(i.type)?(i=gg,gg=null,Mt=i):Mt=o):Mt=Sn?Tr(i.stateNode.nextSibling):null;return!0}function pa(){Mt=Sn=null,ot=!1}function Gp(){var i=ci;return i!==null&&(tr===null?tr=i:tr.push.apply(tr,i),ci=null),i}function Hl(i){ci===null?ci=[i]:ci.push(i)}var Yp=A(null),ma=null,ws=null;function di(i,o,u){W(Yp,o._currentValue),o._currentValue=u}function ks(i){i._currentValue=Yp.current,R(Yp)}function Jp(i,o,u){for(;i!==null;){var f=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),i===u)break;i=i.return}}function Xp(i,o,u,f){var x=i.child;for(x!==null&&(x.return=i);x!==null;){var y=x.dependencies;if(y!==null){var S=x.child;y=y.firstContext;e:for(;y!==null;){var T=y;y=x;for(var D=0;D<o.length;D++)if(T.context===o[D]){y.lanes|=u,T=y.alternate,T!==null&&(T.lanes|=u),Jp(y.return,u,i),f||(S=null);break e}y=T.next}}else if(x.tag===18){if(S=x.return,S===null)throw Error(r(341));S.lanes|=u,y=S.alternate,y!==null&&(y.lanes|=u),Jp(S,u,i),S=null}else S=x.child;if(S!==null)S.return=x;else for(S=x;S!==null;){if(S===i){S=null;break}if(x=S.sibling,x!==null){x.return=S.return,S=x;break}S=S.return}x=S}}function bo(i,o,u,f){i=null;for(var x=o,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var S=x.alternate;if(S===null)throw Error(r(387));if(S=S.memoizedProps,S!==null){var T=x.type;cr(x.pendingProps.value,S.value)||(i!==null?i.push(T):i=[T])}}else if(x===ae.current){if(S=x.alternate,S===null)throw Error(r(387));S.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(i!==null?i.push(hc):i=[hc])}x=x.return}i!==null&&Xp(o,i,u,f),o.flags|=262144}function Gu(i){for(i=i.firstContext;i!==null;){if(!cr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ga(i){ma=i,ws=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function En(i){return l1(ma,i)}function Yu(i,o){return ma===null&&ga(i),l1(i,o)}function l1(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ws===null){if(i===null)throw Error(r(308));ws=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else ws=ws.next=o;return u}var eO=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,f){i.push(f)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},tO=t.unstable_scheduleCallback,nO=t.unstable_NormalPriority,Zt={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qp(){return{controller:new eO,data:new Map,refCount:0}}function Fl(i){i.refCount--,i.refCount===0&&tO(nO,function(){i.controller.abort()})}var Ul=null,Zp=0,yo=0,vo=null;function rO(i,o){if(Ul===null){var u=Ul=[];Zp=0,yo=ng(),vo={status:"pending",value:void 0,then:function(f){u.push(f)}}}return Zp++,o.then(c1,c1),o}function c1(){if(--Zp===0&&Ul!==null){vo!==null&&(vo.status="fulfilled");var i=Ul;Ul=null,yo=0,vo=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function sO(i,o){var u=[],f={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return i.then(function(){f.status="fulfilled",f.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(f.status="rejected",f.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),f}var u1=q.S;q.S=function(i,o){Kv=Dt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&rO(i,o),u1!==null&&u1(i,o)};var xa=A(null);function em(){var i=xa.current;return i!==null?i:kt.pooledCache}function Ju(i,o){o===null?W(xa,xa.current):W(xa,o.pool)}function d1(){var i=em();return i===null?null:{parent:Zt._currentValue,pool:i}}var wo=Error(r(460)),tm=Error(r(474)),Xu=Error(r(542)),Qu={then:function(){}};function f1(i){return i=i.status,i==="fulfilled"||i==="rejected"}function h1(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(xs,xs),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,m1(i),i;default:if(typeof o.status=="string")o.then(xs,xs);else{if(i=kt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(f){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=f}},function(f){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,m1(i),i}throw ya=o,wo}}function ba(i){try{var o=i._init;return o(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(ya=u,wo):u}}var ya=null;function p1(){if(ya===null)throw Error(r(459));var i=ya;return ya=null,i}function m1(i){if(i===wo||i===Xu)throw Error(r(483))}var ko=null,$l=0;function Zu(i){var o=$l;return $l+=1,ko===null&&(ko=[]),h1(ko,i,o)}function Vl(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function ed(i,o){throw o.$$typeof===b?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function g1(i){function o($,B){if(i){var J=$.deletions;J===null?($.deletions=[B],$.flags|=16):J.push(B)}}function u($,B){if(!i)return null;for(;B!==null;)o($,B),B=B.sibling;return null}function f($){for(var B=new Map;$!==null;)$.key!==null?B.set($.key,$):B.set($.index,$),$=$.sibling;return B}function x($,B){return $=ys($,B),$.index=0,$.sibling=null,$}function y($,B,J){return $.index=J,i?(J=$.alternate,J!==null?(J=J.index,J<B?($.flags|=67108866,B):J):($.flags|=67108866,B)):($.flags|=1048576,B)}function S($){return i&&$.alternate===null&&($.flags|=67108866),$}function T($,B,J,ce){return B===null||B.tag!==6?(B=$p(J,$.mode,ce),B.return=$,B):(B=x(B,J),B.return=$,B)}function D($,B,J,ce){var Ie=J.type;return Ie===C?le($,B,J.props.children,ce,J.key):B!==null&&(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===F&&ba(Ie)===B.type)?(B=x(B,J.props),Vl(B,J),B.return=$,B):(B=Wu(J.type,J.key,J.props,null,$.mode,ce),Vl(B,J),B.return=$,B)}function X($,B,J,ce){return B===null||B.tag!==4||B.stateNode.containerInfo!==J.containerInfo||B.stateNode.implementation!==J.implementation?(B=Vp(J,$.mode,ce),B.return=$,B):(B=x(B,J.children||[]),B.return=$,B)}function le($,B,J,ce,Ie){return B===null||B.tag!==7?(B=ha(J,$.mode,ce,Ie),B.return=$,B):(B=x(B,J),B.return=$,B)}function de($,B,J){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=$p(""+B,$.mode,J),B.return=$,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case v:return J=Wu(B.type,B.key,B.props,null,$.mode,J),Vl(J,B),J.return=$,J;case w:return B=Vp(B,$.mode,J),B.return=$,B;case F:return B=ba(B),de($,B,J)}if(Ee(B)||Te(B))return B=ha(B,$.mode,J,null),B.return=$,B;if(typeof B.then=="function")return de($,Zu(B),J);if(B.$$typeof===_)return de($,Yu($,B),J);ed($,B)}return null}function ee($,B,J,ce){var Ie=B!==null?B.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Ie!==null?null:T($,B,""+J,ce);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case v:return J.key===Ie?D($,B,J,ce):null;case w:return J.key===Ie?X($,B,J,ce):null;case F:return J=ba(J),ee($,B,J,ce)}if(Ee(J)||Te(J))return Ie!==null?null:le($,B,J,ce,null);if(typeof J.then=="function")return ee($,B,Zu(J),ce);if(J.$$typeof===_)return ee($,B,Yu($,J),ce);ed($,J)}return null}function se($,B,J,ce,Ie){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return $=$.get(J)||null,T(B,$,""+ce,Ie);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return $=$.get(ce.key===null?J:ce.key)||null,D(B,$,ce,Ie);case w:return $=$.get(ce.key===null?J:ce.key)||null,X(B,$,ce,Ie);case F:return ce=ba(ce),se($,B,J,ce,Ie)}if(Ee(ce)||Te(ce))return $=$.get(J)||null,le(B,$,ce,Ie,null);if(typeof ce.then=="function")return se($,B,J,Zu(ce),Ie);if(ce.$$typeof===_)return se($,B,J,Yu(B,ce),Ie);ed(B,ce)}return null}function Oe($,B,J,ce){for(var Ie=null,ct=null,Re=B,Ye=B=0,at=null;Re!==null&&Ye<J.length;Ye++){Re.index>Ye?(at=Re,Re=null):at=Re.sibling;var ut=ee($,Re,J[Ye],ce);if(ut===null){Re===null&&(Re=at);break}i&&Re&&ut.alternate===null&&o($,Re),B=y(ut,B,Ye),ct===null?Ie=ut:ct.sibling=ut,ct=ut,Re=at}if(Ye===J.length)return u($,Re),ot&&vs($,Ye),Ie;if(Re===null){for(;Ye<J.length;Ye++)Re=de($,J[Ye],ce),Re!==null&&(B=y(Re,B,Ye),ct===null?Ie=Re:ct.sibling=Re,ct=Re);return ot&&vs($,Ye),Ie}for(Re=f(Re);Ye<J.length;Ye++)at=se(Re,$,Ye,J[Ye],ce),at!==null&&(i&&at.alternate!==null&&Re.delete(at.key===null?Ye:at.key),B=y(at,B,Ye),ct===null?Ie=at:ct.sibling=at,ct=at);return i&&Re.forEach(function(Mi){return o($,Mi)}),ot&&vs($,Ye),Ie}function He($,B,J,ce){if(J==null)throw Error(r(151));for(var Ie=null,ct=null,Re=B,Ye=B=0,at=null,ut=J.next();Re!==null&&!ut.done;Ye++,ut=J.next()){Re.index>Ye?(at=Re,Re=null):at=Re.sibling;var Mi=ee($,Re,ut.value,ce);if(Mi===null){Re===null&&(Re=at);break}i&&Re&&Mi.alternate===null&&o($,Re),B=y(Mi,B,Ye),ct===null?Ie=Mi:ct.sibling=Mi,ct=Mi,Re=at}if(ut.done)return u($,Re),ot&&vs($,Ye),Ie;if(Re===null){for(;!ut.done;Ye++,ut=J.next())ut=de($,ut.value,ce),ut!==null&&(B=y(ut,B,Ye),ct===null?Ie=ut:ct.sibling=ut,ct=ut);return ot&&vs($,Ye),Ie}for(Re=f(Re);!ut.done;Ye++,ut=J.next())ut=se(Re,$,Ye,ut.value,ce),ut!==null&&(i&&ut.alternate!==null&&Re.delete(ut.key===null?Ye:ut.key),B=y(ut,B,Ye),ct===null?Ie=ut:ct.sibling=ut,ct=ut);return i&&Re.forEach(function(mj){return o($,mj)}),ot&&vs($,Ye),Ie}function yt($,B,J,ce){if(typeof J=="object"&&J!==null&&J.type===C&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case v:e:{for(var Ie=J.key;B!==null;){if(B.key===Ie){if(Ie=J.type,Ie===C){if(B.tag===7){u($,B.sibling),ce=x(B,J.props.children),ce.return=$,$=ce;break e}}else if(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===F&&ba(Ie)===B.type){u($,B.sibling),ce=x(B,J.props),Vl(ce,J),ce.return=$,$=ce;break e}u($,B);break}else o($,B);B=B.sibling}J.type===C?(ce=ha(J.props.children,$.mode,ce,J.key),ce.return=$,$=ce):(ce=Wu(J.type,J.key,J.props,null,$.mode,ce),Vl(ce,J),ce.return=$,$=ce)}return S($);case w:e:{for(Ie=J.key;B!==null;){if(B.key===Ie)if(B.tag===4&&B.stateNode.containerInfo===J.containerInfo&&B.stateNode.implementation===J.implementation){u($,B.sibling),ce=x(B,J.children||[]),ce.return=$,$=ce;break e}else{u($,B);break}else o($,B);B=B.sibling}ce=Vp(J,$.mode,ce),ce.return=$,$=ce}return S($);case F:return J=ba(J),yt($,B,J,ce)}if(Ee(J))return Oe($,B,J,ce);if(Te(J)){if(Ie=Te(J),typeof Ie!="function")throw Error(r(150));return J=Ie.call(J),He($,B,J,ce)}if(typeof J.then=="function")return yt($,B,Zu(J),ce);if(J.$$typeof===_)return yt($,B,Yu($,J),ce);ed($,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,B!==null&&B.tag===6?(u($,B.sibling),ce=x(B,J),ce.return=$,$=ce):(u($,B),ce=$p(J,$.mode,ce),ce.return=$,$=ce),S($)):u($,B)}return function($,B,J,ce){try{$l=0;var Ie=yt($,B,J,ce);return ko=null,Ie}catch(Re){if(Re===wo||Re===Xu)throw Re;var ct=ur(29,Re,null,$.mode);return ct.lanes=ce,ct.return=$,ct}finally{}}}var va=g1(!0),x1=g1(!1),fi=!1;function nm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rm(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function hi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function pi(i,o,u){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(dt&2)!==0){var x=f.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),f.pending=o,o=qu(i),e1(i,null,u),o}return Vu(i,f,o,u),qu(i)}function ql(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=i.pendingLanes,u|=f,o.lanes=u,Pe(i,u)}}function sm(i,o){var u=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var x=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};y===null?x=y=S:y=y.next=S,u=u.next}while(u!==null);y===null?x=y=o:y=y.next=o}else x=y=o;u={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var im=!1;function Wl(){if(im){var i=vo;if(i!==null)throw i}}function Kl(i,o,u,f){im=!1;var x=i.updateQueue;fi=!1;var y=x.firstBaseUpdate,S=x.lastBaseUpdate,T=x.shared.pending;if(T!==null){x.shared.pending=null;var D=T,X=D.next;D.next=null,S===null?y=X:S.next=X,S=D;var le=i.alternate;le!==null&&(le=le.updateQueue,T=le.lastBaseUpdate,T!==S&&(T===null?le.firstBaseUpdate=X:T.next=X,le.lastBaseUpdate=D))}if(y!==null){var de=x.baseState;S=0,le=X=D=null,T=y;do{var ee=T.lane&-536870913,se=ee!==T.lane;if(se?(it&ee)===ee:(f&ee)===ee){ee!==0&&ee===yo&&(im=!0),le!==null&&(le=le.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Oe=i,He=T;ee=o;var yt=u;switch(He.tag){case 1:if(Oe=He.payload,typeof Oe=="function"){de=Oe.call(yt,de,ee);break e}de=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=He.payload,ee=typeof Oe=="function"?Oe.call(yt,de,ee):Oe,ee==null)break e;de=g({},de,ee);break e;case 2:fi=!0}}ee=T.callback,ee!==null&&(i.flags|=64,se&&(i.flags|=8192),se=x.callbacks,se===null?x.callbacks=[ee]:se.push(ee))}else se={lane:ee,tag:T.tag,payload:T.payload,callback:T.callback,next:null},le===null?(X=le=se,D=de):le=le.next=se,S|=ee;if(T=T.next,T===null){if(T=x.shared.pending,T===null)break;se=T,T=se.next,se.next=null,x.lastBaseUpdate=se,x.shared.pending=null}}while(!0);le===null&&(D=de),x.baseState=D,x.firstBaseUpdate=X,x.lastBaseUpdate=le,y===null&&(x.shared.lanes=0),yi|=S,i.lanes=S,i.memoizedState=de}}function b1(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function y1(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)b1(u[i],o)}var Co=A(null),td=A(0);function v1(i,o){i=js,W(td,i),W(Co,o),js=i|o.baseLanes}function am(){W(td,js),W(Co,Co.current)}function om(){js=td.current,R(Co),R(td)}var dr=A(null),Nr=null;function mi(i){var o=i.alternate;W(Gt,Gt.current&1),W(dr,i),Nr===null&&(o===null||Co.current!==null||o.memoizedState!==null)&&(Nr=i)}function lm(i){W(Gt,Gt.current),W(dr,i),Nr===null&&(Nr=i)}function w1(i){i.tag===22?(W(Gt,Gt.current),W(dr,i),Nr===null&&(Nr=i)):gi()}function gi(){W(Gt,Gt.current),W(dr,dr.current)}function fr(i){R(dr),Nr===i&&(Nr=null),R(Gt)}var Gt=A(0);function nd(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||pg(u)||mg(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Cs=0,Ge=null,xt=null,en=null,rd=!1,So=!1,wa=!1,sd=0,Gl=0,Eo=null,iO=0;function Ft(){throw Error(r(321))}function cm(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!cr(i[u],o[u]))return!1;return!0}function um(i,o,u,f,x,y){return Cs=y,Ge=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,q.H=i===null||i.memoizedState===null?sv:Em,wa=!1,y=u(f,x),wa=!1,So&&(y=C1(o,u,f,x)),k1(i),y}function k1(i){q.H=Xl;var o=xt!==null&&xt.next!==null;if(Cs=0,en=xt=Ge=null,rd=!1,Gl=0,Eo=null,o)throw Error(r(300));i===null||tn||(i=i.dependencies,i!==null&&Gu(i)&&(tn=!0))}function C1(i,o,u,f){Ge=i;var x=0;do{if(So&&(Eo=null),Gl=0,So=!1,25<=x)throw Error(r(301));if(x+=1,en=xt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}q.H=iv,y=o(u,f)}while(So);return y}function aO(){var i=q.H,o=i.useState()[0];return o=typeof o.then=="function"?Yl(o):o,i=i.useState()[0],(xt!==null?xt.memoizedState:null)!==i&&(Ge.flags|=1024),o}function dm(){var i=sd!==0;return sd=0,i}function fm(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function hm(i){if(rd){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}rd=!1}Cs=0,en=xt=Ge=null,So=!1,Gl=sd=0,Eo=null}function Un(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Ge.memoizedState=en=i:en=en.next=i,en}function Yt(){if(xt===null){var i=Ge.alternate;i=i!==null?i.memoizedState:null}else i=xt.next;var o=en===null?Ge.memoizedState:en.next;if(o!==null)en=o,xt=i;else{if(i===null)throw Ge.alternate===null?Error(r(467)):Error(r(310));xt=i,i={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},en===null?Ge.memoizedState=en=i:en=en.next=i}return en}function id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yl(i){var o=Gl;return Gl+=1,Eo===null&&(Eo=[]),i=h1(Eo,i,o),o=Ge,(en===null?o.memoizedState:en.next)===null&&(o=o.alternate,q.H=o===null||o.memoizedState===null?sv:Em),i}function ad(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Yl(i);if(i.$$typeof===_)return En(i)}throw Error(r(438,String(i)))}function pm(i){var o=null,u=Ge.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Ge.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=id(),Ge.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),f=0;f<i;f++)u[f]=Z;return o.index++,u}function Ss(i,o){return typeof o=="function"?o(i):o}function od(i){var o=Yt();return mm(o,xt,i)}function mm(i,o,u){var f=i.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=u;var x=i.baseQueue,y=f.pending;if(y!==null){if(x!==null){var S=x.next;x.next=y.next,y.next=S}o.baseQueue=x=y,f.pending=null}if(y=i.baseState,x===null)i.memoizedState=y;else{o=x.next;var T=S=null,D=null,X=o,le=!1;do{var de=X.lane&-536870913;if(de!==X.lane?(it&de)===de:(Cs&de)===de){var ee=X.revertLane;if(ee===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),de===yo&&(le=!0);else if((Cs&ee)===ee){X=X.next,ee===yo&&(le=!0);continue}else de={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},D===null?(T=D=de,S=y):D=D.next=de,Ge.lanes|=ee,yi|=ee;de=X.action,wa&&u(y,de),y=X.hasEagerState?X.eagerState:u(y,de)}else ee={lane:de,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},D===null?(T=D=ee,S=y):D=D.next=ee,Ge.lanes|=de,yi|=de;X=X.next}while(X!==null&&X!==o);if(D===null?S=y:D.next=T,!cr(y,i.memoizedState)&&(tn=!0,le&&(u=vo,u!==null)))throw u;i.memoizedState=y,i.baseState=S,i.baseQueue=D,f.lastRenderedState=y}return x===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function gm(i){var o=Yt(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var f=u.dispatch,x=u.pending,y=o.memoizedState;if(x!==null){u.pending=null;var S=x=x.next;do y=i(y,S.action),S=S.next;while(S!==x);cr(y,o.memoizedState)||(tn=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,f]}function S1(i,o,u){var f=Ge,x=Yt(),y=ot;if(y){if(u===void 0)throw Error(r(407));u=u()}else u=o();var S=!cr((xt||x).memoizedState,u);if(S&&(x.memoizedState=u,tn=!0),x=x.queue,ym(T1.bind(null,f,x,i),[i]),x.getSnapshot!==o||S||en!==null&&en.memoizedState.tag&1){if(f.flags|=2048,No(9,{destroy:void 0},N1.bind(null,f,x,u,o),null),kt===null)throw Error(r(349));y||(Cs&127)!==0||E1(f,o,u)}return u}function E1(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=Ge.updateQueue,o===null?(o=id(),Ge.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function N1(i,o,u,f){o.value=u,o.getSnapshot=f,A1(o)&&M1(i)}function T1(i,o,u){return u(function(){A1(o)&&M1(i)})}function A1(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!cr(i,u)}catch{return!0}}function M1(i){var o=fa(i,2);o!==null&&nr(o,i,2)}function xm(i){var o=Un();if(typeof i=="function"){var u=i;if(i=u(),wa){kn(!0);try{u()}finally{kn(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:i},o}function O1(i,o,u,f){return i.baseState=u,mm(i,xt,typeof f=="function"?f:Ss)}function oO(i,o,u,f,x){if(ud(i))throw Error(r(485));if(i=o.action,i!==null){var y={payload:x,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};q.T!==null?u(!0):y.isTransition=!1,f(y),u=o.pending,u===null?(y.next=o.pending=y,j1(o,y)):(y.next=u.next,o.pending=u.next=y)}}function j1(i,o){var u=o.action,f=o.payload,x=i.state;if(o.isTransition){var y=q.T,S={};q.T=S;try{var T=u(x,f),D=q.S;D!==null&&D(S,T),_1(i,o,T)}catch(X){bm(i,o,X)}finally{y!==null&&S.types!==null&&(y.types=S.types),q.T=y}}else try{y=u(x,f),_1(i,o,y)}catch(X){bm(i,o,X)}}function _1(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){R1(i,o,f)},function(f){return bm(i,o,f)}):R1(i,o,u)}function R1(i,o,u){o.status="fulfilled",o.value=u,D1(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,j1(i,u)))}function bm(i,o,u){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,D1(o),o=o.next;while(o!==f)}i.action=null}function D1(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function L1(i,o){return o}function I1(i,o){if(ot){var u=kt.formState;if(u!==null){e:{var f=Ge;if(ot){if(Mt){t:{for(var x=Mt,y=Er;x.nodeType!==8;){if(!y){x=null;break t}if(x=Tr(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){Mt=Tr(x.nextSibling),f=x.data==="F!";break e}}ui(f)}f=!1}f&&(o=u[0])}}return u=Un(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:L1,lastRenderedState:o},u.queue=f,u=tv.bind(null,Ge,f),f.dispatch=u,f=xm(!1),y=Sm.bind(null,Ge,!1,f.queue),f=Un(),x={state:o,dispatch:null,action:i,pending:null},f.queue=x,u=oO.bind(null,Ge,x,y,u),x.dispatch=u,f.memoizedState=i,[o,u,!1]}function z1(i){var o=Yt();return B1(o,xt,i)}function B1(i,o,u){if(o=mm(i,o,L1)[0],i=od(Ss)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Yl(o)}catch(S){throw S===wo?Xu:S}else f=o;o=Yt();var x=o.queue,y=x.dispatch;return u!==o.memoizedState&&(Ge.flags|=2048,No(9,{destroy:void 0},lO.bind(null,x,u),null)),[f,y,i]}function lO(i,o){i.action=o}function P1(i){var o=Yt(),u=xt;if(u!==null)return B1(o,u,i);Yt(),o=o.memoizedState,u=Yt();var f=u.queue.dispatch;return u.memoizedState=i,[o,f,!1]}function No(i,o,u,f){return i={tag:i,create:u,deps:f,inst:o,next:null},o=Ge.updateQueue,o===null&&(o=id(),Ge.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(f=u.next,u.next=i,i.next=f,o.lastEffect=i),i}function H1(){return Yt().memoizedState}function ld(i,o,u,f){var x=Un();Ge.flags|=i,x.memoizedState=No(1|o,{destroy:void 0},u,f===void 0?null:f)}function cd(i,o,u,f){var x=Yt();f=f===void 0?null:f;var y=x.memoizedState.inst;xt!==null&&f!==null&&cm(f,xt.memoizedState.deps)?x.memoizedState=No(o,y,u,f):(Ge.flags|=i,x.memoizedState=No(1|o,y,u,f))}function F1(i,o){ld(8390656,8,i,o)}function ym(i,o){cd(2048,8,i,o)}function cO(i){Ge.flags|=4;var o=Ge.updateQueue;if(o===null)o=id(),Ge.updateQueue=o,o.events=[i];else{var u=o.events;u===null?o.events=[i]:u.push(i)}}function U1(i){var o=Yt().memoizedState;return cO({ref:o,nextImpl:i}),function(){if((dt&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}function $1(i,o){return cd(4,2,i,o)}function V1(i,o){return cd(4,4,i,o)}function q1(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function W1(i,o,u){u=u!=null?u.concat([i]):null,cd(4,4,q1.bind(null,o,i),u)}function vm(){}function K1(i,o){var u=Yt();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&cm(o,f[1])?f[0]:(u.memoizedState=[i,o],i)}function G1(i,o){var u=Yt();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&cm(o,f[1]))return f[0];if(f=i(),wa){kn(!0);try{i()}finally{kn(!1)}}return u.memoizedState=[f,o],f}function wm(i,o,u){return u===void 0||(Cs&1073741824)!==0&&(it&261930)===0?i.memoizedState=o:(i.memoizedState=u,i=Yv(),Ge.lanes|=i,yi|=i,u)}function Y1(i,o,u,f){return cr(u,o)?u:Co.current!==null?(i=wm(i,u,f),cr(i,o)||(tn=!0),i):(Cs&42)===0||(Cs&1073741824)!==0&&(it&261930)===0?(tn=!0,i.memoizedState=u):(i=Yv(),Ge.lanes|=i,yi|=i,o)}function J1(i,o,u,f,x){var y=te.p;te.p=y!==0&&8>y?y:8;var S=q.T,T={};q.T=T,Sm(i,!1,o,u);try{var D=x(),X=q.S;if(X!==null&&X(T,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var le=sO(D,f);Jl(i,o,le,mr(i))}else Jl(i,o,f,mr(i))}catch(de){Jl(i,o,{then:function(){},status:"rejected",reason:de},mr())}finally{te.p=y,S!==null&&T.types!==null&&(S.types=T.types),q.T=S}}function uO(){}function km(i,o,u,f){if(i.tag!==5)throw Error(r(476));var x=X1(i).queue;J1(i,x,o,G,u===null?uO:function(){return Q1(i),u(f)})}function X1(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:G,baseState:G,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:G},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Q1(i){var o=X1(i);o.next===null&&(o=i.alternate.memoizedState),Jl(i,o.next.queue,{},mr())}function Cm(){return En(hc)}function Z1(){return Yt().memoizedState}function ev(){return Yt().memoizedState}function dO(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=mr();i=hi(u);var f=pi(o,i,u);f!==null&&(nr(f,o,u),ql(f,o,u)),o={cache:Qp()},i.payload=o;return}o=o.return}}function fO(i,o,u){var f=mr();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ud(i)?nv(o,u):(u=Fp(i,o,u,f),u!==null&&(nr(u,i,f),rv(u,o,f)))}function tv(i,o,u){var f=mr();Jl(i,o,u,f)}function Jl(i,o,u,f){var x={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ud(i))nv(o,x);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var S=o.lastRenderedState,T=y(S,u);if(x.hasEagerState=!0,x.eagerState=T,cr(T,S))return Vu(i,o,x,0),kt===null&&$u(),!1}catch{}finally{}if(u=Fp(i,o,x,f),u!==null)return nr(u,i,f),rv(u,o,f),!0}return!1}function Sm(i,o,u,f){if(f={lane:2,revertLane:ng(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ud(i)){if(o)throw Error(r(479))}else o=Fp(i,u,f,2),o!==null&&nr(o,i,2)}function ud(i){var o=i.alternate;return i===Ge||o!==null&&o===Ge}function nv(i,o){So=rd=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function rv(i,o,u){if((u&4194048)!==0){var f=o.lanes;f&=i.pendingLanes,u|=f,o.lanes=u,Pe(i,u)}}var Xl={readContext:En,use:ad,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft};Xl.useEffectEvent=Ft;var sv={readContext:En,use:ad,useCallback:function(i,o){return Un().memoizedState=[i,o===void 0?null:o],i},useContext:En,useEffect:F1,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,ld(4194308,4,q1.bind(null,o,i),u)},useLayoutEffect:function(i,o){return ld(4194308,4,i,o)},useInsertionEffect:function(i,o){ld(4,2,i,o)},useMemo:function(i,o){var u=Un();o=o===void 0?null:o;var f=i();if(wa){kn(!0);try{i()}finally{kn(!1)}}return u.memoizedState=[f,o],f},useReducer:function(i,o,u){var f=Un();if(u!==void 0){var x=u(o);if(wa){kn(!0);try{u(o)}finally{kn(!1)}}}else x=o;return f.memoizedState=f.baseState=x,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},f.queue=i,i=i.dispatch=fO.bind(null,Ge,i),[f.memoizedState,i]},useRef:function(i){var o=Un();return i={current:i},o.memoizedState=i},useState:function(i){i=xm(i);var o=i.queue,u=tv.bind(null,Ge,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:vm,useDeferredValue:function(i,o){var u=Un();return wm(u,i,o)},useTransition:function(){var i=xm(!1);return i=J1.bind(null,Ge,i.queue,!0,!1),Un().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var f=Ge,x=Un();if(ot){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),kt===null)throw Error(r(349));(it&127)!==0||E1(f,o,u)}x.memoizedState=u;var y={value:u,getSnapshot:o};return x.queue=y,F1(T1.bind(null,f,y,i),[i]),f.flags|=2048,No(9,{destroy:void 0},N1.bind(null,f,y,u,o),null),u},useId:function(){var i=Un(),o=kt.identifierPrefix;if(ot){var u=es,f=Zr;u=(f&~(1<<32-Kt(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=sd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=iO++,o="_"+o+"r_"+u.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:Cm,useFormState:I1,useActionState:I1,useOptimistic:function(i){var o=Un();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Sm.bind(null,Ge,!0,u),u.dispatch=o,[i,o]},useMemoCache:pm,useCacheRefresh:function(){return Un().memoizedState=dO.bind(null,Ge)},useEffectEvent:function(i){var o=Un(),u={impl:i};return o.memoizedState=u,function(){if((dt&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}},Em={readContext:En,use:ad,useCallback:K1,useContext:En,useEffect:ym,useImperativeHandle:W1,useInsertionEffect:$1,useLayoutEffect:V1,useMemo:G1,useReducer:od,useRef:H1,useState:function(){return od(Ss)},useDebugValue:vm,useDeferredValue:function(i,o){var u=Yt();return Y1(u,xt.memoizedState,i,o)},useTransition:function(){var i=od(Ss)[0],o=Yt().memoizedState;return[typeof i=="boolean"?i:Yl(i),o]},useSyncExternalStore:S1,useId:Z1,useHostTransitionStatus:Cm,useFormState:z1,useActionState:z1,useOptimistic:function(i,o){var u=Yt();return O1(u,xt,i,o)},useMemoCache:pm,useCacheRefresh:ev};Em.useEffectEvent=U1;var iv={readContext:En,use:ad,useCallback:K1,useContext:En,useEffect:ym,useImperativeHandle:W1,useInsertionEffect:$1,useLayoutEffect:V1,useMemo:G1,useReducer:gm,useRef:H1,useState:function(){return gm(Ss)},useDebugValue:vm,useDeferredValue:function(i,o){var u=Yt();return xt===null?wm(u,i,o):Y1(u,xt.memoizedState,i,o)},useTransition:function(){var i=gm(Ss)[0],o=Yt().memoizedState;return[typeof i=="boolean"?i:Yl(i),o]},useSyncExternalStore:S1,useId:Z1,useHostTransitionStatus:Cm,useFormState:P1,useActionState:P1,useOptimistic:function(i,o){var u=Yt();return xt!==null?O1(u,xt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:pm,useCacheRefresh:ev};iv.useEffectEvent=U1;function Nm(i,o,u,f){o=i.memoizedState,u=u(f,o),u=u==null?o:g({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Tm={enqueueSetState:function(i,o,u){i=i._reactInternals;var f=mr(),x=hi(f);x.payload=o,u!=null&&(x.callback=u),o=pi(i,x,f),o!==null&&(nr(o,i,f),ql(o,i,f))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var f=mr(),x=hi(f);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=pi(i,x,f),o!==null&&(nr(o,i,f),ql(o,i,f))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=mr(),f=hi(u);f.tag=2,o!=null&&(f.callback=o),o=pi(i,f,u),o!==null&&(nr(o,i,u),ql(o,i,u))}};function av(i,o,u,f,x,y,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,y,S):o.prototype&&o.prototype.isPureReactComponent?!zl(u,f)||!zl(x,y):!0}function ov(i,o,u,f){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==i&&Tm.enqueueReplaceState(o,o.state,null)}function ka(i,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(i=i.defaultProps){u===o&&(u=g({},u));for(var x in i)u[x]===void 0&&(u[x]=i[x])}return u}function lv(i){Uu(i)}function cv(i){console.error(i)}function uv(i){Uu(i)}function dd(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function dv(i,o,u){try{var f=i.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Am(i,o,u){return u=hi(u),u.tag=3,u.payload={element:null},u.callback=function(){dd(i,o)},u}function fv(i){return i=hi(i),i.tag=3,i}function hv(i,o,u,f){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var y=f.value;i.payload=function(){return x(y)},i.callback=function(){dv(o,u,f)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){dv(o,u,f),typeof x!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var T=f.stack;this.componentDidCatch(f.value,{componentStack:T!==null?T:""})})}function hO(i,o,u,f,x){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&bo(o,u,x,!0),u=dr.current,u!==null){switch(u.tag){case 31:case 13:return Nr===null?Cd():u.alternate===null&&Ut===0&&(Ut=3),u.flags&=-257,u.flags|=65536,u.lanes=x,f===Qu?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),Zm(i,f,x)),!1;case 22:return u.flags|=65536,f===Qu?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),Zm(i,f,x)),!1}throw Error(r(435,u.tag))}return Zm(i,f,x),Cd(),!1}if(ot)return o=dr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,f!==Kp&&(i=Error(r(422),{cause:f}),Hl(kr(i,u)))):(f!==Kp&&(o=Error(r(423),{cause:f}),Hl(kr(o,u))),i=i.current.alternate,i.flags|=65536,x&=-x,i.lanes|=x,f=kr(f,u),x=Am(i.stateNode,f,x),sm(i,x),Ut!==4&&(Ut=2)),!1;var y=Error(r(520),{cause:f});if(y=kr(y,u),ic===null?ic=[y]:ic.push(y),Ut!==4&&(Ut=2),o===null)return!0;f=kr(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=x&-x,u.lanes|=i,i=Am(u.stateNode,f,i),sm(u,i),!1;case 1:if(o=u.type,y=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(vi===null||!vi.has(y))))return u.flags|=65536,x&=-x,u.lanes|=x,x=fv(x),hv(x,i,u,f),sm(u,x),!1}u=u.return}while(u!==null);return!1}var Mm=Error(r(461)),tn=!1;function Nn(i,o,u,f){o.child=i===null?x1(o,null,u,f):va(o,i.child,u,f)}function pv(i,o,u,f,x){u=u.render;var y=o.ref;if("ref"in f){var S={};for(var T in f)T!=="ref"&&(S[T]=f[T])}else S=f;return ga(o),f=um(i,o,u,S,y,x),T=dm(),i!==null&&!tn?(fm(i,o,x),Es(i,o,x)):(ot&&T&&qp(o),o.flags|=1,Nn(i,o,f,x),o.child)}function mv(i,o,u,f,x){if(i===null){var y=u.type;return typeof y=="function"&&!Up(y)&&y.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=y,gv(i,o,y,f,x)):(i=Wu(u.type,null,f,o,o.mode,x),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,!zm(i,x)){var S=y.memoizedProps;if(u=u.compare,u=u!==null?u:zl,u(S,f)&&i.ref===o.ref)return Es(i,o,x)}return o.flags|=1,i=ys(y,f),i.ref=o.ref,i.return=o,o.child=i}function gv(i,o,u,f,x){if(i!==null){var y=i.memoizedProps;if(zl(y,f)&&i.ref===o.ref)if(tn=!1,o.pendingProps=f=y,zm(i,x))(i.flags&131072)!==0&&(tn=!0);else return o.lanes=i.lanes,Es(i,o,x)}return Om(i,o,u,f,x)}function xv(i,o,u,f){var x=f.children,y=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|u:u,i!==null){for(f=o.child=i.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~y}else f=0,o.child=null;return bv(i,o,y,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Ju(o,y!==null?y.cachePool:null),y!==null?v1(o,y):am(),w1(o);else return f=o.lanes=536870912,bv(i,o,y!==null?y.baseLanes|u:u,u,f)}else y!==null?(Ju(o,y.cachePool),v1(o,y),gi(),o.memoizedState=null):(i!==null&&Ju(o,null),am(),gi());return Nn(i,o,x,u),o.child}function Ql(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function bv(i,o,u,f,x){var y=em();return y=y===null?null:{parent:Zt._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},i!==null&&Ju(o,null),am(),w1(o),i!==null&&bo(i,o,f,!0),o.childLanes=x,null}function fd(i,o){return o=pd({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function yv(i,o,u){return va(o,i.child,null,u),i=fd(o,o.pendingProps),i.flags|=2,fr(o),o.memoizedState=null,i}function pO(i,o,u){var f=o.pendingProps,x=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(ot){if(f.mode==="hidden")return i=fd(o,f),o.lanes=536870912,Ql(null,i);if(lm(o),(i=Mt)?(i=jw(i,Er),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:li!==null?{id:Zr,overflow:es}:null,retryLane:536870912,hydrationErrors:null},u=n1(i),u.return=o,o.child=u,Sn=o,Mt=null)):i=null,i===null)throw ui(o);return o.lanes=536870912,null}return fd(o,f)}var y=i.memoizedState;if(y!==null){var S=y.dehydrated;if(lm(o),x)if(o.flags&256)o.flags&=-257,o=yv(i,o,u);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(r(558));else if(tn||bo(i,o,u,!1),x=(u&i.childLanes)!==0,tn||x){if(f=kt,f!==null&&(S=st(f,u),S!==0&&S!==y.retryLane))throw y.retryLane=S,fa(i,S),nr(f,i,S),Mm;Cd(),o=yv(i,o,u)}else i=y.treeContext,Mt=Tr(S.nextSibling),Sn=o,ot=!0,ci=null,Er=!1,i!==null&&i1(o,i),o=fd(o,f),o.flags|=4096;return o}return i=ys(i.child,{mode:f.mode,children:f.children}),i.ref=o.ref,o.child=i,i.return=o,i}function hd(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function Om(i,o,u,f,x){return ga(o),u=um(i,o,u,f,void 0,x),f=dm(),i!==null&&!tn?(fm(i,o,x),Es(i,o,x)):(ot&&f&&qp(o),o.flags|=1,Nn(i,o,u,x),o.child)}function vv(i,o,u,f,x,y){return ga(o),o.updateQueue=null,u=C1(o,f,u,x),k1(i),f=dm(),i!==null&&!tn?(fm(i,o,y),Es(i,o,y)):(ot&&f&&qp(o),o.flags|=1,Nn(i,o,u,y),o.child)}function wv(i,o,u,f,x){if(ga(o),o.stateNode===null){var y=po,S=u.contextType;typeof S=="object"&&S!==null&&(y=En(S)),y=new u(f,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Tm,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=f,y.state=o.memoizedState,y.refs={},nm(o),S=u.contextType,y.context=typeof S=="object"&&S!==null?En(S):po,y.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Nm(o,u,S,f),y.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&Tm.enqueueReplaceState(y,y.state,null),Kl(o,f,y,x),Wl(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(i===null){y=o.stateNode;var T=o.memoizedProps,D=ka(u,T);y.props=D;var X=y.context,le=u.contextType;S=po,typeof le=="object"&&le!==null&&(S=En(le));var de=u.getDerivedStateFromProps;le=typeof de=="function"||typeof y.getSnapshotBeforeUpdate=="function",T=o.pendingProps!==T,le||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T||X!==S)&&ov(o,y,f,S),fi=!1;var ee=o.memoizedState;y.state=ee,Kl(o,f,y,x),Wl(),X=o.memoizedState,T||ee!==X||fi?(typeof de=="function"&&(Nm(o,u,de,f),X=o.memoizedState),(D=fi||av(o,u,D,f,ee,X,S))?(le||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=X),y.props=f,y.state=X,y.context=S,f=D):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{y=o.stateNode,rm(i,o),S=o.memoizedProps,le=ka(u,S),y.props=le,de=o.pendingProps,ee=y.context,X=u.contextType,D=po,typeof X=="object"&&X!==null&&(D=En(X)),T=u.getDerivedStateFromProps,(X=typeof T=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==de||ee!==D)&&ov(o,y,f,D),fi=!1,ee=o.memoizedState,y.state=ee,Kl(o,f,y,x),Wl();var se=o.memoizedState;S!==de||ee!==se||fi||i!==null&&i.dependencies!==null&&Gu(i.dependencies)?(typeof T=="function"&&(Nm(o,u,T,f),se=o.memoizedState),(le=fi||av(o,u,le,f,ee,se,D)||i!==null&&i.dependencies!==null&&Gu(i.dependencies))?(X||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,se,D),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,se,D)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=se),y.props=f,y.state=se,y.context=D,f=le):(typeof y.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=1024),f=!1)}return y=f,hd(i,o),f=(o.flags&128)!==0,y||f?(y=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,i!==null&&f?(o.child=va(o,i.child,null,x),o.child=va(o,null,u,x)):Nn(i,o,u,x),o.memoizedState=y.state,i=o.child):i=Es(i,o,x),i}function kv(i,o,u,f){return pa(),o.flags|=256,Nn(i,o,u,f),o.child}var jm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _m(i){return{baseLanes:i,cachePool:d1()}}function Rm(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=pr),i}function Cv(i,o,u){var f=o.pendingProps,x=!1,y=(o.flags&128)!==0,S;if((S=y)||(S=i!==null&&i.memoizedState===null?!1:(Gt.current&2)!==0),S&&(x=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,i===null){if(ot){if(x?mi(o):gi(),(i=Mt)?(i=jw(i,Er),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:li!==null?{id:Zr,overflow:es}:null,retryLane:536870912,hydrationErrors:null},u=n1(i),u.return=o,o.child=u,Sn=o,Mt=null)):i=null,i===null)throw ui(o);return mg(i)?o.lanes=32:o.lanes=536870912,null}var T=f.children;return f=f.fallback,x?(gi(),x=o.mode,T=pd({mode:"hidden",children:T},x),f=ha(f,x,u,null),T.return=o,f.return=o,T.sibling=f,o.child=T,f=o.child,f.memoizedState=_m(u),f.childLanes=Rm(i,S,u),o.memoizedState=jm,Ql(null,f)):(mi(o),Dm(o,T))}var D=i.memoizedState;if(D!==null&&(T=D.dehydrated,T!==null)){if(y)o.flags&256?(mi(o),o.flags&=-257,o=Lm(i,o,u)):o.memoizedState!==null?(gi(),o.child=i.child,o.flags|=128,o=null):(gi(),T=f.fallback,x=o.mode,f=pd({mode:"visible",children:f.children},x),T=ha(T,x,u,null),T.flags|=2,f.return=o,T.return=o,f.sibling=T,o.child=f,va(o,i.child,null,u),f=o.child,f.memoizedState=_m(u),f.childLanes=Rm(i,S,u),o.memoizedState=jm,o=Ql(null,f));else if(mi(o),mg(T)){if(S=T.nextSibling&&T.nextSibling.dataset,S)var X=S.dgst;S=X,f=Error(r(419)),f.stack="",f.digest=S,Hl({value:f,source:null,stack:null}),o=Lm(i,o,u)}else if(tn||bo(i,o,u,!1),S=(u&i.childLanes)!==0,tn||S){if(S=kt,S!==null&&(f=st(S,u),f!==0&&f!==D.retryLane))throw D.retryLane=f,fa(i,f),nr(S,i,f),Mm;pg(T)||Cd(),o=Lm(i,o,u)}else pg(T)?(o.flags|=192,o.child=i.child,o=null):(i=D.treeContext,Mt=Tr(T.nextSibling),Sn=o,ot=!0,ci=null,Er=!1,i!==null&&i1(o,i),o=Dm(o,f.children),o.flags|=4096);return o}return x?(gi(),T=f.fallback,x=o.mode,D=i.child,X=D.sibling,f=ys(D,{mode:"hidden",children:f.children}),f.subtreeFlags=D.subtreeFlags&65011712,X!==null?T=ys(X,T):(T=ha(T,x,u,null),T.flags|=2),T.return=o,f.return=o,f.sibling=T,o.child=f,Ql(null,f),f=o.child,T=i.child.memoizedState,T===null?T=_m(u):(x=T.cachePool,x!==null?(D=Zt._currentValue,x=x.parent!==D?{parent:D,pool:D}:x):x=d1(),T={baseLanes:T.baseLanes|u,cachePool:x}),f.memoizedState=T,f.childLanes=Rm(i,S,u),o.memoizedState=jm,Ql(i.child,f)):(mi(o),u=i.child,i=u.sibling,u=ys(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,i!==null&&(S=o.deletions,S===null?(o.deletions=[i],o.flags|=16):S.push(i)),o.child=u,o.memoizedState=null,u)}function Dm(i,o){return o=pd({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function pd(i,o){return i=ur(22,i,null,o),i.lanes=0,i}function Lm(i,o,u){return va(o,i.child,null,u),i=Dm(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Sv(i,o,u){i.lanes|=o;var f=i.alternate;f!==null&&(f.lanes|=o),Jp(i.return,o,u)}function Im(i,o,u,f,x,y){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:x,treeForkCount:y}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=u,S.tailMode=x,S.treeForkCount=y)}function Ev(i,o,u){var f=o.pendingProps,x=f.revealOrder,y=f.tail;f=f.children;var S=Gt.current,T=(S&2)!==0;if(T?(S=S&1|2,o.flags|=128):S&=1,W(Gt,S),Nn(i,o,f,u),f=ot?Pl:0,!T&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Sv(i,u,o);else if(i.tag===19)Sv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(x){case"forwards":for(u=o.child,x=null;u!==null;)i=u.alternate,i!==null&&nd(i)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),Im(o,!1,x,u,y,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(i=x.alternate,i!==null&&nd(i)===null){o.child=x;break}i=x.sibling,x.sibling=u,u=x,x=i}Im(o,!0,u,null,y,f);break;case"together":Im(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function Es(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),yi|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(bo(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=ys(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=ys(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function zm(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&Gu(i)))}function mO(i,o,u){switch(o.tag){case 3:U(o,o.stateNode.containerInfo),di(o,Zt,i.memoizedState.cache),pa();break;case 27:case 5:ie(o);break;case 4:U(o,o.stateNode.containerInfo);break;case 10:di(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,lm(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(mi(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Cv(i,o,u):(mi(o),i=Es(i,o,u),i!==null?i.sibling:null);mi(o);break;case 19:var x=(i.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(bo(i,o,u,!1),f=(u&o.childLanes)!==0),x){if(f)return Ev(i,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),W(Gt,Gt.current),f)break;return null;case 22:return o.lanes=0,xv(i,o,u,o.pendingProps);case 24:di(o,Zt,i.memoizedState.cache)}return Es(i,o,u)}function Nv(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)tn=!0;else{if(!zm(i,u)&&(o.flags&128)===0)return tn=!1,mO(i,o,u);tn=(i.flags&131072)!==0}else tn=!1,ot&&(o.flags&1048576)!==0&&s1(o,Pl,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(i=ba(o.elementType),o.type=i,typeof i=="function")Up(i)?(f=ka(i,f),o.tag=1,o=wv(null,o,i,f,u)):(o.tag=0,o=Om(null,o,i,f,u));else{if(i!=null){var x=i.$$typeof;if(x===P){o.tag=11,o=pv(null,o,i,f,u);break e}else if(x===O){o.tag=14,o=mv(null,o,i,f,u);break e}}throw o=Se(i)||i,Error(r(306,o,""))}}return o;case 0:return Om(i,o,o.type,o.pendingProps,u);case 1:return f=o.type,x=ka(f,o.pendingProps),wv(i,o,f,x,u);case 3:e:{if(U(o,o.stateNode.containerInfo),i===null)throw Error(r(387));f=o.pendingProps;var y=o.memoizedState;x=y.element,rm(i,o),Kl(o,f,null,u);var S=o.memoizedState;if(f=S.cache,di(o,Zt,f),f!==y.cache&&Xp(o,[Zt],u,!0),Wl(),f=S.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=kv(i,o,f,u);break e}else if(f!==x){x=kr(Error(r(424)),o),Hl(x),o=kv(i,o,f,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Mt=Tr(i.firstChild),Sn=o,ot=!0,ci=null,Er=!0,u=x1(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(pa(),f===x){o=Es(i,o,u);break e}Nn(i,o,f,u)}o=o.child}return o;case 26:return hd(i,o),i===null?(u=zw(o.type,null,o.pendingProps,null))?o.memoizedState=u:ot||(u=o.type,i=o.pendingProps,f=Od(L.current).createElement(u),f[cn]=o,f[mn]=i,Tn(f,u,i),Qt(f),o.stateNode=f):o.memoizedState=zw(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return ie(o),i===null&&ot&&(f=o.stateNode=Dw(o.type,o.pendingProps,L.current),Sn=o,Er=!0,x=Mt,Si(o.type)?(gg=x,Mt=Tr(f.firstChild)):Mt=x),Nn(i,o,o.pendingProps.children,u),hd(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&ot&&((x=f=Mt)&&(f=qO(f,o.type,o.pendingProps,Er),f!==null?(o.stateNode=f,Sn=o,Mt=Tr(f.firstChild),Er=!1,x=!0):x=!1),x||ui(o)),ie(o),x=o.type,y=o.pendingProps,S=i!==null?i.memoizedProps:null,f=y.children,dg(x,y)?f=null:S!==null&&dg(x,S)&&(o.flags|=32),o.memoizedState!==null&&(x=um(i,o,aO,null,null,u),hc._currentValue=x),hd(i,o),Nn(i,o,f,u),o.child;case 6:return i===null&&ot&&((i=u=Mt)&&(u=WO(u,o.pendingProps,Er),u!==null?(o.stateNode=u,Sn=o,Mt=null,i=!0):i=!1),i||ui(o)),null;case 13:return Cv(i,o,u);case 4:return U(o,o.stateNode.containerInfo),f=o.pendingProps,i===null?o.child=va(o,null,f,u):Nn(i,o,f,u),o.child;case 11:return pv(i,o,o.type,o.pendingProps,u);case 7:return Nn(i,o,o.pendingProps,u),o.child;case 8:return Nn(i,o,o.pendingProps.children,u),o.child;case 12:return Nn(i,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,di(o,o.type,f.value),Nn(i,o,f.children,u),o.child;case 9:return x=o.type._context,f=o.pendingProps.children,ga(o),x=En(x),f=f(x),o.flags|=1,Nn(i,o,f,u),o.child;case 14:return mv(i,o,o.type,o.pendingProps,u);case 15:return gv(i,o,o.type,o.pendingProps,u);case 19:return Ev(i,o,u);case 31:return pO(i,o,u);case 22:return xv(i,o,u,o.pendingProps);case 24:return ga(o),f=En(Zt),i===null?(x=em(),x===null&&(x=kt,y=Qp(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=u),x=y),o.memoizedState={parent:f,cache:x},nm(o),di(o,Zt,x)):((i.lanes&u)!==0&&(rm(i,o),Kl(o,null,null,u),Wl()),x=i.memoizedState,y=o.memoizedState,x.parent!==f?(x={parent:f,cache:f},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),di(o,Zt,f)):(f=y.cache,di(o,Zt,f),f!==x.cache&&Xp(o,[Zt],u,!0))),Nn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Ns(i){i.flags|=4}function Bm(i,o,u,f,x){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(x&335544128)===x)if(i.stateNode.complete)i.flags|=8192;else if(Zv())i.flags|=8192;else throw ya=Qu,tm}else i.flags&=-16777217}function Tv(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Uw(o))if(Zv())i.flags|=8192;else throw ya=Qu,tm}function md(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?we():536870912,i.lanes|=o,Oo|=o)}function Zl(i,o){if(!ot)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Ot(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,f=0;if(o)for(var x=i.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=f,i.childLanes=u,o}function gO(i,o,u){var f=o.pendingProps;switch(Wp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(o),null;case 1:return Ot(o),null;case 3:return u=o.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),ks(Zt),ne(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(xo(o)?Ns(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Gp())),Ot(o),null;case 26:var x=o.type,y=o.memoizedState;return i===null?(Ns(o),y!==null?(Ot(o),Tv(o,y)):(Ot(o),Bm(o,x,null,f,u))):y?y!==i.memoizedState?(Ns(o),Ot(o),Tv(o,y)):(Ot(o),o.flags&=-16777217):(i=i.memoizedProps,i!==f&&Ns(o),Ot(o),Bm(o,x,i,f,u)),null;case 27:if(je(o),u=L.current,x=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==f&&Ns(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Ot(o),null}i=oe.current,xo(o)?a1(o):(i=Dw(x,f,u),o.stateNode=i,Ns(o))}return Ot(o),null;case 5:if(je(o),x=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==f&&Ns(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Ot(o),null}if(y=oe.current,xo(o))a1(o);else{var S=Od(L.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?S.createElement(x,{is:f.is}):S.createElement(x)}}y[cn]=o,y[mn]=f;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=y;e:switch(Tn(y,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ns(o)}}return Ot(o),Bm(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,u),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==f&&Ns(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(r(166));if(i=L.current,xo(o)){if(i=o.stateNode,u=o.memoizedProps,f=null,x=Sn,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}i[cn]=o,i=!!(i.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||Cw(i.nodeValue,u)),i||ui(o,!0)}else i=Od(i).createTextNode(f),i[cn]=o,o.stateNode=i}return Ot(o),null;case 31:if(u=o.memoizedState,i===null||i.memoizedState!==null){if(f=xo(o),u!==null){if(i===null){if(!f)throw Error(r(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[cn]=o}else pa(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ot(o),i=!1}else u=Gp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return o.flags&256?(fr(o),o):(fr(o),null);if((o.flags&128)!==0)throw Error(r(558))}return Ot(o),null;case 13:if(f=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(x=xo(o),f!==null&&f.dehydrated!==null){if(i===null){if(!x)throw Error(r(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[cn]=o}else pa(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ot(o),x=!1}else x=Gp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(fr(o),o):(fr(o),null)}return fr(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,i=i!==null&&i.memoizedState!==null,u&&(f=o.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==x&&(f.flags|=2048)),u!==i&&u&&(o.child.flags|=8192),md(o,o.updateQueue),Ot(o),null);case 4:return ne(),i===null&&ag(o.stateNode.containerInfo),Ot(o),null;case 10:return ks(o.type),Ot(o),null;case 19:if(R(Gt),f=o.memoizedState,f===null)return Ot(o),null;if(x=(o.flags&128)!==0,y=f.rendering,y===null)if(x)Zl(f,!1);else{if(Ut!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(y=nd(i),y!==null){for(o.flags|=128,Zl(f,!1),i=y.updateQueue,o.updateQueue=i,md(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)t1(u,i),u=u.sibling;return W(Gt,Gt.current&1|2),ot&&vs(o,f.treeForkCount),o.child}i=i.sibling}f.tail!==null&&Dt()>vd&&(o.flags|=128,x=!0,Zl(f,!1),o.lanes=4194304)}else{if(!x)if(i=nd(y),i!==null){if(o.flags|=128,x=!0,i=i.updateQueue,o.updateQueue=i,md(o,i),Zl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!ot)return Ot(o),null}else 2*Dt()-f.renderingStartTime>vd&&u!==536870912&&(o.flags|=128,x=!0,Zl(f,!1),o.lanes=4194304);f.isBackwards?(y.sibling=o.child,o.child=y):(i=f.last,i!==null?i.sibling=y:o.child=y,f.last=y)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Dt(),i.sibling=null,u=Gt.current,W(Gt,x?u&1|2:u&1),ot&&vs(o,f.treeForkCount),i):(Ot(o),null);case 22:case 23:return fr(o),om(),f=o.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(Ot(o),o.subtreeFlags&6&&(o.flags|=8192)):Ot(o),u=o.updateQueue,u!==null&&md(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),i!==null&&R(xa),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ks(Zt),Ot(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function xO(i,o){switch(Wp(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return ks(Zt),ne(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return je(o),null;case 31:if(o.memoizedState!==null){if(fr(o),o.alternate===null)throw Error(r(340));pa()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(fr(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));pa()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return R(Gt),null;case 4:return ne(),null;case 10:return ks(o.type),null;case 22:case 23:return fr(o),om(),i!==null&&R(xa),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return ks(Zt),null;case 25:return null;default:return null}}function Av(i,o){switch(Wp(o),o.tag){case 3:ks(Zt),ne();break;case 26:case 27:case 5:je(o);break;case 4:ne();break;case 31:o.memoizedState!==null&&fr(o);break;case 13:fr(o);break;case 19:R(Gt);break;case 10:ks(o.type);break;case 22:case 23:fr(o),om(),i!==null&&R(xa);break;case 24:ks(Zt)}}function ec(i,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var x=f.next;u=x;do{if((u.tag&i)===i){f=void 0;var y=u.create,S=u.inst;f=y(),S.destroy=f}u=u.next}while(u!==x)}}catch(T){gt(o,o.return,T)}}function xi(i,o,u){try{var f=o.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var y=x.next;f=y;do{if((f.tag&i)===i){var S=f.inst,T=S.destroy;if(T!==void 0){S.destroy=void 0,x=o;var D=u,X=T;try{X()}catch(le){gt(x,D,le)}}}f=f.next}while(f!==y)}}catch(le){gt(o,o.return,le)}}function Mv(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{y1(o,u)}catch(f){gt(i,i.return,f)}}}function Ov(i,o,u){u.props=ka(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(f){gt(i,o,f)}}function tc(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof u=="function"?i.refCleanup=u(f):u.current=f}}catch(x){gt(i,o,x)}}function ts(i,o){var u=i.ref,f=i.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(x){gt(i,o,x)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){gt(i,o,x)}else u.current=null}function jv(i){var o=i.type,u=i.memoizedProps,f=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(x){gt(i,i.return,x)}}function Pm(i,o,u){try{var f=i.stateNode;PO(f,i.type,u,o),f[mn]=o}catch(x){gt(i,i.return,x)}}function _v(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Si(i.type)||i.tag===4}function Hm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||_v(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Si(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Fm(i,o,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=xs));else if(f!==4&&(f===27&&Si(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(Fm(i,o,u),i=i.sibling;i!==null;)Fm(i,o,u),i=i.sibling}function gd(i,o,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(f!==4&&(f===27&&Si(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(gd(i,o,u),i=i.sibling;i!==null;)gd(i,o,u),i=i.sibling}function Rv(i){var o=i.stateNode,u=i.memoizedProps;try{for(var f=i.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Tn(o,f,u),o[cn]=i,o[mn]=u}catch(y){gt(i,i.return,y)}}var Ts=!1,nn=!1,Um=!1,Dv=typeof WeakSet=="function"?WeakSet:Set,gn=null;function bO(i,o){if(i=i.containerInfo,cg=zd,i=Wy(i),Lp(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var x=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var S=0,T=-1,D=-1,X=0,le=0,de=i,ee=null;t:for(;;){for(var se;de!==u||x!==0&&de.nodeType!==3||(T=S+x),de!==y||f!==0&&de.nodeType!==3||(D=S+f),de.nodeType===3&&(S+=de.nodeValue.length),(se=de.firstChild)!==null;)ee=de,de=se;for(;;){if(de===i)break t;if(ee===u&&++X===x&&(T=S),ee===y&&++le===f&&(D=S),(se=de.nextSibling)!==null)break;de=ee,ee=de.parentNode}de=se}u=T===-1||D===-1?null:{start:T,end:D}}else u=null}u=u||{start:0,end:0}}else u=null;for(ug={focusedElem:i,selectionRange:u},zd=!1,gn=o;gn!==null;)if(o=gn,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,gn=i;else for(;gn!==null;){switch(o=gn,y=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)x=i[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,u=o,x=y.memoizedProps,y=y.memoizedState,f=u.stateNode;try{var Oe=ka(u.type,x);i=f.getSnapshotBeforeUpdate(Oe,y),f.__reactInternalSnapshotBeforeUpdate=i}catch(He){gt(u,u.return,He)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)hg(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":hg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,gn=i;break}gn=o.return}}function Lv(i,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Ms(i,u),f&4&&ec(5,u);break;case 1:if(Ms(i,u),f&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(S){gt(u,u.return,S)}else{var x=ka(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(x,o,i.__reactInternalSnapshotBeforeUpdate)}catch(S){gt(u,u.return,S)}}f&64&&Mv(u),f&512&&tc(u,u.return);break;case 3:if(Ms(i,u),f&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{y1(i,o)}catch(S){gt(u,u.return,S)}}break;case 27:o===null&&f&4&&Rv(u);case 26:case 5:Ms(i,u),o===null&&f&4&&jv(u),f&512&&tc(u,u.return);break;case 12:Ms(i,u);break;case 31:Ms(i,u),f&4&&Bv(i,u);break;case 13:Ms(i,u),f&4&&Pv(i,u),f&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=TO.bind(null,u),KO(i,u))));break;case 22:if(f=u.memoizedState!==null||Ts,!f){o=o!==null&&o.memoizedState!==null||nn,x=Ts;var y=nn;Ts=f,(nn=o)&&!y?Os(i,u,(u.subtreeFlags&8772)!==0):Ms(i,u),Ts=x,nn=y}break;case 30:break;default:Ms(i,u)}}function Iv(i){var o=i.alternate;o!==null&&(i.alternate=null,Iv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&El(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Lt=null,Qn=!1;function As(i,o,u){for(u=u.child;u!==null;)zv(i,o,u),u=u.sibling}function zv(i,o,u){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(pn,u)}catch{}switch(u.tag){case 26:nn||ts(u,o),As(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:nn||ts(u,o);var f=Lt,x=Qn;Si(u.type)&&(Lt=u.stateNode,Qn=!1),As(i,o,u),uc(u.stateNode),Lt=f,Qn=x;break;case 5:nn||ts(u,o);case 6:if(f=Lt,x=Qn,Lt=null,As(i,o,u),Lt=f,Qn=x,Lt!==null)if(Qn)try{(Lt.nodeType===9?Lt.body:Lt.nodeName==="HTML"?Lt.ownerDocument.body:Lt).removeChild(u.stateNode)}catch(y){gt(u,o,y)}else try{Lt.removeChild(u.stateNode)}catch(y){gt(u,o,y)}break;case 18:Lt!==null&&(Qn?(i=Lt,Mw(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Bo(i)):Mw(Lt,u.stateNode));break;case 4:f=Lt,x=Qn,Lt=u.stateNode.containerInfo,Qn=!0,As(i,o,u),Lt=f,Qn=x;break;case 0:case 11:case 14:case 15:xi(2,u,o),nn||xi(4,u,o),As(i,o,u);break;case 1:nn||(ts(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&Ov(u,o,f)),As(i,o,u);break;case 21:As(i,o,u);break;case 22:nn=(f=nn)||u.memoizedState!==null,As(i,o,u),nn=f;break;default:As(i,o,u)}}function Bv(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Bo(i)}catch(u){gt(o,o.return,u)}}}function Pv(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Bo(i)}catch(u){gt(o,o.return,u)}}function yO(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Dv),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Dv),o;default:throw Error(r(435,i.tag))}}function xd(i,o){var u=yO(i);o.forEach(function(f){if(!u.has(f)){u.add(f);var x=AO.bind(null,i,f);f.then(x,x)}})}function Zn(i,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var x=u[f],y=i,S=o,T=S;e:for(;T!==null;){switch(T.tag){case 27:if(Si(T.type)){Lt=T.stateNode,Qn=!1;break e}break;case 5:Lt=T.stateNode,Qn=!1;break e;case 3:case 4:Lt=T.stateNode.containerInfo,Qn=!0;break e}T=T.return}if(Lt===null)throw Error(r(160));zv(y,S,x),Lt=null,Qn=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Hv(o,i),o=o.sibling}var Br=null;function Hv(i,o){var u=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Zn(o,i),er(i),f&4&&(xi(3,i,i.return),ec(3,i),xi(5,i,i.return));break;case 1:Zn(o,i),er(i),f&512&&(nn||u===null||ts(u,u.return)),f&64&&Ts&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var x=Br;if(Zn(o,i),er(i),f&512&&(nn||u===null||ts(u,u.return)),f&4){var y=u!==null?u.memoizedState:null;if(f=i.memoizedState,u===null)if(f===null)if(i.stateNode===null){e:{f=i.type,u=i.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":y=x.getElementsByTagName("title")[0],(!y||y[ri]||y[cn]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(f),x.head.insertBefore(y,x.querySelector("head > title"))),Tn(y,f,u),y[cn]=i,Qt(y),f=y;break e;case"link":var S=Hw("link","href",x).get(f+(u.href||""));if(S){for(var T=0;T<S.length;T++)if(y=S[T],y.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&y.getAttribute("rel")===(u.rel==null?null:u.rel)&&y.getAttribute("title")===(u.title==null?null:u.title)&&y.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(T,1);break t}}y=x.createElement(f),Tn(y,f,u),x.head.appendChild(y);break;case"meta":if(S=Hw("meta","content",x).get(f+(u.content||""))){for(T=0;T<S.length;T++)if(y=S[T],y.getAttribute("content")===(u.content==null?null:""+u.content)&&y.getAttribute("name")===(u.name==null?null:u.name)&&y.getAttribute("property")===(u.property==null?null:u.property)&&y.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&y.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(T,1);break t}}y=x.createElement(f),Tn(y,f,u),x.head.appendChild(y);break;default:throw Error(r(468,f))}y[cn]=i,Qt(y),f=y}i.stateNode=f}else Fw(x,i.type,i.stateNode);else i.stateNode=Pw(x,f,i.memoizedProps);else y!==f?(y===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):y.count--,f===null?Fw(x,i.type,i.stateNode):Pw(x,f,i.memoizedProps)):f===null&&i.stateNode!==null&&Pm(i,i.memoizedProps,u.memoizedProps)}break;case 27:Zn(o,i),er(i),f&512&&(nn||u===null||ts(u,u.return)),u!==null&&f&4&&Pm(i,i.memoizedProps,u.memoizedProps);break;case 5:if(Zn(o,i),er(i),f&512&&(nn||u===null||ts(u,u.return)),i.flags&32){x=i.stateNode;try{ao(x,"")}catch(Oe){gt(i,i.return,Oe)}}f&4&&i.stateNode!=null&&(x=i.memoizedProps,Pm(i,x,u!==null?u.memoizedProps:x)),f&1024&&(Um=!0);break;case 6:if(Zn(o,i),er(i),f&4){if(i.stateNode===null)throw Error(r(162));f=i.memoizedProps,u=i.stateNode;try{u.nodeValue=f}catch(Oe){gt(i,i.return,Oe)}}break;case 3:if(Rd=null,x=Br,Br=jd(o.containerInfo),Zn(o,i),Br=x,er(i),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Bo(o.containerInfo)}catch(Oe){gt(i,i.return,Oe)}Um&&(Um=!1,Fv(i));break;case 4:f=Br,Br=jd(i.stateNode.containerInfo),Zn(o,i),er(i),Br=f;break;case 12:Zn(o,i),er(i);break;case 31:Zn(o,i),er(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 13:Zn(o,i),er(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(yd=Dt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 22:x=i.memoizedState!==null;var D=u!==null&&u.memoizedState!==null,X=Ts,le=nn;if(Ts=X||x,nn=le||D,Zn(o,i),nn=le,Ts=X,er(i),f&8192)e:for(o=i.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||D||Ts||nn||Ca(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){D=u=o;try{if(y=D.stateNode,x)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{T=D.stateNode;var de=D.memoizedProps.style,ee=de!=null&&de.hasOwnProperty("display")?de.display:null;T.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(Oe){gt(D,D.return,Oe)}}}else if(o.tag===6){if(u===null){D=o;try{D.stateNode.nodeValue=x?"":D.memoizedProps}catch(Oe){gt(D,D.return,Oe)}}}else if(o.tag===18){if(u===null){D=o;try{var se=D.stateNode;x?Ow(se,!0):Ow(D.stateNode,!1)}catch(Oe){gt(D,D.return,Oe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=i.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,xd(i,u))));break;case 19:Zn(o,i),er(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 30:break;case 21:break;default:Zn(o,i),er(i)}}function er(i){var o=i.flags;if(o&2){try{for(var u,f=i.return;f!==null;){if(_v(f)){u=f;break}f=f.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var x=u.stateNode,y=Hm(i);gd(i,y,x);break;case 5:var S=u.stateNode;u.flags&32&&(ao(S,""),u.flags&=-33);var T=Hm(i);gd(i,T,S);break;case 3:case 4:var D=u.stateNode.containerInfo,X=Hm(i);Fm(i,X,D);break;default:throw Error(r(161))}}catch(le){gt(i,i.return,le)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function Fv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;Fv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Ms(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Lv(i,o.alternate,o),o=o.sibling}function Ca(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:xi(4,o,o.return),Ca(o);break;case 1:ts(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Ov(o,o.return,u),Ca(o);break;case 27:uc(o.stateNode);case 26:case 5:ts(o,o.return),Ca(o);break;case 22:o.memoizedState===null&&Ca(o);break;case 30:Ca(o);break;default:Ca(o)}i=i.sibling}}function Os(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,x=i,y=o,S=y.flags;switch(y.tag){case 0:case 11:case 15:Os(x,y,u),ec(4,y);break;case 1:if(Os(x,y,u),f=y,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(X){gt(f,f.return,X)}if(f=y,x=f.updateQueue,x!==null){var T=f.stateNode;try{var D=x.shared.hiddenCallbacks;if(D!==null)for(x.shared.hiddenCallbacks=null,x=0;x<D.length;x++)b1(D[x],T)}catch(X){gt(f,f.return,X)}}u&&S&64&&Mv(y),tc(y,y.return);break;case 27:Rv(y);case 26:case 5:Os(x,y,u),u&&f===null&&S&4&&jv(y),tc(y,y.return);break;case 12:Os(x,y,u);break;case 31:Os(x,y,u),u&&S&4&&Bv(x,y);break;case 13:Os(x,y,u),u&&S&4&&Pv(x,y);break;case 22:y.memoizedState===null&&Os(x,y,u),tc(y,y.return);break;case 30:break;default:Os(x,y,u)}o=o.sibling}}function $m(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&Fl(u))}function Vm(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Fl(i))}function Pr(i,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Uv(i,o,u,f),o=o.sibling}function Uv(i,o,u,f){var x=o.flags;switch(o.tag){case 0:case 11:case 15:Pr(i,o,u,f),x&2048&&ec(9,o);break;case 1:Pr(i,o,u,f);break;case 3:Pr(i,o,u,f),x&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Fl(i)));break;case 12:if(x&2048){Pr(i,o,u,f),i=o.stateNode;try{var y=o.memoizedProps,S=y.id,T=y.onPostCommit;typeof T=="function"&&T(S,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(D){gt(o,o.return,D)}}else Pr(i,o,u,f);break;case 31:Pr(i,o,u,f);break;case 13:Pr(i,o,u,f);break;case 23:break;case 22:y=o.stateNode,S=o.alternate,o.memoizedState!==null?y._visibility&2?Pr(i,o,u,f):nc(i,o):y._visibility&2?Pr(i,o,u,f):(y._visibility|=2,To(i,o,u,f,(o.subtreeFlags&10256)!==0||!1)),x&2048&&$m(S,o);break;case 24:Pr(i,o,u,f),x&2048&&Vm(o.alternate,o);break;default:Pr(i,o,u,f)}}function To(i,o,u,f,x){for(x=x&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=i,S=o,T=u,D=f,X=S.flags;switch(S.tag){case 0:case 11:case 15:To(y,S,T,D,x),ec(8,S);break;case 23:break;case 22:var le=S.stateNode;S.memoizedState!==null?le._visibility&2?To(y,S,T,D,x):nc(y,S):(le._visibility|=2,To(y,S,T,D,x)),x&&X&2048&&$m(S.alternate,S);break;case 24:To(y,S,T,D,x),x&&X&2048&&Vm(S.alternate,S);break;default:To(y,S,T,D,x)}o=o.sibling}}function nc(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,f=o,x=f.flags;switch(f.tag){case 22:nc(u,f),x&2048&&$m(f.alternate,f);break;case 24:nc(u,f),x&2048&&Vm(f.alternate,f);break;default:nc(u,f)}o=o.sibling}}var rc=8192;function Ao(i,o,u){if(i.subtreeFlags&rc)for(i=i.child;i!==null;)$v(i,o,u),i=i.sibling}function $v(i,o,u){switch(i.tag){case 26:Ao(i,o,u),i.flags&rc&&i.memoizedState!==null&&ij(u,Br,i.memoizedState,i.memoizedProps);break;case 5:Ao(i,o,u);break;case 3:case 4:var f=Br;Br=jd(i.stateNode.containerInfo),Ao(i,o,u),Br=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=rc,rc=16777216,Ao(i,o,u),rc=f):Ao(i,o,u));break;default:Ao(i,o,u)}}function Vv(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function sc(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];gn=f,Wv(f,i)}Vv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)qv(i),i=i.sibling}function qv(i){switch(i.tag){case 0:case 11:case 15:sc(i),i.flags&2048&&xi(9,i,i.return);break;case 3:sc(i);break;case 12:sc(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,bd(i)):sc(i);break;default:sc(i)}}function bd(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];gn=f,Wv(f,i)}Vv(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:xi(8,o,o.return),bd(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,bd(o));break;default:bd(o)}i=i.sibling}}function Wv(i,o){for(;gn!==null;){var u=gn;switch(u.tag){case 0:case 11:case 15:xi(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Fl(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,gn=f;else e:for(u=i;gn!==null;){f=gn;var x=f.sibling,y=f.return;if(Iv(f),f===u){gn=null;break e}if(x!==null){x.return=y,gn=x;break e}gn=y}}}var vO={getCacheForType:function(i){var o=En(Zt),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u},cacheSignal:function(){return En(Zt).controller.signal}},wO=typeof WeakMap=="function"?WeakMap:Map,dt=0,kt=null,et=null,it=0,mt=0,hr=null,bi=!1,Mo=!1,qm=!1,js=0,Ut=0,yi=0,Sa=0,Wm=0,pr=0,Oo=0,ic=null,tr=null,Km=!1,yd=0,Kv=0,vd=1/0,wd=null,vi=null,un=0,wi=null,jo=null,_s=0,Gm=0,Ym=null,Gv=null,ac=0,Jm=null;function mr(){return(dt&2)!==0&&it!==0?it&-it:q.T!==null?ng():Cn()}function Yv(){if(pr===0)if((it&536870912)===0||ot){var i=yr;yr<<=1,(yr&3932160)===0&&(yr=262144),pr=i}else pr=536870912;return i=dr.current,i!==null&&(i.flags|=32),pr}function nr(i,o,u){(i===kt&&(mt===2||mt===9)||i.cancelPendingCommit!==null)&&(_o(i,0),ki(i,it,pr,!1)),Ve(i,u),((dt&2)===0||i!==kt)&&(i===kt&&((dt&2)===0&&(Sa|=u),Ut===4&&ki(i,it,pr,!1)),ns(i))}function Jv(i,o,u){if((dt&6)!==0)throw Error(r(327));var f=!u&&(o&127)===0&&(o&i.expiredLanes)===0||me(i,o),x=f?SO(i,o):Qm(i,o,!0),y=f;do{if(x===0){Mo&&!f&&ki(i,o,0,!1);break}else{if(u=i.current.alternate,y&&!kO(u)){x=Qm(i,o,!1),y=!1;continue}if(x===2){if(y=o,i.errorRecoveryDisabledLanes&y)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var T=i;x=ic;var D=T.current.memoizedState.isDehydrated;if(D&&(_o(T,S).flags|=256),S=Qm(T,S,!1),S!==2){if(qm&&!D){T.errorRecoveryDisabledLanes|=y,Sa|=y,x=4;break e}y=tr,tr=x,y!==null&&(tr===null?tr=y:tr.push.apply(tr,y))}x=S}if(y=!1,x!==2)continue}}if(x===1){_o(i,0),ki(i,o,0,!0);break}e:{switch(f=i,y=x,y){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:ki(f,o,pr,!bi);break e;case 2:tr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(x=yd+300-Dt(),10<x)){if(ki(f,o,pr,!bi),ue(f,0,!0)!==0)break e;_s=o,f.timeoutHandle=Tw(Xv.bind(null,f,u,tr,wd,Km,o,pr,Sa,Oo,bi,y,"Throttled",-0,0),x);break e}Xv(f,u,tr,wd,Km,o,pr,Sa,Oo,bi,y,null,-0,0)}}break}while(!0);ns(i)}function Xv(i,o,u,f,x,y,S,T,D,X,le,de,ee,se){if(i.timeoutHandle=-1,de=o.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xs},$v(o,y,de);var Oe=(y&62914560)===y?yd-Dt():(y&4194048)===y?Kv-Dt():0;if(Oe=aj(de,Oe),Oe!==null){_s=y,i.cancelPendingCommit=Oe(iw.bind(null,i,o,y,u,f,x,S,T,D,le,de,null,ee,se)),ki(i,y,S,!X);return}}iw(i,o,y,u,f,x,S,T,D)}function kO(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var x=u[f],y=x.getSnapshot;x=x.value;try{if(!cr(y(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ki(i,o,u,f){o&=~Wm,o&=~Sa,i.suspendedLanes|=o,i.pingedLanes&=~o,f&&(i.warmLanes|=o),f=i.expirationTimes;for(var x=o;0<x;){var y=31-Kt(x),S=1<<y;f[y]=-1,x&=~S}u!==0&&Qe(i,u,o)}function kd(){return(dt&6)===0?(oc(0),!1):!0}function Xm(){if(et!==null){if(mt===0)var i=et.return;else i=et,ws=ma=null,hm(i),ko=null,$l=0,i=et;for(;i!==null;)Av(i.alternate,i),i=i.return;et=null}}function _o(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,UO(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),_s=0,Xm(),kt=i,et=u=ys(i.current,null),it=o,mt=0,hr=null,bi=!1,Mo=me(i,o),qm=!1,Oo=pr=Wm=Sa=yi=Ut=0,tr=ic=null,Km=!1,(o&8)!==0&&(o|=o&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=o;0<f;){var x=31-Kt(f),y=1<<x;o|=i[x],f&=~y}return js=o,$u(),u}function Qv(i,o){Ge=null,q.H=Xl,o===wo||o===Xu?(o=p1(),mt=3):o===tm?(o=p1(),mt=4):mt=o===Mm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,hr=o,et===null&&(Ut=1,dd(i,kr(o,i.current)))}function Zv(){var i=dr.current;return i===null?!0:(it&4194048)===it?Nr===null:(it&62914560)===it||(it&536870912)!==0?i===Nr:!1}function ew(){var i=q.H;return q.H=Xl,i===null?Xl:i}function tw(){var i=q.A;return q.A=vO,i}function Cd(){Ut=4,bi||(it&4194048)!==it&&dr.current!==null||(Mo=!0),(yi&134217727)===0&&(Sa&134217727)===0||kt===null||ki(kt,it,pr,!1)}function Qm(i,o,u){var f=dt;dt|=2;var x=ew(),y=tw();(kt!==i||it!==o)&&(wd=null,_o(i,o)),o=!1;var S=Ut;e:do try{if(mt!==0&&et!==null){var T=et,D=hr;switch(mt){case 8:Xm(),S=6;break e;case 3:case 2:case 9:case 6:dr.current===null&&(o=!0);var X=mt;if(mt=0,hr=null,Ro(i,T,D,X),u&&Mo){S=0;break e}break;default:X=mt,mt=0,hr=null,Ro(i,T,D,X)}}CO(),S=Ut;break}catch(le){Qv(i,le)}while(!0);return o&&i.shellSuspendCounter++,ws=ma=null,dt=f,q.H=x,q.A=y,et===null&&(kt=null,it=0,$u()),S}function CO(){for(;et!==null;)nw(et)}function SO(i,o){var u=dt;dt|=2;var f=ew(),x=tw();kt!==i||it!==o?(wd=null,vd=Dt()+500,_o(i,o)):Mo=me(i,o);e:do try{if(mt!==0&&et!==null){o=et;var y=hr;t:switch(mt){case 1:mt=0,hr=null,Ro(i,o,y,1);break;case 2:case 9:if(f1(y)){mt=0,hr=null,rw(o);break}o=function(){mt!==2&&mt!==9||kt!==i||(mt=7),ns(i)},y.then(o,o);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:f1(y)?(mt=0,hr=null,rw(o)):(mt=0,hr=null,Ro(i,o,y,7));break;case 5:var S=null;switch(et.tag){case 26:S=et.memoizedState;case 5:case 27:var T=et;if(S?Uw(S):T.stateNode.complete){mt=0,hr=null;var D=T.sibling;if(D!==null)et=D;else{var X=T.return;X!==null?(et=X,Sd(X)):et=null}break t}}mt=0,hr=null,Ro(i,o,y,5);break;case 6:mt=0,hr=null,Ro(i,o,y,6);break;case 8:Xm(),Ut=6;break e;default:throw Error(r(462))}}EO();break}catch(le){Qv(i,le)}while(!0);return ws=ma=null,q.H=f,q.A=x,dt=u,et!==null?0:(kt=null,it=0,$u(),Ut)}function EO(){for(;et!==null&&!on();)nw(et)}function nw(i){var o=Nv(i.alternate,i,js);i.memoizedProps=i.pendingProps,o===null?Sd(i):et=o}function rw(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=vv(u,o,o.pendingProps,o.type,void 0,it);break;case 11:o=vv(u,o,o.pendingProps,o.type.render,o.ref,it);break;case 5:hm(o);default:Av(u,o),o=et=t1(o,js),o=Nv(u,o,js)}i.memoizedProps=i.pendingProps,o===null?Sd(i):et=o}function Ro(i,o,u,f){ws=ma=null,hm(o),ko=null,$l=0;var x=o.return;try{if(hO(i,x,o,u,it)){Ut=1,dd(i,kr(u,i.current)),et=null;return}}catch(y){if(x!==null)throw et=x,y;Ut=1,dd(i,kr(u,i.current)),et=null;return}o.flags&32768?(ot||f===1?i=!0:Mo||(it&536870912)!==0?i=!1:(bi=i=!0,(f===2||f===9||f===3||f===6)&&(f=dr.current,f!==null&&f.tag===13&&(f.flags|=16384))),sw(o,i)):Sd(o)}function Sd(i){var o=i;do{if((o.flags&32768)!==0){sw(o,bi);return}i=o.return;var u=gO(o.alternate,o,js);if(u!==null){et=u;return}if(o=o.sibling,o!==null){et=o;return}et=o=i}while(o!==null);Ut===0&&(Ut=5)}function sw(i,o){do{var u=xO(i.alternate,i);if(u!==null){u.flags&=32767,et=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){et=i;return}et=i=u}while(i!==null);Ut=6,et=null}function iw(i,o,u,f,x,y,S,T,D){i.cancelPendingCommit=null;do Ed();while(un!==0);if((dt&6)!==0)throw Error(r(327));if(o!==null){if(o===i.current)throw Error(r(177));if(y=o.lanes|o.childLanes,y|=Hp,Ae(i,u,y,S,T,D),i===kt&&(et=kt=null,it=0),jo=o,wi=i,_s=u,Gm=y,Ym=x,Gv=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,MO(hn,function(){return uw(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=q.T,q.T=null,x=te.p,te.p=2,S=dt,dt|=4;try{bO(i,o,u)}finally{dt=S,te.p=x,q.T=f}}un=1,aw(),ow(),lw()}}function aw(){if(un===1){un=0;var i=wi,o=jo,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=q.T,q.T=null;var f=te.p;te.p=2;var x=dt;dt|=4;try{Hv(o,i);var y=ug,S=Wy(i.containerInfo),T=y.focusedElem,D=y.selectionRange;if(S!==T&&T&&T.ownerDocument&&qy(T.ownerDocument.documentElement,T)){if(D!==null&&Lp(T)){var X=D.start,le=D.end;if(le===void 0&&(le=X),"selectionStart"in T)T.selectionStart=X,T.selectionEnd=Math.min(le,T.value.length);else{var de=T.ownerDocument||document,ee=de&&de.defaultView||window;if(ee.getSelection){var se=ee.getSelection(),Oe=T.textContent.length,He=Math.min(D.start,Oe),yt=D.end===void 0?He:Math.min(D.end,Oe);!se.extend&&He>yt&&(S=yt,yt=He,He=S);var $=Vy(T,He),B=Vy(T,yt);if($&&B&&(se.rangeCount!==1||se.anchorNode!==$.node||se.anchorOffset!==$.offset||se.focusNode!==B.node||se.focusOffset!==B.offset)){var J=de.createRange();J.setStart($.node,$.offset),se.removeAllRanges(),He>yt?(se.addRange(J),se.extend(B.node,B.offset)):(J.setEnd(B.node,B.offset),se.addRange(J))}}}}for(de=[],se=T;se=se.parentNode;)se.nodeType===1&&de.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<de.length;T++){var ce=de[T];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}zd=!!cg,ug=cg=null}finally{dt=x,te.p=f,q.T=u}}i.current=o,un=2}}function ow(){if(un===2){un=0;var i=wi,o=jo,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=q.T,q.T=null;var f=te.p;te.p=2;var x=dt;dt|=4;try{Lv(i,o.alternate,o)}finally{dt=x,te.p=f,q.T=u}}un=3}}function lw(){if(un===4||un===3){un=0,Kn();var i=wi,o=jo,u=_s,f=Gv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?un=5:(un=0,jo=wi=null,cw(i,i.pendingLanes));var x=i.pendingLanes;if(x===0&&(vi=null),It(u),o=o.stateNode,Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(pn,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=q.T,x=te.p,te.p=2,q.T=null;try{for(var y=i.onRecoverableError,S=0;S<f.length;S++){var T=f[S];y(T.value,{componentStack:T.stack})}}finally{q.T=o,te.p=x}}(_s&3)!==0&&Ed(),ns(i),x=i.pendingLanes,(u&261930)!==0&&(x&42)!==0?i===Jm?ac++:(ac=0,Jm=i):ac=0,oc(0)}}function cw(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Fl(o)))}function Ed(){return aw(),ow(),lw(),uw()}function uw(){if(un!==5)return!1;var i=wi,o=Gm;Gm=0;var u=It(_s),f=q.T,x=te.p;try{te.p=32>u?32:u,q.T=null,u=Ym,Ym=null;var y=wi,S=_s;if(un=0,jo=wi=null,_s=0,(dt&6)!==0)throw Error(r(331));var T=dt;if(dt|=4,qv(y.current),Uv(y,y.current,S,u),dt=T,oc(0,!1),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(pn,y)}catch{}return!0}finally{te.p=x,q.T=f,cw(i,o)}}function dw(i,o,u){o=kr(u,o),o=Am(i.stateNode,o,2),i=pi(i,o,2),i!==null&&(Ve(i,2),ns(i))}function gt(i,o,u){if(i.tag===3)dw(i,i,u);else for(;o!==null;){if(o.tag===3){dw(o,i,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(vi===null||!vi.has(f))){i=kr(u,i),u=fv(2),f=pi(o,u,2),f!==null&&(hv(u,f,o,i),Ve(f,2),ns(f));break}}o=o.return}}function Zm(i,o,u){var f=i.pingCache;if(f===null){f=i.pingCache=new wO;var x=new Set;f.set(o,x)}else x=f.get(o),x===void 0&&(x=new Set,f.set(o,x));x.has(u)||(qm=!0,x.add(u),i=NO.bind(null,i,o,u),o.then(i,i))}function NO(i,o,u){var f=i.pingCache;f!==null&&f.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,kt===i&&(it&u)===u&&(Ut===4||Ut===3&&(it&62914560)===it&&300>Dt()-yd?(dt&2)===0&&_o(i,0):Wm|=u,Oo===it&&(Oo=0)),ns(i)}function fw(i,o){o===0&&(o=we()),i=fa(i,o),i!==null&&(Ve(i,o),ns(i))}function TO(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),fw(i,u)}function AO(i,o){var u=0;switch(i.tag){case 31:case 13:var f=i.stateNode,x=i.memoizedState;x!==null&&(u=x.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(o),fw(i,u)}function MO(i,o){return _e(i,o)}var Nd=null,Do=null,eg=!1,Td=!1,tg=!1,Ci=0;function ns(i){i!==Do&&i.next===null&&(Do===null?Nd=Do=i:Do=Do.next=i),Td=!0,eg||(eg=!0,jO())}function oc(i,o){if(!tg&&Td){tg=!0;do for(var u=!1,f=Nd;f!==null;){if(i!==0){var x=f.pendingLanes;if(x===0)var y=0;else{var S=f.suspendedLanes,T=f.pingedLanes;y=(1<<31-Kt(42|i)+1)-1,y&=x&~(S&~T),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(u=!0,gw(f,y))}else y=it,y=ue(f,f===kt?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||me(f,y)||(u=!0,gw(f,y));f=f.next}while(u);tg=!1}}function OO(){hw()}function hw(){Td=eg=!1;var i=0;Ci!==0&&FO()&&(i=Ci);for(var o=Dt(),u=null,f=Nd;f!==null;){var x=f.next,y=pw(f,o);y===0?(f.next=null,u===null?Nd=x:u.next=x,x===null&&(Do=u)):(u=f,(i!==0||(y&3)!==0)&&(Td=!0)),f=x}un!==0&&un!==5||oc(i),Ci!==0&&(Ci=0)}function pw(i,o){for(var u=i.suspendedLanes,f=i.pingedLanes,x=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var S=31-Kt(y),T=1<<S,D=x[S];D===-1?((T&u)===0||(T&f)!==0)&&(x[S]=ke(T,o)):D<=o&&(i.expiredLanes|=T),y&=~T}if(o=kt,u=it,u=ue(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,u===0||i===o&&(mt===2||mt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&an(f),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||me(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(f!==null&&an(f),It(u)){case 2:case 8:u=Gn;break;case 32:u=hn;break;case 268435456:u=Yr;break;default:u=hn}return f=mw.bind(null,i),u=_e(u,f),i.callbackPriority=o,i.callbackNode=u,o}return f!==null&&f!==null&&an(f),i.callbackPriority=2,i.callbackNode=null,2}function mw(i,o){if(un!==0&&un!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Ed()&&i.callbackNode!==u)return null;var f=it;return f=ue(i,i===kt?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(Jv(i,f,o),pw(i,Dt()),i.callbackNode!=null&&i.callbackNode===u?mw.bind(null,i):null)}function gw(i,o){if(Ed())return null;Jv(i,o,!0)}function jO(){$O(function(){(dt&6)!==0?_e(Gr,OO):hw()})}function ng(){if(Ci===0){var i=yo;i===0&&(i=Jn,Jn<<=1,(Jn&261888)===0&&(Jn=256)),Ci=i}return Ci}function xw(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Lu(""+i)}function bw(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function _O(i,o,u,f,x){if(o==="submit"&&u&&u.stateNode===x){var y=xw((x[mn]||null).action),S=f.submitter;S&&(o=(o=S[mn]||null)?xw(o.formAction):S.getAttribute("formAction"),o!==null&&(y=o,S=null));var T=new Pu("action","action",null,f,x);i.push({event:T,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ci!==0){var D=S?bw(x,S):new FormData(x);km(u,{pending:!0,data:D,method:x.method,action:y},null,D)}}else typeof y=="function"&&(T.preventDefault(),D=S?bw(x,S):new FormData(x),km(u,{pending:!0,data:D,method:x.method,action:y},y,D))},currentTarget:x}]})}}for(var rg=0;rg<Pp.length;rg++){var sg=Pp[rg],RO=sg.toLowerCase(),DO=sg[0].toUpperCase()+sg.slice(1);zr(RO,"on"+DO)}zr(Yy,"onAnimationEnd"),zr(Jy,"onAnimationIteration"),zr(Xy,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(JM,"onTransitionRun"),zr(XM,"onTransitionStart"),zr(QM,"onTransitionCancel"),zr(Qy,"onTransitionEnd"),gs("onMouseEnter",["mouseout","mouseover"]),gs("onMouseLeave",["mouseout","mouseover"]),gs("onPointerEnter",["pointerout","pointerover"]),gs("onPointerLeave",["pointerout","pointerover"]),vr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vr("onBeforeInput",["compositionend","keypress","textInput","paste"]),vr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lc));function yw(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var f=i[u],x=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var S=f.length-1;0<=S;S--){var T=f[S],D=T.instance,X=T.currentTarget;if(T=T.listener,D!==y&&x.isPropagationStopped())break e;y=T,x.currentTarget=X;try{y(x)}catch(le){Uu(le)}x.currentTarget=null,y=D}else for(S=0;S<f.length;S++){if(T=f[S],D=T.instance,X=T.currentTarget,T=T.listener,D!==y&&x.isPropagationStopped())break e;y=T,x.currentTarget=X;try{y(x)}catch(le){Uu(le)}x.currentTarget=null,y=D}}}}function tt(i,o){var u=o[Cl];u===void 0&&(u=o[Cl]=new Set);var f=i+"__bubble";u.has(f)||(vw(o,i,2,!1),u.add(f))}function ig(i,o,u){var f=0;o&&(f|=4),vw(u,i,f,o)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function ag(i){if(!i[Ad]){i[Ad]=!0,Fn.forEach(function(u){u!=="selectionchange"&&(LO.has(u)||ig(u,!1,i),ig(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Ad]||(o[Ad]=!0,ig("selectionchange",!1,o))}}function vw(i,o,u,f){switch(Yw(o)){case 2:var x=cj;break;case 8:x=uj;break;default:x=wg}u=x.bind(null,o,u,i),x=void 0,!Np||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),f?x!==void 0?i.addEventListener(o,u,{capture:!0,passive:x}):i.addEventListener(o,u,!0):x!==void 0?i.addEventListener(o,u,{passive:x}):i.addEventListener(o,u,!1)}function og(i,o,u,f,x){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var T=f.stateNode.containerInfo;if(T===x)break;if(S===4)for(S=f.return;S!==null;){var D=S.tag;if((D===3||D===4)&&S.stateNode.containerInfo===x)return;S=S.return}for(;T!==null;){if(S=si(T),S===null)return;if(D=S.tag,D===5||D===6||D===26||D===27){f=y=S;continue e}T=T.parentNode}}f=f.return}Ey(function(){var X=y,le=Sp(u),de=[];e:{var ee=Zy.get(i);if(ee!==void 0){var se=Pu,Oe=i;switch(i){case"keypress":if(zu(u)===0)break e;case"keydown":case"keyup":se=AM;break;case"focusin":Oe="focus",se=Op;break;case"focusout":Oe="blur",se=Op;break;case"beforeblur":case"afterblur":se=Op;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=Ay;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=gM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=jM;break;case Yy:case Jy:case Xy:se=yM;break;case Qy:se=RM;break;case"scroll":case"scrollend":se=pM;break;case"wheel":se=LM;break;case"copy":case"cut":case"paste":se=wM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Oy;break;case"toggle":case"beforetoggle":se=zM}var He=(o&4)!==0,yt=!He&&(i==="scroll"||i==="scrollend"),$=He?ee!==null?ee+"Capture":null:ee;He=[];for(var B=X,J;B!==null;){var ce=B;if(J=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||J===null||$===null||(ce=Ol(B,$),ce!=null&&He.push(cc(B,ce,J))),yt)break;B=B.return}0<He.length&&(ee=new se(ee,Oe,null,u,le),de.push({event:ee,listeners:He}))}}if((o&7)===0){e:{if(ee=i==="mouseover"||i==="pointerover",se=i==="mouseout"||i==="pointerout",ee&&u!==Cp&&(Oe=u.relatedTarget||u.fromElement)&&(si(Oe)||Oe[ni]))break e;if((se||ee)&&(ee=le.window===le?le:(ee=le.ownerDocument)?ee.defaultView||ee.parentWindow:window,se?(Oe=u.relatedTarget||u.toElement,se=X,Oe=Oe?si(Oe):null,Oe!==null&&(yt=a(Oe),He=Oe.tag,Oe!==yt||He!==5&&He!==27&&He!==6)&&(Oe=null)):(se=null,Oe=X),se!==Oe)){if(He=Ay,ce="onMouseLeave",$="onMouseEnter",B="mouse",(i==="pointerout"||i==="pointerover")&&(He=Oy,ce="onPointerLeave",$="onPointerEnter",B="pointer"),yt=se==null?ee:oa(se),J=Oe==null?ee:oa(Oe),ee=new He(ce,B+"leave",se,u,le),ee.target=yt,ee.relatedTarget=J,ce=null,si(le)===X&&(He=new He($,B+"enter",Oe,u,le),He.target=J,He.relatedTarget=yt,ce=He),yt=ce,se&&Oe)t:{for(He=IO,$=se,B=Oe,J=0,ce=$;ce;ce=He(ce))J++;ce=0;for(var Ie=B;Ie;Ie=He(Ie))ce++;for(;0<J-ce;)$=He($),J--;for(;0<ce-J;)B=He(B),ce--;for(;J--;){if($===B||B!==null&&$===B.alternate){He=$;break t}$=He($),B=He(B)}He=null}else He=null;se!==null&&ww(de,ee,se,He,!1),Oe!==null&&yt!==null&&ww(de,yt,Oe,He,!0)}}e:{if(ee=X?oa(X):window,se=ee.nodeName&&ee.nodeName.toLowerCase(),se==="select"||se==="input"&&ee.type==="file")var ct=By;else if(Iy(ee))if(Py)ct=KM;else{ct=qM;var Re=VM}else se=ee.nodeName,!se||se.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?X&&kp(X.elementType)&&(ct=By):ct=WM;if(ct&&(ct=ct(i,X))){zy(de,ct,u,le);break e}Re&&Re(i,ee,X),i==="focusout"&&X&&ee.type==="number"&&X.memoizedProps.value!=null&&la(ee,"number",ee.value)}switch(Re=X?oa(X):window,i){case"focusin":(Iy(Re)||Re.contentEditable==="true")&&(uo=Re,Ip=X,Bl=null);break;case"focusout":Bl=Ip=uo=null;break;case"mousedown":zp=!0;break;case"contextmenu":case"mouseup":case"dragend":zp=!1,Ky(de,u,le);break;case"selectionchange":if(YM)break;case"keydown":case"keyup":Ky(de,u,le)}var Ye;if(_p)e:{switch(i){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else co?Dy(i,u)&&(at="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(at="onCompositionStart");at&&(jy&&u.locale!=="ko"&&(co||at!=="onCompositionStart"?at==="onCompositionEnd"&&co&&(Ye=Ny()):(oi=le,Tp="value"in oi?oi.value:oi.textContent,co=!0)),Re=Md(X,at),0<Re.length&&(at=new My(at,i,null,u,le),de.push({event:at,listeners:Re}),Ye?at.data=Ye:(Ye=Ly(u),Ye!==null&&(at.data=Ye)))),(Ye=PM?HM(i,u):FM(i,u))&&(at=Md(X,"onBeforeInput"),0<at.length&&(Re=new My("onBeforeInput","beforeinput",null,u,le),de.push({event:Re,listeners:at}),Re.data=Ye)),_O(de,i,X,u,le)}yw(de,o)})}function cc(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Md(i,o){for(var u=o+"Capture",f=[];i!==null;){var x=i,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=Ol(i,u),x!=null&&f.unshift(cc(i,x,y)),x=Ol(i,o),x!=null&&f.push(cc(i,x,y))),i.tag===3)return f;i=i.return}return[]}function IO(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ww(i,o,u,f,x){for(var y=o._reactName,S=[];u!==null&&u!==f;){var T=u,D=T.alternate,X=T.stateNode;if(T=T.tag,D!==null&&D===f)break;T!==5&&T!==26&&T!==27||X===null||(D=X,x?(X=Ol(u,y),X!=null&&S.unshift(cc(u,X,D))):x||(X=Ol(u,y),X!=null&&S.push(cc(u,X,D)))),u=u.return}S.length!==0&&i.push({event:o,listeners:S})}var zO=/\r\n?/g,BO=/\u0000|\uFFFD/g;function kw(i){return(typeof i=="string"?i:""+i).replace(zO,`
`).replace(BO,"")}function Cw(i,o){return o=kw(o),kw(i)===o}function bt(i,o,u,f,x,y){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||ao(i,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&ao(i,""+f);break;case"className":so(i,"class",f);break;case"tabIndex":so(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":so(i,u,f);break;case"style":Cy(i,f,y);break;case"data":if(o!=="object"){so(i,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=Lu(""+f),i.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(u==="formAction"?(o!=="input"&&bt(i,o,"name",x.name,x,null),bt(i,o,"formEncType",x.formEncType,x,null),bt(i,o,"formMethod",x.formMethod,x,null),bt(i,o,"formTarget",x.formTarget,x,null)):(bt(i,o,"encType",x.encType,x,null),bt(i,o,"method",x.method,x,null),bt(i,o,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=Lu(""+f),i.setAttribute(u,f);break;case"onClick":f!=null&&(i.onclick=xs);break;case"onScroll":f!=null&&tt("scroll",i);break;case"onScrollEnd":f!=null&&tt("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}u=Lu(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""+f):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":f===!0?i.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,f):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(u,f):i.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(u):i.setAttribute(u,f);break;case"popover":tt("beforetoggle",i),tt("toggle",i),Ml(i,"popover",f);break;case"xlinkActuate":Y(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Y(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Y(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Y(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Y(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Y(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Y(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Y(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Y(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Ml(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=fM.get(u)||u,Ml(i,u,f))}}function lg(i,o,u,f,x,y){switch(u){case"style":Cy(i,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof f=="string"?ao(i,f):(typeof f=="number"||typeof f=="bigint")&&ao(i,""+f);break;case"onScroll":f!=null&&tt("scroll",i);break;case"onScrollEnd":f!=null&&tt("scrollend",i);break;case"onClick":f!=null&&(i.onclick=xs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Du.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),y=i[mn]||null,y=y!=null?y[u]:null,typeof y=="function"&&i.removeEventListener(o,y,x),typeof f=="function")){typeof y!="function"&&y!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,f,x);break e}u in i?i[u]=f:f===!0?i.setAttribute(u,""):Ml(i,u,f)}}}function Tn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tt("error",i),tt("load",i);var f=!1,x=!1,y;for(y in u)if(u.hasOwnProperty(y)){var S=u[y];if(S!=null)switch(y){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:bt(i,o,y,S,u,null)}}x&&bt(i,o,"srcSet",u.srcSet,u,null),f&&bt(i,o,"src",u.src,u,null);return;case"input":tt("invalid",i);var T=y=S=x=null,D=null,X=null;for(f in u)if(u.hasOwnProperty(f)){var le=u[f];if(le!=null)switch(f){case"name":x=le;break;case"type":S=le;break;case"checked":D=le;break;case"defaultChecked":X=le;break;case"value":y=le;break;case"defaultValue":T=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(137,o));break;default:bt(i,o,f,le,u,null)}}Qr(i,y,T,D,X,S,x,!1);return;case"select":tt("invalid",i),f=S=y=null;for(x in u)if(u.hasOwnProperty(x)&&(T=u[x],T!=null))switch(x){case"value":y=T;break;case"defaultValue":S=T;break;case"multiple":f=T;default:bt(i,o,x,T,u,null)}o=y,u=S,i.multiple=!!f,o!=null?io(i,!!f,o,!1):u!=null&&io(i,!!f,u,!0);return;case"textarea":tt("invalid",i),y=x=f=null;for(S in u)if(u.hasOwnProperty(S)&&(T=u[S],T!=null))switch(S){case"value":f=T;break;case"defaultValue":x=T;break;case"children":y=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:bt(i,o,S,T,u,null)}wy(i,f,x,y);return;case"option":for(D in u)if(u.hasOwnProperty(D)&&(f=u[D],f!=null))switch(D){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:bt(i,o,D,f,u,null)}return;case"dialog":tt("beforetoggle",i),tt("toggle",i),tt("cancel",i),tt("close",i);break;case"iframe":case"object":tt("load",i);break;case"video":case"audio":for(f=0;f<lc.length;f++)tt(lc[f],i);break;case"image":tt("error",i),tt("load",i);break;case"details":tt("toggle",i);break;case"embed":case"source":case"link":tt("error",i),tt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in u)if(u.hasOwnProperty(X)&&(f=u[X],f!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:bt(i,o,X,f,u,null)}return;default:if(kp(o)){for(le in u)u.hasOwnProperty(le)&&(f=u[le],f!==void 0&&lg(i,o,le,f,u,void 0));return}}for(T in u)u.hasOwnProperty(T)&&(f=u[T],f!=null&&bt(i,o,T,f,u,null))}function PO(i,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,S=null,T=null,D=null,X=null,le=null;for(se in u){var de=u[se];if(u.hasOwnProperty(se)&&de!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":D=de;default:f.hasOwnProperty(se)||bt(i,o,se,null,f,de)}}for(var ee in f){var se=f[ee];if(de=u[ee],f.hasOwnProperty(ee)&&(se!=null||de!=null))switch(ee){case"type":y=se;break;case"name":x=se;break;case"checked":X=se;break;case"defaultChecked":le=se;break;case"value":S=se;break;case"defaultValue":T=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,o));break;default:se!==de&&bt(i,o,ee,se,f,de)}}lr(i,S,T,D,X,le,y,x);return;case"select":se=S=T=ee=null;for(y in u)if(D=u[y],u.hasOwnProperty(y)&&D!=null)switch(y){case"value":break;case"multiple":se=D;default:f.hasOwnProperty(y)||bt(i,o,y,null,f,D)}for(x in f)if(y=f[x],D=u[x],f.hasOwnProperty(x)&&(y!=null||D!=null))switch(x){case"value":ee=y;break;case"defaultValue":T=y;break;case"multiple":S=y;default:y!==D&&bt(i,o,x,y,f,D)}o=T,u=S,f=se,ee!=null?io(i,!!u,ee,!1):!!f!=!!u&&(o!=null?io(i,!!u,o,!0):io(i,!!u,u?[]:"",!1));return;case"textarea":se=ee=null;for(T in u)if(x=u[T],u.hasOwnProperty(T)&&x!=null&&!f.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:bt(i,o,T,null,f,x)}for(S in f)if(x=f[S],y=u[S],f.hasOwnProperty(S)&&(x!=null||y!=null))switch(S){case"value":ee=x;break;case"defaultValue":se=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==y&&bt(i,o,S,x,f,y)}vy(i,ee,se);return;case"option":for(var Oe in u)if(ee=u[Oe],u.hasOwnProperty(Oe)&&ee!=null&&!f.hasOwnProperty(Oe))switch(Oe){case"selected":i.selected=!1;break;default:bt(i,o,Oe,null,f,ee)}for(D in f)if(ee=f[D],se=u[D],f.hasOwnProperty(D)&&ee!==se&&(ee!=null||se!=null))switch(D){case"selected":i.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:bt(i,o,D,ee,f,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var He in u)ee=u[He],u.hasOwnProperty(He)&&ee!=null&&!f.hasOwnProperty(He)&&bt(i,o,He,null,f,ee);for(X in f)if(ee=f[X],se=u[X],f.hasOwnProperty(X)&&ee!==se&&(ee!=null||se!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,o));break;default:bt(i,o,X,ee,f,se)}return;default:if(kp(o)){for(var yt in u)ee=u[yt],u.hasOwnProperty(yt)&&ee!==void 0&&!f.hasOwnProperty(yt)&&lg(i,o,yt,void 0,f,ee);for(le in f)ee=f[le],se=u[le],!f.hasOwnProperty(le)||ee===se||ee===void 0&&se===void 0||lg(i,o,le,ee,f,se);return}}for(var $ in u)ee=u[$],u.hasOwnProperty($)&&ee!=null&&!f.hasOwnProperty($)&&bt(i,o,$,null,f,ee);for(de in f)ee=f[de],se=u[de],!f.hasOwnProperty(de)||ee===se||ee==null&&se==null||bt(i,o,de,ee,f,se)}function Sw(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function HO(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var x=u[f],y=x.transferSize,S=x.initiatorType,T=x.duration;if(y&&T&&Sw(S)){for(S=0,T=x.responseEnd,f+=1;f<u.length;f++){var D=u[f],X=D.startTime;if(X>T)break;var le=D.transferSize,de=D.initiatorType;le&&Sw(de)&&(D=D.responseEnd,S+=le*(D<T?1:(T-X)/(D-X)))}if(--f,o+=8*(y+S)/(x.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var cg=null,ug=null;function Od(i){return i.nodeType===9?i:i.ownerDocument}function Ew(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nw(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function dg(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var fg=null;function FO(){var i=window.event;return i&&i.type==="popstate"?i===fg?!1:(fg=i,!0):(fg=null,!1)}var Tw=typeof setTimeout=="function"?setTimeout:void 0,UO=typeof clearTimeout=="function"?clearTimeout:void 0,Aw=typeof Promise=="function"?Promise:void 0,$O=typeof queueMicrotask=="function"?queueMicrotask:typeof Aw<"u"?function(i){return Aw.resolve(null).then(i).catch(VO)}:Tw;function VO(i){setTimeout(function(){throw i})}function Si(i){return i==="head"}function Mw(i,o){var u=o,f=0;do{var x=u.nextSibling;if(i.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(f===0){i.removeChild(x),Bo(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")uc(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,uc(u);for(var y=u.firstChild;y;){var S=y.nextSibling,T=y.nodeName;y[ri]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||u.removeChild(y),y=S}}else u==="body"&&uc(i.ownerDocument.body);u=x}while(u);Bo(o)}function Ow(i,o){var u=i;i=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=f}while(u)}function hg(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":hg(u),El(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function qO(i,o,u,f){for(;i.nodeType===1;){var x=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[ri])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==x.rel||i.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||i.getAttribute("title")!==(x.title==null?null:x.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(x.src==null?null:x.src)||i.getAttribute("type")!==(x.type==null?null:x.type)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Tr(i.nextSibling),i===null)break}return null}function WO(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Tr(i.nextSibling),i===null))return null;return i}function jw(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Tr(i.nextSibling),i===null))return null;return i}function pg(i){return i.data==="$?"||i.data==="$~"}function mg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function KO(i,o){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function Tr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var gg=null;function _w(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(o===0)return Tr(i.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}i=i.nextSibling}return null}function Rw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return i;o--}else u!=="/$"&&u!=="/&"||o++}i=i.previousSibling}return null}function Dw(i,o,u){switch(o=Od(u),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function uc(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);El(i)}var Ar=new Map,Lw=new Set;function jd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Rs=te.d;te.d={f:GO,r:YO,D:JO,C:XO,L:QO,m:ZO,X:tj,S:ej,M:nj};function GO(){var i=Rs.f(),o=kd();return i||o}function YO(i){var o=ii(i);o!==null&&o.tag===5&&o.type==="form"?Q1(o):Rs.r(i)}var Lo=typeof document>"u"?null:document;function Iw(i,o,u){var f=Lo;if(f&&typeof o=="string"&&o){var x=Bt(o);x='link[rel="'+i+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),Lw.has(x)||(Lw.add(x),i={rel:i,crossOrigin:u,href:o},f.querySelector(x)===null&&(o=f.createElement("link"),Tn(o,"link",i),Qt(o),f.head.appendChild(o)))}}function JO(i){Rs.D(i),Iw("dns-prefetch",i,null)}function XO(i,o){Rs.C(i,o),Iw("preconnect",i,o)}function QO(i,o,u){Rs.L(i,o,u);var f=Lo;if(f&&i&&o){var x='link[rel="preload"][as="'+Bt(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Bt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Bt(u.imageSizes)+'"]')):x+='[href="'+Bt(i)+'"]';var y=x;switch(o){case"style":y=Io(i);break;case"script":y=zo(i)}Ar.has(y)||(i=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Ar.set(y,i),f.querySelector(x)!==null||o==="style"&&f.querySelector(dc(y))||o==="script"&&f.querySelector(fc(y))||(o=f.createElement("link"),Tn(o,"link",i),Qt(o),f.head.appendChild(o)))}}function ZO(i,o){Rs.m(i,o);var u=Lo;if(u&&i){var f=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+Bt(f)+'"][href="'+Bt(i)+'"]',y=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=zo(i)}if(!Ar.has(y)&&(i=g({rel:"modulepreload",href:i},o),Ar.set(y,i),u.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(fc(y)))return}f=u.createElement("link"),Tn(f,"link",i),Qt(f),u.head.appendChild(f)}}}function ej(i,o,u){Rs.S(i,o,u);var f=Lo;if(f&&i){var x=ai(f).hoistableStyles,y=Io(i);o=o||"default";var S=x.get(y);if(!S){var T={loading:0,preload:null};if(S=f.querySelector(dc(y)))T.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Ar.get(y))&&xg(i,u);var D=S=f.createElement("link");Qt(D),Tn(D,"link",i),D._p=new Promise(function(X,le){D.onload=X,D.onerror=le}),D.addEventListener("load",function(){T.loading|=1}),D.addEventListener("error",function(){T.loading|=2}),T.loading|=4,_d(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:T},x.set(y,S)}}}function tj(i,o){Rs.X(i,o);var u=Lo;if(u&&i){var f=ai(u).hoistableScripts,x=zo(i),y=f.get(x);y||(y=u.querySelector(fc(x)),y||(i=g({src:i,async:!0},o),(o=Ar.get(x))&&bg(i,o),y=u.createElement("script"),Qt(y),Tn(y,"link",i),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function nj(i,o){Rs.M(i,o);var u=Lo;if(u&&i){var f=ai(u).hoistableScripts,x=zo(i),y=f.get(x);y||(y=u.querySelector(fc(x)),y||(i=g({src:i,async:!0,type:"module"},o),(o=Ar.get(x))&&bg(i,o),y=u.createElement("script"),Qt(y),Tn(y,"link",i),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function zw(i,o,u,f){var x=(x=L.current)?jd(x):null;if(!x)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Io(u.href),u=ai(x).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Io(u.href);var y=ai(x).hoistableStyles,S=y.get(i);if(S||(x=x.ownerDocument||x,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,S),(y=x.querySelector(dc(i)))&&!y._p&&(S.instance=y,S.state.loading=5),Ar.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ar.set(i,u),y||rj(x,i,u,S.state))),o&&f===null)throw Error(r(528,""));return S}if(o&&f!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=zo(u),u=ai(x).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Io(i){return'href="'+Bt(i)+'"'}function dc(i){return'link[rel="stylesheet"]['+i+"]"}function Bw(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function rj(i,o,u,f){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=i.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),Tn(o,"link",u),Qt(o),i.head.appendChild(o))}function zo(i){return'[src="'+Bt(i)+'"]'}function fc(i){return"script[async]"+i}function Pw(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=i.querySelector('style[data-href~="'+Bt(u.href)+'"]');if(f)return o.instance=f,Qt(f),f;var x=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),Qt(f),Tn(f,"style",x),_d(f,u.precedence,i),o.instance=f;case"stylesheet":x=Io(u.href);var y=i.querySelector(dc(x));if(y)return o.state.loading|=4,o.instance=y,Qt(y),y;f=Bw(u),(x=Ar.get(x))&&xg(f,x),y=(i.ownerDocument||i).createElement("link"),Qt(y);var S=y;return S._p=new Promise(function(T,D){S.onload=T,S.onerror=D}),Tn(y,"link",f),o.state.loading|=4,_d(y,u.precedence,i),o.instance=y;case"script":return y=zo(u.src),(x=i.querySelector(fc(y)))?(o.instance=x,Qt(x),x):(f=u,(x=Ar.get(y))&&(f=g({},u),bg(f,x)),i=i.ownerDocument||i,x=i.createElement("script"),Qt(x),Tn(x,"link",f),i.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,_d(f,u.precedence,i));return o.instance}function _d(i,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,y=x,S=0;S<f.length;S++){var T=f[S];if(T.dataset.precedence===o)y=T;else if(y!==x)break}y?y.parentNode.insertBefore(i,y.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function xg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function bg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Rd=null;function Hw(i,o,u){if(Rd===null){var f=new Map,x=Rd=new Map;x.set(u,f)}else x=Rd,f=x.get(u),f||(f=new Map,x.set(u,f));if(f.has(i))return f;for(f.set(i,null),u=u.getElementsByTagName(i),x=0;x<u.length;x++){var y=u[x];if(!(y[ri]||y[cn]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(o)||"";S=i+S;var T=f.get(S);T?T.push(y):f.set(S,[y])}}return f}function Fw(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function sj(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Uw(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function ij(i,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=Io(f.href),y=o.querySelector(dc(x));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=Dd.bind(i),o.then(i,i)),u.state.loading|=4,u.instance=y,Qt(y);return}y=o.ownerDocument||o,f=Bw(f),(x=Ar.get(x))&&xg(f,x),y=y.createElement("link"),Qt(y);var S=y;S._p=new Promise(function(T,D){S.onload=T,S.onerror=D}),Tn(y,"link",f),u.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=Dd.bind(i),o.addEventListener("load",u),o.addEventListener("error",u))}}var yg=0;function aj(i,o){return i.stylesheets&&i.count===0&&Id(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var f=setTimeout(function(){if(i.stylesheets&&Id(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+o);0<i.imgBytes&&yg===0&&(yg=62500*HO());var x=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Id(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>yg?50:800)+o);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function Dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Id(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ld=null;function Id(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ld=new Map,o.forEach(oj,i),Ld=null,Dd.call(i))}function oj(i,o){if(!(o.state.loading&4)){var u=Ld.get(i);if(u)var f=u.get(null);else{u=new Map,Ld.set(i,u);for(var x=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var S=x[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),f=S)}f&&u.set(null,f)}x=o.instance,S=x.getAttribute("data-precedence"),y=u.get(S)||f,y===f&&u.set(null,x),u.set(S,x),this.count++,f=Dd.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),y?y.parentNode.insertBefore(x,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(x,i.firstChild)),o.state.loading|=4}}var hc={$$typeof:_,Provider:null,Consumer:null,_currentValue:G,_currentValue2:G,_threadCount:0};function lj(i,o,u,f,x,y,S,T,D){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=be(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=be(0),this.hiddenUpdates=be(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function $w(i,o,u,f,x,y,S,T,D,X,le,de){return i=new lj(i,o,u,S,D,X,le,de,T),o=1,y===!0&&(o|=24),y=ur(3,null,null,o),i.current=y,y.stateNode=i,o=Qp(),o.refCount++,i.pooledCache=o,o.refCount++,y.memoizedState={element:f,isDehydrated:u,cache:o},nm(y),i}function Vw(i){return i?(i=po,i):po}function qw(i,o,u,f,x,y){x=Vw(x),f.context===null?f.context=x:f.pendingContext=x,f=hi(o),f.payload={element:u},y=y===void 0?null:y,y!==null&&(f.callback=y),u=pi(i,f,o),u!==null&&(nr(u,i,o),ql(u,i,o))}function Ww(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function vg(i,o){Ww(i,o),(i=i.alternate)&&Ww(i,o)}function Kw(i){if(i.tag===13||i.tag===31){var o=fa(i,67108864);o!==null&&nr(o,i,67108864),vg(i,67108864)}}function Gw(i){if(i.tag===13||i.tag===31){var o=mr();o=ft(o);var u=fa(i,o);u!==null&&nr(u,i,o),vg(i,o)}}var zd=!0;function cj(i,o,u,f){var x=q.T;q.T=null;var y=te.p;try{te.p=2,wg(i,o,u,f)}finally{te.p=y,q.T=x}}function uj(i,o,u,f){var x=q.T;q.T=null;var y=te.p;try{te.p=8,wg(i,o,u,f)}finally{te.p=y,q.T=x}}function wg(i,o,u,f){if(zd){var x=kg(f);if(x===null)og(i,o,f,Bd,u),Jw(i,f);else if(fj(x,i,o,u,f))f.stopPropagation();else if(Jw(i,f),o&4&&-1<dj.indexOf(i)){for(;x!==null;){var y=ii(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=re(y.pendingLanes);if(S!==0){var T=y;for(T.pendingLanes|=2,T.entangledLanes|=2;S;){var D=1<<31-Kt(S);T.entanglements[1]|=D,S&=~D}ns(y),(dt&6)===0&&(vd=Dt()+500,oc(0))}}break;case 31:case 13:T=fa(y,2),T!==null&&nr(T,y,2),kd(),vg(y,2)}if(y=kg(f),y===null&&og(i,o,f,Bd,u),y===x)break;x=y}x!==null&&f.stopPropagation()}else og(i,o,f,null,u)}}function kg(i){return i=Sp(i),Cg(i)}var Bd=null;function Cg(i){if(Bd=null,i=si(i),i!==null){var o=a(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=l(o),i!==null)return i;i=null}else if(u===31){if(i=c(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Bd=i,null}function Yw(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ms()){case Gr:return 2;case Gn:return 8;case hn:case Yn:return 32;case Yr:return 268435456;default:return 32}default:return 32}}var Sg=!1,Ei=null,Ni=null,Ti=null,pc=new Map,mc=new Map,Ai=[],dj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jw(i,o){switch(i){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":pc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(o.pointerId)}}function gc(i,o,u,f,x,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:y,targetContainers:[x]},o!==null&&(o=ii(o),o!==null&&Kw(o)),i):(i.eventSystemFlags|=f,o=i.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),i)}function fj(i,o,u,f,x){switch(o){case"focusin":return Ei=gc(Ei,i,o,u,f,x),!0;case"dragenter":return Ni=gc(Ni,i,o,u,f,x),!0;case"mouseover":return Ti=gc(Ti,i,o,u,f,x),!0;case"pointerover":var y=x.pointerId;return pc.set(y,gc(pc.get(y)||null,i,o,u,f,x)),!0;case"gotpointercapture":return y=x.pointerId,mc.set(y,gc(mc.get(y)||null,i,o,u,f,x)),!0}return!1}function Xw(i){var o=si(i.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){i.blockedOn=o,or(i.priority,function(){Gw(u)});return}}else if(o===31){if(o=c(u),o!==null){i.blockedOn=o,or(i.priority,function(){Gw(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pd(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=kg(i.nativeEvent);if(u===null){u=i.nativeEvent;var f=new u.constructor(u.type,u);Cp=f,u.target.dispatchEvent(f),Cp=null}else return o=ii(u),o!==null&&Kw(o),i.blockedOn=u,!1;o.shift()}return!0}function Qw(i,o,u){Pd(i)&&u.delete(o)}function hj(){Sg=!1,Ei!==null&&Pd(Ei)&&(Ei=null),Ni!==null&&Pd(Ni)&&(Ni=null),Ti!==null&&Pd(Ti)&&(Ti=null),pc.forEach(Qw),mc.forEach(Qw)}function Hd(i,o){i.blockedOn===o&&(i.blockedOn=null,Sg||(Sg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,hj)))}var Fd=null;function Zw(i){Fd!==i&&(Fd=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Fd===i&&(Fd=null);for(var o=0;o<i.length;o+=3){var u=i[o],f=i[o+1],x=i[o+2];if(typeof f!="function"){if(Cg(f||u)===null)continue;break}var y=ii(u);y!==null&&(i.splice(o,3),o-=3,km(y,{pending:!0,data:x,method:u.method,action:f},f,x))}}))}function Bo(i){function o(D){return Hd(D,i)}Ei!==null&&Hd(Ei,i),Ni!==null&&Hd(Ni,i),Ti!==null&&Hd(Ti,i),pc.forEach(o),mc.forEach(o);for(var u=0;u<Ai.length;u++){var f=Ai[u];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Ai.length&&(u=Ai[0],u.blockedOn===null);)Xw(u),u.blockedOn===null&&Ai.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var x=u[f],y=u[f+1],S=x[mn]||null;if(typeof y=="function")S||Zw(u);else if(S){var T=null;if(y&&y.hasAttribute("formAction")){if(x=y,S=y[mn]||null)T=S.formAction;else if(Cg(x)!==null)continue}else T=S.action;typeof T=="function"?u[f+1]=T:(u.splice(f,3),f-=3),Zw(u)}}}function e2(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return x=S})},focusReset:"manual",scroll:"manual"})}function o(){x!==null&&(x(),x=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),x!==null&&(x(),x=null)}}}function Eg(i){this._internalRoot=i}Ud.prototype.render=Eg.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,f=mr();qw(u,f,i,o,null,null)},Ud.prototype.unmount=Eg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;qw(i.current,2,null,i,null,null),kd(),o[ni]=null}};function Ud(i){this._internalRoot=i}Ud.prototype.unstable_scheduleHydration=function(i){if(i){var o=Cn();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ai.length&&o!==0&&o<Ai[u].priority;u++);Ai.splice(u,0,i),u===0&&Xw(i)}};var t2=e.version;if(t2!=="19.2.0")throw Error(r(527,t2,"19.2.0"));te.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(o),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var pj={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$d.isDisabled&&$d.supportsFiber)try{pn=$d.inject(pj),Ht=$d}catch{}}return bc.createRoot=function(i,o){if(!s(i))throw Error(r(299));var u=!1,f="",x=lv,y=cv,S=uv;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=$w(i,1,!1,null,null,u,f,null,x,y,S,e2),i[ni]=o.current,ag(i),new Eg(o)},bc.hydrateRoot=function(i,o,u){if(!s(i))throw Error(r(299));var f=!1,x="",y=lv,S=cv,T=uv,D=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(T=u.onRecoverableError),u.formState!==void 0&&(D=u.formState)),o=$w(i,1,!0,o,u??null,f,x,D,y,S,T,e2),o.context=Vw(null),u=o.current,f=mr(),f=ft(f),x=hi(f),x.callback=null,pi(u,x,f),u=f,o.current.lanes=u,Ve(o,u),ns(o),i[ni]=o.current,ag(i),new Ud(o)},bc.version="19.2.0",bc}var d2;function Cj(){if(d2)return Ag.exports;d2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ag.exports=kj(),Ag.exports}var Sj=Cj();const Ej=Jx(Sj);/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var f2="popstate";function Nj(t={}){function e(s,a){let{pathname:l="/",search:c="",hash:d=""}=gl(s.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),Y0("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){let l=s.document.querySelector("base"),c="";if(l&&l.getAttribute("href")){let d=s.location.href,p=d.indexOf("#");c=p===-1?d:d.slice(0,p)}return c+"#"+(typeof a=="string"?a:Kc(a))}function r(s,a){Ir(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return Aj(e,n,r,t)}function fn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ir(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Tj(){return Math.random().toString(36).substring(2,10)}function h2(t,e){return{usr:t.state,key:t.key,idx:e}}function Y0(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?gl(e):e,state:n,key:e&&e.key||r||Tj()}}function Kc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function gl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Aj(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,c="POP",d=null,p=m();p==null&&(p=0,l.replaceState({...l.state,idx:p},""));function m(){return(l.state||{idx:null}).idx}function g(){c="POP";let k=m(),N=k==null?null:k-p;p=k,d&&d({action:c,location:C.location,delta:N})}function b(k,N){c="PUSH";let M=Y0(C.location,k,N);n&&n(M,k),p=m()+1;let _=h2(M,p),P=C.createHref(M);try{l.pushState(_,"",P)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;s.location.assign(P)}a&&d&&d({action:c,location:C.location,delta:1})}function v(k,N){c="REPLACE";let M=Y0(C.location,k,N);n&&n(M,k),p=m();let _=h2(M,p),P=C.createHref(M);l.replaceState(_,"",P),a&&d&&d({action:c,location:C.location,delta:0})}function w(k){return Mj(k)}let C={get action(){return c},get location(){return t(s,l)},listen(k){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(f2,g),d=k,()=>{s.removeEventListener(f2,g),d=null}},createHref(k){return e(s,k)},createURL:w,encodeLocation(k){let N=w(k);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:b,replace:v,go(k){return l.go(k)}};return C}function Mj(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),fn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Kc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function WS(t,e,n="/"){return Oj(t,e,n,!1)}function Oj(t,e,n,r){let s=typeof e=="string"?gl(e):e,a=Js(s.pathname||"/",n);if(a==null)return null;let l=KS(t);jj(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let p=Uj(a);c=Hj(l[d],p,r)}return c}function KS(t,e=[],n=[],r="",s=!1){let a=(l,c,d=s,p)=>{let m={relativePath:p===void 0?l.path||"":p,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(r)&&d)return;fn(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length)}let g=Ws([r,m.relativePath]),b=n.concat(m);l.children&&l.children.length>0&&(fn(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),KS(l.children,e,b,g,d)),!(l.path==null&&!l.index)&&e.push({path:g,score:Bj(g,l.index),routesMeta:b})};return t.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))a(l,c);else for(let p of GS(l.path))a(l,c,!0,p)}),e}function GS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=GS(r.join("/")),c=[];return c.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function jj(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Pj(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var _j=/^:[\w-]+$/,Rj=3,Dj=2,Lj=1,Ij=10,zj=-2,p2=t=>t==="*";function Bj(t,e){let n=t.split("/"),r=n.length;return n.some(p2)&&(r+=zj),e&&(r+=Dj),n.filter(s=>!p2(s)).reduce((s,a)=>s+(_j.test(a)?Rj:a===""?Lj:Ij),r)}function Pj(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function Hj(t,e,n=!1){let{routesMeta:r}=t,s={},a="/",l=[];for(let c=0;c<r.length;++c){let d=r[c],p=c===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=Tf({path:d.relativePath,caseSensitive:d.caseSensitive,end:p},m),b=d.route;if(!g&&p&&n&&!r[r.length-1].route.index&&(g=Tf({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!g)return null;Object.assign(s,g.params),l.push({params:s,pathname:Ws([a,g.pathname]),pathnameBase:Kj(Ws([a,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(a=Ws([a,g.pathnameBase]))}return l}function Tf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Fj(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((p,{paramName:m,isOptional:g},b)=>{if(m==="*"){let w=c[b]||"";l=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const v=c[b];return g&&!v?p[m]=void 0:p[m]=(v||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:l,pattern:t}}function Fj(t,e=!1,n=!0){Ir(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Uj(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ir(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Js(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var $j=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vj=t=>$j.test(t);function qj(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?gl(t):t,a;if(n)if(Vj(n))a=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),Ir(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${n}`)}n.startsWith("/")?a=m2(n.substring(1),"/"):a=m2(n,e)}else a=e;return{pathname:a,search:Gj(r),hash:Yj(s)}}function m2(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function _g(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Wj(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function YS(t){let e=Wj(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function JS(t,e,n,r=!1){let s;typeof t=="string"?s=gl(t):(s={...t},fn(!s.pathname||!s.pathname.includes("?"),_g("?","pathname","search",s)),fn(!s.pathname||!s.pathname.includes("#"),_g("#","pathname","hash",s)),fn(!s.search||!s.search.includes("#"),_g("#","search","hash",s)));let a=t===""||s.pathname==="",l=a?"/":s.pathname,c;if(l==null)c=n;else{let g=e.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;s.pathname=b.join("/")}c=g>=0?e[g]:"/"}let d=qj(s,c),p=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(p||m)&&(d.pathname+="/"),d}var Ws=t=>t.join("/").replace(/\/\/+/g,"/"),Kj=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Gj=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Yj=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Jj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var XS=["POST","PUT","PATCH","DELETE"];new Set(XS);var Xj=["GET",...XS];new Set(Xj);var xl=E.createContext(null);xl.displayName="DataRouter";var Ph=E.createContext(null);Ph.displayName="DataRouterState";E.createContext(!1);var QS=E.createContext({isTransitioning:!1});QS.displayName="ViewTransition";var Qj=E.createContext(new Map);Qj.displayName="Fetchers";var Zj=E.createContext(null);Zj.displayName="Await";var hs=E.createContext(null);hs.displayName="Navigation";var Hh=E.createContext(null);Hh.displayName="Location";var ei=E.createContext({outlet:null,matches:[],isDataRoute:!1});ei.displayName="Route";var Xx=E.createContext(null);Xx.displayName="RouteError";function e_(t,{relative:e}={}){fn(mu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=E.useContext(hs),{hash:s,pathname:a,search:l}=gu(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:Ws([n,a])),r.createHref({pathname:c,search:l,hash:s})}function mu(){return E.useContext(Hh)!=null}function to(){return fn(mu(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Hh).location}var ZS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eE(t){E.useContext(hs).static||E.useLayoutEffect(t)}function t_(){let{isDataRoute:t}=E.useContext(ei);return t?p_():n_()}function n_(){fn(mu(),"useNavigate() may be used only in the context of a <Router> component.");let t=E.useContext(xl),{basename:e,navigator:n}=E.useContext(hs),{matches:r}=E.useContext(ei),{pathname:s}=to(),a=JSON.stringify(YS(r)),l=E.useRef(!1);return eE(()=>{l.current=!0}),E.useCallback((d,p={})=>{if(Ir(l.current,ZS),!l.current)return;if(typeof d=="number"){n.go(d);return}let m=JS(d,JSON.parse(a),s,p.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ws([e,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[e,n,a,s,t])}E.createContext(null);function gu(t,{relative:e}={}){let{matches:n}=E.useContext(ei),{pathname:r}=to(),s=JSON.stringify(YS(n));return E.useMemo(()=>JS(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function r_(t,e,n,r,s){fn(mu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=E.useContext(hs),{matches:l}=E.useContext(ei),c=l[l.length-1],d=c?c.params:{},p=c?c.pathname:"/",m=c?c.pathnameBase:"/",g=c&&c.route;{let M=g&&g.path||"";tE(p,!g||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let b=to(),v;v=b;let w=v.pathname||"/",C=w;if(m!=="/"){let M=m.replace(/^\//,"").split("/");C="/"+w.replace(/^\//,"").split("/").slice(M.length).join("/")}let k=WS(t,{pathname:C});return Ir(g||k!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ir(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),l_(k&&k.map(M=>Object.assign({},M,{params:Object.assign({},d,M.params),pathname:Ws([m,a.encodeLocation?a.encodeLocation(M.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?m:Ws([m,a.encodeLocation?a.encodeLocation(M.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathnameBase])})),l,n,r,s)}function s_(){let t=h_(),e=Jj(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:a},"ErrorBoundary")," or"," ",E.createElement("code",{style:a},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),n?E.createElement("pre",{style:s},n):null,l)}var i_=E.createElement(s_,null),a_=class extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?E.createElement(ei.Provider,{value:this.props.routeContext},E.createElement(Xx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function o_({routeContext:t,match:e,children:n}){let r=E.useContext(xl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(ei.Provider,{value:t},n)}function l_(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,l=n==null?void 0:n.errors;if(l!=null){let m=a.findIndex(g=>g.route.id&&(l==null?void 0:l[g.route.id])!==void 0);fn(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,m+1))}let c=!1,d=-1;if(n)for(let m=0;m<a.length;m++){let g=a[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=m),g.route.id){let{loaderData:b,errors:v}=n,w=g.route.loader&&!b.hasOwnProperty(g.route.id)&&(!v||v[g.route.id]===void 0);if(g.route.lazy||w){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}let p=n&&r?(m,g)=>{var b,v;r(m,{location:n.location,params:((v=(b=n.matches)==null?void 0:b[0])==null?void 0:v.params)??{},errorInfo:g})}:void 0;return a.reduceRight((m,g,b)=>{let v,w=!1,C=null,k=null;n&&(v=l&&g.route.id?l[g.route.id]:void 0,C=g.route.errorElement||i_,c&&(d<0&&b===0?(tE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,k=null):d===b&&(w=!0,k=g.route.hydrateFallbackElement||null)));let N=e.concat(a.slice(0,b+1)),M=()=>{let _;return v?_=C:w?_=k:g.route.Component?_=E.createElement(g.route.Component,null):g.route.element?_=g.route.element:_=m,E.createElement(o_,{match:g,routeContext:{outlet:m,matches:N,isDataRoute:n!=null},children:_})};return n&&(g.route.ErrorBoundary||g.route.errorElement||b===0)?E.createElement(a_,{location:n.location,revalidation:n.revalidation,component:C,error:v,children:M(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:p}):M()},null)}function Qx(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function c_(t){let e=E.useContext(xl);return fn(e,Qx(t)),e}function u_(t){let e=E.useContext(Ph);return fn(e,Qx(t)),e}function d_(t){let e=E.useContext(ei);return fn(e,Qx(t)),e}function Zx(t){let e=d_(t),n=e.matches[e.matches.length-1];return fn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function f_(){return Zx("useRouteId")}function h_(){var r;let t=E.useContext(Xx),e=u_("useRouteError"),n=Zx("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function p_(){let{router:t}=c_("useNavigate"),e=Zx("useNavigate"),n=E.useRef(!1);return eE(()=>{n.current=!0}),E.useCallback(async(s,a={})=>{Ir(n.current,ZS),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var g2={};function tE(t,e,n){!e&&!g2[t]&&(g2[t]=!0,Ir(!1,n))}E.memo(m_);function m_({routes:t,future:e,state:n,unstable_onError:r}){return r_(t,void 0,n,r,e)}function g_({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:a=!1}){fn(!mu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=E.useMemo(()=>({basename:l,navigator:s,static:a,future:{}}),[l,s,a]);typeof n=="string"&&(n=gl(n));let{pathname:d="/",search:p="",hash:m="",state:g=null,key:b="default"}=n,v=E.useMemo(()=>{let w=Js(d,l);return w==null?null:{location:{pathname:w,search:p,hash:m,state:g,key:b},navigationType:r}},[l,d,p,m,g,b,r]);return Ir(v!=null,`<Router basename="${l}"> is not able to match the URL "${d}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:E.createElement(hs.Provider,{value:c},E.createElement(Hh.Provider,{children:e,value:v}))}var df="get",ff="application/x-www-form-urlencoded";function Fh(t){return t!=null&&typeof t.tagName=="string"}function x_(t){return Fh(t)&&t.tagName.toLowerCase()==="button"}function b_(t){return Fh(t)&&t.tagName.toLowerCase()==="form"}function y_(t){return Fh(t)&&t.tagName.toLowerCase()==="input"}function v_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function w_(t,e){return t.button===0&&(!e||e==="_self")&&!v_(t)}var Vd=null;function k_(){if(Vd===null)try{new FormData(document.createElement("form"),0),Vd=!1}catch{Vd=!0}return Vd}var C_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Rg(t){return t!=null&&!C_.has(t)?(Ir(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ff}"`),null):t}function S_(t,e){let n,r,s,a,l;if(b_(t)){let c=t.getAttribute("action");r=c?Js(c,e):null,n=t.getAttribute("method")||df,s=Rg(t.getAttribute("enctype"))||ff,a=new FormData(t)}else if(x_(t)||y_(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||c.getAttribute("action");if(r=d?Js(d,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||df,s=Rg(t.getAttribute("formenctype"))||Rg(c.getAttribute("enctype"))||ff,a=new FormData(c,t),!k_()){let{name:p,type:m,value:g}=t;if(m==="image"){let b=p?`${p}.`:"";a.append(`${b}x`,"0"),a.append(`${b}y`,"0")}else p&&a.append(p,g)}}else{if(Fh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=df,r=null,s=ff,l=t}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function eb(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function E_(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Js(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function N_(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function T_(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function A_(t,e,n){let r=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await N_(a,n);return l.links?l.links():[]}return[]}));return __(r.flat(1).filter(T_).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function x2(t,e,n,r,s,a){let l=(d,p)=>n[p]?d.route.id!==n[p].route.id:!0,c=(d,p)=>{var m;return n[p].pathname!==d.pathname||((m=n[p].route.path)==null?void 0:m.endsWith("*"))&&n[p].params["*"]!==d.params["*"]};return a==="assets"?e.filter((d,p)=>l(d,p)||c(d,p)):a==="data"?e.filter((d,p)=>{var g;let m=r.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,p)||c(d,p))return!0;if(d.route.shouldRevalidate){let b=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((g=n[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function M_(t,e,{includeHydrateFallback:n}={}){return O_(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function O_(t){return[...new Set(t)]}function j_(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function __(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let a=JSON.stringify(j_(s));return n.has(a)||(n.add(a),r.push({key:a,link:s})),r},[])}function nE(){let t=E.useContext(xl);return eb(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function R_(){let t=E.useContext(Ph);return eb(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var tb=E.createContext(void 0);tb.displayName="FrameworkContext";function rE(){let t=E.useContext(tb);return eb(t,"You must render this element inside a <HydratedRouter> element"),t}function D_(t,e){let n=E.useContext(tb),[r,s]=E.useState(!1),[a,l]=E.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:p,onMouseLeave:m,onTouchStart:g}=e,b=E.useRef(null);E.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let C=N=>{N.forEach(M=>{l(M.isIntersecting)})},k=new IntersectionObserver(C,{threshold:.5});return b.current&&k.observe(b.current),()=>{k.disconnect()}}},[t]),E.useEffect(()=>{if(r){let C=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(C)}}},[r]);let v=()=>{s(!0)},w=()=>{s(!1),l(!1)};return n?t!=="intent"?[a,b,{}]:[a,b,{onFocus:yc(c,v),onBlur:yc(d,w),onMouseEnter:yc(p,v),onMouseLeave:yc(m,w),onTouchStart:yc(g,v)}]:[!1,b,{}]}function yc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function L_({page:t,...e}){let{router:n}=nE(),r=E.useMemo(()=>WS(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?E.createElement(z_,{page:t,matches:r,...e}):null}function I_(t){let{manifest:e,routeModules:n}=rE(),[r,s]=E.useState([]);return E.useEffect(()=>{let a=!1;return A_(t,e,n).then(l=>{a||s(l)}),()=>{a=!0}},[t,e,n]),r}function z_({page:t,matches:e,...n}){let r=to(),{manifest:s,routeModules:a}=rE(),{basename:l}=nE(),{loaderData:c,matches:d}=R_(),p=E.useMemo(()=>x2(t,e,d,s,r,"data"),[t,e,d,s,r]),m=E.useMemo(()=>x2(t,e,d,s,r,"assets"),[t,e,d,s,r]),g=E.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let w=new Set,C=!1;if(e.forEach(N=>{var _;let M=s.routes[N.route.id];!M||!M.hasLoader||(!p.some(P=>P.route.id===N.route.id)&&N.route.id in c&&((_=a[N.route.id])!=null&&_.shouldRevalidate)||M.hasClientLoader?C=!0:w.add(N.route.id))}),w.size===0)return[];let k=E_(t,l,"data");return C&&w.size>0&&k.searchParams.set("_routes",e.filter(N=>w.has(N.route.id)).map(N=>N.route.id).join(",")),[k.pathname+k.search]},[l,c,r,s,p,e,t,a]),b=E.useMemo(()=>M_(m,s),[m,s]),v=I_(m);return E.createElement(E.Fragment,null,g.map(w=>E.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),b.map(w=>E.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),v.map(({key:w,link:C})=>E.createElement("link",{key:w,nonce:n.nonce,...C})))}function B_(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var sE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sE&&(window.__reactRouterVersion="7.9.6")}catch{}function P_({basename:t,children:e,window:n}){let r=E.useRef();r.current==null&&(r.current=Nj({window:n,v5Compat:!0}));let s=r.current,[a,l]=E.useState({action:s.action,location:s.location}),c=E.useCallback(d=>{E.startTransition(()=>l(d))},[l]);return E.useLayoutEffect(()=>s.listen(c),[s,c]),E.createElement(g_,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s})}var iE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aE=E.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:c,target:d,to:p,preventScrollReset:m,viewTransition:g,...b},v){let{basename:w}=E.useContext(hs),C=typeof p=="string"&&iE.test(p),k,N=!1;if(typeof p=="string"&&C&&(k=p,sE))try{let V=new URL(window.location.href),Z=p.startsWith("//")?new URL(V.protocol+p):new URL(p),he=Js(Z.pathname,w);Z.origin===V.origin&&he!=null?p=he+Z.search+Z.hash:N=!0}catch{Ir(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=e_(p,{relative:s}),[_,P,z]=D_(r,b),K=$_(p,{replace:l,state:c,target:d,preventScrollReset:m,relative:s,viewTransition:g});function O(V){e&&e(V),V.defaultPrevented||K(V)}let F=E.createElement("a",{...b,...z,href:k||M,onClick:N||a?e:O,ref:B_(v,P),target:d,"data-discover":!C&&n==="render"?"true":void 0});return _&&!C?E.createElement(E.Fragment,null,F,E.createElement(L_,{page:M})):F});aE.displayName="Link";var H_=E.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:c,children:d,...p},m){let g=gu(l,{relative:p.relative}),b=to(),v=E.useContext(Ph),{navigator:w,basename:C}=E.useContext(hs),k=v!=null&&G_(g)&&c===!0,N=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,M=b.pathname,_=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(M=M.toLowerCase(),_=_?_.toLowerCase():null,N=N.toLowerCase()),_&&C&&(_=Js(_,C)||_);const P=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let z=M===N||!s&&M.startsWith(N)&&M.charAt(P)==="/",K=_!=null&&(_===N||!s&&_.startsWith(N)&&_.charAt(N.length)==="/"),O={isActive:z,isPending:K,isTransitioning:k},F=z?e:void 0,V;typeof r=="function"?V=r(O):V=[r,z?"active":null,K?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let Z=typeof a=="function"?a(O):a;return E.createElement(aE,{...p,"aria-current":F,className:V,ref:m,style:Z,to:l,viewTransition:c},typeof d=="function"?d(O):d)});H_.displayName="NavLink";var F_=E.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:a,method:l=df,action:c,onSubmit:d,relative:p,preventScrollReset:m,viewTransition:g,...b},v)=>{let w=W_(),C=K_(c,{relative:p}),k=l.toLowerCase()==="get"?"get":"post",N=typeof c=="string"&&iE.test(c),M=_=>{if(d&&d(_),_.defaultPrevented)return;_.preventDefault();let P=_.nativeEvent.submitter,z=(P==null?void 0:P.getAttribute("formmethod"))||l;w(P||_.currentTarget,{fetcherKey:e,method:z,navigate:n,replace:s,state:a,relative:p,preventScrollReset:m,viewTransition:g})};return E.createElement("form",{ref:v,method:k,action:C,onSubmit:r?d:M,...b,"data-discover":!N&&t==="render"?"true":void 0})});F_.displayName="Form";function U_(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oE(t){let e=E.useContext(xl);return fn(e,U_(t)),e}function $_(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:a,viewTransition:l}={}){let c=t_(),d=to(),p=gu(t,{relative:a});return E.useCallback(m=>{if(w_(m,e)){m.preventDefault();let g=n!==void 0?n:Kc(d)===Kc(p);c(t,{replace:g,state:r,preventScrollReset:s,relative:a,viewTransition:l})}},[d,c,p,n,r,e,t,s,a,l])}var V_=0,q_=()=>`__${String(++V_)}__`;function W_(){let{router:t}=oE("useSubmit"),{basename:e}=E.useContext(hs),n=f_();return E.useCallback(async(r,s={})=>{let{action:a,method:l,encType:c,formData:d,body:p}=S_(r,e);if(s.navigate===!1){let m=s.fetcherKey||q_();await t.fetch(m,n,s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:p,formMethod:s.method||l,formEncType:s.encType||c,flushSync:s.flushSync})}else await t.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:p,formMethod:s.method||l,formEncType:s.encType||c,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function K_(t,{relative:e}={}){let{basename:n}=E.useContext(hs),r=E.useContext(ei);fn(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...gu(t||".",{relative:e})},l=to();if(t==null){a.search=l.search;let c=new URLSearchParams(a.search),d=c.getAll("index");if(d.some(m=>m==="")){c.delete("index"),d.filter(g=>g).forEach(g=>c.append("index",g));let m=c.toString();a.search=m?`?${m}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Ws([n,a.pathname])),Kc(a)}function G_(t,{relative:e}={}){let n=E.useContext(QS);fn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=oE("useViewTransitionState"),s=gu(t,{relative:e});if(!n.isTransitioning)return!1;let a=Js(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Js(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Tf(s.pathname,l)!=null||Tf(s.pathname,a)!=null}var Wo=qS();const Y_=Jx(Wo),J_="modulepreload",X_=function(t){return"/"+t},b2={},Gc=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(p){return Promise.all(p.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=l(n.map(p=>{if(p=X_(p),p in b2)return;b2[p]=!0;const m=p.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${g}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":J_,m||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),m)return new Promise((v,w)=>{b.addEventListener("load",v),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Z_=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),y2=t=>{const e=Z_(t);return e.charAt(0).toUpperCase()+e.slice(1)},lE=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),e4=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var t4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=E.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:l,...c},d)=>E.createElement("svg",{ref:d,...t4,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:lE("lucide",s),...!a&&!e4(c)&&{"aria-hidden":"true"},...c},[...l.map(([p,m])=>E.createElement(p,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=(t,e)=>{const n=E.forwardRef(({className:r,...s},a)=>E.createElement(n4,{ref:a,iconNode:e,className:lE(`lucide-${Q_(y2(t))}`,`lucide-${t}`,r),...s}));return n.displayName=y2(t),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cE=ye("arrow-left",r4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],i4=ye("arrow-up-down",s4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],o4=ye("bold",a4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ba=ye("book-open",l4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],nb=ye("book",c4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],v2=ye("bot",u4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],f4=ye("brain",d4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],nl=ye("calendar",h4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],J0=ye("camera",p4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],rb=ye("check",m4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_a=ye("chevron-down",g4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Fs=ye("chevron-left",x4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],uE=ye("chevron-right",b4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dE=ye("chevron-up",y4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rl=ye("circle-alert",v4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Yc=ye("circle-check-big",w4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],C4=ye("circle-question-mark",k4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],E4=ye("clock-3",S4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],T4=ye("clock",N4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],M4=ye("columns-3",A4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fE=ye("compass",O4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],_4=ye("database",j4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],D4=ye("download",R4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],I4=ye("eraser",L4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Uh=ye("external-link",z4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],w2=ye("eye",B4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],hE=ye("file-braces",P4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],F4=ye("file-search",H4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xu=ye("file-text",U4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],V4=ye("folder-plus",$4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],k2=ye("folder",q4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],K4=ye("funnel",W4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Y4=ye("gauge",G4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],$h=ye("globe",J4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],C2=ye("grip-vertical",X4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Af=ye("hash",Q4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],e3=ye("heading-1",Z4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],n3=ye("heading-2",t3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],S2=ye("image",r3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],i3=ye("info",s3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],o3=ye("italic",a3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],c3=ye("layers",l3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],pE=ye("layout-panel-left",u3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],mE=ye("library",d3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],E2=ye("link",f3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],N2=ye("list-filter",h3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],m3=ye("list-ordered",p3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],x3=ye("list",g3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Jt=ye("loader-circle",b3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],v3=ye("log-out",y3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],k3=ye("map-pin",w3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],S3=ye("menu",C3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],X0=ye("message-circle",E3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],T3=ye("moon",N3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],M3=ye("palette",A3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],Mf=ye("pen-tool",O3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Of=ye("pen",j3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],T2=ye("pencil-line",_3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],D3=ye("pencil",R3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],gE=ye("play",L3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Q0=ye("plus",I3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],Jc=ye("quote",z3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],xE=ye("rotate-ccw",B3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],H3=ye("rows-3",P3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],U3=ye("save",F3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],V3=ye("scan-line",$3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Us=ye("search",q3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],K3=ye("send",W3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Dg=ye("settings-2",G3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],J3=ye("skip-forward",Y3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Q3=ye("sliders-horizontal",X3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ks=ye("sparkles",Z3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],tR=ye("square-check-big",eR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],rR=ye("square",nR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Po=ye("star",sR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],sl=ye("sticky-note",iR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],oR=ye("sun",aR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],cR=ye("table-2",lR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],dR=ye("thumbs-down",uR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],hR=ye("thumbs-up",fR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Pa=ye("trash-2",pR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],$i=ye("triangle-alert",mR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],xR=ye("type",gR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],yR=ye("underline",bR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],jf=ye("upload",vR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],sb=ye("user",wR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],CR=ye("wand-sparkles",kR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],cs=ye("x",SR),Vh=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bl(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function ib(t){return"nodeType"in t}function Wn(t){var e,n;return t?bl(t)?t:ib(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function ab(t){const{Document:e}=Wn(t);return t instanceof e}function bu(t){return bl(t)?!1:t instanceof Wn(t).HTMLElement}function bE(t){return t instanceof Wn(t).SVGElement}function yl(t){return t?bl(t)?t.document:ib(t)?ab(t)?t:bu(t)||bE(t)?t.ownerDocument:document:document:document}const Xs=Vh?E.useLayoutEffect:E.useEffect;function qh(t){const e=E.useRef(t);return Xs(()=>{e.current=t}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function ER(){const t=E.useRef(null),e=E.useCallback((r,s)=>{t.current=setInterval(r,s)},[]),n=E.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Xc(t,e){e===void 0&&(e=[t]);const n=E.useRef(t);return Xs(()=>{n.current!==t&&(n.current=t)},e),n}function yu(t,e){const n=E.useRef();return E.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function _f(t){const e=qh(t),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(e==null||e(s,n.current)),n.current=s},[]);return[n,r]}function Rf(t){const e=E.useRef();return E.useEffect(()=>{e.current=t},[t]),e.current}let Lg={};function Wh(t,e){return E.useMemo(()=>{if(e)return e;const n=Lg[t]==null?0:Lg[t]+1;return Lg[t]=n,t+"-"+n},[t,e])}function yE(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((a,l)=>{const c=Object.entries(l);for(const[d,p]of c){const m=a[d];m!=null&&(a[d]=m+t*p)}return a},{...e})}}const Yo=yE(1),Df=yE(-1);function NR(t){return"clientX"in t&&"clientY"in t}function ob(t){if(!t)return!1;const{KeyboardEvent:e}=Wn(t.target);return e&&t instanceof e}function TR(t){if(!t)return!1;const{TouchEvent:e}=Wn(t.target);return e&&t instanceof e}function Lf(t){if(TR(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return NR(t)?{x:t.clientX,y:t.clientY}:null}const il=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[il.Translate.toString(t),il.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),A2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function AR(t){return t.matches(A2)?t:t.querySelector(A2)}const MR={display:"none"};function OR(t){let{id:e,value:n}=t;return We.createElement("div",{id:e,style:MR},n)}function jR(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return We.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function _R(){const[t,e]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const vE=E.createContext(null);function RR(t){const e=E.useContext(vE);E.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function DR(){const[t]=E.useState(()=>new Set),e=E.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[E.useCallback(r=>{let{type:s,event:a}=r;t.forEach(l=>{var c;return(c=l[s])==null?void 0:c.call(l,a)})},[t]),e]}const LR={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},IR={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function zR(t){let{announcements:e=IR,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=LR}=t;const{announce:a,announcement:l}=_R(),c=Wh("DndLiveRegion"),[d,p]=E.useState(!1);if(E.useEffect(()=>{p(!0)},[]),RR(E.useMemo(()=>({onDragStart(g){let{active:b}=g;a(e.onDragStart({active:b}))},onDragMove(g){let{active:b,over:v}=g;e.onDragMove&&a(e.onDragMove({active:b,over:v}))},onDragOver(g){let{active:b,over:v}=g;a(e.onDragOver({active:b,over:v}))},onDragEnd(g){let{active:b,over:v}=g;a(e.onDragEnd({active:b,over:v}))},onDragCancel(g){let{active:b,over:v}=g;a(e.onDragCancel({active:b,over:v}))}}),[a,e])),!d)return null;const m=We.createElement(We.Fragment,null,We.createElement(OR,{id:r,value:s.draggable}),We.createElement(jR,{id:c,announcement:l}));return n?Wo.createPortal(m,n):m}var dn;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(dn||(dn={}));function If(){}function M2(t,e){return E.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function BR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return E.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const qr=Object.freeze({x:0,y:0});function PR(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function HR(t,e){const n=Lf(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function FR(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function UR(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function $R(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function O2(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const VR=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=O2(e,e.left,e.top),a=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const p=PR(O2(d),s);a.push({id:c,data:{droppableContainer:l,value:p}})}}return a.sort(FR)};function qR(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),l=s-r,c=a-n;if(r<s&&n<a){const d=e.width*e.height,p=t.width*t.height,m=l*c,g=m/(d+p-m);return Number(g.toFixed(4))}return 0}const WR=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=qR(c,e);d>0&&s.push({id:l,data:{droppableContainer:a,value:d}})}}return s.sort(UR)};function KR(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function wE(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:qr}function GR(t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((l,c)=>({...l,top:l.top+t*c.y,bottom:l.bottom+t*c.y,left:l.left+t*c.x,right:l.right+t*c.x}),{...n})}}const YR=GR(1);function kE(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function JR(t,e,n){const r=kE(e);if(!r)return t;const{scaleX:s,scaleY:a,x:l,y:c}=r,d=t.left-l-(1-s)*parseFloat(n),p=t.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=s?t.width/s:t.width,g=a?t.height/a:t.height;return{width:m,height:g,top:p,right:d+m,bottom:p+g,left:d}}const XR={ignoreTransform:!1};function vu(t,e){e===void 0&&(e=XR);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:p,transformOrigin:m}=Wn(t).getComputedStyle(t);p&&(n=JR(n,p,m))}const{top:r,left:s,width:a,height:l,bottom:c,right:d}=n;return{top:r,left:s,width:a,height:l,bottom:c,right:d}}function j2(t){return vu(t,{ignoreTransform:!0})}function QR(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function ZR(t,e){return e===void 0&&(e=Wn(t).getComputedStyle(t)),e.position==="fixed"}function eD(t,e){e===void 0&&(e=Wn(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=e[s];return typeof a=="string"?n.test(a):!1})}function lb(t,e){const n=[];function r(s){if(e!=null&&n.length>=e||!s)return n;if(ab(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!bu(s)||bE(s)||n.includes(s))return n;const a=Wn(t).getComputedStyle(s);return s!==t&&eD(s,a)&&n.push(s),ZR(s,a)?n:r(s.parentNode)}return t?r(t):n}function CE(t){const[e]=lb(t,1);return e??null}function Ig(t){return!Vh||!t?null:bl(t)?t:ib(t)?ab(t)||t===yl(t).scrollingElement?window:bu(t)?t:null:null}function SE(t){return bl(t)?t.scrollX:t.scrollLeft}function EE(t){return bl(t)?t.scrollY:t.scrollTop}function Z0(t){return{x:SE(t),y:EE(t)}}var xn;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(xn||(xn={}));function NE(t){return!Vh||!t?!1:t===document.scrollingElement}function TE(t){const e={x:0,y:0},n=NE(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},s=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,l=t.scrollTop>=r.y,c=t.scrollLeft>=r.x;return{isTop:s,isLeft:a,isBottom:l,isRight:c,maxScroll:r,minScroll:e}}const tD={x:.2,y:.2};function nD(t,e,n,r,s){let{top:a,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),s===void 0&&(s=tD);const{isTop:p,isBottom:m,isLeft:g,isRight:b}=TE(t),v={x:0,y:0},w={x:0,y:0},C={height:e.height*s.y,width:e.width*s.x};return!p&&a<=e.top+C.height?(v.y=xn.Backward,w.y=r*Math.abs((e.top+C.height-a)/C.height)):!m&&d>=e.bottom-C.height&&(v.y=xn.Forward,w.y=r*Math.abs((e.bottom-C.height-d)/C.height)),!b&&c>=e.right-C.width?(v.x=xn.Forward,w.x=r*Math.abs((e.right-C.width-c)/C.width)):!g&&l<=e.left+C.width&&(v.x=xn.Backward,w.x=r*Math.abs((e.left+C.width-l)/C.width)),{direction:v,speed:w}}function rD(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:e,left:n,right:r,bottom:s}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:s,width:t.clientWidth,height:t.clientHeight}}function AE(t){return t.reduce((e,n)=>Yo(e,Z0(n)),qr)}function sD(t){return t.reduce((e,n)=>e+SE(n),0)}function iD(t){return t.reduce((e,n)=>e+EE(n),0)}function ME(t,e){if(e===void 0&&(e=vu),!t)return;const{top:n,left:r,bottom:s,right:a}=e(t);CE(t)&&(s<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const aD=[["x",["left","right"],sD],["y",["top","bottom"],iD]];class cb{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=lb(n),s=AE(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,l,c]of aD)for(const d of l)Object.defineProperty(this,d,{get:()=>{const p=c(r),m=s[a]-p;return this.rect[d]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Oc{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var s;(s=this.target)==null||s.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function oD(t){const{EventTarget:e}=Wn(t);return t instanceof e?t:yl(t)}function zg(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var jr;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(jr||(jr={}));function _2(t){t.preventDefault()}function lD(t){t.stopPropagation()}var Ct;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ct||(Ct={}));const OE={start:[Ct.Space,Ct.Enter],cancel:[Ct.Esc],end:[Ct.Space,Ct.Enter,Ct.Tab]},cD=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Ct.Right:return{...n,x:n.x+25};case Ct.Left:return{...n,x:n.x-25};case Ct.Down:return{...n,y:n.y+25};case Ct.Up:return{...n,y:n.y-25}}};class jE{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new Oc(yl(n)),this.windowListeners=new Oc(Wn(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(jr.Resize,this.handleCancel),this.windowListeners.add(jr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(jr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&ME(r),n(qr)}handleKeyDown(e){if(ob(e)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:a=OE,coordinateGetter:l=cD,scrollBehavior:c="smooth"}=s,{code:d}=e;if(a.end.includes(d)){this.handleEnd(e);return}if(a.cancel.includes(d)){this.handleCancel(e);return}const{collisionRect:p}=r.current,m=p?{x:p.left,y:p.top}:qr;this.referenceCoordinates||(this.referenceCoordinates=m);const g=l(e,{active:n,context:r.current,currentCoordinates:m});if(g){const b=Df(g,m),v={x:0,y:0},{scrollableAncestors:w}=r.current;for(const C of w){const k=e.code,{isTop:N,isRight:M,isLeft:_,isBottom:P,maxScroll:z,minScroll:K}=TE(C),O=rD(C),F={x:Math.min(k===Ct.Right?O.right-O.width/2:O.right,Math.max(k===Ct.Right?O.left:O.left+O.width/2,g.x)),y:Math.min(k===Ct.Down?O.bottom-O.height/2:O.bottom,Math.max(k===Ct.Down?O.top:O.top+O.height/2,g.y))},V=k===Ct.Right&&!M||k===Ct.Left&&!_,Z=k===Ct.Down&&!P||k===Ct.Up&&!N;if(V&&F.x!==g.x){const he=C.scrollLeft+b.x,Te=k===Ct.Right&&he<=z.x||k===Ct.Left&&he>=K.x;if(Te&&!b.y){C.scrollTo({left:he,behavior:c});return}Te?v.x=C.scrollLeft-he:v.x=k===Ct.Right?C.scrollLeft-z.x:C.scrollLeft-K.x,v.x&&C.scrollBy({left:-v.x,behavior:c});break}else if(Z&&F.y!==g.y){const he=C.scrollTop+b.y,Te=k===Ct.Down&&he<=z.y||k===Ct.Up&&he>=K.y;if(Te&&!b.x){C.scrollTo({top:he,behavior:c});return}Te?v.y=C.scrollTop-he:v.y=k===Ct.Down?C.scrollTop-z.y:C.scrollTop-K.y,v.y&&C.scrollBy({top:-v.y,behavior:c});break}}this.handleMove(e,Yo(Df(g,this.referenceCoordinates),v))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}jE.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=OE,onActivation:s}=e,{active:a}=n;const{code:l}=t.nativeEvent;if(r.start.includes(l)){const c=a.activatorNode.current;return c&&t.target!==c?!1:(t.preventDefault(),s==null||s({event:t.nativeEvent}),!0)}return!1}}];function R2(t){return!!(t&&"distance"in t)}function D2(t){return!!(t&&"delay"in t)}class ub{constructor(e,n,r){var s;r===void 0&&(r=oD(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:a}=e,{target:l}=a;this.props=e,this.events=n,this.document=yl(l),this.documentListeners=new Oc(this.document),this.listeners=new Oc(r),this.windowListeners=new Oc(Wn(l)),this.initialCoordinates=(s=Lf(a))!=null?s:qr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(jr.Resize,this.handleCancel),this.windowListeners.add(jr.DragStart,_2),this.windowListeners.add(jr.VisibilityChange,this.handleCancel),this.windowListeners.add(jr.ContextMenu,_2),this.documentListeners.add(jr.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(D2(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(R2(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(jr.Click,lD,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(jr.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:l,options:{activationConstraint:c}}=a;if(!s)return;const d=(n=Lf(e))!=null?n:qr,p=Df(s,d);if(!r&&c){if(R2(c)){if(c.tolerance!=null&&zg(p,c.tolerance))return this.handleCancel();if(zg(p,c.distance))return this.handleStart()}if(D2(c)&&zg(p,c.tolerance))return this.handleCancel();this.handlePending(c,p);return}e.cancelable&&e.preventDefault(),l(d)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Ct.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const uD={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class db extends ub{constructor(e){const{event:n}=e,r=yl(n.target);super(e,uD,r)}}db.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const dD={move:{name:"mousemove"},end:{name:"mouseup"}};var ex;(function(t){t[t.RightClick=2]="RightClick"})(ex||(ex={}));class fD extends ub{constructor(e){super(e,dD,yl(e.event.target))}}fD.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===ex.RightClick?!1:(r==null||r({event:n}),!0)}}];const Bg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class _E extends ub{constructor(e){super(e,Bg)}static setup(){return window.addEventListener(Bg.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Bg.move.name,e)};function e(){}}}_E.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var jc;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(jc||(jc={}));var zf;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(zf||(zf={}));function hD(t){let{acceleration:e,activator:n=jc.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:l=5,order:c=zf.TreeOrder,pointerCoordinates:d,scrollableAncestors:p,scrollableAncestorRects:m,delta:g,threshold:b}=t;const v=mD({delta:g,disabled:!a}),[w,C]=ER(),k=E.useRef({x:0,y:0}),N=E.useRef({x:0,y:0}),M=E.useMemo(()=>{switch(n){case jc.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case jc.DraggableRect:return s}},[n,s,d]),_=E.useRef(null),P=E.useCallback(()=>{const K=_.current;if(!K)return;const O=k.current.x*N.current.x,F=k.current.y*N.current.y;K.scrollBy(O,F)},[]),z=E.useMemo(()=>c===zf.TreeOrder?[...p].reverse():p,[c,p]);E.useEffect(()=>{if(!a||!p.length||!M){C();return}for(const K of z){if((r==null?void 0:r(K))===!1)continue;const O=p.indexOf(K),F=m[O];if(!F)continue;const{direction:V,speed:Z}=nD(K,F,M,e,b);for(const he of["x","y"])v[he][V[he]]||(Z[he]=0,V[he]=0);if(Z.x>0||Z.y>0){C(),_.current=K,w(P,l),k.current=Z,N.current=V;return}}k.current={x:0,y:0},N.current={x:0,y:0},C()},[e,P,r,C,a,l,JSON.stringify(M),JSON.stringify(v),w,p,z,m,JSON.stringify(b)])}const pD={x:{[xn.Backward]:!1,[xn.Forward]:!1},y:{[xn.Backward]:!1,[xn.Forward]:!1}};function mD(t){let{delta:e,disabled:n}=t;const r=Rf(e);return yu(s=>{if(n||!r||!s)return pD;const a={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[xn.Backward]:s.x[xn.Backward]||a.x===-1,[xn.Forward]:s.x[xn.Forward]||a.x===1},y:{[xn.Backward]:s.y[xn.Backward]||a.y===-1,[xn.Forward]:s.y[xn.Forward]||a.y===1}}},[n,e,r])}function gD(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return yu(s=>{var a;return e==null?null:(a=r??s)!=null?a:null},[r,e])}function xD(t,e){return E.useMemo(()=>t.reduce((n,r)=>{const{sensor:s}=r,a=s.activators.map(l=>({eventName:l.eventName,handler:e(l.handler,r)}));return[...n,...a]},[]),[t,e])}var Qc;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Qc||(Qc={}));var tx;(function(t){t.Optimized="optimized"})(tx||(tx={}));const L2=new Map;function bD(t,e){let{dragging:n,dependencies:r,config:s}=e;const[a,l]=E.useState(null),{frequency:c,measure:d,strategy:p}=s,m=E.useRef(t),g=k(),b=Xc(g),v=E.useCallback(function(N){N===void 0&&(N=[]),!b.current&&l(M=>M===null?N:M.concat(N.filter(_=>!M.includes(_))))},[b]),w=E.useRef(null),C=yu(N=>{if(g&&!n)return L2;if(!N||N===L2||m.current!==t||a!=null){const M=new Map;for(let _ of t){if(!_)continue;if(a&&a.length>0&&!a.includes(_.id)&&_.rect.current){M.set(_.id,_.rect.current);continue}const P=_.node.current,z=P?new cb(d(P),P):null;_.rect.current=z,z&&M.set(_.id,z)}return M}return N},[t,a,n,g,d]);return E.useEffect(()=>{m.current=t},[t]),E.useEffect(()=>{g||v()},[n,g]),E.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),E.useEffect(()=>{g||typeof c!="number"||w.current!==null||(w.current=setTimeout(()=>{v(),w.current=null},c))},[c,g,v,...r]),{droppableRects:C,measureDroppableContainers:v,measuringScheduled:a!=null};function k(){switch(p){case Qc.Always:return!1;case Qc.BeforeDragging:return n;default:return!n}}}function fb(t,e){return yu(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function yD(t,e){return fb(t,e)}function vD(t){let{callback:e,disabled:n}=t;const r=qh(e),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Kh(t){let{callback:e,disabled:n}=t;const r=qh(e),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function wD(t){return new cb(vu(t),t)}function I2(t,e,n){e===void 0&&(e=wD);const[r,s]=E.useState(null);function a(){s(d=>{if(!t)return null;if(t.isConnected===!1){var p;return(p=d??n)!=null?p:null}const m=e(t);return JSON.stringify(d)===JSON.stringify(m)?d:m})}const l=vD({callback(d){if(t)for(const p of d){const{type:m,target:g}=p;if(m==="childList"&&g instanceof HTMLElement&&g.contains(t)){a();break}}}}),c=Kh({callback:a});return Xs(()=>{a(),t?(c==null||c.observe(t),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[t]),r}function kD(t){const e=fb(t);return wE(t,e)}const z2=[];function CD(t){const e=E.useRef(t),n=yu(r=>t?r&&r!==z2&&t&&e.current&&t.parentNode===e.current.parentNode?r:lb(t):z2,[t]);return E.useEffect(()=>{e.current=t},[t]),n}function SD(t){const[e,n]=E.useState(null),r=E.useRef(t),s=E.useCallback(a=>{const l=Ig(a.target);l&&n(c=>c?(c.set(l,Z0(l)),new Map(c)):null)},[]);return E.useEffect(()=>{const a=r.current;if(t!==a){l(a);const c=t.map(d=>{const p=Ig(d);return p?(p.addEventListener("scroll",s,{passive:!0}),[p,Z0(p)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=t}return()=>{l(t),l(a)};function l(c){c.forEach(d=>{const p=Ig(d);p==null||p.removeEventListener("scroll",s)})}},[s,t]),E.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,l)=>Yo(a,l),qr):AE(t):qr,[t,e])}function B2(t,e){e===void 0&&(e=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},e),E.useEffect(()=>{const r=t!==qr;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Df(t,n.current):qr}function ED(t){E.useEffect(()=>{if(!Vh)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function ND(t,e){return E.useMemo(()=>t.reduce((n,r)=>{let{eventName:s,handler:a}=r;return n[s]=l=>{a(l,e)},n},{}),[t,e])}function RE(t){return E.useMemo(()=>t?QR(t):null,[t])}const P2=[];function TD(t,e){e===void 0&&(e=vu);const[n]=t,r=RE(n?Wn(n):null),[s,a]=E.useState(P2);function l(){a(()=>t.length?t.map(d=>NE(d)?r:new cb(e(d),d)):P2)}const c=Kh({callback:l});return Xs(()=>{c==null||c.disconnect(),l(),t.forEach(d=>c==null?void 0:c.observe(d))},[t]),s}function DE(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return bu(e)?e:t}function AD(t){let{measure:e}=t;const[n,r]=E.useState(null),s=E.useCallback(p=>{for(const{target:m}of p)if(bu(m)){r(g=>{const b=e(m);return g?{...g,width:b.width,height:b.height}:b});break}},[e]),a=Kh({callback:s}),l=E.useCallback(p=>{const m=DE(p);a==null||a.disconnect(),m&&(a==null||a.observe(m)),r(m?e(m):null)},[e,a]),[c,d]=_f(l);return E.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const MD=[{sensor:db,options:{}},{sensor:jE,options:{}}],OD={current:{}},hf={draggable:{measure:j2},droppable:{measure:j2,strategy:Qc.WhileDragging,frequency:tx.Optimized},dragOverlay:{measure:vu}};class _c extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const jD={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _c,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:If},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:hf,measureDroppableContainers:If,windowRect:null,measuringScheduled:!1},LE={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:If,draggableNodes:new Map,over:null,measureDroppableContainers:If},wu=E.createContext(LE),IE=E.createContext(jD);function _D(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _c}}}function RD(t,e){switch(e.type){case dn.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case dn.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case dn.DragEnd:case dn.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dn.RegisterDroppable:{const{element:n}=e,{id:r}=n,s=new _c(t.droppable.containers);return s.set(r,n),{...t,droppable:{...t.droppable,containers:s}}}case dn.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=e,a=t.droppable.containers.get(n);if(!a||r!==a.key)return t;const l=new _c(t.droppable.containers);return l.set(n,{...a,disabled:s}),{...t,droppable:{...t.droppable,containers:l}}}case dn.UnregisterDroppable:{const{id:n,key:r}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const a=new _c(t.droppable.containers);return a.delete(n),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function DD(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(wu),a=Rf(r),l=Rf(n==null?void 0:n.id);return E.useEffect(()=>{if(!e&&!r&&a&&l!=null){if(!ob(a)||document.activeElement===a.target)return;const c=s.get(l);if(!c)return;const{activatorNode:d,node:p}=c;if(!d.current&&!p.current)return;requestAnimationFrame(()=>{for(const m of[d.current,p.current]){if(!m)continue;const g=AR(m);if(g){g.focus();break}}})}},[r,e,s,l,a]),null}function zE(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((s,a)=>a({transform:s,...r}),n):n}function LD(t){return E.useMemo(()=>({draggable:{...hf.draggable,...t==null?void 0:t.draggable},droppable:{...hf.droppable,...t==null?void 0:t.droppable},dragOverlay:{...hf.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function ID(t){let{activeNode:e,measure:n,initialRect:r,config:s=!0}=t;const a=E.useRef(!1),{x:l,y:c}=typeof s=="boolean"?{x:s,y:s}:s;Xs(()=>{if(!l&&!c||!e){a.current=!1;return}if(a.current||!r)return;const p=e==null?void 0:e.node.current;if(!p||p.isConnected===!1)return;const m=n(p),g=wE(m,r);if(l||(g.x=0),c||(g.y=0),a.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const b=CE(p);b&&b.scrollBy({top:g.y,left:g.x})}},[e,l,c,r,n])}const Gh=E.createContext({...qr,scaleX:1,scaleY:1});var Ri;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Ri||(Ri={}));const zD=E.memo(function(e){var n,r,s,a;let{id:l,accessibility:c,autoScroll:d=!0,children:p,sensors:m=MD,collisionDetection:g=WR,measuring:b,modifiers:v,...w}=e;const C=E.useReducer(RD,void 0,_D),[k,N]=C,[M,_]=DR(),[P,z]=E.useState(Ri.Uninitialized),K=P===Ri.Initialized,{draggable:{active:O,nodes:F,translate:V},droppable:{containers:Z}}=k,he=O!=null?F.get(O):null,Te=E.useRef({initial:null,translated:null}),ve=E.useMemo(()=>{var Q;return O!=null?{id:O,data:(Q=he==null?void 0:he.data)!=null?Q:OD,rect:Te}:null},[O,he]),Se=E.useRef(null),[Ee,q]=E.useState(null),[te,G]=E.useState(null),I=Xc(w,Object.values(w)),H=Wh("DndDescribedBy",l),A=E.useMemo(()=>Z.getEnabled(),[Z]),R=LD(b),{droppableRects:W,measureDroppableContainers:oe,measuringScheduled:xe}=bD(A,{dragging:K,dependencies:[V.x,V.y],config:R.droppable}),L=gD(F,O),ae=E.useMemo(()=>te?Lf(te):null,[te]),U=yr(),ne=yD(L,R.draggable.measure);ID({activeNode:O!=null?F.get(O):null,config:U.layoutShiftCompensation,initialRect:ne,measure:R.draggable.measure});const ie=I2(L,R.draggable.measure,ne),je=I2(L?L.parentElement:null),Ue=E.useRef({activatorEvent:null,active:null,activeNode:L,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:F,draggingNode:null,draggingNodeRect:null,droppableContainers:Z,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),lt=Z.getNodeFor((n=Ue.current.over)==null?void 0:n.id),Fe=AD({measure:R.dragOverlay.measure}),nt=(r=Fe.nodeRef.current)!=null?r:L,pt=K?(s=Fe.rect)!=null?s:ie:null,Me=!!(Fe.nodeRef.current&&Fe.rect),rt=kD(Me?null:ie),De=RE(nt?Wn(nt):null),_e=CD(K?lt??L:null),an=TD(_e),on=zE(v,{transform:{x:V.x-rt.x,y:V.y-rt.y,scaleX:1,scaleY:1},activatorEvent:te,active:ve,activeNodeRect:ie,containerNodeRect:je,draggingNodeRect:pt,over:Ue.current.over,overlayNodeRect:Fe.rect,scrollableAncestors:_e,scrollableAncestorRects:an,windowRect:De}),Kn=ae?Yo(ae,V):null,Dt=SD(_e),ms=B2(Dt),Gr=B2(Dt,[ie]),Gn=Yo(on,ms),hn=pt?YR(pt,on):null,Yn=ve&&hn?g({active:ve,collisionRect:hn,droppableRects:W,droppableContainers:A,pointerCoordinates:Kn}):null,Yr=$R(Yn,"id"),[Xt,Pn]=E.useState(null),pn=Me?on:Yo(on,Gr),Ht=KR(pn,(a=Xt==null?void 0:Xt.rect)!=null?a:null,ie),kn=E.useRef(null),Kt=E.useCallback((Q,re)=>{let{sensor:ue,options:me}=re;if(Se.current==null)return;const ke=F.get(Se.current);if(!ke)return;const we=Q.nativeEvent,be=new ue({active:Se.current,activeNode:ke,event:we,options:me,context:Ue,onAbort(Ae){if(!F.get(Ae))return;const{onDragAbort:Pe}=I.current,st={id:Ae};Pe==null||Pe(st),M({type:"onDragAbort",event:st})},onPending(Ae,Qe,Pe,st){if(!F.get(Ae))return;const{onDragPending:It}=I.current,Cn={id:Ae,constraint:Qe,initialCoordinates:Pe,offset:st};It==null||It(Cn),M({type:"onDragPending",event:Cn})},onStart(Ae){const Qe=Se.current;if(Qe==null)return;const Pe=F.get(Qe);if(!Pe)return;const{onDragStart:st}=I.current,ft={activatorEvent:we,active:{id:Qe,data:Pe.data,rect:Te}};Wo.unstable_batchedUpdates(()=>{st==null||st(ft),z(Ri.Initializing),N({type:dn.DragStart,initialCoordinates:Ae,active:Qe}),M({type:"onDragStart",event:ft}),q(kn.current),G(we)})},onMove(Ae){N({type:dn.DragMove,coordinates:Ae})},onEnd:Ve(dn.DragEnd),onCancel:Ve(dn.DragCancel)});kn.current=be;function Ve(Ae){return async function(){const{active:Pe,collisions:st,over:ft,scrollAdjustedTranslate:It}=Ue.current;let Cn=null;if(Pe&&It){const{cancelDrop:or}=I.current;Cn={activatorEvent:we,active:Pe,collisions:st,delta:It,over:ft},Ae===dn.DragEnd&&typeof or=="function"&&await Promise.resolve(or(Cn))&&(Ae=dn.DragCancel)}Se.current=null,Wo.unstable_batchedUpdates(()=>{N({type:Ae}),z(Ri.Uninitialized),Pn(null),q(null),G(null),kn.current=null;const or=Ae===dn.DragEnd?"onDragEnd":"onDragCancel";if(Cn){const Hn=I.current[or];Hn==null||Hn(Cn),M({type:or,event:Cn})}})}}},[F]),aa=E.useCallback((Q,re)=>(ue,me)=>{const ke=ue.nativeEvent,we=F.get(me);if(Se.current!==null||!we||ke.dndKit||ke.defaultPrevented)return;const be={active:we};Q(ue,re.options,be)===!0&&(ke.dndKit={capturedBy:re.sensor},Se.current=me,Kt(ue,re))},[F,Kt]),ln=xD(m,aa);ED(m),Xs(()=>{ie&&P===Ri.Initializing&&z(Ri.Initialized)},[ie,P]),E.useEffect(()=>{const{onDragMove:Q}=I.current,{active:re,activatorEvent:ue,collisions:me,over:ke}=Ue.current;if(!re||!ue)return;const we={active:re,activatorEvent:ue,collisions:me,delta:{x:Gn.x,y:Gn.y},over:ke};Wo.unstable_batchedUpdates(()=>{Q==null||Q(we),M({type:"onDragMove",event:we})})},[Gn.x,Gn.y]),E.useEffect(()=>{const{active:Q,activatorEvent:re,collisions:ue,droppableContainers:me,scrollAdjustedTranslate:ke}=Ue.current;if(!Q||Se.current==null||!re||!ke)return;const{onDragOver:we}=I.current,be=me.get(Yr),Ve=be&&be.rect.current?{id:be.id,rect:be.rect.current,data:be.data,disabled:be.disabled}:null,Ae={active:Q,activatorEvent:re,collisions:ue,delta:{x:ke.x,y:ke.y},over:Ve};Wo.unstable_batchedUpdates(()=>{Pn(Ve),we==null||we(Ae),M({type:"onDragOver",event:Ae})})},[Yr]),Xs(()=>{Ue.current={activatorEvent:te,active:ve,activeNode:L,collisionRect:hn,collisions:Yn,droppableRects:W,draggableNodes:F,draggingNode:nt,draggingNodeRect:pt,droppableContainers:Z,over:Xt,scrollableAncestors:_e,scrollAdjustedTranslate:Gn},Te.current={initial:pt,translated:hn}},[ve,L,Yn,hn,F,nt,pt,W,Z,Xt,_e,Gn]),hD({...U,delta:V,draggingRect:hn,pointerCoordinates:Kn,scrollableAncestors:_e,scrollableAncestorRects:an});const Jr=E.useMemo(()=>({active:ve,activeNode:L,activeNodeRect:ie,activatorEvent:te,collisions:Yn,containerNodeRect:je,dragOverlay:Fe,draggableNodes:F,droppableContainers:Z,droppableRects:W,over:Xt,measureDroppableContainers:oe,scrollableAncestors:_e,scrollableAncestorRects:an,measuringConfiguration:R,measuringScheduled:xe,windowRect:De}),[ve,L,ie,te,Yn,je,Fe,F,Z,W,Xt,oe,_e,an,R,xe,De]),Jn=E.useMemo(()=>({activatorEvent:te,activators:ln,active:ve,activeNodeRect:ie,ariaDescribedById:{draggable:H},dispatch:N,draggableNodes:F,over:Xt,measureDroppableContainers:oe}),[te,ln,ve,ie,N,H,F,Xt,oe]);return We.createElement(vE.Provider,{value:_},We.createElement(wu.Provider,{value:Jn},We.createElement(IE.Provider,{value:Jr},We.createElement(Gh.Provider,{value:Ht},p)),We.createElement(DD,{disabled:(c==null?void 0:c.restoreFocus)===!1})),We.createElement(zR,{...c,hiddenTextDescribedById:H}));function yr(){const Q=(Ee==null?void 0:Ee.autoScrollEnabled)===!1,re=typeof d=="object"?d.enabled===!1:d===!1,ue=K&&!Q&&!re;return typeof d=="object"?{...d,enabled:ue}:{enabled:ue}}}),BD=E.createContext(null),H2="button",PD="Draggable";function HD(t){let{id:e,data:n,disabled:r=!1,attributes:s}=t;const a=Wh(PD),{activators:l,activatorEvent:c,active:d,activeNodeRect:p,ariaDescribedById:m,draggableNodes:g,over:b}=E.useContext(wu),{role:v=H2,roleDescription:w="draggable",tabIndex:C=0}=s??{},k=(d==null?void 0:d.id)===e,N=E.useContext(k?Gh:BD),[M,_]=_f(),[P,z]=_f(),K=ND(l,e),O=Xc(n);Xs(()=>(g.set(e,{id:e,key:a,node:M,activatorNode:P,data:O}),()=>{const V=g.get(e);V&&V.key===a&&g.delete(e)}),[g,e]);const F=E.useMemo(()=>({role:v,tabIndex:C,"aria-disabled":r,"aria-pressed":k&&v===H2?!0:void 0,"aria-roledescription":w,"aria-describedby":m.draggable}),[r,v,C,k,w,m.draggable]);return{active:d,activatorEvent:c,activeNodeRect:p,attributes:F,isDragging:k,listeners:r?void 0:K,node:M,over:b,setNodeRef:_,setActivatorNodeRef:z,transform:N}}function FD(){return E.useContext(IE)}const UD="Droppable",$D={timeout:25};function VD(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:s}=t;const a=Wh(UD),{active:l,dispatch:c,over:d,measureDroppableContainers:p}=E.useContext(wu),m=E.useRef({disabled:n}),g=E.useRef(!1),b=E.useRef(null),v=E.useRef(null),{disabled:w,updateMeasurementsFor:C,timeout:k}={...$D,...s},N=Xc(C??r),M=E.useCallback(()=>{if(!g.current){g.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{p(Array.isArray(N.current)?N.current:[N.current]),v.current=null},k)},[k]),_=Kh({callback:M,disabled:w||!l}),P=E.useCallback((F,V)=>{_&&(V&&(_.unobserve(V),g.current=!1),F&&_.observe(F))},[_]),[z,K]=_f(P),O=Xc(e);return E.useEffect(()=>{!_||!z.current||(_.disconnect(),g.current=!1,_.observe(z.current))},[z,_]),E.useEffect(()=>(c({type:dn.RegisterDroppable,element:{id:r,key:a,disabled:n,node:z,rect:b,data:O}}),()=>c({type:dn.UnregisterDroppable,key:a,id:r})),[r]),E.useEffect(()=>{n!==m.current.disabled&&(c({type:dn.SetDroppableDisabled,id:r,key:a,disabled:n}),m.current.disabled=n)},[r,a,n,c]),{active:l,rect:b,isOver:(d==null?void 0:d.id)===r,node:z,over:d,setNodeRef:K}}function qD(t){let{animation:e,children:n}=t;const[r,s]=E.useState(null),[a,l]=E.useState(null),c=Rf(n);return!n&&!r&&c&&s(c),Xs(()=>{if(!a)return;const d=r==null?void 0:r.key,p=r==null?void 0:r.props.id;if(d==null||p==null){s(null);return}Promise.resolve(e(p,a)).then(()=>{s(null)})},[e,r,a]),We.createElement(We.Fragment,null,n,r?E.cloneElement(r,{ref:l}):null)}const WD={x:0,y:0,scaleX:1,scaleY:1};function KD(t){let{children:e}=t;return We.createElement(wu.Provider,{value:LE},We.createElement(Gh.Provider,{value:WD},e))}const GD={position:"fixed",touchAction:"none"},YD=t=>ob(t)?"transform 250ms ease":void 0,JD=E.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:s,children:a,className:l,rect:c,style:d,transform:p,transition:m=YD}=t;if(!c)return null;const g=s?p:{...p,scaleX:1,scaleY:1},b={...GD,width:c.width,height:c.height,top:c.top,left:c.left,transform:il.Transform.toString(g),transformOrigin:s&&r?HR(r,c):void 0,transition:typeof m=="function"?m(r):m,...d};return We.createElement(n,{className:l,style:b,ref:e},a)}),XD=t=>e=>{let{active:n,dragOverlay:r}=e;const s={},{styles:a,className:l}=t;if(a!=null&&a.active)for(const[c,d]of Object.entries(a.active))d!==void 0&&(s[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(a!=null&&a.dragOverlay)for(const[c,d]of Object.entries(a.dragOverlay))d!==void 0&&r.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&r.node.classList.add(l.dragOverlay),function(){for(const[d,p]of Object.entries(s))n.node.style.setProperty(d,p);l!=null&&l.active&&n.node.classList.remove(l.active)}},QD=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:il.Transform.toString(e)},{transform:il.Transform.toString(n)}]},ZD={duration:250,easing:"ease",keyframes:QD,sideEffects:XD({styles:{active:{opacity:"0"}}})};function e6(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=t;return qh((a,l)=>{if(e===null)return;const c=n.get(a);if(!c)return;const d=c.node.current;if(!d)return;const p=DE(l);if(!p)return;const{transform:m}=Wn(l).getComputedStyle(l),g=kE(m);if(!g)return;const b=typeof e=="function"?e:t6(e);return ME(d,s.draggable.measure),b({active:{id:a,data:c.data,node:d,rect:s.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:s.dragOverlay.measure(p)},droppableContainers:r,measuringConfiguration:s,transform:g})})}function t6(t){const{duration:e,easing:n,sideEffects:r,keyframes:s}={...ZD,...t};return a=>{let{active:l,dragOverlay:c,transform:d,...p}=a;if(!e)return;const m={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},g={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},b={x:d.x-m.x,y:d.y-m.y,...g},v=s({...p,active:l,dragOverlay:c,transform:{initial:d,final:b}}),[w]=v,C=v[v.length-1];if(JSON.stringify(w)===JSON.stringify(C))return;const k=r==null?void 0:r({active:l,dragOverlay:c,...p}),N=c.node.animate(v,{duration:e,easing:n,fill:"forwards"});return new Promise(M=>{N.onfinish=()=>{k==null||k(),M()}})}}let F2=0;function n6(t){return E.useMemo(()=>{if(t!=null)return F2++,F2},[t])}const r6=We.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:s,transition:a,modifiers:l,wrapperElement:c="div",className:d,zIndex:p=999}=t;const{activatorEvent:m,active:g,activeNodeRect:b,containerNodeRect:v,draggableNodes:w,droppableContainers:C,dragOverlay:k,over:N,measuringConfiguration:M,scrollableAncestors:_,scrollableAncestorRects:P,windowRect:z}=FD(),K=E.useContext(Gh),O=n6(g==null?void 0:g.id),F=zE(l,{activatorEvent:m,active:g,activeNodeRect:b,containerNodeRect:v,draggingNodeRect:k.rect,over:N,overlayNodeRect:k.rect,scrollableAncestors:_,scrollableAncestorRects:P,transform:K,windowRect:z}),V=fb(b),Z=e6({config:r,draggableNodes:w,droppableContainers:C,measuringConfiguration:M}),he=V?k.setRef:void 0;return We.createElement(KD,null,We.createElement(qD,{animation:Z},g&&O?We.createElement(JD,{key:O,id:g.id,ref:he,as:c,activatorEvent:m,adjustScale:e,className:d,transition:a,rect:V,style:{zIndex:p,...s},transform:F},n):null))});function s6(t,e,n){const r={...t};return e.top+t.y<=n.top?r.y=n.top-e.top:e.bottom+t.y>=n.top+n.height&&(r.y=n.top+n.height-e.bottom),e.left+t.x<=n.left?r.x=n.left-e.left:e.right+t.x>=n.left+n.width&&(r.x=n.left+n.width-e.right),r}const U2=t=>{let{transform:e,draggingNodeRect:n,windowRect:r}=t;return!n||!r?e:s6(e,n,r)},i6=4,Bf=["Felsefe","Sosyoloji","Psikoloji","Bilim ve Teknoloji","Din ve nan","Tarih","nceleme ve Aratrma","Ekonomi ve Hukuk","Trk Edebiyat","Dnya Edebiyat","Sanat ve Kltr","Dier"],$2=({activeCategory:t,onCategoryChange:e,categories:n=Bf})=>h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsx("div",{className:"flex items-center justify-between px-1",children:h.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Keif Alanlar"})}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("button",{onClick:()=>e(null),className:`w-full text-left px-3 py-2 rounded-xl text-sm font-bold transition-all duration-300 border ${t===null?"bg-card border-[#CC561E] text-card-foreground shadow-[0_0_12px_rgba(204,86,30,0.35)]":"bg-card border-white/10 text-card-foreground hover:border-white/20 hover:bg-card/90"}`,children:"Tm"}),n.map(r=>h.jsx("button",{onClick:()=>e(r),className:`w-full text-left px-3 py-2 rounded-xl text-sm font-bold transition-all duration-300 border ${t===r?"bg-card border-[#CC561E] text-card-foreground shadow-[0_0_12px_rgba(204,86,30,0.35)]":"bg-card border-white/10 text-card-foreground hover:border-white/20 hover:bg-card/90"}`,children:r},r))]})]}),BE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"kb-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[h.jsx("stop",{offset:"0%",stopColor:"#CC561E"}),h.jsx("stop",{offset:"100%",stopColor:"#A44319"})]})}),h.jsx("rect",{x:"2",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"}),h.jsx("rect",{x:"9",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"16",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),h.jsx("rect",{x:"2",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)"}),h.jsx("rect",{x:"16",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"2",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),h.jsx("rect",{x:"9",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"16",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"})]}),PE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M12 20H21",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M16.5 3.5C17.3284 2.67157 18.6716 2.67157 19.5 3.5C20.3284 4.32843 20.3284 5.67157 19.5 6.5L7 19L3 20L4 16L16.5 3.5Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M15 5L19 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),nx=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"3",y:"6",width:"4",height:"12",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M4 9H6",stroke:"#CC561E",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("rect",{x:"8",y:"4",width:"4",height:"14",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.3"}),h.jsx("path",{d:"M9 7H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),h.jsx("path",{d:"M9 15H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),h.jsx("rect",{x:"13",y:"7",width:"4",height:"11",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"18",y:"5",width:"4",height:"13",rx:"0.5",transform:"rotate(12 18 5)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M2 19H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.3"})]}),pf=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M4 4H14L20 10V20H4V4Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M14 4V10H20",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M8 14H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M8 17H12",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),mf=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"11",cy:"11",r:"9",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("ellipse",{cx:"11",cy:"11",rx:"3.5",ry:"9",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M2 11H20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M11 2V20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M16 14L22 17L19 18L21 21L19 22L17 19L14 22V14Z",fill:"#CC561E",stroke:"#000",strokeWidth:"0.5"})]}),HE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"5",y:"5",width:"14",height:"15",rx:"1.5",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.3",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M3 4C3 3.44772 3.44772 3 4 3H19C19.5523 3 20 3.44772 20 4V20C20 20.5523 19.5523 21 19 21H4C3.44772 21 3 20.5523 3 20V4Z",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.15"}),h.jsx("path",{d:"M5 1V5M9 1V5M13 1V5M17 1V5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M7 9H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M7 12H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M7 15H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M16 21L20 17",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),Vq=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M6 20V14",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M12 20V10",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M18 20V5",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M4 14L10 8L15 13L21 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M21 4H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M21 4V9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),qq=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"5",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"13",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"5",y:"13",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"16",y:"13",width:"6",height:"6",rx:"2",transform:"rotate(45 16 16)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"})]}),Wq=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.8"}),h.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.5"}),h.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M19 5L13.5 10.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M19 5L20 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M19 5L15 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),Kq=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M21 8V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M23 3H1V8H23V3Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"10",y:"12",width:"4",height:"2",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M7 16H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("path",{d:"M7 19H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"})]}),rx=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"#CC561E",strokeWidth:"2.5",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M14.5 7.5C14.5 7.5 13.5 6.5 11 6.5",stroke:"#fff",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.7"}),h.jsx("circle",{cx:"11",cy:"11",r:"4",stroke:"#CC561E",strokeWidth:"1",strokeOpacity:"0.3"}),h.jsx("path",{d:"M16 16L20 20",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M17 17L19 19",stroke:"#fff",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.5"}),h.jsx("circle",{cx:"18",cy:"6",r:"1.5",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("circle",{cx:"21",cy:"9",r:"1",fill:"#CC561E",fillOpacity:"0.4"})]}),a6=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"4",y:"6",width:"16",height:"15",rx:"4",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M12 6V3",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("circle",{cx:"12",cy:"3",r:"2",stroke:"#CC561E",strokeWidth:"1.5"}),h.jsx("circle",{cx:"12",cy:"3",r:"0.5",fill:"#CC561E"}),h.jsx("rect",{x:"7",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("rect",{x:"14",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M9 16C9 16 10 17 12 17C14 17 15 16 15 16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M2 13H4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("path",{d:"M20 13H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),o6=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M2 6C6 6 6 10 10 10C14 10 14 6 18 6C20 6 21 7 22 8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M2 12C6 12 6 16 10 16C14 16 14 12 18 12C20 12 21 13 22 14",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M2 18C6 18 6 22 10 22C14 22 14 18 18 18C20 18 21 19 22 20",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.2"}),h.jsx("path",{d:"M10 4V20",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"2 4",strokeOpacity:"0.5"})]});function Yh(t){const e=typeof t=="string"?t.trim().toLowerCase():"";return e==="insight"||e==="note"?"insight":"highlight"}function FE(t){return Yh(t)==="insight"}const UE="PRIVATE";function Jh(t){const e=typeof t=="string"?t.trim().toUpperCase():"";return e==="DAILY"?"DAILY":e==="IDEAS"?"IDEAS":UE}function Pt(t){return t.type==="PERSONAL_NOTE"}function Dn(t){return Pt(t)?Jh(t.personalNoteCategory):UE}function $E(t){return Pt(t)&&Dn(t)==="IDEAS"}function VE(t){return $E(t)?"INSIGHT":"PERSONAL_NOTE"}function qE(t){return typeof t!="string"?void 0:t.trim().replace(/\s+/g," ")||void 0}function WE(t){return typeof t!="string"?void 0:t.trim()||void 0}const l6=/<\/?[a-z][\s\S]*>/i,KE=t=>l6.test(t),Ea=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Na=t=>t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(.+?)__/g,"<u>$1</u>").replace(/_(.+?)_/g,"<em>$1</em>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,'<code class="px-1 py-0.5 rounded bg-slate-100 text-slate-700">$1</code>'),c6=t=>{if(typeof window>"u")return t;const n=new DOMParser().parseFromString(t,"text/html");return n.querySelectorAll("script,style,iframe,object,embed").forEach(r=>r.remove()),n.body.querySelectorAll("*").forEach(r=>{[...r.attributes].forEach(s=>{const a=s.name.toLowerCase(),l=s.value.toLowerCase();a.startsWith("on")&&r.removeAttribute(s.name),(a==="href"||a==="src")&&l.startsWith("javascript:")&&r.removeAttribute(s.name)})}),n.body.innerHTML},Wa=t=>{if(!t)return"";if(KE(t)){const e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/(p|div|li|h1|h2|h3|h4|h5|h6|blockquote|pre|tr|td|th|ul|ol)>/gi,`
`);return typeof window<"u"?(new DOMParser().parseFromString(e,"text/html").body.textContent||"").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).trim():e.replace(/<[^>]*>/g," ").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]{2,}/g," ").trim()}return t.replace(/^#{1,6}\s+/gm,"").replace(/^\s*-\s\[(?: |x|X)\]\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/^\s*>\s?/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\s+\n/g,`
`).trim()},Pf=t=>Wa(t).trim().length>0,hb=t=>{if(!Pf(t))return'<p class="text-slate-400 italic">No content added.</p>';if(KE(t))return c6(t);const e=t.split(`
`);let n="",r=null;const s=()=>{r&&(n+=`</${r}>`,r=null)};for(const a of e){if(!a.trim()){s(),n+='<div class="h-2"></div>';continue}const l=a.match(/^\s*#\s+(.+)/),c=a.match(/^\s*##\s+(.+)/),d=a.match(/^\s*-\s\[( |x|X)\]\s+(.+)/),p=a.match(/^\s*-\s+(.+)/),m=a.match(/^\s*\d+\.\s+(.+)/),g=a.match(/^\s*>\s+(.+)/);if(l){s(),n+=`<h1 class="text-xl font-bold mt-3 mb-1.5">${Na(Ea(l[1]))}</h1>`;continue}if(c){s(),n+=`<h2 class="text-lg font-semibold mt-3 mb-1.5">${Na(Ea(c[1]))}</h2>`;continue}if(g){s(),n+=`<blockquote class="border-l-2 border-[#CC561E]/40 pl-3 italic text-slate-600 my-1">${Na(Ea(g[1]))}</blockquote>`;continue}if(d){r!=="ul"&&(s(),r="ul",n+='<ul class="space-y-1 my-1">');const b=d[1].toLowerCase()==="x";n+=`<li class="text-sm flex items-start gap-2"><span class="mt-0.5">${b?"&#9745;":"&#9744;"}</span><span>${Na(Ea(d[2]))}</span></li>`;continue}if(p){r!=="ul"&&(s(),r="ul",n+='<ul class="list-disc pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${Na(Ea(p[1]))}</li>`;continue}if(m){r!=="ol"&&(s(),r="ol",n+='<ol class="list-decimal pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${Na(Ea(m[1]))}</li>`;continue}s(),n+=`<p class="text-sm leading-relaxed my-1">${Na(Ea(a.trim()))}</p>`}return s(),n};var Pg={exports:{}},Hg={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V2;function u6(){if(V2)return Hg;V2=1;var t=pu();function e(g,b){return g===b&&(g!==0||1/g===1/b)||g!==g&&b!==b}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,a=t.useLayoutEffect,l=t.useDebugValue;function c(g,b){var v=b(),w=r({inst:{value:v,getSnapshot:b}}),C=w[0].inst,k=w[1];return a(function(){C.value=v,C.getSnapshot=b,d(C)&&k({inst:C})},[g,v,b]),s(function(){return d(C)&&k({inst:C}),g(function(){d(C)&&k({inst:C})})},[g]),l(v),v}function d(g){var b=g.getSnapshot;g=g.value;try{var v=b();return!n(g,v)}catch{return!0}}function p(g,b){return b()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return Hg.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:m,Hg}var q2;function GE(){return q2||(q2=1,Pg.exports=u6()),Pg.exports}var YE=GE();function An(t){this.content=t}An.prototype={constructor:An,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),a=r.content.slice();return s==-1?a.push(n||t,e):(a[s+1]=e,n&&(a[s]=n)),new An(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new An(n)},addToStart:function(t,e){return new An([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new An(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),a=r.find(t);return s.splice(a==-1?s.length:a,0,e,n),new An(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=An.from(t),t.size?new An(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=An.from(t),t.size?new An(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=An.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};An.from=function(t){if(t instanceof An)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new An(e)};function JE(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),a=e.child(r);if(s==a){n+=s.nodeSize;continue}if(!s.sameMarkup(a))return n;if(s.isText&&s.text!=a.text){for(let l=0;s.text[l]==a.text[l];l++)n++;return n}if(s.content.size||a.content.size){let l=JE(s.content,a.content,n+1);if(l!=null)return l}n+=s.nodeSize}}function XE(t,e,n,r){for(let s=t.childCount,a=e.childCount;;){if(s==0||a==0)return s==a?null:{a:n,b:r};let l=t.child(--s),c=e.child(--a),d=l.nodeSize;if(l==c){n-=d,r-=d;continue}if(!l.sameMarkup(c))return{a:n,b:r};if(l.isText&&l.text!=c.text){let p=0,m=Math.min(l.text.length,c.text.length);for(;p<m&&l.text[l.text.length-p-1]==c.text[c.text.length-p-1];)p++,n--,r--;return{a:n,b:r}}if(l.content.size||c.content.size){let p=XE(l.content,c.content,n-1,r-1);if(p)return p}n-=d,r-=d}}class fe{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,a){for(let l=0,c=0;c<n;l++){let d=this.content[l],p=c+d.nodeSize;if(p>e&&r(d,s+c,a||null,l)!==!1&&d.content.size){let m=c+1;d.nodesBetween(Math.max(0,e-m),Math.min(d.content.size,n-m),r,s+m)}c=p}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let a="",l=!0;return this.nodesBetween(e,n,(c,d)=>{let p=c.isText?c.text.slice(Math.max(e,d)-d,n-d):c.isLeaf?s?typeof s=="function"?s(c):s:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&p||c.isTextblock)&&r&&(l?l=!1:a+=r),a+=p},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),a=1);a<e.content.length;a++)s.push(e.content[a]);return new fe(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let a=0,l=0;l<n;a++){let c=this.content[a],d=l+c.nodeSize;d>e&&((l<e||d>n)&&(c.isText?c=c.cut(Math.max(0,e-l),Math.min(c.text.length,n-l)):c=c.cut(Math.max(0,e-l-1),Math.min(c.content.size,n-l-1))),r.push(c),s+=c.nodeSize),l=d}return new fe(r,s)}cutByIndex(e,n){return e==n?fe.empty:e==0&&n==this.content.length?this:new fe(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),a=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new fe(s,a)}addToStart(e){return new fe([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new fe(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return JE(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return XE(this,e,n,r)}findIndex(e){if(e==0)return qd(0,e);if(e==this.size)return qd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),a=r+s.nodeSize;if(a>=e)return a==e?qd(n+1,a):qd(n,r);r=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return fe.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new fe(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return fe.empty;let n,r=0;for(let s=0;s<e.length;s++){let a=e[s];r+=a.nodeSize,s&&a.isText&&e[s-1].sameMarkup(a)?(n||(n=e.slice(0,s)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new fe(n||e,r)}static from(e){if(!e)return fe.empty;if(e instanceof fe)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new fe([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}fe.empty=new fe([],0);const Fg={index:0,offset:0};function qd(t,e){return Fg.index=t,Fg.offset=e,Fg}function Hf(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Hf(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Hf(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Et=class sx{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let a=e[s];if(this.eq(a))return e;if(this.type.excludes(a.type))n||(n=e.slice(0,s));else{if(a.type.excludes(this.type))return e;!r&&a.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(a)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Hf(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return sx.none;if(e instanceof sx)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};Et.none=[];class Ff extends Error{}class Ne{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=ZE(this.content,e+this.openStart,n);return r&&new Ne(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Ne(QE(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Ne.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ne(fe.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let a=e.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=e.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)s++;return new Ne(e,r,s)}}Ne.empty=new Ne(fe.empty,0,0);function QE(t,e,n){let{index:r,offset:s}=t.findIndex(e),a=t.maybeChild(r),{index:l,offset:c}=t.findIndex(n);if(s==e||a.isText){if(c!=n&&!t.child(l).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=l)throw new RangeError("Removing non-flat range");return t.replaceChild(r,a.copy(QE(a.content,e-s-1,n-s-1)))}function ZE(t,e,n,r){let{index:s,offset:a}=t.findIndex(e),l=t.maybeChild(s);if(a==e||l.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let c=ZE(l.content,e-a-1,n,l);return c&&t.replaceChild(s,l.copy(c))}function d6(t,e,n){if(n.openStart>t.depth)throw new Ff("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ff("Inconsistent open depths");return eN(t,e,n,0)}function eN(t,e,n,r){let s=t.index(r),a=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let l=eN(t,e,n,r+1);return a.copy(a.content.replaceChild(s,l))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let l=t.parent,c=l.content;return Fa(l,c.cut(0,t.parentOffset).append(n.content).append(c.cut(e.parentOffset)))}else{let{start:l,end:c}=f6(n,t);return Fa(a,nN(t,l,c,e,r))}else return Fa(a,Uf(t,e,r))}function tN(t,e){if(!e.type.compatibleContent(t.type))throw new Ff("Cannot join "+e.type.name+" onto "+t.type.name)}function ix(t,e,n){let r=t.node(n);return tN(r,e.node(n)),r}function Ha(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Rc(t,e,n,r){let s=(e||t).node(n),a=0,l=e?e.index(n):s.childCount;t&&(a=t.index(n),t.depth>n?a++:t.textOffset&&(Ha(t.nodeAfter,r),a++));for(let c=a;c<l;c++)Ha(s.child(c),r);e&&e.depth==n&&e.textOffset&&Ha(e.nodeBefore,r)}function Fa(t,e){return t.type.checkContent(e),t.copy(e)}function nN(t,e,n,r,s){let a=t.depth>s&&ix(t,e,s+1),l=r.depth>s&&ix(n,r,s+1),c=[];return Rc(null,t,s,c),a&&l&&e.index(s)==n.index(s)?(tN(a,l),Ha(Fa(a,nN(t,e,n,r,s+1)),c)):(a&&Ha(Fa(a,Uf(t,e,s+1)),c),Rc(e,n,s,c),l&&Ha(Fa(l,Uf(n,r,s+1)),c)),Rc(r,null,s,c),new fe(c)}function Uf(t,e,n){let r=[];if(Rc(null,t,n,r),t.depth>n){let s=ix(t,e,n+1);Ha(Fa(s,Uf(t,e,n+1)),r)}return Rc(e,null,n,r),new fe(r)}function f6(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let a=n-1;a>=0;a--)s=e.node(a).copy(fe.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Zc{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let a=0;a<e;a++)s+=r.child(a).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Et.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let c=r;r=s,s=c}let a=r.marks;for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!s||!a[l].isInSet(s.marks))&&(a=a[l--].removeFromSet(a));return a}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!s||!r[a].isInSet(s.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new $f(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,a=n;for(let l=e;;){let{index:c,offset:d}=l.content.findIndex(a),p=a-d;if(r.push(l,c,s+d),!p||(l=l.child(c),l.isText))break;a=p-1,s+=d+1}return new Zc(n,r,a)}static resolveCached(e,n){let r=W2.get(e);if(r)for(let a=0;a<r.elts.length;a++){let l=r.elts[a];if(l.pos==n)return l}else W2.set(e,r=new h6);let s=r.elts[r.i]=Zc.resolve(e,n);return r.i=(r.i+1)%p6,s}}class h6{constructor(){this.elts=[],this.i=0}}const p6=12,W2=new WeakMap;class $f{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const m6=Object.create(null);class $r{constructor(e,n,r,s=Et.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||fe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Hf(this.attrs,n||e.defaultAttrs||m6)&&Et.sameSet(this.marks,r||Et.none)}copy(e=null){return e==this.content?this:new $r(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new $r(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return Ne.empty;let s=this.resolve(e),a=this.resolve(n),l=r?0:s.sharedDepth(n),c=s.start(l),p=s.node(l).content.cut(s.pos-c,a.pos-c);return new Ne(p,s.depth-l,a.depth-l)}replace(e,n,r){return d6(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Zc.resolveCached(this,e)}resolveNoCache(e){return Zc.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,a=>(r.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),rN(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=fe.empty,s=0,a=r.childCount){let l=this.contentMatchAt(e).matchFragment(r,s,a),c=l&&l.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(let d=s;d<a;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(e).matchType(r),l=a&&a.matchFragment(this.content,n);return l?l.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Et.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Et.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=fe.fromJSON(e,n.content),a=e.nodeType(n.type).create(n.attrs,s,r);return a.type.checkAttrs(a.attrs),a}}$r.prototype.text=void 0;class Vf extends $r{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):rN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Vf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Vf(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function rN(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Ka{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new g6(e,n);if(r.next==null)return Ka.empty;let s=sN(r);r.next&&r.err("Unexpected trailing text");let a=C6(k6(s));return S6(a,r),a}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let a=n;s&&a<r;a++)s=s.matchType(e.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function a(l,c){let d=l.matchFragment(e,r);if(d&&(!n||d.validEnd))return fe.from(c.map(p=>p.createAndFill()));for(let p=0;p<l.next.length;p++){let{type:m,next:g}=l.next[p];if(!(m.isText||m.hasRequiredAttrs())&&s.indexOf(g)==-1){s.push(g);let b=a(g,c.concat(m));if(b)return b}}return null}return a(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),a=s.match;if(a.matchType(e)){let l=[];for(let c=s;c.type;c=c.via)l.push(c.type);return l.reverse()}for(let l=0;l<a.next.length;l++){let{type:c,next:d}=a.next[l];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in n)&&(!s.type||d.validEnd)&&(r.push({match:c.contentMatch,type:c,via:s}),n[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let a=s+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)a+=(l?", ":"")+r.next[l].type.name+"->"+e.indexOf(r.next[l].next);return a}).join(`
`)}}Ka.empty=new Ka(!0);class g6{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function sN(t){let e=[];do e.push(x6(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function x6(t){let e=[];do e.push(b6(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function b6(t){let e=w6(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=y6(t,e);else break;return e}function K2(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function y6(t,e){let n=K2(t),r=n;return t.eat(",")&&(t.next!="}"?r=K2(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function v6(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let a in n){let l=n[a];l.isInGroup(e)&&s.push(l)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function w6(t){if(t.eat("(")){let e=sN(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=v6(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function k6(t){let e=[[]];return s(a(t,0),n()),e;function n(){return e.push([])-1}function r(l,c,d){let p={term:d,to:c};return e[l].push(p),p}function s(l,c){l.forEach(d=>d.to=c)}function a(l,c){if(l.type=="choice")return l.exprs.reduce((d,p)=>d.concat(a(p,c)),[]);if(l.type=="seq")for(let d=0;;d++){let p=a(l.exprs[d],c);if(d==l.exprs.length-1)return p;s(p,c=n())}else if(l.type=="star"){let d=n();return r(c,d),s(a(l.expr,d),d),[r(d)]}else if(l.type=="plus"){let d=n();return s(a(l.expr,c),d),s(a(l.expr,d),d),[r(d)]}else{if(l.type=="opt")return[r(c)].concat(a(l.expr,c));if(l.type=="range"){let d=c;for(let p=0;p<l.min;p++){let m=n();s(a(l.expr,d),m),d=m}if(l.max==-1)s(a(l.expr,d),d);else for(let p=l.min;p<l.max;p++){let m=n();r(d,m),s(a(l.expr,d),m),d=m}return[r(d)]}else{if(l.type=="name")return[r(c,void 0,l.value)];throw new Error("Unknown expr type")}}}}function iN(t,e){return e-t}function G2(t,e){let n=[];return r(e),n.sort(iN);function r(s){let a=t[s];if(a.length==1&&!a[0].term)return r(a[0].to);n.push(s);for(let l=0;l<a.length;l++){let{term:c,to:d}=a[l];!c&&n.indexOf(d)==-1&&r(d)}}}function C6(t){let e=Object.create(null);return n(G2(t,0));function n(r){let s=[];r.forEach(l=>{t[l].forEach(({term:c,to:d})=>{if(!c)return;let p;for(let m=0;m<s.length;m++)s[m][0]==c&&(p=s[m][1]);G2(t,d).forEach(m=>{p||s.push([c,p=[]]),p.indexOf(m)==-1&&p.push(m)})})});let a=e[r.join(",")]=new Ka(r.indexOf(t.length-1)>-1);for(let l=0;l<s.length;l++){let c=s[l][1].sort(iN);a.next.push({type:s[l][0],next:e[c.join(",")]||n(c)})}return a}}function S6(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],a=!s.validEnd,l=[];for(let c=0;c<s.next.length;c++){let{type:d,next:p}=s.next[c];l.push(d.name),a&&!(d.isText||d.hasRequiredAttrs())&&(a=!1),r.indexOf(p)==-1&&r.push(p)}a&&e.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function aN(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function oN(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let a=t[r];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function lN(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let a=t[s];a.validate&&a.validate(e[s])}}function cN(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new N6(t,r,e[r]);return n}let Y2=class uN{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=cN(e,r.attrs),this.defaultAttrs=aN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ka.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:oN(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new $r(this,this.computeAttrs(e),fe.from(n),Et.setFrom(r))}createChecked(e=null,n,r){return n=fe.from(n),this.checkContent(n),new $r(this,this.computeAttrs(e),n,Et.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=fe.from(n),n.size){let l=this.contentMatch.fillBefore(n);if(!l)return null;n=l.append(n)}let s=this.contentMatch.matchFragment(n),a=s&&s.fillBefore(fe.empty,!0);return a?new $r(this,e,n.append(a),Et.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){lN(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Et.none:e}static compile(e,n){let r=Object.create(null);e.forEach((a,l)=>r[a]=new uN(a,n,l));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function E6(t,e,n){let r=n.split("|");return s=>{let a=s===null?"null":typeof s;if(r.indexOf(a)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${a}`)}}class N6{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?E6(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Xh{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=cN(e,s.attrs),this.excluded=null;let a=aN(this.attrs);this.instance=a?new Et(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Et(this,oN(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((a,l)=>r[a]=new Xh(a,s++,n,l)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){lN(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class dN{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=An.from(e.nodes),n.marks=An.from(e.marks||{}),this.nodes=Y2.compile(this.spec.nodes,this),this.marks=Xh.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],l=a.spec.content||"",c=a.spec.marks;if(a.contentMatch=r[l]||(r[l]=Ka.parse(l,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=c=="_"?null:c?J2(this,c.split(" ")):c==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],l=a.spec.excludes;a.excluded=l==null?[a]:l==""?[]:J2(this,l.split(" "))}this.nodeFromJSON=s=>$r.fromJSON(this,s),this.markFromJSON=s=>Et.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Y2){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new Vf(r,r.defaultAttrs,e,Et.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function J2(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],a=t.marks[s],l=a;if(a)n.push(a);else for(let c in t.marks){let d=t.marks[c];(s=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(s)>-1)&&n.push(l=d)}if(!l)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function T6(t){return t.tag!=null}function A6(t){return t.style!=null}let Dc=class ax{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(T6(s))this.tags.push(s);else if(A6(s)){let a=/[^=]*/.exec(s.style)[0];r.indexOf(a)<0&&r.push(a),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let a=e.nodes[s.node];return a.contentMatch.matchType(a)})}parse(e,n={}){let r=new Q2(this,n,!1);return r.addAll(e,Et.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Q2(this,n,!0);return r.addAll(e,Et.none,n.from,n.to),Ne.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(j6(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){let l=a.getAttrs(e);if(l===!1)continue;a.attrs=l||void 0}return a}}}matchStyle(e,n,r,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let l=this.styles[a],c=l.style;if(!(c.indexOf(e)!=0||l.context&&!r.matchesContext(l.context)||c.length>e.length&&(c.charCodeAt(e.length)!=61||c.slice(e.length+1)!=n))){if(l.getAttrs){let d=l.getAttrs(n);if(d===!1)continue;l.attrs=d||void 0}return l}}}static schemaRules(e){let n=[];function r(s){let a=s.priority==null?50:s.priority,l=0;for(;l<n.length;l++){let c=n[l];if((c.priority==null?50:c.priority)<a)break}n.splice(l,0,s)}for(let s in e.marks){let a=e.marks[s].spec.parseDOM;a&&a.forEach(l=>{r(l=Z2(l)),l.mark||l.ignore||l.clearMark||(l.mark=s)})}for(let s in e.nodes){let a=e.nodes[s].spec.parseDOM;a&&a.forEach(l=>{r(l=Z2(l)),l.node||l.ignore||l.mark||(l.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ax(e,ax.schemaRules(e)))}};const fN={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},M6={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},hN={ol:!0,ul:!0},eu=1,ox=2,Lc=4;function X2(t,e,n){return e!=null?(e?eu:0)|(e==="full"?ox:0):t&&t.whitespace=="pre"?eu|ox:n&~Lc}class Wd{constructor(e,n,r,s,a,l){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=l,this.content=[],this.activeMarks=Et.none,this.match=a||(l&Lc?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(fe.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&eu)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let n=fe.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(fe.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!fN.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Q2{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,a,l=X2(null,n.preserveWhitespace,0)|(r?Lc:0);s?a=new Wd(s.type,s.attrs,Et.none,!0,n.topMatch||s.type.contentMatch,l):r?a=new Wd(null,null,Et.none,!0,null,l):a=new Wd(e.schema.topNodeType,null,Et.none,!0,null,l),this.nodes=[a],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,a=s.options&ox?"full":this.localPreserveWS||(s.options&eu)>0,{schema:l}=this.parser;if(a==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(a)if(a==="full")r=r.replace(/\r\n?/g,`
`);else if(l.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(l.linebreakReplacement.create())){let c=r.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(l.linebreakReplacement.create(),n,!0),c[d]&&this.insertNode(l.text(c[d]),n,!/\S/.test(c[d]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let c=s.content[s.content.length-1],d=e.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(r=r.slice(1))}r&&this.insertNode(l.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let l=e.nodeName.toLowerCase(),c;hN.hasOwnProperty(l)&&this.parser.normalizeLists&&O6(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(c=this.parser.matchTag(e,this,r));e:if(d?d.ignore:M6.hasOwnProperty(l))this.findInside(e),this.ignoreFallback(e,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let p,m=this.needsBlock;if(fN.hasOwnProperty(l))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),p=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=d&&d.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),p&&this.sync(a),this.needsBlock=m}else{let p=this.readStyles(e,n);p&&this.addElementByRule(e,d,p,d.consuming===!1?c:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let a=this.parser.matchedStyles[s],l=r.getPropertyValue(a);if(l)for(let c=void 0;;){let d=this.parser.matchStyle(a,l,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(p=>!d.clearMark(p)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return n}addElementByRule(e,n,r,s){let a,l;if(n.node)if(l=this.parser.schema.nodes[n.node],l.isLeaf)this.insertNode(l.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let d=this.enter(l,n.attrs||null,r,n.preserveWhitespace);d&&(a=!0,r=d)}else{let d=this.parser.schema.marks[n.mark];r=r.concat(d.create(n.attrs))}let c=this.top;if(l&&l.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=e;typeof n.contentElement=="string"?d=e.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(e):n.contentElement&&(d=n.contentElement),this.findAround(e,d,!0),this.addAll(d,r),this.findAround(e,d,!1)}a&&this.sync(c)&&this.open--}addAll(e,n,r,s){let a=r||0;for(let l=r?e.childNodes[r]:e.firstChild,c=s==null?null:e.childNodes[s];l!=c;l=l.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(l,n);this.findAtPoint(e,a)}findPlace(e,n,r){let s,a;for(let l=this.open,c=0;l>=0;l--){let d=this.nodes[l],p=d.findWrapping(e);if(p&&(!s||s.length>p.length+c)&&(s=p,a=d,!p.length))break;if(d.solid){if(r)break;c+=2}}if(!s)return null;this.sync(a);for(let l=0;l<s.length;l++)n=this.enterInner(s[l],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(n=this.enterInner(a,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let l=Et.none;for(let c of s.concat(e.marks))(a.type?a.type.allowsMarkType(c.type):ek(c.type,e.type))&&(l=c.addToSet(l));return a.content.push(e.mark(l)),!0}return!1}enter(e,n,r,s){let a=this.findPlace(e.create(n),r,!1);return a&&(a=this.enterInner(e,n,r,!0,s)),a}enterInner(e,n,r,s=!1,a){this.closeExtra();let l=this.top;l.match=l.match&&l.match.matchType(e);let c=X2(e,a,l.options);l.options&Lc&&l.content.length==0&&(c|=Lc);let d=Et.none;return r=r.filter(p=>(l.type?l.type.allowsMarkType(p.type):ek(p.type,e))?(d=p.addToSet(d),!1):!0),this.nodes.push(new Wd(e,n,d,s,null,c)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=eu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(s?0:1),l=(c,d)=>{for(;c>=0;c--){let p=n[c];if(p==""){if(c==n.length-1||c==0)continue;for(;d>=a;d--)if(l(c-1,d))return!0;return!1}else{let m=d>0||d==0&&s?this.nodes[d].type:r&&d>=a?r.node(d-a).type:null;if(!m||m.name!=p&&!m.isInGroup(p))return!1;d--}}return!0};return l(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function O6(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&hN.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function j6(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Z2(t){let e={};for(let n in t)e[n]=t[n];return e}function ek(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let a=[],l=c=>{a.push(c);for(let d=0;d<c.edgeCount;d++){let{type:p,next:m}=c.edge(d);if(p==e||a.indexOf(m)<0&&l(m))return!0}};if(l(s.contentMatch))return!0}}class no{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Ug(n).createDocumentFragment());let s=r,a=[];return e.forEach(l=>{if(a.length||l.marks.length){let c=0,d=0;for(;c<a.length&&d<l.marks.length;){let p=l.marks[d];if(!this.marks[p.type.name]){d++;continue}if(!p.eq(a[c][0])||p.type.spec.spanning===!1)break;c++,d++}for(;c<a.length;)s=a.pop()[1];for(;d<l.marks.length;){let p=l.marks[d++],m=this.serializeMark(p,l.isInline,n);m&&(a.push([p,s]),s.appendChild(m.dom),s=m.contentDOM||m.dom)}}s.appendChild(this.serializeNodeInner(l,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=gf(Ug(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let a=this.serializeMark(e.marks[s],e.isInline,n);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&gf(Ug(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return gf(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new no(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=tk(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return tk(e.marks)}}function tk(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Ug(t){return t.document||window.document}const nk=new WeakMap;function _6(t){let e=nk.get(t);return e===void 0&&nk.set(t,e=R6(t)),e}function R6(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function gf(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],a;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(a=_6(r))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=s.indexOf(" ");l>0&&(n=s.slice(0,l),s=s.slice(l+1));let c,d=n?t.createElementNS(n,s):t.createElement(s),p=e[1],m=1;if(p&&typeof p=="object"&&p.nodeType==null&&!Array.isArray(p)){m=2;for(let g in p)if(p[g]!=null){let b=g.indexOf(" ");b>0?d.setAttributeNS(g.slice(0,b),g.slice(b+1),p[g]):g=="style"&&d.style?d.style.cssText=p[g]:d.setAttribute(g,p[g])}}for(let g=m;g<e.length;g++){let b=e[g];if(b===0){if(g<e.length-1||g>m)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:v,contentDOM:w}=gf(t,b,n,r);if(d.appendChild(v),w){if(c)throw new RangeError("Multiple content holes");c=w}}}return{dom:d,contentDOM:c}}const pN=65535,mN=Math.pow(2,16);function D6(t,e){return t+e*mN}function rk(t){return t&pN}function L6(t){return(t-(t&pN))/mN}const gN=1,xN=2,xf=4,bN=8;class lx{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&bN)>0}get deletedBefore(){return(this.delInfo&(gN|xf))>0}get deletedAfter(){return(this.delInfo&(xN|xf))>0}get deletedAcross(){return(this.delInfo&xf)>0}}class gr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&gr.empty)return gr.empty}recover(e){let n=0,r=rk(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+L6(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?s:0);if(d>e)break;let p=this.ranges[c+a],m=this.ranges[c+l],g=d+p;if(e<=g){let b=p?e==d?-1:e==g?1:n:n,v=d+s+(b<0?0:m);if(r)return v;let w=e==(n<0?d:g)?null:D6(c/3,e-d),C=e==d?xN:e==g?gN:xf;return(n<0?e!=d:e!=g)&&(C|=bN),new lx(v,C,w)}s+=m-p}return r?e+s:new lx(e+s,0,null)}touches(e,n){let r=0,s=rk(n),a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?r:0);if(d>e)break;let p=this.ranges[c+a],m=d+p;if(e<=m&&c==s*3)return!0;r+=this.ranges[c+l]-p}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let l=this.ranges[s],c=l-(this.inverted?a:0),d=l+(this.inverted?0:a),p=this.ranges[s+n],m=this.ranges[s+r];e(c,c+p,d,d+m),a+=m-p}}invert(){return new gr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?gr.empty:new gr(e<0?[0,-e,0]:[0,0,e])}}gr.empty=new gr([]);class tu{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new tu(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new tu;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let a=this.from;a<this.to;a++){let l=this._maps[a],c=l.mapResult(e,n);if(c.recover!=null){let d=this.getMirror(a);if(d!=null&&d>a&&d<this.to){a=d,e=this._maps[d].recover(c.recover);continue}}s|=c.delInfo,e=c.pos}return r?e:new lx(e,s,null)}}const $g=Object.create(null);class Bn{getMap(){return gr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=$g[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in $g)throw new RangeError("Duplicate use of step JSON ID "+e);return $g[e]=n,n.prototype.jsonID=e,n}}class rn{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new rn(e,null)}static fail(e){return new rn(null,e)}static fromReplace(e,n,r,s){try{return rn.ok(e.replace(n,r,s))}catch(a){if(a instanceof Ff)return rn.fail(a.message);throw a}}}function pb(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let a=t.child(s);a.content.size&&(a=a.copy(pb(a.content,e,a))),a.isInline&&(a=e(a,n,s)),r.push(a)}return fe.fromArray(r)}class Vi extends Bn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),a=new Ne(pb(n.content,(l,c)=>!l.isAtom||!c.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),s),n.openStart,n.openEnd);return rn.fromReplace(e,this.from,this.to,a)}invert(){return new Fr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Vi(n.pos,r.pos,this.mark)}merge(e){return e instanceof Vi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Vi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Vi(n.from,n.to,e.markFromJSON(n.mark))}}Bn.jsonID("addMark",Vi);class Fr extends Bn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new Ne(pb(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return rn.fromReplace(e,this.from,this.to,r)}invert(){return new Vi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Fr(n.pos,r.pos,this.mark)}merge(e){return e instanceof Fr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Fr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Fr(n.from,n.to,e.markFromJSON(n.mark))}}Bn.jsonID("removeMark",Fr);class qi extends Bn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return rn.fromReplace(e,this.pos,this.pos+1,new Ne(fe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new qi(this.pos,n.marks[s]);return new qi(this.pos,this.mark)}}return new Ga(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new qi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new qi(n.pos,e.markFromJSON(n.mark))}}Bn.jsonID("addNodeMark",qi);class Ga extends Bn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return rn.fromReplace(e,this.pos,this.pos+1,new Ne(fe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new qi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ga(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ga(n.pos,e.markFromJSON(n.mark))}}Bn.jsonID("removeNodeMark",Ga);class bn extends Bn{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&cx(e,this.from,this.to)?rn.fail("Structure replace would overwrite content"):rn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new gr([this.from,this.to-this.from,this.slice.size])}invert(e){return new bn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new bn(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof bn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?Ne.empty:new Ne(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new bn(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?Ne.empty:new Ne(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new bn(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new bn(n.from,n.to,Ne.fromJSON(e,n.slice),!!n.structure)}}Bn.jsonID("replace",bn);class vn extends Bn{constructor(e,n,r,s,a,l,c=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=a,this.insert=l,this.structure=c}apply(e){if(this.structure&&(cx(e,this.from,this.gapFrom)||cx(e,this.gapTo,this.to)))return rn.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return rn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?rn.fromReplace(e,this.from,this.to,r):rn.fail("Content does not fit in gap")}getMap(){return new gr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new vn(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||a>r.pos?null:new vn(n.pos,r.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new vn(n.from,n.to,n.gapFrom,n.gapTo,Ne.fromJSON(e,n.slice),n.insert,!!n.structure)}}Bn.jsonID("replaceAround",vn);function cx(t,e,n){let r=t.resolve(e),s=n-e,a=r.depth;for(;s>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,s--;if(s>0){let l=r.node(a).maybeChild(r.indexAfter(a));for(;s>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,s--}}return!1}function I6(t,e,n,r){let s=[],a=[],l,c;t.doc.nodesBetween(e,n,(d,p,m)=>{if(!d.isInline)return;let g=d.marks;if(!r.isInSet(g)&&m.type.allowsMarkType(r.type)){let b=Math.max(p,e),v=Math.min(p+d.nodeSize,n),w=r.addToSet(g);for(let C=0;C<g.length;C++)g[C].isInSet(w)||(l&&l.to==b&&l.mark.eq(g[C])?l.to=v:s.push(l=new Fr(b,v,g[C])));c&&c.to==b?c.to=v:a.push(c=new Vi(b,v,r))}}),s.forEach(d=>t.step(d)),a.forEach(d=>t.step(d))}function z6(t,e,n,r){let s=[],a=0;t.doc.nodesBetween(e,n,(l,c)=>{if(!l.isInline)return;a++;let d=null;if(r instanceof Xh){let p=l.marks,m;for(;m=r.isInSet(p);)(d||(d=[])).push(m),p=m.removeFromSet(p)}else r?r.isInSet(l.marks)&&(d=[r]):d=l.marks;if(d&&d.length){let p=Math.min(c+l.nodeSize,n);for(let m=0;m<d.length;m++){let g=d[m],b;for(let v=0;v<s.length;v++){let w=s[v];w.step==a-1&&g.eq(s[v].style)&&(b=w)}b?(b.to=p,b.step=a):s.push({style:g,from:Math.max(c,e),to:p,step:a})}}}),s.forEach(l=>t.step(new Fr(l.from,l.to,l.style)))}function mb(t,e,n,r=n.contentMatch,s=!0){let a=t.doc.nodeAt(e),l=[],c=e+1;for(let d=0;d<a.childCount;d++){let p=a.child(d),m=c+p.nodeSize,g=r.matchType(p.type);if(!g)l.push(new bn(c,m,Ne.empty));else{r=g;for(let b=0;b<p.marks.length;b++)n.allowsMarkType(p.marks[b].type)||t.step(new Fr(c,m,p.marks[b]));if(s&&p.isText&&n.whitespace!="pre"){let b,v=/\r?\n|\r/g,w;for(;b=v.exec(p.text);)w||(w=new Ne(fe.from(n.schema.text(" ",n.allowedMarks(p.marks))),0,0)),l.push(new bn(c+b.index,c+b.index+b[0].length,w))}}c=m}if(!r.validEnd){let d=r.fillBefore(fe.empty,!0);t.replace(c,c,new Ne(d,0,0))}for(let d=l.length-1;d>=0;d--)t.step(l[d])}function B6(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function vl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,a=0;;--r){let l=t.$from.node(r),c=t.$from.index(r)+s,d=t.$to.indexAfter(r)-a;if(r<t.depth&&l.canReplace(c,d,n))return r;if(r==0||l.type.spec.isolating||!B6(l,c,d))break;c&&(s=1),d<l.childCount&&(a=1)}return null}function P6(t,e,n){let{$from:r,$to:s,depth:a}=e,l=r.before(a+1),c=s.after(a+1),d=l,p=c,m=fe.empty,g=0;for(let w=a,C=!1;w>n;w--)C||r.index(w)>0?(C=!0,m=fe.from(r.node(w).copy(m)),g++):d--;let b=fe.empty,v=0;for(let w=a,C=!1;w>n;w--)C||s.after(w+1)<s.end(w)?(C=!0,b=fe.from(s.node(w).copy(b)),v++):p++;t.step(new vn(d,p,l,c,new Ne(m.append(b),g,v),m.size-g,!0))}function gb(t,e,n=null,r=t){let s=H6(t,e),a=s&&F6(r,e);return a?s.map(sk).concat({type:e,attrs:n}).concat(a.map(sk)):null}function sk(t){return{type:t,attrs:null}}function H6(t,e){let{parent:n,startIndex:r,endIndex:s}=t,a=n.contentMatchAt(r).findWrapping(e);if(!a)return null;let l=a.length?a[0]:e;return n.canReplaceWith(r,s,l)?a:null}function F6(t,e){let{parent:n,startIndex:r,endIndex:s}=t,a=n.child(r),l=e.contentMatch.findWrapping(a.type);if(!l)return null;let d=(l.length?l[l.length-1]:e).contentMatch;for(let p=r;d&&p<s;p++)d=d.matchType(n.child(p).type);return!d||!d.validEnd?null:l}function U6(t,e,n){let r=fe.empty;for(let l=n.length-1;l>=0;l--){if(r.size){let c=n[l].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=fe.from(n[l].type.create(n[l].attrs,r))}let s=e.start,a=e.end;t.step(new vn(s,a,s,a,new Ne(r,0,0),n.length,!0))}function $6(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,n,(l,c)=>{let d=typeof s=="function"?s(l):s;if(l.isTextblock&&!l.hasMarkup(r,d)&&V6(t.doc,t.mapping.slice(a).map(c),r)){let p=null;if(r.schema.linebreakReplacement){let v=r.whitespace=="pre",w=!!r.contentMatch.matchType(r.schema.linebreakReplacement);v&&!w?p=!1:!v&&w&&(p=!0)}p===!1&&vN(t,l,c,a),mb(t,t.mapping.slice(a).map(c,1),r,void 0,p===null);let m=t.mapping.slice(a),g=m.map(c,1),b=m.map(c+l.nodeSize,1);return t.step(new vn(g,b,g+1,b-1,new Ne(fe.from(r.create(d,null,l.marks)),0,0),1,!0)),p===!0&&yN(t,l,c,a),!1}})}function yN(t,e,n,r){e.forEach((s,a)=>{if(s.isText){let l,c=/\r?\n|\r/g;for(;l=c.exec(s.text);){let d=t.mapping.slice(r).map(n+1+a+l.index);t.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function vN(t,e,n,r){e.forEach((s,a)=>{if(s.type==s.type.schema.linebreakReplacement){let l=t.mapping.slice(r).map(n+1+a);t.replaceWith(l,l+1,e.type.schema.text(`
`))}})}function V6(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function q6(t,e,n,r,s){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");n||(n=a.type);let l=n.create(r,null,s||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,l);if(!n.validContent(a.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new vn(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new Ne(fe.from(l),0,0),1,!0))}function Gs(t,e,n=1,r){let s=t.resolve(e),a=s.depth-n,l=r&&r[r.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!l.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let p=s.depth-1,m=n-2;p>a;p--,m--){let g=s.node(p),b=s.index(p);if(g.type.spec.isolating)return!1;let v=g.content.cutByIndex(b,g.childCount),w=r&&r[m+1];w&&(v=v.replaceChild(0,w.type.create(w.attrs)));let C=r&&r[m]||g;if(!g.canReplace(b+1,g.childCount)||!C.type.validContent(v))return!1}let c=s.indexAfter(a),d=r&&r[0];return s.node(a).canReplaceWith(c,c,d?d.type:s.node(a+1).type)}function W6(t,e,n=1,r){let s=t.doc.resolve(e),a=fe.empty,l=fe.empty;for(let c=s.depth,d=s.depth-n,p=n-1;c>d;c--,p--){a=fe.from(s.node(c).copy(a));let m=r&&r[p];l=fe.from(m?m.type.create(m.attrs,l):s.node(c).copy(l))}t.step(new bn(e,e,new Ne(a.append(l),n,n),!0))}function ea(t,e){let n=t.resolve(e),r=n.index();return wN(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function K6(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let a=e.child(s),l=a.type==r?t.type.schema.nodes.text:a.type;if(n=n.matchType(l),!n||!t.type.allowsMarks(a.marks))return!1}return n.validEnd}function wN(t,e){return!!(t&&e&&!t.isLeaf&&K6(t,e))}function Qh(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let a,l,c=r.index(s);if(s==r.depth?(a=r.nodeBefore,l=r.nodeAfter):n>0?(a=r.node(s+1),c++,l=r.node(s).maybeChild(c)):(a=r.node(s).maybeChild(c-1),l=r.node(s+1)),a&&!a.isTextblock&&wN(a,l)&&r.node(s).canReplace(c,c+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function G6(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,a=t.doc.resolve(e-n),l=a.node().type;if(s&&l.inlineContent){let m=l.whitespace=="pre",g=!!l.contentMatch.matchType(s);m&&!g?r=!1:!m&&g&&(r=!0)}let c=t.steps.length;if(r===!1){let m=t.doc.resolve(e+n);vN(t,m.node(),m.before(),c)}l.inlineContent&&mb(t,e+n-1,l,a.node().contentMatchAt(a.index()),r==null);let d=t.mapping.slice(c),p=d.map(e-n);if(t.step(new bn(p,d.map(e+n,-1),Ne.empty,!0)),r===!0){let m=t.doc.resolve(p);yN(t,m.node(),m.before(),t.steps.length)}return t}function Y6(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let a=r.index(s);if(r.node(s).canReplaceWith(a,a,n))return r.before(s+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}return null}function kN(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let a=0;a<n.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(n.openStart==0&&n.size?2:1);a++)for(let l=r.depth;l>=0;l--){let c=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,d=r.index(l)+(c>0?1:0),p=r.node(l),m=!1;if(a==1)m=p.canReplace(d,d,s);else{let g=p.contentMatchAt(d).findWrapping(s.firstChild.type);m=g&&p.canReplaceWith(d,d,g[0])}if(m)return c==0?r.pos:c<0?r.before(l+1):r.after(l+1)}return null}function Zh(t,e,n=e,r=Ne.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),a=t.resolve(n);return CN(s,a,r)?new bn(e,n,r):new J6(s,a,r).fit()}function CN(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class J6{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=fe.empty;for(let s=0;s<=e.depth;s++){let a=e.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=fe.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let p=this.findFittable();p?this.placeNodes(p):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let a=this.placed,l=r.depth,c=s.depth;for(;l&&c&&a.childCount==1;)a=a.firstChild.content,l--,c--;let d=new Ne(a,l,c);return e>-1?new vn(r.pos,e,this.$to.pos,this.$to.end(),d,n):d.size||r.pos!=this.$to.pos?new bn(r.pos,s.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let a=n.firstChild;if(n.childCount>1&&(s=0),a.type.spec.isolating&&s<=r){e=r;break}n=a.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,a=null;r?(a=Vg(this.unplaced.content,r-1).firstChild,s=a.content):s=this.unplaced.content;let l=s.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:p}=this.frontier[c],m,g=null;if(n==1&&(l?p.matchType(l.type)||(g=p.fillBefore(fe.from(l),!1)):a&&d.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:c,parent:a,inject:g};if(n==2&&l&&(m=p.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:c,parent:a,wrap:m};if(a&&p.matchType(a.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Vg(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Ne(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Vg(e,n);if(s.childCount<=1&&n>0){let a=e.size-n<=n+s.size;this.unplaced=new Ne(Sc(e,n-1,1),n-1,a?n-1:r)}else this.unplaced=new Ne(Sc(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:a}){for(;this.depth>n;)this.closeFrontierNode();if(a)for(let C=0;C<a.length;C++)this.openFrontierNode(a[C]);let l=this.unplaced,c=r?r.content:l.content,d=l.openStart-e,p=0,m=[],{match:g,type:b}=this.frontier[n];if(s){for(let C=0;C<s.childCount;C++)m.push(s.child(C));g=g.matchFragment(s)}let v=c.size+e-(l.content.size-l.openEnd);for(;p<c.childCount;){let C=c.child(p),k=g.matchType(C.type);if(!k)break;p++,(p>1||d==0||C.content.size)&&(g=k,m.push(SN(C.mark(b.allowedMarks(C.marks)),p==1?d:0,p==c.childCount?v:-1)))}let w=p==c.childCount;w||(v=-1),this.placed=Ec(this.placed,n,fe.from(m)),this.frontier[n].match=g,w&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let C=0,k=c;C<v;C++){let N=k.lastChild;this.frontier.push({type:N.type,match:N.contentMatchAt(N.childCount)}),k=N.content}this.unplaced=w?e==0?Ne.empty:new Ne(Sc(l.content,e-1,1),e-1,v<0?l.openEnd:e-1):new Ne(Sc(l.content,e,p),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!qg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],a=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),l=qg(e,n,s,r,a);if(l){for(let c=n-1;c>=0;c--){let{match:d,type:p}=this.frontier[c],m=qg(e,c,p,d,!0);if(!m||m.childCount)continue e}return{depth:n,fit:l,move:a?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Ec(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),a=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,a)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Ec(this.placed,this.depth,fe.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(fe.empty,!0);n.childCount&&(this.placed=Ec(this.placed,this.frontier.length,n))}}function Sc(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Sc(t.firstChild.content,e-1,n)))}function Ec(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Ec(t.lastChild.content,e-1,n)))}function Vg(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function SN(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,SN(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(fe.empty,!0)))),t.copy(r)}function qg(t,e,n,r,s){let a=t.node(e),l=s?t.indexAfter(e):t.index(e);if(l==a.childCount&&!n.compatibleContent(a.type))return null;let c=r.fillBefore(a.content,!0,l);return c&&!X6(n,a.content,l)?c:null}function X6(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function Q6(t){return t.spec.defining||t.spec.definingForContent}function Z6(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),a=t.doc.resolve(n);if(CN(s,a,r))return t.step(new bn(e,n,r));let l=NN(s,a);l[l.length-1]==0&&l.pop();let c=-(s.depth+1);l.unshift(c);for(let b=s.depth,v=s.pos-1;b>0;b--,v--){let w=s.node(b).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;l.indexOf(b)>-1?c=b:s.before(b)==v&&l.splice(1,0,-b)}let d=l.indexOf(c),p=[],m=r.openStart;for(let b=r.content,v=0;;v++){let w=b.firstChild;if(p.push(w),v==r.openStart)break;b=w.content}for(let b=m-1;b>=0;b--){let v=p[b],w=Q6(v.type);if(w&&!v.sameMarkup(s.node(Math.abs(c)-1)))m=b;else if(w||!v.type.isTextblock)break}for(let b=r.openStart;b>=0;b--){let v=(b+m+1)%(r.openStart+1),w=p[v];if(w)for(let C=0;C<l.length;C++){let k=l[(C+d)%l.length],N=!0;k<0&&(N=!1,k=-k);let M=s.node(k-1),_=s.index(k-1);if(M.canReplaceWith(_,_,w.type,w.marks))return t.replace(s.before(k),N?a.after(k):n,new Ne(EN(r.content,0,r.openStart,v),v,r.openEnd))}}let g=t.steps.length;for(let b=l.length-1;b>=0&&(t.replace(e,n,r),!(t.steps.length>g));b--){let v=l[b];v<0||(e=s.before(v),n=a.after(v))}}function EN(t,e,n,r,s){if(e<n){let a=t.firstChild;t=t.replaceChild(0,a.copy(EN(a.content,e+1,n,r,a)))}if(e>r){let a=s.contentMatchAt(0),l=a.fillBefore(t).append(t);t=l.append(a.matchFragment(l).fillBefore(fe.empty,!0))}return t}function eL(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=Y6(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new Ne(fe.from(r),0,0))}function tL(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),a=NN(r,s);for(let l=0;l<a.length;l++){let c=a[l],d=l==a.length-1;if(d&&c==0||r.node(c).type.contentMatch.validEnd)return t.delete(r.start(c),s.end(c));if(c>0&&(d||r.node(c-1).canReplace(r.index(c-1),s.indexAfter(c-1))))return t.delete(r.before(c),s.after(c))}for(let l=1;l<=r.depth&&l<=s.depth;l++)if(e-r.start(l)==r.depth-l&&n>r.end(l)&&s.end(l)-n!=s.depth-l&&r.start(l-1)==s.start(l-1)&&r.node(l-1).canReplace(r.index(l-1),s.index(l-1)))return t.delete(r.before(l),n);t.delete(e,n)}function NN(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let a=t.start(s);if(a<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(a==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==a-1)&&n.push(s)}return n}class Jo extends Bn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at attribute step's position");let r=Object.create(null);for(let a in n.attrs)r[a]=n.attrs[a];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return rn.fromReplace(e,this.pos,this.pos+1,new Ne(fe.from(s),0,n.isLeaf?0:1))}getMap(){return gr.empty}invert(e){return new Jo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Jo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Jo(n.pos,n.attr,n.value)}}Bn.jsonID("attr",Jo);class nu extends Bn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return rn.ok(r)}getMap(){return gr.empty}invert(e){return new nu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new nu(n.attr,n.value)}}Bn.jsonID("docAttr",nu);let al=class extends Error{};al=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};al.prototype=Object.create(Error.prototype);al.prototype.constructor=al;al.prototype.name="TransformError";class xb{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new tu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new al(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let s=this.mapping.maps[r];r&&(e=s.map(e,1),n=s.map(n,-1)),s.forEach((a,l,c,d)=>{e=Math.min(e,c),n=Math.max(n,d)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=Ne.empty){let s=Zh(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new Ne(fe.from(r),0,0))}delete(e,n){return this.replace(e,n,Ne.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return Z6(this,e,n,r),this}replaceRangeWith(e,n,r){return eL(this,e,n,r),this}deleteRange(e,n){return tL(this,e,n),this}lift(e,n){return P6(this,e,n),this}join(e,n=1){return G6(this,e,n),this}wrap(e,n){return U6(this,e,n),this}setBlockType(e,n=e,r,s=null){return $6(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return q6(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Jo(e,n,r)),this}setDocAttribute(e,n){return this.step(new nu(e,n)),this}addNodeMark(e,n){return this.step(new qi(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Et)n.isInSet(r.marks)&&this.step(new Ga(e,n));else{let s=r.marks,a,l=[];for(;a=n.isInSet(s);)l.push(new Ga(e,a)),s=a.removeFromSet(s);for(let c=l.length-1;c>=0;c--)this.step(l[c])}return this}split(e,n=1,r){return W6(this,e,n,r),this}addMark(e,n,r){return I6(this,e,n,r),this}removeMark(e,n,r){return z6(this,e,n,r),this}clearIncompatible(e,n,r){return mb(this,e,n,r),this}}const Wg=Object.create(null);class $e{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new TN(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=Ne.empty){let r=n.content.lastChild,s=null;for(let c=0;c<n.openEnd;c++)s=r,r=r.lastChild;let a=e.steps.length,l=this.ranges;for(let c=0;c<l.length;c++){let{$from:d,$to:p}=l[c],m=e.mapping.slice(a);e.replaceRange(m.map(d.pos),m.map(p.pos),c?Ne.empty:n),c==0&&ok(e,a,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=e.mapping.slice(r),p=d.map(l.pos),m=d.map(c.pos);a?e.deleteRange(p,m):(e.replaceRangeWith(p,m,n),ok(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new Be(e):Uo(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let a=e.depth-1;a>=0;a--){let l=n<0?Uo(e.node(0),e.node(a),e.before(a+1),e.index(a),n,r):Uo(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,n,r);if(l)return l}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new br(e.node(0))}static atStart(e){return Uo(e,e,0,0,1)||new br(e)}static atEnd(e){return Uo(e,e,e.content.size,e.childCount,-1)||new br(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Wg[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Wg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Wg[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Be.between(this.$anchor,this.$head).getBookmark()}}$e.prototype.visible=!0;class TN{constructor(e,n){this.$from=e,this.$to=n}}let ik=!1;function ak(t){!ik&&!t.parent.inlineContent&&(ik=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Be extends $e{constructor(e,n=e){ak(e),ak(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return $e.near(r);let s=e.resolve(n.map(this.anchor));return new Be(s.parent.inlineContent?s:r,r)}replace(e,n=Ne.empty){if(super.replace(e,n),n==Ne.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Be&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ep(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Be(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let a=$e.findFrom(n,r,!0)||$e.findFrom(n,-r,!0);if(a)n=a.$head;else return $e.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=($e.findFrom(e,-r,!0)||$e.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new Be(e,n)}}$e.jsonID("text",Be);class ep{constructor(e,n){this.anchor=e,this.head=n}map(e){return new ep(e.map(this.anchor),e.map(this.head))}resolve(e){return Be.between(e.resolve(this.anchor),e.resolve(this.head))}}class ze extends $e{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),a=e.resolve(s);return r?$e.near(a):new ze(a)}content(){return new Ne(fe.from(this.node),0,0)}eq(e){return e instanceof ze&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new bb(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ze(e.resolve(n.anchor))}static create(e,n){return new ze(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ze.prototype.visible=!1;$e.jsonID("node",ze);class bb{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new ep(r,r):new bb(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ze.isSelectable(r)?new ze(n):$e.near(n)}}class br extends $e{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=Ne.empty){if(n==Ne.empty){e.delete(0,e.doc.content.size);let r=$e.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new br(e)}map(e){return new br(e)}eq(e){return e instanceof br}getBookmark(){return nL}}$e.jsonID("all",br);const nL={map(){return this},resolve(t){return new br(t)}};function Uo(t,e,n,r,s,a=!1){if(e.inlineContent)return Be.create(t,n);for(let l=r-(s>0?0:1);s>0?l<e.childCount:l>=0;l+=s){let c=e.child(l);if(c.isAtom){if(!a&&ze.isSelectable(c))return ze.create(t,n-(s<0?c.nodeSize:0))}else{let d=Uo(t,c,n+s,s<0?c.childCount:0,s,a);if(d)return d}n+=c.nodeSize*s}return null}function ok(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof bn||s instanceof vn))return;let a=t.mapping.maps[r],l;a.forEach((c,d,p,m)=>{l==null&&(l=m)}),t.setSelection($e.near(t.doc.resolve(l),n))}const lk=1,Kd=2,ck=4;class rL extends xb{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|lk)&~Kd,this.storedMarks=null,this}get selectionSet(){return(this.updated&lk)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Kd,this}ensureMarks(e){return Et.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Kd)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Kd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Et.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let a=this.storedMarks;if(!a){let l=this.doc.resolve(n);a=r==n?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,a)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection($e.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ck,this}get scrolledIntoView(){return(this.updated&ck)>0}}function uk(t,e){return!e||!t?t:t.bind(e)}class Nc{constructor(e,n,r){this.name=e,this.init=uk(n.init,r),this.apply=uk(n.apply,r)}}const sL=[new Nc("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Nc("selection",{init(t,e){return t.selection||$e.atStart(e.doc)},apply(t){return t.selection}}),new Nc("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Nc("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Kg{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=sL.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Nc(r.key,r.spec.state,r))})}}class Ko{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let a=!1;for(let l=0;l<this.config.plugins.length;l++){let c=this.config.plugins[l];if(c.spec.appendTransaction){let d=s?s[l].n:0,p=s?s[l].state:this,m=d<n.length&&c.spec.appendTransaction.call(c,d?n.slice(d):n,p,r);if(m&&r.filterTransaction(m,l)){if(m.setMeta("appendedTransaction",e),!s){s=[];for(let g=0;g<this.config.plugins.length;g++)s.push(g<l?{state:r,n:n.length}:{state:this,n:0})}n.push(m),r=r.applyInner(m),a=!0}s&&(s[l]={state:r,n:n.length})}}if(!a)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Ko(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let a=r[s];n[a.name]=a.apply(e,this[a.name],this,n)}return n}get tr(){return new rL(this)}static create(e){let n=new Kg(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ko(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new Kg(this.schema,e.plugins),r=n.fields,s=new Ko(n);for(let a=0;a<r.length;a++){let l=r[a].name;s[l]=this.hasOwnProperty(l)?this[l]:r[a].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],a=s.spec.state;a&&a.toJSON&&(n[r]=a.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Kg(e.schema,e.plugins),a=new Ko(s);return s.fields.forEach(l=>{if(l.name=="doc")a.doc=$r.fromJSON(e.schema,n.doc);else if(l.name=="selection")a.selection=$e.fromJSON(a.doc,n.selection);else if(l.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let c in r){let d=r[c],p=d.spec.state;if(d.key==l.name&&p&&p.fromJSON&&Object.prototype.hasOwnProperty.call(n,c)){a[l.name]=p.fromJSON.call(d,e,n[c],a);return}}a[l.name]=l.init(e,a)}}),a}}function AN(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=AN(s,e,{})),n[r]=s}return n}class Rt{constructor(e){this.spec=e,this.props={},e.props&&AN(e.props,this,this.props),this.key=e.key?e.key.key:MN("plugin")}getState(e){return e[this.key]}}const Gg=Object.create(null);function MN(t){return t in Gg?t+"$"+ ++Gg[t]:(Gg[t]=0,t+"$")}class Wt{constructor(e="key"){this.key=MN(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const yb=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function ON(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const jN=(t,e,n)=>{let r=ON(t,n);if(!r)return!1;let s=vb(r);if(!s){let l=r.blockRange(),c=l&&vl(l);return c==null?!1:(e&&e(t.tr.lift(l,c).scrollIntoView()),!0)}let a=s.nodeBefore;if(HN(t,s,e,-1))return!0;if(r.parent.content.size==0&&(ol(a,"end")||ze.isSelectable(a)))for(let l=r.depth;;l--){let c=Zh(t.doc,r.before(l),r.after(l),Ne.empty);if(c&&c.slice.size<c.to-c.from){if(e){let d=t.tr.step(c);d.setSelection(ol(a,"end")?$e.findFrom(d.doc.resolve(d.mapping.map(s.pos,-1)),-1):ze.create(d.doc,s.pos-a.nodeSize)),e(d.scrollIntoView())}return!0}if(l==1||r.node(l-1).childCount>1)break}return a.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1},iL=(t,e,n)=>{let r=ON(t,n);if(!r)return!1;let s=vb(r);return s?_N(t,s,e):!1},aL=(t,e,n)=>{let r=DN(t,n);if(!r)return!1;let s=wb(r);return s?_N(t,s,e):!1};function _N(t,e,n){let r=e.nodeBefore,s=r,a=e.pos-1;for(;!s.isTextblock;a--){if(s.type.spec.isolating)return!1;let m=s.lastChild;if(!m)return!1;s=m}let l=e.nodeAfter,c=l,d=e.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let m=c.firstChild;if(!m)return!1;c=m}let p=Zh(t.doc,a,d,Ne.empty);if(!p||p.from!=a||p instanceof bn&&p.slice.size>=d-a)return!1;if(n){let m=t.tr.step(p);m.setSelection(Be.create(m.doc,a)),n(m.scrollIntoView())}return!0}function ol(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const RN=(t,e,n)=>{let{$head:r,empty:s}=t.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;a=vb(r)}let l=a&&a.nodeBefore;return!l||!ze.isSelectable(l)?!1:(e&&e(t.tr.setSelection(ze.create(t.doc,a.pos-l.nodeSize)).scrollIntoView()),!0)};function vb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function DN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const LN=(t,e,n)=>{let r=DN(t,n);if(!r)return!1;let s=wb(r);if(!s)return!1;let a=s.nodeAfter;if(HN(t,s,e,1))return!0;if(r.parent.content.size==0&&(ol(a,"start")||ze.isSelectable(a))){let l=Zh(t.doc,r.before(),r.after(),Ne.empty);if(l&&l.slice.size<l.to-l.from){if(e){let c=t.tr.step(l);c.setSelection(ol(a,"start")?$e.findFrom(c.doc.resolve(c.mapping.map(s.pos)),1):ze.create(c.doc,c.mapping.map(s.pos))),e(c.scrollIntoView())}return!0}}return a.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},IN=(t,e,n)=>{let{$head:r,empty:s}=t.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;a=wb(r)}let l=a&&a.nodeAfter;return!l||!ze.isSelectable(l)?!1:(e&&e(t.tr.setSelection(ze.create(t.doc,a.pos)).scrollIntoView()),!0)};function wb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const oL=(t,e)=>{let n=t.selection,r=n instanceof ze,s;if(r){if(n.node.isTextblock||!ea(t.doc,n.from))return!1;s=n.from}else if(s=Qh(t.doc,n.from,-1),s==null)return!1;if(e){let a=t.tr.join(s);r&&a.setSelection(ze.create(a.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},lL=(t,e)=>{let n=t.selection,r;if(n instanceof ze){if(n.node.isTextblock||!ea(t.doc,n.to))return!1;r=n.to}else if(r=Qh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},cL=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),a=s&&vl(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)},zN=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function kb(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const uL=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),a=n.indexAfter(-1),l=kb(s.contentMatchAt(a));if(!l||!s.canReplaceWith(a,a,l))return!1;if(e){let c=n.after(),d=t.tr.replaceWith(c,c,l.createAndFill());d.setSelection($e.near(d.doc.resolve(c),1)),e(d.scrollIntoView())}return!0},BN=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof br||r.parent.inlineContent||s.parent.inlineContent)return!1;let a=kb(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let l=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,c=t.tr.insert(l,a.createAndFill());c.setSelection(Be.create(c.doc,l+1)),e(c.scrollIntoView())}return!0},PN=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if(Gs(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let r=n.blockRange(),s=r&&vl(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function dL(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof ze&&e.selection.node.isBlock)return!r.parentOffset||!Gs(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let a=[],l,c,d=!1,p=!1;for(let v=r.depth;;v--)if(r.node(v).isBlock){d=r.end(v)==r.pos+(r.depth-v),p=r.start(v)==r.pos-(r.depth-v),c=kb(r.node(v-1).contentMatchAt(r.indexAfter(v-1))),a.unshift(d&&c?{type:c}:null),l=v;break}else{if(v==1)return!1;a.unshift(null)}let m=e.tr;(e.selection instanceof Be||e.selection instanceof br)&&m.deleteSelection();let g=m.mapping.map(r.pos),b=Gs(m.doc,g,a.length,a);if(b||(a[0]=c?{type:c}:null,b=Gs(m.doc,g,a.length,a)),!b)return!1;if(m.split(g,a.length,a),!d&&p&&r.node(l).type!=c){let v=m.mapping.map(r.before(l)),w=m.doc.resolve(v);c&&r.node(l-1).canReplaceWith(w.index(),w.index()+1,c)&&m.setNodeMarkup(m.mapping.map(r.before(l)),c)}return n&&n(m.scrollIntoView()),!0}}const fL=dL(),hL=(t,e)=>{let{$from:n,to:r}=t.selection,s,a=n.sharedDepth(r);return a==0?!1:(s=n.before(a),e&&e(t.tr.setSelection(ze.create(t.doc,s))),!0)};function pL(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,a=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(a-1,a)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(s.isTextblock||ea(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function HN(t,e,n,r){let s=e.nodeBefore,a=e.nodeAfter,l,c,d=s.type.spec.isolating||a.type.spec.isolating;if(!d&&pL(t,e,n))return!0;let p=!d&&e.parent.canReplace(e.index(),e.index()+1);if(p&&(l=(c=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&c.matchType(l[0]||a.type).validEnd){if(n){let v=e.pos+a.nodeSize,w=fe.empty;for(let N=l.length-1;N>=0;N--)w=fe.from(l[N].create(null,w));w=fe.from(s.copy(w));let C=t.tr.step(new vn(e.pos-1,v,e.pos,v,new Ne(w,1,0),l.length,!0)),k=C.doc.resolve(v+2*l.length);k.nodeAfter&&k.nodeAfter.type==s.type&&ea(C.doc,k.pos)&&C.join(k.pos),n(C.scrollIntoView())}return!0}let m=a.type.spec.isolating||r>0&&d?null:$e.findFrom(e,1),g=m&&m.$from.blockRange(m.$to),b=g&&vl(g);if(b!=null&&b>=e.depth)return n&&n(t.tr.lift(g,b).scrollIntoView()),!0;if(p&&ol(a,"start",!0)&&ol(s,"end")){let v=s,w=[];for(;w.push(v),!v.isTextblock;)v=v.lastChild;let C=a,k=1;for(;!C.isTextblock;C=C.firstChild)k++;if(v.canReplace(v.childCount,v.childCount,C.content)){if(n){let N=fe.empty;for(let _=w.length-1;_>=0;_--)N=fe.from(w[_].copy(N));let M=t.tr.step(new vn(e.pos-w.length,e.pos+a.nodeSize,e.pos+k,e.pos+a.nodeSize-k,new Ne(N,w.length,0),0,!0));n(M.scrollIntoView())}return!0}}return!1}function FN(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(n&&n(e.tr.setSelection(Be.create(e.doc,t<0?s.start(a):s.end(a)))),!0):!1}}const mL=FN(-1),gL=FN(1);function xL(t,e=null){return function(n,r){let{$from:s,$to:a}=n.selection,l=s.blockRange(a),c=l&&gb(l,t,e);return c?(r&&r(n.tr.wrap(l,c).scrollIntoView()),!0):!1}}function dk(t,e=null){return function(n,r){let s=!1;for(let a=0;a<n.selection.ranges.length&&!s;a++){let{$from:{pos:l},$to:{pos:c}}=n.selection.ranges[a];n.doc.nodesBetween(l,c,(d,p)=>{if(s)return!1;if(!(!d.isTextblock||d.hasMarkup(t,e)))if(d.type==t)s=!0;else{let m=n.doc.resolve(p),g=m.index();s=m.parent.canReplaceWith(g,g+1,t)}})}if(!s)return!1;if(r){let a=n.tr;for(let l=0;l<n.selection.ranges.length;l++){let{$from:{pos:c},$to:{pos:d}}=n.selection.ranges[l];a.setBlockType(c,d,t,e)}r(a.scrollIntoView())}return!0}}function Cb(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}Cb(yb,jN,RN);Cb(yb,LN,IN);Cb(zN,BN,PN,fL);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function bL(t,e=null){return function(n,r){let{$from:s,$to:a}=n.selection,l=s.blockRange(a);if(!l)return!1;let c=r?n.tr:null;return yL(c,l,t,e)?(r&&r(c.scrollIntoView()),!0):!1}}function yL(t,e,n,r=null){let s=!1,a=e,l=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=l.resolve(e.start-2);a=new $f(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new $f(e.$from,l.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let c=gb(a,n,r,e);return c?(t&&vL(t,e,c,s,n),!0):!1}function vL(t,e,n,r,s){let a=fe.empty;for(let m=n.length-1;m>=0;m--)a=fe.from(n[m].type.create(n[m].attrs,a));t.step(new vn(e.start-(r?2:0),e.end,e.start,e.end,new Ne(a,0,0),n.length,!0));let l=0;for(let m=0;m<n.length;m++)n[m].type==s&&(l=m+1);let c=n.length-l,d=e.start+n.length-(r?2:0),p=e.parent;for(let m=e.startIndex,g=e.endIndex,b=!0;m<g;m++,b=!1)!b&&Gs(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=p.child(m).nodeSize;return t}function wL(t){return function(e,n){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,l=>l.childCount>0&&l.firstChild.type==t);return a?n?r.node(a.depth-1).type==t?kL(e,n,t,a):CL(e,n,a):!0:!1}}function kL(t,e,n,r){let s=t.tr,a=r.end,l=r.$to.end(r.depth);a<l&&(s.step(new vn(a-1,l,a,l,new Ne(fe.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new $f(s.doc.resolve(r.$from.pos),s.doc.resolve(l),r.depth));const c=vl(r);if(c==null)return!1;s.lift(r,c);let d=s.doc.resolve(s.mapping.map(a,-1)-1);return ea(s.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&s.join(d.pos),e(s.scrollIntoView()),!0}function CL(t,e,n){let r=t.tr,s=n.parent;for(let v=n.end,w=n.endIndex-1,C=n.startIndex;w>C;w--)v-=s.child(w).nodeSize,r.delete(v-1,v+1);let a=r.doc.resolve(n.start),l=a.nodeAfter;if(r.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let c=n.startIndex==0,d=n.endIndex==s.childCount,p=a.node(-1),m=a.index(-1);if(!p.canReplace(m+(c?0:1),m+1,l.content.append(d?fe.empty:fe.from(s))))return!1;let g=a.pos,b=g+l.nodeSize;return r.step(new vn(g-(c?1:0),b+(d?1:0),g+1,b-1,new Ne((c?fe.empty:fe.from(s.copy(fe.empty))).append(d?fe.empty:fe.from(s.copy(fe.empty))),c?0:1,d?0:1),c?0:1)),e(r.scrollIntoView()),!0}function SL(t){return function(e,n){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,p=>p.childCount>0&&p.firstChild.type==t);if(!a)return!1;let l=a.startIndex;if(l==0)return!1;let c=a.parent,d=c.child(l-1);if(d.type!=t)return!1;if(n){let p=d.lastChild&&d.lastChild.type==c.type,m=fe.from(p?t.create():null),g=new Ne(fe.from(t.create(null,fe.from(c.type.create(null,m)))),p?3:1,0),b=a.start,v=a.end;n(e.tr.step(new vn(b-(p?3:1),v,b,v,g,1,!0)).scrollIntoView())}return!0}}const Mn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},ll=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let ux=null;const Ps=function(t,e,n){let r=ux||(ux=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},EL=function(){ux=null},Ya=function(t,e,n,r){return n&&(fk(t,e,n,r,-1)||fk(t,e,n,r,1))},NL=/^(img|br|input|textarea|hr)$/i;function fk(t,e,n,r,s){for(var a;;){if(t==n&&e==r)return!0;if(e==(s<0?0:Rr(t))){let l=t.parentNode;if(!l||l.nodeType!=1||ku(t)||NL.test(t.nodeName)||t.contentEditable=="false")return!1;e=Mn(t)+(s<0?0:1),t=l}else if(t.nodeType==1){let l=t.childNodes[e+(s<0?-1:0)];if(l.nodeType==1&&l.contentEditable=="false")if(!((a=l.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=s;else return!1;else t=l,e=s<0?Rr(t):0}else return!1}}function Rr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function TL(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Rr(t)}else if(t.parentNode&&!ku(t))e=Mn(t),t=t.parentNode;else return null}}function AL(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!ku(t))e=Mn(t)+1,t=t.parentNode;else return null}}function ML(t,e,n){for(let r=e==0,s=e==Rr(t);r||s;){if(t==n)return!0;let a=Mn(t);if(t=t.parentNode,!t)return!1;r=r&&a==0,s=s&&a==Rr(t)}}function ku(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const tp=function(t){return t.focusNode&&Ya(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Oa(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function OL(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function jL(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Rr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Rr(r.startContainer),r.startOffset)}}}const us=typeof navigator<"u"?navigator:null,hk=typeof document<"u"?document:null,ta=us&&us.userAgent||"",dx=/Edge\/(\d+)/.exec(ta),UN=/MSIE \d/.exec(ta),fx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ta),ar=!!(UN||fx||dx),Ki=UN?document.documentMode:fx?+fx[1]:dx?+dx[1]:0,Dr=!ar&&/gecko\/(\d+)/i.test(ta);Dr&&+(/Firefox\/(\d+)/.exec(ta)||[0,0])[1];const hx=!ar&&/Chrome\/(\d+)/.exec(ta),jn=!!hx,$N=hx?+hx[1]:0,In=!ar&&!!us&&/Apple Computer/.test(us.vendor),cl=In&&(/Mobile\/\w+/.test(ta)||!!us&&us.maxTouchPoints>2),_r=cl||(us?/Mac/.test(us.platform):!1),VN=us?/Win/.test(us.platform):!1,$s=/Android \d/.test(ta),Cu=!!hk&&"webkitFontSmoothing"in hk.documentElement.style,_L=Cu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function RL(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ds(t,e){return typeof t=="number"?t:t[e]}function DL(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function pk(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let l=n||t.dom;l;){if(l.nodeType!=1){l=ll(l);continue}let c=l,d=c==a.body,p=d?RL(a):DL(c),m=0,g=0;if(e.top<p.top+Ds(r,"top")?g=-(p.top-e.top+Ds(s,"top")):e.bottom>p.bottom-Ds(r,"bottom")&&(g=e.bottom-e.top>p.bottom-p.top?e.top+Ds(s,"top")-p.top:e.bottom-p.bottom+Ds(s,"bottom")),e.left<p.left+Ds(r,"left")?m=-(p.left-e.left+Ds(s,"left")):e.right>p.right-Ds(r,"right")&&(m=e.right-p.right+Ds(s,"right")),m||g)if(d)a.defaultView.scrollBy(m,g);else{let v=c.scrollLeft,w=c.scrollTop;g&&(c.scrollTop+=g),m&&(c.scrollLeft+=m);let C=c.scrollLeft-v,k=c.scrollTop-w;e={left:e.left-C,top:e.top-k,right:e.right-C,bottom:e.bottom-k}}let b=d?"fixed":getComputedStyle(l).position;if(/^(fixed|sticky)$/.test(b))break;l=b=="absolute"?l.offsetParent:ll(l)}}function LL(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let a=(e.left+e.right)/2,l=n+1;l<Math.min(innerHeight,e.bottom);l+=5){let c=t.root.elementFromPoint(a,l);if(!c||c==t.dom||!t.dom.contains(c))continue;let d=c.getBoundingClientRect();if(d.top>=n-20){r=c,s=d.top;break}}return{refDOM:r,refTop:s,stack:qN(t.dom)}}function qN(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=ll(r));return e}function IL({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;WN(n,r==0?0:r-e)}function WN(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:a}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=a&&(r.scrollLeft=a)}}let Ho=null;function zL(t){if(t.setActive)return t.setActive();if(Ho)return t.focus(Ho);let e=qN(t);t.focus(Ho==null?{get preventScroll(){return Ho={preventScroll:!0},!0}}:void 0),Ho||(Ho=!1,WN(e,0))}function KN(t,e){let n,r=2e8,s,a=0,l=e.top,c=e.top,d,p;for(let m=t.firstChild,g=0;m;m=m.nextSibling,g++){let b;if(m.nodeType==1)b=m.getClientRects();else if(m.nodeType==3)b=Ps(m).getClientRects();else continue;for(let v=0;v<b.length;v++){let w=b[v];if(w.top<=l&&w.bottom>=c){l=Math.max(w.bottom,l),c=Math.min(w.top,c);let C=w.left>e.left?w.left-e.left:w.right<e.left?e.left-w.right:0;if(C<r){n=m,r=C,s=C&&n.nodeType==3?{left:w.right<e.left?w.right:w.left,top:e.top}:e,m.nodeType==1&&C&&(a=g+(e.left>=(w.left+w.right)/2?1:0));continue}}else w.top>e.top&&!d&&w.left<=e.left&&w.right>=e.left&&(d=m,p={left:Math.max(w.left,Math.min(w.right,e.left)),top:w.top});!n&&(e.left>=w.right&&e.top>=w.top||e.left>=w.left&&e.top>=w.bottom)&&(a=g+1)}}return!n&&d&&(n=d,s=p,r=0),n&&n.nodeType==3?BL(n,s):!n||r&&n.nodeType==1?{node:t,offset:a}:KN(n,s)}function BL(t,e){let n=t.nodeValue.length,r=document.createRange(),s;for(let a=0;a<n;a++){r.setEnd(t,a+1),r.setStart(t,a);let l=_i(r,1);if(l.top!=l.bottom&&Sb(e,l)){s={node:t,offset:a+(e.left>=(l.left+l.right)/2?1:0)};break}}return r.detach(),s||{node:t,offset:0}}function Sb(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function PL(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function HL(t,e,n){let{node:r,offset:s}=KN(e,n),a=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();a=l.left!=l.right&&n.left>(l.left+l.right)/2?1:-1}return t.docView.posFromDOM(r,s,a)}function FL(t,e,n,r){let s=-1;for(let a=e,l=!1;a!=t.dom;){let c=t.docView.nearestDesc(a,!0),d;if(!c)return null;if(c.dom.nodeType==1&&(c.node.isBlock&&c.parent||!c.contentDOM)&&((d=c.dom.getBoundingClientRect()).width||d.height)&&(c.node.isBlock&&c.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(c.dom.nodeName)&&(!l&&d.left>r.left||d.top>r.top?s=c.posBefore:(!l&&d.right<r.left||d.bottom<r.top)&&(s=c.posAfter),l=!0),!c.contentDOM&&s<0&&!c.node.isText))return(c.node.isBlock?r.top<(d.top+d.bottom)/2:r.left<(d.left+d.right)/2)?c.posBefore:c.posAfter;a=c.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function GN(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),a=s;;){let l=t.childNodes[a];if(l.nodeType==1){let c=l.getClientRects();for(let d=0;d<c.length;d++){let p=c[d];if(Sb(e,p))return GN(l,e,p)}}if((a=(a+1)%r)==s)break}return t}function UL(t,e){let n=t.dom.ownerDocument,r,s=0,a=jL(n,e.left,e.top);a&&({node:r,offset:s}=a);let l=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),c;if(!l||!t.dom.contains(l.nodeType!=1?l.parentNode:l)){let p=t.dom.getBoundingClientRect();if(!Sb(e,p)||(l=GN(t.dom,e,p),!l))return null}if(In)for(let p=l;r&&p;p=ll(p))p.draggable&&(r=void 0);if(l=PL(l,e),r){if(Dr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let m=r.childNodes[s],g;m.nodeName=="IMG"&&(g=m.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&s++}let p;Cu&&s&&r.nodeType==1&&(p=r.childNodes[s-1]).nodeType==1&&p.contentEditable=="false"&&p.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?c=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(c=FL(t,r,s,e))}c==null&&(c=HL(t,l,e));let d=t.docView.nearestDesc(l,!0);return{pos:c,inside:d?d.posAtStart-d.border:-1}}function mk(t){return t.top<t.bottom||t.left<t.right}function _i(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(mk(r))return r}return Array.prototype.find.call(n,mk)||t.getBoundingClientRect()}const $L=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function YN(t,e,n){let{node:r,offset:s,atom:a}=t.docView.domFromPos(e,n<0?-1:1),l=Cu||Dr;if(r.nodeType==3)if(l&&($L.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let d=_i(Ps(r,s,s),n);if(Dr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let p=_i(Ps(r,s-1,s-1),-1);if(p.top==d.top){let m=_i(Ps(r,s,s+1),-1);if(m.top!=d.top)return vc(m,m.left<p.left)}}return d}else{let d=s,p=s,m=n<0?1:-1;return n<0&&!s?(p++,m=-1):n>=0&&s==r.nodeValue.length?(d--,m=1):n<0?d--:p++,vc(_i(Ps(r,d,p),m),m<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&s&&(n<0||s==Rr(r))){let d=r.childNodes[s-1];if(d.nodeType==1)return Yg(d.getBoundingClientRect(),!1)}if(a==null&&s<Rr(r)){let d=r.childNodes[s];if(d.nodeType==1)return Yg(d.getBoundingClientRect(),!0)}return Yg(r.getBoundingClientRect(),n>=0)}if(a==null&&s&&(n<0||s==Rr(r))){let d=r.childNodes[s-1],p=d.nodeType==3?Ps(d,Rr(d)-(l?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(p)return vc(_i(p,1),!1)}if(a==null&&s<Rr(r)){let d=r.childNodes[s];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let p=d?d.nodeType==3?Ps(d,0,l?0:1):d.nodeType==1?d:null:null;if(p)return vc(_i(p,-1),!0)}return vc(_i(r.nodeType==3?Ps(r):r,-n),n>=0)}function vc(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Yg(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function JN(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function VL(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return JN(t,e,()=>{let{node:a}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let c=t.docView.nearestDesc(a,!0);if(!c)break;if(c.node.isBlock){a=c.contentDOM||c.dom;break}a=c.dom.parentNode}let l=YN(t,s.pos,1);for(let c=a.firstChild;c;c=c.nextSibling){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Ps(c,0,c.nodeValue.length).getClientRects();else continue;for(let p=0;p<d.length;p++){let m=d[p];if(m.bottom>m.top+1&&(n=="up"?l.top-m.top>(m.bottom-l.top)*2:m.bottom-l.bottom>(l.bottom-m.top)*2))return!1}}return!0})}const qL=/[\u0590-\u08ac]/;function WL(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,a=!s,l=s==r.parent.content.size,c=t.domSelection();return c?!qL.test(r.parent.textContent)||!c.modify?n=="left"||n=="backward"?a:l:JN(t,e,()=>{let{focusNode:d,focusOffset:p,anchorNode:m,anchorOffset:g}=t.domSelectionRange(),b=c.caretBidiLevel;c.modify("move",n,"character");let v=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:w,focusOffset:C}=t.domSelectionRange(),k=w&&!v.contains(w.nodeType==1?w:w.parentNode)||d==w&&p==C;try{c.collapse(m,g),d&&(d!=m||p!=g)&&c.extend&&c.extend(d,p)}catch{}return b!=null&&(c.caretBidiLevel=b),k}):r.pos==r.start()||r.pos==r.end()}let gk=null,xk=null,bk=!1;function KL(t,e,n){return gk==e&&xk==n?bk:(gk=e,xk=n,bk=n=="up"||n=="down"?VL(t,e,n):WL(t,e,n))}const Lr=0,yk=1,Ra=2,ds=3;class Su{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=Lr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let a,l;if(e==this.contentDOM)a=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(l)+l.size:this.posAtStart}else{let a,l;if(e==this.contentDOM)a=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(l):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>Mn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let a=this.getDesc(s),l;if(a&&(!n||a.node))if(r&&(l=a.nodeDOM)&&!(l.nodeType==1?l.contains(e.nodeType==1?e:e.parentNode):l==e))r=!1;else return a}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],a=r+s.size;if(r==e&&a!=r){for(;!s.border&&s.children.length;)for(let l=0;l<s.children.length;l++){let c=s.children[l];if(c.size){s=c;break}}return s}if(e<a)return s.descAt(e-r-s.border);r=a}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let a=0;r<this.children.length;r++){let l=this.children[r],c=a+l.size;if(c>e||l instanceof QN){s=e-a;break}a=c}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof XN&&a.side>=0;r--);if(n<=0){let a,l=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,l=!1);return a&&n&&l&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?Mn(a.dom)+1:0}}else{let a,l=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,l=!1);return a&&l&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?Mn(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let l=r,c=0;;c++){let d=this.children[c],p=l+d.size;if(s==-1&&e<=p){let m=l+d.border;if(e>=m&&n<=p-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,n,m);e=l;for(let g=c;g>0;g--){let b=this.children[g-1];if(b.size&&b.dom.parentNode==this.contentDOM&&!b.emptyChildAt(1)){s=Mn(b.dom)+1;break}e-=b.size}s==-1&&(s=0)}if(s>-1&&(p>n||c==this.children.length-1)){n=p;for(let m=c+1;m<this.children.length;m++){let g=this.children[m];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){a=Mn(g.dom);break}n+=g.size}a==-1&&(a=this.contentDOM.childNodes.length);break}l=p}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let a=Math.min(e,n),l=Math.max(e,n);for(let v=0,w=0;v<this.children.length;v++){let C=this.children[v],k=w+C.size;if(a>w&&l<k)return C.setSelection(e-w-C.border,n-w-C.border,r,s);w=k}let c=this.domFromPos(e,e?-1:1),d=n==e?c:this.domFromPos(n,n?-1:1),p=r.root.getSelection(),m=r.domSelectionRange(),g=!1;if((Dr||In)&&e==n){let{node:v,offset:w}=c;if(v.nodeType==3){if(g=!!(w&&v.nodeValue[w-1]==`
`),g&&w==v.nodeValue.length)for(let C=v,k;C;C=C.parentNode){if(k=C.nextSibling){k.nodeName=="BR"&&(c=d={node:k.parentNode,offset:Mn(k)+1});break}let N=C.pmViewDesc;if(N&&N.node&&N.node.isBlock)break}}else{let C=v.childNodes[w-1];g=C&&(C.nodeName=="BR"||C.contentEditable=="false")}}if(Dr&&m.focusNode&&m.focusNode!=d.node&&m.focusNode.nodeType==1){let v=m.focusNode.childNodes[m.focusOffset];v&&v.contentEditable=="false"&&(s=!0)}if(!(s||g&&In)&&Ya(c.node,c.offset,m.anchorNode,m.anchorOffset)&&Ya(d.node,d.offset,m.focusNode,m.focusOffset))return;let b=!1;if((p.extend||e==n)&&!(g&&Dr)){p.collapse(c.node,c.offset);try{e!=n&&p.extend(d.node,d.offset),b=!0}catch{}}if(!b){if(e>n){let w=c;c=d,d=w}let v=document.createRange();v.setEnd(d.node,d.offset),v.setStart(c.node,c.offset),p.removeAllRanges(),p.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let a=this.children[s],l=r+a.size;if(r==l?e<=l&&n>=r:e<l&&n>r){let c=r+a.border,d=l-a.border;if(e>=c&&n<=d){this.dirty=e==r||n==l?Ra:yk,e==c&&n==d&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=ds:a.markDirty(e-c,n-c);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Ra:ds}r=l}this.dirty=Ra}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Ra:yk;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class XN extends Su{constructor(e,n,r,s){let a,l=n.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!n.type.spec.raw){if(l.nodeType!=1){let c=document.createElement("span");c.appendChild(l),l=c}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(e,[],l,null),this.widget=n,this.widget=n,a=this}matchesWidget(e){return this.dirty==Lr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class GL extends Su{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ja extends Su{constructor(e,n,r,s,a){super(e,[],r,s),this.mark=n,this.spec=a}static create(e,n,r,s){let a=s.nodeViews[n.type.name],l=a&&a(n,s,r);return(!l||!l.dom)&&(l=no.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Ja(e,n,l.dom,l.contentDOM||l.dom,l)}parseRule(){return this.dirty&ds||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ds&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Lr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Lr}}slice(e,n,r){let s=Ja.create(this.parent,this.mark,!0,r),a=this.children,l=this.size;n<l&&(a=mx(a,n,l,r)),e>0&&(a=mx(a,0,e,r));for(let c=0;c<a.length;c++)a[c].parent=s;return s.children=a,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Gi extends Su{constructor(e,n,r,s,a,l,c,d,p){super(e,[],a,l),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=c}static create(e,n,r,s,a,l){let c=a.nodeViews[n.type.name],d,p=c&&c(n,a,()=>{if(!d)return l;if(d.parent)return d.parent.posBeforeChild(d)},r,s),m=p&&p.dom,g=p&&p.contentDOM;if(n.isText){if(!m)m=document.createTextNode(n.text);else if(m.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else m||({dom:m,contentDOM:g}=no.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&m.nodeName!="BR"&&(m.hasAttribute("contenteditable")||(m.contentEditable="false"),n.type.spec.draggable&&(m.draggable=!0));let b=m;return m=tT(m,r,n),p?d=new YL(e,n,r,s,m,g||null,b,p,a,l+1):n.isText?new np(e,n,r,s,m,b,a):new Gi(e,n,r,s,m,g||null,b,a,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>fe.empty)}return e}matchesNode(e,n,r){return this.dirty==Lr&&e.eq(this.node)&&qf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,a=e.composing?this.localCompositionInfo(e,n):null,l=a&&a.pos>-1?a:null,c=a&&a.pos<0,d=new XL(this,l&&l.node,e);eI(this.node,this.innerDeco,(p,m,g)=>{p.spec.marks?d.syncToMarks(p.spec.marks,r,e,m):p.type.side>=0&&!g&&d.syncToMarks(m==this.node.childCount?Et.none:this.node.child(m).marks,r,e,m),d.placeWidget(p,e,s)},(p,m,g,b)=>{d.syncToMarks(p.marks,r,e,b);let v;d.findNodeMatch(p,m,g,b)||c&&e.state.selection.from>s&&e.state.selection.to<s+p.nodeSize&&(v=d.findIndexWithChild(a.node))>-1&&d.updateNodeAt(p,m,g,v,e)||d.updateNextNode(p,m,g,e,b,s)||d.addNode(p,m,g,e,s),s+=p.nodeSize}),d.syncToMarks([],r,e,0),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Ra)&&(l&&this.protectLocalComposition(e,l),ZN(this.contentDOM,this.children,e),cl&&tI(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof Be)||r<n||s>n+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let l=a.nodeValue,c=nI(this.node.content,l,r-n,s-n);return c<0?null:{node:a,pos:c,text:l}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let l=new GL(this,a,n,s);e.input.compositionNodes.push(l),this.children=mx(this.children,r,r+s.length,e,l)}update(e,n,r,s){return this.dirty==ds||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Lr}updateOuterDeco(e){if(qf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=eT(this.dom,this.nodeDOM,px(this.outerDeco,this.node,n),px(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function vk(t,e,n,r,s){tT(r,e,t);let a=new Gi(void 0,t,e,n,r,r,r,s,0);return a.contentDOM&&a.updateChildren(s,0),a}class np extends Gi{constructor(e,n,r,s,a,l,c){super(e,n,r,s,a,null,l,c,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==ds||this.dirty!=Lr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Lr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Lr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),a=document.createTextNode(s.text);return new np(this.parent,s,this.outerDeco,this.innerDeco,a,a,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=ds)}get domAtom(){return!1}isText(e){return this.node.text==e}}class QN extends Su{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Lr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class YL extends Gi{constructor(e,n,r,s,a,l,c,d,p,m){super(e,n,r,s,a,l,c,p,m),this.spec=d}update(e,n,r,s){if(this.dirty==ds)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,n,r);return a&&this.updateInner(e,n,r,s),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ZN(t,e,n){let r=t.firstChild,s=!1;for(let a=0;a<e.length;a++){let l=e[a],c=l.dom;if(c.parentNode==t){for(;c!=r;)r=wk(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(c,r);if(l instanceof Ja){let d=r?r.previousSibling:t.lastChild;ZN(l.contentDOM,l.children,n),r=d?d.nextSibling:t.firstChild}}for(;r;)r=wk(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const Ic=function(t){t&&(this.nodeName=t)};Ic.prototype=Object.create(null);const Da=[new Ic];function px(t,e,n){if(t.length==0)return Da;let r=n?Da[0]:new Ic,s=[r];for(let a=0;a<t.length;a++){let l=t[a].type.attrs;if(l){l.nodeName&&s.push(r=new Ic(l.nodeName));for(let c in l){let d=l[c];d!=null&&(n&&s.length==1&&s.push(r=new Ic(e.isInline?"span":"div")),c=="class"?r.class=(r.class?r.class+" ":"")+d:c=="style"?r.style=(r.style?r.style+";":"")+d:c!="nodeName"&&(r[c]=d))}}}return s}function eT(t,e,n,r){if(n==Da&&r==Da)return e;let s=e;for(let a=0;a<r.length;a++){let l=r[a],c=n[a];if(a){let d;c&&c.nodeName==l.nodeName&&s!=t&&(d=s.parentNode)&&d.nodeName.toLowerCase()==l.nodeName||(d=document.createElement(l.nodeName),d.pmIsDeco=!0,d.appendChild(s),c=Da[0]),s=d}JL(s,c||Da[0],l)}return s}function JL(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)s.indexOf(r[a])==-1&&t.classList.remove(r[a]);for(let a=0;a<s.length;a++)r.indexOf(s[a])==-1&&t.classList.add(s[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function tT(t,e,n){return eT(t,t,Da,px(e,n,t.nodeType!=1))}function qf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function wk(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class XL{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=QL(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,s){let a=0,l=this.stack.length>>1,c=Math.min(l,e.length);for(;a<c&&(a==l-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<l;)this.destroyRest(),this.top.dirty=Lr,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<e.length;){this.stack.push(this.top,this.index+1);let d=-1,p=this.top.children.length;s<this.preMatch.index&&(p=Math.min(this.index+3,p));for(let m=this.index;m<p;m++){let g=this.top.children[m];if(g.matchesMark(e[l])&&!this.isLocked(g.dom)){d=m;break}}if(d>-1)d>this.index&&(this.changed=!0,this.destroyBetween(this.index,d)),this.top=this.top.children[this.index];else{let m=Ja.create(this.top,e[l],n,r);this.top.children.splice(this.index,0,m),this.top=m,this.changed=!0}this.index=0,l++}}findNodeMatch(e,n,r,s){let a=-1,l;if(s>=this.preMatch.index&&(l=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&l.matchesNode(e,n,r))a=this.top.children.indexOf(l,this.index);else for(let c=this.index,d=Math.min(this.top.children.length,c+5);c<d;c++){let p=this.top.children[c];if(p.matchesNode(e,n,r)&&!this.preMatch.matched.has(p)){a=c;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,n,r,s,a){let l=this.top.children[s];return l.dirty==ds&&l.dom==l.contentDOM&&(l.dirty=Ra),l.update(e,n,r,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,a,l){for(let c=this.index;c<this.top.children.length;c++){let d=this.top.children[c];if(d instanceof Gi){let p=this.preMatch.matched.get(d);if(p!=null&&p!=a)return!1;let m=d.dom,g,b=this.isLocked(m)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=ds&&qf(n,d.outerDeco));if(!b&&d.update(e,n,r,s))return this.destroyBetween(this.index,c),d.dom!=m&&(this.changed=!0),this.index++,!0;if(!b&&(g=this.recreateWrapper(d,e,n,r,s,l)))return this.destroyBetween(this.index,c),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Ra,g.updateChildren(s,l+1),g.dirty=Lr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,a,l){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!qf(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let c=Gi.create(this.top,n,r,s,a,l);if(c.contentDOM){c.children=e.children,e.children=[];for(let d of c.children)d.parent=c}return e.destroy(),c}addNode(e,n,r,s,a){let l=Gi.create(this.top,e,n,r,s,a);l.contentDOM&&l.updateChildren(s,a+1),this.top.children.splice(this.index++,0,l),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new XN(this.top,e,n,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Ja;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof np)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((In||jn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new QN(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function QL(t,e){let n=e,r=n.children.length,s=t.childCount,a=new Map,l=[];e:for(;s>0;){let c;for(;;)if(r){let p=n.children[r-1];if(p instanceof Ja)n=p,r=p.children.length;else{c=p,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let d=c.node;if(d){if(d!=t.child(s-1))break;--s,a.set(c,s),l.push(c)}}return{index:s,matched:a,matches:l.reverse()}}function ZL(t,e){return t.type.side-e.type.side}function eI(t,e,n,r){let s=e.locals(t),a=0;if(s.length==0){for(let p=0;p<t.childCount;p++){let m=t.child(p);r(m,s,e.forChild(a,m),p),a+=m.nodeSize}return}let l=0,c=[],d=null;for(let p=0;;){let m,g;for(;l<s.length&&s[l].to==a;){let k=s[l++];k.widget&&(m?(g||(g=[m])).push(k):m=k)}if(m)if(g){g.sort(ZL);for(let k=0;k<g.length;k++)n(g[k],p,!!d)}else n(m,p,!!d);let b,v;if(d)v=-1,b=d,d=null;else if(p<t.childCount)v=p,b=t.child(p++);else break;for(let k=0;k<c.length;k++)c[k].to<=a&&c.splice(k--,1);for(;l<s.length&&s[l].from<=a&&s[l].to>a;)c.push(s[l++]);let w=a+b.nodeSize;if(b.isText){let k=w;l<s.length&&s[l].from<k&&(k=s[l].from);for(let N=0;N<c.length;N++)c[N].to<k&&(k=c[N].to);k<w&&(d=b.cut(k-a),b=b.cut(0,k-a),w=k,v=-1)}else for(;l<s.length&&s[l].to<w;)l++;let C=b.isInline&&!b.isLeaf?c.filter(k=>!k.inline):c.slice();r(b,C,e.forChild(a,b),v),a=w}}function tI(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function nI(t,e,n,r){for(let s=0,a=0;s<t.childCount&&a<=r;){let l=t.child(s++),c=a;if(a+=l.nodeSize,!l.isText)continue;let d=l.text;for(;s<t.childCount;){let p=t.child(s++);if(a+=p.nodeSize,!p.isText)break;d+=p.text}if(a>=n){if(a>=r&&d.slice(r-e.length-c,r-c)==e)return r-e.length;let p=c<r?d.lastIndexOf(e,r-c-1):-1;if(p>=0&&p+e.length+c>=n)return c+p;if(n==r&&d.length>=r+e.length-c&&d.slice(r-c,r-c+e.length)==e)return r}}return-1}function mx(t,e,n,r,s){let a=[];for(let l=0,c=0;l<t.length;l++){let d=t[l],p=c,m=c+=d.size;p>=n||m<=e?a.push(d):(p<e&&a.push(d.slice(0,e-p,r)),s&&(a.push(s),s=void 0),m>n&&a.push(d.slice(n-p,d.size,r)))}return a}function Eb(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),a=s&&s.size==0,l=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(l<0)return null;let c=r.resolve(l),d,p;if(tp(n)){for(d=l;s&&!s.node;)s=s.parent;let g=s.node;if(s&&g.isAtom&&ze.isSelectable(g)&&s.parent&&!(g.isInline&&ML(n.focusNode,n.focusOffset,s.dom))){let b=s.posBefore;p=new ze(l==b?c:r.resolve(b))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=l,b=l;for(let v=0;v<n.rangeCount;v++){let w=n.getRangeAt(v);g=Math.min(g,t.docView.posFromDOM(w.startContainer,w.startOffset,1)),b=Math.max(b,t.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(g<0)return null;[d,l]=b==t.state.selection.anchor?[b,g]:[g,b],c=r.resolve(l)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let m=r.resolve(d);if(!p){let g=e=="pointer"||t.state.selection.head<c.pos&&!a?1:-1;p=Nb(t,m,c,g)}return p}function nT(t){return t.editable?t.hasFocus():sT(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ys(t,e=!1){let n=t.state.selection;if(rT(t,n),!!nT(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&jn){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Ya(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)sI(t);else{let{anchor:r,head:s}=n,a,l;kk&&!(n instanceof Be)&&(n.$from.parent.inlineContent||(a=Ck(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(l=Ck(t,n.to))),t.docView.setSelection(r,s,t,e),kk&&(a&&Sk(a),l&&Sk(l)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&rI(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const kk=In||jn&&$N<63;function Ck(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,a=r?n.childNodes[r-1]:null;if(In&&s&&s.contentEditable=="false")return Jg(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Jg(s);if(a)return Jg(a)}}function Jg(t){return t.contentEditable="true",In&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Sk(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function rI(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!nT(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function sI(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Mn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&ar&&Ki<=11&&(n.disabled=!0,n.disabled=!1)}function rT(t,e){if(e instanceof ze){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Ek(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Ek(t)}function Ek(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Nb(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||Be.between(e,n,r)}function Nk(t){return t.editable&&!t.hasFocus()?!1:sT(t)}function sT(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function iI(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Ya(e.node,e.offset,n.anchorNode,n.anchorOffset)}function gx(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),a=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return a&&$e.findFrom(a,e)}function Di(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Tk(t,e,n){let r=t.state.selection;if(r instanceof Be)if(n.indexOf("s")>-1){let{$head:s}=r,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let l=t.state.doc.resolve(s.pos+a.nodeSize*(e<0?-1:1));return Di(t,new Be(r.$anchor,l))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=gx(t.state,e);return s&&s instanceof ze?Di(t,s):!1}else if(!(_r&&n.indexOf("m")>-1)){let s=r.$head,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,l;if(!a||a.isText)return!1;let c=e<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(l=t.docView.descAt(c))&&!l.contentDOM?ze.isSelectable(a)?Di(t,new ze(e<0?t.state.doc.resolve(s.pos-a.nodeSize):s)):Cu?Di(t,new Be(t.state.doc.resolve(e<0?c:c+a.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ze&&r.node.isInline)return Di(t,new Be(e>0?r.$to:r.$from));{let s=gx(t.state,e);return s?Di(t,s):!1}}}function Wf(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function zc(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Fo(t,e){return e<0?aI(t):oI(t)}function aI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,a,l=!1;for(Dr&&n.nodeType==1&&r<Wf(n)&&zc(n.childNodes[r],-1)&&(l=!0);;)if(r>0){if(n.nodeType!=1)break;{let c=n.childNodes[r-1];if(zc(c,-1))s=n,a=--r;else if(c.nodeType==3)n=c,r=n.nodeValue.length;else break}}else{if(iT(n))break;{let c=n.previousSibling;for(;c&&zc(c,-1);)s=n.parentNode,a=Mn(c),c=c.previousSibling;if(c)n=c,r=Wf(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}l?xx(t,n,r):s&&xx(t,s,a)}function oI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Wf(n),a,l;for(;;)if(r<s){if(n.nodeType!=1)break;let c=n.childNodes[r];if(zc(c,1))a=n,l=++r;else break}else{if(iT(n))break;{let c=n.nextSibling;for(;c&&zc(c,1);)a=c.parentNode,l=Mn(c)+1,c=c.nextSibling;if(c)n=c,r=0,s=Wf(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}a&&xx(t,a,l)}function iT(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function lI(t,e){for(;t&&e==t.childNodes.length&&!ku(t);)e=Mn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function cI(t,e){for(;t&&!e&&!ku(t);)e=Mn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function xx(t,e,n){if(e.nodeType!=3){let a,l;(l=lI(e,n))?(e=l,n=0):(a=cI(e,n))&&(e=a,n=a.nodeValue.length)}let r=t.domSelection();if(!r)return;if(tp(r)){let a=document.createRange();a.setEnd(e,n),a.setStart(e,n),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&Ys(t)},50)}function Ak(t,e){let n=t.state.doc.resolve(e);if(!(jn||VN)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let a=t.coordsAtPos(e-1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left<s.left?"ltr":"rtl"}if(e<n.end()){let a=t.coordsAtPos(e+1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Mk(t,e,n){let r=t.state.selection;if(r instanceof Be&&!r.empty||n.indexOf("s")>-1||_r&&n.indexOf("m")>-1)return!1;let{$from:s,$to:a}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let l=gx(t.state,e);if(l&&l instanceof ze)return Di(t,l)}if(!s.parent.inlineContent){let l=e<0?s:a,c=r instanceof br?$e.near(l,e):$e.findFrom(l,e);return c?Di(t,c):!1}return!1}function Ok(t,e){if(!(t.state.selection instanceof Be))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let l=t.state.tr;return e<0?l.delete(n.pos-a.nodeSize,n.pos):l.delete(n.pos,n.pos+a.nodeSize),t.dispatch(l),!0}return!1}function jk(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function uI(t){if(!In||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;jk(t,r,"true"),setTimeout(()=>jk(t,r,"false"),20)}return!1}function dI(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function fI(t,e){let n=e.keyCode,r=dI(e);if(n==8||_r&&n==72&&r=="c")return Ok(t,-1)||Fo(t,-1);if(n==46&&!e.shiftKey||_r&&n==68&&r=="c")return Ok(t,1)||Fo(t,1);if(n==13||n==27)return!0;if(n==37||_r&&n==66&&r=="c"){let s=n==37?Ak(t,t.state.selection.from)=="ltr"?-1:1:-1;return Tk(t,s,r)||Fo(t,s)}else if(n==39||_r&&n==70&&r=="c"){let s=n==39?Ak(t,t.state.selection.from)=="ltr"?1:-1:1;return Tk(t,s,r)||Fo(t,s)}else{if(n==38||_r&&n==80&&r=="c")return Mk(t,-1,r)||Fo(t,-1);if(n==40||_r&&n==78&&r=="c")return uI(t)||Mk(t,1,r)||Fo(t,1);if(r==(_r?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Tb(t,e){t.someProp("transformCopied",v=>{e=v(e,t)});let n=[],{content:r,openStart:s,openEnd:a}=e;for(;s>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,a--;let v=r.firstChild;n.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),r=v.content}let l=t.someProp("clipboardSerializer")||no.fromSchema(t.state.schema),c=dT(),d=c.createElement("div");d.appendChild(l.serializeFragment(r,{document:c}));let p=d.firstChild,m,g=0;for(;p&&p.nodeType==1&&(m=uT[p.nodeName.toLowerCase()]);){for(let v=m.length-1;v>=0;v--){let w=c.createElement(m[v]);for(;d.firstChild;)w.appendChild(d.firstChild);d.appendChild(w),g++}p=d.firstChild}p&&p.nodeType==1&&p.setAttribute("data-pm-slice",`${s} ${a}${g?` -${g}`:""} ${JSON.stringify(n)}`);let b=t.someProp("clipboardTextSerializer",v=>v(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:b,slice:e}}function aT(t,e,n,r,s){let a=s.parent.type.spec.code,l,c;if(!n&&!e)return null;let d=!!e&&(r||a||!n);if(d){if(t.someProp("transformPastedText",b=>{e=b(e,a||r,t)}),a)return c=new Ne(fe.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",b=>{c=b(c,t,!0)}),c;let g=t.someProp("clipboardTextParser",b=>b(e,s,r,t));if(g)c=g;else{let b=s.marks(),{schema:v}=t.state,w=no.fromSchema(v);l=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(C=>{let k=l.appendChild(document.createElement("p"));C&&k.appendChild(w.serializeNode(v.text(C,b)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),l=gI(n),Cu&&xI(l);let p=l&&l.querySelector("[data-pm-slice]"),m=p&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(p.getAttribute("data-pm-slice")||"");if(m&&m[3])for(let g=+m[3];g>0;g--){let b=l.firstChild;for(;b&&b.nodeType!=1;)b=b.nextSibling;if(!b)break;l=b}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||Dc.fromSchema(t.state.schema)).parseSlice(l,{preserveWhitespace:!!(d||m),context:s,ruleFromNode(b){return b.nodeName=="BR"&&!b.nextSibling&&b.parentNode&&!hI.test(b.parentNode.nodeName)?{ignore:!0}:null}})),m)c=bI(_k(c,+m[1],+m[2]),m[4]);else if(c=Ne.maxOpen(pI(c.content,s),!0),c.openStart||c.openEnd){let g=0,b=0;for(let v=c.content.firstChild;g<c.openStart&&!v.type.spec.isolating;g++,v=v.firstChild);for(let v=c.content.lastChild;b<c.openEnd&&!v.type.spec.isolating;b++,v=v.lastChild);c=_k(c,g,b)}return t.someProp("transformPasted",g=>{c=g(c,t,d)}),c}const hI=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function pI(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),a,l=[];if(t.forEach(c=>{if(!l)return;let d=s.findWrapping(c.type),p;if(!d)return l=null;if(p=l.length&&a.length&&lT(d,a,c,l[l.length-1],0))l[l.length-1]=p;else{l.length&&(l[l.length-1]=cT(l[l.length-1],a.length));let m=oT(c,d);l.push(m),s=s.matchType(m.type),a=d}}),l)return fe.from(l)}return t}function oT(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,fe.from(t));return t}function lT(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let a=lT(t,e,n,r.lastChild,s+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(fe.from(oT(n,t,s+1))))}}function cT(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,cT(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(fe.empty,!0);return t.copy(n.append(r))}function bx(t,e,n,r,s,a){let l=e<0?t.firstChild:t.lastChild,c=l.content;return t.childCount>1&&(a=0),s<r-1&&(c=bx(c,e,n,r,s+1,a)),s>=n&&(c=e<0?l.contentMatchAt(0).fillBefore(c,a<=s).append(c):c.append(l.contentMatchAt(l.childCount).fillBefore(fe.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,l.copy(c))}function _k(t,e,n){return e<t.openStart&&(t=new Ne(bx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new Ne(bx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const uT={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Rk=null;function dT(){return Rk||(Rk=document.implementation.createHTMLDocument("title"))}let Xg=null;function mI(t){let e=window.trustedTypes;return e?(Xg||(Xg=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Xg.createHTML(t)):t}function gI(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=dT().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&uT[r[1].toLowerCase()])&&(t=s.map(a=>"<"+a+">").join("")+t+s.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=mI(t),s)for(let a=0;a<s.length;a++)n=n.querySelector(s[a])||n;return n}function xI(t){let e=t.querySelectorAll(jn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function bI(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:a,openEnd:l}=t;for(let c=r.length-2;c>=0;c-=2){let d=n.nodes[r[c]];if(!d||d.hasRequiredAttrs())break;s=fe.from(d.create(r[c+1],s)),a++,l++}return new Ne(s,a,l)}const $n={},Vn={},yI={touchstart:!0,touchmove:!0};class vI{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function wI(t){for(let e in $n){let n=$n[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{CI(t,r)&&!Ab(t,r)&&(t.editable||!(r.type in Vn))&&n(t,r)},yI[e]?{passive:!0}:void 0)}In&&t.dom.addEventListener("input",()=>null),yx(t)}function Wi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function kI(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function yx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Ab(t,r))})}function Ab(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function CI(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function SI(t,e){!Ab(t,e)&&$n[e.type]&&(t.editable||!(e.type in Vn))&&$n[e.type](t,e)}Vn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!hT(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!($s&&jn&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),cl&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,Oa(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||fI(t,n)?n.preventDefault():Wi(t,"key")};Vn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Vn.keypress=(t,e)=>{let n=e;if(hT(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||_r&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Be)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),a=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",l=>l(t,r.$from.pos,r.$to.pos,s,a))&&t.dispatch(a()),n.preventDefault()}};function rp(t){return{left:t.clientX,top:t.clientY}}function EI(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Mb(t,e,n,r,s){if(r==-1)return!1;let a=t.state.doc.resolve(r);for(let l=a.depth+1;l>0;l--)if(t.someProp(e,c=>l>a.depth?c(t,n,a.nodeAfter,a.before(l),s,!0):c(t,n,a.node(l),a.before(l),s,!1)))return!0;return!1}function Xo(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function NI(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ze.isSelectable(r)?(Xo(t,new ze(n)),!0):!1}function TI(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof ze&&(r=n.node);let a=t.state.doc.resolve(e);for(let l=a.depth+1;l>0;l--){let c=l>a.depth?a.nodeAfter:a.node(l);if(ze.isSelectable(c)){r&&n.$from.depth>0&&l>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?s=a.before(n.$from.depth):s=a.before(l);break}}return s!=null?(Xo(t,ze.create(t.state.doc,s)),!0):!1}function AI(t,e,n,r,s){return Mb(t,"handleClickOn",e,n,r)||t.someProp("handleClick",a=>a(t,e,r))||(s?TI(t,n):NI(t,n))}function MI(t,e,n,r){return Mb(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function OI(t,e,n,r){return Mb(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||jI(t,n,r)}function jI(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Xo(t,Be.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let a=s.depth+1;a>0;a--){let l=a>s.depth?s.nodeAfter:s.node(a),c=s.before(a);if(l.inlineContent)Xo(t,Be.create(r,c+1,c+1+l.content.size));else if(ze.isSelectable(l))Xo(t,ze.create(r,c));else continue;return!0}}function Ob(t){return Kf(t)}const fT=_r?"metaKey":"ctrlKey";$n.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Ob(t),s=Date.now(),a="singleClick";s-t.input.lastClick.time<500&&EI(n,t.input.lastClick)&&!n[fT]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:a,button:n.button};let l=t.posAtCoords(rp(n));l&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new _I(t,l,n,!!r)):(a=="doubleClick"?MI:OI)(t,l.pos,l.inside,n)?n.preventDefault():Wi(t,"pointer"))};class _I{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[fT],this.allowDefault=r.shiftKey;let a,l;if(n.inside>-1)a=e.state.doc.nodeAt(n.inside),l=n.inside;else{let m=e.state.doc.resolve(n.pos);a=m.parent,l=m.depth?m.before():0}const c=s?null:r.target,d=c?e.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:p}=e.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||p instanceof ze&&p.from<=l&&p.to>l)&&(this.mightDrag={node:a,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Dr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Wi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ys(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(rp(e))),this.updateAllowDefault(e),this.allowDefault||!n?Wi(this.view,"pointer"):AI(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||In&&this.mightDrag&&!this.mightDrag.node.isAtom||jn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Xo(this.view,$e.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Wi(this.view,"pointer")}move(e){this.updateAllowDefault(e),Wi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}$n.touchstart=t=>{t.input.lastTouch=Date.now(),Ob(t),Wi(t,"pointer")};$n.touchmove=t=>{t.input.lastTouch=Date.now(),Wi(t,"pointer")};$n.contextmenu=t=>Ob(t);function hT(t,e){return t.composing?!0:In&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const RI=$s?5e3:-1;Vn.compositionstart=Vn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Be&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||jn&&VN&&DI(t)))t.markCursor=t.state.storedMarks||n.marks(),Kf(t,!0),t.markCursor=null;else if(Kf(t,!e.selection.empty),Dr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,a=r.focusOffset;s&&s.nodeType==1&&a!=0;){let l=a<0?s.lastChild:s.childNodes[a-1];if(!l)break;if(l.nodeType==3){let c=t.domSelection();c&&c.collapse(l,l.nodeValue.length);break}else s=l,a=-1}}t.input.composing=!0}pT(t,RI)};function DI(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}Vn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,pT(t,20))};function pT(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Kf(t),e))}function mT(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=II());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function LI(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=TL(e.focusNode,e.focusOffset),r=AL(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(n==a||r==a)return a;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let l=n.pmViewDesc;if(!(!l||!l.isText(n.nodeValue)))return r}}return n||r}function II(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Kf(t,e=!1){if(!($s&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),mT(t),e||t.docView&&t.docView.dirty){let n=Eb(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function zI(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const ru=ar&&Ki<15||cl&&_L<604;$n.copy=Vn.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let a=ru?null:n.clipboardData,l=r.content(),{dom:c,text:d}=Tb(t,l);a?(n.preventDefault(),a.clearData(),a.setData("text/html",c.innerHTML),a.setData("text/plain",d)):zI(t,c),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function BI(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function PI(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?su(t,r.value,null,s,e):su(t,r.textContent,r.innerHTML,s,e)},50)}function su(t,e,n,r,s){let a=aT(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,s,a||Ne.empty)))return!0;if(!a)return!1;let l=BI(a),c=l?t.state.tr.replaceSelectionWith(l,r):t.state.tr.replaceSelection(a);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function gT(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Vn.paste=(t,e)=>{let n=e;if(t.composing&&!$s)return;let r=ru?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&su(t,gT(r),r.getData("text/html"),s,n)?n.preventDefault():PI(t,n)};class xT{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const HI=_r?"altKey":"ctrlKey";function bT(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[HI]}$n.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,a=s.empty?null:t.posAtCoords(rp(n)),l;if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof ze?s.to-1:s.to))){if(r&&r.mightDrag)l=ze.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(l=ze.create(t.state.doc,g.posBefore))}}let c=(l||t.state.selection).content(),{dom:d,text:p,slice:m}=Tb(t,c);(!n.dataTransfer.files.length||!jn||$N>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(ru?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",ru||n.dataTransfer.setData("text/plain",p),t.dragging=new xT(m,bT(t,n),l)};$n.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Vn.dragover=Vn.dragenter=(t,e)=>e.preventDefault();Vn.drop=(t,e)=>{try{FI(t,e,t.dragging)}finally{t.dragging=null}};function FI(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(rp(e));if(!r)return;let s=t.state.doc.resolve(r.pos),a=n&&n.slice;a?t.someProp("transformPasted",v=>{a=v(a,t,!1)}):a=aT(t,gT(e.dataTransfer),ru?null:e.dataTransfer.getData("text/html"),!1,s);let l=!!(n&&bT(t,e));if(t.someProp("handleDrop",v=>v(t,e,a||Ne.empty,l))){e.preventDefault();return}if(!a)return;e.preventDefault();let c=a?kN(t.state.doc,s.pos,a):s.pos;c==null&&(c=s.pos);let d=t.state.tr;if(l){let{node:v}=n;v?v.replace(d):d.deleteSelection()}let p=d.mapping.map(c),m=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,g=d.doc;if(m?d.replaceRangeWith(p,p,a.content.firstChild):d.replaceRange(p,p,a),d.doc.eq(g))return;let b=d.doc.resolve(p);if(m&&ze.isSelectable(a.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(a.content.firstChild))d.setSelection(new ze(b));else{let v=d.mapping.map(c);d.mapping.maps[d.mapping.maps.length-1].forEach((w,C,k,N)=>v=N),d.setSelection(Nb(t,b,d.doc.resolve(v)))}t.focus(),t.dispatch(d.setMeta("uiEvent","drop"))}$n.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ys(t)},20))};$n.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};$n.beforeinput=(t,e)=>{if(jn&&$s&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,Oa(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in Vn)$n[t]=Vn[t];function iu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Gf{constructor(e,n){this.toDOM=e,this.spec=n||Ua,this.side=this.spec.side||0}map(e,n,r,s){let{pos:a,deleted:l}=e.mapResult(n.from+s,this.side<0?-1:1);return l?null:new yn(a-r,a-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Gf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&iu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Yi{constructor(e,n){this.attrs=e,this.spec=n||Ua}map(e,n,r,s){let a=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,l=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return a>=l?null:new yn(a,l,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Yi&&iu(this.attrs,e.attrs)&&iu(this.spec,e.spec)}static is(e){return e.type instanceof Yi}destroy(){}}class jb{constructor(e,n){this.attrs=e,this.spec=n||Ua}map(e,n,r,s){let a=e.mapResult(n.from+s,1);if(a.deleted)return null;let l=e.mapResult(n.to+s,-1);return l.deleted||l.pos<=a.pos?null:new yn(a.pos-r,l.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),a;return s==n.from&&!(a=e.child(r)).isText&&s+a.nodeSize==n.to}eq(e){return this==e||e instanceof jb&&iu(this.attrs,e.attrs)&&iu(this.spec,e.spec)}destroy(){}}class yn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new yn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new yn(e,e,new Gf(n,r))}static inline(e,n,r,s){return new yn(e,n,new Yi(r,s))}static node(e,n,r,s){return new yn(e,n,new jb(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Yi}get widget(){return this.type instanceof Gf}}const $o=[],Ua={};class Nt{constructor(e,n){this.local=e.length?e:$o,this.children=n.length?n:$o}static create(e,n){return n.length?Yf(n,e,0,Ua):Ln}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,a){for(let l=0;l<this.local.length;l++){let c=this.local[l];c.from<=n&&c.to>=e&&(!a||a(c.spec))&&r.push(c.copy(c.from+s,c.to+s))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<n&&this.children[l+1]>e){let c=this.children[l]+1;this.children[l+2].findInner(e-c,n-c,r,s+c,a)}}map(e,n,r){return this==Ln||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Ua)}mapInner(e,n,r,s,a){let l;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(e,r,s);d&&d.type.valid(n,d)?(l||(l=[])).push(d):a.onRemove&&a.onRemove(this.local[c].spec)}return this.children.length?UI(this.children,l||[],e,n,r,s,a):l?new Nt(l.sort($a),$o):Ln}add(e,n){return n.length?this==Ln?Nt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,a=0;e.forEach((c,d)=>{let p=d+r,m;if(m=vT(n,c,p)){for(s||(s=this.children.slice());a<s.length&&s[a]<d;)a+=3;s[a]==d?s[a+2]=s[a+2].addInner(c,m,p+1):s.splice(a,0,d,d+c.nodeSize,Yf(m,c,p+1,Ua)),a+=3}});let l=yT(a?wT(n):n,-r);for(let c=0;c<l.length;c++)l[c].type.valid(e,l[c])||l.splice(c--,1);return new Nt(l.length?this.local.concat(l).sort($a):this.local,s||this.children)}remove(e){return e.length==0||this==Ln?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let a=0;a<r.length;a+=3){let l,c=r[a]+n,d=r[a+1]+n;for(let m=0,g;m<e.length;m++)(g=e[m])&&g.from>c&&g.to<d&&(e[m]=null,(l||(l=[])).push(g));if(!l)continue;r==this.children&&(r=this.children.slice());let p=r[a+2].removeInner(l,c+1);p!=Ln?r[a+2]=p:(r.splice(a,3),a-=3)}if(s.length){for(let a=0,l;a<e.length;a++)if(l=e[a])for(let c=0;c<s.length;c++)s[c].eq(l,n)&&(s==this.local&&(s=this.local.slice()),s.splice(c--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Nt(s,r):Ln}forChild(e,n){if(this==Ln)return this;if(n.isLeaf)return Nt.empty;let r,s;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=e){this.children[c]==e&&(r=this.children[c+2]);break}let a=e+1,l=a+n.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<l&&d.to>a&&d.type instanceof Yi){let p=Math.max(a,d.from)-a,m=Math.min(l,d.to)-a;p<m&&(s||(s=[])).push(d.copy(p,m))}}if(s){let c=new Nt(s.sort($a),$o);return r?new zi([c,r]):c}return r||Ln}eq(e){if(this==e)return!0;if(!(e instanceof Nt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return _b(this.localsInner(e))}localsInner(e){if(this==Ln)return $o;if(e.inlineContent||!this.local.some(Yi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Yi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Nt.empty=new Nt([],[]);Nt.removeOverlap=_b;const Ln=Nt.empty;class zi{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Ua));return zi.from(r)}forChild(e,n){if(n.isLeaf)return Nt.empty;let r=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(e,n);a!=Ln&&(a instanceof zi?r=r.concat(a.members):r.push(a))}return zi.from(r)}eq(e){if(!(e instanceof zi)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(e);if(a.length)if(!n)n=a;else{r&&(n=n.slice(),r=!1);for(let l=0;l<a.length;l++)n.push(a[l])}}return n?_b(r?n:n.sort($a)):$o}static from(e){switch(e.length){case 0:return Ln;case 1:return e[0];default:return new zi(e.every(n=>n instanceof Nt)?e:e.reduce((n,r)=>n.concat(r instanceof Nt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function UI(t,e,n,r,s,a,l){let c=t.slice();for(let p=0,m=a;p<n.maps.length;p++){let g=0;n.maps[p].forEach((b,v,w,C)=>{let k=C-w-(v-b);for(let N=0;N<c.length;N+=3){let M=c[N+1];if(M<0||b>M+m-g)continue;let _=c[N]+m-g;v>=_?c[N+1]=b<=_?-2:-1:b>=m&&k&&(c[N]+=k,c[N+1]+=k)}g+=k}),m=n.maps[p].map(m,-1)}let d=!1;for(let p=0;p<c.length;p+=3)if(c[p+1]<0){if(c[p+1]==-2){d=!0,c[p+1]=-1;continue}let m=n.map(t[p]+a),g=m-s;if(g<0||g>=r.content.size){d=!0;continue}let b=n.map(t[p+1]+a,-1),v=b-s,{index:w,offset:C}=r.content.findIndex(g),k=r.maybeChild(w);if(k&&C==g&&C+k.nodeSize==v){let N=c[p+2].mapInner(n,k,m+1,t[p]+a+1,l);N!=Ln?(c[p]=g,c[p+1]=v,c[p+2]=N):(c[p+1]=-2,d=!0)}else d=!0}if(d){let p=$I(c,t,e,n,s,a,l),m=Yf(p,r,0,l);e=m.local;for(let g=0;g<c.length;g+=3)c[g+1]<0&&(c.splice(g,3),g-=3);for(let g=0,b=0;g<m.children.length;g+=3){let v=m.children[g];for(;b<c.length&&c[b]<v;)b+=3;c.splice(b,0,m.children[g],m.children[g+1],m.children[g+2])}}return new Nt(e.sort($a),c)}function yT(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new yn(s.from+e,s.to+e,s.type))}return n}function $I(t,e,n,r,s,a,l){function c(d,p){for(let m=0;m<d.local.length;m++){let g=d.local[m].map(r,s,p);g?n.push(g):l.onRemove&&l.onRemove(d.local[m].spec)}for(let m=0;m<d.children.length;m+=3)c(d.children[m+2],d.children[m]+p+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],e[d]+a+1);return n}function vT(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let a=0,l;a<t.length;a++)(l=t[a])&&l.from>n&&l.to<r&&((s||(s=[])).push(l),t[a]=null);return s}function wT(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Yf(t,e,n,r){let s=[],a=!1;e.forEach((c,d)=>{let p=vT(t,c,d+n);if(p){a=!0;let m=Yf(p,c,n+d+1,r);m!=Ln&&s.push(d,d+c.nodeSize,m)}});let l=yT(a?wT(t):t,-n).sort($a);for(let c=0;c<l.length;c++)l[c].type.valid(e,l[c])||(r.onRemove&&r.onRemove(l[c].spec),l.splice(c--,1));return l.length||s.length?new Nt(l,s):Ln}function $a(t,e){return t.from-e.from||t.to-e.to}function _b(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let a=e[s];if(a.from==r.from){a.to!=r.to&&(e==t&&(e=t.slice()),e[s]=a.copy(a.from,r.to),Dk(e,s+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,a.from),Dk(e,s,r.copy(a.from,r.to)));break}}}return e}function Dk(t,e,n){for(;e<t.length&&$a(n,t[e])>0;)e++;t.splice(e,0,n)}function Qg(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Ln&&e.push(r)}),t.cursorWrapper&&e.push(Nt.create(t.state.doc,[t.cursorWrapper.deco])),zi.from(e)}const VI={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},qI=ar&&Ki<=11;class WI{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class KI{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new WI,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);ar&&Ki<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():In&&e.composing&&r.some(s=>s.type=="childList"&&s.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),qI&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,VI)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Nk(this.view)){if(this.suppressingSelectionUpdates)return Ys(this.view);if(ar&&Ki<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ya(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let a=e.focusNode;a;a=ll(a))n.add(a);for(let a=e.anchorNode;a;a=ll(a))if(n.has(a)){r=a;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Nk(e)&&!this.ignoreSelectionChange(r),a=-1,l=-1,c=!1,d=[];if(e.editable)for(let m=0;m<n.length;m++){let g=this.registerMutation(n[m],d);g&&(a=a<0?g.from:Math.min(g.from,a),l=l<0?g.to:Math.max(g.to,l),g.typeOver&&(c=!0))}if(d.some(m=>m.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let m of d)if(m.nodeName=="BR"&&m.parentNode){let g=m.nextSibling;g&&g.nodeType==1&&g.contentEditable=="false"&&m.parentNode.removeChild(m)}}else if(Dr&&d.length){let m=d.filter(g=>g.nodeName=="BR");if(m.length==2){let[g,b]=m;g.parentNode&&g.parentNode.parentNode==b.parentNode?b.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let b of m){let v=b.parentNode;v&&v.nodeName=="LI"&&(!g||JI(e,g)!=v)&&b.remove()}}}let p=null;a<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&tp(r)&&(p=Eb(e))&&p.eq($e.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ys(e),this.currentSelection.set(r),e.scrollToSelection()):(a>-1||s)&&(a>-1&&(e.docView.markDirty(a,l),GI(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,XI(e,d)),this.handleDOMChange(a,l,c,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ys(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let m=0;m<e.addedNodes.length;m++){let g=e.addedNodes[m];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,a=e.nextSibling;if(ar&&Ki<=11&&e.addedNodes.length)for(let m=0;m<e.addedNodes.length;m++){let{previousSibling:g,nextSibling:b}=e.addedNodes[m];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(s=g),(!b||Array.prototype.indexOf.call(e.addedNodes,b)<0)&&(a=b)}let l=s&&s.parentNode==e.target?Mn(s)+1:0,c=r.localPosFromDOM(e.target,l,-1),d=a&&a.parentNode==e.target?Mn(a):e.target.childNodes.length,p=r.localPosFromDOM(e.target,d,1);return{from:c,to:p}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Lk=new WeakMap,Ik=!1;function GI(t){if(!Lk.has(t)&&(Lk.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Dr,Ik)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Ik=!0}}function zk(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,a=e.endOffset,l=t.domAtPos(t.state.selection.anchor);return Ya(l.node,l.offset,s,a)&&([n,r,s,a]=[s,a,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:a}}function YI(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return zk(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?zk(t,n):null}function JI(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function XI(t,e){var n;let{focusNode:r,focusOffset:s}=t.domSelectionRange();for(let a of e)if(((n=a.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let l=a.nextSibling;for(;l&&l.nodeName!="TD"&&l.nodeName!="TH";)l=l.nextSibling;if(l){let c=l;for(;;){let d=c.firstChild;if(!d||d.nodeType!=1||d.contentEditable=="false"||/^(BR|IMG)$/.test(d.nodeName))break;c=d}c.insertBefore(a,c.firstChild),r==a&&t.domSelection().collapse(a,s)}else a.parentNode.removeChild(a)}}function QI(t,e,n){let{node:r,fromOffset:s,toOffset:a,from:l,to:c}=t.docView.parseRange(e,n),d=t.domSelectionRange(),p,m=d.anchorNode;if(m&&t.dom.contains(m.nodeType==1?m:m.parentNode)&&(p=[{node:m,offset:d.anchorOffset}],tp(d)||p.push({node:d.focusNode,offset:d.focusOffset})),jn&&t.input.lastKeyCode===8)for(let k=a;k>s;k--){let N=r.childNodes[k-1],M=N.pmViewDesc;if(N.nodeName=="BR"&&!M){a=k;break}if(!M||M.size)break}let g=t.state.doc,b=t.someProp("domParser")||Dc.fromSchema(t.state.schema),v=g.resolve(l),w=null,C=b.parse(r,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:s,to:a,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:p,ruleFromNode:ZI,context:v});if(p&&p[0].pos!=null){let k=p[0].pos,N=p[1]&&p[1].pos;N==null&&(N=k),w={anchor:k+l,head:N+l}}return{doc:C,sel:w,from:l,to:c}}function ZI(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(In&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||In&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ez=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function tz(t,e,n,r,s){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,F=Eb(t,O);if(F&&!t.state.selection.eq(F)){if(jn&&$s&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",Z=>Z(t,Oa(13,"Enter"))))return;let V=t.state.tr.setSelection(F);O=="pointer"?V.setMeta("pointer",!0):O=="key"&&V.scrollIntoView(),a&&V.setMeta("composition",a),t.dispatch(V)}return}let l=t.state.doc.resolve(e),c=l.sharedDepth(n);e=l.before(c+1),n=t.state.doc.resolve(n).after(c+1);let d=t.state.selection,p=QI(t,e,n),m=t.state.doc,g=m.slice(p.from,p.to),b,v;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(b=t.state.selection.to,v="end"):(b=t.state.selection.from,v="start"),t.input.lastKeyCode=null;let w=sz(g.content,p.doc.content,p.from,b,v);if(w&&t.input.domChangeCount++,(cl&&t.input.lastIOSEnter>Date.now()-225||$s)&&s.some(O=>O.nodeType==1&&!ez.test(O.nodeName))&&(!w||w.endA>=w.endB)&&t.someProp("handleKeyDown",O=>O(t,Oa(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!w)if(r&&d instanceof Be&&!d.empty&&d.$head.sameParent(d.$anchor)&&!t.composing&&!(p.sel&&p.sel.anchor!=p.sel.head))w={start:d.from,endA:d.to,endB:d.to};else{if(p.sel){let O=Bk(t,t.state.doc,p.sel);if(O&&!O.eq(t.state.selection)){let F=t.state.tr.setSelection(O);a&&F.setMeta("composition",a),t.dispatch(F)}}return}t.state.selection.from<t.state.selection.to&&w.start==w.endB&&t.state.selection instanceof Be&&(w.start>t.state.selection.from&&w.start<=t.state.selection.from+2&&t.state.selection.from>=p.from?w.start=t.state.selection.from:w.endA<t.state.selection.to&&w.endA>=t.state.selection.to-2&&t.state.selection.to<=p.to&&(w.endB+=t.state.selection.to-w.endA,w.endA=t.state.selection.to)),ar&&Ki<=11&&w.endB==w.start+1&&w.endA==w.start&&w.start>p.from&&p.doc.textBetween(w.start-p.from-1,w.start-p.from+1)==" "&&(w.start--,w.endA--,w.endB--);let C=p.doc.resolveNoCache(w.start-p.from),k=p.doc.resolveNoCache(w.endB-p.from),N=m.resolve(w.start),M=C.sameParent(k)&&C.parent.inlineContent&&N.end()>=w.endA;if((cl&&t.input.lastIOSEnter>Date.now()-225&&(!M||s.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!M&&C.pos<p.doc.content.size&&(!C.sameParent(k)||!C.parent.inlineContent)&&C.pos<k.pos&&!/\S/.test(p.doc.textBetween(C.pos,k.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,Oa(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>w.start&&rz(m,w.start,w.endA,C,k)&&t.someProp("handleKeyDown",O=>O(t,Oa(8,"Backspace")))){$s&&jn&&t.domObserver.suppressSelectionUpdates();return}jn&&w.endB==w.start&&(t.input.lastChromeDelete=Date.now()),$s&&!M&&C.start()!=k.start()&&k.parentOffset==0&&C.depth==k.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==w.endA&&(w.endB-=2,k=p.doc.resolveNoCache(w.endB-p.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,Oa(13,"Enter"))})},20));let _=w.start,P=w.endA,z=O=>{let F=O||t.state.tr.replace(_,P,p.doc.slice(w.start-p.from,w.endB-p.from));if(p.sel){let V=Bk(t,F.doc,p.sel);V&&!(jn&&t.composing&&V.empty&&(w.start!=w.endB||t.input.lastChromeDelete<Date.now()-100)&&(V.head==_||V.head==F.mapping.map(P)-1)||ar&&V.empty&&V.head==_)&&F.setSelection(V)}return a&&F.setMeta("composition",a),F.scrollIntoView()},K;if(M)if(C.pos==k.pos){ar&&Ki<=11&&C.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ys(t),20));let O=z(t.state.tr.delete(_,P)),F=m.resolve(w.start).marksAcross(m.resolve(w.endA));F&&O.ensureMarks(F),t.dispatch(O)}else if(w.endA==w.endB&&(K=nz(C.parent.content.cut(C.parentOffset,k.parentOffset),N.parent.content.cut(N.parentOffset,w.endA-N.start())))){let O=z(t.state.tr);K.type=="add"?O.addMark(_,P,K.mark):O.removeMark(_,P,K.mark),t.dispatch(O)}else if(C.parent.child(C.index()).isText&&C.index()==k.index()-(k.textOffset?0:1)){let O=C.parent.textBetween(C.parentOffset,k.parentOffset),F=()=>z(t.state.tr.insertText(O,_,P));t.someProp("handleTextInput",V=>V(t,_,P,O,F))||t.dispatch(F())}else t.dispatch(z());else t.dispatch(z())}function Bk(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Nb(t,e.resolve(n.anchor),e.resolve(n.head))}function nz(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,a=r,l,c,d;for(let m=0;m<r.length;m++)s=r[m].removeFromSet(s);for(let m=0;m<n.length;m++)a=n[m].removeFromSet(a);if(s.length==1&&a.length==0)c=s[0],l="add",d=m=>m.mark(c.addToSet(m.marks));else if(s.length==0&&a.length==1)c=a[0],l="remove",d=m=>m.mark(c.removeFromSet(m.marks));else return null;let p=[];for(let m=0;m<e.childCount;m++)p.push(d(e.child(m)));if(fe.from(p).eq(t))return{mark:c,type:l}}function rz(t,e,n,r,s){if(n-e<=s.pos-r.pos||Zg(r,!0,!1)<s.pos)return!1;let a=t.resolve(e);if(!r.parent.isTextblock){let c=a.nodeAfter;return c!=null&&n==e+c.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let l=t.resolve(Zg(a,!0,!0));return!l.parent.isTextblock||l.pos>n||Zg(l,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function Zg(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let a=t.node(r).maybeChild(t.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function sz(t,e,n,r,s){let a=t.findDiffStart(e,n);if(a==null)return null;let{a:l,b:c}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let d=Math.max(0,a-Math.min(l,c));r-=l+d-a}if(l<a&&t.size<e.size){let d=r<=a&&r>=l?a-r:0;a-=d,a&&a<e.size&&Pk(e.textBetween(a-1,a+1))&&(a+=d?1:-1),c=a+(c-l),l=a}else if(c<a){let d=r<=a&&r>=c?a-r:0;a-=d,a&&a<t.size&&Pk(t.textBetween(a-1,a+1))&&(a+=d?1:-1),l=a+(l-c),c=a}return{start:a,endA:l,endB:c}}function Pk(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class kT{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new vI,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Vk),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Uk(this),Fk(this),this.nodeViews=$k(this),this.docView=vk(this.state.doc,Hk(this),Qg(this),this.dom,this),this.domObserver=new KI(this,(r,s,a,l)=>tz(this,r,s,a,l)),this.domObserver.start(),wI(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&yx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Vk),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,a=!1,l=!1;e.storedMarks&&this.composing&&(mT(this),l=!0),this.state=e;let c=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(c||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let v=$k(this);az(v,this.nodeViews)&&(this.nodeViews=v,a=!0)}(c||n.handleDOMEvents!=this._props.handleDOMEvents)&&yx(this),this.editable=Uk(this),Fk(this);let d=Qg(this),p=Hk(this),m=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",g=a||!this.docView.matchesNode(e.doc,p,d);(g||!e.selection.eq(s.selection))&&(l=!0);let b=m=="preserve"&&l&&this.dom.style.overflowAnchor==null&&LL(this);if(l){this.domObserver.stop();let v=g&&(ar||jn)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&iz(s.selection,e.selection);if(g){let w=jn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=LI(this)),(a||!this.docView.update(e.doc,p,d,this))&&(this.docView.updateOuterDeco(p),this.docView.destroy(),this.docView=vk(e.doc,p,d,this.dom,this)),w&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&iI(this))?Ys(this,v):(rT(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),m=="reset"?this.dom.scrollTop=0:m=="to selection"?this.scrollToSelection():b&&IL(b)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ze){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&pk(this,n.getBoundingClientRect(),e)}else pk(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let a=r.from+(this.state.doc.content.size-n.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==r.node&&(s=a)}this.dragging=new xT(e.slice,e.move,s<0?void 0:ze.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let l=0;l<this.directPlugins.length;l++){let c=this.directPlugins[l].props[e];if(c!=null&&(s=n?n(c):c))return s}let a=this.state.plugins;if(a)for(let l=0;l<a.length;l++){let c=a[l].props[e];if(c!=null&&(s=n?n(c):c))return s}}hasFocus(){if(ar){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&zL(this.dom),Ys(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return UL(this,e)}coordsAtPos(e,n=1){return YN(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return KL(this,n||this.state,e)}pasteHTML(e,n){return su(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return su(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Tb(this,e)}destroy(){this.docView&&(kI(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Qg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,EL())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return SI(this,e)}domSelectionRange(){let e=this.domSelection();return e?In&&this.root.nodeType===11&&OL(this.dom.ownerDocument)==this.dom&&YI(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}kT.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function Hk(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[yn.node(0,t.state.doc.content.size,e)]}function Fk(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:yn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Uk(t){return!t.someProp("editable",e=>e(t.state)===!1)}function iz(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function $k(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function az(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function Vk(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Qi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Jf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},oz=typeof navigator<"u"&&/Mac/.test(navigator.platform),lz=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var On=0;On<10;On++)Qi[48+On]=Qi[96+On]=String(On);for(var On=1;On<=24;On++)Qi[On+111]="F"+On;for(var On=65;On<=90;On++)Qi[On]=String.fromCharCode(On+32),Jf[On]=String.fromCharCode(On);for(var e0 in Qi)Jf.hasOwnProperty(e0)||(Jf[e0]=Qi[e0]);function cz(t){var e=oz&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||lz&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Jf:Qi)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const uz=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),dz=typeof navigator<"u"&&/Win/.test(navigator.platform);function fz(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,a,l;for(let c=0;c<e.length-1;c++){let d=e[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))uz?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),l&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function hz(t){let e=Object.create(null);for(let n in t)e[fz(n)]=t[n];return e}function t0(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function pz(t){return new Rt({props:{handleKeyDown:Rb(t)}})}function Rb(t){let e=hz(t);return function(n,r){let s=cz(r),a,l=e[t0(s,r)];if(l&&l(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let c=e[t0(s,r,!1)];if(c&&c(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(dz&&r.ctrlKey&&r.altKey)&&(a=Qi[r.keyCode])&&a!=s){let c=e[t0(a,r)];if(c&&c(n.state,n.dispatch,n))return!0}}return!1}}var mz=Object.defineProperty,Db=(t,e)=>{for(var n in e)mz(t,n,{get:e[n],enumerable:!0})};function sp(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:a}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,a=n.storedMarks,n}}}var ip=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,a=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...p)=>{const m=c(...p)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:a}=r,l=[],c=!!t,d=t||s.tr,p=()=>(!c&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(d),l.every(g=>g===!0)),m={...Object.fromEntries(Object.entries(n).map(([g,b])=>[g,(...w)=>{const C=this.buildProps(d,e),k=b(...w)(C);return l.push(k),m}])),run:p};return m}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,a=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([c,d])=>[c,(...p)=>d(...p)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:a}=r,l={tr:t,editor:r,view:a,state:sp({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...p)=>d(...p)(l)]))}};return l}},CT={};Db(CT,{blur:()=>gz,clearContent:()=>xz,clearNodes:()=>bz,command:()=>yz,createParagraphNear:()=>vz,cut:()=>wz,deleteCurrentNode:()=>kz,deleteNode:()=>Cz,deleteRange:()=>Sz,deleteSelection:()=>Ez,enter:()=>Nz,exitCode:()=>Tz,extendMarkRange:()=>Az,first:()=>Mz,focus:()=>jz,forEach:()=>_z,insertContent:()=>Rz,insertContentAt:()=>Iz,joinBackward:()=>Pz,joinDown:()=>Bz,joinForward:()=>Hz,joinItemBackward:()=>Fz,joinItemForward:()=>Uz,joinTextblockBackward:()=>$z,joinTextblockForward:()=>Vz,joinUp:()=>zz,keyboardShortcut:()=>Wz,lift:()=>Kz,liftEmptyBlock:()=>Gz,liftListItem:()=>Yz,newlineInCode:()=>Jz,resetAttributes:()=>Xz,scrollIntoView:()=>Qz,selectAll:()=>Zz,selectNodeBackward:()=>e8,selectNodeForward:()=>t8,selectParentNode:()=>n8,selectTextblockEnd:()=>r8,selectTextblockStart:()=>s8,setContent:()=>i8,setMark:()=>S8,setMeta:()=>E8,setNode:()=>N8,setNodeSelection:()=>T8,setTextDirection:()=>A8,setTextSelection:()=>M8,sinkListItem:()=>O8,splitBlock:()=>j8,splitListItem:()=>_8,toggleList:()=>R8,toggleMark:()=>D8,toggleNode:()=>L8,toggleWrap:()=>I8,undoInputRule:()=>z8,unsetAllMarks:()=>B8,unsetMark:()=>P8,unsetTextDirection:()=>H8,updateAttributes:()=>F8,wrapIn:()=>U8,wrapInList:()=>$8});var gz=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),xz=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),bz=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:a,$to:l})=>{t.doc.nodesBetween(a.pos,l.pos,(c,d)=>{if(c.type.isText)return;const{doc:p,mapping:m}=e,g=p.resolve(m.map(d)),b=p.resolve(m.map(d+c.nodeSize)),v=g.blockRange(b);if(!v)return;const w=vl(v);if(c.type.isTextblock){const{defaultType:C}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(v.start,C)}(w||w===0)&&e.lift(v,w)})}),!0},yz=t=>e=>t(e),vz=()=>({state:t,dispatch:e})=>BN(t,e),wz=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,a=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const l=r.mapping.map(e);return r.insert(l,a.content),r.setSelection(new Be(r.doc.resolve(Math.max(l-1,0)))),!0},kz=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===r.type){if(e){const c=s.before(a),d=s.after(a);t.delete(c,d).scrollIntoView()}return!0}return!1};function sn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var Cz=t=>({tr:e,state:n,dispatch:r})=>{const s=sn(t,n.schema),a=e.selection.$anchor;for(let l=a.depth;l>0;l-=1)if(a.node(l).type===s){if(r){const d=a.before(l),p=a.after(l);e.delete(d,p).scrollIntoView()}return!0}return!1},Sz=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},Ez=()=>({state:t,dispatch:e})=>yb(t,e),Nz=()=>({commands:t})=>t.keyboardShortcut("Enter"),Tz=()=>({state:t,dispatch:e})=>uL(t,e);function Lb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Xf(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:Lb(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function ST(t,e,n={}){return t.find(r=>r.type===e&&Xf(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function qk(t,e,n={}){return!!ST(t,e,n)}function Ib(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(m=>m.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(m=>m.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!ST([...s.node.marks],e,n)))return;let l=s.index,c=t.start()+s.offset,d=l+1,p=c+s.node.nodeSize;for(;l>0&&qk([...t.parent.child(l-1).marks],e,n);)l-=1,c-=t.parent.child(l).nodeSize;for(;d<t.parent.childCount&&qk([...t.parent.child(d).marks],e,n);)p+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:p}}function ti(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var Az=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const a=ti(t,r.schema),{doc:l,selection:c}=n,{$from:d,from:p,to:m}=c;if(s){const g=Ib(d,a,e);if(g&&g.from<=p&&g.to>=m){const b=Be.create(l,g.from,g.to);n.setSelection(b)}}return!0},Mz=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function ET(t){return t instanceof Be}function La(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function NT(t,e=null){if(!e)return null;const n=$e.atStart(t),r=$e.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,a=r.to;return e==="all"?Be.create(t,La(0,s,a),La(t.content.size,s,a)):Be.create(t,La(e,s,a),La(e,s,a))}function Wk(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Qf(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function Oz(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var jz=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:a})=>{e={scrollIntoView:!0,...e};const l=()=>{(Qf()||Wk())&&r.dom.focus(),Oz()&&!Qf()&&!Wk()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};try{if(r.hasFocus()&&t===null||t===!1)return!0}catch{return!1}if(a&&t===null&&!ET(n.state.selection))return l(),!0;const c=NT(s.doc,t)||n.state.selection,d=n.state.selection.eq(c);return a&&(d||s.setSelection(c),d&&s.storedMarks&&s.setStoredMarks(s.storedMarks),l()),!0},_z=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),Rz=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),TT=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&TT(r)}return t};function Gd(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return TT(n)}function au(t,e,n){if(t instanceof $r||t instanceof fe)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return fe.fromArray(t.map(c=>e.nodeFromJSON(c)));const l=e.nodeFromJSON(t);return n.errorOnInvalidContent&&l.check(),l}catch(a){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),au("",e,n)}if(s){if(n.errorOnInvalidContent){let l=!1,c="";const d=new dN({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:p=>(l=!0,c=typeof p=="string"?p:p.outerHTML,null)}]}})});if(n.slice?Dc.fromSchema(d).parseSlice(Gd(t),n.parseOptions):Dc.fromSchema(d).parse(Gd(t),n.parseOptions),n.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const a=Dc.fromSchema(e);return n.slice?a.parseSlice(Gd(t),n.parseOptions).content:a.parse(Gd(t),n.parseOptions)}return au("",e,n)}function Dz(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof bn||s instanceof vn))return;const a=t.mapping.maps[r];let l=0;a.forEach((c,d,p,m)=>{l===0&&(l=m)}),t.setSelection($e.near(t.doc.resolve(l),n))}var Lz=t=>!("type"in t),Iz=(t,e,n)=>({tr:r,dispatch:s,editor:a})=>{var l;if(s){n={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=k=>{a.emit("contentError",{editor:a,error:k,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},p={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{au(e,a.schema,{parseOptions:p,errorOnInvalidContent:!0})}catch(k){d(k)}try{c=au(e,a.schema,{parseOptions:p,errorOnInvalidContent:(l=n.errorOnInvalidContent)!=null?l:a.options.enableContentCheck})}catch(k){return d(k),!1}let{from:m,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},b=!0,v=!0;if((Lz(c)?c:[c]).forEach(k=>{k.check(),b=b?k.isText&&k.marks.length===0:!1,v=v?k.isBlock:!1}),m===g&&v){const{parent:k}=r.doc.resolve(m);k.isTextblock&&!k.type.spec.code&&!k.childCount&&(m-=1,g+=1)}let C;if(b){if(Array.isArray(e))C=e.map(k=>k.text||"").join("");else if(e instanceof fe){let k="";e.forEach(N=>{N.text&&(k+=N.text)}),C=k}else typeof e=="object"&&e&&e.text?C=e.text:C=e;r.insertText(C,m,g)}else{C=c;const k=r.doc.resolve(m),N=k.node(),M=k.parentOffset===0,_=N.isText||N.isTextblock,P=N.content.size>0;M&&_&&P&&(m=Math.max(0,m-1)),r.replaceWith(m,g,C)}n.updateSelection&&Dz(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:m,text:C}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:m,text:C})}return!0},zz=()=>({state:t,dispatch:e})=>oL(t,e),Bz=()=>({state:t,dispatch:e})=>lL(t,e),Pz=()=>({state:t,dispatch:e})=>jN(t,e),Hz=()=>({state:t,dispatch:e})=>LN(t,e),Fz=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Qh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},Uz=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Qh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},$z=()=>({state:t,dispatch:e})=>iL(t,e),Vz=()=>({state:t,dispatch:e})=>aL(t,e);function AT(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function qz(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,a,l;for(let c=0;c<e.length-1;c+=1){const d=e[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))Qf()||AT()?l=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),l&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}var Wz=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const a=qz(t).split(/-(?!$)/),l=a.find(p=>!["Alt","Ctrl","Meta","Shift"].includes(p)),c=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{n.someProp("handleKeyDown",p=>p(n,c))});return d==null||d.steps.forEach(p=>{const m=p.map(r.mapping);m&&s&&r.maybeStep(m)}),!0};function Zi(t,e,n={}){const{from:r,to:s,empty:a}=t.selection,l=e?sn(e,t.schema):null,c=[];t.doc.nodesBetween(r,s,(g,b)=>{if(g.isText)return;const v=Math.max(r,b),w=Math.min(s,b+g.nodeSize);c.push({node:g,from:v,to:w})});const d=s-r,p=c.filter(g=>l?l.name===g.node.type.name:!0).filter(g=>Xf(g.node.attrs,n,{strict:!1}));return a?!!p.length:p.reduce((g,b)=>g+b.to-b.from,0)>=d}var Kz=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return Zi(n,s,e)?cL(n,r):!1},Gz=()=>({state:t,dispatch:e})=>PN(t,e),Yz=t=>({state:e,dispatch:n})=>{const r=sn(t,e.schema);return wL(r)(e,n)},Jz=()=>({state:t,dispatch:e})=>zN(t,e);function ap(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Kk(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var Xz=(t,e)=>({tr:n,state:r,dispatch:s})=>{let a=null,l=null;const c=ap(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(a=sn(t,r.schema)),c==="mark"&&(l=ti(t,r.schema));let d=!1;return n.selection.ranges.forEach(p=>{r.doc.nodesBetween(p.$from.pos,p.$to.pos,(m,g)=>{a&&a===m.type&&(d=!0,s&&n.setNodeMarkup(g,void 0,Kk(m.attrs,e))),l&&m.marks.length&&m.marks.forEach(b=>{l===b.type&&(d=!0,s&&n.addMark(g,g+m.nodeSize,l.create(Kk(b.attrs,e))))})})}),d},Qz=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),Zz=()=>({tr:t,dispatch:e})=>{if(e){const n=new br(t.doc);t.setSelection(n)}return!0},e8=()=>({state:t,dispatch:e})=>RN(t,e),t8=()=>({state:t,dispatch:e})=>IN(t,e),n8=()=>({state:t,dispatch:e})=>hL(t,e),r8=()=>({state:t,dispatch:e})=>gL(t,e),s8=()=>({state:t,dispatch:e})=>mL(t,e);function vx(t,e,n={},r={}){return au(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var i8=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:a,dispatch:l,commands:c})=>{const{doc:d}=a;if(r.preserveWhitespace!=="full"){const p=vx(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return l&&a.replaceWith(0,d.content.size,p).setMeta("preventUpdate",!n),!0}return l&&a.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function MT(t,e){const n=ti(e,t.schema),{from:r,to:s,empty:a}=t.selection,l=[];a?(t.storedMarks&&l.push(...t.storedMarks),l.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,d=>{l.push(...d.marks)});const c=l.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function OT(t,e){const n=new xb(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function a8(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function o8(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,a)=>{n(s)&&r.push({node:s,pos:a})}),r}function jT(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function op(t){return e=>jT(e.$from,t)}function Le(t,e,n){return t.config[e]===void 0&&t.parent?Le(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Le(t.parent,e,n):null}):t.config[e]}function zb(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Le(e,"addExtensions",n);return r?[e,...zb(r())]:e}).flat(10)}function Bb(t,e){const n=no.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function _T(t){return typeof t=="function"}function ht(t,e=void 0,...n){return _T(t)?e?t.bind(e)(...n):t(...n):t}function l8(t={}){return Object.keys(t).length===0&&t.constructor===Object}function ul(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function RT(t){const e=[],{nodeExtensions:n,markExtensions:r}=ul(t),s=[...n,...r],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(l=>{const c={name:l.name,options:l.options,storage:l.storage,extensions:s},d=Le(l,"addGlobalAttributes",c);if(!d)return;d().forEach(m=>{m.types.forEach(g=>{Object.entries(m.attributes).forEach(([b,v])=>{e.push({type:g,name:b,attribute:{...a,...v}})})})})}),s.forEach(l=>{const c={name:l.name,options:l.options,storage:l.storage},d=Le(l,"addAttributes",c);if(!d)return;const p=d();Object.entries(p).forEach(([m,g])=>{const b={...a,...g};typeof(b==null?void 0:b.default)=="function"&&(b.default=b.default()),b!=null&&b.isRequired&&(b==null?void 0:b.default)===void 0&&delete b.default,e.push({type:l.name,name:m,attribute:b})})}),e}function _t(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,a])=>{if(!r[s]){r[s]=a;return}if(s==="class"){const c=a?String(a).split(" "):[],d=r[s]?r[s].split(" "):[],p=c.filter(m=>!d.includes(m));r[s]=[...d,...p].join(" ")}else if(s==="style"){const c=a?a.split(";").map(m=>m.trim()).filter(Boolean):[],d=r[s]?r[s].split(";").map(m=>m.trim()).filter(Boolean):[],p=new Map;d.forEach(m=>{const[g,b]=m.split(":").map(v=>v.trim());p.set(g,b)}),c.forEach(m=>{const[g,b]=m.split(":").map(v=>v.trim());p.set(g,b)}),r[s]=Array.from(p.entries()).map(([m,g])=>`${m}: ${g}`).join("; ")}else r[s]=a}),r},{})}function ou(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>_t(n,r),{})}function c8(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Gk(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((a,l)=>{const c=l.attribute.parseHTML?l.attribute.parseHTML(n):c8(n.getAttribute(l.name));return c==null?a:{...a,[l.name]:c}},{});return{...r,...s}}}}function Yk(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&l8(n)?!1:n!=null))}function Jk(t){var e,n;const r={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(r.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function u8(t,e){var n;const r=RT(t),{nodeExtensions:s,markExtensions:a}=ul(t),l=(n=s.find(p=>Le(p,"topNode")))==null?void 0:n.name,c=Object.fromEntries(s.map(p=>{const m=r.filter(N=>N.type===p.name),g={name:p.name,options:p.options,storage:p.storage,editor:e},b=t.reduce((N,M)=>{const _=Le(M,"extendNodeSchema",g);return{...N,..._?_(p):{}}},{}),v=Yk({...b,content:ht(Le(p,"content",g)),marks:ht(Le(p,"marks",g)),group:ht(Le(p,"group",g)),inline:ht(Le(p,"inline",g)),atom:ht(Le(p,"atom",g)),selectable:ht(Le(p,"selectable",g)),draggable:ht(Le(p,"draggable",g)),code:ht(Le(p,"code",g)),whitespace:ht(Le(p,"whitespace",g)),linebreakReplacement:ht(Le(p,"linebreakReplacement",g)),defining:ht(Le(p,"defining",g)),isolating:ht(Le(p,"isolating",g)),attrs:Object.fromEntries(m.map(Jk))}),w=ht(Le(p,"parseHTML",g));w&&(v.parseDOM=w.map(N=>Gk(N,m)));const C=Le(p,"renderHTML",g);C&&(v.toDOM=N=>C({node:N,HTMLAttributes:ou(N,m)}));const k=Le(p,"renderText",g);return k&&(v.toText=k),[p.name,v]})),d=Object.fromEntries(a.map(p=>{const m=r.filter(k=>k.type===p.name),g={name:p.name,options:p.options,storage:p.storage,editor:e},b=t.reduce((k,N)=>{const M=Le(N,"extendMarkSchema",g);return{...k,...M?M(p):{}}},{}),v=Yk({...b,inclusive:ht(Le(p,"inclusive",g)),excludes:ht(Le(p,"excludes",g)),group:ht(Le(p,"group",g)),spanning:ht(Le(p,"spanning",g)),code:ht(Le(p,"code",g)),attrs:Object.fromEntries(m.map(Jk))}),w=ht(Le(p,"parseHTML",g));w&&(v.parseDOM=w.map(k=>Gk(k,m)));const C=Le(p,"renderHTML",g);return C&&(v.toDOM=k=>C({mark:k,HTMLAttributes:ou(k,m)})),[p.name,v]}));return new dN({topNode:l,nodes:c,marks:d})}function d8(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Zf(t){return t.sort((n,r)=>{const s=Le(n,"priority")||100,a=Le(r,"priority")||100;return s>a?-1:s<a?1:0})}function DT(t){const e=Zf(zb(t)),n=d8(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function LT(t,e,n){const{from:r,to:s}=e,{blockSeparator:a=`

`,textSerializers:l={}}=n||{};let c="";return t.nodesBetween(r,s,(d,p,m,g)=>{var b;d.isBlock&&p>r&&(c+=a);const v=l==null?void 0:l[d.type.name];if(v)return m&&(c+=v({node:d,pos:p,parent:m,index:g,range:e})),!1;d.isText&&(c+=(b=d==null?void 0:d.text)==null?void 0:b.slice(Math.max(r,p)-p,s-p))}),c}function f8(t,e){const n={from:0,to:t.content.size};return LT(t,n,e)}function IT(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function h8(t,e){const n=sn(e,t.schema),{from:r,to:s}=t.selection,a=[];t.doc.nodesBetween(r,s,c=>{a.push(c)});const l=a.reverse().find(c=>c.type.name===n.name);return l?{...l.attrs}:{}}function zT(t,e){const n=ap(typeof e=="string"?e:e.name,t.schema);return n==="node"?h8(t,e):n==="mark"?MT(t,e):{}}function p8(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function m8(t){const e=p8(t);return e.length===1?e:e.filter((n,r)=>!e.filter((a,l)=>l!==r).some(a=>n.oldRange.from>=a.oldRange.from&&n.oldRange.to<=a.oldRange.to&&n.newRange.from>=a.newRange.from&&n.newRange.to<=a.newRange.to))}function BT(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,a)=>{const l=[];if(s.ranges.length)s.forEach((c,d)=>{l.push({from:c,to:d})});else{const{from:c,to:d}=n[a];if(c===void 0||d===void 0)return;l.push({from:c,to:d})}l.forEach(({from:c,to:d})=>{const p=e.slice(a).map(c,-1),m=e.slice(a).map(d),g=e.invert().map(p,-1),b=e.invert().map(m);r.push({oldRange:{from:g,to:b},newRange:{from:p,to:m}})})}),m8(r)}function Pb(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const a=n.resolve(t),l=Ib(a,s.type);l&&r.push({mark:s,...l})}):n.nodesBetween(t,e,(s,a)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(l=>({from:a,to:a+s.nodeSize,mark:l})))}),r}var g8=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let a=r,l=null;for(;a>0&&l===null;){const c=s.node(a);(c==null?void 0:c.type.name)===e?l=c:a-=1}return[l,a]};function Yd(t,e){return e.nodes[t]||e.marks[t]||null}function bf(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(a=>a.type===e&&a.name===r);return s?s.attribute.keepOnSplit:!1}))}var x8=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,a,l,c)=>{var d,p;const m=((p=(d=s.type.spec).toText)==null?void 0:p.call(d,{node:s,pos:a,parent:l,index:c}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?m:m.slice(0,Math.max(0,r-a))}),n};function wx(t,e,n={}){const{empty:r,ranges:s}=t.selection,a=e?ti(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>a?a.name===g.type.name:!0).find(g=>Xf(g.attrs,n,{strict:!1}));let l=0;const c=[];if(s.forEach(({$from:g,$to:b})=>{const v=g.pos,w=b.pos;t.doc.nodesBetween(v,w,(C,k)=>{if(!C.isText&&!C.marks.length)return;const N=Math.max(v,k),M=Math.min(w,k+C.nodeSize),_=M-N;l+=_,c.push(...C.marks.map(P=>({mark:P,from:N,to:M})))})}),l===0)return!1;const d=c.filter(g=>a?a.name===g.mark.type.name:!0).filter(g=>Xf(g.mark.attrs,n,{strict:!1})).reduce((g,b)=>g+b.to-b.from,0),p=c.filter(g=>a?g.mark.type!==a&&g.mark.type.excludes(a):!0).reduce((g,b)=>g+b.to-b.from,0);return(d>0?d+p:d)>=l}function b8(t,e,n={}){if(!e)return Zi(t,null,n)||wx(t,null,n);const r=ap(e,t.schema);return r==="node"?Zi(t,e,n):r==="mark"?wx(t,e,n):!1}var y8=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const a=op(c=>c.type.name===e)(t.selection);if(!a)return!1;const l=t.doc.resolve(a.pos+1);return s.pos+1===l.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},v8=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function Xk(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Qk(t,e){const{nodeExtensions:n}=ul(e),r=n.find(l=>l.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},a=ht(Le(r,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function lp(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(a=>{s!==!1&&(lp(a,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function PT(t){return t instanceof ze}var HT=class FT{constructor(e){this.position=e}static fromJSON(e){return new FT(e.position)}toJSON(){return{position:this.position}}};function w8(t,e){const n=e.mapping.mapResult(t.position);return{position:new HT(n.pos),mapResult:n}}function k8(t){return new HT(t)}function C8(t,e,n){var r;const{selection:s}=e;let a=null;if(ET(s)&&(a=s.$cursor),a){const c=(r=t.storedMarks)!=null?r:a.marks();return a.parent.type.allowsMarkType(n)&&(!!n.isInSet(c)||!c.some(p=>p.type.excludes(n)))}const{ranges:l}=s;return l.some(({$from:c,$to:d})=>{let p=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(m,g,b)=>{if(p)return!1;if(m.isInline){const v=!b||b.type.allowsMarkType(n),w=!!n.isInSet(m.marks)||!m.marks.some(C=>C.type.excludes(n));p=v&&w}return!p}),p})}var S8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:a}=n,{empty:l,ranges:c}=a,d=ti(t,r.schema);if(s)if(l){const p=MT(r,d);n.addStoredMark(d.create({...p,...e}))}else c.forEach(p=>{const m=p.$from.pos,g=p.$to.pos;r.doc.nodesBetween(m,g,(b,v)=>{const w=Math.max(v,m),C=Math.min(v+b.nodeSize,g);b.marks.find(N=>N.type===d)?b.marks.forEach(N=>{d===N.type&&n.addMark(w,C,d.create({...N.attrs,...e}))}):n.addMark(w,C,d.create(e))})});return C8(r,n,d)},E8=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),N8=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const a=sn(t,n.schema);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a.isTextblock?s().command(({commands:c})=>dk(a,{...l,...e})(n)?!0:c.clearNodes()).command(({state:c})=>dk(a,{...l,...e})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},T8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=La(t,0,r.content.size),a=ze.create(r,s);e.setSelection(a)}return!0},A8=(t,e)=>({tr:n,state:r,dispatch:s})=>{const{selection:a}=r;let l,c;return typeof e=="number"?(l=e,c=e):e&&"from"in e&&"to"in e?(l=e.from,c=e.to):(l=a.from,c=a.to),s&&n.doc.nodesBetween(l,c,(d,p)=>{d.isText||n.setNodeMarkup(p,void 0,{...d.attrs,dir:t})}),!0},M8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:a}=typeof t=="number"?{from:t,to:t}:t,l=Be.atStart(r).from,c=Be.atEnd(r).to,d=La(s,l,c),p=La(a,l,c),m=Be.create(r,d,p);e.setSelection(m)}return!0},O8=t=>({state:e,dispatch:n})=>{const r=sn(t,e.schema);return SL(r)(e,n)};function Zk(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}var j8=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:a,doc:l}=e,{$from:c,$to:d}=a,p=s.extensionManager.attributes,m=bf(p,c.node().type.name,c.node().attrs);if(a instanceof ze&&a.node.isBlock)return!c.parentOffset||!Gs(l,c.pos)?!1:(r&&(t&&Zk(n,s.extensionManager.splittableMarks),e.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const g=d.parentOffset===d.parent.content.size,b=c.depth===0?void 0:a8(c.node(-1).contentMatchAt(c.indexAfter(-1)));let v=g&&b?[{type:b,attrs:m}]:void 0,w=Gs(e.doc,e.mapping.map(c.pos),1,v);if(!v&&!w&&Gs(e.doc,e.mapping.map(c.pos),1,b?[{type:b}]:void 0)&&(w=!0,v=b?[{type:b,attrs:m}]:void 0),r){if(w&&(a instanceof Be&&e.deleteSelection(),e.split(e.mapping.map(c.pos),1,v),b&&!g&&!c.parentOffset&&c.parent.type!==b)){const C=e.mapping.map(c.before()),k=e.doc.resolve(C);c.node(-1).canReplaceWith(k.index(),k.index()+1,b)&&e.setNodeMarkup(e.mapping.map(c.before()),b)}t&&Zk(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return w},_8=(t,e={})=>({tr:n,state:r,dispatch:s,editor:a})=>{var l;const c=sn(t,r.schema),{$from:d,$to:p}=r.selection,m=r.selection.node;if(m&&m.isBlock||d.depth<2||!d.sameParent(p))return!1;const g=d.node(-1);if(g.type!==c)return!1;const b=a.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(s){let N=fe.empty;const M=d.index(-1)?1:d.index(-2)?2:3;for(let F=d.depth-M;F>=d.depth-3;F-=1)N=fe.from(d.node(F).copy(N));const _=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,P={...bf(b,d.node().type.name,d.node().attrs),...e},z=((l=c.contentMatch.defaultType)==null?void 0:l.createAndFill(P))||void 0;N=N.append(fe.from(c.createAndFill(null,z)||void 0));const K=d.before(d.depth-(M-1));n.replace(K,d.after(-_),new Ne(N,4-M,0));let O=-1;n.doc.nodesBetween(K,n.doc.content.size,(F,V)=>{if(O>-1)return!1;F.isTextblock&&F.content.size===0&&(O=V+1)}),O>-1&&n.setSelection(Be.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const v=p.pos===d.end()?g.contentMatchAt(0).defaultType:null,w={...bf(b,g.type.name,g.attrs),...e},C={...bf(b,d.node().type.name,d.node().attrs),...e};n.delete(d.pos,p.pos);const k=v?[{type:c,attrs:w},{type:v,attrs:C}]:[{type:c,attrs:w}];if(!Gs(n.doc,d.pos,2))return!1;if(s){const{selection:N,storedMarks:M}=r,{splittableMarks:_}=a.extensionManager,P=M||N.$to.parentOffset&&N.$from.marks();if(n.split(d.pos,2,k).scrollIntoView(),!P||!s)return!0;const z=P.filter(K=>_.includes(K.type.name));n.ensureMarks(z)}return!0},n0=(t,e)=>{const n=op(l=>l.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ea(t.doc,n.pos)&&t.join(n.pos),!0},r0=(t,e)=>{const n=op(l=>l.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ea(t.doc,r)&&t.join(r),!0},R8=(t,e,n,r={})=>({editor:s,tr:a,state:l,dispatch:c,chain:d,commands:p,can:m})=>{const{extensions:g,splittableMarks:b}=s.extensionManager,v=sn(t,l.schema),w=sn(e,l.schema),{selection:C,storedMarks:k}=l,{$from:N,$to:M}=C,_=N.blockRange(M),P=k||C.$to.parentOffset&&C.$from.marks();if(!_)return!1;const z=op(K=>Qk(K.type.name,g))(C);if(_.depth>=1&&z&&_.depth-z.depth<=1){if(z.node.type===v)return p.liftListItem(w);if(Qk(z.node.type.name,g)&&v.validContent(z.node.content)&&c)return d().command(()=>(a.setNodeMarkup(z.pos,v),!0)).command(()=>n0(a,v)).command(()=>r0(a,v)).run()}return!n||!P||!c?d().command(()=>m().wrapInList(v,r)?!0:p.clearNodes()).wrapInList(v,r).command(()=>n0(a,v)).command(()=>r0(a,v)).run():d().command(()=>{const K=m().wrapInList(v,r),O=P.filter(F=>b.includes(F.type.name));return a.ensureMarks(O),K?!0:p.clearNodes()}).wrapInList(v,r).command(()=>n0(a,v)).command(()=>r0(a,v)).run()},D8=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:a=!1}=n,l=ti(t,r.schema);return wx(r,l,e)?s.unsetMark(l,{extendEmptyMarkRange:a}):s.setMark(l,e)},L8=(t,e,n={})=>({state:r,commands:s})=>{const a=sn(t,r.schema),l=sn(e,r.schema),c=Zi(r,a,n);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),c?s.setNode(l,d):s.setNode(a,{...d,...n})},I8=(t,e={})=>({state:n,commands:r})=>{const s=sn(t,n.schema);return Zi(n,s,e)?r.lift(s):r.wrapIn(s,e)},z8=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let a;if(s.spec.isInputRules&&(a=s.getState(t))){if(e){const l=t.tr,c=a.transform;for(let d=c.steps.length-1;d>=0;d-=1)l.step(c.steps[d].invert(c.docs[d]));if(a.text){const d=l.doc.resolve(a.from).marks();l.replaceWith(a.from,a.to,t.schema.text(a.text,d))}else l.delete(a.from,a.to)}return!0}}return!1},B8=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},P8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var a;const{extendEmptyMarkRange:l=!1}=e,{selection:c}=n,d=ti(t,r.schema),{$from:p,empty:m,ranges:g}=c;if(!s)return!0;if(m&&l){let{from:b,to:v}=c;const w=(a=p.marks().find(k=>k.type===d))==null?void 0:a.attrs,C=Ib(p,d,w);C&&(b=C.from,v=C.to),n.removeMark(b,v,d)}else g.forEach(b=>{n.removeMark(b.$from.pos,b.$to.pos,d)});return n.removeStoredMark(d),!0},H8=t=>({tr:e,state:n,dispatch:r})=>{const{selection:s}=n;let a,l;return typeof t=="number"?(a=t,l=t):t&&"from"in t&&"to"in t?(a=t.from,l=t.to):(a=s.from,l=s.to),r&&e.doc.nodesBetween(a,l,(c,d)=>{if(c.isText)return;const p={...c.attrs};delete p.dir,e.setNodeMarkup(d,void 0,p)}),!0},F8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let a=null,l=null;const c=ap(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(a=sn(t,r.schema)),c==="mark"&&(l=ti(t,r.schema));let d=!1;return n.selection.ranges.forEach(p=>{const m=p.$from.pos,g=p.$to.pos;let b,v,w,C;n.selection.empty?r.doc.nodesBetween(m,g,(k,N)=>{a&&a===k.type&&(d=!0,w=Math.max(N,m),C=Math.min(N+k.nodeSize,g),b=N,v=k)}):r.doc.nodesBetween(m,g,(k,N)=>{N<m&&a&&a===k.type&&(d=!0,w=Math.max(N,m),C=Math.min(N+k.nodeSize,g),b=N,v=k),N>=m&&N<=g&&(a&&a===k.type&&(d=!0,s&&n.setNodeMarkup(N,void 0,{...k.attrs,...e})),l&&k.marks.length&&k.marks.forEach(M=>{if(l===M.type&&(d=!0,s)){const _=Math.max(N,m),P=Math.min(N+k.nodeSize,g);n.addMark(_,P,l.create({...M.attrs,...e}))}}))}),v&&(b!==void 0&&s&&n.setNodeMarkup(b,void 0,{...v.attrs,...e}),l&&v.marks.length&&v.marks.forEach(k=>{l===k.type&&s&&n.addMark(w,C,l.create({...k.attrs,...e}))}))}),d},U8=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return xL(s,e)(n,r)},$8=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return bL(s,e)(n,r)},V8=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},cp=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},q8=(t,e)=>{if(Lb(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Jd(t){var e;const{editor:n,from:r,to:s,text:a,rules:l,plugin:c}=t,{view:d}=n;if(d.composing)return!1;const p=d.state.doc.resolve(r);if(p.parent.type.spec.code||(e=p.nodeBefore||p.nodeAfter)!=null&&e.marks.find(b=>b.type.spec.code))return!1;let m=!1;const g=x8(p)+a;return l.forEach(b=>{if(m)return;const v=q8(g,b.find);if(!v)return;const w=d.state.tr,C=sp({state:d.state,transaction:w}),k={from:r-(v[0].length-a.length),to:s},{commands:N,chain:M,can:_}=new ip({editor:n,state:C});b.handler({state:C,range:k,match:v,commands:N,chain:M,can:_})===null||!w.steps.length||(b.undoable&&w.setMeta(c,{transform:w,from:r,to:s,text:a}),d.dispatch(w),m=!0)}),m}function W8(t){const{editor:e,rules:n}=t,r=new Rt({state:{init(){return null},apply(s,a,l){const c=s.getMeta(r);if(c)return c;const d=s.getMeta("applyInputRules");return!!d&&setTimeout(()=>{let{text:m}=d;typeof m=="string"?m=m:m=Bb(fe.from(m),l.schema);const{from:g}=d,b=g+m.length;Jd({editor:e,from:g,to:b,text:m,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:a}},props:{handleTextInput(s,a,l,c){return Jd({editor:e,from:a,to:l,text:c,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&Jd({editor:e,from:a.pos,to:a.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:l}=s.state.selection;return l?Jd({editor:e,from:l.pos,to:l.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function K8(t){return Object.prototype.toString.call(t).slice(8,-1)}function Xd(t){return K8(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function UT(t,e){const n={...t};return Xd(t)&&Xd(e)&&Object.keys(e).forEach(r=>{Xd(e[r])&&Xd(t[r])?n[r]=UT(t[r],e[r]):n[r]=e[r]}),n}var Hb=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...ht(Le(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...ht(Le(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>UT(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},na=class $T extends Hb{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new $T(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const l=s.marks();if(!!!l.find(p=>(p==null?void 0:p.type.name)===n.name))return!1;const d=l.find(p=>(p==null?void 0:p.type.name)===n.name);return d&&r.removeStoredMark(d),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function G8(t){return typeof t=="number"}var Y8=class{constructor(t){this.find=t.find,this.handler=t.handler}},J8=(t,e,n)=>{if(Lb(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const a=[s.text];return a.index=s.index,a.input=t,a.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(s.replaceWith)),a}):[]};function X8(t){const{editor:e,state:n,from:r,to:s,rule:a,pasteEvent:l,dropEvent:c}=t,{commands:d,chain:p,can:m}=new ip({editor:e,state:n}),g=[];return n.doc.nodesBetween(r,s,(v,w)=>{var C,k,N,M,_;if((k=(C=v.type)==null?void 0:C.spec)!=null&&k.code||!(v.isText||v.isTextblock||v.isInline))return;const P=(_=(M=(N=v.content)==null?void 0:N.size)!=null?M:v.nodeSize)!=null?_:0,z=Math.max(r,w),K=Math.min(s,w+P);if(z>=K)return;const O=v.isText?v.text||"":v.textBetween(z-w,K-w,void 0,"");J8(O,a.find,l).forEach(V=>{if(V.index===void 0)return;const Z=z+V.index+1,he=Z+V[0].length,Te={from:n.tr.mapping.map(Z),to:n.tr.mapping.map(he)},ve=a.handler({state:n,range:Te,match:V,commands:d,chain:p,can:m,pasteEvent:l,dropEvent:c});g.push(ve)})}),g.every(v=>v!==null)}var Qd=null,Q8=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function Z8(t){const{editor:e,rules:n}=t;let r=null,s=!1,a=!1,l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,c;try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}const d=({state:m,from:g,to:b,rule:v,pasteEvt:w})=>{const C=m.tr,k=sp({state:m,transaction:C});if(!(!X8({editor:e,state:k,from:Math.max(g-1,0),to:b.b-1,rule:v,pasteEvent:w,dropEvent:c})||!C.steps.length)){try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}return l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,C}};return n.map(m=>new Rt({view(g){const b=w=>{var C;r=(C=g.dom.parentElement)!=null&&C.contains(w.target)?g.dom.parentElement:null,r&&(Qd=e)},v=()=>{Qd&&(Qd=null)};return window.addEventListener("dragstart",b),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",b),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(g,b)=>{if(a=r===g.dom.parentElement,c=b,!a){const v=Qd;v!=null&&v.isEditable&&setTimeout(()=>{const w=v.state.selection;w&&v.commands.deleteRange({from:w.from,to:w.to})},10)}return!1},paste:(g,b)=>{var v;const w=(v=b.clipboardData)==null?void 0:v.getData("text/html");return l=b,s=!!(w!=null&&w.includes("data-pm-slice")),!1}}},appendTransaction:(g,b,v)=>{const w=g[0],C=w.getMeta("uiEvent")==="paste"&&!s,k=w.getMeta("uiEvent")==="drop"&&!a,N=w.getMeta("applyPasteRules"),M=!!N;if(!C&&!k&&!M)return;if(M){let{text:z}=N;typeof z=="string"?z=z:z=Bb(fe.from(z),v.schema);const{from:K}=N,O=K+z.length,F=Q8(z);return d({rule:m,state:v,from:K,to:{b:O},pasteEvt:F})}const _=b.doc.content.findDiffStart(v.doc.content),P=b.doc.content.findDiffEnd(v.doc.content);if(!(!G8(_)||!P||_===P.b))return d({rule:m,state:v,from:_,to:P,pasteEvt:l})}}))}var up=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=DT(t),this.schema=u8(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Yd(e.name,this.schema)},r=Le(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Zf([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Yd(r.name,this.schema)},a=[],l=Le(r,"addKeyboardShortcuts",s);let c={};if(r.type==="mark"&&Le(r,"exitable",s)&&(c.ArrowRight=()=>na.handleExit({editor:t,mark:r})),l){const b=Object.fromEntries(Object.entries(l()).map(([v,w])=>[v,()=>w({editor:t})]));c={...c,...b}}const d=pz(c);a.push(d);const p=Le(r,"addInputRules",s);if(Xk(r,t.options.enableInputRules)&&p){const b=p();if(b&&b.length){const v=W8({editor:t,rules:b}),w=Array.isArray(v)?v:[v];a.push(...w)}}const m=Le(r,"addPasteRules",s);if(Xk(r,t.options.enablePasteRules)&&m){const b=m();if(b&&b.length){const v=Z8({editor:t,rules:b});a.push(...v)}}const g=Le(r,"addProseMirrorPlugins",s);if(g){const b=g();a.push(...b)}return a})}get attributes(){return RT(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=ul(this.extensions);return Object.fromEntries(e.filter(n=>!!Le(n,"addNodeView")).map(n=>{const r=this.attributes.filter(d=>d.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:sn(n.name,this.schema)},a=Le(n,"addNodeView",s);if(!a)return[];const l=a();if(!l)return[];const c=(d,p,m,g,b)=>{const v=ou(d,r);return l({node:d,view:p,getPos:m,decorations:g,innerDecorations:b,editor:t,extension:n,HTMLAttributes:v})};return[n.name,c]}))}dispatchTransaction(t){const{editor:e}=this;return Zf([...this.extensions].reverse()).reduceRight((r,s)=>{const a={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:e,type:Yd(s.name,this.schema)},l=Le(s,"dispatchTransaction",a);return l?c=>{l.call(a,{transaction:c,next:r})}:r},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=ul(this.extensions);return Object.fromEntries(e.filter(n=>!!Le(n,"addMarkView")).map(n=>{const r=this.attributes.filter(c=>c.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:ti(n.name,this.schema)},a=Le(n,"addMarkView",s);if(!a)return[];const l=(c,d,p)=>{const m=ou(c,r);return a()({mark:c,view:d,inline:p,editor:t,extension:n,HTMLAttributes:m,updateAttributes:g=>{hB(c,t,g)}})};return[n.name,l]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Yd(e.name,this.schema)};e.type==="mark"&&((n=ht(Le(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=Le(e,"onBeforeCreate",r),a=Le(e,"onCreate",r),l=Le(e,"onUpdate",r),c=Le(e,"onSelectionUpdate",r),d=Le(e,"onTransaction",r),p=Le(e,"onFocus",r),m=Le(e,"onBlur",r),g=Le(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),a&&this.editor.on("create",a),l&&this.editor.on("update",l),c&&this.editor.on("selectionUpdate",c),d&&this.editor.on("transaction",d),p&&this.editor.on("focus",p),m&&this.editor.on("blur",m),g&&this.editor.on("destroy",g)})}};up.resolve=DT;up.sort=Zf;up.flatten=zb;var eB={};Db(eB,{ClipboardTextSerializer:()=>qT,Commands:()=>WT,Delete:()=>KT,Drop:()=>GT,Editable:()=>YT,FocusEvents:()=>XT,Keymap:()=>QT,Paste:()=>ZT,Tabindex:()=>eA,TextDirection:()=>tA,focusEventsPluginKey:()=>JT});var vt=class VT extends Hb{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new VT(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},qT=vt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Rt({key:new Wt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:a}=s,l=Math.min(...a.map(m=>m.$from.pos)),c=Math.max(...a.map(m=>m.$to.pos)),d=IT(n);return LT(r,{from:l,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),WT=vt.create({name:"commands",addCommands(){return{...CT}}}),KT=vt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const a=()=>{var l,c,d,p;if((p=(d=(c=(l=this.editor.options.coreExtensionOptions)==null?void 0:l.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?p:t.getMeta("y-sync$"))return;const m=OT(t.before,[t,...e]);BT(m).forEach(v=>{m.mapping.mapResult(v.oldRange.from).deletedAfter&&m.mapping.mapResult(v.oldRange.to).deletedBefore&&m.before.nodesBetween(v.oldRange.from,v.oldRange.to,(w,C)=>{const k=C+w.nodeSize-2,N=v.oldRange.from<=C&&k<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:C,to:k,newFrom:m.mapping.map(C),newTo:m.mapping.map(k),deletedRange:v.oldRange,newRange:v.newRange,partial:!N,editor:this.editor,transaction:t,combinedTransform:m})})});const b=m.mapping;m.steps.forEach((v,w)=>{var C,k;if(v instanceof Fr){const N=b.slice(w).map(v.from,-1),M=b.slice(w).map(v.to),_=b.invert().map(N,-1),P=b.invert().map(M),z=(C=m.doc.nodeAt(N-1))==null?void 0:C.marks.some(O=>O.eq(v.mark)),K=(k=m.doc.nodeAt(M))==null?void 0:k.marks.some(O=>O.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:_,to:P},newRange:{from:N,to:M},partial:!!(K||z),editor:this.editor,transaction:t,combinedTransform:m})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(a,0):a()}}),GT=vt.create({name:"drop",addProseMirrorPlugins(){return[new Rt({key:new Wt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),YT=vt.create({name:"editable",addProseMirrorPlugins(){return[new Rt({key:new Wt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),JT=new Wt("focusEvents"),XT=vt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Rt({key:JT,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),QT=vt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:c})=>{const{selection:d,doc:p}=c,{empty:m,$anchor:g}=d,{pos:b,parent:v}=g,w=g.parent.isTextblock&&b>0?c.doc.resolve(b-1):g,C=w.parent.type.spec.isolating,k=g.pos-g.parentOffset,N=C&&w.parent.childCount===1?k===g.pos:$e.atStart(p).from===b;return!m||!v.type.isTextblock||v.textContent.length||!N||N&&g.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},a={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Qf()||AT()?a:s},addProseMirrorPlugins(){return[new Rt({key:new Wt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(C=>C.getMeta("composition")))return;const r=t.some(C=>C.docChanged)&&!e.doc.eq(n.doc),s=t.some(C=>C.getMeta("preventClearDocument"));if(!r||s)return;const{empty:a,from:l,to:c}=e.selection,d=$e.atStart(e.doc).from,p=$e.atEnd(e.doc).to;if(a||!(l===d&&c===p)||!lp(n.doc))return;const b=n.tr,v=sp({state:n,transaction:b}),{commands:w}=new ip({editor:this.editor,state:v});if(w.clearNodes(),!!b.steps.length)return b}})]}}),ZT=vt.create({name:"paste",addProseMirrorPlugins(){return[new Rt({key:new Wt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),eA=vt.create({name:"tabindex",addProseMirrorPlugins(){return[new Rt({key:new Wt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),tA=vt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=ul(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Rt({key:new Wt("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),tB=class Tc{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Tc(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Tc(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Tc(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,a=n.isAtom&&!n.isText,l=n.isInline,c=this.pos+r+(a?0:1);if(c<0||c>this.resolvedPos.doc.nodeSize-2)return;const d=this.resolvedPos.doc.resolve(c);if(!s&&!l&&d.depth<=this.depth)return;const p=new Tc(d,this.editor,s,s||l?n:null);s&&(p.actualDepth=this.depth+1),e.push(p)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const a=s.node.attrs,l=Object.keys(n);for(let c=0;c<l.length;c+=1){const d=l[c];if(a[d]!==n[d])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const a=Object.keys(n);return this.children.forEach(l=>{r&&s.length>0||(l.node.type.name===e&&a.every(d=>n[d]===l.node.attrs[d])&&s.push(l),!(r&&s.length>0)&&(s=s.concat(l.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},nB=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function rB(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var sB=class extends V8{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:w8,createMappablePosition:k8},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:a})=>this.options.onDrop(r,s,a)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=NT(e,this.options.autofocus);this.editorState=Ko.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=rB(nB,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=_T(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;n=n.filter(l=>!l.key.startsWith(a))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[YT,qT.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),WT,XT,QT,eA,GT,ZT,KT,tA.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new up(r,this)}createCommandManager(){this.commandManager=new ip({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=vx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=vx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),s=n?this.extensionManager.dispatchTransaction(r):r;this.editorView=new kT(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const l=this.view.dom;l.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(p=>{var m;return(m=this.capturedTransaction)==null?void 0:m.step(p)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const l=n.findLast(p=>p.getMeta("focus")||p.getMeta("blur")),c=l==null?void 0:l.getMeta("focus"),d=l==null?void 0:l.getMeta("blur");c&&this.emit("focus",{editor:this,event:c.event,transaction:l}),d&&this.emit("blur",{editor:this,event:d.event,transaction:l}),!(t.getMeta("preventUpdate")||!n.some(p=>p.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return zT(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return b8(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Bb(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return f8(this.state.doc,{blockSeparator:e,textSerializers:{...IT(this.schema),...n}})}get isEmpty(){return lp(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new tB(e,this)}get $doc(){return this.$pos(0)}};function dl(t){return new cp({find:t.find,handler:({state:e,range:n,match:r})=>{const s=ht(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:a}=e,l=r[r.length-1],c=r[0];if(l){const d=c.search(/\S/),p=n.from+c.indexOf(l),m=p+l.length;if(Pb(n.from,n.to,e.doc).filter(v=>v.mark.type.excluded.find(C=>C===t.type&&C!==v.mark.type)).filter(v=>v.to>p).length)return null;m<n.to&&a.delete(m,n.to),p>n.from&&a.delete(n.from+d,p);const b=n.from+d+l.length;a.addMark(n.from+d,b,t.type.create(s||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function iB(t){return new cp({find:t.find,handler:({state:e,range:n,match:r})=>{const s=ht(t.getAttributes,void 0,r)||{},{tr:a}=e,l=n.from;let c=n.to;const d=t.type.create(s);if(r[1]){const p=r[0].lastIndexOf(r[1]);let m=l+p;m>c?m=c:c=m+r[1].length;const g=r[0][r[0].length-1];a.insertText(g,l+r[0].length-1),a.replaceWith(m,c,d)}else if(r[0]){const p=t.type.isInline?l:l-1;a.insert(p,t.type.create(s)).delete(a.mapping.map(l),a.mapping.map(c))}a.scrollIntoView()},undoable:t.undoable})}function kx(t){return new cp({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),a=ht(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,a)},undoable:t.undoable})}function fl(t){return new cp({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const a=ht(t.getAttributes,void 0,r)||{},l=e.tr.delete(n.from,n.to),d=l.doc.resolve(n.from).blockRange(),p=d&&gb(d,t.type,a);if(!p)return null;if(l.wrap(d,p),t.keepMarks&&t.editor){const{selection:g,storedMarks:b}=e,{splittableMarks:v}=t.editor.extensionManager,w=b||g.$to.parentOffset&&g.$from.marks();if(w){const C=w.filter(k=>v.includes(k.type.name));l.ensureMarks(C)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(g,a).run()}const m=l.doc.resolve(n.from-1).nodeBefore;m&&m.type===t.type&&ea(l.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,m))&&l.join(n.from-1)},undoable:t.undoable})}function aB(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof ze){const a=r.index();return r.parent.canReplaceWith(a,a+1,e)}let s=r.depth;for(;s>=0;){const a=r.index(s);if(r.node(s).contentMatchAt(a).matchType(e))return!0;s-=1}return!1}var oB={};Db(oB,{createAtomBlockMarkdownSpec:()=>lB,createBlockMarkdownSpec:()=>cB,createInlineMarkdownSpec:()=>fB,parseAttributes:()=>Fb,parseIndentedBlocks:()=>Cx,renderNestedMarkdownContent:()=>$b,serializeAttributes:()=>Ub});function Fb(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,p=>(n.push(p),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const p=s.map(m=>m.trim().slice(1));e.class=p.join(" ")}const a=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const l=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(l)).forEach(([,p,m])=>{var g;const b=parseInt(((g=m.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),v=n[b];v&&(e[p]=v.slice(1,-1))});const d=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(m=>{m.match(/^[a-zA-Z][\w-]*$/)&&(e[m]=!0)}),e}function Ub(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function lB(t){const{nodeName:e,name:n,parseAttributes:r=Fb,serializeAttributes:s=Ub,defaultAttributes:a={},requiredAttributes:l=[],allowedAttributes:c}=t,d=n||e,p=m=>{if(!c)return m;const g={};return c.forEach(b=>{b in m&&(g[b]=m[b])}),g};return{parseMarkdown:(m,g)=>{const b={...a,...m.attributes};return g.createNode(e,b,[])},markdownTokenizer:{name:e,level:"block",start(m){var g;const b=new RegExp(`^:::${d}(?:\\s|$)`,"m"),v=(g=m.match(b))==null?void 0:g.index;return v!==void 0?v:-1},tokenize(m,g,b){const v=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),w=m.match(v);if(!w)return;const C=w[1]||"",k=r(C);if(!l.find(M=>!(M in k)))return{type:e,raw:w[0],attributes:k}}},renderMarkdown:m=>{const g=p(m.attrs||{}),b=s(g),v=b?` {${b}}`:"";return`:::${d}${v} :::`}}}function cB(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Fb,serializeAttributes:a=Ub,defaultAttributes:l={},content:c="block",allowedAttributes:d}=t,p=n||e,m=g=>{if(!d)return g;const b={};return d.forEach(v=>{v in g&&(b[v]=g[v])}),b};return{parseMarkdown:(g,b)=>{let v;if(r){const C=r(g);v=typeof C=="string"?[{type:"text",text:C}]:C}else c==="block"?v=b.parseChildren(g.tokens||[]):v=b.parseInline(g.tokens||[]);const w={...l,...g.attributes};return b.createNode(e,w,v)},markdownTokenizer:{name:e,level:"block",start(g){var b;const v=new RegExp(`^:::${p}`,"m"),w=(b=g.match(v))==null?void 0:b.index;return w!==void 0?w:-1},tokenize(g,b,v){var w;const C=new RegExp(`^:::${p}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),k=g.match(C);if(!k)return;const[N,M=""]=k,_=s(M);let P=1;const z=N.length;let K="";const O=/^:::([\w-]*)(\s.*)?/gm,F=g.slice(z);for(O.lastIndex=0;;){const V=O.exec(F);if(V===null)break;const Z=V.index,he=V[1];if(!((w=V[2])!=null&&w.endsWith(":::"))){if(he)P+=1;else if(P-=1,P===0){const Te=F.slice(0,Z);K=Te.trim();const ve=g.slice(0,z+Z+V[0].length);let Se=[];if(K)if(c==="block")for(Se=v.blockTokens(Te),Se.forEach(Ee=>{Ee.text&&(!Ee.tokens||Ee.tokens.length===0)&&(Ee.tokens=v.inlineTokens(Ee.text))});Se.length>0;){const Ee=Se[Se.length-1];if(Ee.type==="paragraph"&&(!Ee.text||Ee.text.trim()===""))Se.pop();else break}else Se=v.inlineTokens(K);return{type:e,raw:ve,attributes:_,content:K,tokens:Se}}}}}},renderMarkdown:(g,b)=>{const v=m(g.attrs||{}),w=a(v),C=w?` {${w}}`:"",k=b.renderChildren(g.content||[],`

`);return`:::${p}${C}

${k}

:::`}}}function uB(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,a,l]=r;e[s]=a||l,r=n.exec(t)}return e}function dB(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function fB(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=uB,serializeAttributes:a=dB,defaultAttributes:l={},selfClosing:c=!1,allowedAttributes:d}=t,p=n||e,m=b=>{if(!d)return b;const v={};return d.forEach(w=>{const C=typeof w=="string"?w:w.name,k=typeof w=="string"?void 0:w.skipIfDefault;if(C in b){const N=b[C];if(k!==void 0&&N===k)return;v[C]=N}}),v},g=p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(b,v)=>{const w={...l,...b.attributes};if(c)return v.createNode(e,w);const C=r?r(b):b.content||"";return C?v.createNode(e,w,[v.createTextNode(C)]):v.createNode(e,w,[])},markdownTokenizer:{name:e,level:"inline",start(b){const v=c?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),w=b.match(v),C=w==null?void 0:w.index;return C!==void 0?C:-1},tokenize(b,v,w){const C=c?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),k=b.match(C);if(!k)return;let N="",M="";if(c){const[,P]=k;M=P}else{const[,P,z]=k;M=P,N=z||""}const _=s(M.trim());return{type:e,raw:k[0],content:N.trim(),attributes:_}}},renderMarkdown:b=>{let v="";r?v=r(b):b.content&&b.content.length>0&&(v=b.content.filter(N=>N.type==="text").map(N=>N.text).join(""));const w=m(b.attrs||{}),C=a(w),k=C?` ${C}`:"";return c?`[${p}${k}]`:`[${p}${k}]${v}[/${p}]`}}}function Cx(t,e,n){var r,s,a,l;const c=t.split(`
`),d=[];let p="",m=0;const g=e.baseIndentSize||2;for(;m<c.length;){const b=c[m],v=b.match(e.itemPattern);if(!v){if(d.length>0)break;if(b.trim()===""){m+=1,p=`${p}${b}
`;continue}else return}const w=e.extractItemData(v),{indentLevel:C,mainContent:k}=w;p=`${p}${b}
`;const N=[k];for(m+=1;m<c.length;){const z=c[m];if(z.trim()===""){const O=c.slice(m+1).findIndex(Z=>Z.trim()!=="");if(O===-1)break;if((((s=(r=c[m+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>C){N.push(z),p=`${p}${z}
`,m+=1;continue}else break}if((((l=(a=z.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:l.length)||0)>C)N.push(z),p=`${p}${z}
`,m+=1;else break}let M;const _=N.slice(1);if(_.length>0){const z=_.map(K=>K.slice(C+g)).join(`
`);z.trim()&&(e.customNestedParser?M=e.customNestedParser(z):M=n.blockTokens(z))}const P=e.createToken(w,M);d.push(P)}if(d.length!==0)return{items:d,raw:p}}function $b(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[a,...l]=t.content,c=e.renderChildren([a]),d=[`${s}${c}`];return l&&l.length>0&&l.forEach(p=>{const m=e.renderChildren([p]);if(m){const g=m.split(`
`).map(b=>b?e.indent(b):"").join(`
`);d.push(g)}}),d.join(`
`)}function hB(t,e,n={}){const{state:r}=e,{doc:s,tr:a}=r,l=t;s.descendants((c,d)=>{const p=a.mapping.map(d),m=a.mapping.map(d)+c.nodeSize;let g=null;if(c.marks.forEach(v=>{if(v!==l)return!1;g=v}),!g)return;let b=!1;if(Object.keys(n).forEach(v=>{n[v]!==g.attrs[v]&&(b=!0)}),b){const v=t.type.create({...t.attrs,...n});a.removeMark(p,m,t.type),a.addMark(p,m,v)}}),a.docChanged&&e.view.dispatch(a)}var _n=class nA extends Hb{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new nA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Xa(t){return new Y8({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const a=ht(t.getAttributes,void 0,r,s);if(a===!1||a===null)return null;const{tr:l}=e,c=r[r.length-1],d=r[0];let p=n.to;if(c){const m=d.search(/\S/),g=n.from+d.indexOf(c),b=g+c.length;if(Pb(n.from,n.to,e.doc).filter(w=>w.mark.type.excluded.find(k=>k===t.type&&k!==w.mark.type)).filter(w=>w.to>g).length)return null;b<n.to&&l.delete(b,n.to),g>n.from&&l.delete(n.from+m,g),p=n.from+m+c.length,l.addMark(n.from+m,p,t.type.create(a||{})),l.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:pB,getOwnPropertySymbols:mB}=Object,{hasOwnProperty:gB}=Object.prototype;function s0(t,e){return function(r,s,a){return t(r,s,a)&&e(r,s,a)}}function Zd(t){return function(n,r,s){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,s);const{cache:a}=s,l=a.get(n),c=a.get(r);if(l&&c)return l===r&&c===n;a.set(n,r),a.set(r,n);const d=t(n,r,s);return a.delete(n),a.delete(r),d}}function xB(t){return t!=null?t[Symbol.toStringTag]:void 0}function eC(t){return pB(t).concat(mB(t))}const bB=Object.hasOwn||((t,e)=>gB.call(t,e));function ro(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const yB="__v",vB="__o",wB="_owner",{getOwnPropertyDescriptor:tC,keys:nC}=Object;function kB(t,e){return t.byteLength===e.byteLength&&eh(new Uint8Array(t),new Uint8Array(e))}function CB(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function SB(t,e){return t.byteLength===e.byteLength&&eh(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function EB(t,e){return ro(t.getTime(),e.getTime())}function NB(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function TB(t,e){return t===e}function rC(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),a=t.entries();let l,c,d=0;for(;(l=a.next())&&!l.done;){const p=e.entries();let m=!1,g=0;for(;(c=p.next())&&!c.done;){if(s[g]){g++;continue}const b=l.value,v=c.value;if(n.equals(b[0],v[0],d,g,t,e,n)&&n.equals(b[1],v[1],b[0],v[0],t,e,n)){m=s[g]=!0;break}g++}if(!m)return!1;d++}return!0}const AB=ro;function MB(t,e,n){const r=nC(t);let s=r.length;if(nC(e).length!==s)return!1;for(;s-- >0;)if(!rA(t,e,n,r[s]))return!1;return!0}function wc(t,e,n){const r=eC(t);let s=r.length;if(eC(e).length!==s)return!1;let a,l,c;for(;s-- >0;)if(a=r[s],!rA(t,e,n,a)||(l=tC(t,a),c=tC(e,a),(l||c)&&(!l||!c||l.configurable!==c.configurable||l.enumerable!==c.enumerable||l.writable!==c.writable)))return!1;return!0}function OB(t,e){return ro(t.valueOf(),e.valueOf())}function jB(t,e){return t.source===e.source&&t.flags===e.flags}function sC(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),a=t.values();let l,c;for(;(l=a.next())&&!l.done;){const d=e.values();let p=!1,m=0;for(;(c=d.next())&&!c.done;){if(!s[m]&&n.equals(l.value,c.value,l.value,c.value,t,e,n)){p=s[m]=!0;break}m++}if(!p)return!1}return!0}function eh(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function _B(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function rA(t,e,n,r){return(r===wB||r===vB||r===yB)&&(t.$$typeof||e.$$typeof)?!0:bB(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const RB="[object ArrayBuffer]",DB="[object Arguments]",LB="[object Boolean]",IB="[object DataView]",zB="[object Date]",BB="[object Error]",PB="[object Map]",HB="[object Number]",FB="[object Object]",UB="[object RegExp]",$B="[object Set]",VB="[object String]",qB={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},WB="[object URL]",KB=Object.prototype.toString;function GB({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:s,areFunctionsEqual:a,areMapsEqual:l,areNumbersEqual:c,areObjectsEqual:d,arePrimitiveWrappersEqual:p,areRegExpsEqual:m,areSetsEqual:g,areTypedArraysEqual:b,areUrlsEqual:v,unknownTagComparators:w}){return function(k,N,M){if(k===N)return!0;if(k==null||N==null)return!1;const _=typeof k;if(_!==typeof N)return!1;if(_!=="object")return _==="number"?c(k,N,M):_==="function"?a(k,N,M):!1;const P=k.constructor;if(P!==N.constructor)return!1;if(P===Object)return d(k,N,M);if(Array.isArray(k))return e(k,N,M);if(P===Date)return r(k,N,M);if(P===RegExp)return m(k,N,M);if(P===Map)return l(k,N,M);if(P===Set)return g(k,N,M);const z=KB.call(k);if(z===zB)return r(k,N,M);if(z===UB)return m(k,N,M);if(z===PB)return l(k,N,M);if(z===$B)return g(k,N,M);if(z===FB)return typeof k.then!="function"&&typeof N.then!="function"&&d(k,N,M);if(z===WB)return v(k,N,M);if(z===BB)return s(k,N,M);if(z===DB)return d(k,N,M);if(qB[z])return b(k,N,M);if(z===RB)return t(k,N,M);if(z===IB)return n(k,N,M);if(z===LB||z===HB||z===VB)return p(k,N,M);if(w){let K=w[z];if(!K){const O=xB(k);O&&(K=w[O])}if(K)return K(k,N,M)}return!1}}function YB({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:kB,areArraysEqual:n?wc:CB,areDataViewsEqual:SB,areDatesEqual:EB,areErrorsEqual:NB,areFunctionsEqual:TB,areMapsEqual:n?s0(rC,wc):rC,areNumbersEqual:AB,areObjectsEqual:n?wc:MB,arePrimitiveWrappersEqual:OB,areRegExpsEqual:jB,areSetsEqual:n?s0(sC,wc):sC,areTypedArraysEqual:n?s0(eh,wc):eh,areUrlsEqual:_B,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const s=Zd(r.areArraysEqual),a=Zd(r.areMapsEqual),l=Zd(r.areObjectsEqual),c=Zd(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:l,areSetsEqual:c})}return r}function JB(t){return function(e,n,r,s,a,l,c){return t(e,n,c)}}function XB({circular:t,comparator:e,createState:n,equals:r,strict:s}){if(n)return function(c,d){const{cache:p=t?new WeakMap:void 0,meta:m}=n();return e(c,d,{cache:p,equals:r,meta:m,strict:s})};if(t)return function(c,d){return e(c,d,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};const a={cache:void 0,equals:r,meta:void 0,strict:s};return function(c,d){return e(c,d,a)}}const QB=ra();ra({strict:!0});ra({circular:!0});ra({circular:!0,strict:!0});ra({createInternalComparator:()=>ro});ra({strict:!0,createInternalComparator:()=>ro});ra({circular:!0,createInternalComparator:()=>ro});ra({circular:!0,createInternalComparator:()=>ro,strict:!0});function ra(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:s=!1}=t,a=YB(t),l=GB(a),c=n?n(l):JB(l);return XB({circular:e,comparator:l,createState:r,equals:c,strict:s})}var i0={exports:{}},a0={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iC;function ZB(){if(iC)return a0;iC=1;var t=pu(),e=GE();function n(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,a=t.useRef,l=t.useEffect,c=t.useMemo,d=t.useDebugValue;return a0.useSyncExternalStoreWithSelector=function(p,m,g,b,v){var w=a(null);if(w.current===null){var C={hasValue:!1,value:null};w.current=C}else C=w.current;w=c(function(){function N(K){if(!M){if(M=!0,_=K,K=b(K),v!==void 0&&C.hasValue){var O=C.value;if(v(O,K))return P=O}return P=K}if(O=P,r(_,K))return O;var F=b(K);return v!==void 0&&v(O,F)?(_=K,O):(_=K,P=F)}var M=!1,_,P,z=g===void 0?null:g;return[function(){return N(m())},z===null?void 0:function(){return N(z())}]},[m,g,b,v]);var k=s(p,w[0],w[1]);return l(function(){C.hasValue=!0,C.value=k},[k]),d(k),k},a0}var aC;function eP(){return aC||(aC=1,i0.exports=ZB()),i0.exports}var tP=eP(),nP=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},rP=({contentComponent:t})=>{const e=YE.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return h.jsx(h.Fragment,{children:Object.values(e)})};function sP(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:Y_.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var iP=class extends We.Component{constructor(t){var e;super(t),this.editorContentRef=We.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=sP(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:nP(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&h.jsx(rP,{contentComponent:t.contentComponent})]})}},aP=E.forwardRef((t,e)=>{const n=We.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return We.createElement(iP,{key:n,innerRef:e,...t})}),sA=We.memo(aP),oP=typeof window<"u"?E.useLayoutEffect:E.useEffect,lP=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function cP(t){var e;const[n]=E.useState(()=>new lP(t.editor)),r=tP.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:QB);return oP(()=>n.watch(t.editor),[t.editor,n]),E.useDebugValue(r),r}var uP=!1,Sx=typeof window>"u",dP=Sx||!!(typeof window<"u"&&window.next),fP=class iA{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Sx||dP?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onBeforeCreate)==null?void 0:a.call(s,...r)},onBlur:(...r)=>{var s,a;return(a=(s=this.options.current).onBlur)==null?void 0:a.call(s,...r)},onCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onCreate)==null?void 0:a.call(s,...r)},onDestroy:(...r)=>{var s,a;return(a=(s=this.options.current).onDestroy)==null?void 0:a.call(s,...r)},onFocus:(...r)=>{var s,a;return(a=(s=this.options.current).onFocus)==null?void 0:a.call(s,...r)},onSelectionUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onSelectionUpdate)==null?void 0:a.call(s,...r)},onTransaction:(...r)=>{var s,a;return(a=(s=this.options.current).onTransaction)==null?void 0:a.call(s,...r)},onUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onUpdate)==null?void 0:a.call(s,...r)},onContentError:(...r)=>{var s,a;return(a=(s=this.options.current).onContentError)==null?void 0:a.call(s,...r)},onDrop:(...r)=>{var s,a;return(a=(s=this.options.current).onDrop)==null?void 0:a.call(s,...r)},onPaste:(...r)=>{var s,a;return(a=(s=this.options.current).onPaste)==null?void 0:a.call(s,...r)},onDelete:(...r)=>{var s,a;return(a=(s=this.options.current).onDelete)==null?void 0:a.call(s,...r)}};return new sB(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,a)=>{var l;return s===((l=n.extensions)==null?void 0:l[a])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?iA.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function hP(t={},e=[]){const n=E.useRef(t);n.current=t;const[r]=E.useState(()=>new fP(n)),s=YE.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return E.useDebugValue(s),E.useEffect(r.onRender(e)),cP({editor:s,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),s}var aA=E.createContext({editor:null});aA.Consumer;var pP=E.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),mP=()=>E.useContext(pP);We.forwardRef((t,e)=>{const{onDragStart:n}=mP(),r=t.as||"div";return h.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});We.createContext({markViewContentRef:()=>{}});var Vb=E.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});Vb.displayName="TiptapContext";var gP=()=>E.useContext(Vb);function oA({editor:t,instance:e,children:n}){const r=t??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const s=E.useMemo(()=>({editor:r}),[r]),a=E.useMemo(()=>({editor:r}),[r]);return h.jsx(aA.Provider,{value:a,children:h.jsx(Vb.Provider,{value:s,children:n})})}oA.displayName="Tiptap";function lA({...t}){const{editor:e}=gP();return h.jsx(sA,{editor:e,...t})}lA.displayName="Tiptap.Content";Object.assign(oA,{Content:lA});var th=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},xP=/^\s*>\s$/,bP=_n.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return th("blockquote",{..._t(this.options.HTMLAttributes,t),children:th("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(s=>{const c=e.renderChildren([s]).split(`
`).map(d=>d.trim()===""?n:`${n} ${d}`);r.push(c.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[fl({find:xP,type:this.type})]}}),yP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,vP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,wP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,kP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,CP=na.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return th("strong",{..._t(this.options.HTMLAttributes,t),children:th("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[dl({find:yP,type:this.type}),dl({find:wP,type:this.type})]},addPasteRules(){return[Xa({find:vP,type:this.type}),Xa({find:kP,type:this.type})]}}),SP=/(^|[^`])`([^`]+)`(?!`)$/,EP=/(^|[^`])`([^`]+)`(?!`)/g,NP=na.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",_t(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[dl({find:SP,type:this.type})]},addPasteRules(){return[Xa({find:EP,type:this.type})]}}),o0=4,TP=/^```([a-z]+)?[\s\n]$/,AP=/^~~~([a-z]+)?[\s\n]$/,MP=_n.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:o0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(l=>l.startsWith(n)).map(l=>l.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",_t(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:o0,{state:r}=t,{selection:s}=r,{$from:a,empty:l}=s;if(a.parent.type!==this.type)return!1;const c=" ".repeat(n);return l?t.commands.insertContent(c):t.commands.command(({tr:d})=>{const{from:p,to:m}=s,v=r.doc.textBetween(p,m,`
`,`
`).split(`
`).map(w=>c+w).join(`
`);return d.replaceWith(p,m,r.schema.text(v)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:o0,{state:r}=t,{selection:s}=r,{$from:a,empty:l}=s;return a.parent.type!==this.type?!1:l?t.commands.command(({tr:c})=>{var d;const{pos:p}=a,m=a.start(),g=a.end(),v=r.doc.textBetween(m,g,`
`,`
`).split(`
`);let w=0,C=0;const k=p-m;for(let K=0;K<v.length;K+=1){if(C+v[K].length>=k){w=K;break}C+=v[K].length+1}const M=((d=v[w].match(/^ */))==null?void 0:d[0])||"",_=Math.min(M.length,n);if(_===0)return!0;let P=m;for(let K=0;K<w;K+=1)P+=v[K].length+1;return c.delete(P,P+_),p-P<=_&&c.setSelection(Be.create(c.doc,P)),!0}):t.commands.command(({tr:c})=>{const{from:d,to:p}=s,b=r.doc.textBetween(d,p,`
`,`
`).split(`
`).map(v=>{var w;const C=((w=v.match(/^ */))==null?void 0:w[0])||"",k=Math.min(C.length,n);return v.slice(k)}).join(`
`);return c.replaceWith(d,p,r.schema.text(b)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,l=r.parent.textContent.endsWith(`

`);return!a||!l?!1:t.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:a}=n;if(!a||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const c=s.after();return c===void 0?!1:r.nodeAt(c)?t.commands.command(({tr:p})=>(p.setSelection($e.near(r.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[kx({find:TP,type:this.type,getAttributes:t=>({language:t[1]})}),kx({find:AP,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Rt({key:new Wt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,a=s==null?void 0:s.mode;if(!n||!a)return!1;const{tr:l,schema:c}=t.state,d=c.text(n.replace(/\r\n?/g,`
`));return l.replaceSelectionWith(this.type.create({language:a},d)),l.selection.$from.parent.type!==this.type&&l.setSelection(Be.near(l.doc.resolve(Math.max(0,l.selection.from-2)))),l.setMeta("paste",!0),t.dispatch(l),!0}}})]}}),OP=_n.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),jP=_n.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",_t(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:a}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:l}=this.options,{splittableMarks:c}=r.extensionManager,d=a||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:p,dispatch:m})=>{if(m&&d&&l){const g=d.filter(b=>c.includes(b.type.name));p.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),_P=_n.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,_t(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>kx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),RP=_n.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",_t(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!aB(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return PT(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:a,tr:l,dispatch:c})=>{if(c){const{$to:d}=l.selection,p=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?l.setSelection(Be.create(l.doc,d.pos+1)):d.nodeAfter.isBlock?l.setSelection(ze.create(l.doc,d.pos)):l.setSelection(Be.create(l.doc,d.pos));else{const m=a.schema.nodes[this.options.nextNodeType]||d.parent.type.contentMatch.defaultType,g=m==null?void 0:m.create();g&&(l.insert(p,g),l.setSelection(Be.create(l.doc,p+1)))}l.scrollIntoView()}return!0}).run()}}},addInputRules(){return[iB({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),DP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,LP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,IP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,zP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,BP=na.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",_t(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[dl({find:DP,type:this.type}),dl({find:IP,type:this.type})]},addPasteRules(){return[Xa({find:LP,type:this.type}),Xa({find:zP,type:this.type})]}});const PP="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",HP="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Ex="numeric",Nx="ascii",Tx="alpha",Bc="asciinumeric",Ac="alphanumeric",Ax="domain",cA="emoji",FP="scheme",UP="slashscheme",l0="whitespace";function $P(t,e){return t in e||(e[t]=[]),e[t]}function Ia(t,e,n){e[Ex]&&(e[Bc]=!0,e[Ac]=!0),e[Nx]&&(e[Bc]=!0,e[Tx]=!0),e[Bc]&&(e[Ac]=!0),e[Tx]&&(e[Ac]=!0),e[Ac]&&(e[Ax]=!0),e[cA]&&(e[Ax]=!0);for(const r in e){const s=$P(r,n);s.indexOf(t)<0&&s.push(t)}}function VP(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function ir(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}ir.groups={};ir.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],a=e.jr[r][1];if(a&&s.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||ir.groups;let s;return e&&e.j?s=e:(s=new ir(e),n&&r&&Ia(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const a=t.length;if(!a)return s;for(let l=0;l<a-1;l++)s=s.tt(t[l]);return s.tt(t[a-1],e,n,r)},tt(t,e,n,r){r=r||ir.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const a=e;let l,c=s.go(t);if(c?(l=new ir,Object.assign(l.j,c.j),l.jr.push.apply(l.jr,c.jr),l.jd=c.jd,l.t=c.t):l=new ir,a){if(r)if(l.t&&typeof l.t=="string"){const d=Object.assign(VP(l.t,r),n);Ia(a,d,r)}else n&&Ia(a,n,r);l.t=a}return s.j[t]=l,l}};const Je=(t,e,n,r,s)=>t.ta(e,n,r,s),$t=(t,e,n,r,s)=>t.tr(e,n,r,s),oC=(t,e,n,r,s)=>t.ts(e,n,r,s),ge=(t,e,n,r,s)=>t.tt(e,n,r,s),zs="WORD",Mx="UWORD",uA="ASCIINUMERICAL",dA="ALPHANUMERICAL",lu="LOCALHOST",Ox="TLD",jx="UTLD",yf="SCHEME",Vo="SLASH_SCHEME",qb="NUM",_x="WS",Wb="NL",Pc="OPENBRACE",Hc="CLOSEBRACE",nh="OPENBRACKET",rh="CLOSEBRACKET",sh="OPENPAREN",ih="CLOSEPAREN",ah="OPENANGLEBRACKET",oh="CLOSEANGLEBRACKET",lh="FULLWIDTHLEFTPAREN",ch="FULLWIDTHRIGHTPAREN",uh="LEFTCORNERBRACKET",dh="RIGHTCORNERBRACKET",fh="LEFTWHITECORNERBRACKET",hh="RIGHTWHITECORNERBRACKET",ph="FULLWIDTHLESSTHAN",mh="FULLWIDTHGREATERTHAN",gh="AMPERSAND",xh="APOSTROPHE",bh="ASTERISK",Li="AT",yh="BACKSLASH",vh="BACKTICK",wh="CARET",Bi="COLON",Kb="COMMA",kh="DOLLAR",rs="DOT",Ch="EQUALS",Gb="EXCLAMATION",Or="HYPHEN",Fc="PERCENT",Sh="PIPE",Eh="PLUS",Nh="POUND",Uc="QUERY",Yb="QUOTE",fA="FULLWIDTHMIDDLEDOT",Jb="SEMI",ss="SLASH",$c="TILDE",Th="UNDERSCORE",hA="EMOJI",Ah="SYM";var pA=Object.freeze({__proto__:null,ALPHANUMERICAL:dA,AMPERSAND:gh,APOSTROPHE:xh,ASCIINUMERICAL:uA,ASTERISK:bh,AT:Li,BACKSLASH:yh,BACKTICK:vh,CARET:wh,CLOSEANGLEBRACKET:oh,CLOSEBRACE:Hc,CLOSEBRACKET:rh,CLOSEPAREN:ih,COLON:Bi,COMMA:Kb,DOLLAR:kh,DOT:rs,EMOJI:hA,EQUALS:Ch,EXCLAMATION:Gb,FULLWIDTHGREATERTHAN:mh,FULLWIDTHLEFTPAREN:lh,FULLWIDTHLESSTHAN:ph,FULLWIDTHMIDDLEDOT:fA,FULLWIDTHRIGHTPAREN:ch,HYPHEN:Or,LEFTCORNERBRACKET:uh,LEFTWHITECORNERBRACKET:fh,LOCALHOST:lu,NL:Wb,NUM:qb,OPENANGLEBRACKET:ah,OPENBRACE:Pc,OPENBRACKET:nh,OPENPAREN:sh,PERCENT:Fc,PIPE:Sh,PLUS:Eh,POUND:Nh,QUERY:Uc,QUOTE:Yb,RIGHTCORNERBRACKET:dh,RIGHTWHITECORNERBRACKET:hh,SCHEME:yf,SEMI:Jb,SLASH:ss,SLASH_SCHEME:Vo,SYM:Ah,TILDE:$c,TLD:Ox,UNDERSCORE:Th,UTLD:jx,UWORD:Mx,WORD:zs,WS:_x});const Ls=/[a-z]/,kc=new RegExp("\\p{L}","u"),c0=new RegExp("\\p{Emoji}","u"),Is=/\d/,u0=/\s/,lC="\r",d0=`
`,qP="",WP="",f0="";let ef=null,tf=null;function KP(t=[]){const e={};ir.groups=e;const n=new ir;ef==null&&(ef=cC(PP)),tf==null&&(tf=cC(HP)),ge(n,"'",xh),ge(n,"{",Pc),ge(n,"}",Hc),ge(n,"[",nh),ge(n,"]",rh),ge(n,"(",sh),ge(n,")",ih),ge(n,"<",ah),ge(n,">",oh),ge(n,"",lh),ge(n,"",ch),ge(n,"",uh),ge(n,"",dh),ge(n,"",fh),ge(n,"",hh),ge(n,"",ph),ge(n,"",mh),ge(n,"&",gh),ge(n,"*",bh),ge(n,"@",Li),ge(n,"`",vh),ge(n,"^",wh),ge(n,":",Bi),ge(n,",",Kb),ge(n,"$",kh),ge(n,".",rs),ge(n,"=",Ch),ge(n,"!",Gb),ge(n,"-",Or),ge(n,"%",Fc),ge(n,"|",Sh),ge(n,"+",Eh),ge(n,"#",Nh),ge(n,"?",Uc),ge(n,'"',Yb),ge(n,"/",ss),ge(n,";",Jb),ge(n,"~",$c),ge(n,"_",Th),ge(n,"\\",yh),ge(n,"",fA);const r=$t(n,Is,qb,{[Ex]:!0});$t(r,Is,r);const s=$t(r,Ls,uA,{[Bc]:!0}),a=$t(r,kc,dA,{[Ac]:!0}),l=$t(n,Ls,zs,{[Nx]:!0});$t(l,Is,s),$t(l,Ls,l),$t(s,Is,s),$t(s,Ls,s);const c=$t(n,kc,Mx,{[Tx]:!0});$t(c,Ls),$t(c,Is,a),$t(c,kc,c),$t(a,Is,a),$t(a,Ls),$t(a,kc,a);const d=ge(n,d0,Wb,{[l0]:!0}),p=ge(n,lC,_x,{[l0]:!0}),m=$t(n,u0,_x,{[l0]:!0});ge(n,f0,m),ge(p,d0,d),ge(p,f0,m),$t(p,u0,m),ge(m,lC),ge(m,d0),$t(m,u0,m),ge(m,f0,m);const g=$t(n,c0,hA,{[cA]:!0});ge(g,"#"),$t(g,c0,g),ge(g,qP,g);const b=ge(g,WP);ge(b,"#"),$t(b,c0,g);const v=[[Ls,l],[Is,s]],w=[[Ls,null],[kc,c],[Is,a]];for(let C=0;C<ef.length;C++)Oi(n,ef[C],Ox,zs,v);for(let C=0;C<tf.length;C++)Oi(n,tf[C],jx,Mx,w);Ia(Ox,{tld:!0,ascii:!0},e),Ia(jx,{utld:!0,alpha:!0},e),Oi(n,"file",yf,zs,v),Oi(n,"mailto",yf,zs,v),Oi(n,"http",Vo,zs,v),Oi(n,"https",Vo,zs,v),Oi(n,"ftp",Vo,zs,v),Oi(n,"ftps",Vo,zs,v),Ia(yf,{scheme:!0,ascii:!0},e),Ia(Vo,{slashscheme:!0,ascii:!0},e),t=t.sort((C,k)=>C[0]>k[0]?1:-1);for(let C=0;C<t.length;C++){const k=t[C][0],M=t[C][1]?{[FP]:!0}:{[UP]:!0};k.indexOf("-")>=0?M[Ax]=!0:Ls.test(k)?Is.test(k)?M[Bc]=!0:M[Nx]=!0:M[Ex]=!0,oC(n,k,k,M)}return oC(n,"localhost",lu,{ascii:!0}),n.jd=new ir(Ah),{start:n,tokens:Object.assign({groups:e},pA)}}function mA(t,e){const n=GP(e.replace(/[A-Z]/g,c=>c.toLowerCase())),r=n.length,s=[];let a=0,l=0;for(;l<r;){let c=t,d=null,p=0,m=null,g=-1,b=-1;for(;l<r&&(d=c.go(n[l]));)c=d,c.accepts()?(g=0,b=0,m=c):g>=0&&(g+=n[l].length,b++),p+=n[l].length,a+=n[l].length,l++;a-=g,l-=b,p-=g,s.push({t:m.t,v:e.slice(a-p,a),s:a-p,e:a})}return s}function GP(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),a,l=s<55296||s>56319||r+1===n||(a=t.charCodeAt(r+1))<56320||a>57343?t[r]:t.slice(r,r+2);e.push(l),r+=l.length}return e}function Oi(t,e,n,r,s){let a;const l=e.length;for(let c=0;c<l-1;c++){const d=e[c];t.j[d]?a=t.j[d]:(a=new ir(r),a.jr=s.slice(),t.j[d]=a),t=a}return a=new ir(n),a.jr=s.slice(),t.j[e[l-1]]=a,a}function cC(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let a=0;for(;s.indexOf(t[r+a])>=0;)a++;if(a>0){e.push(n.join(""));for(let l=parseInt(t.substring(r,r+a),10);l>0;l--)n.pop();r+=a}else n.push(t[r]),r++}return e}const cu={defaultProtocol:"http",events:null,format:uC,formatHref:uC,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Xb(t,e=null){let n=Object.assign({},cu);t&&(n=Object.assign(n,t instanceof Xb?t.o:t));const r=n.ignoreTags,s=[];for(let a=0;a<r.length;a++)s.push(r[a].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}Xb.prototype={o:cu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:cu[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function uC(t){return t}function gA(t,e){this.t="token",this.v=t,this.tk=e}gA.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=cu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),a=this.toFormattedString(t),l={},c=t.get("className",n,e),d=t.get("target",n,e),p=t.get("rel",n,e),m=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return l.href=r,c&&(l.class=c),d&&(l.target=d),p&&(l.rel=p),m&&Object.assign(l,m),{tagName:s,attributes:l,content:a,eventListeners:g}}};function dp(t,e){class n extends gA{constructor(s,a){super(s,a),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const dC=dp("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),fC=dp("text"),YP=dp("nl"),nf=dp("url",{isLink:!0,toHref(t=cu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==lu&&t[1].t===Bi}}),Mr=t=>new ir(t);function JP({groups:t}){const e=t.domain.concat([gh,bh,Li,yh,vh,wh,kh,Ch,Or,qb,Fc,Sh,Eh,Nh,ss,Ah,$c,Th]),n=[xh,Bi,Kb,rs,Gb,Fc,Uc,Yb,Jb,ah,oh,Pc,Hc,rh,nh,sh,ih,lh,ch,uh,dh,fh,hh,ph,mh],r=[gh,xh,bh,yh,vh,wh,kh,Ch,Or,Pc,Hc,Fc,Sh,Eh,Nh,Uc,ss,Ah,$c,Th],s=Mr(),a=ge(s,$c);Je(a,r,a),Je(a,t.domain,a);const l=Mr(),c=Mr(),d=Mr();Je(s,t.domain,l),Je(s,t.scheme,c),Je(s,t.slashscheme,d),Je(l,r,a),Je(l,t.domain,l);const p=ge(l,Li);ge(a,Li,p),ge(c,Li,p),ge(d,Li,p);const m=ge(a,rs);Je(m,r,a),Je(m,t.domain,a);const g=Mr();Je(p,t.domain,g),Je(g,t.domain,g);const b=ge(g,rs);Je(b,t.domain,g);const v=Mr(dC);Je(b,t.tld,v),Je(b,t.utld,v),ge(p,lu,v);const w=ge(g,Or);ge(w,Or,w),Je(w,t.domain,g),Je(v,t.domain,g),ge(v,rs,b),ge(v,Or,w);const C=ge(v,Bi);Je(C,t.numeric,dC);const k=ge(l,Or),N=ge(l,rs);ge(k,Or,k),Je(k,t.domain,l),Je(N,r,a),Je(N,t.domain,l);const M=Mr(nf);Je(N,t.tld,M),Je(N,t.utld,M),Je(M,t.domain,l),Je(M,r,a),ge(M,rs,N),ge(M,Or,k),ge(M,Li,p);const _=ge(M,Bi),P=Mr(nf);Je(_,t.numeric,P);const z=Mr(nf),K=Mr();Je(z,e,z),Je(z,n,K),Je(K,e,z),Je(K,n,K),ge(M,ss,z),ge(P,ss,z);const O=ge(c,Bi),F=ge(d,Bi),V=ge(F,ss),Z=ge(V,ss);Je(c,t.domain,l),ge(c,rs,N),ge(c,Or,k),Je(d,t.domain,l),ge(d,rs,N),ge(d,Or,k),Je(O,t.domain,z),ge(O,ss,z),ge(O,Uc,z),Je(Z,t.domain,z),Je(Z,e,z),ge(Z,ss,z);const he=[[Pc,Hc],[nh,rh],[sh,ih],[ah,oh],[lh,ch],[uh,dh],[fh,hh],[ph,mh]];for(let Te=0;Te<he.length;Te++){const[ve,Se]=he[Te],Ee=ge(z,ve);ge(K,ve,Ee),ge(Ee,Se,z);const q=Mr(nf);Je(Ee,e,q);const te=Mr();Je(Ee,n),Je(q,e,q),Je(q,n,te),Je(te,e,q),Je(te,n,te),ge(q,Se,z),ge(te,Se,z)}return ge(s,lu,M),ge(s,Wb,YP),{start:s,tokens:pA}}function XP(t,e,n){let r=n.length,s=0,a=[],l=[];for(;s<r;){let c=t,d=null,p=null,m=0,g=null,b=-1;for(;s<r&&!(d=c.go(n[s].t));)l.push(n[s++]);for(;s<r&&(p=d||c.go(n[s].t));)d=null,c=p,c.accepts()?(b=0,g=c):b>=0&&b++,s++,m++;if(b<0)s-=m,s<r&&(l.push(n[s]),s++);else{l.length>0&&(a.push(h0(fC,e,l)),l=[]),s-=b,m-=b;const v=g.t,w=n.slice(s-m,s);a.push(h0(v,e,w))}}return l.length>0&&a.push(h0(fC,e,l)),a}function h0(t,e,n){const r=n[0].s,s=n[n.length-1].e,a=e.slice(r,s);return new t(a,n)}const QP=typeof console<"u"&&console&&console.warn||(()=>{}),ZP="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",jt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function e7(){return ir.groups={},jt.scanner=null,jt.parser=null,jt.tokenQueue=[],jt.pluginQueue=[],jt.customSchemes=[],jt.initialized=!1,jt}function hC(t,e=!1){if(jt.initialized&&QP(`linkifyjs: already initialized - will not register custom scheme "${t}" ${ZP}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);jt.customSchemes.push([t,e])}function t7(){jt.scanner=KP(jt.customSchemes);for(let t=0;t<jt.tokenQueue.length;t++)jt.tokenQueue[t][1]({scanner:jt.scanner});jt.parser=JP(jt.scanner.tokens);for(let t=0;t<jt.pluginQueue.length;t++)jt.pluginQueue[t][1]({scanner:jt.scanner,parser:jt.parser});return jt.initialized=!0,jt}function Qb(t){return jt.initialized||t7(),XP(jt.parser.start,t,mA(jt.scanner.start,t))}Qb.scan=mA;function xA(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Xb(n),s=Qb(t),a=[];for(let l=0;l<s.length;l++){const c=s[l];c.isLink&&(!e||c.t===e)&&r.check(c)&&a.push(c.toFormattedObject(r))}return a}var Zb="[\0- -\u2029]",n7=new RegExp(Zb),r7=new RegExp(`${Zb}$`),s7=new RegExp(Zb,"g");function i7(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function a7(t){return new Rt({key:new Wt("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(p=>p.docChanged)&&!n.doc.eq(r.doc),a=e.some(p=>p.getMeta("preventAutolink"));if(!s||a)return;const{tr:l}=r,c=OT(n.doc,[...e]);if(BT(c).forEach(({newRange:p})=>{const m=o8(r.doc,p,v=>v.isTextblock);let g,b;if(m.length>1)g=m[0],b=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(m.length){const v=r.doc.textBetween(p.from,p.to," "," ");if(!r7.test(v))return;g=m[0],b=r.doc.textBetween(g.pos,p.to,void 0," ")}if(g&&b){const v=b.split(n7).filter(Boolean);if(v.length<=0)return!1;const w=v[v.length-1],C=g.pos+b.lastIndexOf(w);if(!w)return!1;const k=Qb(w).map(N=>N.toObject(t.defaultProtocol));if(!i7(k))return!1;k.filter(N=>N.isLink).map(N=>({...N,from:C+N.start+1,to:C+N.end+1})).filter(N=>r.schema.marks.code?!r.doc.rangeHasMark(N.from,N.to,r.schema.marks.code):!0).filter(N=>t.validate(N.value)).filter(N=>t.shouldAutoLink(N.value)).forEach(N=>{Pb(N.from,N.to,r.doc).some(M=>M.mark.type===t.type)||l.addMark(N.from,N.to,t.type.create({href:N.href}))})}}),!!l.steps.length)return l}})}function o7(t){return new Rt({key:new Wt("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,a;if(r.button!==0||!e.editable)return!1;let l=null;if(r.target instanceof HTMLAnchorElement)l=r.target;else{const d=r.target;if(!d)return!1;const p=t.editor.view.dom;l=d.closest("a"),l&&!p.contains(l)&&(l=null)}if(!l)return!1;let c=!1;if(t.enableClickSelection&&(c=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const d=zT(e.state,t.type.name),p=(s=l.href)!=null?s:d.href,m=(a=l.target)!=null?a:d.target;p&&(window.open(p,m),c=!0)}return c}}})}function l7(t){return new Rt({key:new Wt("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:a}=e,{selection:l}=a,{empty:c}=l;if(c)return!1;let d="";r.content.forEach(m=>{d+=m.textContent});const p=xA(d,{defaultProtocol:t.defaultProtocol}).find(m=>m.isLink&&m.value===d);return!d||!p||s!==void 0&&!s(p.value)?!1:t.editor.commands.setMark(t.type,{href:p.href})}}})}function Ta(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(s7,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var c7=na.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){hC(t);return}hC(t.scheme,t.optionalSlashes)})},onDestroy(){e7()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Ta(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const s=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Ta(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Ta(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",_t(this.options.HTMLAttributes,t),0]:["a",_t(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n,r,s,a;const l=(r=(n=t.attrs)==null?void 0:n.href)!=null?r:"",c=(a=(s=t.attrs)==null?void 0:s.title)!=null?a:"",d=e.renderChildren(t);return c?`[${d}](${l} "${c}")`:`[${d}](${l})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Ta(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Ta(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Xa({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=xA(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:l=>!!Ta(l,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(a7({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Ta(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(o7({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(l7({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),u7=Object.defineProperty,d7=(t,e)=>{for(var n in e)u7(t,n,{get:e[n],enumerable:!0})},f7="listItem",pC="textStyle",mC=/^\s*([-+*])\s$/,bA=_n.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",_t(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(f7,this.editor.getAttributes(pC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=fl({find:mC,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fl({find:mC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(pC),editor:this.editor})),[t]}}),yA=_n.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",_t(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const l=t.tokens.slice(1),c=e.parseChildren(l);n.push(...c)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>$b(t,e,r=>{var s,a;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((a=(s=r.meta)==null?void 0:s.parentAttrs)==null?void 0:a.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),h7={};d7(h7,{findListItemPos:()=>Eu,getNextListDepth:()=>ey,handleBackspace:()=>Rx,handleDelete:()=>Dx,hasListBefore:()=>vA,hasListItemAfter:()=>p7,hasListItemBefore:()=>wA,listItemHasSubList:()=>kA,nextListIsDeeper:()=>CA,nextListIsHigher:()=>SA});var Eu=(t,e)=>{const{$from:n}=e.selection,r=sn(t,e.schema);let s=null,a=n.depth,l=n.pos,c=null;for(;a>0&&c===null;)s=n.node(a),s.type===r?c=a:(a-=1,l-=1);return c===null?null:{$pos:e.doc.resolve(l),depth:c}},ey=(t,e)=>{const n=Eu(t,e);if(!n)return!1;const[,r]=g8(e,t,n.$pos.pos+4);return r},vA=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),a=t.doc.resolve(s).node();return!(!a||!n.includes(a.type.name))},wA=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},kA=(t,e,n)=>{if(!n)return!1;const r=sn(t,e.schema);let s=!1;return n.descendants(a=>{a.type===r&&(s=!0)}),s},Rx=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Zi(t.state,e)&&vA(t.state,e,n)){const{$anchor:c}=t.state.selection,d=t.state.doc.resolve(c.before()-1),p=[];d.node().descendants((b,v)=>{b.type.name===e&&p.push({node:b,pos:v})});const m=p.at(-1);if(!m)return!1;const g=t.state.doc.resolve(d.start()+m.pos+1);return t.chain().cut({from:c.start()-1,to:c.end()+1},g.end()).joinForward().run()}if(!Zi(t.state,e)||!v8(t.state))return!1;const r=Eu(e,t.state);if(!r)return!1;const a=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),l=kA(e,t.state,a);return wA(e,t.state)&&!l?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},CA=(t,e)=>{const n=ey(t,e),r=Eu(t,e);return!r||!n?!1:n>r.depth},SA=(t,e)=>{const n=ey(t,e),r=Eu(t,e);return!r||!n?!1:n<r.depth},Dx=(t,e)=>{if(!Zi(t.state,e)||!y8(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:CA(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():SA(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},p7=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},EA=vt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Rx(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Rx(t,n,r)&&(e=!0)}),e}}}}),gC=/^(\s*)(\d+)\.\s+(.*)$/,m7=/^\s/;function g7(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],a=s.match(gC);if(!a)break;const[,l,c,d]=a,p=l.length;let m=d,g=n+1;const b=[s];for(;g<t.length;){const v=t[g];if(v.match(gC))break;if(v.trim()==="")b.push(v),m+=`
`,g+=1;else if(v.match(m7))b.push(v),m+=`
${v.slice(p+2)}`,g+=1;else break}e.push({indent:p,number:parseInt(c,10),content:m.trim(),raw:b.join(`
`)}),r=g,n=g}return[e,r]}function NA(t,e,n){var r;const s=[];let a=0;for(;a<t.length;){const l=t[a];if(l.indent===e){const c=l.content.split(`
`),d=((r=c[0])==null?void 0:r.trim())||"",p=[];d&&p.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const m=c.slice(1).join(`
`).trim();if(m){const v=n.blockTokens(m);p.push(...v)}let g=a+1;const b=[];for(;g<t.length&&t[g].indent>e;)b.push(t[g]),g+=1;if(b.length>0){const v=Math.min(...b.map(C=>C.indent)),w=NA(b,v,n);p.push({type:"list",ordered:!0,start:b[0].number,items:w,raw:b.map(C=>C.raw).join(`
`)})}s.push({type:"list_item",raw:l.raw,tokens:p}),a=g}else a+=1}return s}function x7(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const a=e.parseChildren([s]);r.push({type:"paragraph",content:a})}else{const a=e.parseChildren([s]);a.length>0&&r.push(...a)}}),{type:"listItem",content:r}})}var b7="listItem",xC="textStyle",bC=/^(\d+)\.\s$/,TA=_n.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",_t(this.options.HTMLAttributes,n),0]:["ol",_t(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?x7(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[a,l]=g7(s);if(a.length===0)return;const c=NA(a,0,n);return c.length===0?void 0:{type:"list",ordered:!0,start:((r=a[0])==null?void 0:r.number)||1,items:c,raw:s.slice(0,l).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(b7,this.editor.getAttributes(xC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=fl({find:bC,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fl({find:bC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(xC)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),y7=/^\s*(\[([( |x])?\])\s$/,AA=_n.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",_t(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return $b(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),a=document.createElement("label"),l=document.createElement("span"),c=document.createElement("input"),d=document.createElement("div"),p=g=>{var b,v;c.ariaLabel=((v=(b=this.options.a11y)==null?void 0:b.checkboxLabel)==null?void 0:v.call(b,g,c.checked))||`Task item checkbox for ${g.textContent||"empty task item"}`};p(t),a.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",g=>g.preventDefault()),c.addEventListener("change",g=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){c.checked=!c.checked;return}const{checked:b}=g.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const w=n();if(typeof w!="number")return!1;const C=v.doc.nodeAt(w);return v.setNodeMarkup(w,void 0,{...C==null?void 0:C.attrs,checked:b}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,b)||(c.checked=!c.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([g,b])=>{s.setAttribute(g,b)}),s.dataset.checked=t.attrs.checked,c.checked=t.attrs.checked,a.append(c,l),s.append(a,d),Object.entries(e).forEach(([g,b])=>{s.setAttribute(g,b)});let m=new Set(Object.keys(e));return{dom:s,contentDOM:d,update:g=>{if(g.type!==this.type)return!1;s.dataset.checked=g.attrs.checked,c.checked=g.attrs.checked,p(g);const b=r.extensionManager.attributes,v=ou(g,b),w=new Set(Object.keys(v)),C=this.options.HTMLAttributes;return m.forEach(k=>{w.has(k)||(k in C?s.setAttribute(k,C[k]):s.removeAttribute(k))}),Object.entries(v).forEach(([k,N])=>{N==null?k in C?s.setAttribute(k,C[k]):s.removeAttribute(k):s.setAttribute(k,N)}),m=w,!0}}}},addInputRules(){return[fl({find:y7,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),MA=_n.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",_t(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=a=>{const l=Cx(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:c=>({indentLevel:c[1].length,mainContent:c[4],checked:c[3].toLowerCase()==="x"}),createToken:(c,d)=>({type:"taskItem",raw:"",mainContent:c.mainContent,indentLevel:c.indentLevel,checked:c.checked,text:c.mainContent,tokens:n.inlineTokens(c.mainContent),nestedTokens:d}),customNestedParser:r},n);return l?[{type:"taskList",raw:l.raw,items:l.items}]:n.blockTokens(a)},s=Cx(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:n.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});vt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(bA.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(yA.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(EA.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(TA.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(AA.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(MA.configure(this.options.taskList)),t}});var yC="&nbsp;",v7="",w7=_n.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",_t(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];if(n.length===1&&n[0].type==="image")return e.parseChildren([n[0]]);const r=e.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===yC||r[0].text===v7)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(t,e)=>{if(!t)return"";const n=Array.isArray(t.content)?t.content:[];return n.length===0?yC:e.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),k7=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,C7=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,S7=na.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",_t(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[dl({find:k7,type:this.type})]},addPasteRules(){return[Xa({find:C7,type:this.type})]}}),E7=_n.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),OA=na.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",_t(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const a=s[2].trim();return{type:"underline",raw:s[0],text:a,tokens:n.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),N7=OA;function T7(t={}){return new Rt({view(e){return new A7(e,t)}})}class A7{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let a=l=>{this[s](l)};return e.dom.addEventListener(s,a),{name:s,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,a=s.getBoundingClientRect(),l=a.width/s.offsetWidth,c=a.height/s.offsetHeight;if(n){let g=e.nodeBefore,b=e.nodeAfter;if(g||b){let v=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(v){let w=v.getBoundingClientRect(),C=g?w.bottom:w.top;g&&b&&(C=(C+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let k=this.width/2*c;r={left:w.left,right:w.right,top:C-k,bottom:C+k}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),b=this.width/2*l;r={left:g.left-b,right:g.left+b,top:g.top,bottom:g.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let p,m;if(!d||d==document.body&&getComputedStyle(d).position=="static")p=-pageXOffset,m=-pageYOffset;else{let g=d.getBoundingClientRect(),b=g.width/d.offsetWidth,v=g.height/d.offsetHeight;p=g.left-d.scrollLeft*b,m=g.top-d.scrollTop*v}this.element.style.left=(r.left-p)/l+"px",this.element.style.top=(r.top-m)/c+"px",this.element.style.width=(r.right-r.left)/l+"px",this.element.style.height=(r.bottom-r.top)/c+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!a){let l=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=kN(this.editorView.state.doc,l,this.editorView.dragging.slice);c!=null&&(l=c)}this.setCursor(l),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Vt extends $e{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Vt.valid(r)?new Vt(r):$e.near(r)}content(){return Ne.empty}eq(e){return e instanceof Vt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Vt(e.resolve(n.pos))}getBookmark(){return new ty(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!M7(e)||!O7(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Vt.valid(e))return e;let s=e.pos,a=null;for(let l=e.depth;;l--){let c=e.node(l);if(n>0?e.indexAfter(l)<c.childCount:e.index(l)>0){a=c.child(n>0?e.indexAfter(l):e.index(l)-1);break}else if(l==0)return null;s+=n;let d=e.doc.resolve(s);if(Vt.valid(d))return d}for(;;){let l=n>0?a.firstChild:a.lastChild;if(!l){if(a.isAtom&&!a.isText&&!ze.isSelectable(a)){e=e.doc.resolve(s+a.nodeSize*n),r=!1;continue e}break}a=l,s+=n;let c=e.doc.resolve(s);if(Vt.valid(c))return c}return null}}}Vt.prototype.visible=!1;Vt.findFrom=Vt.findGapCursorFrom;$e.jsonID("gapcursor",Vt);class ty{constructor(e){this.pos=e}map(e){return new ty(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Vt.valid(n)?new Vt(n):$e.near(n)}}function jA(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function M7(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||jA(s.type))return!0;if(s.inlineContent)return!1}}return!0}function O7(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||jA(s.type))return!0;if(s.inlineContent)return!1}}return!0}function j7(){return new Rt({props:{decorations:L7,createSelectionBetween(t,e,n){return e.pos==n.pos&&Vt.valid(n)?new Vt(n):null},handleClick:R7,handleKeyDown:_7,handleDOMEvents:{beforeinput:D7}}})}const _7=Rb({ArrowLeft:rf("horiz",-1),ArrowRight:rf("horiz",1),ArrowUp:rf("vert",-1),ArrowDown:rf("vert",1)});function rf(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,a){let l=r.selection,c=e>0?l.$to:l.$from,d=l.empty;if(l instanceof Be){if(!a.endOfTextblock(n)||c.depth==0)return!1;d=!1,c=r.doc.resolve(e>0?c.after():c.before())}let p=Vt.findGapCursorFrom(c,e,d);return p?(s&&s(r.tr.setSelection(new Vt(p))),!0):!1}}function R7(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Vt.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&ze.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Vt(r))),!0)}function D7(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Vt))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=fe.empty;for(let l=r.length-1;l>=0;l--)s=fe.from(r[l].createAndFill(null,s));let a=t.state.tr.replace(n.pos,n.pos,new Ne(s,0,0));return a.setSelection(Be.near(a.doc.resolve(n.pos+1))),t.dispatch(a),!1}function L7(t){if(!(t.selection instanceof Vt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Nt.create(t.doc,[yn.widget(t.selection.head,e,{key:"gapcursor"})])}var Mh=200,wn=function(){};wn.prototype.append=function(e){return e.length?(e=wn.from(e),!this.length&&e||e.length<Mh&&this.leafAppend(e)||this.length<Mh&&e.leafPrepend(this)||this.appendInner(e)):this};wn.prototype.prepend=function(e){return e.length?wn.from(e).append(this):this};wn.prototype.appendInner=function(e){return new I7(this,e)};wn.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?wn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};wn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};wn.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};wn.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(a,l){return s.push(e(a,l))},n,r),s};wn.from=function(e){return e instanceof wn?e:e&&e.length?new _A(e):wn.empty};var _A=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,a){return s==0&&a==this.length?this:new e(this.values.slice(s,a))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,a,l,c){for(var d=a;d<l;d++)if(s(this.values[d],c+d)===!1)return!1},e.prototype.forEachInvertedInner=function(s,a,l,c){for(var d=a-1;d>=l;d--)if(s(this.values[d],c+d)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Mh)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Mh)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(wn);wn.empty=new _A([]);var I7=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,a,l){var c=this.left.length;if(s<c&&this.left.forEachInner(r,s,Math.min(a,c),l)===!1||a>c&&this.right.forEachInner(r,Math.max(s-c,0),Math.min(this.length,a)-c,l+c)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,a,l){var c=this.left.length;if(s>c&&this.right.forEachInvertedInner(r,s-c,Math.max(a,c)-c,l+c)===!1||a<c&&this.left.forEachInvertedInner(r,Math.min(s,c),a,l)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var a=this.left.length;return s<=a?this.left.slice(r,s):r>=a?this.right.slice(r-a,s-a):this.left.slice(r,a).append(this.right.slice(0,s-a))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(wn);const z7=500;class Hr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,a;n&&(s=this.remapping(r,this.items.length),a=s.maps.length);let l=e.tr,c,d,p=[],m=[];return this.items.forEach((g,b)=>{if(!g.step){s||(s=this.remapping(r,b+1),a=s.maps.length),a--,m.push(g);return}if(s){m.push(new is(g.map));let v=g.step.map(s.slice(a)),w;v&&l.maybeStep(v).doc&&(w=l.mapping.maps[l.mapping.maps.length-1],p.push(new is(w,void 0,void 0,p.length+m.length))),a--,w&&s.appendMap(w,a)}else l.maybeStep(g.step);if(g.selection)return c=s?g.selection.map(s.slice(a)):g.selection,d=new Hr(this.items.slice(0,r).append(m.reverse().concat(p)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:l,selection:c}}addTransform(e,n,r,s){let a=[],l=this.eventCount,c=this.items,d=!s&&c.length?c.get(c.length-1):null;for(let m=0;m<e.steps.length;m++){let g=e.steps[m].invert(e.docs[m]),b=new is(e.mapping.maps[m],g,n),v;(v=d&&d.merge(b))&&(b=v,m?a.pop():c=c.slice(0,c.length-1)),a.push(b),n&&(l++,n=void 0),s||(d=b)}let p=l-r.depth;return p>P7&&(c=B7(c,p),l-=p),new Hr(c.append(a),l)}remapping(e,n){let r=new tu;return this.items.forEach((s,a)=>{let l=s.mirrorOffset!=null&&a-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,l)},e,n),r}addMaps(e){return this.eventCount==0?this:new Hr(this.items.append(e.map(n=>new is(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),a=e.mapping,l=e.steps.length,c=this.eventCount;this.items.forEach(b=>{b.selection&&c--},s);let d=n;this.items.forEach(b=>{let v=a.getMirror(--d);if(v==null)return;l=Math.min(l,v);let w=a.maps[v];if(b.step){let C=e.steps[v].invert(e.docs[v]),k=b.selection&&b.selection.map(a.slice(d+1,v));k&&c++,r.push(new is(w,C,k))}else r.push(new is(w))},s);let p=[];for(let b=n;b<l;b++)p.push(new is(a.maps[b]));let m=this.items.slice(0,s).append(p).append(r),g=new Hr(m,c);return g.emptyItemCount()>z7&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],a=0;return this.items.forEach((l,c)=>{if(c>=e)s.push(l),l.selection&&a++;else if(l.step){let d=l.step.map(n.slice(r)),p=d&&d.getMap();if(r--,p&&n.appendMap(p,r),d){let m=l.selection&&l.selection.map(n.slice(r));m&&a++;let g=new is(p.invert(),d,m),b,v=s.length-1;(b=s.length&&s[v].merge(g))?s[v]=b:s.push(g)}}else l.map&&r--},this.items.length,0),new Hr(wn.from(s.reverse()),a)}}Hr.empty=new Hr(wn.empty,0);function B7(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class is{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new is(n.getMap().invert(),n,this.selection)}}}class Ii{constructor(e,n,r,s,a){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=a}}const P7=20;function H7(t,e,n,r){let s=n.getMeta(Va),a;if(s)return s.historyState;n.getMeta($7)&&(t=new Ii(t.done,t.undone,null,0,-1));let l=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(l&&l.getMeta(Va))return l.getMeta(Va).redo?new Ii(t.done.addTransform(n,void 0,r,vf(e)),t.undone,vC(n.mapping.maps),t.prevTime,t.prevComposition):new Ii(t.done,t.undone.addTransform(n,void 0,r,vf(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(l&&l.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),d=t.prevTime==0||!l&&t.prevComposition!=c&&(t.prevTime<(n.time||0)-r.newGroupDelay||!F7(n,t.prevRanges)),p=l?p0(t.prevRanges,n.mapping):vC(n.mapping.maps);return new Ii(t.done.addTransform(n,d?e.selection.getBookmark():void 0,r,vf(e)),Hr.empty,p,n.time,c??t.prevComposition)}else return(a=n.getMeta("rebased"))?new Ii(t.done.rebased(n,a),t.undone.rebased(n,a),p0(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Ii(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),p0(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function F7(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let a=0;a<e.length;a+=2)r<=e[a+1]&&s>=e[a]&&(n=!0)}),n}function vC(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,a,l)=>e.push(a,l));return e}function p0(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),a=e.map(t[r+1],-1);s<=a&&n.push(s,a)}return n}function U7(t,e,n){let r=vf(e),s=Va.get(e).spec.config,a=(n?t.undone:t.done).popEvent(e,r);if(!a)return null;let l=a.selection.resolve(a.transform.doc),c=(n?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),s,r),d=new Ii(n?c:a.remaining,n?a.remaining:c,null,0,-1);return a.transform.setSelection(l).setMeta(Va,{redo:n,historyState:d})}let m0=!1,wC=null;function vf(t){let e=t.plugins;if(wC!=e){m0=!1,wC=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){m0=!0;break}}return m0}const Va=new Wt("history"),$7=new Wt("closeHistory");function V7(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Rt({key:Va,state:{init(){return new Ii(Hr.empty,Hr.empty,null,0,-1)},apply(e,n,r){return H7(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?DA:r=="historyRedo"?LA:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function RA(t,e){return(n,r)=>{let s=Va.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let a=U7(s,n,t);a&&r(e?a.scrollIntoView():a)}return!0}}const DA=RA(!1,!0),LA=RA(!0,!0);vt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new Rt({key:new Wt("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const a=this.storage.characters({node:r.doc});if(a>s){const l=a-s,c=0,d=l;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const p=r.tr.deleteRange(c,d);return t=!0,p}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),a=this.storage.characters({node:e.doc});if(a<=r||s>r&&a>r&&a<=s)return!0;if(s>r&&a>r&&a>s||!e.getMeta("paste"))return!1;const c=e.selection.$head.pos,d=a-r,p=c-d,m=c;return e.deleteRange(p,m),!(this.storage.characters({node:e.doc})>r)}})]}});var q7=vt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[T7(this.options)]}});vt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Rt({key:new Wt("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,a=[];if(!n||!r)return Nt.create(t,[]);let l=0;this.options.mode==="deepest"&&t.descendants((d,p)=>{if(d.isText)return;if(!(s>=p&&s<=p+d.nodeSize-1))return!1;l+=1});let c=0;return t.descendants((d,p)=>{if(d.isText||!(s>=p&&s<=p+d.nodeSize-1))return!1;if(c+=1,this.options.mode==="deepest"&&l-c>0||this.options.mode==="shallowest"&&c>1)return this.options.mode==="deepest";a.push(yn.node(p,p+d.nodeSize,{class:this.options.className}))}),Nt.create(t,a)}}})]}});var W7=vt.create({name:"gapCursor",addProseMirrorPlugins(){return[j7()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ht(Le(t,"allowGapCursor",n)))!=null?e:null}}}),kC="placeholder";function K7(t){return t.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var G7=vt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:kC,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const t=this.options.dataAttribute?`data-${K7(this.options.dataAttribute)}`:`data-${kC}`;return[new Rt({key:new Wt("placeholder"),props:{decorations:({doc:e,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=n,a=[];if(!r)return null;const l=this.editor.isEmpty;return e.descendants((c,d)=>{const p=s>=d&&s<=d+c.nodeSize,m=!c.isLeaf&&lp(c);if((p||!this.options.showOnlyCurrent)&&m){const g=[this.options.emptyNodeClass];l&&g.push(this.options.emptyEditorClass);const b=yn.node(d,d+c.nodeSize,{class:g.join(" "),[t]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:c,pos:d,hasAnchor:p}):this.options.placeholder});a.push(b)}return this.options.includeChildren}),Nt.create(e,a)}}})]}});vt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Rt({key:new Wt("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||PT(n.selection)||t.view.dragging?null:Nt.create(n.doc,[yn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function CC({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var Y7=vt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Wt(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new Rt({key:e,appendTransaction:(s,a,l)=>{const{doc:c,tr:d,schema:p}=l,m=e.getState(l),g=c.content.size,b=p.nodes[n];if(m)return d.insert(g,b.create())},state:{init:(s,a)=>{const l=a.tr.doc.lastChild;return!CC({node:l,types:r})},apply:(s,a)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return a;const l=s.doc.lastChild;return!CC({node:l,types:r})}}})]}}),J7=vt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>DA(t,e),redo:()=>({state:t,dispatch:e})=>LA(t,e)}},addProseMirrorPlugins(){return[V7(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),X7=vt.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(CP.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(bP.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(bA.configure(this.options.bulletList)),this.options.code!==!1&&s.push(NP.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(MP.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(OP.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(q7.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(W7.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(jP.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(_P.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(J7.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(RP.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(BP.configure(this.options.italic)),this.options.listItem!==!1&&s.push(yA.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(EA.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(c7.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(TA.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(w7.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(S7.configure(this.options.strike)),this.options.text!==!1&&s.push(E7.configure(this.options.text)),this.options.underline!==!1&&s.push(OA.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(Y7.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),Q7=X7,Z7=MA,e9=AA,t9=G7,n9=20,IA=(t,e=0)=>{const n=[];return!t.children.length||e>n9||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...IA(r,e+1))}),n},r9=t=>{if(!t.children.length)return;const e=IA(t);e&&e.forEach(n=>{var r,s;const a=n.getAttribute("style"),l=(s=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");n.setAttribute("style",`${l};${a}`)})},zA=na.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&r9(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",_t(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(a=>!!a))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),s9=vt.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const a=r[s].split(":");if(a.length>=2){const l=a[0].trim().toLowerCase(),c=a.slice(1).join(":").trim();if(l==="background-color")return c.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),BA=vt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const a=r[s].split(":");if(a.length>=2){const l=a[0].trim().toLowerCase(),c=a.slice(1).join(":").trim();if(l==="color")return c.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),i9=vt.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),a9=vt.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),o9=vt.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});vt.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(s9.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(BA.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(i9.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(a9.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(o9.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(zA.configure(this.options.textStyle)),t}});var l9=BA;let Lx,Ix;if(typeof WeakMap<"u"){let t=new WeakMap;Lx=e=>t.get(e),Ix=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Lx=r=>{for(let s=0;s<t.length;s+=2)if(t[s]==r)return t[s+1]},Ix=(r,s)=>(n==10&&(n=0),t[n++]=r,t[n++]=s)}var qt=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,s=e/this.width|0;let a=r+1,l=s+1;for(let c=1;a<this.width&&this.map[e+c]==n;c++)a++;for(let c=1;l<this.height&&this.map[e+this.width*c]==n;c++)l++;return{left:r,top:s,right:a,bottom:l}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:s,top:a,bottom:l}=this.findCell(t);return e=="horiz"?(n<0?r==0:s==this.width)?null:this.map[a*this.width+(n<0?r-1:s)]:(n<0?a==0:l==this.height)?null:this.map[r+this.width*(n<0?a-1:l)]}rectBetween(t,e){const{left:n,right:r,top:s,bottom:a}=this.findCell(t),{left:l,right:c,top:d,bottom:p}=this.findCell(e);return{left:Math.min(n,l),top:Math.min(s,d),right:Math.max(r,c),bottom:Math.max(a,p)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let s=t.left;s<t.right;s++){const a=r*this.width+s,l=this.map[a];n[l]||(n[l]=!0,!(s==t.left&&s&&this.map[a-1]==l||r==t.top&&r&&this.map[a-this.width]==l)&&e.push(l))}return e}positionAt(t,e,n){for(let r=0,s=0;;r++){const a=s+n.child(r).nodeSize;if(r==t){let l=e+t*this.width;const c=(t+1)*this.width;for(;l<c&&this.map[l]<s;)l++;return l==c?a-1:this.map[l]}s=a}}static get(t){return Lx(t)||Ix(t,c9(t))}};function c9(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=u9(t),n=t.childCount,r=[];let s=0,a=null;const l=[];for(let p=0,m=e*n;p<m;p++)r[p]=0;for(let p=0,m=0;p<n;p++){const g=t.child(p);m++;for(let w=0;;w++){for(;s<r.length&&r[s]!=0;)s++;if(w==g.childCount)break;const C=g.child(w),{colspan:k,rowspan:N,colwidth:M}=C.attrs;for(let _=0;_<N;_++){if(_+p>=n){(a||(a=[])).push({type:"overlong_rowspan",pos:m,n:N-_});break}const P=s+_*e;for(let z=0;z<k;z++){r[P+z]==0?r[P+z]=m:(a||(a=[])).push({type:"collision",row:p,pos:m,n:k-z});const K=M&&M[z];if(K){const O=(P+z)%e*2,F=l[O];F==null||F!=K&&l[O+1]==1?(l[O]=K,l[O+1]=1):F==K&&l[O+1]++}}}s+=k,m+=C.nodeSize}const b=(p+1)*e;let v=0;for(;s<b;)r[s++]==0&&v++;v&&(a||(a=[])).push({type:"missing",row:p,n:v}),m++}(e===0||n===0)&&(a||(a=[])).push({type:"zero_sized"});const c=new qt(e,n,r,a);let d=!1;for(let p=0;!d&&p<l.length;p+=2)l[p]!=null&&l[p+1]<n&&(d=!0);return d&&d9(c,l,t),c}function u9(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const s=t.child(r);let a=0;if(n)for(let l=0;l<r;l++){const c=t.child(l);for(let d=0;d<c.childCount;d++){const p=c.child(d);l+p.attrs.rowspan>r&&(a+=p.attrs.colspan)}}for(let l=0;l<s.childCount;l++){const c=s.child(l);a+=c.attrs.colspan,c.attrs.rowspan>1&&(n=!0)}e==-1?e=a:e!=a&&(e=Math.max(e,a))}return e}function d9(t,e,n){t.problems||(t.problems=[]);const r={};for(let s=0;s<t.map.length;s++){const a=t.map[s];if(r[a])continue;r[a]=!0;const l=n.nodeAt(a);if(!l)throw new RangeError(`No cell with offset ${a} found`);let c=null;const d=l.attrs;for(let p=0;p<d.colspan;p++){const m=e[(s+p)%t.width*2];m!=null&&(!d.colwidth||d.colwidth[p]!=m)&&((c||(c=f9(d)))[p]=m)}c&&t.problems.unshift({type:"colwidth mismatch",pos:a,colwidth:c})}}function f9(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function zn(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],s=r.spec.tableRole;s&&(e[s]=r)}}return e}const Pi=new Wt("selectingCells");function Qa(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function h9(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function Wr(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function fp(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=Qa(e.$head)||p9(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function p9(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function zx(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function m9(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function ny(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function PA(t,e,n){const r=t.node(-1),s=qt.get(r),a=t.start(-1),l=s.nextCell(t.pos-a,e,n);return l==null?null:t.node(0).resolve(a+l)}function Za(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function HA(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<n;s++)r.colwidth.splice(e,0,0)}return r}function g9(t,e,n){const r=zn(e.type.schema).header_cell;for(let s=0;s<t.height;s++)if(e.nodeAt(t.map[n+s*t.width]).type!=r)return!1;return!0}var Tt=class Bs extends $e{constructor(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.rectBetween(e.pos-a,n.pos-a),c=e.node(0),d=s.cellsInRect(l).filter(m=>m!=n.pos-a);d.unshift(n.pos-a);const p=d.map(m=>{const g=r.nodeAt(m);if(!g)throw new RangeError(`No cell with offset ${m} found`);const b=a+m+1;return new TN(c.resolve(b),c.resolve(b+g.content.size))});super(p[0].$from,p[0].$to,p),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),s=e.resolve(n.map(this.$headCell.pos));if(zx(r)&&zx(s)&&ny(r,s)){const a=this.$anchorCell.node(-1)!=r.node(-1);return a&&this.isRowSelection()?Bs.rowSelection(r,s):a&&this.isColSelection()?Bs.colSelection(r,s):new Bs(r,s)}return Be.between(r,s)}content(){const e=this.$anchorCell.node(-1),n=qt.get(e),r=this.$anchorCell.start(-1),s=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),a={},l=[];for(let d=s.top;d<s.bottom;d++){const p=[];for(let m=d*n.width+s.left,g=s.left;g<s.right;g++,m++){const b=n.map[m];if(a[b])continue;a[b]=!0;const v=n.findCell(b);let w=e.nodeAt(b);if(!w)throw new RangeError(`No cell with offset ${b} found`);const C=s.left-v.left,k=v.right-s.right;if(C>0||k>0){let N=w.attrs;if(C>0&&(N=Za(N,0,C)),k>0&&(N=Za(N,N.colspan-k,k)),v.left<s.left){if(w=w.type.createAndFill(N),!w)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(N)}`)}else w=w.type.create(N,w.content)}if(v.top<s.top||v.bottom>s.bottom){const N={...w.attrs,rowspan:Math.min(v.bottom,s.bottom)-Math.max(v.top,s.top)};v.top<s.top?w=w.type.createAndFill(N):w=w.type.create(N,w.content)}p.push(w)}l.push(e.child(d).copy(fe.from(p)))}const c=this.isColSelection()&&this.isRowSelection()?e:l;return new Ne(fe.from(c),1,1)}replace(e,n=Ne.empty){const r=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){const{$from:c,$to:d}=s[l],p=e.mapping.slice(r);e.replace(p.map(c.pos),p.map(d.pos),l?Ne.empty:n)}const a=$e.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);a&&e.setSelection(a)}replaceWith(e,n){this.replace(e,new Ne(fe.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=qt.get(n),s=this.$anchorCell.start(-1),a=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let l=0;l<a.length;l++)e(n.nodeAt(a[l]),s+a[l])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,s=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.findCell(e.pos-a),c=s.findCell(n.pos-a),d=e.node(0);return l.top<=c.top?(l.top>0&&(e=d.resolve(a+s.map[l.left])),c.bottom<s.height&&(n=d.resolve(a+s.map[s.width*(s.height-1)+c.right-1]))):(c.top>0&&(n=d.resolve(a+s.map[c.left])),l.bottom<s.height&&(e=d.resolve(a+s.map[s.width*(s.height-1)+l.right-1]))),new Bs(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=qt.get(e),r=this.$anchorCell.start(-1),s=n.colCount(this.$anchorCell.pos-r),a=n.colCount(this.$headCell.pos-r);if(Math.min(s,a)>0)return!1;const l=s+this.$anchorCell.nodeAfter.attrs.colspan,c=a+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,c)==n.width}eq(e){return e instanceof Bs&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.findCell(e.pos-a),c=s.findCell(n.pos-a),d=e.node(0);return l.left<=c.left?(l.left>0&&(e=d.resolve(a+s.map[l.top*s.width])),c.right<s.width&&(n=d.resolve(a+s.map[s.width*(c.top+1)-1]))):(c.left>0&&(n=d.resolve(a+s.map[c.top*s.width])),l.right<s.width&&(e=d.resolve(a+s.map[s.width*(l.top+1)-1]))),new Bs(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Bs(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Bs(e.resolve(n),e.resolve(r))}getBookmark(){return new x9(this.$anchorCell.pos,this.$headCell.pos)}};Tt.prototype.visible=!1;$e.jsonID("cell",Tt);var x9=class FA{constructor(e,n){this.anchor=e,this.head=n}map(e){return new FA(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&ny(n,r)?new Tt(n,r):$e.near(r,1)}};function b9(t){if(!(t.selection instanceof Tt))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(yn.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Nt.create(t.doc,e)}function y9({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,s=t.depth;for(;s>=0&&!(t.after(s+1)<t.end(s));s--,n++);for(let a=e.depth;a>=0&&!(e.before(a+1)>e.start(a));a--,r--);return n==r&&/row|table/.test(t.node(s).type.spec.tableRole)}function v9({$from:t,$to:e}){let n,r;for(let s=t.depth;s>0;s--){const a=t.node(s);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){n=a;break}}for(let s=e.depth;s>0;s--){const a=e.node(s);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){r=a;break}}return n!==r&&e.parentOffset===0}function w9(t,e,n){const r=(e||t).selection,s=(e||t).doc;let a,l;if(r instanceof ze&&(l=r.node.type.spec.tableRole)){if(l=="cell"||l=="header_cell")a=Tt.create(s,r.from);else if(l=="row"){const c=s.resolve(r.from+1);a=Tt.rowSelection(c,c)}else if(!n){const c=qt.get(r.node),d=r.from+1,p=d+c.map[c.width*c.height-1];a=Tt.create(s,d+1,p)}}else r instanceof Be&&y9(r)?a=Be.create(s,r.from):r instanceof Be&&v9(r)&&(a=Be.create(s,r.$from.start(),r.$from.end()));return a&&(e||(e=t.tr)).setSelection(a),e}const k9=new Wt("fix-tables");function UA(t,e,n,r){const s=t.childCount,a=e.childCount;e:for(let l=0,c=0;l<a;l++){const d=e.child(l);for(let p=c,m=Math.min(s,l+3);p<m;p++)if(t.child(p)==d){c=p+1,n+=d.nodeSize;continue e}r(d,n),c<s&&t.child(c).sameMarkup(d)?UA(t.child(c),d,n+1,r):d.nodesBetween(0,d.content.size,r,n+1),n+=d.nodeSize}}function $A(t,e){let n;const r=(s,a)=>{s.type.spec.tableRole=="table"&&(n=C9(t,s,a,n))};return e?e.doc!=t.doc&&UA(e.doc,t.doc,0,r):t.doc.descendants(r),n}function C9(t,e,n,r){const s=qt.get(e);if(!s.problems)return r;r||(r=t.tr);const a=[];for(let d=0;d<s.height;d++)a.push(0);for(let d=0;d<s.problems.length;d++){const p=s.problems[d];if(p.type=="collision"){const m=e.nodeAt(p.pos);if(!m)continue;const g=m.attrs;for(let b=0;b<g.rowspan;b++)a[p.row+b]+=p.n;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,Za(g,g.colspan-p.n,p.n))}else if(p.type=="missing")a[p.row]+=p.n;else if(p.type=="overlong_rowspan"){const m=e.nodeAt(p.pos);if(!m)continue;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,{...m.attrs,rowspan:m.attrs.rowspan-p.n})}else if(p.type=="colwidth mismatch"){const m=e.nodeAt(p.pos);if(!m)continue;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,{...m.attrs,colwidth:p.colwidth})}else if(p.type=="zero_sized"){const m=r.mapping.map(n);r.delete(m,m+e.nodeSize)}}let l,c;for(let d=0;d<a.length;d++)a[d]&&(l==null&&(l=d),c=d);for(let d=0,p=n+1;d<s.height;d++){const m=e.child(d),g=p+m.nodeSize,b=a[d];if(b>0){let v="cell";m.firstChild&&(v=m.firstChild.type.spec.tableRole);const w=[];for(let k=0;k<b;k++){const N=zn(t.schema)[v].createAndFill();N&&w.push(N)}const C=(d==0||l==d-1)&&c==d?p+1:g-1;r.insert(r.mapping.map(C),w)}p=g}return r.setMeta(k9,{fixTables:!0})}function ps(t){const e=t.selection,n=fp(t),r=n.node(-1),s=n.start(-1),a=qt.get(r);return{...e instanceof Tt?a.rectBetween(e.$anchorCell.pos-s,e.$headCell.pos-s):a.findCell(n.pos-s),tableStart:s,map:a,table:r}}function VA(t,{map:e,tableStart:n,table:r},s){let a=s>0?-1:0;g9(e,r,s+a)&&(a=s==0||s==e.width?null:0);for(let l=0;l<e.height;l++){const c=l*e.width+s;if(s>0&&s<e.width&&e.map[c-1]==e.map[c]){const d=e.map[c],p=r.nodeAt(d);t.setNodeMarkup(t.mapping.map(n+d),null,HA(p.attrs,s-e.colCount(d))),l+=p.attrs.rowspan-1}else{const d=a==null?zn(r.type.schema).cell:r.nodeAt(e.map[c+a]).type,p=e.positionAt(l,s,r);t.insert(t.mapping.map(n+p),d.createAndFill())}}return t}function S9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t);e(VA(t.tr,n,n.left))}return!0}function E9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t);e(VA(t.tr,n,n.right))}return!0}function N9(t,{map:e,table:n,tableStart:r},s){const a=t.mapping.maps.length;for(let l=0;l<e.height;){const c=l*e.width+s,d=e.map[c],p=n.nodeAt(d),m=p.attrs;if(s>0&&e.map[c-1]==d||s<e.width-1&&e.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(a).map(r+d),null,Za(m,s-e.colCount(d)));else{const g=t.mapping.slice(a).map(r+d);t.delete(g,g+p.nodeSize)}l+=m.rowspan}}function T9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let s=n.right-1;N9(r,n,s),s!=n.left;s--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=qt.get(a)}e(r)}return!0}function A9(t,e,n){var r;const s=zn(e.type.schema).header_cell;for(let a=0;a<t.width;a++)if(((r=e.nodeAt(t.map[a+n*t.width]))===null||r===void 0?void 0:r.type)!=s)return!1;return!0}function qA(t,{map:e,tableStart:n,table:r},s){let a=n;for(let p=0;p<s;p++)a+=r.child(p).nodeSize;const l=[];let c=s>0?-1:0;A9(e,r,s+c)&&(c=s==0||s==e.height?null:0);for(let p=0,m=e.width*s;p<e.width;p++,m++)if(s>0&&s<e.height&&e.map[m]==e.map[m-e.width]){const g=e.map[m],b=r.nodeAt(g).attrs;t.setNodeMarkup(n+g,null,{...b,rowspan:b.rowspan+1}),p+=b.colspan-1}else{var d;const g=c==null?zn(r.type.schema).cell:(d=r.nodeAt(e.map[m+c*e.width]))===null||d===void 0?void 0:d.type,b=g==null?void 0:g.createAndFill();b&&l.push(b)}return t.insert(a,zn(r.type.schema).row.create(null,l)),t}function M9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t);e(qA(t.tr,n,n.top))}return!0}function O9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t);e(qA(t.tr,n,n.bottom))}return!0}function j9(t,{map:e,table:n,tableStart:r},s){let a=0;for(let p=0;p<s;p++)a+=n.child(p).nodeSize;const l=a+n.child(s).nodeSize,c=t.mapping.maps.length;t.delete(a+r,l+r);const d=new Set;for(let p=0,m=s*e.width;p<e.width;p++,m++){const g=e.map[m];if(!d.has(g)){if(d.add(g),s>0&&g==e.map[m-e.width]){const b=n.nodeAt(g).attrs;t.setNodeMarkup(t.mapping.slice(c).map(g+r),null,{...b,rowspan:b.rowspan-1}),p+=b.colspan-1}else if(s<e.height&&g==e.map[m+e.width]){const b=n.nodeAt(g),v=b.attrs,w=b.type.create({...v,rowspan:b.attrs.rowspan-1},b.content),C=e.positionAt(s+1,p,n);t.insert(t.mapping.slice(c).map(r+C),w),p+=v.colspan-1}}}}function _9(t,e){if(!Wr(t))return!1;if(e){const n=ps(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let s=n.bottom-1;j9(r,n,s),s!=n.top;s--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=qt.get(n.table)}e(r)}return!0}function SC(t){const e=t.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function R9({width:t,height:e,map:n},r){let s=r.top*t+r.left,a=s,l=(r.bottom-1)*t+r.left,c=s+(r.right-r.left-1);for(let d=r.top;d<r.bottom;d++){if(r.left>0&&n[a]==n[a-1]||r.right<t&&n[c]==n[c+1])return!0;a+=t,c+=t}for(let d=r.left;d<r.right;d++){if(r.top>0&&n[s]==n[s-t]||r.bottom<e&&n[l]==n[l+t])return!0;s++,l++}return!1}function EC(t,e){const n=t.selection;if(!(n instanceof Tt)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=ps(t),{map:s}=r;if(R9(s,r))return!1;if(e){const a=t.tr,l={};let c=fe.empty,d,p;for(let m=r.top;m<r.bottom;m++)for(let g=r.left;g<r.right;g++){const b=s.map[m*s.width+g],v=r.table.nodeAt(b);if(!(l[b]||!v))if(l[b]=!0,d==null)d=b,p=v;else{SC(v)||(c=c.append(v.content));const w=a.mapping.map(b+r.tableStart);a.delete(w,w+v.nodeSize)}}if(d==null||p==null)return!0;if(a.setNodeMarkup(d+r.tableStart,null,{...HA(p.attrs,p.attrs.colspan,r.right-r.left-p.attrs.colspan),rowspan:r.bottom-r.top}),c.size>0){const m=d+1+p.content.size,g=SC(p)?d+1:m;a.replaceWith(g+r.tableStart,m+r.tableStart,c)}a.setSelection(new Tt(a.doc.resolve(d+r.tableStart))),e(a)}return!0}function NC(t,e){const n=zn(t.schema);return D9(({node:r})=>n[r.type.spec.tableRole])(t,e)}function D9(t){return(e,n)=>{const r=e.selection;let s,a;if(r instanceof Tt){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;s=r.$anchorCell.nodeAfter,a=r.$anchorCell.pos}else{var l;if(s=h9(r.$from),!s)return!1;a=(l=Qa(r.$from))===null||l===void 0?void 0:l.pos}if(s==null||a==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(n){let c=s.attrs;const d=[],p=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const m=ps(e),g=e.tr;for(let v=0;v<m.right-m.left;v++)d.push(p?{...c,colwidth:p&&p[v]?[p[v]]:null}:c);let b;for(let v=m.top;v<m.bottom;v++){let w=m.map.positionAt(v,m.left,m.table);v==m.top&&(w+=s.nodeSize);for(let C=m.left,k=0;C<m.right;C++,k++)C==m.left&&v==m.top||g.insert(b=g.mapping.map(w+m.tableStart,1),t({node:s,row:v,col:C}).createAndFill(d[k]))}g.setNodeMarkup(a,t({node:s,row:m.top,col:m.left}),d[0]),r instanceof Tt&&g.setSelection(new Tt(g.doc.resolve(r.$anchorCell.pos),b?g.doc.resolve(b):void 0)),n(g)}return!0}}function L9(t,e){return function(n,r){if(!Wr(n))return!1;const s=fp(n);if(s.nodeAfter.attrs[t]===e)return!1;if(r){const a=n.tr;n.selection instanceof Tt?n.selection.forEachCell((l,c)=>{l.attrs[t]!==e&&a.setNodeMarkup(c,null,{...l.attrs,[t]:e})}):a.setNodeMarkup(s.pos,null,{...s.nodeAfter.attrs,[t]:e}),r(a)}return!0}}function I9(t){return function(e,n){if(!Wr(e))return!1;if(n){const r=zn(e.schema),s=ps(e),a=e.tr,l=s.map.cellsInRect(t=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:t=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),c=l.map(d=>s.table.nodeAt(d));for(let d=0;d<l.length;d++)c[d].type==r.header_cell&&a.setNodeMarkup(s.tableStart+l[d],r.cell,c[d].attrs);if(a.steps.length===0)for(let d=0;d<l.length;d++)a.setNodeMarkup(s.tableStart+l[d],r.header_cell,c[d].attrs);n(a)}return!0}}function TC(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let s=0;s<r.length;s++){const a=e.table.nodeAt(r[s]);if(a&&a.type!==n.header_cell)return!1}return!0}function uu(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?I9(t):function(n,r){if(!Wr(n))return!1;if(r){const s=zn(n.schema),a=ps(n),l=n.tr,c=TC("row",a,s),d=TC("column",a,s),p=(t==="column"?c:t==="row"&&d)?1:0,m=t=="column"?{left:0,top:p,right:1,bottom:a.map.height}:t=="row"?{left:p,top:0,right:a.map.width,bottom:1}:a,g=t=="column"?d?s.cell:s.header_cell:t=="row"?c?s.cell:s.header_cell:s.cell;a.map.cellsInRect(m).forEach(b=>{const v=b+a.tableStart,w=l.doc.nodeAt(v);w&&l.setNodeMarkup(v,g,w.attrs)}),r(l)}return!0}}uu("row",{useDeprecatedLogic:!0});uu("column",{useDeprecatedLogic:!0});const z9=uu("cell",{useDeprecatedLogic:!0});function B9(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,s=t.before();r>=0;r--){const a=t.node(-1).child(r),l=a.lastChild;if(l)return s-1-l.nodeSize;s-=a.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),s=t.after();r<n.childCount;r++){const a=n.child(r);if(a.childCount)return s+1;s+=a.nodeSize}}return null}function AC(t){return function(e,n){if(!Wr(e))return!1;const r=B9(fp(e),t);if(r==null)return!1;if(n){const s=e.doc.resolve(r);n(e.tr.setSelection(Be.between(s,m9(s))).scrollIntoView())}return!0}}function P9(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function sf(t,e){const n=t.selection;if(!(n instanceof Tt))return!1;if(e){const r=t.tr,s=zn(t.schema).cell.createAndFill().content;n.forEachCell((a,l)=>{a.content.eq(s)||r.replace(r.mapping.map(l+1),r.mapping.map(l+a.nodeSize-1),new Ne(s,0,0))}),r.docChanged&&e(r)}return!0}function H9(t){if(t.size===0)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const s=e.child(0),a=s.type.spec.tableRole,l=s.type.schema,c=[];if(a=="row")for(let d=0;d<e.childCount;d++){let p=e.child(d).content;const m=d?0:Math.max(0,n-1),g=d<e.childCount-1?0:Math.max(0,r-1);(m||g)&&(p=Bx(zn(l).row,new Ne(p,m,g)).content),c.push(p)}else if(a=="cell"||a=="header_cell")c.push(n||r?Bx(zn(l).row,new Ne(e,n,r)).content:e);else return null;return F9(l,c)}function F9(t,e){const n=[];for(let s=0;s<e.length;s++){const a=e[s];for(let l=a.childCount-1;l>=0;l--){const{rowspan:c,colspan:d}=a.child(l).attrs;for(let p=s;p<s+c;p++)n[p]=(n[p]||0)+d}}let r=0;for(let s=0;s<n.length;s++)r=Math.max(r,n[s]);for(let s=0;s<n.length;s++)if(s>=e.length&&e.push(fe.empty),n[s]<r){const a=zn(t).cell.createAndFill(),l=[];for(let c=n[s];c<r;c++)l.push(a);e[s]=e[s].append(fe.from(l))}return{height:e.length,width:r,rows:e}}function Bx(t,e){const n=t.createAndFill();return new xb(n).replace(0,n.content.size,e).doc}function U9({width:t,height:e,rows:n},r,s){if(t!=r){const a=[],l=[];for(let c=0;c<n.length;c++){const d=n[c],p=[];for(let m=a[c]||0,g=0;m<r;g++){let b=d.child(g%d.childCount);m+b.attrs.colspan>r&&(b=b.type.createChecked(Za(b.attrs,b.attrs.colspan,m+b.attrs.colspan-r),b.content)),p.push(b),m+=b.attrs.colspan;for(let v=1;v<b.attrs.rowspan;v++)a[c+v]=(a[c+v]||0)+b.attrs.colspan}l.push(fe.from(p))}n=l,t=r}if(e!=s){const a=[];for(let l=0,c=0;l<s;l++,c++){const d=[],p=n[c%e];for(let m=0;m<p.childCount;m++){let g=p.child(m);l+g.attrs.rowspan>s&&(g=g.type.create({...g.attrs,rowspan:Math.max(1,s-g.attrs.rowspan)},g.content)),d.push(g)}a.push(fe.from(d))}n=a,e=s}return{width:t,height:e,rows:n}}function $9(t,e,n,r,s,a,l){const c=t.doc.type.schema,d=zn(c);let p,m;if(s>e.width)for(let g=0,b=0;g<e.height;g++){const v=n.child(g);b+=v.nodeSize;const w=[];let C;v.lastChild==null||v.lastChild.type==d.cell?C=p||(p=d.cell.createAndFill()):C=m||(m=d.header_cell.createAndFill());for(let k=e.width;k<s;k++)w.push(C);t.insert(t.mapping.slice(l).map(b-1+r),w)}if(a>e.height){const g=[];for(let w=0,C=(e.height-1)*e.width;w<Math.max(e.width,s);w++){const k=w>=e.width?!1:n.nodeAt(e.map[C+w]).type==d.header_cell;g.push(k?m||(m=d.header_cell.createAndFill()):p||(p=d.cell.createAndFill()))}const b=d.row.create(null,fe.from(g)),v=[];for(let w=e.height;w<a;w++)v.push(b);t.insert(t.mapping.slice(l).map(r+n.nodeSize-2),v)}return!!(p||m)}function MC(t,e,n,r,s,a,l,c){if(l==0||l==e.height)return!1;let d=!1;for(let p=s;p<a;p++){const m=l*e.width+p,g=e.map[m];if(e.map[m-e.width]==g){d=!0;const b=n.nodeAt(g),{top:v,left:w}=e.findCell(g);t.setNodeMarkup(t.mapping.slice(c).map(g+r),null,{...b.attrs,rowspan:l-v}),t.insert(t.mapping.slice(c).map(e.positionAt(l,w,n)),b.type.createAndFill({...b.attrs,rowspan:v+b.attrs.rowspan-l})),p+=b.attrs.colspan-1}}return d}function OC(t,e,n,r,s,a,l,c){if(l==0||l==e.width)return!1;let d=!1;for(let p=s;p<a;p++){const m=p*e.width+l,g=e.map[m];if(e.map[m-1]==g){d=!0;const b=n.nodeAt(g),v=e.colCount(g),w=t.mapping.slice(c).map(g+r);t.setNodeMarkup(w,null,Za(b.attrs,l-v,b.attrs.colspan-(l-v))),t.insert(w+b.nodeSize,b.type.createAndFill(Za(b.attrs,0,l-v))),p+=b.attrs.rowspan-1}}return d}function jC(t,e,n,r,s){let a=n?t.doc.nodeAt(n-1):t.doc;if(!a)throw new Error("No table found");let l=qt.get(a);const{top:c,left:d}=r,p=d+s.width,m=c+s.height,g=t.tr;let b=0;function v(){if(a=n?g.doc.nodeAt(n-1):g.doc,!a)throw new Error("No table found");l=qt.get(a),b=g.mapping.maps.length}$9(g,l,a,n,p,m,b)&&v(),MC(g,l,a,n,d,p,c,b)&&v(),MC(g,l,a,n,d,p,m,b)&&v(),OC(g,l,a,n,c,m,d,b)&&v(),OC(g,l,a,n,c,m,p,b)&&v();for(let w=c;w<m;w++){const C=l.positionAt(w,d,a),k=l.positionAt(w,p,a);g.replace(g.mapping.slice(b).map(C+n),g.mapping.slice(b).map(k+n),new Ne(s.rows[w-c],0,0))}v(),g.setSelection(new Tt(g.doc.resolve(n+l.positionAt(c,d,a)),g.doc.resolve(n+l.positionAt(m-1,p-1,a)))),e(g)}const V9=Rb({ArrowLeft:af("horiz",-1),ArrowRight:af("horiz",1),ArrowUp:af("vert",-1),ArrowDown:af("vert",1),"Shift-ArrowLeft":of("horiz",-1),"Shift-ArrowRight":of("horiz",1),"Shift-ArrowUp":of("vert",-1),"Shift-ArrowDown":of("vert",1),Backspace:sf,"Mod-Backspace":sf,Delete:sf,"Mod-Delete":sf});function wf(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function af(t,e){return(n,r,s)=>{if(!s)return!1;const a=n.selection;if(a instanceof Tt)return wf(n,r,$e.near(a.$headCell,e));if(t!="horiz"&&!a.empty)return!1;const l=WA(s,t,e);if(l==null)return!1;if(t=="horiz")return wf(n,r,$e.near(n.doc.resolve(a.head+e),e));{const c=n.doc.resolve(l),d=PA(c,t,e);let p;return d?p=$e.near(d,1):e<0?p=$e.near(n.doc.resolve(c.before(-1)),-1):p=$e.near(n.doc.resolve(c.after(-1)),1),wf(n,r,p)}}}function of(t,e){return(n,r,s)=>{if(!s)return!1;const a=n.selection;let l;if(a instanceof Tt)l=a;else{const d=WA(s,t,e);if(d==null)return!1;l=new Tt(n.doc.resolve(d))}const c=PA(l.$headCell,t,e);return c?wf(n,r,new Tt(l.$anchorCell,c)):!1}}function q9(t,e){const n=t.state.doc,r=Qa(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new Tt(r))),!0):!1}function W9(t,e,n){if(!Wr(t.state))return!1;let r=H9(n);const s=t.state.selection;if(s instanceof Tt){r||(r={width:1,height:1,rows:[fe.from(Bx(zn(t.state.schema).cell,n))]});const a=s.$anchorCell.node(-1),l=s.$anchorCell.start(-1),c=qt.get(a).rectBetween(s.$anchorCell.pos-l,s.$headCell.pos-l);return r=U9(r,c.right-c.left,c.bottom-c.top),jC(t.state,t.dispatch,l,c,r),!0}else if(r){const a=fp(t.state),l=a.start(-1);return jC(t.state,t.dispatch,l,qt.get(a.node(-1)).findCell(a.pos-l),r),!0}else return!1}function K9(t,e){var n;if(e.button!=0||e.ctrlKey||e.metaKey)return;const r=_C(t,e.target);let s;if(e.shiftKey&&t.state.selection instanceof Tt)a(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(s=Qa(t.state.selection.$anchor))!=null&&((n=g0(t,e))===null||n===void 0?void 0:n.pos)!=s.pos)a(s,e),e.preventDefault();else if(!r)return;function a(d,p){let m=g0(t,p);const g=Pi.getState(t.state)==null;if(!m||!ny(d,m))if(g)m=d;else return;const b=new Tt(d,m);if(g||!t.state.selection.eq(b)){const v=t.state.tr.setSelection(b);g&&v.setMeta(Pi,d.pos),t.dispatch(v)}}function l(){t.root.removeEventListener("mouseup",l),t.root.removeEventListener("dragstart",l),t.root.removeEventListener("mousemove",c),Pi.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Pi,-1))}function c(d){const p=d,m=Pi.getState(t.state);let g;if(m!=null)g=t.state.doc.resolve(m);else if(_C(t,p.target)!=r&&(g=g0(t,e),!g))return l();g&&a(g,p)}t.root.addEventListener("mouseup",l),t.root.addEventListener("dragstart",l),t.root.addEventListener("mousemove",c)}function WA(t,e,n){if(!(t.state.selection instanceof Be))return null;const{$head:r}=t.state.selection;for(let s=r.depth-1;s>=0;s--){const a=r.node(s);if((n<0?r.index(s):r.indexAfter(s))!=(n<0?0:a.childCount))return null;if(a.type.spec.tableRole=="cell"||a.type.spec.tableRole=="header_cell"){const l=r.before(s),c=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(c)?l:null}}return null}function _C(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function g0(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});if(!n)return null;let{inside:r,pos:s}=n;return r>=0&&Qa(t.state.doc.resolve(r))||Qa(t.state.doc.resolve(s))}var G9=class{constructor(e,n){this.node=e,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Px(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Px(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Px(t,e,n,r,s,a){let l=0,c=!0,d=e.firstChild;const p=t.firstChild;if(p){for(let g=0,b=0;g<p.childCount;g++){const{colspan:v,colwidth:w}=p.child(g).attrs;for(let C=0;C<v;C++,b++){const k=s==b?a:w&&w[C],N=k?k+"px":"";if(l+=k||r,k||(c=!1),d)d.style.width!=N&&(d.style.width=N),d=d.nextSibling;else{const M=document.createElement("col");M.style.width=N,e.appendChild(M)}}}for(;d;){var m;const g=d.nextSibling;(m=d.parentNode)===null||m===void 0||m.removeChild(d),d=g}c?(n.style.width=l+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=l+"px")}}const xr=new Wt("tableColumnResizing");function Y9({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=G9,lastColumnResizable:s=!0}={}){const a=new Rt({key:xr,state:{init(l,c){var d;const p=(d=a.spec)===null||d===void 0||(d=d.props)===null||d===void 0?void 0:d.nodeViews,m=zn(c.schema).table.name;return r&&p&&(p[m]=(g,b)=>new r(g,n,b)),new J9(-1,!1)},apply(l,c){return c.apply(l)}},props:{attributes:l=>{const c=xr.getState(l);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(l,c)=>{X9(l,c,t,s)},mouseleave:l=>{Q9(l)},mousedown:(l,c)=>{Z9(l,c,e,n)}},decorations:l=>{const c=xr.getState(l);if(c&&c.activeHandle>-1)return sH(l,c.activeHandle)},nodeViews:{}}});return a}var J9=class kf{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(xr);if(r&&r.setHandle!=null)return new kf(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new kf(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let s=e.mapping.map(n.activeHandle,-1);return zx(e.doc.resolve(s))||(s=-1),new kf(s,n.dragging)}return n}};function X9(t,e,n,r){if(!t.editable)return;const s=xr.getState(t.state);if(s&&!s.dragging){const a=tH(e.target);let l=-1;if(a){const{left:c,right:d}=a.getBoundingClientRect();e.clientX-c<=n?l=RC(t,e,"left",n):d-e.clientX<=n&&(l=RC(t,e,"right",n))}if(l!=s.activeHandle){if(!r&&l!==-1){const c=t.state.doc.resolve(l),d=c.node(-1),p=qt.get(d),m=c.start(-1);if(p.colCount(c.pos-m)+c.nodeAfter.attrs.colspan-1==p.width-1)return}KA(t,l)}}}function Q9(t){if(!t.editable)return;const e=xr.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&KA(t,-1)}function Z9(t,e,n,r){var s;if(!t.editable)return!1;const a=(s=t.dom.ownerDocument.defaultView)!==null&&s!==void 0?s:window,l=xr.getState(t.state);if(!l||l.activeHandle==-1||l.dragging)return!1;const c=t.state.doc.nodeAt(l.activeHandle),d=eH(t,l.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(xr,{setDragging:{startX:e.clientX,startWidth:d}}));function p(g){a.removeEventListener("mouseup",p),a.removeEventListener("mousemove",m);const b=xr.getState(t.state);b!=null&&b.dragging&&(nH(t,b.activeHandle,DC(b.dragging,g,n)),t.dispatch(t.state.tr.setMeta(xr,{setDragging:null})))}function m(g){if(!g.which)return p(g);const b=xr.getState(t.state);if(b&&b.dragging){const v=DC(b.dragging,g,n);LC(t,b.activeHandle,v,r)}}return LC(t,l.activeHandle,d,r),a.addEventListener("mouseup",p),a.addEventListener("mousemove",m),e.preventDefault(),!0}function eH(t,e,{colspan:n,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const a=t.domAtPos(e);let l=a.node.childNodes[a.offset].offsetWidth,c=n;if(r)for(let d=0;d<n;d++)r[d]&&(l-=r[d],c--);return l/c}function tH(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function RC(t,e,n,r){const s=n=="right"?-r:r,a=t.posAtCoords({left:e.clientX+s,top:e.clientY});if(!a)return-1;const{pos:l}=a,c=Qa(t.state.doc.resolve(l));if(!c)return-1;if(n=="right")return c.pos;const d=qt.get(c.node(-1)),p=c.start(-1),m=d.map.indexOf(c.pos-p);return m%d.width==0?-1:p+d.map[m-1]}function DC(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function KA(t,e){t.dispatch(t.state.tr.setMeta(xr,{setHandle:e}))}function nH(t,e,n){const r=t.state.doc.resolve(e),s=r.node(-1),a=qt.get(s),l=r.start(-1),c=a.colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let p=0;p<a.height;p++){const m=p*a.width+c;if(p&&a.map[m]==a.map[m-a.width])continue;const g=a.map[m],b=s.nodeAt(g).attrs,v=b.colspan==1?0:c-a.colCount(g);if(b.colwidth&&b.colwidth[v]==n)continue;const w=b.colwidth?b.colwidth.slice():rH(b.colspan);w[v]=n,d.setNodeMarkup(l+g,null,{...b,colwidth:w})}d.docChanged&&t.dispatch(d)}function LC(t,e,n,r){const s=t.state.doc.resolve(e),a=s.node(-1),l=s.start(-1),c=qt.get(a).colCount(s.pos-l)+s.nodeAfter.attrs.colspan-1;let d=t.domAtPos(s.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&Px(a,d.firstChild,d,r,c,n)}function rH(t){return Array(t).fill(0)}function sH(t,e){const n=[],r=t.doc.resolve(e),s=r.node(-1);if(!s)return Nt.empty;const a=qt.get(s),l=r.start(-1),c=a.colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1;for(let p=0;p<a.height;p++){const m=c+p*a.width;if((c==a.width-1||a.map[m]!=a.map[m+1])&&(p==0||a.map[m]!=a.map[m-a.width])){var d;const g=a.map[m],b=l+g+s.nodeAt(g).nodeSize-1,v=document.createElement("div");v.className="column-resize-handle",!((d=xr.getState(t))===null||d===void 0)&&d.dragging&&n.push(yn.node(l+g,l+g+s.nodeAt(g).nodeSize,{class:"column-resize-dragging"})),n.push(yn.widget(b,v))}}return Nt.create(t.doc,n)}function iH({allowTableNodeSelection:t=!1}={}){return new Rt({key:Pi,state:{init(){return null},apply(e,n){const r=e.getMeta(Pi);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:s,pos:a}=e.mapping.mapResult(n);return s?null:a}},props:{decorations:b9,handleDOMEvents:{mousedown:K9},createSelectionBetween(e){return Pi.getState(e.state)!=null?e.state.selection:null},handleTripleClick:q9,handleKeyDown:V9,handlePaste:W9},appendTransaction(e,n,r){return w9(r,$A(r,n),t)}})}var GA=_n.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var e,n;const r=t.getAttribute("colwidth"),s=r?r.split(",").map(a=>parseInt(a,10)):null;if(!s){const a=(e=t.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),l=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(l&&l>-1&&a&&a[l]){const c=a[l].getAttribute("width");return c?[parseInt(c,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",_t(this.options.HTMLAttributes,t),0]}}),YA=_n.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",_t(this.options.HTMLAttributes,t),0]}}),JA=_n.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",_t(this.options.HTMLAttributes,t),0]}});function Hx(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function IC(t,e,n,r,s,a){var l;let c=0,d=!0,p=e.firstChild;const m=t.firstChild;if(m!==null)for(let b=0,v=0;b<m.childCount;b+=1){const{colspan:w,colwidth:C}=m.child(b).attrs;for(let k=0;k<w;k+=1,v+=1){const N=s===v?a:C&&C[k],M=N?`${N}px`:"";if(c+=N||r,N||(d=!1),p){if(p.style.width!==M){const[_,P]=Hx(r,N);p.style.setProperty(_,P)}p=p.nextSibling}else{const _=document.createElement("col"),[P,z]=Hx(r,N);_.style.setProperty(P,z),e.appendChild(_)}}}for(;p;){const b=p.nextSibling;(l=p.parentNode)==null||l.removeChild(p),p=b}const g=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!g?(n.style.width=`${c}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${c}px`)}var aH=class{constructor(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),IC(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,IC(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(n&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function oH(t,e,n,r){let s=0,a=!0;const l=[],c=t.firstChild;if(!c)return{};for(let g=0,b=0;g<c.childCount;g+=1){const{colspan:v,colwidth:w}=c.child(g).attrs;for(let C=0;C<v;C+=1,b+=1){const k=n===b?r:w&&w[C];s+=k||e,k||(a=!1);const[N,M]=Hx(e,k);l.push(["col",{style:`${N}: ${M}`}])}}const d=a?`${s}px`:"",p=a?"":`${s}px`;return{colgroup:["colgroup",{},...l],tableWidth:d,tableMinWidth:p}}function zC(t,e){return t.createAndFill()}function lH(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function cH(t,e,n,r,s){const a=lH(t),l=[],c=[];for(let p=0;p<n;p+=1){const m=zC(a.cell);if(m&&c.push(m),r){const g=zC(a.header_cell);g&&l.push(g)}}const d=[];for(let p=0;p<e;p+=1)d.push(a.row.createChecked(null,r&&p===0?l:c));return a.table.createChecked(null,d)}function uH(t){return t instanceof Tt}var lf=({editor:t})=>{const{selection:e}=t.state;if(!uH(e))return!1;let n=0;const r=jT(e.ranges[0].$from,a=>a.type.name==="table");return r==null||r.node.descendants(a=>{if(a.type.name==="table")return!1;["tableCell","tableHeader"].includes(a.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},dH="";function fH(t){return(t||"").replace(/\s+/g," ").trim()}function hH(t,e,n={}){var r;const s=(r=n.cellLineSeparator)!=null?r:dH;if(!t||!t.content||t.content.length===0)return"";const a=[];t.content.forEach(w=>{const C=[];w.content&&w.content.forEach(k=>{let N="";k.content&&Array.isArray(k.content)&&k.content.length>1?N=k.content.map(z=>e.renderChildren(z)).join(s):N=k.content?e.renderChildren(k.content):"";const M=fH(N),_=k.type==="tableHeader";C.push({text:M,isHeader:_})}),a.push(C)});const l=a.reduce((w,C)=>Math.max(w,C.length),0);if(l===0)return"";const c=new Array(l).fill(0);a.forEach(w=>{var C;for(let k=0;k<l;k+=1){const M=(((C=w[k])==null?void 0:C.text)||"").length;M>c[k]&&(c[k]=M),c[k]<3&&(c[k]=3)}});const d=(w,C)=>w+" ".repeat(Math.max(0,C-w.length)),p=a[0],m=p.some(w=>w.isHeader);let g=`
`;const b=new Array(l).fill(0).map((w,C)=>m&&p[C]&&p[C].text||"");return g+=`| ${b.map((w,C)=>d(w,c[C])).join(" | ")} |
`,g+=`| ${c.map(w=>"-".repeat(Math.max(3,w))).join(" | ")} |
`,(m?a.slice(1):a).forEach(w=>{g+=`| ${new Array(l).fill(0).map((C,k)=>d(w[k]&&w[k].text||"",c[k])).join(" | ")} |
`}),g}var pH=hH,XA=_n.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:aH,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=oH(t,this.options.cellMinWidth),a=e.style;function l(){return a||(r?`width: ${r}`:`min-width: ${s}`)}const c=["table",_t(this.options.HTMLAttributes,e,{style:l()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(s=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(s.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const s=[];r.forEach(a=>{s.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(a.tokens)}]))}),n.push(e.createNode("tableRow",{},s))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>pH(t,e),addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:a})=>{const l=cH(a.schema,t,e,n);if(s){const c=r.selection.from+1;r.replaceSelectionWith(l).scrollIntoView().setSelection(Be.near(r.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>S9(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>E9(t,e),deleteColumn:()=>({state:t,dispatch:e})=>T9(t,e),addRowBefore:()=>({state:t,dispatch:e})=>M9(t,e),addRowAfter:()=>({state:t,dispatch:e})=>O9(t,e),deleteRow:()=>({state:t,dispatch:e})=>_9(t,e),deleteTable:()=>({state:t,dispatch:e})=>P9(t,e),mergeCells:()=>({state:t,dispatch:e})=>EC(t,e),splitCell:()=>({state:t,dispatch:e})=>NC(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>uu("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>uu("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>z9(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>EC(t,e)?!0:NC(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>L9(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>AC(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>AC(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&$A(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=Tt.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:lf,"Mod-Backspace":lf,Delete:lf,"Mod-Delete":lf}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Y9({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],iH({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:ht(Le(t,"tableRole",e))}}});vt.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(XA.configure(this.options.table)),this.options.tableCell!==!1&&t.push(GA.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(YA.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(JA.configure(this.options.tableRow)),t}});var mH=JA,gH=YA,xH=GA;const bH=/<\/?[a-z][\s\S]*>/i,yH=t=>bH.test(t),BC=t=>t.trim()?yH(t)?t:hb(t):"<p></p>",vH=[Q7.configure({heading:{levels:[1,2]}}),N7,zA,l9,XA.configure({resizable:!0}),mH,gH,xH,Z7,e9.configure({nested:!0})],rr=({active:t=!1,onClick:e,title:n,children:r})=>h.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:e,className:`p-1 md:p-1.5 rounded transition-colors ${t?"bg-[#CC561E]/15 text-[#CC561E]":"text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-800"}`,title:n,children:r}),QA=({value:t,onChange:e,autoFocus:n=!1,placeholder:r="Start writing... Use toolbar for lists, checklist, headings, and emphasis.",minHeight:s=220})=>{const[a,l]=E.useState("write"),[c,d]=E.useState("#0f172a"),p=E.useRef(!1),m={"--note-editor-min-height":`${s}px`},g=hP({extensions:E.useMemo(()=>[...vH,t9.configure({placeholder:r})],[r]),content:BC(t),autofocus:n?"end":!1,editorProps:{attributes:{class:"personal-note-prosemirror"}},onUpdate:({editor:v})=>{p.current||e(v.getHTML())}});E.useEffect(()=>{if(!g)return;const v=BC(t);g.getHTML()!==v&&(p.current=!0,g.commands.setContent(v,{emitUpdate:!1}),p.current=!1)},[g,t]);const b=E.useMemo(()=>hb(t),[t]);return h.jsxs("div",{className:"rounded-xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-950 overflow-hidden",children:[h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:flex-wrap px-2 md:px-3 py-1.5 md:py-2 border-b border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900 gap-2 md:gap-3",children:[h.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap",children:[h.jsx(rr,{active:!!(g!=null&&g.isActive("heading",{level:1})),onClick:()=>g==null?void 0:g.chain().focus().toggleHeading({level:1}).run(),title:"Heading 1",children:h.jsx(e3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("heading",{level:2})),onClick:()=>g==null?void 0:g.chain().focus().toggleHeading({level:2}).run(),title:"Heading 2",children:h.jsx(n3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("bold")),onClick:()=>g==null?void 0:g.chain().focus().toggleBold().run(),title:"Bold",children:h.jsx(o4,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("italic")),onClick:()=>g==null?void 0:g.chain().focus().toggleItalic().run(),title:"Italic",children:h.jsx(o3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("underline")),onClick:()=>g==null?void 0:g.chain().focus().toggleUnderline().run(),title:"Underline",children:h.jsx(yR,{size:12,className:"md:w-3.5 md:h-3.5"})})]}),h.jsx("div",{className:"flex items-center justify-end md:justify-start gap-1",children:h.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 rounded-md border border-[#E6EAF2] dark:border-slate-700",children:[h.jsxs("button",{type:"button",onClick:()=>l("write"),className:`p-1 md:px-2 md:py-1 text-xs rounded-l-md transition-colors ${a==="write"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Write",children:[h.jsx("span",{className:"md:hidden",children:h.jsx(T2,{size:12})}),h.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[h.jsx(T2,{size:12})," Write"]})]}),h.jsxs("button",{type:"button",onClick:()=>l("preview"),className:`p-1 md:px-2 md:py-1 text-xs rounded-r-md transition-colors ${a==="preview"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Preview",children:[h.jsx("span",{className:"md:hidden",children:h.jsx(w2,{size:12})}),h.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[h.jsx(w2,{size:12})," Preview"]})]})]})}),h.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap md:flex-nowrap",children:[h.jsxs("div",{className:"inline-flex items-center gap-0.5 px-1 py-0.5 rounded border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-900",children:[h.jsx(M3,{size:11,className:"text-slate-500 md:w-3 md:h-3"}),h.jsx("input",{type:"color",value:c,onChange:v=>{const w=v.target.value;d(w),g==null||g.chain().focus().setColor(w).run()},className:"w-4 h-4 md:w-5 md:h-5 p-0 border-0 bg-transparent cursor-pointer",title:"Text Color"}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().unsetColor().run(),title:"Clear Text Color",children:h.jsx(I4,{size:10,className:"md:w-3 md:h-3"})})]}),h.jsx(rr,{active:!!(g!=null&&g.isActive("bulletList")),onClick:()=>g==null?void 0:g.chain().focus().toggleBulletList().run(),title:"Bullet List",children:h.jsx(x3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("orderedList")),onClick:()=>g==null?void 0:g.chain().focus().toggleOrderedList().run(),title:"Numbered List",children:h.jsx(m3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("taskList")),onClick:()=>g==null?void 0:g.chain().focus().toggleTaskList().run(),title:"Checklist",children:h.jsx(tR,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("blockquote")),onClick:()=>g==null?void 0:g.chain().focus().toggleBlockquote().run(),title:"Quote",children:h.jsx(Jc,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("table")),onClick:()=>g==null?void 0:g.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),title:"Insert Table",children:h.jsx(cR,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().addRowAfter().run(),title:"Add Row",children:h.jsx(H3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().addColumnAfter().run(),title:"Add Column",children:h.jsx(M4,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().deleteTable().run(),title:"Delete Table",children:h.jsx(Pa,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]}),a==="write"?h.jsx("div",{className:"bg-white dark:bg-slate-950 text-slate-900 dark:text-white",style:m,children:h.jsx(sA,{editor:g})}):h.jsx("div",{className:"personal-note-render p-3 md:p-4 max-w-none text-slate-800 dark:text-slate-200",style:{minHeight:s},dangerouslySetInnerHTML:{__html:b}})]})},wH=We.lazy(()=>Gc(()=>import("./KnowledgeDashboard-BDGa1m3S.js"),[]).then(t=>({default:t.KnowledgeDashboard}))),PC=t=>t.trim().toLowerCase(),Aa=10,qo=t=>t.toLocaleLowerCase("tr-TR").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"i").replace(/\s+/g," ").trim(),sr=(t,e)=>e?qo(t).includes(e):!0,HC=({id:t,children:e})=>{const{attributes:n,listeners:r,setNodeRef:s,transform:a,isDragging:l}=HD({id:t}),c={transform:il.Transform.toString(a)};return h.jsx(h.Fragment,{children:e({setNodeRef:s,style:c,isDragging:l,attributes:n,listeners:r})})},x0=({id:t,children:e})=>{const{setNodeRef:n,isOver:r}=VD({id:t});return h.jsx("div",{ref:n,children:e(r)})},kH=We.memo(({books:t,personalNoteFolders:e=[],onAddBook:n,onAddPersonalNote:r,onQuickCreatePersonalNote:s,onCreatePersonalFolder:a,onRenamePersonalFolder:l,onDeletePersonalFolder:c,onMovePersonalNote:d,onMovePersonalFolder:p,onSelectBook:m,onSelectBookWithTab:g,activeTab:b,onMobileMenuClick:v,onDeleteBook:w,onDeleteMultiple:C,onToggleFavorite:k,onToggleHighlightFavorite:N,userId:M,categoryFilter:_,onCategoryFilterChange:P,onCategoryNavigate:z,onStatusNavigate:K,currentPage:O,onPageChange:F,searchQuery:V,onSearchChange:Z,statusFilter:he,onStatusFilterChange:Te,sortOption:ve,onSortOptionChange:Se,publisherFilter:Ee,onPublisherFilterChange:q,onTabChange:te})=>{const[G,I]=E.useState(!1),H={"To Read":"bg-[#94A3B8]/15 text-[#94A3B8] border border-[#94A3B8]/40",Reading:"bg-[#38BDF8]/15 text-[#38BDF8] border border-[#38BDF8]/40",Finished:"bg-[#22C55E]/15 text-[#22C55E] border border-[#22C55E]/40"},A=b==="DASHBOARD",R=b==="NOTES",W=b==="PERSONAL_NOTE",[oe,xe]=E.useState("ALL"),[L,ae]=E.useState("ALL"),[U,ne]=E.useState("NONE"),[ie,je]=E.useState(null),[Ue,lt]=E.useState(!1),[Fe,nt]=E.useState({PRIVATE:!0,DAILY:!0,IDEAS:!0}),[pt,Me]=E.useState({PRIVATE:Aa,DAILY:Aa,IDEAS:Aa}),[rt,De]=E.useState(!1),[_e,an]=E.useState(!1),[on,Kn]=E.useState("DAILY"),[Dt,ms]=E.useState(""),[Gr,Gn]=E.useState(""),[hn,Yn]=E.useState(null),[Yr,Xt]=E.useState(null),[Pn,pn]=E.useState(null),[Ht,kn]=E.useState(null);E.useEffect(()=>{W||(xe("ALL"),ae("ALL"),ne("NONE"),je(null),lt(!1),nt({PRIVATE:!0,DAILY:!0,IDEAS:!0}),Me({PRIVATE:Aa,DAILY:Aa,IDEAS:Aa}),Kn("DAILY"),De(!1))},[W]),E.useEffect(()=>{ie&&lt(!0)},[ie]);const Kt=BR(M2(db,{activationConstraint:{distance:8}}),M2(_E,{activationConstraint:{delay:120,tolerance:8}})),aa=Y=>{const j=Date.now();window.innerWidth<768&&(Ht==null?void 0:Ht.noteId)===Y.id&&j-Ht.time<300?(kn(null),g?g(Y,"info"):m(Y)):(kn({noteId:Y.id,time:j}),m(Y))},ln=E.useMemo(()=>{const Y=new Map;return e.forEach(j=>Y.set(j.id,j)),Y},[e]);E.useEffect(()=>{if(L==="ALL"||L==="__ROOT__")return;const Y=ln.get(L);Y&&(on!==Y.category&&Kn(Y.category),nt(j=>({...j,[Y.category]:!1})))},[L,ln,on]);const Jr=E.useMemo(()=>{const Y=new Map;return e.forEach(j=>{Y.set(`${j.category}::${j.name.toLowerCase()}`,j.id)}),Y},[e]),Jn=Y=>{if(!Pt(Y))return;if(Y.personalFolderId)return Y.personalFolderId;const j=(Y.folderPath||"").trim();if(j)return Jr.get(`${Dn(Y)}::${j.toLowerCase()}`)},yr=Y=>{var Ce;const j=Jn(Y);return j?(Ce=ln.get(j))==null?void 0:Ce.name:Y.folderPath||void 0},Q=E.useMemo(()=>{switch(b){case"BOOK":return 24;case"ARTICLE":return 24;case"WEBSITE":return 24;case"PERSONAL_NOTE":return 30;case"NOTES":return 50;default:return 24}},[b]),[re,ue]=E.useState(V);E.useEffect(()=>{if(re!==V){I(!0);const Y=setTimeout(()=>{Z(re),F(1),I(!1)},300);return()=>clearTimeout(Y)}},[re,V,Z,F]),E.useEffect(()=>{ue(V)},[V]);const me=E.useMemo(()=>{if(R||A)return[];const Y=qo(V),j=W&&U==="RECENT"?new Set(t.filter(pe=>pe.type==="PERSONAL_NOTE"&&Dn(pe)!=="PRIVATE").sort((pe,Ze)=>Ze.addedAt-pe.addedAt).slice(0,20).map(pe=>pe.id)):null;return t.filter(pe=>{if(pe.type!==b)return!1;if(W){const lr=Dn(pe);if(oe==="ALL"&&lr==="PRIVATE"||oe!=="ALL"&&lr!==oe)return!1;if(L!=="ALL"){const Qr=Jn(pe);if(L==="__ROOT__"){if(Qr)return!1}else if(Qr!==L)return!1}if(U==="FAVORITES"&&!pe.isFavorite||U==="RECENT"&&!(j!=null&&j.has(pe.id))||ie&&!new Set((pe.tags||[]).map(la=>PC(la))).has(ie))return!1}if(_){const lr=qo(_);if(!(pe.tags||[]).some(la=>qo(la)===lr))return!1}let Ze=!0;return he!=="ALL"&&(he==="HIGHLIGHTS"?Ze=pe.highlights&&pe.highlights.length>0:he==="FAVORITES"?Ze=pe.isFavorite===!0:["To Read","Reading","Finished"].includes(he)?Ze=pe.readingStatus===he:b==="BOOK"?Ze=pe.status===he:Ze=!1),!Ze||Ee&&b!=="BOOK"&&!sr(pe.publisher||"",qo(Ee))?!1:!Y||sr(pe.title||"",Y)||sr(pe.author||"",Y)?!0:b==="BOOK"?!!(sr(pe.isbn||"",Y)||sr(pe.code||"",Y)):!!((pe.tags||[]).some(lr=>sr(lr,Y))||sr(Wa(pe.generalNotes||""),Y)||Pt(pe)&&(sr(Dn(pe),Y)||sr(yr(pe)||"",Y)))}).sort((pe,Ze)=>ve==="title_asc"?pe.title.localeCompare(Ze.title):ve==="date_asc"?pe.addedAt-Ze.addedAt:Ze.addedAt-pe.addedAt)},[t,V,he,Ee,ve,b,R,A,_,W,oe,L,U,ie,ln,Jr]),ke=E.useMemo(()=>t.filter(Y=>Y.type==="PERSONAL_NOTE"),[t]),we=E.useMemo(()=>ke.filter(Y=>Dn(Y)!=="PRIVATE"),[ke]),be=we.length,Ve=E.useMemo(()=>we.filter(Y=>Y.isFavorite).length,[we]),Qe=E.useMemo(()=>[...we].sort((Y,j)=>j.addedAt-Y.addedAt).slice(0,20).map(Y=>Y.id),[we]).length,Pe=E.useMemo(()=>{const Y=new Map;return we.forEach(j=>{const Ce=new Set;(j.tags||[]).forEach(pe=>{const Ze=pe.trim();if(!Ze)return;const wt=PC(Ze);if(Ce.has(wt))return;Ce.add(wt);const zt=Y.get(wt);if(!zt){Y.set(wt,{label:Ze,noteIds:new Set([j.id])});return}zt.noteIds.add(j.id)})}),[...Y.entries()].map(([j,Ce])=>({key:j,label:Ce.label||j,count:Ce.noteIds.size})).sort((j,Ce)=>Ce.count-j.count||j.label.localeCompare(Ce.label)).slice(0,10)},[we]),st=E.useMemo(()=>{const Y={PRIVATE:0,DAILY:0,IDEAS:0};return ke.forEach(j=>{Y[Dn(j)]+=1}),Y},[ke]),ft=E.useMemo(()=>{const Y={PRIVATE:[],DAILY:[],IDEAS:[]};return e.forEach(j=>{Y[j.category].push({id:j.id,name:j.name,order:j.order,count:ke.filter(Ce=>Jn(Ce)===j.id).length})}),["PRIVATE","DAILY","IDEAS"].forEach(j=>{Y[j].sort((Ce,pe)=>Ce.order-pe.order||Ce.name.localeCompare(pe.name))}),Y},[ke,e,Jr]),It=E.useMemo(()=>{const Y={PRIVATE:0,DAILY:0,IDEAS:0};return ke.forEach(j=>{const Ce=Dn(j);Jn(j)||(Y[Ce]+=1)}),Y},[ke,Jr]);E.useEffect(()=>{if(L==="ALL"||L==="__ROOT__")return;const Y=["PRIVATE","DAILY","IDEAS"].find(Ce=>ft[Ce].some(pe=>pe.id===L));if(!Y)return;const j=ft[Y].findIndex(Ce=>Ce.id===L);j<0||Me(Ce=>{const pe=j+1;return Ce[Y]>=pe?Ce:{...Ce,[Y]:pe}})},[L,ft]);const Cn=E.useMemo(()=>{if(!R)return[];const Y=qo(V);return t.flatMap(j=>j.highlights.map(Ce=>({...Ce,source:j}))).filter(j=>he==="FAVORITES"&&!j.isFavorite?!1:Y?sr(j.text||"",Y)||sr(j.comment||"",Y)||sr(j.source.title||"",Y)||sr(j.source.author||"",Y)||!!(j.tags&&j.tags.some(Ce=>sr(Ce,Y))):!0).sort((j,Ce)=>Ce.createdAt-j.createdAt)},[t,R,V,he]),or=E.useMemo(()=>R?{total:Cn.length,reading:0,toRead:0}:{total:me.length,reading:me.filter(Y=>Y.readingStatus==="Reading").length,toRead:me.filter(Y=>Y.readingStatus==="To Read").length},[R,Cn.length,me]),Hn=Y=>{switch(Y){case"BOOK":return"Books";case"ARTICLE":return"Articles";case"WEBSITE":return"Websites";case"PERSONAL_NOTE":return"Personal Notes";case"NOTES":return"All Notes";case"DASHBOARD":return"Dashboard"}},cn=()=>R?"Search quotes...":b==="PERSONAL_NOTE"?"Search notes...":b==="ARTICLE"?"Search title, author...":b==="WEBSITE"?"Search site, URL...":"Search title, author, ISBN...",mn=Y=>{switch(Y){case"PRIVATE":return"Private";case"DAILY":return"Daily";case"IDEAS":return"Ideas";default:return Y}},ni=async Y=>{const j=window.prompt(`${mn(Y)} klasor adi:`),Ce=j==null?void 0:j.trim();if(!Ce)return;const pe=await(a==null?void 0:a(Y,Ce));pe&&(ne("NONE"),je(null),xe(Y),ae(pe.id),F(1))},Cl=async(Y,j)=>{const Ce=window.prompt("Yeni klasor adi:",j),pe=Ce==null?void 0:Ce.trim();!pe||pe===j||await(l==null?void 0:l(Y,pe))},yp=async Y=>{!window.confirm("Bu klasor silinsin mi? Icindeki notlar kategori kokune tasinacak.")||!await(c==null?void 0:c(Y))||L===Y&&(ne("NONE"),je(null),ae("__ROOT__"))},vp=(Y,j,Ce)=>{Pn&&window.clearTimeout(Pn.timeoutId);const pe=window.setTimeout(()=>{pn(null)},5e3);pn({noteId:Y,category:j,folderId:Ce,timeoutId:pe})},Sl=async(Y,j,Ce,pe=!0)=>{const Ze=ke.find(Bt=>Bt.id===Y);if(!Ze)return;const wt=Dn(Ze),zt=Jn(Ze);await(d==null?void 0:d(Y,j,Ce))&&pe&&vp(Y,wt,zt)},ri=Y=>{var j;if(Y.startsWith("cat-root:"))return Y.replace("cat-root:","");if(Y.startsWith("cat-group:"))return Y.replace("cat-group:","");if(Y.startsWith("folder:")){const Ce=Y.replace("folder:","");return(j=ln.get(Ce))==null?void 0:j.category}},El=async(Y,j)=>{const Ce=ln.get(Y);if(!Ce||Ce.category===j)return;await(p==null?void 0:p(Y,j))&&L===Y&&(xe(j),F(1))},si=Y=>{const j=String(Y.active.id);if(j.startsWith("note:")){Yn(j.replace("note:","")),Xt(null);return}j.startsWith("folder-item:")&&(Xt(j.replace("folder-item:","")),Yn(null))},ii=()=>{Yn(null),Xt(null)},oa=async Y=>{var pe;Yn(null),Xt(null);const j=String(Y.active.id||""),Ce=String(((pe=Y.over)==null?void 0:pe.id)||"");if(Ce){if(j.startsWith("note:")){const Ze=j.replace("note:",""),wt=ri(Ce);if(!wt)return;const zt=Ce.startsWith("folder:")?Ce.replace("folder:",""):void 0;await Sl(Ze,wt,zt,!0);return}if(j.startsWith("folder-item:")){const Ze=j.replace("folder-item:",""),wt=ri(Ce);if(!wt)return;await El(Ze,wt)}}},ai=()=>{var wt,zt;const Y=Gr;if(!Pf(Y))return;const j=L==="ALL"||L==="__ROOT__"?void 0:L,pe=(j?(wt=ln.get(j))==null?void 0:wt.category:void 0)||on,Ze=j?(zt=ln.get(j))==null?void 0:zt.name:void 0;s==null||s({title:Dt.trim()||"Quick Note",content:Y,category:pe,folderId:j,folderPath:Ze}),ms(""),Gn("")},Qt=R?Cn.length:me.length,Fn=Math.ceil(Qt/Q),Du=b==="ARTICLE"||b==="WEBSITE"?"dark:bg-slate-800":"dark:bg-slate-900",vr=E.useMemo(()=>{const Y=(O-1)*Q;return me.slice(Y,Y+Q)},[me,O,Q]),gs=E.useMemo(()=>{const Y=(O-1)*Q;return Cn.slice(Y,Y+Q)},[Cn,O,Q]),Nl=E.useMemo(()=>hn&&ke.find(Y=>Y.id===hn)||null,[ke,hn]),Tl=E.useMemo(()=>Yr&&ln.get(Yr)||null,[ln,Yr]),Al=()=>{if(Fn<=1)return null;const Y=()=>{const j=[];if(Fn<=5)for(let pe=1;pe<=Fn;pe++)j.push(pe);else O<=3?j.push(1,2,3,4,"...",Fn):O>=Fn-2?j.push(1,"...",Fn-3,Fn-2,Fn-1,Fn):j.push(1,"...",O-1,O,O+1,"...",Fn);return j};return h.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4 md:mt-12 select-none",children:[h.jsx("button",{onClick:()=>F(Math.max(O-1,1)),disabled:O===1,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h.jsx(Fs,{size:20})}),h.jsx("div",{className:"flex items-center gap-1",children:Y().map((j,Ce)=>h.jsx(We.Fragment,{children:j==="..."?h.jsx("span",{className:"px-2 text-slate-400",children:"..."}):h.jsx("button",{onClick:()=>F(j),className:`w-8 h-8 md:w-10 md:h-10 rounded-lg text-sm font-medium transition-colors ${O===j?"bg-[#262D40]/40 text-white shadow-md shadow-[#262D40]/12 dark:shadow-none":"text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82"}`,children:j})},Ce))}),h.jsx("button",{onClick:()=>F(Math.min(O+1,Fn)),disabled:O===Fn,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h.jsx(uE,{size:20})})]})},wp=()=>{var Y;return A?h.jsx(We.Suspense,{fallback:h.jsx("div",{className:"flex justify-center items-center py-20",children:h.jsx(Jt,{size:32,className:"animate-spin text-[#262D40]/90"})}),children:h.jsx(wH,{items:t,userId:M,onCategorySelect:j=>z==null?void 0:z(j),onStatusSelect:j=>K==null?void 0:K(j),onNavigateToTab:j=>te==null?void 0:te(j),onMobileMenuClick:v})}):G?h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400 animate-in fade-in duration-200",children:[h.jsx(Jt,{size:32,className:"animate-spin text-[#262D40]/90 mb-4"}),h.jsx("p",{children:"Searching library..."})]}):R?gs.length===0?h.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:h.jsx(sl,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),h.jsx("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:"No highlights found"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:V?"Try a different search term.":"Highlights added to books appear here."})]}):h.jsxs("div",{className:"pb-10 md:pb-20",children:[h.jsx("div",{className:"columns-2 lg:columns-3 gap-2 md:gap-6 space-y-2 md:space-y-6",children:gs.map((j,Ce)=>{var Ze,wt;const pe=FE(j.type);return h.jsxs("div",{onClick:()=>{g?g(j.source,"highlights",j.id):m(j.source)},className:"break-inside-avoid p-2.5 md:p-6 rounded-xl border hover:shadow-md transition-all group cursor-pointer relative flex flex-col bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/12 dark:hover:border-[#262D40]/30",children:[h.jsx("button",{onClick:zt=>{zt.stopPropagation(),N&&N(j.source.id,j.id)},className:`absolute top-2 right-2 p-1.5 rounded-full transition-all shadow-sm z-10 ${j.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:j.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Po,{size:14,fill:j.isFavorite?"currentColor":"none"})}),h.jsx("div",{className:"mb-2 md:mb-3",children:pe?h.jsx(sl,{className:"text-[#CC561E] fill-[#CC561E]/10 w-4 h-4 md:w-6 md:h-6"}):((Ze=j.source)==null?void 0:Ze.type)==="ARTICLE"?h.jsx(pf,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):((wt=j.source)==null?void 0:wt.type)==="WEBSITE"?h.jsx(mf,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):h.jsx(Jc,{className:"text-[#262D40]/82 fill-[#262D40]/85 w-4 h-4 md:w-6 md:h-6"})}),h.jsx("p",{className:`text-xs md:text-base leading-relaxed mb-2 md:mb-4 whitespace-pre-wrap line-clamp-[8] md:line-clamp-none font-lora ${pe?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-slate-200"}`,children:j.text}),j.tags&&j.tags.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 mb-2 md:mb-3",children:j.tags.map((zt,Xr)=>h.jsxs("span",{className:"px-1.5 md:px-2 py-0.5 md:py-1 bg-[#F3F5FA] dark:bg-slate-700/50 border border-[#E6EAF2] dark:border-white/10 rounded text-[10px] md:text-xs text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[h.jsx(Af,{size:10,className:"md:w-3 md:h-3"})," ",zt]},Xr))}),h.jsx("div",{className:`pt-2 md:pt-4 mt-auto flex items-center justify-between border-t ${pe?"border-[#E6EAF2]":"border-[#262D40]/50"}`,children:h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"text-xs md:text-sm font-bold text-slate-900 dark:text-white truncate",children:j.source.title}),h.jsx("div",{className:"flex items-center gap-1 md:gap-2 text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:h.jsx("span",{className:"truncate max-w-[50%]",children:j.source.author})})]})})]},`${j.id}-${Ce}`)})}),Al()]}):vr.length===0&&!W?h.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:b==="BOOK"?h.jsx(nb,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):b==="ARTICLE"?h.jsx(xu,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):b==="PERSONAL_NOTE"?h.jsx(Mf,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):h.jsx($h,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),h.jsxs("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:["No ",Hn(b).toLowerCase()," found"]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:V?"Try a different search term.":"Adjust filters or add a new item."})]}):h.jsxs("div",{className:"pb-10 md:pb-20",children:[W?h.jsxs(zD,{sensors:Kt,collisionDetection:VR,modifiers:[U2],onDragStart:si,onDragCancel:ii,onDragEnd:oa,children:[h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_minmax(0,1fr)] gap-4 md:gap-6",children:[h.jsxs("aside",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl p-3 md:p-4 h-fit ${rt?"block":"hidden lg:block"}`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("h3",{className:"text-xs font-bold uppercase tracking-[0.16em] text-slate-500 flex items-center gap-2",children:[h.jsx(N2,{size:14}),"Note Space"]}),h.jsx("button",{onClick:()=>De(!1),className:"lg:hidden text-slate-400 hover:text-slate-700",children:h.jsx(cs,{size:16})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{onClick:()=>{ne("NONE"),je(null),xe("ALL"),ae("ALL"),F(1)},className:`w-full text-left px-2.5 py-2 rounded-lg text-sm transition-colors ${oe==="ALL"&&L==="ALL"&&U==="NONE"&&!ie?"bg-[#262D40]/20 text-[#262D40] dark:text-white font-semibold":"hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300"}`,children:["All Notes (",be,")"]}),h.jsxs("div",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-800 p-2",children:[h.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 mb-1",children:"Smart Folders"}),h.jsxs("button",{onClick:()=>{ne("FAVORITES"),je(null),xe("ALL"),ae("ALL"),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${U==="FAVORITES"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[h.jsx(Po,{size:12}),"Favorites"]}),h.jsx("span",{className:"text-[10px] opacity-70",children:Ve})]}),h.jsxs("button",{onClick:()=>{ne("RECENT"),je(null),xe("ALL"),ae("ALL"),F(1)},className:`mt-1 w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${U==="RECENT"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[h.jsx(E4,{size:12}),"Recent Notes"]}),h.jsx("span",{className:"text-[10px] opacity-70",children:Qe})]}),h.jsxs("div",{className:"mt-2 border-t border-[#E6EAF2] dark:border-slate-800 pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsxs("button",{onClick:()=>lt(j=>!j),className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 inline-flex items-center gap-1 hover:text-slate-700 dark:hover:text-slate-300",children:[h.jsx(_a,{size:11,className:`transition-transform ${Ue?"rotate-180":""}`}),"Top Tags"]}),ie&&h.jsx("button",{onClick:()=>{je(null),F(1)},className:"text-[10px] text-[#CC561E] hover:underline",children:"Clear tag filter"})]}),Ue&&(Pe.length===0?h.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No tags yet"}):h.jsx("div",{className:"space-y-1",children:Pe.map(j=>h.jsxs("button",{onClick:()=>{je(j.key),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${ie===j.key?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"truncate",children:["#",j.label]}),h.jsx("span",{className:"text-[10px] opacity-70",children:j.count})]},j.key))}))]})]}),["PRIVATE","DAILY","IDEAS"].map(j=>h.jsx(x0,{id:`cat-group:${j}`,children:Ce=>h.jsxs("div",{className:`rounded-lg border p-2 ${Ce?"border-[#CC561E]/40 bg-[#CC561E]/5":"border-[#E6EAF2] dark:border-slate-800"}`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsxs("button",{onClick:()=>{ne("NONE"),je(null),xe(j),ae("ALL"),F(1)},className:`text-xs font-semibold uppercase tracking-wide ${oe===j&&L==="ALL"&&U==="NONE"&&!ie?"text-[#CC561E]":"text-slate-600 dark:text-slate-300"}`,children:[mn(j)," (",st[j],")"]}),h.jsxs("button",{onClick:()=>ni(j),className:"text-[11px] text-[#CC561E] hover:underline inline-flex items-center gap-1",children:[h.jsx(V4,{size:11}),"Folder"]})]}),h.jsx(x0,{id:`cat-root:${j}`,children:pe=>h.jsxs("button",{onClick:()=>{ne("NONE"),je(null),xe(j),ae("__ROOT__"),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors ${pe?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${oe===j&&L==="__ROOT__"&&U==="NONE"&&!ie?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:["Unfiled (",It[j],")"]})}),h.jsxs("div",{className:"mt-1",children:[h.jsxs("button",{onClick:()=>nt(pe=>({...pe,[j]:!pe[j]})),className:"w-full text-left px-2 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 inline-flex items-center gap-1",children:[h.jsx(_a,{size:11,className:`transition-transform ${Fe[j]?"":"rotate-180"}`}),"Folders (",ft[j].length,")"]}),!Fe[j]&&h.jsxs("div",{className:"mt-1 space-y-1",children:[ft[j].length===0?h.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No folders yet"}):ft[j].slice(0,pt[j]).map(pe=>h.jsx(x0,{id:`folder:${pe.id}`,children:Ze=>h.jsx(HC,{id:`folder-item:${pe.id}`,children:({setNodeRef:wt,style:zt,isDragging:Xr,attributes:Bt,listeners:lr})=>h.jsxs("div",{ref:wt,style:Xr?void 0:zt,className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm flex items-center gap-2 ${Ze?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${oe===j&&L===pe.id&&U==="NONE"&&!ie?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"} ${Xr?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[h.jsx("button",{...Bt,...lr,onClick:Qr=>Qr.stopPropagation(),className:"p-1 rounded text-slate-400 hover:text-slate-700 cursor-grab active:cursor-grabbing",title:"Move folder",children:h.jsx(C2,{size:12})}),h.jsxs("button",{onClick:()=>{ne("NONE"),je(null),xe(j),ae(pe.id),F(1)},className:"flex items-center gap-2 flex-1 min-w-0",children:[h.jsx(k2,{size:12}),h.jsx("span",{className:"truncate",children:pe.name})]}),h.jsx("span",{className:"text-[10px] opacity-70",children:pe.count}),h.jsx("button",{onClick:()=>Cl(pe.id,pe.name),className:"text-slate-400 hover:text-slate-700",title:"Rename folder",children:h.jsx(D3,{size:12})}),h.jsx("button",{onClick:()=>yp(pe.id),className:"text-slate-400 hover:text-red-500",title:"Delete folder",children:h.jsx(Pa,{size:12})})]})})},pe.id)),ft[j].length>pt[j]&&h.jsxs("button",{onClick:()=>Me(pe=>({...pe,[j]:pe[j]+Aa})),className:"w-full text-left px-2 py-1.5 rounded-md text-[11px] font-semibold text-[#CC561E] hover:bg-[#CC561E]/10",children:["Load more (",ft[j].length-pt[j]," left)"]})]})]})]})},j))]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"lg:hidden flex gap-2",children:[h.jsxs("button",{onClick:()=>De(j=>!j),className:"flex-1 px-3 py-2.5 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider text-slate-600 dark:text-slate-400 shadow-sm active:scale-95 transition-all",children:[h.jsx(N2,{size:14}),"Navigator"]}),h.jsxs("button",{onClick:()=>an(!_e),className:`flex-1 px-3 py-2.5 border rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider transition-all shadow-sm active:scale-95 ${_e?"bg-[#CC561E]/10 border-[#CC561E]/30 text-[#CC561E]":"bg-white dark:bg-slate-900 border-[#E6EAF2] dark:border-slate-800 text-slate-600 dark:text-slate-400"}`,children:[h.jsx(_a,{size:14,className:`transition-transform duration-200 ${_e?"rotate-180":""}`}),"Capture"]})]}),h.jsxs("div",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-2xl overflow-hidden ${_e?"block":"hidden lg:block"}`,children:[h.jsxs("div",{className:`w-full flex items-center justify-between p-4 md:p-5 transition-colors ${_e?"":"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,onClick:()=>!_e&&an(!0),children:[h.jsxs("h4",{className:"hidden lg:flex text-sm md:text-base font-semibold uppercase tracking-[0.12em] text-slate-500 items-center gap-2 cursor-pointer",onClick:j=>{j.stopPropagation(),an(!_e)},children:[h.jsx(_a,{size:16,className:`transition-transform duration-200 ${_e?"rotate-180":""}`}),"Quick Capture"]}),(_e||window.innerWidth>=1024)&&h.jsxs("div",{className:`flex items-center gap-2 flex-1 lg:flex-none justify-between lg:justify-end ${_e?"flex":"hidden lg:flex"}`,onClick:j=>j.stopPropagation(),children:[h.jsx("span",{className:"lg:hidden text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Quick Capture"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("select",{value:on,onChange:j=>Kn(j.target.value),className:"text-[11px] border border-[#E6EAF2] dark:border-slate-700 rounded-md px-2 py-1 bg-white dark:bg-slate-950 text-slate-500 outline-none",children:[h.jsx("option",{value:"DAILY",children:"Daily"}),h.jsx("option",{value:"PRIVATE",children:"Private"}),h.jsx("option",{value:"IDEAS",children:"Ideas"})]}),U==="NONE"&&L!=="ALL"&&L!=="__ROOT__"&&h.jsxs("span",{className:"hidden sm:inline text-[11px] text-slate-400",children:["/ ",((Y=ln.get(L))==null?void 0:Y.name)||L]})]})]})]}),_e&&h.jsxs("div",{className:"px-4 pb-4 md:px-5 md:pb-5 pt-0 animate-in slide-in-from-top-2 duration-200",children:[h.jsx("input",{value:Dt,onChange:j=>ms(j.target.value),placeholder:"Note title (optional)",className:"w-full md:max-w-none max-w-[90%] mx-auto mb-3 border border-[#E6EAF2] dark:border-slate-700 rounded-xl px-4 py-3 text-sm md:text-base bg-white dark:bg-slate-950 block"}),h.jsx("div",{className:"max-w-[90%] md:max-w-none mx-auto",children:h.jsx(QA,{value:Gr,onChange:Gn,autoFocus:W,placeholder:"Start writing immediately...",minHeight:242},"quick-capture-editor")}),h.jsx("div",{className:"mt-3 flex justify-end max-w-[90%] md:max-w-none mx-auto",children:h.jsx("button",{onClick:ai,disabled:!Pf(Gr),className:"px-4 py-2 rounded-lg bg-[#262D40] text-white text-sm md:text-base disabled:opacity-40",children:"Save Quick Note"})})]})]}),vr.length===0?h.jsxs("div",{className:"text-center py-10 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx(Mf,{size:26,className:"mx-auto mb-2 text-slate-300"}),h.jsx("h3",{className:"text-base font-medium text-slate-900 dark:text-white",children:"No notes matched this filter"}),h.jsx("p",{className:"text-xs md:text-sm text-slate-500 mt-1",children:"Change category/folder filter or create a new note."})]}):h.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-2 md:gap-4",children:vr.map(j=>{const Ce=Wa(j.generalNotes||"");return h.jsx(HC,{id:`note:${j.id}`,children:({setNodeRef:pe,style:Ze,isDragging:wt,attributes:zt,listeners:Xr})=>h.jsxs("div",{ref:pe,style:wt?void 0:Ze,onClick:()=>aa(j),className:`bg-white dark:bg-slate-800 p-2.5 md:p-5 rounded-xl border border-[#E6EAF2] dark:border-slate-800 hover:border-[#262D40]/20 dark:hover:border-[#262D40]/30 hover:shadow-md transition-all cursor-pointer flex flex-col group relative ${wt||hn===j.id?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[h.jsx("div",{className:"absolute top-2 left-2 z-10",children:h.jsx("button",{...zt,...Xr,onClick:Bt=>Bt.stopPropagation(),className:"p-1.5 rounded-full bg-white/85 dark:bg-slate-800/85 text-slate-400 hover:text-slate-700 shadow-sm",title:"Drag note",children:h.jsx(C2,{size:13})})}),h.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 z-10",children:[h.jsx("button",{onClick:Bt=>{Bt.stopPropagation(),k(j.id)},className:`p-1.5 rounded-full transition-all shadow-sm ${j.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:j.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Po,{size:14,fill:j.isFavorite?"currentColor":"none"})}),h.jsx("button",{onClick:Bt=>{Bt.stopPropagation(),w(j.id)},className:"p-1.5 bg-white/80 dark:bg-slate-800/80 hover:bg-[#F3F5FA] dark:hover:bg-slate-700 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 shadow-sm",title:"Delete Note",children:h.jsx(Pa,{size:14})})]}),h.jsx("h3",{className:"font-bold text-sm md:text-base text-slate-900 dark:text-white mb-2 leading-tight pl-8 pr-8",children:j.title}),h.jsxs("div",{className:"text-slate-600 dark:text-slate-300 text-xs md:text-sm whitespace-pre-wrap leading-relaxed max-h-[180px] overflow-hidden relative font-lora mb-3",children:[Ce||h.jsx("span",{className:"italic text-slate-400 dark:text-slate-500",children:"Empty"}),Ce.length>140&&h.jsx("div",{className:"absolute bottom-0 inset-x-0 h-8 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),h.jsxs("div",{className:"mt-auto pt-2 flex flex-wrap gap-1.5 border-t border-slate-100 dark:border-slate-800 items-center",children:[h.jsx("span",{className:"px-2 py-0.5 bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs rounded border border-[#CC561E]/20 font-semibold",children:Dn(j)}),yr(j)&&h.jsx("span",{className:"px-2 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700 truncate max-w-[150px]",children:yr(j)}),h.jsxs("span",{className:"ml-auto text-[10px] md:text-xs text-slate-400 flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),new Date(j.addedAt).toLocaleDateString()]})]})]})},j.id)})})]})]}),h.jsx(r6,{modifiers:[U2],children:Nl?h.jsxs("div",{className:"w-[320px] max-w-[80vw] bg-white dark:bg-slate-800 p-3 rounded-xl border border-[#CC561E]/35 shadow-xl cursor-grabbing",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:Nl.title}),h.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-300 truncate",children:mn(Dn(Nl))})]}):Tl?h.jsxs("div",{className:"w-[220px] max-w-[70vw] bg-white dark:bg-slate-900 px-3 py-2 rounded-lg border border-[#CC561E]/35 shadow-xl cursor-grabbing flex items-center gap-2",children:[h.jsx(k2,{size:13,className:"text-slate-500"}),h.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 truncate",children:Tl.name})]}):null})]}):h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 md:gap-6",children:vr.map(j=>h.jsxs("div",{onClick:()=>m(j),className:`bg-white ${Du} rounded-xl border border-[#E6EAF2] dark:border-slate-800 overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all cursor-pointer group flex flex-col h-full relative`,children:[h.jsxs("div",{className:"h-[122px] md:h-40 bg-[#F3F5FA] dark:bg-slate-800 relative flex items-end justify-between overflow-hidden group-hover:opacity-95 transition-opacity",children:[h.jsxs("div",{className:"absolute top-2 right-2 z-40 flex gap-1",children:[h.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),k(j.id)},className:`p-1.5 rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all ${j.isFavorite?"bg-amber-100/90 dark:bg-amber-900/80 text-amber-500 dark:text-amber-400 opacity-100":"bg-white/90 dark:bg-slate-900/90 text-slate-400 dark:text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:j.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Po,{size:14,className:"md:w-4 md:h-4",fill:j.isFavorite?"currentColor":"none"})}),h.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),w(j.id)},className:"p-1.5 bg-white/90 dark:bg-slate-900/90 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:"Delete Item",children:h.jsx(Pa,{size:14,className:"md:w-4 md:h-4"})}),j.isIngested&&h.jsx("div",{className:"p-1.5 bg-[#262D40]/90 dark:bg-[#262D40]/90 text-white rounded-full shadow-sm backdrop-blur-sm border border-[#262D40]/50 dark:border-[#262D40]/50 transition-all z-40",title:"Added to AI Library",children:h.jsx(Yc,{size:14,className:"md:w-4 md:h-4",fill:"currentColor"})})]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#F3F5FA] dark:bg-slate-800 transition-colors group-hover:bg-[#EDF1F8] dark:group-hover:bg-slate-700",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-[#262D40]/20 blur-2xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),h.jsx("div",{className:"relative p-4 rounded-full",children:j.type==="BOOK"?h.jsx(nx,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):j.type==="ARTICLE"?h.jsx(pf,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):h.jsx(mf,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"})})]})}),j.type==="BOOK"&&j.coverUrl&&h.jsxs(h.Fragment,{children:[h.jsx("img",{src:j.coverUrl,alt:j.title,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 z-10",onError:Ce=>{Ce.currentTarget.style.display="none";const pe=Ce.currentTarget.nextElementSibling;pe&&pe.classList.add("hidden")}}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/80 via-slate-900/20 to-transparent z-20 pointer-events-none"})]}),j.type!=="BOOK"&&h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-transparent z-20 pointer-events-none"}),h.jsxs("div",{className:"relative z-30 p-1.5 md:p-4 w-full flex justify-between items-end",children:[h.jsx("div",{className:`text-[8px] md:text-xs font-bold px-1 md:px-2 py-0.5 md:py-1 rounded shadow-sm backdrop-blur-md ${j.type==="BOOK"&&j.coverUrl||j.type!=="BOOK"?"bg-white/90 dark:bg-slate-900/90 text-slate-900 dark:text-white border border-white/50 dark:border-slate-700":H[j.readingStatus]}`,children:j.readingStatus}),h.jsxs("div",{className:"flex gap-0.5 md:gap-1",children:[j.type==="BOOK"&&j.status==="Lent Out"&&h.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F59E0B] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lent Out",children:h.jsx($i,{size:10,className:"md:w-3 md:h-3"})}),j.type==="BOOK"&&j.status==="Lost"&&h.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F43F5E] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lost",children:h.jsx($i,{size:10,className:"md:w-3 md:h-3"})})]})]})]}),h.jsxs("div",{className:"p-2.5 md:p-5 flex-1 flex flex-col",children:[h.jsx("h3",{className:"font-bold text-sm md:text-lg text-slate-900 dark:text-white leading-tight mb-0.5 md:mb-1 line-clamp-2 group-hover:text-[#262D40] dark:group-hover:text-[#262D40] transition-colors",children:j.title}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mb-2 md:mb-4 line-clamp-1",children:j.author}),h.jsxs("div",{className:"mt-auto pt-2 md:pt-4 border-t border-slate-50 dark:border-slate-800 flex justify-between items-center text-[10px] md:text-xs text-slate-400 dark:text-slate-500",children:[h.jsx("span",{className:"truncate max-w-[70%]",children:j.type==="BOOK"?j.publisher||"":j.type==="ARTICLE"?j.publisher||"Journal":(()=>{try{return j.url?new URL(j.url).hostname:"Web"}catch{return"Web"}})()}),j.type==="ARTICLE"&&j.publicationYear&&h.jsx("span",{className:"bg-[#F3F5FA] dark:bg-slate-800 px-1.5 py-0.5 rounded text-slate-500 dark:text-slate-400 font-mono",children:j.publicationYear}),j.type==="WEBSITE"&&j.url&&h.jsx("a",{href:j.url,target:"_blank",rel:"noreferrer",className:"text-[#262D40]/70 hover:text-[#262D40]",onClick:Ce=>Ce.stopPropagation(),children:h.jsx(Uh,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]})]},j.id))}),Al()]})},so=(Y=>{switch(Y){case"DASHBOARD":return BE;case"NOTES":return PE;case"BOOK":return nx;case"ARTICLE":return pf;case"WEBSITE":return mf;case"PERSONAL_NOTE":return HE;default:return mE}})(b);return h.jsxs("div",{className:"max-w-6xl w-full mx-auto p-3 md:p-8 lg:p-10 animate-in fade-in duration-500",children:[!A&&h.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-8 gap-2",children:[h.jsxs("div",{className:"flex items-center gap-2 md:gap-4 overflow-hidden flex-1",children:[h.jsx("button",{onClick:v,className:"lg:hidden p-1 -ml-1 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 rounded-lg transition-colors shrink-0",children:h.jsx(S3,{size:18,className:"md:w-6 md:h-6"})}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"hidden md:flex p-2 bg-[#262D40] rounded-xl border border-[#262D40]/80 shadow-sm",children:h.jsx(so,{size:24,className:"text-white"})}),h.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[h.jsx("h1",{className:"text-lg md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight leading-none truncate",children:Hn(b)}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-[10px] md:text-sm md:mt-1 font-medium truncate",children:R?`${or.total} Highlights`:W?`${or.total} Notes`:`${or.total} Items  ${or.reading} Reading`})]})]})]}),h.jsx("div",{className:"flex gap-2",children:h.jsxs("button",{onClick:()=>{var Y;if(W&&r){const j=oe==="ALL"?"DAILY":oe,Ce=L==="ALL"||L==="__ROOT__"?void 0:L;r({category:j,folderId:Ce,folderPath:Ce?(Y=ln.get(Ce))==null?void 0:Y.name:void 0});return}n()},className:"bg-[#262D40] text-white px-2 py-1.5 md:px-5 md:py-2.5 rounded-lg hover:bg-[#1d2333] transition-all flex items-center gap-1 shadow-md shadow-[#262D40]/20 dark:shadow-none font-medium shrink-0 active:scale-95",children:[h.jsx(Q0,{size:14,className:"md:w-5 md:h-5"}),h.jsxs("span",{className:"text-[10px] md:text-base",children:["Add ",b==="ARTICLE"?"Article":b==="WEBSITE"?"Web":b==="PERSONAL_NOTE"?"Note":"Book"]})]})})]}),!A&&h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-1.5 md:p-4 rounded-xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 mb-2 md:mb-8 flex flex-col md:flex-row gap-2 md:gap-4 max-w-[90%] md:max-w-none mx-auto w-full",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx(Us,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-5 md:h-5"}),h.jsx("input",{type:"text",placeholder:cn(),value:re,onChange:Y=>ue(Y.target.value),className:`w-full pl-7 md:pl-10 ${R||W?"pr-10":"pr-4"} md:pr-4 py-1 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] focus:border-transparent outline-none transition-all text-[11px] md:text-base bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500`}),G&&h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:h.jsx(Jt,{size:16,className:"animate-spin text-[#CC561E]"})}),(R||W)&&h.jsx("button",{onClick:()=>Te(he==="FAVORITES"?"ALL":"FAVORITES"),className:`md:hidden absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-lg border transition-all flex items-center justify-center shrink-0 ${he==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500"}`,title:he==="FAVORITES"?"Show All":"Show Favorites Only",children:h.jsx(Po,{size:14,fill:he==="FAVORITES"?"currentColor":"none"})})]}),(R||W)&&h.jsx("button",{onClick:()=>Te(he==="FAVORITES"?"ALL":"FAVORITES"),className:`hidden md:flex p-2 rounded-lg border transition-all items-center justify-center shrink-0 ${he==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-700"}`,title:he==="FAVORITES"?"Show All":"Show Favorites Only",children:h.jsx(Po,{size:20,className:"md:w-5 md:h-5",fill:he==="FAVORITES"?"currentColor":"none"})}),!R&&!W&&h.jsxs("div",{className:"grid grid-cols-2 md:flex gap-2 items-center",children:[h.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[h.jsx(K4,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:he,onChange:Y=>{Te(Y.target.value),F(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"ALL",children:"All"}),h.jsx("option",{value:"FAVORITES",children:"Favorites"}),h.jsx("option",{value:"HIGHLIGHTS",children:"Highlight"}),h.jsxs("optgroup",{label:"Status",children:[h.jsx("option",{value:"To Read",children:"To Read"}),h.jsx("option",{value:"Reading",children:"Reading"}),h.jsx("option",{value:"Finished",children:"Finished"})]}),b==="BOOK"&&h.jsxs("optgroup",{label:"Inventory",children:[h.jsx("option",{value:"On Shelf",children:"On Shelf"}),h.jsx("option",{value:"Lent Out",children:"Lent Out"}),h.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),h.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[h.jsx(i4,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:ve,onChange:Y=>{Se(Y.target.value),F(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"date_desc",children:"Newest"}),h.jsx("option",{value:"date_asc",children:"Oldest"}),h.jsx("option",{value:"title_asc",children:"A-Z"})]})]}),b==="BOOK"&&h.jsxs("div",{className:"relative min-w-[140px] md:min-w-[180px]",children:[h.jsx(Af,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:_||"",onChange:Y=>P==null?void 0:P(Y.target.value||null),className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"",children:"All categories"}),Bf.map(Y=>h.jsx("option",{value:Y,children:Y},Y))]})]}),b==="ARTICLE"&&h.jsx("input",{type:"text",placeholder:"Journal...",value:Ee,onChange:Y=>{q(Y.target.value),F(1)},className:"hidden md:block px-4 py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] text-sm min-w-[140px] bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500"})]})]}),b==="BOOK"&&!A&&_&&h.jsxs("div",{className:"flex items-center gap-2 mb-4 md:mb-6",children:[h.jsx("span",{className:"text-xs md:text-sm text-slate-500",children:"Category:"}),h.jsxs("button",{className:"flex items-center gap-2 px-3 py-1 bg-[rgba(204,86,30,0.1)] text-[#CC561E] rounded-full text-xs md:text-sm border border-[#CC561E]/20 shadow-sm",onClick:()=>P==null?void 0:P(null),children:[h.jsx("span",{className:"font-semibold",children:_}),h.jsx(cs,{size:14})]})]}),wp(),W&&Pn&&h.jsxs("div",{className:"fixed bottom-5 right-5 z-50 bg-[#262D40] text-white px-4 py-3 rounded-xl shadow-xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm",children:"Note moved."}),h.jsx("button",{onClick:()=>{window.clearTimeout(Pn.timeoutId);const Y=Pn;pn(null),Sl(Y.noteId,Y.category,Y.folderId,!1)},className:"text-sm font-semibold text-[#FFB58D] hover:text-white",children:"Undo"})]})]})}),CH=()=>{};var FC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},SH=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[n++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[n++],l=t[n++],c=t[n++],d=((s&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const a=t[n++],l=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},e5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const a=t[s],l=s+1<t.length,c=l?t[s+1]:0,d=s+2<t.length,p=d?t[s+2]:0,m=a>>2,g=(a&3)<<4|c>>4;let b=(c&15)<<2|p>>6,v=p&63;d||(v=64,l||(b=64)),r.push(n[m],n[g],n[b],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ZA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SH(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const a=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const p=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,a==null||c==null||p==null||g==null)throw new EH;const b=a<<2|c>>4;if(r.push(b),p!==64){const v=c<<4&240|p>>2;if(r.push(v),g!==64){const w=p<<6&192|g;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class EH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NH=function(t){const e=ZA(t);return e5.encodeByteArray(e,!0)},t5=function(t){return NH(t).replace(/\./g,"")},n5=function(t){try{return e5.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AH=()=>TH().__FIREBASE_DEFAULTS__,MH=()=>{if(typeof process>"u"||typeof FC>"u")return;const t=FC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},OH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&n5(t[1]);return e&&JSON.parse(e)},ry=()=>{try{return CH()||AH()||MH()||OH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},jH=t=>{var e,n;return(n=(e=ry())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},r5=()=>{var t;return(t=ry())==null?void 0:t.config},s5=t=>{var e;return(e=ry())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _H{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function RH(t){return(await fetch(t,{credentials:"include"})).ok}const Vc={};function DH(){const t={prod:[],emulator:[]};for(const e of Object.keys(Vc))Vc[e]?t.emulator.push(e):t.prod.push(e);return t}function LH(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let UC=!1;function IH(t,e){if(typeof window>"u"||typeof document>"u"||!hp(window.location.host)||Vc[t]===e||Vc[t]||UC)return;Vc[t]=e;function n(b){return`__firebase__banner__${b}`}const r="__firebase__banner",a=DH().prod.length>0;function l(){const b=document.getElementById(r);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function d(b,v){b.setAttribute("width","24"),b.setAttribute("id",v),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{UC=!0,l()},b}function m(b,v){b.setAttribute("id",v),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function g(){const b=LH(r),v=n("text"),w=document.getElementById(v)||document.createElement("span"),C=n("learnmore"),k=document.getElementById(C)||document.createElement("a"),N=n("preprendIcon"),M=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const _=b.element;c(_),m(k,C);const P=p();d(M,N),_.append(M,w,k,P),document.body.appendChild(_)}a?(w.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qn())}function BH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function HH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FH(){const t=qn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function UH(){try{return typeof indexedDB=="object"}catch{return!1}}function $H(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VH="FirebaseError";class sa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=VH,Object.setPrototypeOf(this,sa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nu.prototype.create)}}class Nu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?qH(a,r):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new sa(s,c,r)}}function qH(t,e){return t.replace(WH,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const WH=/\{\$([^}]+)}/g;function KH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const a=t[s],l=e[s];if($C(a)&&$C(l)){if(!hl(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function $C(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function GH(t,e){const n=new YH(t,e);return n.subscribe.bind(n)}class YH{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");JH(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=b0),s.error===void 0&&(s.error=b0),s.complete===void 0&&(s.complete=b0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JH(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function b0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(t){return t&&t._delegate?t._delegate:t}class pl{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XH{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new _H;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZH(e))try{this.getOrInitializeService({instanceIdentifier:Ma})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Ma){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ma){return this.instances.has(e)}getOptions(e=Ma){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&l.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:QH(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ma){return this.component?this.component.multipleInstances?e:Ma:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QH(t){return t===Ma?void 0:t}function ZH(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new XH(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(St||(St={}));const tF={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},nF=St.INFO,rF={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},sF=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rF[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class i5{constructor(e){this.name=e,this._logLevel=nF,this._logHandler=sF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}}const iF=(t,e)=>e.some(n=>t instanceof n);let VC,qC;function aF(){return VC||(VC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oF(){return qC||(qC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const a5=new WeakMap,Fx=new WeakMap,o5=new WeakMap,y0=new WeakMap,sy=new WeakMap;function lF(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",l)},a=()=>{n(Ji(t.result)),s()},l=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&a5.set(n,t)}).catch(()=>{}),sy.set(e,t),e}function cF(t){if(Fx.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",l),t.removeEventListener("abort",l)},a=()=>{n(),s()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",l),t.addEventListener("abort",l)});Fx.set(t,e)}let Ux={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Fx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||o5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uF(t){Ux=t(Ux)}function dF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(v0(this),e,...n);return o5.set(r,e.sort?e.sort():[e]),Ji(r)}:oF().includes(t)?function(...e){return t.apply(v0(this),e),Ji(a5.get(this))}:function(...e){return Ji(t.apply(v0(this),e))}}function fF(t){return typeof t=="function"?dF(t):(t instanceof IDBTransaction&&cF(t),iF(t,aF())?new Proxy(t,Ux):t)}function Ji(t){if(t instanceof IDBRequest)return lF(t);if(y0.has(t))return y0.get(t);const e=fF(t);return e!==t&&(y0.set(t,e),sy.set(e,t)),e}const v0=t=>sy.get(t);function hF(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(t,e),c=Ji(l);return r&&l.addEventListener("upgradeneeded",d=>{r(Ji(l.result),d.oldVersion,d.newVersion,Ji(l.transaction),d)}),n&&l.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),s&&d.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const pF=["get","getKey","getAll","getAllKeys","count"],mF=["put","add","delete","clear"],w0=new Map;function WC(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(w0.get(e))return w0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=mF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pF.includes(n)))return;const a=async function(l,...c){const d=this.transaction(l,s?"readwrite":"readonly");let p=d.store;return r&&(p=p.index(c.shift())),(await Promise.all([p[n](...c),s&&d.done]))[0]};return w0.set(e,a),a}uF(t=>({...t,get:(e,n,r)=>WC(e,n)||t.get(e,n,r),has:(e,n)=>!!WC(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function xF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $x="@firebase/app",KC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new i5("@firebase/app"),bF="@firebase/app-compat",yF="@firebase/analytics-compat",vF="@firebase/analytics",wF="@firebase/app-check-compat",kF="@firebase/app-check",CF="@firebase/auth",SF="@firebase/auth-compat",EF="@firebase/database",NF="@firebase/data-connect",TF="@firebase/database-compat",AF="@firebase/functions",MF="@firebase/functions-compat",OF="@firebase/installations",jF="@firebase/installations-compat",_F="@firebase/messaging",RF="@firebase/messaging-compat",DF="@firebase/performance",LF="@firebase/performance-compat",IF="@firebase/remote-config",zF="@firebase/remote-config-compat",BF="@firebase/storage",PF="@firebase/storage-compat",HF="@firebase/firestore",FF="@firebase/ai",UF="@firebase/firestore-compat",$F="firebase",VF="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="[DEFAULT]",qF={[$x]:"fire-core",[bF]:"fire-core-compat",[vF]:"fire-analytics",[yF]:"fire-analytics-compat",[kF]:"fire-app-check",[wF]:"fire-app-check-compat",[CF]:"fire-auth",[SF]:"fire-auth-compat",[EF]:"fire-rtdb",[NF]:"fire-data-connect",[TF]:"fire-rtdb-compat",[AF]:"fire-fn",[MF]:"fire-fn-compat",[OF]:"fire-iid",[jF]:"fire-iid-compat",[_F]:"fire-fcm",[RF]:"fire-fcm-compat",[DF]:"fire-perf",[LF]:"fire-perf-compat",[IF]:"fire-rc",[zF]:"fire-rc-compat",[BF]:"fire-gcs",[PF]:"fire-gcs-compat",[HF]:"fire-fst",[UF]:"fire-fst-compat",[FF]:"fire-vertex","fire-js":"fire-js",[$F]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Map,WF=new Map,qx=new Map;function GC(t,e){try{t.container.addComponent(e)}catch(n){Qs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function du(t){const e=t.name;if(qx.has(e))return Qs.debug(`There were multiple attempts to register component ${e}.`),!1;qx.set(e,t);for(const n of Oh.values())GC(n,t);for(const n of WF.values())GC(n,t);return!0}function l5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function as(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new Nu("app","Firebase",KF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new pl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=VF;function c5(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Vx,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Xi.create("bad-app-name",{appName:String(s)});if(n||(n=r5()),!n)throw Xi.create("no-options");const a=Oh.get(s);if(a){if(hl(n,a.options)&&hl(r,a.config))return a;throw Xi.create("duplicate-app",{appName:s})}const l=new eF(s);for(const d of qx.values())l.addComponent(d);const c=new GF(n,r,l);return Oh.set(s,c),c}function YF(t=Vx){const e=Oh.get(t);if(!e&&t===Vx&&r5())return c5();if(!e)throw Xi.create("no-app",{appName:t});return e}function Qo(t,e,n){let r=qF[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qs.warn(l.join(" "));return}du(new pl(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF="firebase-heartbeat-database",XF=1,fu="firebase-heartbeat-store";let k0=null;function u5(){return k0||(k0=hF(JF,XF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Xi.create("idb-open",{originalErrorMessage:t.message})})),k0}async function QF(t){try{const n=(await u5()).transaction(fu),r=await n.objectStore(fu).get(d5(t));return await n.done,r}catch(e){if(e instanceof sa)Qs.warn(e.message);else{const n=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qs.warn(n.message)}}}async function YC(t,e){try{const r=(await u5()).transaction(fu,"readwrite");await r.objectStore(fu).put(e,d5(t)),await r.done}catch(n){if(n instanceof sa)Qs.warn(n.message);else{const r=Xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qs.warn(r.message)}}}function d5(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=1024,eU=30;class tU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=JC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>eU){const l=sU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Qs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=JC(),{heartbeatsToSend:r,unsentEntries:s}=nU(this._heartbeatsCache.heartbeats),a=t5(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return Qs.warn(n),""}}}function JC(){return new Date().toISOString().substring(0,10)}function nU(t,e=ZF){const n=[];let r=t.slice();for(const s of t){const a=n.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),XC(n)>e){a.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),XC(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UH()?$H().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await QF(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return YC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return YC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function XC(t){return t5(JSON.stringify({version:2,heartbeats:t})).length}function sU(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){du(new pl("platform-logger",e=>new gF(e),"PRIVATE")),du(new pl("heartbeat",e=>new tU(e),"PRIVATE")),Qo($x,KC,t),Qo($x,KC,"esm2020"),Qo("fire-js","")}iU("");function f5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aU=f5,h5=new Nu("auth","Firebase",f5());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh=new i5("@firebase/auth");function oU(t,...e){jh.logLevel<=St.WARN&&jh.warn(`Auth (${Au}): ${t}`,...e)}function Cf(t,...e){jh.logLevel<=St.ERROR&&jh.error(`Auth (${Au}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t,...e){throw ay(t,...e)}function Vr(t,...e){return ay(t,...e)}function iy(t,e,n){const r={...aU(),[e]:n};return new Nu("auth","Firebase",r).create(e,{appName:t.name})}function qa(t){return iy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lU(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&fs(t,"argument-error"),iy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ay(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return h5.create(t,...e)}function qe(t,e,...n){if(!t)throw ay(e,...n)}function Vs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cf(e),new Error(e)}function Zs(t,e){t||Vs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function cU(){return QC()==="http:"||QC()==="https:"}function QC(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cU()||PH()||"connection"in navigator)?navigator.onLine:!0}function dU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zs(n>e,"Short delay should be less than long delay!"),this.isMobile=zH()||HH()}get(){return uU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){Zs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pU=new Mu(3e4,6e4);function ly(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function wl(t,e,n,r,s={}){return m5(t,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const c=Tu({key:t.config.apiKey,...l}).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:d,...a};return BH()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&hp(t.emulatorConfig.host)&&(p.credentials="include"),p5.fetch()(await g5(t,t.config.apiHost,n,c),p)})}async function m5(t,e,n){t._canInitEmulator=!1;const r={...fU,...e};try{const s=new gU(t),a=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw cf(t,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[d,p]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw cf(t,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw cf(t,"email-already-in-use",l);if(d==="USER_DISABLED")throw cf(t,"user-disabled",l);const m=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw iy(t,m,p);fs(t,m)}}catch(s){if(s instanceof sa)throw s;fs(t,"network-request-failed",{message:String(s)})}}async function mU(t,e,n,r,s={}){const a=await wl(t,e,n,r,s);return"mfaPendingCredential"in a&&fs(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function g5(t,e,n,r){const s=`${e}${n}?${r}`,a=t,l=a.config.emulator?oy(t.config,s):`${t.config.apiScheme}://${s}`;return hU.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class gU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Vr(this.auth,"network-request-failed")),pU.get())})}}function cf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Vr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xU(t,e){return wl(t,"POST","/v1/accounts:delete",e)}async function _h(t,e){return wl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bU(t,e=!1){const n=ia(t),r=await n.getIdToken(e),s=cy(r);qe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:qc(C0(s.auth_time)),issuedAtTime:qc(C0(s.iat)),expirationTime:qc(C0(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function C0(t){return Number(t)*1e3}function cy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Cf("JWT malformed, contained fewer than 3 sections"),null;try{const s=n5(n);return s?JSON.parse(s):(Cf("Failed to decode base64 JWT payload"),null)}catch(s){return Cf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ZC(t){const e=cy(t);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof sa&&yU(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function yU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=qc(this.lastLoginAt),this.creationTime=qc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rh(t){var g;const e=t.auth,n=await t.getIdToken(),r=await hu(t,_h(e,{idToken:n}));qe(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const a=(g=s.providerUserInfo)!=null&&g.length?x5(s.providerUserInfo):[],l=kU(t.providerData,a),c=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Kx(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(t,m)}async function wU(t){const e=ia(t);await Rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kU(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function x5(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CU(t,e){const n=await m5(t,{},async()=>{const r=Tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,l=await g5(t,s,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:r};return t.emulatorConfig&&hp(t.emulatorConfig.host)&&(d.credentials="include"),p5.fetch()(l,d)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function SU(t,e){return wl(t,"POST","/v2/accounts:revokeToken",ly(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const n=ZC(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:a}=await CU(e,n);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:a}=n,l=new Zo;return r&&(qe(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(qe(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(qe(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zo,this.toJSON())}_performRefresh(){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t,e){qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ur{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new vU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Kx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await hu(this,this.stsTokenManager.getToken(this.auth,e));return qe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bU(this,e)}reload(){return wU(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ur({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Rh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(as(this.auth.app))return Promise.reject(qa(this.auth));const e=await this.getIdToken();return await hu(this,xU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,a=n.phoneNumber??void 0,l=n.photoURL??void 0,c=n.tenantId??void 0,d=n._redirectEventId??void 0,p=n.createdAt??void 0,m=n.lastLoginAt??void 0,{uid:g,emailVerified:b,isAnonymous:v,providerData:w,stsTokenManager:C}=n;qe(g&&C,e,"internal-error");const k=Zo.fromJSON(this.name,C);qe(typeof g=="string",e,"internal-error"),ji(r,e.name),ji(s,e.name),qe(typeof b=="boolean",e,"internal-error"),qe(typeof v=="boolean",e,"internal-error"),ji(a,e.name),ji(l,e.name),ji(c,e.name),ji(d,e.name),ji(p,e.name),ji(m,e.name);const N=new Ur({uid:g,auth:e,email:s,emailVerified:b,displayName:r,isAnonymous:v,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:k,createdAt:p,lastLoginAt:m});return w&&Array.isArray(w)&&(N.providerData=w.map(M=>({...M}))),d&&(N._redirectEventId=d),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new Zo;s.updateFromServerResponse(n);const a=new Ur({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Rh(a),a}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];qe(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?x5(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),c=new Zo;c.updateFromIdToken(r);const d=new Ur({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Kx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=new Map;function qs(t){Zs(t instanceof Function,"Expected a class definition");let e=eS.get(t);return e?(Zs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}b5.type="NONE";const tS=b5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t,e,n){return`firebase:${t}:${e}:${n}`}class el{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Sf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Sf("persistence",s.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await _h(this.auth,{idToken:e}).catch(()=>{});return n?Ur._fromGetAccountInfoResponse(this.auth,n,e):null}return Ur._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new el(qs(tS),e,r);const s=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||qs(tS);const l=Sf(r,e.config.apiKey,e.name);let c=null;for(const p of n)try{const m=await p._get(l);if(m){let g;if(typeof m=="string"){const b=await _h(e,{idToken:m}).catch(()=>{});if(!b)break;g=await Ur._fromGetAccountInfoResponse(e,b,m)}else g=Ur._fromJSON(e,m);p!==a&&(c=g),a=p;break}}catch{}const d=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new el(a,e,r):(a=d[0],c&&await a._set(l,c.toJSON()),await Promise.all(n.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new el(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(k5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(y5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S5(e))return"Blackberry";if(E5(e))return"Webos";if(v5(e))return"Safari";if((e.includes("chrome/")||w5(e))&&!e.includes("edge/"))return"Chrome";if(C5(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function y5(t=qn()){return/firefox\//i.test(t)}function v5(t=qn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w5(t=qn()){return/crios\//i.test(t)}function k5(t=qn()){return/iemobile/i.test(t)}function C5(t=qn()){return/android/i.test(t)}function S5(t=qn()){return/blackberry/i.test(t)}function E5(t=qn()){return/webos/i.test(t)}function uy(t=qn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function EU(t=qn()){var e;return uy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function NU(){return FH()&&document.documentMode===10}function N5(t=qn()){return uy(t)||C5(t)||E5(t)||S5(t)||/windows phone/i.test(t)||k5(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(t,e=[]){let n;switch(t){case"Browser":n=nS(qn());break;case"Worker":n=`${nS(qn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Au}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((l,c)=>{try{const d=e(a);l(d)}catch(d){c(d)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AU(t,e={}){return wl(t,"GET","/v2/passwordPolicy",ly(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU=6;class OU{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??MU,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rS(this),this.idTokenSubscription=new rS(this),this.beforeStateQueue=new TU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qs(n)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await el.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await _h(this,{idToken:e}),r=await Ur._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(as(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,c=r==null?void 0:r._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===c)&&(d!=null&&d.user)&&(r=d.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Rh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(as(this.app))return Promise.reject(qa(this));const n=e?ia(e):null;return n&&qe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return as(this.app)?Promise.reject(qa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return as(this.app)?Promise.reject(qa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AU(this),n=new OU(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await SU(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qs(e)||this._popupRedirectResolver;qe(n,this,"argument-error"),this.redirectPersistenceManager=await el.create(this,[qs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof n=="function"){const d=e.addObserver(n,r,s);return()=>{l=!0,d()}}else{const d=e.addObserver(n);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&oU(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ou(t){return ia(t)}class rS{constructor(e){this.auth=e,this.observer=null,this.addObserver=GH(n=>this.observer=n)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _U(t){dy=t}function RU(t){return dy.loadJS(t)}function DU(){return dy.gapiScript}function LU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IU(t,e){const n=l5(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),a=n.getOptions();if(hl(a,e??{}))return s;fs(s,"already-initialized")}return n.initialize({options:e})}function zU(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function BU(t,e,n){const r=Ou(t);qe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=A5(e),{host:l,port:c}=PU(e),d=c===null?"":`:${c}`,p={url:`${a}//${l}${d}/`},m=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){qe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),qe(hl(p,r.config.emulator)&&hl(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,hp(l)?(RH(`${a}//${l}${d}`),IH("Auth",!0)):HU()}function A5(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function PU(t){const e=A5(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:sS(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:sS(l)}}}function sS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function HU(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,n){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tl(t,e){return mU(t,"POST","/v1/accounts:signInWithIdp",ly(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU="http://localhost";class eo extends M5{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):fs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...a}=n;if(!r||!s)return null;const l=new eo(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return tl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,tl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,tl(e,n)}buildRequest(){const e={requestUri:FU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Tu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju extends fy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends ju{constructor(){super("facebook.com")}static credential(e){return eo._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return eo._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Hs.credential(n,r)}catch{return null}}}Hs.GOOGLE_SIGN_IN_METHOD="google.com";Hs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends ju{constructor(){super("github.com")}static credential(e){return eo._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com";Fi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends ju{constructor(){super("twitter.com")}static credential(e,n){return eo._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ui.credential(n,r)}catch{return null}}}Ui.TWITTER_SIGN_IN_METHOD="twitter.com";Ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const a=await Ur._fromIdTokenResponse(e,r,s),l=iS(r);return new ml({user:a,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=iS(r);return new ml({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function iS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh extends sa{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Dh(e,n,r,s)}}function O5(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(t,a,e,r):a})}async function UU(t,e,n=!1){const r=await hu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ml._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $U(t,e,n=!1){const{auth:r}=t;if(as(r.app))return Promise.reject(qa(r));const s="reauthenticate";try{const a=await hu(t,O5(r,s,e,t),n);qe(a.idToken,r,"internal-error");const l=cy(a.idToken);qe(l,r,"internal-error");const{sub:c}=l;return qe(t.uid===c,r,"user-mismatch"),ml._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&fs(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VU(t,e,n=!1){if(as(t.app))return Promise.reject(qa(t));const r="signIn",s=await O5(t,r,e),a=await ml._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(a.user),a}function qU(t,e,n,r){return ia(t).onIdTokenChanged(e,n,r)}function WU(t,e,n){return ia(t).beforeAuthStateChanged(e,n)}function KU(t,e,n,r){return ia(t).onAuthStateChanged(e,n,r)}function GU(t){return ia(t).signOut()}const Lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Lh,"1"),this.storage.removeItem(Lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YU=1e3,JU=10;class _5 extends j5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=N5(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);NU()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,JU):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},YU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}_5.type="LOCAL";const XU=_5;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5 extends j5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}R5.type="SESSION";const D5=R5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QU(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new pp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:a}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(l).map(async p=>p(n.origin,a)),d=await QU(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:d})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((c,d)=>{const p=hy("",20);s.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(g){const b=g;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(m),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(b.data.response);break;default:clearTimeout(m),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(){return window}function e$(t){ls().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(){return typeof ls().WorkerGlobalScope<"u"&&typeof ls().importScripts=="function"}async function t$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function n$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function r$(){return L5()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5="firebaseLocalStorageDb",s$=1,Ih="firebaseLocalStorage",z5="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function mp(t,e){return t.transaction([Ih],e?"readwrite":"readonly").objectStore(Ih)}function i$(){const t=indexedDB.deleteDatabase(I5);return new _u(t).toPromise()}function Gx(){const t=indexedDB.open(I5,s$);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ih,{keyPath:z5})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ih)?e(r):(r.close(),await i$(),e(await Gx()))})})}async function aS(t,e,n){const r=mp(t,!0).put({[z5]:e,value:n});return new _u(r).toPromise()}async function a$(t,e){const n=mp(t,!1).get(e),r=await new _u(n).toPromise();return r===void 0?null:r.value}function oS(t,e){const n=mp(t,!0).delete(e);return new _u(n).toPromise()}const o$=800,l$=3;class B5{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>l$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return L5()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pp._getInstance(r$()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await t$(),!this.activeServiceWorker)return;this.sender=new ZU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||n$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gx();return await aS(e,Lh,"1"),await oS(e,Lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>aS(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>a$(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=mp(s,!1).getAll();return new _u(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),o$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}B5.type="LOCAL";const c$=B5;new Mu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(t,e){return e?qs(e):(qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py extends M5{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return tl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return tl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function u$(t){return VU(t.auth,new py(t),t.bypassAuthState)}function d$(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),$U(n,new py(t),t.bypassAuthState)}async function f$(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),UU(n,new py(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e,n,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u$;case"linkViaPopup":case"linkViaRedirect":return f$;case"reauthViaPopup":case"reauthViaRedirect":return d$;default:fs(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$=new Mu(2e3,1e4);async function p$(t,e,n){if(as(t.app))return Promise.reject(Vr(t,"operation-not-supported-in-this-environment"));const r=Ou(t);lU(t,e,fy);const s=P5(r,n);return new za(r,"signInViaPopup",e,s).executeNotNull()}class za extends H5{constructor(e,n,r,s,a){super(e,n,s,a),this.provider=r,this.authWindow=null,this.pollId=null,za.currentPopupAction&&za.currentPopupAction.cancel(),za.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=hy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,za.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,h$.get())};e()}}za.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$="pendingRedirect",Ef=new Map;class g$ extends H5{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ef.get(this.auth._key());if(!e){try{const r=await x$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ef.set(this.auth._key(),e)}return this.bypassAuthState||Ef.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x$(t,e){const n=v$(e),r=y$(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function b$(t,e){Ef.set(t._key(),e)}function y$(t){return qs(t._redirectPersistence)}function v$(t){return Sf(m$,t.config.apiKey,t.name)}async function w$(t,e){return await Ou(t)._initializationPromise,F5(t,e,!1)}async function F5(t,e,n=!1){if(as(t.app))return Promise.reject(qa(t));const r=Ou(t),s=P5(r,e),l=await new g$(r,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$=600*1e3;class C${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S$(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!U5(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Vr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=k$&&this.cachedEventUids.clear(),this.cachedEventUids.has(lS(e))}saveEventToCache(e){this.cachedEventUids.add(lS(e)),this.lastProcessedEventTime=Date.now()}}function lS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function U5({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function S$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return U5(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E$(t,e={}){return wl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,T$=/^https?/;async function A$(t){if(t.config.emulator)return;const{authorizedDomains:e}=await E$(t);for(const n of e)try{if(M$(n))return}catch{}fs(t,"unauthorized-domain")}function M$(t){const e=Wx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!T$.test(n))return!1;if(N$.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O$=new Mu(3e4,6e4);function cS(){const t=ls().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function j$(t){return new Promise((e,n)=>{var s,a,l;function r(){cS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cS(),n(Vr(t,"network-request-failed"))},timeout:O$.get()})}if((a=(s=ls().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=ls().gapi)!=null&&l.load)r();else{const c=LU("iframefcb");return ls()[c]=()=>{gapi.load?r():n(Vr(t,"network-request-failed"))},RU(`${DU()}?onload=${c}`).catch(d=>n(d))}}).catch(e=>{throw Nf=null,e})}let Nf=null;function _$(t){return Nf=Nf||j$(t),Nf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R$=new Mu(5e3,15e3),D$="__/auth/iframe",L$="emulator/auth/iframe",I$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function B$(t){const e=t.config;qe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?oy(e,L$):`https://${t.config.authDomain}/${D$}`,r={apiKey:e.apiKey,appName:t.name,v:Au},s=z$.get(t.config.apiHost);s&&(r.eid=s);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${Tu(r).slice(1)}`}async function P$(t){const e=await _$(t),n=ls().gapi;return qe(n,t,"internal-error"),e.open({where:document.body,url:B$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I$,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=Vr(t,"network-request-failed"),c=ls().setTimeout(()=>{a(l)},R$.get());function d(){ls().clearTimeout(c),s(r)}r.ping(d).then(d,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},F$=500,U$=600,$$="_blank",V$="http://localhost";class uS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function q$(t,e,n,r=F$,s=U$){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const d={...H$,width:r.toString(),height:s.toString(),top:a,left:l},p=qn().toLowerCase();n&&(c=w5(p)?$$:n),y5(p)&&(e=e||V$,d.scrollbars="yes");const m=Object.entries(d).reduce((b,[v,w])=>`${b}${v}=${w},`,"");if(EU(p)&&c!=="_self")return W$(e||"",c),new uS(null);const g=window.open(e||"",c,m);qe(g,t,"popup-blocked");try{g.focus()}catch{}return new uS(g)}function W$(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$="__/auth/handler",G$="emulator/auth/handler",Y$=encodeURIComponent("fac");async function dS(t,e,n,r,s,a){qe(t.config.authDomain,t,"auth-domain-config-required"),qe(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Au,eventId:s};if(e instanceof fy){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",KH(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))l[m]=g}if(e instanceof ju){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(l.scopes=m.join(","))}t.tenantId&&(l.tid=t.tenantId);const c=l;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await t._getAppCheckToken(),p=d?`#${Y$}=${encodeURIComponent(d)}`:"";return`${J$(t)}?${Tu(c).slice(1)}${p}`}function J$({config:t}){return t.emulator?oy(t,G$):`https://${t.authDomain}/${K$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0="webStorageSupport";class X${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D5,this._completeRedirectFn=F5,this._overrideRedirectResult=b$}async _openPopup(e,n,r,s){var l;Zs((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await dS(e,n,r,Wx(),s);return q$(e,a,hy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const a=await dS(e,n,r,Wx(),s);return e$(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:a}=this.eventManagers[n];return s?Promise.resolve(s):(Zs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await P$(e),r=new C$(e);return n.register("authEvent",s=>(qe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(S0,{type:S0},s=>{var l;const a=(l=s==null?void 0:s[0])==null?void 0:l[S0];a!==void 0&&n(!!a),fs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=A$(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return N5()||v5()||uy()}}const Q$=X$;var fS="@firebase/auth",hS="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tV(t){du(new pl("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=r.options;qe(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:l,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T5(t)},p=new jU(r,s,a,d);return zU(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),du(new pl("auth-internal",e=>{const n=Ou(e.getProvider("auth").getImmediate());return(r=>new Z$(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qo(fS,hS,eV(t)),Qo(fS,hS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV=300,rV=s5("authIdTokenMaxAge")||nV;let pS=null;const sV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>rV)return;const s=n==null?void 0:n.token;pS!==s&&(pS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function my(t=YF()){const e=l5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=IU(t,{popupRedirectResolver:Q$,persistence:[c$,XU,D5]}),r=s5("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=sV(a.toString());WU(n,l,()=>l(n.currentUser)),qU(n,c=>l(c))}}const s=jH("auth");return s&&BU(n,`http://${s}`),n}function iV(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}_U({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const a=Vr("internal-error");a.customData=s,n(a)},r.type="text/javascript",r.charset="UTF-8",iV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tV("Browser");const aV=new Set(["localhost","127.0.0.1"]),oV="http://localhost:8000",lV="https://api.tomehub.nl",cV="https://api.tomehub.nl".trim(),uV=aV.has(window.location.hostname)?oV:lV,Xe=(cV||uV).replace(/\/+$/,""),dV="Backend baglantisi kurulamadi. `apps/backend` klasorunde `python app.py` calistirin (port 8000).";async function fV(){const{auth:t}=await Gc(async()=>{const{auth:n}=await Promise.resolve().then(()=>wV);return{auth:n}},void 0),e=t.currentUser;if(!e)throw new Error("Oturum dogrulamasi bulunamadi. Lutfen tekrar giris yapin.");return e.getIdToken()}async function At(t,e={}){const n=await fV(),r=new Headers(e.headers||{});return r.has("Authorization")||r.set("Authorization",`Bearer ${n}`),fetch(t,{...e,headers:r})}async function Kr(t,e){try{const n=await t.json(),r=(n==null?void 0:n.detail)||(n==null?void 0:n.details)||(n==null?void 0:n.error);if(typeof r=="string"&&r.trim())return r}catch{}return e}function Go(t){return t instanceof TypeError&&/fetch/i.test(t.message)?`${dV} (API: ${Xe})`:t instanceof Error&&t.message?t.message:"Beklenmeyen API hatasi"}const kl=async()=>{const e=my().currentUser;return e?await e.getIdToken():""},zh=t=>{const e=(t||"").toLowerCase().trim();if(e==="tr"||e==="turkish"||e==="turkce"||e==="trke")return"tr";if(e==="en"||e==="english"||e==="ingilizce")return"en"},gp=t=>({title:t.title,author:t.author,publisher:t.publisher,isbn:t.isbn,translator:t.translator,tags:t.tags,summary:t.summaryText||t.generalNotes||t.summary||"",publishedDate:t.publicationYear?String(t.publicationYear):t.publishedDate||"",url:t.url,coverUrl:t.coverUrl??null,pageCount:t.pageCount||void 0,contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved,sourceLanguageHint:zh(t.sourceLanguageHint)}),xp=(t,e)=>{const n=(e.content_language_resolved||e.contentLanguageResolved||"").toString().toLowerCase(),r=n==="tr"||n==="en"?n:t.contentLanguageResolved,s=Number(e.language_decision_confidence??e.languageDecisionConfidence??t.languageDecisionConfidence??NaN),a=Number.isFinite(s)?s:t.languageDecisionConfidence;return{...t,summaryText:e.summary&&e.summary.trim().length>0?e.summary:t.summaryText,tags:e.tags&&e.tags.length>0?e.tags:t.tags,publisher:e.publisher||t.publisher,isbn:e.isbn||t.isbn,author:e.author||t.author,translator:e.translator||t.translator,publicationYear:e.publishedDate?String(Number(e.publishedDate)||t.publicationYear||""):t.publicationYear,coverUrl:e.coverUrl??t.coverUrl,pageCount:e.pageCount||t.pageCount||void 0,contentLanguageMode:e.contentLanguageMode||t.contentLanguageMode||"AUTO",contentLanguageResolved:r,sourceLanguageHint:zh(e.sourceLanguageHint||t.sourceLanguageHint),languageDecisionReason:e.language_decision_reason||e.languageDecisionReason||t.languageDecisionReason,languageDecisionConfidence:a}},hV=async t=>{if(!t.trim())return[];const e=[];try{const n=`https://api.crossref.org/works?query=${encodeURIComponent(t)}&rows=5&select=title,author,publisher,published,DOI,abstract,URL`,s=await fetch(n).then(a=>a.ok?a.json():null).then(a=>{var l;return(l=a==null?void 0:a.message)!=null&&l.items?a.message.items.map(c=>{var d,p,m,g,b,v,w,C,k;return{title:Array.isArray(c.title)?c.title[0]:c.title||"",author:(p=(d=c.author)==null?void 0:d[0])!=null&&p.family?`${c.author[0].given||""} ${c.author[0].family}`.trim():((g=(m=c.author)==null?void 0:m[0])==null?void 0:g.name)||"Unknown",publisher:c.publisher||((b=c["container-title"])==null?void 0:b[0])||"",isbn:"",translator:"",tags:c.subject||[],summary:c.abstract||`DOI: ${c.DOI||""}`,publishedDate:((k=(C=(w=(v=c.published)==null?void 0:v["date-parts"])==null?void 0:w[0])==null?void 0:C[0])==null?void 0:k.toString())||"",url:c.URL||(c.DOI?`https://doi.org/${c.DOI}`:""),coverUrl:null}}):[]}).catch(()=>[]);return e.push(...s),e}catch(n){return console.error("Article search error:",n),[]}},$5=async(t,e)=>{const n=t.trim();if(!n)return[];if(e==="BOOK"){const{searchBooks:r}=await Gc(async()=>{const{searchBooks:a}=await import("./bookSearchService-CDC4-bV9.js");return{searchBooks:a}},[]),s=await r(n);if(s.results.length>0)return console.log(` Results from bookSearchService (${s.source}, cached: ${s.cached})`),s.results}if(e==="ARTICLE"){const r=await hV(n);if(r.length>0)return console.log(" Results from CrossRef (fast)"),r}try{const r=await kl(),s=await fetch(`${Xe}/api/ai/search-resources`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({query:n,type:e})});if(!s.ok){const l=await s.json();throw new Error(l.detail||"Search failed")}return(await s.json()).results.map(l=>({...l,coverUrl:null,sourceLanguageHint:zh(l.sourceLanguageHint||l.source_language_hint),contentLanguageResolved:zh(l.contentLanguageResolved||l.content_language_resolved)}))}catch(r){return console.error("Error searching with Gemini (Backend):",r),[]}},V5=async t=>{if(t.length===0)return null;try{const e=await kl(),n=await fetch(`${Xe}/api/ai/analyze-highlights`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({highlights:t})});return n.ok&&(await n.json()).summary||null}catch(e){return console.error("Gemini error (Backend):",e),null}},gy=async t=>{if(!t)return[];try{const e=await kl(),n=await fetch(`${Xe}/api/ai/generate-tags`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({note_content:t})});return n.ok?(await n.json()).tags||[]:[]}catch(e){return console.error("Gemini tag generation error (Backend):",e),[]}},E0=async(t,e)=>{var l,c;const n=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${t}&maxResults=1`,{signal:e});if(!n.ok)throw new Error(`Google Books Error: ${n.status}`);const s=(l=(await n.json()).items)==null?void 0:l[0],a=(c=s==null?void 0:s.volumeInfo)==null?void 0:c.imageLinks;if(a!=null&&a.thumbnail||a!=null&&a.smallThumbnail){let d=a.thumbnail||a.smallThumbnail;return d=d.replace(/^http:\/\//i,"https://").replace("&edge=curl",""),d}throw new Error("No cover in Google Books result")},pV=async(t,e,n,r)=>{var c;if(n){const p=`https://covers.openlibrary.org/b/isbn/${n.replace(/[^0-9X]/gi,"")}-L.jpg`;if((await fetch(p,{method:"HEAD",signal:r})).ok)return console.log(" Cover found via OpenLibrary ISBN"),p}const s=e?`${t} ${e}`:t,a=`https://openlibrary.org/search.json?q=${encodeURIComponent(s)}&limit=1`,l=await fetch(a,{signal:r});if(l.ok){const p=(c=(await l.json()).docs)==null?void 0:c[0];if(p!=null&&p.cover_i){const m=`https://covers.openlibrary.org/b/id/${p.cover_i}-L.jpg`;return console.log(" Cover found via OpenLibrary search"),m}}throw new Error("No cover found in OpenLibrary")},mV=async(t,e,n)=>{try{const r=await kl(),s=new AbortController,a=setTimeout(()=>s.abort(),3e4),l=await fetch(`${Xe}/api/ai/verify-cover`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({title:t,author:e,isbn:n}),signal:s.signal});return clearTimeout(a),l.ok&&(await l.json()).url||null}catch(r){return r.name==="AbortError"?console.warn("AI Cover Verification timed out"):console.error("AI cover verification error (Backend):",r),null}},gV=async(t,e,n)=>{const r=n?n.replace(/[^0-9X]/gi,""):"",s=new AbortController,a=s.signal,l=[];if(r&&l.push(E0(`isbn:${r}`,a)),t&&e){const c=`intitle:${encodeURIComponent(t)}+inauthor:${encodeURIComponent(e)}`;l.push(E0(c,a))}l.push(pV(t,e,r,a)),t&&!e&&l.push(E0(`intitle:${encodeURIComponent(t)}`,a));try{const c=await Promise.any(l);return s.abort(),c}catch{console.warn("Fast cover fetch failed (all sources). Falling back to AI...");const d=await mV(t,e,n);if(d)return console.log(" Cover found via AI verification"),d}return console.log(" No verified cover found"),null},xy=async(t,e)=>{if(!((e==null?void 0:e.forceRegenerate)||q5(t)))return t;try{const r=await kl(),s={...t,content_language_mode:t.contentLanguageMode||"AUTO",source_language_hint:t.sourceLanguageHint||void 0,force_regenerate:!!(e!=null&&e.forceRegenerate)},a=await fetch(`${Xe}/api/ai/enrich-book`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(s)});if(!a.ok){const c=await a.text();return console.error(`Enrichment failed with status ${a.status}: ${c}`),t}return await a.json()}catch(r){return console.error("Enrich error (Backend):",r),t}},q5=t=>{const e=!t.summary||t.summary.trim().length<40,n=!t.tags||t.tags.length<2,r=(t.contentLanguageMode||"AUTO").toUpperCase(),s=(t.contentLanguageResolved||"").toLowerCase(),a=r==="TR"&&s!=="tr"||r==="EN"&&s!=="en"||!!t.sourceLanguageHint&&!s;return e||n||a},W5=async t=>{if(t.length===0)return[];try{const e=await kl(),n=await fetch(`${Xe}/api/ai/enrich-batch`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({books:t})});if(!n.ok||!n.body)return console.error("Batch response failed"),t;const r=n.body.getReader(),s=new TextDecoder,a=[];let l="";for(;;){const{value:c,done:d}=await r.read();if(d)break;const p=s.decode(c,{stream:!0});l+=p;const m=l.split(`
`);l=m.pop()||"";for(const g of m)if(g.trim())try{const b=JSON.parse(g);a.push(b)}catch(b){console.error("Error parsing NDJSON line:",b)}}if(l.trim())try{const c=JSON.parse(l);a.push(c)}catch(c){console.error("Error parsing final buffer:",c)}return a.length>0?a:t}catch(e){return console.error("Batch enrich error (Backend):",e),t}},mS=Object.freeze(Object.defineProperty({__proto__:null,analyzeHighlightsAI:V5,enrichBookWithAI:xy,enrichBooksBatch:W5,fetchBookCover:gV,generateTagsForNote:gy,libraryItemToDraft:gp,mergeEnrichedDraftIntoItem:xp,needsBookEnrichment:q5,searchResourcesAI:$5},Symbol.toStringTag,{value:"Module"}));var xV="firebase",bV="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qo(xV,bV,"app");const yV={apiKey:"AIzaSyDwvjdmQGhwIgAKgaVmOkOnFdMgzaJ4heA",authDomain:"tomehub.firebaseapp.com",projectId:"tomehub",storageBucket:"tomehub.firebasestorage.app",messagingSenderId:"407093539608",appId:"1:407093539608:web:dfd1e04346b49060d2246d"},vV=c5(yV),Mc=my(vV),K5=new Hs,wV=Object.freeze(Object.defineProperty({__proto__:null,auth:Mc,googleProvider:K5},Symbol.toStringTag,{value:"Module"})),G5=E.createContext(void 0),kV=({children:t})=>{const[e,n]=E.useState(null),[r,s]=E.useState(!0);E.useEffect(()=>{w$(Mc).then(p=>{p&&console.log("Successfully signed in with redirect")}).catch(p=>{console.error("Redirect login error:",p)});const d=KU(Mc,p=>{n(p),s(!1)});return()=>d()},[]);const c={user:e,loading:r,loginWithGoogle:async()=>{try{await p$(Mc,K5)}catch(d){console.error("Login with Google failed:",d),d.code==="auth/popup-blocked"?alert("Giri penceresi engellendi. Ltfen Safari veya Chrome gibi bir taraycda an veya pop-uplara izin verin."):d.code==="auth/cancelled-popup-request"||alert("Giri hatas: "+(d.message||"Bilinmeyen bir hata olutu."))}},logout:async()=>{await GU(Mc)}};return h.jsx(G5.Provider,{value:c,children:t})},bp=()=>{const t=E.useContext(G5);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},Y5=t=>{const e=(t||"").trim().toUpperCase();return e==="NOTE"||e==="PERSONAL"?"PERSONAL_NOTE":e==="NOTES"?"HIGHLIGHT":e==="INSIGHTS"?"INSIGHT":e||"PERSONAL_NOTE"};async function CV(t,e,n="STANDARD",r,s="AUTO",a){if(!e)throw new Error("User must be authenticated to search");const l=await At(`${Xe}/api/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,firebase_uid:e,mode:n,book_id:r,context_book_id:a,scope_mode:s})});if(!l.ok){const c=await l.json();throw new Error(c.details||c.error||"Search failed")}return l.json()}async function SV(t,e,n=null,r="EXPLORER",s=null,a=20,l="AUTO",c=null,d=null){if(!e)throw new Error("User must be authenticated to chat");const p=await At(`${Xe}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,firebase_uid:e,session_id:n,mode:r,resource_type:s,scope_mode:l,book_id:c,context_book_id:d,limit:a})});if(!p.ok){const m=await p.json();throw new Error(m.details||m.error||"Chat failed")}return p.json()}async function J5(t,e,n,r,s,a){if(!r)throw new Error("User must be authenticated to ingest documents");const l=new FormData;l.append("file",t),l.append("title",e),l.append("author",n),l.append("firebase_uid",r),s&&l.append("book_id",s),a&&l.append("tags",a);const c=await At(`${Xe}/api/ingest`,{method:"POST",body:l});if(!c.ok){const d=await c.json();throw new Error(d.details||d.error||"Ingestion failed")}return c.json()}async function EV(t){const e=await At(`${Xe}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.details||n.error||"Feedback failed")}return e.json()}async function NV(t,e,n){if(!e)throw new Error("User must be authenticated to fetch ingestion status");const r=new URLSearchParams;r.set("firebase_uid",e),n&&n.trim()&&r.set("title",n.trim());const s=await At(`${Xe}/api/books/${encodeURIComponent(t)}/ingestion-status?${r.toString()}`,{method:"GET",headers:{"Content-Type":"application/json","X-Firebase-UID":e}});if(!s.ok){const a=await s.json();throw new Error(a.details||a.error||"Failed to fetch ingestion status")}return s.json()}async function TV(t){const e=new FormData;e.append("file",t);const n=await At(`${Xe}/api/extract-metadata`,{method:"POST",body:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Metadata extraction failed")}return n.json()}async function X5(t,e,n,r,s,a){const l=Y5(r),c=await At(`${Xe}/api/add-item`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,title:e,author:n,type:l,firebase_uid:s,...a})});if(!c.ok)throw new Error("Failed to add item");return c.json()}async function AV(t,e){const n=t.map(s=>({...s,type:Y5(s.type)})),r=await At(`${Xe}/api/migrate_bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n,firebase_uid:e})});if(!r.ok)throw new Error("Failed to migrate batch");return r.json()}async function Q5(t,e,n,r,s){const a=s.map(c=>({...c,type:Yh(c.type)})),l=await At(`${Xe}/api/books/${encodeURIComponent(e)}/sync-highlights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,title:n,author:r,highlights:a})});if(!l.ok)throw new Error("Failed to sync highlights");return l.json()}async function MV(t,e,n){const r=await At(`${Xe}/api/notes/${encodeURIComponent(e)}/sync-personal-note`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,...n})});if(!r.ok)throw new Error("Failed to sync personal note");return r.json()}async function gS(t,e){const n=await At(`${Xe}/api/resources/${encodeURIComponent(e)}/purge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t})});if(!n.ok)throw new Error("Failed to purge resource content");return n.json()}async function OV(t,e,n,r=50,s=0){const a=new URL(`${Xe}/api/analytics/concordance`);a.searchParams.append("book_id",e),a.searchParams.append("term",n),a.searchParams.append("limit",r.toString()),a.searchParams.append("offset",s.toString()),a.searchParams.append("firebase_uid",t);const l=await At(a.toString(),{headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error("Failed to fetch concordance");return l.json()}async function jV(t,e,n){const r=new URL(`${Xe}/api/analytics/distribution`);r.searchParams.append("book_id",e),r.searchParams.append("term",n),r.searchParams.append("firebase_uid",t);const s=await At(r.toString(),{headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch distribution");return s.json()}async function Yq(t,e,n=250){const r=new URL(`${Xe}/api/analytics/epistemic-distribution`);r.searchParams.append("firebase_uid",t),r.searchParams.append("limit",String(n));const s=await At(r.toString(),{headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch epistemic distribution");return s.json()}async function _V(t,e=0,n=100){if(!t)throw new Error("User must be authenticated for realtime polling");const r=new URL(`${Xe}/api/realtime/poll`);r.searchParams.append("firebase_uid",t),r.searchParams.append("since_ms",String(Math.max(0,Math.floor(e||0)))),r.searchParams.append("limit",String(Math.min(300,Math.max(1,Math.floor(n||100)))));const s=await At(r.toString(),{headers:{"Content-Type":"application/json"}});if(!s.ok){const a=await s.json();throw new Error(a.details||a.error||"Realtime polling failed")}return s.json()}const RV=({initialData:t,initialType:e,noteDefaults:n,onSave:r,onCancel:s})=>{const[a,l]=E.useState(t||e==="WEBSITE"||e==="PERSONAL_NOTE"?"edit":"search"),[c,d]=E.useState(""),[p,m]=E.useState([]),[g,b]=E.useState(!1),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(!1),[_,P]=E.useState(!1),[z,K]=E.useState(!1),[O,F]=E.useState(null),{user:V}=bp(),[Z,he]=E.useState({title:"",author:"",translator:"",publisher:"",publicationYear:"",isbn:"",url:"",code:"",status:"On Shelf",readingStatus:"To Read",tags:"",generalNotes:"",summaryText:"",coverUrl:"",lentToName:"",lentDate:"",addedAt:new Date().toISOString().split("T")[0],pageCount:"",contentLanguageMode:"AUTO",contentLanguageResolved:"",sourceLanguageHint:"",personalNoteCategory:"DAILY",personalFolderId:"",folderPath:""});E.useEffect(()=>{var L,ae,U;t?he({title:t.title,author:t.author,translator:t.translator||"",publisher:t.publisher||"",publicationYear:t.publicationYear||"",isbn:t.isbn||"",url:t.url||"",code:t.code||"",status:t.status,readingStatus:t.readingStatus,tags:t.tags.join(", "),generalNotes:t.generalNotes||"",summaryText:t.summaryText||"",coverUrl:t.coverUrl||"",lentToName:((L=t.lentInfo)==null?void 0:L.borrowerName)||"",lentDate:((ae=t.lentInfo)==null?void 0:ae.lentDate)||"",addedAt:new Date(t.addedAt).toISOString().split("T")[0],pageCount:((U=t.pageCount)==null?void 0:U.toString())||"",contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved||"",sourceLanguageHint:t.sourceLanguageHint||"",personalNoteCategory:t.personalNoteCategory||"DAILY",personalFolderId:t.personalFolderId||"",folderPath:t.folderPath||""}):e==="PERSONAL_NOTE"&&he(ne=>({...ne,author:"Self",status:"On Shelf",readingStatus:"Finished",personalNoteCategory:(n==null?void 0:n.personalNoteCategory)||"DAILY",personalFolderId:(n==null?void 0:n.personalFolderId)||"",folderPath:(n==null?void 0:n.folderPath)||""}))},[t,e,n]);const Te=async L=>{if(L.preventDefault(),!!c.trim()){b(!0),m([]);try{const ae=await $5(c,e);m(ae),e==="BOOK"&&console.log(` Search completed for book: "${c}"`)}catch(ae){console.error("Search failed:",ae)}finally{b(!1)}}},ve=async()=>{const L=Wa(Z.generalNotes);if(!L)return;M(!0);const ae=await gy(L);ae.length>0&&he(U=>({...U,tags:ae.join(", ")})),M(!1)},Se=async(L,ae,U)=>{w(!0);try{const{fetchBookCover:ne}=await Gc(async()=>{const{fetchBookCover:je}=await Promise.resolve().then(()=>mS);return{fetchBookCover:je}},void 0),ie=await ne(L,ae,U);ie&&he(je=>({...je,coverUrl:ie}))}catch(ne){console.error("Cover fetch failed:",ne)}finally{w(!1)}},Ee=async(L,ae=!1)=>{k(!0);try{const{enrichBookWithAI:U}=await Gc(async()=>{const{enrichBookWithAI:ie}=await Promise.resolve().then(()=>mS);return{enrichBookWithAI:ie}},void 0),ne=await U({...L,contentLanguageMode:Z.contentLanguageMode,sourceLanguageHint:Z.sourceLanguageHint||L.sourceLanguageHint},{forceRegenerate:ae});he(ie=>({...ie,tags:ne.tags&&ne.tags.length>0?ne.tags.join(", "):ie.tags,summaryText:ne.summary&&ne.summary.length>0?ne.summary:ie.summaryText,publisher:ne.publisher||ie.publisher,publicationYear:ne.publishedDate?String(ne.publishedDate):ie.publicationYear,isbn:ne.isbn||ie.isbn,pageCount:ne.pageCount?String(ne.pageCount):ie.pageCount,translator:ne.translator||ie.translator,contentLanguageResolved:ne.content_language_resolved||ne.contentLanguageResolved||ie.contentLanguageResolved||""}))}catch(U){console.error("Enrichment failed",U)}finally{k(!1)}},q=async L=>{he(ae=>{var U;return{...ae,title:L.title,author:L.author,publisher:L.publisher||"",isbn:L.isbn||"",publicationYear:L.publishedDate||"",translator:L.translator||"",tags:L.tags?L.tags.join(", "):"",summaryText:L.summary||"",coverUrl:L.coverUrl||"",url:(e==="WEBSITE"||e==="ARTICLE")&&L.url||"",pageCount:((U=L.pageCount)==null?void 0:U.toString())||"",contentLanguageMode:L.contentLanguageMode||Z.contentLanguageMode||"AUTO",contentLanguageResolved:(L.contentLanguageResolved||"").toLowerCase()==="tr"?"tr":(L.contentLanguageResolved||"").toLowerCase()==="en"?"en":"",sourceLanguageHint:(L.sourceLanguageHint||"").toLowerCase()==="tr"?"tr":(L.sourceLanguageHint||"").toLowerCase()==="en"?"en":""}}),l("edit"),e==="BOOK"&&(Se(L.title,L.author,L.isbn||""),(!L.summary||!L.tags||L.tags.length===0||L.sourceLanguageHint)&&Ee(L))},te=L=>{const{name:ae,value:U}=L.target;he(ne=>ae==="contentLanguageMode"?{...ne,[ae]:U,contentLanguageResolved:""}:{...ne,[ae]:U})},G=async L=>{if(L.target.files&&L.target.files[0]){const ae=L.target.files[0];if(ae.type==="application/pdf"){F(ae),K(!0);try{const U=await TV(ae);he(ne=>{var ie;return{...ne,title:ne.title||U.title||"",author:ne.author||U.author||"",pageCount:ne.pageCount||((ie=U.page_count)==null?void 0:ie.toString())||""}}),!Z.title&&U.title&&e==="BOOK"&&!Z.coverUrl&&Se(U.title,U.author||"","")}catch(U){console.error("Failed to extract PDF metadata:",U)}finally{K(!1)}}else alert("Please select a PDF file"),L.target.value=""}},I=async L=>{L.preventDefault();const ae=t?t.id:Date.now().toString();if(O&&V){P(!0);try{await J5(O,Z.title,Z.author,V.uid,ae,Z.tags)}catch(ie){console.error("PDF Ingestion failed:",ie)}finally{P(!1)}}const U=e==="BOOK"&&Z.status==="Lent Out"&&Z.lentToName?{borrowerName:Z.lentToName,lentDate:Z.lentDate||new Date().toISOString().split("T")[0]}:void 0,ne=Z.addedAt?new Date(Z.addedAt).getTime():Date.now();r({id:ae,type:e,title:Z.title,author:Z.author,translator:Z.translator,publisher:Z.publisher,publicationYear:Z.publicationYear,isbn:Z.isbn,url:e==="WEBSITE"||e==="ARTICLE"?Z.url:"",code:Z.code,status:Z.status,readingStatus:Z.readingStatus,tags:Z.tags.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0),generalNotes:R?Z.generalNotes:"",summaryText:R?"":Z.summaryText,contentLanguageMode:Z.contentLanguageMode,contentLanguageResolved:Z.contentLanguageResolved||void 0,sourceLanguageHint:Z.sourceLanguageHint||void 0,personalNoteCategory:R?Z.personalNoteCategory:void 0,personalFolderId:R&&Z.personalFolderId.trim()||void 0,folderPath:R&&Z.folderPath.trim()||void 0,coverUrl:Z.coverUrl,lentInfo:U,addedAt:ne,pageCount:Z.pageCount?parseInt(Z.pageCount):void 0})},H=()=>{switch(e){case"ARTICLE":return h.jsx(xu,{className:"text-[#CC561E]",size:24});case"WEBSITE":return h.jsx($h,{className:"text-[#CC561E]",size:24});case"PERSONAL_NOTE":return h.jsx(Mf,{className:"text-[#CC561E]",size:24});default:return h.jsx(nb,{className:"text-[#CC561E]",size:24})}},A=()=>{if(t)return"Edit Details";switch(e){case"ARTICLE":return"New Article";case"WEBSITE":return"New Website Resource";case"PERSONAL_NOTE":return"New Note";default:return"New Book"}},R=e==="PERSONAL_NOTE",W=R?"text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300",oe=R?"text-slate-800 dark:text-slate-200":"text-slate-700 dark:text-slate-300",xe=R?"text-slate-700 dark:text-slate-400":"text-slate-500 dark:text-slate-400";return h.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full overflow-hidden flex flex-col ${R?"max-w-3xl max-h-[94vh]":"max-w-2xl max-h-[90vh]"}`,children:[h.jsxs("div",{className:`${R?"p-4":"p-5"} border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white dark:bg-slate-900 z-10`,children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:a==="search"?h.jsxs(h.Fragment,{children:[h.jsx(Us,{className:"text-[#CC561E]",size:24}),"Find ",e==="ARTICLE"?"Article":"Book"]}):h.jsxs(h.Fragment,{children:[H(),A()]})}),h.jsx("button",{onClick:s,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:h.jsx(cs,{size:24})})]}),a==="search"&&h.jsxs("div",{className:"p-6 flex flex-col h-full overflow-y-auto",children:[h.jsxs("form",{onSubmit:Te,className:"relative mb-4",children:[h.jsx("input",{autoFocus:!0,type:"text",value:c,onChange:L=>d(L.target.value),placeholder:e==="ARTICLE"?"Enter Title, DOI, Author...":"Enter Title, ISBN, Author...",className:"w-full pl-5 pr-14 py-4 text-lg border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:border-[#CC561E] dark:focus:border-[#CC561E] focus:ring-4 focus:ring-[#CC561E]/10 outline-none transition-all placeholder:text-slate-400 dark:placeholder:text-slate-500 bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),h.jsx("button",{type:"submit",disabled:g||!c.trim(),className:"absolute right-3 top-1/2 -translate-y-1/2 bg-[#CC561E] text-white p-2 rounded-lg hover:bg-[#b34b1a] disabled:opacity-50 disabled:hover:bg-[#CC561E] transition-colors",children:g?h.jsx(Jt,{className:"animate-spin",size:20}):h.jsx(Us,{size:20})})]}),h.jsx("div",{className:"space-y-3 flex-1 mt-6",children:p.length>0?h.jsxs(h.Fragment,{children:[h.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"Matches Found"}),p.map((L,ae)=>h.jsxs("button",{onClick:()=>q(L),className:"w-full text-left p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 dark:hover:border-[#CC561E]/50 hover:shadow-md hover:bg-[rgba(204,86,30,0.05)] dark:hover:bg-[rgba(204,86,30,0.1)] transition-all group flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:L.title}),h.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:L.author}),h.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-slate-400",children:[L.publisher&&h.jsx("span",{children:L.publisher}),L.publishedDate&&h.jsx("span",{children:L.publishedDate}),L.isbn&&h.jsxs("span",{className:"font-mono tracking-tight",children:["ISBN: ",L.isbn]})]})]}),h.jsx(uE,{className:"text-slate-300 dark:text-slate-600 group-hover:text-[#CC561E]",size:20})]},ae))]}):!g&&c&&h.jsxs("div",{className:"text-center py-10 text-slate-500",children:[h.jsxs("p",{children:['No AI results found matching "',c,'".']}),h.jsx("p",{className:"text-sm mt-2",children:"Try entering details manually."})]})}),h.jsx("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:h.jsxs("button",{onClick:()=>l("edit"),className:"text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] text-sm font-medium flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[h.jsx("span",{children:"Don't see it? Enter details manually"}),h.jsx(J3,{size:16})]})})]}),a==="edit"&&h.jsxs("form",{onSubmit:I,className:`${R?"p-4 md:p-5":"p-6"} overflow-y-auto flex-1`,children:[h.jsxs("div",{className:R?"space-y-3":"space-y-5",children:[h.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${R?"gap-3":"gap-4"}`,children:[h.jsxs("div",{className:"md:col-span-2",children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Title *"}),h.jsx("input",{required:!0,name:"title",value:Z.title,onChange:te,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${R?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:R?"Note Title":e==="WEBSITE"?"Page Title or Site Name":"e.g. The Stranger"})]}),!R&&h.jsxs("div",{className:e==="WEBSITE"?"md:col-span-2":"",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="WEBSITE"?"Author / Organization":"Author *"}),h.jsx("input",{required:e!=="WEBSITE",name:"author",value:Z.author,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Albert Camus"})]}),R&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:[h.jsxs("label",{className:`block text-[13px] font-medium mb-1 flex items-center gap-1 ${oe}`,children:[h.jsx(nl,{size:14,className:"text-slate-400"}),"Date"]}),h.jsx("input",{type:"date",name:"addedAt",value:Z.addedAt,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:`block text-[13px] font-medium mb-1 ${oe}`,children:"Category"}),h.jsxs("select",{name:"personalNoteCategory",value:Z.personalNoteCategory,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"PRIVATE",children:"Private"}),h.jsx("option",{value:"DAILY",children:"Daily"}),h.jsx("option",{value:"IDEAS",children:"Ideas"})]}),h.jsx("p",{className:`mt-0.5 text-[10px] leading-tight ${xe}`,children:"Private/Daily sadece local aramada kalir. Ideas AI aramalara da katilir."})]})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Translator"}),h.jsx("input",{name:"translator",value:Z.translator,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Content Language"}),h.jsxs("select",{name:"contentLanguageMode",value:Z.contentLanguageMode,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"AUTO",children:"AUTO (Recommended)"}),h.jsx("option",{value:"TR",children:"TR"}),h.jsx("option",{value:"EN",children:"EN"})]}),(Z.contentLanguageResolved||Z.sourceLanguageHint)&&h.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:["Resolved: ",Z.contentLanguageResolved||"-"," | Source Hint: ",Z.sourceLanguageHint||"-"]})]})]}),!R&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e!=="WEBSITE"&&h.jsxs("div",{className:e==="ARTICLE"?"md:col-span-2":"",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="ARTICLE"?"Journal / Publisher":"Publisher"}),h.jsx("input",{name:"publisher",value:Z.publisher,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ISBN"}),h.jsx("input",{name:"isbn",value:Z.isbn,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="ARTICLE"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Year"}),h.jsx("input",{name:"publicationYear",value:Z.publicationYear,onChange:te,placeholder:"YYYY",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Page Count"}),h.jsx("input",{type:"number",name:"pageCount",value:Z.pageCount,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. 250"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Shelf Code"}),h.jsx("input",{name:"code",value:Z.code,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. A-12"})]})]}),(e==="WEBSITE"||e==="ARTICLE")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"URL"}),h.jsx("input",{name:"url",value:Z.url,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-[#CC561E] dark:text-[#f3a47b] bg-white dark:bg-slate-950",placeholder:"https://..."})]}),R&&h.jsxs("div",{children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Sub-file (optional)"}),h.jsx("input",{name:"folderPath",value:Z.folderPath,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Sermon Ideas or Journal-2026-Week1"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(S2,{size:16}),"Cover Image URL"]})}),h.jsxs("div",{className:"flex gap-4 items-start",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx("input",{name:"coverUrl",value:Z.coverUrl,onChange:te,placeholder:"Paste image URL or Auto-Find ->",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg pl-3 pr-24 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-sm text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-950"}),h.jsxs("button",{type:"button",onClick:()=>Se(Z.title,Z.author,Z.isbn),disabled:v||!Z.title&&!Z.isbn,className:"absolute right-1 top-1 bottom-1 px-3 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] hover:bg-[rgba(204,86,30,0.15)] dark:hover:bg-[rgba(204,86,30,0.25)] text-[#CC561E] dark:text-[#f3a47b] rounded text-xs font-semibold flex items-center gap-1 transition-colors",title:"Auto-find cover based on Title/ISBN",children:[v?h.jsx(Jt,{size:14,className:"animate-spin"}):h.jsx(CR,{size:14}),"Auto-Find"]})]}),h.jsxs("div",{className:"w-16 h-20 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0 shadow-sm relative group",children:[Z.coverUrl?h.jsx("img",{src:Z.coverUrl,alt:"Preview",className:"w-full h-full object-cover",onError:L=>L.currentTarget.style.display="none"}):h.jsx(S2,{className:"text-slate-300",size:20}),v&&h.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center backdrop-blur-[1px]",children:h.jsx(Jt,{size:16,className:"animate-spin text-[#CC561E]"})}),!v&&!Z.coverUrl&&h.jsx("div",{className:"absolute inset-0 bg-black/5 hidden group-hover:flex items-center justify-center",children:h.jsx(Us,{size:12,className:"text-slate-500"})})]})]}),h.jsx("div",{className:"mt-1 flex justify-end",children:h.jsxs("a",{href:`https://www.google.com/search?tbm=isch&q=book+cover+${encodeURIComponent(Z.title+" "+Z.author)}`,target:"_blank",rel:"noreferrer",className:"text-xs text-slate-400 dark:text-slate-500 hover:text-[#CC561E] dark:hover:text-[#f3a47b] hover:underline flex items-center gap-1",children:["Manual Search on Google Images ",h.jsx(Us,{size:10})]})})]}),(e==="BOOK"||e==="ARTICLE")&&h.jsxs("div",{className:"bg-[rgba(204,86,30,0.05)] dark:bg-[rgba(204,86,30,0.1)] p-4 rounded-xl border border-[#CC561E]/10 dark:border-[#CC561E]/20",children:[h.jsxs("label",{className:"block text-sm font-semibold text-[#CC561E] dark:text-[#f3a47b] mb-2 flex items-center gap-2",children:[h.jsx(jf,{size:16}),"Upload PDF Document to Library"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:G,className:"flex-1 text-sm text-slate-600 dark:text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[#CC561E] file:text-white hover:file:bg-[#b34b1a] transition-all cursor-pointer"}),O&&h.jsx("button",{type:"button",onClick:()=>F(null),className:"text-red-500 hover:text-red-600 p-2",title:"Remove PDF",children:h.jsx(cs,{size:18})}),z&&h.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[#CC561E] font-medium animate-pulse",children:[h.jsx(Jt,{size:14,className:"animate-spin"}),"Verifying metadata..."]})]}),h.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-2",children:"PDF content will be vectorized and added to your searchable AI library."})]})]}),h.jsx("hr",{className:`${R?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),R&&h.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Content"}),h.jsx(QA,{value:Z.generalNotes,onChange:L=>he(ae=>({...ae,generalNotes:L})),minHeight:420}),h.jsx("p",{className:`mt-1 text-[10px] ${xe}`,children:"Toolbar supports heading, bold, underline, bullet list, numbered list and checklist."})]}),h.jsxs("div",{className:R?"space-y-3":"space-y-5",children:[!R&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Reading Status *"}),h.jsxs("select",{name:"readingStatus",value:Z.readingStatus,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"To Read",children:"To Read"}),h.jsx("option",{value:"Reading",children:"Reading"}),h.jsx("option",{value:"Finished",children:"Finished"})]})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Inventory Status *"}),h.jsxs("select",{name:"status",value:Z.status,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"On Shelf",children:"On Shelf"}),h.jsx("option",{value:"Lent Out",children:"Lent Out"}),h.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("label",{className:`block text-sm font-medium mb-1 flex justify-between ${W}`,children:[h.jsxs("div",{className:"flex items-center gap-2",children:["Tags (comma separated)",C&&h.jsxs("span",{className:"text-xs text-[#CC561E] animate-pulse flex items-center gap-1",children:[h.jsx(Ks,{size:10})," AI Enriching..."]})]}),R&&h.jsxs("button",{type:"button",onClick:ve,disabled:N||!Pf(Z.generalNotes),className:"text-xs text-[#CC561E] dark:text-[#f3a47b] hover:text-[#b34b1a] dark:hover:text-white flex items-center gap-1 disabled:opacity-50",children:[N?h.jsx(Jt,{size:12,className:"animate-spin"}):h.jsx(Ks,{size:12}),"AI Auto-Tag"]})]}),h.jsx("input",{name:"tags",value:Z.tags,onChange:te,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${R?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:R?"Use AI to generate tags...":"Ideas, Todo, Research"})]}),e==="BOOK"&&Z.status==="Lent Out"&&h.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 grid grid-cols-1 md:grid-cols-2 gap-4 animate-in slide-in-from-top-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Lent To (Name) *"}),h.jsx("input",{required:!0,name:"lentToName",value:Z.lentToName,onChange:te,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Date"}),h.jsx("input",{type:"date",name:"lentDate",value:Z.lentDate,onChange:te,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]})]})]}),h.jsx("hr",{className:`${R?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),!R&&h.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Summary"}),h.jsx("textarea",{name:"summaryText",rows:4,value:Z.summaryText,onChange:te,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] resize-none leading-relaxed flex-1 bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:e==="WEBSITE"?"Why did you save this website?":"Your thoughts..."})]}),h.jsxs("div",{className:`flex justify-between items-center ${R?"pt-1":"pt-2"} mt-auto`,children:[!t&&e!=="WEBSITE"&&!R&&h.jsx("button",{type:"button",onClick:()=>l("search"),className:"text-sm text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] underline decoration-[#CC561E]/30 dark:decoration-[#CC561E]/50 hover:decoration-[#CC561E] dark:hover:decoration-[#CC561E]",children:"Back to Search"}),h.jsxs("div",{className:"flex gap-3 ml-auto",children:[h.jsx("button",{type:"button",onClick:s,className:"px-5 py-2 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium",children:"Cancel"}),h.jsx("button",{type:"submit",disabled:_,className:"px-5 py-2 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg shadow-lg shadow-[#CC561E]/20 transition-all font-medium flex items-center gap-2 active:scale-95",children:_?h.jsxs(h.Fragment,{children:[h.jsx(Jt,{size:18,className:"animate-spin"}),"Ingesting PDF..."]}):h.jsxs(h.Fragment,{children:["Save ",e==="ARTICLE"?"Article":e==="WEBSITE"?"Website":e==="PERSONAL_NOTE"?"Note":"Book"]})})]})]})]})]})})};var N0={exports:{}},xS;function DV(){return xS||(xS=1,(function(t){var e=(function(n){var r=Object.prototype,s=r.hasOwnProperty,a=Object.defineProperty||function(I,H,A){I[H]=A.value},l,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",p=c.asyncIterator||"@@asyncIterator",m=c.toStringTag||"@@toStringTag";function g(I,H,A){return Object.defineProperty(I,H,{value:A,enumerable:!0,configurable:!0,writable:!0}),I[H]}try{g({},"")}catch{g=function(H,A,R){return H[A]=R}}function b(I,H,A,R){var W=H&&H.prototype instanceof _?H:_,oe=Object.create(W.prototype),xe=new q(R||[]);return a(oe,"_invoke",{value:Te(I,A,xe)}),oe}n.wrap=b;function v(I,H,A){try{return{type:"normal",arg:I.call(H,A)}}catch(R){return{type:"throw",arg:R}}}var w="suspendedStart",C="suspendedYield",k="executing",N="completed",M={};function _(){}function P(){}function z(){}var K={};g(K,d,function(){return this});var O=Object.getPrototypeOf,F=O&&O(O(te([])));F&&F!==r&&s.call(F,d)&&(K=F);var V=z.prototype=_.prototype=Object.create(K);P.prototype=z,a(V,"constructor",{value:z,configurable:!0}),a(z,"constructor",{value:P,configurable:!0}),P.displayName=g(z,m,"GeneratorFunction");function Z(I){["next","throw","return"].forEach(function(H){g(I,H,function(A){return this._invoke(H,A)})})}n.isGeneratorFunction=function(I){var H=typeof I=="function"&&I.constructor;return H?H===P||(H.displayName||H.name)==="GeneratorFunction":!1},n.mark=function(I){return Object.setPrototypeOf?Object.setPrototypeOf(I,z):(I.__proto__=z,g(I,m,"GeneratorFunction")),I.prototype=Object.create(V),I},n.awrap=function(I){return{__await:I}};function he(I,H){function A(oe,xe,L,ae){var U=v(I[oe],I,xe);if(U.type==="throw")ae(U.arg);else{var ne=U.arg,ie=ne.value;return ie&&typeof ie=="object"&&s.call(ie,"__await")?H.resolve(ie.__await).then(function(je){A("next",je,L,ae)},function(je){A("throw",je,L,ae)}):H.resolve(ie).then(function(je){ne.value=je,L(ne)},function(je){return A("throw",je,L,ae)})}}var R;function W(oe,xe){function L(){return new H(function(ae,U){A(oe,xe,ae,U)})}return R=R?R.then(L,L):L()}a(this,"_invoke",{value:W})}Z(he.prototype),g(he.prototype,p,function(){return this}),n.AsyncIterator=he,n.async=function(I,H,A,R,W){W===void 0&&(W=Promise);var oe=new he(b(I,H,A,R),W);return n.isGeneratorFunction(H)?oe:oe.next().then(function(xe){return xe.done?xe.value:oe.next()})};function Te(I,H,A){var R=w;return function(oe,xe){if(R===k)throw new Error("Generator is already running");if(R===N){if(oe==="throw")throw xe;return G()}for(A.method=oe,A.arg=xe;;){var L=A.delegate;if(L){var ae=ve(L,A);if(ae){if(ae===M)continue;return ae}}if(A.method==="next")A.sent=A._sent=A.arg;else if(A.method==="throw"){if(R===w)throw R=N,A.arg;A.dispatchException(A.arg)}else A.method==="return"&&A.abrupt("return",A.arg);R=k;var U=v(I,H,A);if(U.type==="normal"){if(R=A.done?N:C,U.arg===M)continue;return{value:U.arg,done:A.done}}else U.type==="throw"&&(R=N,A.method="throw",A.arg=U.arg)}}}function ve(I,H){var A=H.method,R=I.iterator[A];if(R===l)return H.delegate=null,A==="throw"&&I.iterator.return&&(H.method="return",H.arg=l,ve(I,H),H.method==="throw")||A!=="return"&&(H.method="throw",H.arg=new TypeError("The iterator does not provide a '"+A+"' method")),M;var W=v(R,I.iterator,H.arg);if(W.type==="throw")return H.method="throw",H.arg=W.arg,H.delegate=null,M;var oe=W.arg;if(!oe)return H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,M;if(oe.done)H[I.resultName]=oe.value,H.next=I.nextLoc,H.method!=="return"&&(H.method="next",H.arg=l);else return oe;return H.delegate=null,M}Z(V),g(V,m,"Generator"),g(V,d,function(){return this}),g(V,"toString",function(){return"[object Generator]"});function Se(I){var H={tryLoc:I[0]};1 in I&&(H.catchLoc=I[1]),2 in I&&(H.finallyLoc=I[2],H.afterLoc=I[3]),this.tryEntries.push(H)}function Ee(I){var H=I.completion||{};H.type="normal",delete H.arg,I.completion=H}function q(I){this.tryEntries=[{tryLoc:"root"}],I.forEach(Se,this),this.reset(!0)}n.keys=function(I){var H=Object(I),A=[];for(var R in H)A.push(R);return A.reverse(),function W(){for(;A.length;){var oe=A.pop();if(oe in H)return W.value=oe,W.done=!1,W}return W.done=!0,W}};function te(I){if(I){var H=I[d];if(H)return H.call(I);if(typeof I.next=="function")return I;if(!isNaN(I.length)){var A=-1,R=function W(){for(;++A<I.length;)if(s.call(I,A))return W.value=I[A],W.done=!1,W;return W.value=l,W.done=!0,W};return R.next=R}}return{next:G}}n.values=te;function G(){return{value:l,done:!0}}return q.prototype={constructor:q,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(Ee),!I)for(var H in this)H.charAt(0)==="t"&&s.call(this,H)&&!isNaN(+H.slice(1))&&(this[H]=l)},stop:function(){this.done=!0;var I=this.tryEntries[0],H=I.completion;if(H.type==="throw")throw H.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var H=this;function A(ae,U){return oe.type="throw",oe.arg=I,H.next=ae,U&&(H.method="next",H.arg=l),!!U}for(var R=this.tryEntries.length-1;R>=0;--R){var W=this.tryEntries[R],oe=W.completion;if(W.tryLoc==="root")return A("end");if(W.tryLoc<=this.prev){var xe=s.call(W,"catchLoc"),L=s.call(W,"finallyLoc");if(xe&&L){if(this.prev<W.catchLoc)return A(W.catchLoc,!0);if(this.prev<W.finallyLoc)return A(W.finallyLoc)}else if(xe){if(this.prev<W.catchLoc)return A(W.catchLoc,!0)}else if(L){if(this.prev<W.finallyLoc)return A(W.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(I,H){for(var A=this.tryEntries.length-1;A>=0;--A){var R=this.tryEntries[A];if(R.tryLoc<=this.prev&&s.call(R,"finallyLoc")&&this.prev<R.finallyLoc){var W=R;break}}W&&(I==="break"||I==="continue")&&W.tryLoc<=H&&H<=W.finallyLoc&&(W=null);var oe=W?W.completion:{};return oe.type=I,oe.arg=H,W?(this.method="next",this.next=W.finallyLoc,M):this.complete(oe)},complete:function(I,H){if(I.type==="throw")throw I.arg;return I.type==="break"||I.type==="continue"?this.next=I.arg:I.type==="return"?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):I.type==="normal"&&H&&(this.next=H),M},finish:function(I){for(var H=this.tryEntries.length-1;H>=0;--H){var A=this.tryEntries[H];if(A.finallyLoc===I)return this.complete(A.completion,A.afterLoc),Ee(A),M}},catch:function(I){for(var H=this.tryEntries.length-1;H>=0;--H){var A=this.tryEntries[H];if(A.tryLoc===I){var R=A.completion;if(R.type==="throw"){var W=R.arg;Ee(A)}return W}}throw new Error("illegal catch attempt")},delegateYield:function(I,H,A){return this.delegate={iterator:te(I),resultName:H,nextLoc:A},this.method==="next"&&(this.arg=l),M}},n})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(N0)),N0.exports}var T0,bS;function by(){return bS||(bS=1,T0=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),T0}var A0,yS;function Z5(){if(yS)return A0;yS=1;const t=by();let e=0;return A0=({id:n,action:r,payload:s={}})=>{let a=n;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:r,payload:s}},A0}var Cc={},vS;function yy(){if(vS)return Cc;vS=1;let t=!1;return Cc.logging=t,Cc.setLogging=e=>{t=e},Cc.log=(...e)=>t?console.log.apply(this,e):null,Cc}var M0,wS;function LV(){if(wS)return M0;wS=1;const t=Z5(),{log:e}=yy(),n=by();let r=0;return M0=()=>{const s=n("Scheduler",r),a={},l={};let c=[];r+=1;const d=()=>c.length,p=()=>Object.keys(a).length,m=()=>{if(c.length!==0){const C=Object.keys(a);for(let k=0;k<C.length;k+=1)if(typeof l[C[k]]>"u"){c[0](a[C[k]]);break}}},g=(C,k)=>new Promise((N,M)=>{const _=t({action:C,payload:k});c.push(async P=>{c.shift(),l[P.id]=_;try{N(await P[C].apply(this,[...k,_.id]))}catch(z){M(z)}finally{delete l[P.id],m()}}),e(`[${s}]: Add ${_.id} to JobQueue`),e(`[${s}]: JobQueue length=${c.length}`),m()});return{addWorker:C=>(a[C.id]=C,e(`[${s}]: Add ${C.id}`),e(`[${s}]: Number of workers=${p()}`),m(),C.id),addJob:async(C,...k)=>{if(p()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return g(C,k)},terminate:async()=>{Object.keys(a).forEach(async C=>{await a[C].terminate()}),c=[]},getQueueLen:d,getNumWorkers:p}},M0}function IV(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var O0,kS;function zV(){return kS||(kS=1,O0=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof IV=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),O0}var j0,CS;function BV(){if(CS)return j0;CS=1;const e=zV()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return j0=n=>{const r={...n};return["corePath","workerPath","langPath"].forEach(s=>{n[s]&&(r[s]=e(r[s]))}),r},j0}var _0,SS;function eM(){return SS||(SS=1,_0={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),_0}const PV="7.0.0",HV={version:PV};var R0,ES;function FV(){return ES||(ES=1,R0={workerBlobURL:!0,logger:()=>{}}),R0}var D0,NS;function UV(){if(NS)return D0;NS=1;const t=HV.version;return D0={...FV(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},D0}var L0,TS;function $V(){return TS||(TS=1,L0=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n}),L0}var I0,AS;function VV(){return AS||(AS=1,I0=t=>{t.terminate()}),I0}var z0,MS;function qV(){return MS||(MS=1,z0=(t,e)=>{t.onmessage=({data:n})=>{e(n)}}),z0}var B0,OS;function WV(){return OS||(OS=1,B0=async(t,e)=>{t.postMessage(e)}),B0}var P0,jS;function KV(){if(jS)return P0;jS=1;const t=n=>new Promise((r,s)=>{const a=new FileReader;a.onload=()=>{r(a.result)},a.onerror=({target:{error:{code:l}}})=>{s(Error(`File could not be read! Code=${l}`))},a.readAsArrayBuffer(n)}),e=async n=>{let r=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?r=atob(n.split(",")[1]).split("").map(s=>s.charCodeAt(0)):r=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(r=await e(n.src)),n.tagName==="VIDEO"&&(r=await e(n.poster)),n.tagName==="CANVAS"&&await new Promise(s=>{n.toBlob(async a=>{r=await t(a),s()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const s=await n.convertToBlob();r=await t(s)}else(n instanceof File||n instanceof Blob)&&(r=await t(n));return new Uint8Array(r)};return P0=e,P0}var H0,_S;function GV(){if(_S)return H0;_S=1;const t=UV(),e=$V(),n=VV(),r=qV(),s=WV(),a=KV();return H0={defaultOptions:t,spawnWorker:e,terminateWorker:n,onMessage:r,send:s,loadImage:a},H0}var F0,RS;function tM(){if(RS)return F0;RS=1;const t=BV(),e=Z5(),{log:n}=yy(),r=by(),s=eM(),{defaultOptions:a,spawnWorker:l,terminateWorker:c,onMessage:d,loadImage:p,send:m}=GV();let g=0;return F0=async(b="eng",v=s.LSTM_ONLY,w={},C={})=>{const k=r("Worker",g),{logger:N,errorHandler:M,..._}=t({...a,...w}),P={},z=typeof b=="string"?b.split("+"):b;let K=v,O=C;const F=[s.DEFAULT,s.LSTM_ONLY].includes(v)&&!_.legacyCore;let V,Z;const he=new Promise((ne,ie)=>{Z=ne,V=ie}),Te=ne=>{V(ne.message)};let ve=l(_);ve.onerror=Te,g+=1;const Se=({id:ne,action:ie,payload:je})=>new Promise((Ue,lt)=>{n(`[${k}]: Start ${ne}, action=${ie}`);const Fe=`${ie}-${ne}`;P[Fe]={resolve:Ue,reject:lt},m(ve,{workerId:k,jobId:ne,action:ie,payload:je})}),Ee=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),q=ne=>Se(e({id:ne,action:"load",payload:{options:{lstmOnly:F,corePath:_.corePath,logging:_.logging}}})),te=(ne,ie,je)=>Se(e({id:je,action:"FS",payload:{method:"writeFile",args:[ne,ie]}})),G=(ne,ie)=>Se(e({id:ie,action:"FS",payload:{method:"readFile",args:[ne,{encoding:"utf8"}]}})),I=(ne,ie)=>Se(e({id:ie,action:"FS",payload:{method:"unlink",args:[ne]}})),H=(ne,ie,je)=>Se(e({id:je,action:"FS",payload:{method:ne,args:ie}})),A=(ne,ie)=>Se(e({id:ie,action:"loadLanguage",payload:{langs:ne,options:{langPath:_.langPath,dataPath:_.dataPath,cachePath:_.cachePath,cacheMethod:_.cacheMethod,gzip:_.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(K)&&!_.legacyLang}}})),R=(ne,ie,je,Ue)=>Se(e({id:Ue,action:"initialize",payload:{langs:ne,oem:ie,config:je}})),W=(ne="eng",ie,je,Ue)=>{if(F&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(ie))throw Error("Legacy model requested but code missing.");const lt=ie||K;K=lt;const Fe=je||O;O=Fe;const pt=(typeof ne=="string"?ne.split("+"):ne).filter(Me=>!z.includes(Me));return z.push(...pt),pt.length>0?A(pt,Ue).then(()=>R(ne,lt,Fe,Ue)):R(ne,lt,Fe,Ue)},oe=(ne={},ie)=>Se(e({id:ie,action:"setParameters",payload:{params:ne}})),xe=async(ne,ie={},je={text:!0},Ue)=>Se(e({id:Ue,action:"recognize",payload:{image:await p(ne),options:ie,output:je}})),L=async(ne,ie)=>{if(F)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return Se(e({id:ie,action:"detect",payload:{image:await p(ne)}}))},ae=async()=>(ve!==null&&(c(ve),ve=null),Promise.resolve());d(ve,({workerId:ne,jobId:ie,status:je,action:Ue,data:lt})=>{const Fe=`${Ue}-${ie}`;if(je==="resolve")n(`[${ne}]: Complete ${ie}`),P[Fe].resolve({jobId:ie,data:lt}),delete P[Fe];else if(je==="reject")if(P[Fe].reject(lt),delete P[Fe],Ue==="load"&&V(lt),M)M(lt);else throw Error(lt);else je==="progress"&&N({...lt,userJobId:ie})});const U={id:k,worker:ve,load:Ee,writeText:te,readText:G,removeFile:I,FS:H,reinitialize:W,setParameters:oe,recognize:xe,detect:L,terminate:ae};return q().then(()=>A(b)).then(()=>R(b,v,C)).then(()=>Z(U)).catch(()=>{}),he},F0}var U0,DS;function YV(){if(DS)return U0;DS=1;const t=tM();return U0={recognize:async(r,s,a)=>{const l=await t(s,1,a);return l.recognize(r).finally(async()=>{await l.terminate()})},detect:async(r,s)=>{const a=await t("osd",0,s);return a.detect(r).finally(async()=>{await a.terminate()})}},U0}var $0,LS;function JV(){return LS||(LS=1,$0={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),$0}var V0,IS;function XV(){return IS||(IS=1,V0={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),V0}var q0,zS;function QV(){if(zS)return q0;zS=1,DV();const t=LV(),e=tM(),n=YV(),r=JV(),s=eM(),a=XV(),{setLogging:l}=yy();return q0={languages:r,OEM:s,PSM:a,createScheduler:t,createWorker:e,setLogging:l,...n},q0}var ZV=QV();const eq=async(t,e)=>{const n=await ZV.createWorker("tur+eng",1,{logger:r=>{r.status==="recognizing text"&&e&&e(Math.round(r.progress*100))}});try{const{data:{text:r,confidence:s}}=await n.recognize(t);return{text:r,confidence:s}}finally{await n.terminate()}},tq=1600,nq=.85;function rq(t){const e=t.maxTouchPoints>0||t.hasCoarsePointer,n=t.viewportWidth<=1024;return e&&n}function sq(t,e){const n=(t||"").trim(),r=(e||"").trim();return r?n?`${n}

${r}`:r:n}async function iq(t,e={}){const n=e.maxWidth??tq,r=e.quality??nq,s=await createImageBitmap(t);try{const a=s.width,l=s.height;if(!a||!l)throw new Error("Invalid image dimensions");const c=a>n?n/a:1,d=Math.max(1,Math.round(a*c)),p=Math.max(1,Math.round(l*c)),m=document.createElement("canvas");m.width=d,m.height=p;const g=m.getContext("2d");if(!g)throw new Error("Canvas context is unavailable");return g.drawImage(s,0,0,d,p),await new Promise(v=>{m.toBlob(v,"image/jpeg",r)})||t}finally{s.close()}}const BS=.02,aq=({open:t,onClose:e,onApply:n,onProcessingChange:r,onErrorChange:s,onDraftChange:a})=>{const[l,c]=E.useState(null),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState(!1),[w,C]=E.useState(!1),[k,N]=E.useState(0),[M,_]=E.useState(""),P=E.useRef(null),z=E.useRef(null),K=E.useRef(null),O=E.useRef(null),F=(G,I,H)=>Math.min(H,Math.max(I,G));if(E.useEffect(()=>{t&&(c(null),p(null),g(null),_(""),N(0),v(!1),C(!1),r(!1),s(null),a(""),setTimeout(()=>{var G;(G=P.current)==null||G.click()},100))},[t,a,s,r]),E.useEffect(()=>{O.current=m},[m]),!t)return null;const V=G=>{var A;const I=(A=G.target.files)==null?void 0:A[0];if(!I)return;p(I),g(null),_(""),a(""),s(null);const H=new FileReader;H.onload=R=>{var W;c((W=R.target)==null?void 0:W.result)},H.readAsDataURL(I)},Z=G=>{if(!z.current)return null;const I=z.current.getBoundingClientRect();return I.width<=0||I.height<=0?null:{x:F((G.clientX-I.left)/I.width,0,1),y:F((G.clientY-I.top)/I.height,0,1)}},he=G=>{if(b)return;const I=Z(G);I&&(G.currentTarget.setPointerCapture(G.pointerId),K.current=I,g({x:I.x,y:I.y,width:0,height:0}),C(!0))},Te=G=>{if(!w||!K.current)return;const I=Z(G);if(!I)return;const H=K.current,A=Math.min(H.x,I.x),R=Math.min(H.y,I.y),W=Math.abs(I.x-H.x),oe=Math.abs(I.y-H.y);g({x:A,y:R,width:W,height:oe})},ve=G=>{if(!w)return;G.currentTarget.hasPointerCapture(G.pointerId)&&G.currentTarget.releasePointerCapture(G.pointerId),C(!1);const I=O.current;(!I||I.width<BS||I.height<BS)&&g(null)},Se=async(G,I)=>{const H=await createImageBitmap(G);try{const A=F(Math.round(I.x*H.width),0,H.width-1),R=F(Math.round(I.y*H.height),0,H.height-1),W=Math.max(1,Math.round(I.width*H.width)),oe=Math.max(1,Math.round(I.height*H.height)),xe=Math.min(W,H.width-A),L=Math.min(oe,H.height-R),ae=document.createElement("canvas");ae.width=xe,ae.height=L;const U=ae.getContext("2d");if(!U)throw new Error("Canvas context is unavailable");return U.drawImage(H,A,R,xe,L,0,0,xe,L),await new Promise(ie=>{ae.toBlob(ie,"image/jpeg",.92)})||G}finally{H.close()}},Ee=async G=>{if(d){v(!0),r(!0),s(null),N(0);try{const I=G&&m?await Se(d,m):d,H=await iq(I),R=((await eq(H,W=>N(W))).text||"").trim();_(R),a(R),R||s("Secilen alanda okunabilir metin bulunamadi. Alani degistirip tekrar deneyin.")}catch(I){console.error("OCR Error:",I);const H="Metin okunamadi. Isigi ve aciyi duzeltip tekrar deneyin.";s(H),alert(H)}finally{v(!1),r(!1)}}},q=()=>{c(null),p(null),g(null),_(""),N(0),C(!1),a(""),s(null),P.current&&(P.current.value="",P.current.click())},te=()=>{n(M),e()};return h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-white/10",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(J0,{size:20,className:"text-primary dark:text-orange-500"}),"Metin Tara (OCR)"]}),h.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 dark:hover:bg-white/5 rounded-full transition-colors","aria-label":"Kapat",children:h.jsx(cs,{size:20,className:"text-slate-500"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!l&&h.jsxs("div",{onClick:()=>{var G;return(G=P.current)==null?void 0:G.click()},className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-12 flex flex-col items-center justify-center gap-4 cursor-pointer hover:border-primary/50 dark:hover:border-orange-500/50 transition-colors",children:[h.jsx("div",{className:"w-16 h-16 bg-primary/10 dark:bg-orange-500/10 rounded-full flex items-center justify-center text-primary dark:text-orange-500",children:h.jsx(J0,{size:32})}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Kamerayi Ac"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Sayfayi cekin, sonra metin alanini secin"})]})]}),l&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"relative bg-black rounded-lg border border-slate-200 dark:border-white/10 shadow-inner p-2",children:[h.jsxs("div",{className:"relative mx-auto w-fit max-w-full touch-none",children:[h.jsx("img",{src:l,alt:"Captured",className:"block max-h-[58vh] w-auto max-w-full rounded-md"}),!b&&h.jsx("div",{ref:z,className:"absolute inset-0 cursor-crosshair",onPointerDown:he,onPointerMove:Te,onPointerUp:ve,onPointerCancel:ve,children:m&&h.jsx("div",{className:"absolute border-2 border-emerald-400 bg-emerald-400/12",style:{left:`${m.x*100}%`,top:`${m.y*100}%`,width:`${m.width*100}%`,height:`${m.height*100}%`}})})]}),b&&h.jsxs("div",{className:"absolute inset-0 bg-black/60 flex flex-col items-center justify-center text-white p-6 text-center backdrop-blur-[2px]",children:[h.jsx(Jt,{size:48,className:"animate-spin mb-4 text-primary dark:text-orange-500"}),h.jsx("p",{className:"font-bold text-lg mb-2",children:"Metin Isleniyor..."}),h.jsx("div",{className:"w-full max-w-xs bg-white/20 h-2 rounded-full overflow-hidden",children:h.jsx("div",{className:"bg-primary dark:bg-orange-500 h-full transition-all duration-300",style:{width:`${k}%`}})}),h.jsxs("p",{className:"mt-2 text-sm font-medium",children:["%",k]}),h.jsx("p",{className:"mt-4 text-[10px] text-white/60",children:"Bu islem cihaz hizina gore 5-10 saniye surebilir."})]})]}),!b&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Metin bolgesini secmek icin gorsel uzerinde surukleyin."}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[h.jsxs("button",{type:"button",onClick:()=>Ee(!0),disabled:!m,className:"py-2 px-3 rounded-lg bg-emerald-600 text-white text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center gap-2",children:[h.jsx(V3,{size:16}),"Secili Alani Tara"]}),h.jsx("button",{type:"button",onClick:()=>Ee(!1),className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:"Tum Sayfayi Tara"}),h.jsxs("button",{type:"button",onClick:q,className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:[h.jsx(xE,{size:16}),"Tekrar Cek"]})]})]}),!b&&M&&h.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Okunan Metin"}),h.jsx("textarea",{value:M,onChange:G=>{_(G.target.value),a(G.target.value)},className:"w-full h-40 border border-slate-200 dark:border-white/10 rounded-xl p-3 text-sm bg-slate-50 dark:bg-white/5 text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/20 outline-none resize-none font-lora"}),h.jsx("p",{className:"text-[10px] text-slate-400 italic text-right",children:"* Hatalari buradan duzeltebilirsiniz."})]})]})]}),h.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-white/10 flex gap-3",children:[l&&!b&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 border border-slate-200 dark:border-white/10 rounded-xl text-slate-600 dark:text-slate-300 font-semibold hover:bg-slate-50 dark:hover:bg-white/5 transition-colors",children:"Kapat"}),h.jsxs("button",{onClick:te,disabled:!M,className:"flex-[1.5] py-3 px-4 bg-primary dark:bg-orange-600 text-white rounded-xl font-bold hover:opacity-90 transition-all shadow-lg shadow-primary/20 dark:shadow-orange-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:[h.jsx(rb,{size:18}),"Highlight'a Ekle"]})]}),!l&&h.jsx("button",{onClick:e,className:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 dark:hover:text-slate-300 transition-colors",children:"Vazgec"})]})]}),h.jsx("input",{ref:P,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:V})]})},oq=({highlights:t,onUpdate:e,autoEditHighlightId:n})=>{const[r,s]=E.useState(!1),[a,l]=E.useState(null),[c,d]=E.useState({}),[p,m]=E.useState("highlight"),[g,b]=E.useState(!1),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(""),[_,P]=E.useState(null),[z,K]=E.useState(""),[O,F]=E.useState(""),[V,Z]=E.useState(!1);We.useEffect(()=>{if(n){const G=t.find(I=>I.id===n);G&&Te(G)}},[n]),We.useEffect(()=>{const G=()=>{if(typeof window>"u"){w(!1);return}const I=typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches,H=typeof navigator<"u"?Number(navigator.maxTouchPoints||0):0;w(rq({viewportWidth:window.innerWidth||0,maxTouchPoints:H,hasCoarsePointer:I}))};return G(),window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[]);const he=()=>{l(null),d({}),m("highlight"),K(new Date().toISOString().split("T")[0]),F(""),b(!1),P(null),M(""),s(!0)},Te=G=>{l(G.id),d({...G}),m(Yh(G.type)),K(new Date(G.createdAt).toISOString().split("T")[0]),F(G.tags?G.tags.join(", "):""),b(!1),P(null),M(""),s(!0)},ve=()=>{s(!1),l(null),d({}),F(""),K(""),b(!1),P(null),M(""),k(!1)},Se=We.useCallback(G=>{d(I=>({...I,text:sq(String(I.text||""),G)})),M(G),P(null),b(!1)},[]),Ee=async()=>{if(!c.text)return;Z(!0);const G=`"${c.text}"
${c.comment?`Context: ${c.comment}`:""}`,I=await gy(G);if(I.length>0){const H=O?O.split(",").map(R=>R.trim()).filter(Boolean):[],A=Array.from(new Set([...H,...I]));F(A.join(", "))}Z(!1)},q=()=>{if(!c.text)return;const G=O.split(",").map(A=>A.trim()).filter(A=>A.length>0),I=z?new Date(z).getTime():Date.now(),H={id:a||Date.now().toString(),text:c.text,type:p,pageNumber:c.pageNumber,paragraphNumber:c.paragraphNumber,chapterTitle:c.chapterTitle,comment:c.comment,createdAt:I,tags:G};if(a){const A=t.map(R=>R.id===a?H:R);e(A)}else e([H,...t]);ve()},te=G=>{window.confirm("Delete this item?")&&e(t.filter(I=>I.id!==G))};return h.jsxs("div",{className:"space-y-4 md:space-y-6",children:[!r&&h.jsxs("button",{onClick:he,className:"w-full py-3 md:py-4 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl text-slate-500 dark:text-slate-400 hover:border-[#262D40]/24 hover:text-[#262D40] hover:bg-[#262D40]/30 dark:hover:bg-white/5 transition-all flex flex-col items-center gap-1 md:gap-2",children:[h.jsx(Q0,{size:20,className:"md:w-6 md:h-6"}),h.jsx("span",{className:"text-sm md:text-base font-medium",children:"Add Highlight or Insights"})]}),r&&h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl shadow-lg border border-[#262D40]/8 dark:border-white/10 animate-in fade-in zoom-in-95 duration-200 relative ring-1 ring-[#262D40]/5 dark:ring-white/5",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[h.jsxs("h4",{className:"font-semibold text-slate-800 dark:text-white flex items-center gap-2 text-sm md:text-base",children:[a?h.jsx(Of,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}):h.jsx(Q0,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}),a?p==="highlight"?"Edit Highlight":"Edit Note":"New Entry"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[p==="highlight"&&v&&h.jsxs("button",{type:"button",onClick:()=>{P(null),M(""),b(!0)},disabled:C,className:"inline-flex items-center gap-1 rounded-md border border-sky-200 bg-sky-50 px-2 py-1 text-[11px] font-semibold text-sky-700 transition-colors hover:bg-sky-100 disabled:cursor-not-allowed disabled:opacity-60 dark:border-sky-700 dark:bg-sky-950/35 dark:text-sky-200 dark:hover:bg-sky-950/55",title:"Kamera ile metin tara",children:[C?h.jsx(Jt,{size:12,className:"animate-spin"}):h.jsx(J0,{size:12}),"Tara"]}),h.jsx("button",{onClick:ve,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:h.jsx(cs,{size:18,className:"md:w-5 md:h-5"})})]})]}),h.jsxs("div",{className:"flex bg-[#F3F5FA] dark:bg-white/5 p-1 rounded-lg mb-4 md:mb-5",children:[h.jsxs("button",{type:"button",onClick:()=>{p!=="highlight"&&(m("highlight"),d({}),F(""),P(null),M(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${p==="highlight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[h.jsx(Jc,{size:14,className:"md:w-4 md:h-4"}),"Highlight"]}),h.jsxs("button",{type:"button",onClick:()=>{p!=="insight"&&(m("insight"),d({}),F(""),b(!1),P(null),M(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${p==="insight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[h.jsx(sl,{size:14,className:"md:w-4 md:h-4"}),"Insights"]})]}),h.jsxs("div",{className:"space-y-2 md:space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:p==="highlight"?"Highlight Text *":"Insight Content *"}),h.jsx("textarea",{autoFocus:!0,rows:12,className:"w-full border rounded-lg p-2 md:p-3 text-sm md:text-base text-slate-800 dark:text-white focus:ring-2 focus:ring-[#262D40]/30 dark:focus:ring-orange-500/30 focus:border-[#262D40]/30 dark:focus:border-orange-500/30 font-lora bg-[#F3F5FA] border-[#E6EAF2] dark:bg-slate-800/50 dark:border-white/10",placeholder:p==="highlight"?"Type the text exactly as it appears...":"Write your thoughts, summary, or key takeaway...",value:c.text||"",onChange:G=>d(I=>({...I,text:G.target.value}))}),p==="highlight"&&N&&h.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-sky-700 dark:text-sky-300",children:"OCR metni eklendi. Kaydetmeden once metni kontrol edebilirsiniz."}),p==="highlight"&&_&&h.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-red-600 dark:text-red-400",children:_})]}),p==="highlight"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Comment"}),h.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Why is this quote important?",value:c.comment||"",onChange:G=>d(I=>({...I,comment:G.target.value}))})]}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Page #"}),h.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:c.pageNumber||"",onChange:G=>d(I=>({...I,pageNumber:parseInt(G.target.value)||void 0}))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Paragraph #"}),h.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:c.paragraphNumber||"",onChange:G=>d(I=>({...I,paragraphNumber:parseInt(G.target.value)||void 0}))})]}),h.jsxs("div",{className:"col-span-2 md:col-span-1",children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Chapter"}),h.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Title or No.",value:c.chapterTitle||"",onChange:G=>d(I=>({...I,chapterTitle:G.target.value}))})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4 pt-2 border-t border-slate-50 dark:border-white/5",children:[h.jsxs("div",{className:"md:col-span-1",children:[h.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"})," Date"]}),h.jsx("input",{type:"date",value:z,onChange:G=>K(G.target.value),className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]}),h.jsxs("div",{className:"md:col-span-2",children:[h.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center justify-between",children:[h.jsx("span",{children:"Tags"}),h.jsxs("button",{type:"button",onClick:Ee,disabled:V||!c.text,className:"text-[#262D40] dark:text-orange-500 hover:text-[#262D40] dark:hover:text-orange-400 flex items-center gap-1 disabled:opacity-50 text-[10px] font-bold tracking-wide",children:[V?h.jsx(Jt,{size:10,className:"animate-spin"}):h.jsx(Ks,{size:10}),"AI AUTO-TAG"]})]}),h.jsx("input",{type:"text",value:O,onChange:G=>F(G.target.value),placeholder:"Separate with commas...",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-2 mt-2",children:[h.jsx("button",{onClick:ve,className:"px-3 md:px-4 py-2 text-xs md:text-sm text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-white/5 rounded-lg flex items-center gap-2",children:"Cancel"}),h.jsxs("button",{onClick:q,disabled:!c.text,className:"px-3 md:px-4 py-2 text-xs md:text-sm bg-[#262D40]/40 dark:bg-orange-600/40 text-white rounded-lg hover:bg-[#262D40]/55 dark:hover:bg-orange-600/60 disabled:opacity-50 shadow-sm flex items-center gap-2",children:[h.jsx(U3,{size:14,className:"md:w-4 md:h-4"}),a?"Update Entry":"Save Entry"]})]})]})]}),h.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.map(G=>{const I=FE(G.type);return h.jsxs("div",{className:"p-3 md:p-6 rounded-xl border transition-all relative group bg-white dark:bg-slate-900/50 border-[#E6EAF2] dark:border-white/10 hover:border-[#262D40]/12 dark:hover:border-orange-500/30 hover:shadow-md",children:[h.jsxs("div",{className:"absolute top-1 right-1 md:top-4 md:right-4 flex gap-0.5 md:gap-2 md:bg-white/80 md:dark:bg-slate-800/90 md:backdrop-blur-sm p-0 md:p-1 rounded-lg md:shadow-sm md:border md:border-[#E6EAF2] md:dark:border-white/10 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity z-10",children:[h.jsx("button",{type:"button",onClick:H=>{H.stopPropagation(),Te(G)},className:"p-1.5 text-slate-400/70 dark:text-slate-500/70 hover:text-[#262D40] dark:hover:text-orange-500 hover:bg-[#262D40]/5 dark:hover:bg-white/5 rounded-md transition-colors",title:"Edit",children:h.jsx(Of,{size:14,className:"md:w-4 md:h-4"})}),h.jsx("button",{type:"button",onClick:H=>{H.stopPropagation(),te(G.id)},className:"p-1.5 text-slate-400/70 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:h.jsx(Pa,{size:14,className:"md:w-4 md:h-4"})})]}),h.jsxs("div",{className:"flex gap-3 md:gap-4",children:[h.jsx("div",{className:"flex-shrink-0 mt-0.5 md:mt-1",children:I?h.jsx(sl,{size:16,className:"text-[#262D40]/82 fill-[#262D40]/85 md:w-5 md:h-5"}):h.jsx(Jc,{size:16,className:"text-yellow-400 fill-yellow-200 md:w-5 md:h-5"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:`text-sm md:text-lg leading-relaxed mb-2 md:mb-3 pr-0 md:pr-16 whitespace-pre-wrap font-lora ${I?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-white"}`,children:G.text}),h.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mb-2",children:[(G.pageNumber||G.paragraphNumber)&&h.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 md:px-2 md:py-1 rounded border bg-[#F3F5FA] dark:bg-white/5 border-[#E6EAF2] dark:border-white/10 text-slate-600 dark:text-slate-400",children:[h.jsx(k3,{size:10,className:"md:w-3 md:h-3"}),G.pageNumber&&h.jsxs("span",{children:["Pg ",G.pageNumber]}),G.pageNumber&&G.paragraphNumber&&h.jsx("span",{children:""}),G.paragraphNumber&&h.jsxs("span",{children:["Para ",G.paragraphNumber]})]}),G.chapterTitle&&h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(xu,{size:10,className:"md:w-3 md:h-3"}),h.jsx("span",{children:G.chapterTitle})]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),h.jsx("span",{children:new Date(G.createdAt).toLocaleDateString()})]})]}),G.tags&&G.tags.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-2",children:G.tags.map((H,A)=>h.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-white/5 border border-[#E6EAF2] dark:border-white/10 rounded text-[9px] md:text-[10px] text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[h.jsx(Af,{size:8})," ",H]},A))}),G.comment&&h.jsx("div",{className:"mt-2 md:mt-3 pl-3 md:pl-4 border-l-2 border-[#E6EAF2] dark:border-white/10 py-0.5 md:py-1",children:h.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 italic",children:G.comment})})]})]})]},G.id)}),t.length===0&&!r&&h.jsx("div",{className:"text-center py-8 md:py-12 text-slate-400",children:h.jsx("p",{className:"text-xs md:text-base",children:"No highlights or insights added yet."})})]}),h.jsx(aq,{open:g,onClose:()=>b(!1),onApply:Se,onProcessingChange:k,onErrorChange:P,onDraftChange:M})]})},Bh=(t,e)=>{if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=Date.parse(t);if(Number.isFinite(n))return n}return e},lq=t=>{const e=String(t||"AUTO").trim().toUpperCase();return e==="TR"||e==="EN"?e:"AUTO"},PS=t=>{const e=String(t||"").trim().toLowerCase();if(e==="tr"||e==="en")return e},cq=(t,e)=>{const n=Bh(t.createdAt,Date.now());return{id:typeof t.id=="string"&&t.id.trim()?t.id:`${n}-${e}`,text:t.text||"",type:Yh(t.type),pageNumber:t.pageNumber,paragraphNumber:t.paragraphNumber,chapterTitle:t.chapterTitle,comment:t.comment,createdAt:n,tags:Array.isArray(t.tags)?t.tags:[],isFavorite:!!t.isFavorite}},nM=t=>({...t,addedAt:Bh(t.addedAt,Date.now()),tags:Array.isArray(t.tags)?t.tags:[],contentLanguageMode:lq(t.contentLanguageMode),contentLanguageResolved:PS(t.contentLanguageResolved),sourceLanguageHint:PS(t.sourceLanguageHint),highlights:Array.isArray(t.highlights)?t.highlights.map((e,n)=>cq(e,n)):[],personalNoteCategory:t.type==="PERSONAL_NOTE"?Jh(t.personalNoteCategory):void 0,personalFolderId:t.type==="PERSONAL_NOTE"?WE(t.personalFolderId):void 0,folderPath:t.type==="PERSONAL_NOTE"?qE(t.folderPath):void 0,status:t.status||"On Shelf",readingStatus:t.readingStatus||"To Read",author:(t.author||"Unknown Author").trim()||"Unknown Author",title:(t.title||"Untitled").trim()||"Untitled",summaryText:typeof t.summaryText=="string"?t.summaryText:void 0}),rM=t=>({...t,category:Jh(t.category),name:(t.name||"").trim(),order:Number.isFinite(t.order)?t.order:0,createdAt:Bh(t.createdAt,Date.now()),updatedAt:Bh(t.updatedAt,Date.now())});function uq(t){return t?{__oracleCursor:t}:null}function dq(t){return t?t.__oracleCursor:void 0}const W0=async(t,e=2e3,n)=>{const r=new URL(`${Xe}/api/library/items`);r.searchParams.set("limit",String(e));const s=dq(n);s&&r.searchParams.set("cursor",s);const a=await At(r.toString());if(!a.ok)throw new Error(await Kr(a,"Failed to fetch library items from Oracle"));const l=await a.json(),d=(Array.isArray(l==null?void 0:l.items)?l.items:[]).map(m=>nM(m)),p=uq(typeof(l==null?void 0:l.next_cursor)=="string"?l.next_cursor:null);return{items:d,lastDoc:p}},ja=async(t,e)=>{const n=nM(e),r=await At(`${Xe}/api/library/items/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to save library item to Oracle"))},Yx=async(t,e,n)=>{const r=await At(`${Xe}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:n})});if(!r.ok)throw new Error(await Kr(r,"Failed to patch library item in Oracle"))},fq=async(t,e)=>{const n=await At(`${Xe}/api/library/items/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Kr(n,"Failed to delete library item from Oracle"))},hq=async(t,e)=>{if(e.length===0)return;const n=await At(`${Xe}/api/library/items/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:e})});if(!n.ok)throw new Error(await Kr(n,"Failed to bulk delete library items from Oracle"))},HS=async t=>{const e=await At(`${Xe}/api/library/personal-note-folders`);if(!e.ok)throw new Error(await Kr(e,"Failed to fetch personal note folders from Oracle"));const n=await e.json();return(Array.isArray(n==null?void 0:n.folders)?n.folders:[]).map(s=>rM(s)).sort((s,a)=>s.category!==a.category?s.category.localeCompare(a.category):s.order!==a.order?s.order-a.order:s.name.localeCompare(a.name))},FS=async(t,e)=>{const n=rM(e),r=await At(`${Xe}/api/library/personal-note-folders/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to save personal note folder to Oracle"))},US=async(t,e,n)=>{const r=await At(`${Xe}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to update personal note folder in Oracle"))},pq=async(t,e)=>{const n=await At(`${Xe}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Kr(n,"Failed to delete personal note folder from Oracle"))},uf=async(t,e,n,r,s)=>{const a=await At(`${Xe}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:{personalNoteCategory:Jh(n),personalFolderId:WE(r)||null,folderPath:qE(s)||null}})});if(!a.ok)throw new Error(await Kr(a,"Failed to move personal note in Oracle"))},mq=We.memo(({book:t,onBack:e,onEdit:n,onDelete:r,onUpdateHighlights:s,initialTab:a="info",autoEditHighlightId:l,onIngestSuccess:c,onBookUpdated:d})=>{const[p,m]=E.useState(a),[g,b]=E.useState(null),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(!1),[_,P]=E.useState(null),[z,K]=E.useState(null),[O,F]=E.useState(null),[V,Z]=E.useState(null),[he,Te]=E.useState(null),[ve,Se]=E.useState(0),[Ee,q]=E.useState(0),{user:te}=bp(),G=We.useRef(null),I=We.useRef(null),H=t.type==="PERSONAL_NOTE",A=Me=>{if(!Me)return"";const rt=Me.replace(/_/g," ").replace(/\s+/g," ").trim(),De=24;return rt.length<=De?rt:`${rt.slice(0,De).trimEnd()}...`},R=async Me=>{var De;const rt=(De=Me.target.files)==null?void 0:De[0];if(!(!rt||!te)){if(rt.type!=="application/pdf"){F("Please select a PDF file");return}k(!0),F(null),K(null),Z({status:"PROCESSING",file_name:rt.name,chunk_count:null,embedding_count:null,updated_at:new Date().toISOString()}),Se(_e=>_e+1);try{const _e=await J5(rt,t.title,t.author,te.uid,t.id);K(_e),setTimeout(()=>K(null),5e3)}catch(_e){F(_e instanceof Error?_e.message:"Ingestion failed")}finally{k(!1),G.current&&(G.current.value="")}}},W=Me=>{switch(Me){case"Reading":return{icon:Ba,color:"text-[#38BDF8]",bg:"bg-[#38BDF8]/12",border:"border-[#38BDF8]/45"};case"Finished":return{icon:Yc,color:"text-[#22C55E]",bg:"bg-[#22C55E]/12",border:"border-[#22C55E]/45"};case"To Read":return{icon:T4,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"};default:return{icon:Ba,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"}}},oe=Me=>{switch(Me){case"Lent Out":return{icon:$i,color:"text-[#F59E0B]",bg:"bg-[#F59E0B]/15",border:"border-[#F59E0B]/45"};case"Lost":return{icon:$i,color:"text-[#F43F5E]",bg:"bg-[#F43F5E]/15",border:"border-[#F43F5E]/45"};case"On Shelf":default:return{icon:mE,color:"text-[#14B8A6]",bg:"bg-[#14B8A6]/15",border:"border-[#14B8A6]/45"}}},xe=async()=>{if(t.highlights.length===0)return;w(!0);const Me=t.highlights.map(De=>De.text),rt=await V5(Me);b(rt),w(!1)},L=async()=>{if(!(!(te!=null&&te.uid)||N)){M(!0),P(null);try{const Me=gp(t),rt=await xy(Me,{forceRegenerate:!0}),De=xp(t,rt),_e={};De.summaryText!==t.summaryText&&(_e.summaryText=De.summaryText),JSON.stringify(De.tags||[])!==JSON.stringify(t.tags||[])&&(_e.tags=De.tags),De.publisher!==t.publisher&&(_e.publisher=De.publisher),De.translator!==t.translator&&(_e.translator=De.translator),De.publicationYear!==t.publicationYear&&(_e.publicationYear=De.publicationYear),De.isbn!==t.isbn&&(_e.isbn=De.isbn),De.coverUrl!==t.coverUrl&&(_e.coverUrl=De.coverUrl),De.pageCount!==t.pageCount&&(_e.pageCount=De.pageCount),De.contentLanguageMode!==t.contentLanguageMode&&(_e.contentLanguageMode=De.contentLanguageMode),De.contentLanguageResolved!==t.contentLanguageResolved&&(_e.contentLanguageResolved=De.contentLanguageResolved),De.sourceLanguageHint!==t.sourceLanguageHint&&(_e.sourceLanguageHint=De.sourceLanguageHint),De.languageDecisionReason!==t.languageDecisionReason&&(_e.languageDecisionReason=De.languageDecisionReason),De.languageDecisionConfidence!==t.languageDecisionConfidence&&(_e.languageDecisionConfidence=De.languageDecisionConfidence),Object.keys(_e).length>0&&await Yx(te.uid,t.id,_e),d==null||d({...t,..._e}),(De.summaryText||De.generalNotes)&&b(De.summaryText||De.generalNotes||null)}catch(Me){console.error("Enrich failed",Me),P(Me instanceof Error?Me.message:"Failed to generate with AI")}finally{M(!1)}}},ae=H?null:W(t.readingStatus),U=H?null:oe(t.status),ne=!!((V==null?void 0:V.status)==="COMPLETED"&&(V!=null&&V.matched_by_title)&&(V!=null&&V.resolved_book_id)&&String(V.resolved_book_id)!==String(t.id)),ie=(V==null?void 0:V.status)==="COMPLETED"&&!ne,je=(V==null?void 0:V.status)==="PROCESSING",Ue=(V==null?void 0:V.status)==="FAILED",lt=ie||je||C,Fe=Math.min(95,Math.max(12,12+Ee*3)),nt=We.useCallback(()=>{Se(Me=>Me+1)},[]);We.useEffect(()=>{if(!(te!=null&&te.uid)||!(t!=null&&t.id)||H){Z(null),Te(null),q(0),I.current&&(clearTimeout(I.current),I.current=null);return}let Me=!1;const rt=60,De=async()=>{try{const _e=await NV(t.id,te.uid,t.title);if(Me)return;Z(_e),Te(null);const an=!!(_e.status==="COMPLETED"&&_e.matched_by_title&&_e.resolved_book_id&&String(_e.resolved_book_id)!==String(t.id)),on=_e.status==="COMPLETED"&&!an;if(t.isIngested!==on){const Kn={...t,isIngested:on};d==null||d(Kn)}_e.status==="COMPLETED"&&!an&&(c==null||c()),_e.status==="PROCESSING"&&q(Kn=>{const Dt=Kn+1;return Dt<rt&&!Me&&(I.current=setTimeout(De,1e4)),Dt})}catch(_e){if(Me)return;Te(_e instanceof Error?_e.message:"Failed to fetch ingestion status"),q(an=>{const on=an+1;return on<rt&&!Me&&(I.current=setTimeout(De,1e4)),on})}};return q(0),De(),()=>{Me=!0,I.current&&(clearTimeout(I.current),I.current=null)}},[t.id,te==null?void 0:te.uid,H,ve]);const pt=(Me,rt,De)=>h.jsxs("div",{className:`p-2 md:p-4 rounded-lg md:rounded-xl border-2 ${Me.bg} ${Me.border} flex items-center gap-2 md:gap-3 shadow-sm h-full`,children:[h.jsx("div",{className:`p-1.5 md:p-2 rounded-full bg-white/50 dark:bg-black/20 ${Me.color} flex-shrink-0`,children:h.jsx(Me.icon,{size:16,className:"md:w-5 md:h-5"})}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("span",{className:"block text-[9px] md:text-[10px] uppercase tracking-wider font-bold text-[#111827] dark:text-white/60 truncate",children:rt}),h.jsx("span",{className:"font-bold text-xs md:text-base leading-tight text-[#111827] dark:text-white truncate block",children:De})]})]});return h.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-3 md:p-4 pb-20 animate-in fade-in duration-300",children:[h.jsxs("button",{onClick:e,className:"mb-2 md:mb-6 flex items-center text-slate-500 dark:text-slate-400 hover:text-[#262D40] dark:hover:text-white transition-colors group text-base md:text-base",children:[h.jsx(cE,{size:18,className:"mr-1.5 md:mr-1 md:w-5 md:h-5 group-hover:-translate-x-1 transition-transform"}),"Back to ",H?"Notes":"Library"]}),h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 overflow-hidden",children:[h.jsx("div",{className:"p-4 md:p-8 border-b border-[#E6EAF2] dark:border-slate-800",children:H?h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2 md:mb-4 text-[#262D40]/90 dark:text-white/85",children:[h.jsx(Mf,{size:18,className:"md:w-6 md:h-6"}),h.jsx("span",{className:"text-xs md:text-sm font-bold tracking-wide uppercase text-[#262D40]/80 dark:text-white",children:"Personal Note"}),h.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs font-bold tracking-wide",children:Dn(t)}),t.folderPath&&h.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs border border-[#E6EAF2] dark:border-slate-700",children:t.folderPath})]}),h.jsx("h1",{className:"text-xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 md:mb-4 leading-tight",children:t.title}),h.jsxs("div",{className:"flex flex-wrap gap-1.5 md:gap-2 mb-2",children:[t.tags.map((Me,rt)=>h.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},rt)),h.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 text-slate-400 dark:text-slate-500 text-[10px] md:text-xs flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),new Date(t.addedAt).toLocaleDateString()]})]})]}),h.jsxs("div",{className:"flex gap-1 md:gap-2 ml-2 md:ml-4 flex-shrink-0",children:[h.jsx("input",{type:"file",ref:G,className:"hidden",accept:".pdf",onChange:R}),h.jsx("button",{type:"button",onClick:()=>{var Me;return(Me=G.current)==null?void 0:Me.click()},disabled:lt,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors relative",title:ie?`PDF already indexed: ${(V==null?void 0:V.file_name)||""}`:"Upload PDF",children:C?h.jsx(Jt,{size:18,className:"md:w-5 md:h-5 animate-spin text-[#262D40]/90"}):h.jsx(jf,{size:18,className:"md:w-5 md:h-5"})}),h.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors",title:"Edit Note",children:h.jsx(Of,{size:18,className:"md:w-5 md:h-5"})}),h.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-full transition-colors",title:"Delete Note",children:h.jsx(Pa,{size:18,className:"md:w-5 md:h-5"})})]})]}):h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[h.jsxs("div",{className:"flex gap-4 md:block md:shrink-0",children:[h.jsx("div",{className:"w-20 h-32 md:w-34 md:h-52 bg-slate-200 dark:bg-slate-800 rounded-lg shadow-inner flex-shrink-0 flex items-center justify-center text-slate-400 dark:text-slate-600 self-center md:self-start overflow-hidden relative border border-[#E6EAF2] dark:border-slate-700",children:t.type==="BOOK"&&t.coverUrl?h.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-full h-full object-cover"}):t.type==="BOOK"?h.jsx(Ba,{size:32,className:"md:w-12 md:h-12"}):t.type==="ARTICLE"?h.jsx(xu,{size:32,className:"md:w-12 md:h-12"}):h.jsx($h,{size:32,className:"md:w-12 md:h-12"})}),h.jsxs("div",{className:"md:hidden flex-1 flex justify-between items-start min-w-0 py-1 gap-2",children:[h.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[h.jsx("h1",{className:"text-[16px] font-bold text-slate-900 dark:text-white mb-1 leading-snug line-clamp-3",children:t.title}),h.jsx("p",{className:"text-[13px] text-slate-600 dark:text-slate-400 mb-2 line-clamp-2",children:t.author}),t.url&&t.type!=="BOOK"&&h.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 text-[#262D40] dark:text-slate-400 hover:underline max-w-full",children:[h.jsx(E2,{size:12}),h.jsx("span",{className:"text-xs truncate",children:new URL(t.url).hostname})]})]}),h.jsxs("div",{className:"flex flex-col gap-1.5 flex-shrink-0 pt-0.5",children:[ae&&h.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${ae.bg} ${ae.border} ${ae.color}`,children:[h.jsx(ae.icon,{size:10}),h.jsx("span",{children:t.readingStatus})]}),U&&t.type==="BOOK"&&h.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${U.bg} ${U.border} ${U.color}`,children:[h.jsx(U.icon,{size:10}),h.jsx("span",{children:t.status})]})]})]})]}),h.jsxs("div",{className:"hidden md:block flex-1 min-w-0",children:[h.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 leading-tight",children:t.title}),h.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 mb-4",children:t.author}),h.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.tags.map((Me,rt)=>h.jsxs("span",{className:"px-2 py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},rt))}),t.url&&t.type!=="BOOK"&&h.jsx("div",{className:"mb-6",children:h.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[#262D40] dark:text-[#262D40]/82 hover:underline",children:[h.jsx(E2,{size:16}),h.jsx("span",{className:"text-sm",children:t.url})]})})]}),h.jsx("div",{className:"md:hidden flex flex-wrap gap-1.5 -mt-1 mb-1",children:t.tags.map((Me,rt)=>h.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},rt))}),h.jsxs("div",{className:"w-full md:w-64 flex-shrink-0 flex flex-col gap-2 md:gap-3",children:[h.jsxs("div",{className:"hidden md:flex md:flex-col gap-2 md:gap-3",children:[ae&&h.jsx("div",{className:!U||t.type!=="BOOK"?"col-span-2 md:col-span-1":"col-span-1",children:pt(ae,"Status",t.readingStatus)}),U&&t.type==="BOOK"&&h.jsx("div",{className:"col-span-1",children:pt(U,"Inventory",t.status)})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1 md:mt-2",children:[h.jsx("input",{type:"file",ref:G,className:"hidden",accept:".pdf",onChange:R}),h.jsxs("button",{type:"button",onClick:()=>{var Me;return(Me=G.current)==null?void 0:Me.click()},disabled:lt,className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium disabled:opacity-50",title:ie?`PDF already indexed: ${(V==null?void 0:V.file_name)||""}`:"Upload PDF",children:[C?h.jsx(Jt,{size:14,className:"animate-spin"}):h.jsx(jf,{size:14}),h.jsx("span",{className:"hidden lg:inline",children:"PDF"})]}),h.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[h.jsx(Of,{size:14})," ",h.jsx("span",{className:"hidden lg:inline",children:"Edit"})]}),h.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-red-300 dark:hover:border-red-500 hover:text-red-600 dark:hover:text-red-400 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[h.jsx(Pa,{size:14})," ",h.jsx("span",{className:"hidden lg:inline",children:"Delete"})]})]}),(z||ie)&&h.jsxs("div",{className:"mt-2 text-[10px] text-emerald-600 dark:text-emerald-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(Yc,{size:10}),(V==null?void 0:V.chunk_count)!=null?`PDF indexlendi (${V.chunk_count} chunk)`:"PDF indexlendi"]}),ne&&h.jsxs("div",{className:"mt-2 text-[10px] text-amber-600 dark:text-amber-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx($i,{size:10})," Ayni baslikta baska bir kaydin PDF'i bulundu; bu kayit icin indexli sayilmadi."]}),O&&h.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(rl,{size:10})," ",O]}),Ue&&h.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx($i,{size:10})," PDF islenemedi. Lutfen farkli bir PDF ile tekrar deneyin."]})]})]})}),!H&&h.jsxs("div",{className:"flex border-b border-[#E6EAF2] dark:border-slate-800",children:[h.jsx("button",{onClick:()=>m("info"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${p==="info"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:"Details"}),h.jsxs("button",{onClick:()=>m("highlights"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${p==="highlights"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:["Highlights (",t.highlights.length,")"]})]}),h.jsxs("div",{className:"p-4 md:p-8 bg-[#F7F8FB] dark:bg-slate-900/50 min-h-[400px]",children:[(p==="info"||H)&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8",children:[h.jsx("div",{className:H?"md:col-span-3":"md:col-span-2 space-y-6",children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm ${H?"min-h-[300px]":""}`,children:[!H&&h.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 md:mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(sl,{size:18,className:"text-[#262D40]/90 dark:text-[#262D40]/82 md:w-5 md:h-5"}),h.jsx("h3",{className:"text-base md:text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Summary"})]}),h.jsxs("button",{type:"button",onClick:L,disabled:N,className:"flex items-center gap-1.5 text-[11px] md:text-xs font-semibold text-white px-2 py-1 rounded-lg border border-[#262D40] bg-[#262D40] hover:bg-[#1d2333] disabled:opacity-60",children:[N?h.jsx(Jt,{size:14,className:"animate-spin"}):h.jsx(Ks,{size:14}),N?"Generating...":"Generate with AI"]})]}),(H?t.generalNotes:t.summaryText||t.generalNotes)?H?h.jsx("div",{className:"personal-note-render text-slate-700 dark:text-slate-300 leading-relaxed text-sm md:text-base max-w-none",dangerouslySetInnerHTML:{__html:hb(t.generalNotes)}}):h.jsx("p",{className:"text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed text-sm md:text-lg",children:t.summaryText||t.generalNotes}):h.jsx("p",{className:"text-slate-400 dark:text-slate-500 italic text-sm",children:"No content added."}),_&&h.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2 flex items-center gap-1",children:[h.jsx(rl,{size:12})," ",_]})]})}),!H&&h.jsx("div",{className:"space-y-4 md:space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm space-y-4",children:[h.jsx("h3",{className:"text-xs md:text-sm font-semibold text-slate-900 dark:text-white uppercase tracking-wider mb-2 md:mb-4",children:"Information"}),t.publisher&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:t.type==="ARTICLE"?"Journal":"Publisher"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publisher})]}),t.publicationYear&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Year"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publicationYear})]}),t.translator&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Translator"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.translator})]}),t.isbn&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"ISBN"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 font-mono",children:t.isbn})]}),t.pageCount&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Page Count"}),h.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[t.pageCount," pages"]})]}),V&&V.status!=="NOT_FOUND"&&!ne&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"PDF"}),h.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[je&&"Processing...",Ue&&"Failed - please re-upload",ie&&h.jsxs(h.Fragment,{children:[V.file_name?h.jsx("span",{title:V.file_name,children:`Indexed: ${A(V.file_name)}`}):"Indexed",V.chunk_count!==null?` (${V.chunk_count} chunks)`:""]})]}),(je||C)&&h.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[h.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700 overflow-hidden",children:h.jsx("div",{className:"h-full rounded-full bg-sky-500 transition-all duration-500",style:{width:`${Fe}%`}})}),h.jsx("button",{type:"button",onClick:nt,className:"text-[10px] md:text-xs text-sky-600 dark:text-sky-400 underline underline-offset-2",children:"Yenile"})]}),he&&h.jsx("span",{className:"text-[10px] md:text-xs text-red-600 dark:text-red-400",children:he})]}),t.code&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Shelf Code"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Af,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.code})]})]}),h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Added"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(nl,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:new Date(t.addedAt).toLocaleDateString()})]})]})]})})]}),!H&&p==="highlights"&&h.jsxs("div",{className:"space-y-6",children:[t.highlights.length>0&&h.jsx("div",{className:"flex justify-end",children:h.jsxs("button",{onClick:xe,disabled:v,className:"text-xs md:text-sm text-[#262D40] dark:text-[#262D40]/82 hover:text-[#262D40] dark:hover:text-[#262D40]/78 flex items-center gap-2 disabled:opacity-50",children:[h.jsx(Ks,{size:14,className:"md:w-4 md:h-4"}),v?"Analyzing...":"Analyze Highlights with AI"]})}),g&&h.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 border border-[#262D40]/8 dark:border-[#262D40]/70 p-3 md:p-4 rounded-lg mb-4 animate-in fade-in slide-in-from-top-2",children:[h.jsxs("h4",{className:"text-[#262D40] dark:text-[#262D40]/78 font-semibold text-xs md:text-sm mb-2 flex items-center gap-2",children:[h.jsx(Ks,{size:14})," AI Analysis"]}),h.jsxs("p",{className:"text-[#262D40] dark:text-[#262D40]/75 text-xs md:text-sm leading-relaxed italic",children:['"',g,'"']})]}),h.jsx(oq,{highlights:t.highlights,onUpdate:s,autoEditHighlightId:l})]})]})]})]})}),sM="/assets/logo_v9-D75hAm-V.png",iM=E.createContext(void 0),gq=({children:t})=>{const[e,n]=E.useState("light");E.useEffect(()=>{const s=localStorage.getItem("theme");s?n(s):window.matchMedia("(prefers-color-scheme: dark)").matches&&n("dark")},[]),E.useEffect(()=>{const s=window.document.documentElement;e==="dark"?s.classList.add("dark"):s.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const r=()=>{n(s=>s==="light"?"dark":"light")};return h.jsx(iM.Provider,{value:{theme:e,toggleTheme:r},children:t})},xq=()=>{const t=E.useContext(iM);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},bq=({activeTab:t,onTabChange:e,isOpen:n,onClose:r})=>{const{theme:s,toggleTheme:a}=xq(),l=[{id:"DASHBOARD",label:"Dashboard",icon:BE},{id:"SMART_SEARCH",label:"Search (Layer 2)",icon:rx},{id:"RAG_SEARCH",label:"LogosChat (Layer 3)",icon:a6},{id:"FLOW",label:"Flux (Layer 4)",icon:o6},{id:"BOOK",label:"Books",icon:nx},{id:"ARTICLE",label:"Articles",icon:pf},{id:"WEBSITE",label:"Websites",icon:mf},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:HE},{id:"NOTES",label:"All Notes",icon:PE}];return h.jsxs(h.Fragment,{children:[n&&h.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-40 lg:hidden backdrop-blur-sm",onClick:r}),h.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50 w-[269px] bg-[#262D40] border-r border-white/10 transform transition-transform duration-300 ease-in-out flex flex-col shadow-xl lg:shadow-none h-full
        ${n?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:[h.jsxs("div",{className:"px-3 pt-0 pb-3 flex flex-col items-center border-b border-white/10 bg-[#262D40] gap-2 relative",children:[h.jsx("img",{src:sM,alt:"TomeHub Icon",className:"h-16 lg:h-[77px] w-auto object-contain brightness-110 drop-shadow-md"}),h.jsx("button",{onClick:r,className:"lg:hidden absolute top-2 right-3 p-1 hover:bg-white/10 rounded-full text-white/70 hover:text-white transition-colors",children:h.jsx(cs,{size:20})})]}),h.jsx("nav",{className:"flex-1 px-3 pt-2 pb-6 space-y-1 overflow-y-auto",children:l.map(c=>{const d=c.icon,p=t===c.id;return h.jsxs("button",{onClick:()=>{e(c.id),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-xs lg:text-sm font-medium transition-all duration-200 group ${p?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[h.jsx(d,{className:`w-[17px] h-[17px] lg:w-5 lg:h-5 transition-colors ${p?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),c.label]},c.id)})}),h.jsxs("div",{className:"p-3 border-t border-white/10",children:[h.jsxs("button",{onClick:()=>{e("PROFILE"),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-xs lg:text-sm font-medium transition-all duration-200 group ${t==="PROFILE"?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[h.jsx(sb,{className:`w-[17px] h-[17px] lg:w-5 lg:h-5 transition-colors ${t==="PROFILE"?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),"Profile"]}),h.jsx("button",{onClick:a,className:"w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-xs lg:text-sm font-medium text-white/70 hover:bg-white/5 hover:text-white transition-all duration-200 group mt-1",children:s==="light"?h.jsxs(h.Fragment,{children:[h.jsx(T3,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-white/60 group-hover:text-white"}),"Dark Mode"]}):h.jsxs(h.Fragment,{children:[h.jsx(oR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-amber-400"}),"Light Mode"]})})]}),h.jsx("div",{className:"p-4 border-t border-white/10",children:h.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[h.jsx("p",{className:"text-xs text-white/70 font-medium mb-1",children:"My Personal Library"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CC561E] animate-pulse"}),h.jsx("p",{className:"text-[10px] text-white/50 uppercase tracking-wider font-semibold",children:"Online"})]})]})})]})]})},yq=({books:t,userId:e})=>{const[n,r]=E.useState(!1),[s,a]=E.useState(0),[l,c]=E.useState({success:0,failed:0,total:0}),[d,p]=E.useState(""),[m,g]=E.useState(null),[b,v]=E.useState(!1),w=async()=>{if(!e)return;r(!0),g(null),v(!1);let C=0,k=0;c({success:0,failed:0,total:t.length});const N=t.map(O=>{if(Pt(O)&&!$E(O))return null;let F="";return O.type==="PERSONAL_NOTE"?(F=Wa(O.generalNotes||"")||O.title,O.highlights&&O.highlights.length>0&&(F+=`

`+O.highlights.map(V=>V.text).join(`

`))):(F=`Title: ${O.title}
Author: ${O.author}
`,O.generalNotes&&(F+=`
Summary/Notes: ${Wa(O.generalNotes)}`),O.tags&&O.tags.length>0&&(F+=`
Tags: ${O.tags.join(", ")}`)),{text:F,title:O.title,author:O.author,type:Pt(O)?VE(O):O.type,book_id:O.id,tags:O.tags}}).filter(O=>!!O&&O.text.length>20),M=N.length,_=20,P=[];for(let O=0;O<N.length;O+=_)P.push(N.slice(O,O+_));let z=0;for(let O=0;O<P.length;O++){const F=P[O];p(`Batch ${O+1}/${P.length} (${F.length} items)`);try{const V=await AV(F,e);V.success&&V.results&&(C+=V.results.success,k+=V.results.failed)}catch(V){console.error(`Batch ${O+1} failed:`,V),k+=F.length}z+=F.length,a(Math.round(z/M*100)),c(V=>({...V,success:C,failed:k+(t.length-M)}))}const K=t.filter(O=>O.highlights&&O.highlights.length>0);if(K.length>0){p("Syncing highlights...");for(const O of K)try{await Q5(e,O.id,O.title,O.author,O.highlights||[])}catch(F){console.error(`Highlight sync failed for ${O.title}:`,F)}}r(!1),v(!0),p("")};return h.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-slate-50 dark:from-[#262D40]/20 dark:to-slate-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:h.jsxs("div",{className:"p-6 md:p-8",children:[h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(_4,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Migrate to AI Library"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Sync your existing books and notes to the new AI backend to make them searchable."})]})]}),h.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[h.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:n?"Migration in Progress...":"Ready to Sync"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:b?h.jsxs("span",{className:"text-[#262D40] font-medium",children:["Migration Complete! ",l.success," items synced."]}):n?h.jsxs("span",{children:["Syncing: ",h.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:d})]}):h.jsxs("span",{children:["Sync ",t.length," items to Oracle AI Vector Database."]})})]}),!n&&!b&&h.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-6 py-3 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg font-medium transition-colors shadow-md shadow-[#CC561E]/20 dark:shadow-none",children:[h.jsx(gE,{size:18,fill:"currentColor"}),"Start Migration"]}),n&&h.jsxs("div",{className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-slate-500 rounded-lg border border-slate-200 dark:border-slate-700",children:[h.jsx(Jt,{size:18,className:"animate-spin"}),"Processing..."]})]}),(n||b)&&h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[h.jsx("span",{children:"Progress"}),h.jsxs("span",{children:[s,"%"]})]}),h.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:`${s}%`}})}),h.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[h.jsxs("span",{children:[l.success+l.failed,"/",l.total," items"]}),h.jsxs("span",{children:["Success: ",l.success,"  Failed: ",l.failed]})]})]})]})]})})},vq=()=>{const{user:t}=bp(),[e,n]=E.useState(!1),[r,s]=E.useState(0),[a,l]=E.useState(0),[c,d]=E.useState(!1),[p,m]=E.useState(null),g=E.useRef(null),b=async C=>{var M;const k=(M=C.target.files)==null?void 0:M[0];if(!k)return;if(!k.name.toLowerCase().endsWith(".json")){m("Please upload a valid JSON file.");return}const N=new FileReader;N.onload=async _=>{var P;try{const z=(P=_.target)==null?void 0:P.result,K=JSON.parse(z);if(!Array.isArray(K))throw new Error("JSON must be an array of books.");await v(K)}catch(z){console.error("File parsing error:",z),m("Failed to parse JSON file. Make sure it's a valid list of books.")}},N.onerror=()=>{m("Error reading file.")},N.readAsText(k)},v=async C=>{if(!t)return;n(!0),m(null),d(!1),l(C.length),s(0);let k=0;try{for(const N of C){const M={id:Date.now().toString()+Math.random().toString(36).substr(2,9),type:"BOOK",title:N.title||"Untitled",author:N.author||"Unknown Author",status:"On Shelf",readingStatus:"To Read",tags:[],highlights:[],addedAt:Date.now(),coverUrl:N.coverUrl||void 0};await ja(t.uid,M);try{const _=`Title: ${M.title}
Author: ${M.author}`;await X5(_,M.title,M.author,M.type,t.uid,{book_id:M.id,tags:M.tags||[]})}catch(_){console.error("Import sync to AI backend failed:",_)}k++,s(k),await new Promise(_=>setTimeout(_,50))}d(!0),g.current&&(g.current.value="")}catch(N){console.error("Import failed:",N),m("Failed to import books. Please try again.")}finally{n(!1)}},w=()=>{var C;(C=g.current)==null||C.click()};return h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 md:p-8 mt-6",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Import Books"}),h.jsx("p",{className:"text-slate-500 mt-1",children:"Upload a JSON file to add books to your library."})]}),h.jsx("div",{className:"p-3 bg-[#262D40]/5 text-[#262D40] rounded-lg",children:h.jsx(hE,{size:24})})]}),p&&h.jsxs("div",{className:"mb-4 p-4 bg-red-50 text-red-700 rounded-lg flex items-center gap-2",children:[h.jsx(rl,{size:20}),p]}),c?h.jsxs("div",{className:"mb-4 p-4 bg-green-50 text-green-700 rounded-lg flex items-center gap-2",children:[h.jsx(rb,{size:20}),"Successfully imported ",a," books!"]}):null,e?h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[h.jsx("span",{children:"Importing..."}),h.jsxs("span",{children:[Math.round(r/a*100),"%"]})]}),h.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2.5 overflow-hidden",children:h.jsx("div",{className:"bg-[#262D40]/40 h-2.5 rounded-full transition-all duration-300",style:{width:`${r/a*100}%`}})}),h.jsxs("p",{className:"text-xs text-slate-400 text-center mt-2",children:[r," / ",a," books processed"]})]}):h.jsxs(h.Fragment,{children:[h.jsx("input",{type:"file",ref:g,onChange:b,accept:".json",className:"hidden"}),h.jsxs("button",{onClick:w,disabled:e,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white shadow-md hover:shadow-lg",children:[h.jsx(jf,{size:20}),"Select JSON File"]})]})]})},wq=({books:t})=>{const[e,n]=E.useState(!1),[r,s]=E.useState(!1),[a,l]=E.useState(null),c=()=>{try{n(!0),l(null),s(!1);const d=t.map(w=>({...w,id:w.id,type:w.type,title:w.title,author:w.author,status:w.status,readingStatus:w.readingStatus,tags:w.tags,highlights:w.highlights,addedAt:w.addedAt,generalNotes:w.generalNotes,coverUrl:w.coverUrl,isbn:w.isbn,publisher:w.publisher,publicationYear:w.publicationYear,translator:w.translator,code:w.code,url:w.url,lentTo:w.lentTo,lentDate:w.lentDate})),p=JSON.stringify(d,null,2),m=new Blob([p],{type:"application/json"}),g=URL.createObjectURL(m),b=document.createElement("a");b.href=g;const v=new Date().toISOString().split("T")[0];b.download=`tomehub-export-${v}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(g),s(!0),n(!1),setTimeout(()=>{s(!1)},3e3)}catch(d){console.error("Export failed:",d),l("Failed to export library. Please try again."),n(!1)}};return h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 md:p-8 mt-6",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Export Library"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Download your entire library as a JSON file."})]}),h.jsx("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg",children:h.jsx(hE,{size:24})})]}),a&&h.jsxs("div",{className:"mb-4 p-4 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg flex items-center gap-2 border border-[#262D40]/8 dark:border-[#262D40]/30",children:[h.jsx(rl,{size:20}),a]}),r&&h.jsxs("div",{className:"mb-4 p-4 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 rounded-lg flex items-center gap-2 border border-orange-100 dark:border-orange-900/30",children:[h.jsx(rb,{size:20}),"Successfully exported ",t.length," items!"]}),h.jsxs("button",{onClick:c,disabled:e||t.length===0,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#CC561E] dark:bg-[#CC561E] hover:bg-[#b34b1a] text-white shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(D4,{size:20}),t.length===0?"No Items to Export":`Export ${t.length} Items`]}),h.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 text-center mt-3",children:"Exports all books, articles, websites, and notes with highlights"})]})},kq=({userId:t,email:e,onLogout:n,onBack:r,books:s,onStartEnrichment:a,onStopEnrichment:l,isEnriching:c,enrichmentStats:d})=>{const p=s.filter(m=>m.type==="BOOK"&&(!m.generalNotes||m.generalNotes.length<10)&&(!m.tags||m.tags.length===0)).length;return h.jsxs("div",{className:"p-6 md:p-10 max-w-[1100px] w-full mx-auto animate-in fade-in slide-in-from-bottom-4",children:[h.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white mb-6 transition-colors group",children:[h.jsx(cE,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),h.jsx("span",{className:"font-medium",children:"Back"})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Profile"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Manage your account settings"})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden mb-8",children:[h.jsxs("div",{className:"p-6 md:p-8 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-start md:items-center gap-6",children:[h.jsx("div",{className:"w-20 h-20 bg-[#262D40]/8 dark:bg-[#262D40]/30 rounded-full flex items-center justify-center text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(sb,{size:40})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Account Information"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Signed in as"}),h.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-slate-200 mt-1",children:e||"No email available"})]})]}),h.jsx("div",{className:"p-6 md:p-8 bg-slate-50/50 dark:bg-slate-900/50",children:h.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30",children:[h.jsx(v3,{size:20}),"Log Out"]})})]}),h.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-purple-50 dark:from-[#262D40]/20 dark:to-purple-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:h.jsxs("div",{className:"p-6 md:p-8",children:[h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(Ks,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"AI Library Assistant"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Automatically fill in missing summaries and tags for your imported books."})]})]}),h.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[h.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:c?"Enrichment in Progress...":"Library Status"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:c?h.jsxs("span",{children:["Processing: ",h.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:d.currentBookTitle||"Initializing..."})]}):h.jsxs("span",{children:[h.jsx("span",{className:"font-bold text-[#262D40] dark:text-[#262D40]/82",children:p})," books are missing details."]})})]}),c?h.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30 shadow-sm",children:[h.jsx(rR,{size:18,fill:"currentColor"}),"Stop"]}):h.jsxs("button",{onClick:()=>a(s),disabled:p===0,className:"flex items-center gap-2 px-6 py-3 bg-[#262D40]/40 dark:bg-[#262D40]/30 text-white hover:bg-[#262D40]/55 dark:hover:bg-[#262D40]/40 rounded-lg font-medium transition-colors shadow-md shadow-[#262D40]/12 dark:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(gE,{size:18,fill:"currentColor"}),"Auto-fill Missing Info"]})]}),c&&h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[h.jsx("span",{children:"Progress"}),h.jsxs("span",{children:[Math.round(d.processed/d.total*100),"%"]})]}),h.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-[#262D40]/30 dark:bg-[#262D40]/24 transition-all duration-500 ease-out",style:{width:`${d.processed/d.total*100}%`}})}),h.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[h.jsxs("span",{children:["Processed: ",d.processed,"/",d.total]}),h.jsxs("span",{children:["Success: ",d.success,"  Failed: ",d.failed]})]})]})]})]})}),h.jsx(yq,{books:s,userId:t}),h.jsx(vq,{}),h.jsx(wq,{books:s})]})},Cq=({data:t,onBarClick:e,currentStartPage:n,currentEndPage:r})=>{const{maxPage:s,maxCount:a,bars:l}=E.useMemo(()=>{if(!t||t.length===0)return{maxPage:0,maxCount:0,bars:[]};const c=Math.max(...t.map(p=>p.page_number)),d=Math.max(...t.map(p=>p.count));return{maxPage:c,maxCount:d,bars:t}},[t]);return l.length===0?null:h.jsxs("div",{className:"w-full space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-mono uppercase tracking-wider",children:[h.jsx("span",{children:"Page 1"}),h.jsx("span",{children:"Distribution Timeline"}),h.jsxs("span",{children:["Page ",s]})]}),h.jsxs("div",{className:"relative w-full h-[60px] bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden flex items-end",children:[h.jsxs("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none p-[1px]",children:[h.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"}),h.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"})]}),l.map(c=>{const d=(c.page_number-1)/s*100,p=c.count/a*100,m=c.count>a*.7;return h.jsxs("div",{onClick:()=>e&&e(c.page_number),className:"absolute bottom-0 cursor-pointer transition-all hover:opacity-80 group",style:{left:`${d}%`,height:`${p}%`,width:`max(2px, ${100/s}%)`,minHeight:"4px"},children:[h.jsx("div",{className:`w-full h-full rounded-t-sm ${m?"bg-[#262D40]/30 dark:bg-[#262D40]/24":"bg-[#262D40]/18 dark:bg-[#262D40]/40"}`}),h.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block z-20 whitespace-nowrap",children:h.jsxs("div",{className:"bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg",children:["Page ",c.page_number,": ",c.count," hits"]})})]},c.page_number)})]})]})},aM=({bookId:t,term:e,initialContexts:n=[],firebaseUid:r,onClose:s})=>{const[a,l]=We.useState(n||[]),[c,d]=We.useState(!1),[p,m]=We.useState((a==null?void 0:a.length)||0),[g,b]=We.useState(((a==null?void 0:a.length)||0)>=10),[v,w]=We.useState([]);E.useEffect(()=>{(async()=>{try{const M=await jV(r,t,e);w(M.distribution||[])}catch(M){console.error("Dist fetch failed",M)}})()},[t,e,r]);const C=async()=>{if(!c){d(!0);try{const N=await OV(r,t,e,50,p);N.contexts.length>0?(l(M=>[...M,...N.contexts]),m(M=>M+N.contexts.length)):b(!1)}catch(N){console.error("Failed to load more contexts:",N)}finally{d(!1)}}},k=(N,M)=>{if(!M)return N;const _=N.split(new RegExp(`(${M})`,"gi"));return h.jsx(h.Fragment,{children:_.map((P,z)=>P.toLowerCase()===M.toLowerCase()?h.jsx("mark",{className:"bg-yellow-200 text-slate-900 font-semibold rounded-sm px-0.5",children:P},z):P)})};return h.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-950 border-l border-slate-200 dark:border-slate-800 shadow-xl animate-in slide-in-from-right duration-300",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-900 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:['"',e,'" Balamlar']}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total occurrences found"})]}),h.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-500",children:h.jsx(cs,{size:20})})]}),h.jsxs("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 m-4 rounded-lg border border-[#262D40]/8 dark:border-[#262D40]/70 flex gap-3 text-xs text-[#262D40] dark:text-[#262D40]/78",children:[h.jsx(i3,{size:16,className:"shrink-0 mt-0.5"}),h.jsx("p",{children:"Bu liste, kelimenin kitaptaki farkl formlarn (ekim ekleri, kk formlar) ve getii orijinal pasajlar gsterir."})]}),h.jsx("div",{className:"px-4 pb-2",children:h.jsx(Cq,{data:v})}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[a.map((N,M)=>h.jsxs("div",{className:"group relative",children:[h.jsxs("div",{className:"flex justify-between items-start mb-1 text-[10px] items-center",children:[h.jsxs("span",{className:"font-semibold text-[#262D40] dark:text-[#262D40]/82 bg-[#262D40]/5 dark:bg-[#262D40]/40 px-1.5 py-0.5 rounded uppercase tracking-wider",children:["Sayfa ",N.page_number]}),h.jsxs("button",{className:"text-slate-300 group-hover:text-slate-500 dark:text-slate-700 dark:group-hover:text-slate-400 flex items-center gap-1 transition-colors",children:[h.jsx("span",{className:"text-[9px]",children:"GRNTLE"}),h.jsx(Uh,{size:10})]})]}),h.jsx("div",{className:"text-sm md:text-base text-slate-700 dark:text-slate-300 leading-relaxed font-lora border-l-2 border-slate-100 dark:border-slate-800 pl-4 py-1 italic hover:border-[#262D40]/18 dark:hover:border-[#262D40]/55 transition-colors",children:k(N.snippet,N.keyword_found)})]},M)),g&&h.jsx("button",{onClick:C,disabled:c,className:"w-full py-4 text-sm font-medium text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-xl hover:border-[#262D40]/12 dark:hover:border-[#262D40]/70 hover:bg-slate-50 dark:hover:bg-slate-900 transition-all flex items-center justify-center gap-2",children:c?h.jsxs(h.Fragment,{children:[h.jsx(Jt,{size:16,className:"animate-spin"}),"Ykleniyor..."]}):"Daha Fazla Balam Ykle"})]})]})},Sq=new Set(["ve","veya","ile","ama","fakat","ancak","lakin","ki","de","da","gibi","icin","iin","gore","gre","kadar","hem","ya","yada","yahut","mi","mu","m","m"]);function Eq({userId:t,onBack:e,books:n=[]}){const[r,s]=E.useState(""),[a,l]=E.useState([]),[c,d]=E.useState(!1),[p,m]=E.useState(null),[g,b]=E.useState(!1),[v,w]=E.useState(null),[C,k]=E.useState(!1),[N,M]=E.useState(0),[_,P]=E.useState(0),z=20,K=(F,V)=>{if(!V||!F)return F;const Z={i:"[iI]",:"[iI]",s:"[sS]",:"[sS]",c:"[cC]",:"[cC]",g:"[gG]",:"[gG]",o:"[oO]",:"[oO]",u:"[uU]",:"[uU]"},he=V.toLowerCase().split(/\s+/).map(Te=>Te.trim()).filter(Te=>Te.length>=2&&!Sq.has(Te));if(he.length===0)return F;try{const Te=he.map(Ee=>Ee.split("").map(q=>Z[q]||q).join("")),ve=new RegExp(`((?<![\\p{L}\\p{N}])(?:${Te.join("|")})[\\p{L}\\p{N}]*(?![\\p{L}\\p{N}]))`,"giu");return F.split(ve).map((Ee,q)=>q%2===1?h.jsx("mark",{className:"bg-[rgba(204,86,30,0.12)] dark:bg-[rgba(204,86,30,0.25)] text-[#111827] dark:text-white px-0.5 rounded font-medium shadow-sm transition-colors duration-200",children:Ee},q):h.jsx("span",{children:Ee},q))}catch{return F}},O=async(F,V=0)=>{var Z,he,Te;if(F&&F.preventDefault(),!!r.trim()){d(!0),m(null),V===0&&(l([]),b(!0)),M(V);try{const ve=`${Xe}/api/smart-search`;console.log("[SmartSearch] Calling:",ve,"Offset:",V);const Se=await At(ve,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:r,firebase_uid:t,limit:z,offset:V})});if(!Se.ok)throw new Error(await Kr(Se,"Search failed"));const Ee=await Se.json();((Z=Ee.metadata)==null?void 0:Z.status)==="analytic"&&((he=Ee.metadata)!=null&&he.analytics)?(w({...Ee.metadata.analytics,answer:Ee.answer}),l([]),P(0)):(l(Ee.results||[]),P(Ee.total||((Te=Ee.results)==null?void 0:Te.length)||0),w(null))}catch(ve){console.error("[SmartSearch] Error:",ve),m(Go(ve))}finally{d(!1)}}};return h.jsxs("div",{className:"flex flex-col h-full p-6 max-w-[1100px] mx-auto w-full animate-in fade-in duration-500",children:[h.jsxs("div",{className:"sticky top-0 z-50 -mx-6 px-6 pt-2 md:pt-6 pb-2 md:pb-4 bg-[#F7F8FB]/95 dark:bg-[#0b0e14]/95 backdrop-blur border-b border-[#E6EAF2]/60 dark:border-white/5",children:[g?h.jsxs("div",{className:"flex items-center gap-4",children:[e&&h.jsxs("button",{onClick:e,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(rx,{className:"w-6 h-6"}),h.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent",children:"Search"})]})]}):h.jsxs("div",{className:"flex flex-row md:flex-col items-center justify-center gap-3 md:space-y-3 relative",children:[e&&h.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 md:top-0 md:translate-y-0",children:h.jsxs("button",{onClick:e,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),h.jsx("div",{className:"inline-flex items-center justify-center p-2 md:p-3 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl mb-0 md:mb-2 shrink-0",children:h.jsx(rx,{className:"w-6 h-6 md:w-8 md:h-8"})}),h.jsx("h2",{className:"text-2xl md:text-4xl font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight",children:"Search"})]}),h.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-xl border border-[#E6EAF2] dark:border-gray-700 overflow-hidden mt-2 md:mt-4 max-w-2xl mx-auto",children:h.jsx("div",{className:"p-2 md:p-3",children:h.jsxs("form",{onSubmit:O,className:"flex items-center gap-2",children:[h.jsxs("div",{className:"relative flex-1 group",children:[h.jsx(Us,{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400 group-focus-within:text-[#262D40]"}),h.jsx("input",{type:"text",placeholder:"Ktphanende akll arama yap...",value:r,onChange:F=>s(F.target.value),className:"w-full pl-9 md:pl-12 pr-4 py-2 md:py-4 text-base md:text-lg bg-transparent border-none outline-none text-gray-900 dark:text-gray-100 placeholder:text-gray-400 font-medium"})]}),h.jsx("button",{type:"submit",disabled:c||!r.trim(),className:"px-4 md:px-8 py-2 md:py-4 bg-[#262D40] hover:bg-[#1d2333] text-white rounded-xl md:rounded-2xl font-bold text-sm md:text-base transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-[#262D40]/20",children:c?h.jsx(Jt,{className:"w-4 h-4 md:w-5 md:h-5 animate-spin"}):h.jsx("span",{children:"Search"})})]})})})]}),!g&&h.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-gray-900/40 px-6 py-3 rounded-2xl border border-[#E6EAF2] dark:border-gray-700 flex flex-wrap gap-4 text-sm text-gray-500 font-medium mt-6",children:[h.jsxs("span",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 px-3 py-1 rounded-full border border-[#E6EAF2] dark:border-gray-700 shadow-sm",children:[h.jsx(Ks,{className:"w-4 h-4 text-[#CC561E]"})," AI Query Expansion"]}),h.jsxs("span",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 px-3 py-1 rounded-full border border-[#E6EAF2] dark:border-gray-700 shadow-sm",children:[h.jsx(xR,{className:"w-4 h-4 text-[#262D40]/90"})," Typo Correction"]}),h.jsxs("span",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 px-3 py-1 rounded-full border border-[#E6EAF2] dark:border-gray-700 shadow-sm",children:[h.jsx(Ba,{className:"w-4 h-4 text-[#262D40]/90"})," Hybrid Retrieval"]})]}),p&&h.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/78 p-5 rounded-2xl flex items-center gap-4 border border-[#262D40]/8 dark:border-[#262D40]/50 shadow-sm",children:[h.jsx(rl,{className:"w-6 h-6 shrink-0"}),h.jsx("p",{className:"font-medium",children:p})]}),h.jsx("div",{className:"space-y-6 pb-12 mt-6",children:a.length>0?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"flex items-center justify-between px-2",children:h.jsxs("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider",children:["Found ",_," relevant items"]})}),h.jsx("div",{className:"grid gap-5",children:a.map((F,V)=>h.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 border border-[#E6EAF2] dark:border-gray-700 transition-all duration-300",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("h3",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 flex items-center gap-3 group-hover:text-[#CC561E] transition-colors",children:[h.jsx(Ba,{className:"w-5 h-5 text-[#CC561E]"}),K(F.title,r)]}),h.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[F.match_type==="content_exact"&&h.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Match"}),F.match_type==="semantic"&&h.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Semantic"}),h.jsxs("span",{className:"bg-[#262D40] text-white text-xs px-3 py-1 rounded-full font-mono font-medium ring-1 ring-white/10",children:["p.",F.page_number]})]})]}),h.jsx("div",{className:"pl-5 border-l-4 border-[#262D40]/10 group-hover:border-[#CC561E]/30 transition-colors",children:h.jsx("p",{className:"text-gray-700 dark:text-gray-200 leading-relaxed text-base whitespace-pre-wrap font-serif",children:K(F.content_chunk,r)})}),(F.comment||F.personal_comment)&&h.jsxs("div",{className:"mt-4 pt-4 border-t border-[#E6EAF2] dark:border-gray-700 bg-[rgba(204,86,30,0.08)] dark:bg-[rgba(204,86,30,0.1)] -mx-6 px-6 py-4 rounded-b-2xl",children:[h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#CC561E] block mb-1",children:"Comment:"}),h.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 italic border-l-2 border-[#CC561E]/30 pl-3",children:K(F.comment||F.personal_comment||"",r)})]})]},V))}),_>z&&h.jsxs("div",{className:"flex items-center justify-between mt-10 pt-6 border-t border-[#E6EAF2] dark:border-gray-700",children:[h.jsxs("button",{onClick:()=>O(void 0,Math.max(0,N-z)),disabled:c||N===0,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:[h.jsx(Fs,{size:20}),"Previous"]}),h.jsxs("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:["Page ",Math.floor(N/z)+1," of ",Math.ceil(_/z)]}),h.jsxs("button",{onClick:()=>O(void 0,N+z),disabled:c||N+z>=_,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:["Next",h.jsx(Fs,{size:20,className:"rotate-180"})]})]})]}):g&&!c&&!p?h.jsxs("div",{className:"text-center py-24 opacity-60",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-gray-800 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6",children:h.jsx(Us,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),h.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"No results found"})]}):null}),v&&h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-xl border-t-4 border-[#CC561E] animate-in zoom-in duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute right-[-20px] top-[-20px] opacity-[0.03] dark:opacity-[0.05] pointer-events-none",children:h.jsx(F4,{size:220})}),h.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] text-xs font-bold uppercase tracking-widest",children:[h.jsx(Ks,{size:12}),"Deterministic Analytics"]}),h.jsx("h3",{className:"text-3xl font-extrabold text-slate-900 dark:text-white leading-tight",children:v.answer})]}),v.contexts&&v.contexts.length>0&&h.jsxs("button",{onClick:()=>k(!0),className:"group flex items-center gap-3 bg-[#CC561E] hover:bg-[#b34b1a] text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-[#CC561E]/30 transition-all hover:scale-[1.02] active:scale-[0.98]",children:[h.jsx(pE,{size:20,className:"group-hover:rotate-12 transition-transform"}),"See Contexts"]})]})]}),C&&v&&h.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[h.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>k(!1)}),h.jsx("div",{className:"relative w-full max-w-lg h-full overflow-hidden",children:h.jsx(aM,{bookId:v.resolved_book_id||"",term:v.term,initialContexts:v.contexts,firebaseUid:t,onClose:()=>k(!1)})})]})]})}const Nq=(t,e)=>{const[n,r]=E.useState(!1),[s,a]=E.useState({total:0,processed:0,success:0,failed:0}),l=E.useRef(!1),c=E.useCallback(async p=>{const m=p.filter(b=>b.type==="BOOK"&&(!(b.summaryText||b.generalNotes)||(b.summaryText||b.generalNotes||"").length<10)&&(!b.tags||b.tags.length===0));if(m.length===0){alert("No books found that need enrichment!");return}r(!0),l.current=!1,a({total:m.length,processed:0,success:0,failed:0,currentBookTitle:""});const g=5;for(let b=0;b<m.length&&!l.current;b+=g){const v=m.slice(b,b+g),w=v.map(C=>C.title).join(", ");a(C=>({...C,currentBookTitle:`Batch: ${w.substring(0,30)}...`}));try{b>0&&await new Promise(N=>setTimeout(N,2e3));const C=v.map(N=>gp(N)),k=await W5(C);for(let N=0;N<v.length;N++){const M=v[N],_=k.find(P=>P.title===M.title)||k[N];if(_){const P=xp(M,_);await ja(t,P),e(P),a(z=>({...z,processed:z.processed+1,success:z.success+1}))}else a(P=>({...P,processed:P.processed+1,failed:P.failed+1}))}}catch(C){console.error(`Failed to enrich batch starting at ${b}:`,C),a(k=>({...k,processed:k.processed+v.length,failed:k.failed+v.length}))}}r(!1),a(b=>({...b,currentBookTitle:void 0}))},[t,e]),d=E.useCallback(()=>{l.current=!0},[]);return{isEnriching:n,stats:s,startEnrichment:c,stopEnrichment:d}},Tq=({state:t})=>{const[e,n]=E.useState(!1);return!t.active_topic&&(!t.assumptions||t.assumptions.length===0)?null:h.jsx("div",{className:"sticky top-0 z-10 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border-b border-[#CC561E]/10 dark:border-slate-700 shadow-sm transition-all",children:h.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-2 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>n(!e),children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("div",{className:"p-1.5 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-md flex-shrink-0",children:h.jsx(fE,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("p",{className:"text-[10px] font-bold text-[#CC561E] dark:text-[#f3a47b] uppercase tracking-widest",children:"Current Topic"}),h.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:t.active_topic||"Initializing exploration..."})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[t.assumptions&&t.assumptions.length>0&&h.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 text-xs px-2 py-1 rounded-full bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border border-amber-100 dark:border-amber-800/50",children:[h.jsx($i,{className:"w-3 h-3"}),t.assumptions.length," Assumptions"]}),e?h.jsx(dE,{className:"w-4 h-4 text-slate-400"}):h.jsx(_a,{className:"w-4 h-4 text-slate-400"})]})]}),e&&h.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-700 space-y-4 pb-2 animate-fade-in-down",children:[t.assumptions&&t.assumptions.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx($i,{className:"w-3 h-3"})," Working Assumptions"]}),h.jsx("div",{className:"grid gap-2",children:t.assumptions.map((r,s)=>h.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 bg-amber-50/50 dark:bg-amber-900/10 p-2 rounded border-l-2 border-amber-400",children:[r.text,h.jsxs("span",{className:"ml-2 text-xs text-amber-600 dark:text-amber-500 font-medium opacity-75",children:["(",r.confidence,")"]})]},s))})]}),t.open_questions&&t.open_questions.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx(C4,{className:"w-3 h-3"})," Open Questions"]}),h.jsx("ul",{className:"space-y-1",children:t.open_questions.map((r,s)=>h.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[h.jsx("span",{className:"text-slate-400 mt-1.5",children:""}),r]},s))})]}),t.established_facts&&t.established_facts.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx(Yc,{className:"w-3 h-3"})," Validated Facts"]}),h.jsx("ul",{className:"space-y-1",children:t.established_facts.map((r,s)=>h.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[h.jsx(Yc,{className:"w-3 h-3 text-green-500 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[r.text,h.jsxs("span",{className:"ml-1 text-xs text-slate-400",children:["[",r.source,"]"]})]})]},s))})]})]})]})})},Aq=({userId:t,onBack:e})=>{var q,te,G,I,H,A,R,W,oe,xe,L,ae;const[n,r]=E.useState([]),[s,a]=E.useState(""),[l,c]=E.useState(!1),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState(new Set),[w,C]=E.useState(new Set),[k,N]=E.useState(null),[M,_]=E.useState("AUTO"),[P,z]=E.useState({}),K=E.useRef(null),O=E.useRef(null);E.useEffect(()=>{var U;(U=K.current)==null||U.scrollIntoView({behavior:"smooth"})},[n]),E.useEffect(()=>{var U;(U=O.current)==null||U.focus()},[]);const F=async()=>{var ne;if(!s.trim()||l)return;if(!t||t.includes("@")){g("Authentication error. Please refresh the page.");return}const U={id:Date.now(),role:"user",content:s.trim(),timestamp:new Date().toISOString()};r(ie=>[...ie,U]),a(""),c(!0),g(null);try{const ie=await SV(U.content,t,d,"EXPLORER",null,20,M);ie.session_id&&p(ie.session_id),ie.conversation_state&&z(ie.conversation_state);const je={id:Date.now()+1,role:"assistant",content:ie.answer||"",sources:ie.sources||[],thinkingHistory:ie.thinking_history||[],timestamp:ie.timestamp||new Date().toISOString()};r(Ue=>[...Ue,je])}catch(ie){g(ie instanceof Error?ie.message:"Failed to send message")}finally{c(!1),(ne=O.current)==null||ne.focus()}},V=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),F())},Z=U=>{C(ne=>{const ie=new Set(ne);return ie.has(U)?ie.delete(U):ie.add(U),ie})},he=U=>{v(ne=>{const ie=new Set(ne);return ie.has(U)?ie.delete(U):ie.add(U),ie})},Te=()=>{var U;r([]),p(null),g(null),z({}),(U=O.current)==null||U.focus()},ve=U=>U.replace(/\[DNCE SREC\][\s\S]*?\[\/DNCE SREC\]/,"").replace(/## AAMA 0:[\s\S]*?(?=##)/,"").trim(),Se=(U,ne,ie)=>ne?U.split(/(\[ID: \d+\])/g).map((Ue,lt)=>{const Fe=Ue.match(/\[ID: (\d+)\]/);if(Fe){const nt=parseInt(Fe[1]);if(ne.find(Me=>Me.id===nt))return h.jsx("button",{onMouseEnter:Me=>{const rt=Me.currentTarget.getBoundingClientRect();N({id:nt,messageId:ie||0,x:rt.left,y:rt.top-10})},onMouseLeave:()=>N(null),className:"inline-flex items-center justify-center w-5 h-5 mx-0.5 text-[10px] font-bold bg-[#CC561E]/10 dark:bg-[#CC561E]/20 text-[#CC561E] dark:text-[#f3a47b] rounded-md border border-[#CC561E]/20 dark:border-[#CC561E]/30 hover:bg-[#CC561E] hover:text-white transition-all transform hover:-translate-y-0.5 cursor-help",children:nt},lt)}return Ue}):U,Ee=(U,ne,ie)=>{const je=ve(U);let Ue=!1;return je.split(`
`).map((lt,Fe)=>{const nt=lt.trim();if(nt.toLowerCase().includes("keif nerileri")||nt.toLowerCase().includes("exploration paths"))return Ue=!0,h.jsxs("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 mt-6 mb-3 flex items-center gap-2",children:[h.jsx(fE,{className:"w-4 h-4 text-[#CC561E]"}),nt]},Fe);if(nt.startsWith("## ")||nt.startsWith("### ")&&!Ue)return h.jsx("h3",{className:"text-base font-bold text-[#CC561E] dark:text-[#f3a47b] mt-5 mb-2",children:nt.replace(/^#+\s+/,"")},Fe);if(nt==="")return h.jsx("div",{className:"h-2"},Fe);if(Ue&&(nt.startsWith("-")||nt.startsWith("")||/^\d+\./.test(nt))){const pt=nt.replace(/^[-\d.]+\s+/,"");return h.jsx("div",{onClick:()=>{l||a(pt)},className:"ml-2 mb-2 p-3 bg-white dark:bg-slate-800/50 border border-[#CC561E]/10 dark:border-[#CC561E]/20 rounded-xl shadow-sm hover:shadow-md hover:border-[#CC561E]/40 dark:hover:border-[#CC561E]/60 transition-all cursor-pointer group active:scale-[0.98]",children:h.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-200 flex items-center gap-3",children:[h.jsxs("span",{className:"w-6 h-6 flex-shrink-0 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full flex items-center justify-center text-[10px] font-bold text-[#CC561E] group-hover:bg-[#CC561E] group-hover:text-white transition-colors",children:[Fe-10," "]}),pt]})},Fe)}else return h.jsx("p",{className:`text-sm leading-relaxed mb-2 ${Ue?"text-slate-500 dark:text-slate-400 italic":"text-slate-700 dark:text-slate-300"}`,children:Se(lt,ne,ie)},Fe)})};return h.jsx("div",{className:"flex h-[calc(100vh-120px)] w-full gap-4",children:h.jsxs("div",{className:"flex flex-col flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-t-xl",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-lg",children:h.jsx(X0,{className:"w-5 h-5 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"font-semibold text-slate-900 dark:text-white",children:"Explorer Mode"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:d?`Session #${d}  ${n.length} messages`:"New conversation"})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-slate-200 dark:border-slate-700 text-xs text-slate-600 dark:text-slate-300 bg-slate-50 dark:bg-slate-800",children:[h.jsx("input",{type:"checkbox",checked:M==="BOOK_FIRST",onChange:U=>_(U.target.checked?"BOOK_FIRST":"AUTO"),className:"w-3.5 h-3.5 rounded border-slate-300 text-[#CC561E] focus:ring-[#CC561E]/40","aria-label":"Bu kitapla snrla"}),"Bu kitapla snrla"]}),h.jsxs("button",{onClick:Te,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Start new conversation",children:[h.jsx(xE,{className:"w-4 h-4"}),"New"]}),e&&h.jsx("button",{onClick:e,className:"px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Back"})]})]}),h.jsx(Tq,{state:P}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 dark:bg-slate-900",children:[n.length===0&&!l&&h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[h.jsx("div",{className:"p-4 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full mb-4",children:h.jsx(Ba,{className:"w-8 h-8 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"Explorer Mode"}),h.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-md",children:"Ask deep, philosophical questions. I'll analyze your notes dialectically, identify gaps, and expand with general knowledge when needed."}),h.jsx("div",{className:"mt-6 space-y-2",children:["What is the relationship between consciousness and reality?","How do different philosophers define virtue?","Analyze the concept of free will in my notes"].map((U,ne)=>h.jsx("button",{onClick:()=>a(U),className:"block w-full text-left px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300 hover:bg-[#CC561E]/5 dark:hover:bg-[#CC561E]/10 transition-colors",children:U},ne))})]}),n.map(U=>h.jsxs("div",{className:`flex gap-3 ${U.role==="user"?"justify-end":"justify-start"}`,children:[U.role==="assistant"&&h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:h.jsx(v2,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{className:`max-w-[80%] ${U.role==="user"?"order-first":""}`,children:[U.role==="assistant"&&U.thinkingHistory&&U.thinkingHistory.length>0&&h.jsxs("div",{className:"mb-2",children:[h.jsxs("button",{onClick:()=>Z(U.id),className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-400 hover:text-[#CC561E] transition-colors",children:[h.jsx(f4,{className:"w-3 h-3"}),w.has(U.id)?"Hide Reflection":"Show Reflection",h.jsxs("span",{className:"opacity-50",children:[" ",U.thinkingHistory.length," Iterations"]})]}),w.has(U.id)&&h.jsx("div",{className:"mt-2 mb-3 space-y-3 bg-slate-100/50 dark:bg-slate-800/50 p-3 rounded-xl border border-dashed border-slate-200 dark:border-slate-700 animate-fade-in",children:U.thinkingHistory.map((ne,ie)=>h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ne.evaluation.verdict==="PASSED"?"bg-green-500":ne.evaluation.verdict==="DECLINE"?"bg-red-500":"bg-amber-500"}`}),h.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:["STEP ",ne.attempt,": ",ne.evaluation.verdict]})]}),h.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:[h.jsx(Y4,{className:"w-2.5 h-2.5"}),(ne.latency/1e3).toFixed(1),"s"]})]}),h.jsx("div",{className:"h-1 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:h.jsx("div",{className:`h-full transition-all duration-1000 ${ne.evaluation.overall_score>.7?"bg-green-500":ne.evaluation.overall_score>.4?"bg-amber-500":"bg-red-500"}`,style:{width:`${ne.evaluation.overall_score*100}%`}})}),h.jsx("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-snug",children:ne.evaluation.explanation})]},ie))})]}),h.jsx("div",{className:`rounded-2xl px-4 py-3 ${U.role==="user"?"bg-[#CC561E] text-white rounded-br-md shadow-lg shadow-[#CC561E]/20":"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-bl-md"}`,children:U.role==="user"?h.jsx("p",{className:"text-sm",children:U.content}):h.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:Ee(U.content,U.sources,U.id)})}),U.role==="assistant"&&U.sources&&U.sources.length>0&&h.jsxs("div",{className:"mt-2",children:[h.jsxs("button",{onClick:()=>he(U.id),className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] transition-colors",children:[b.has(U.id)?h.jsx(dE,{className:"w-3 h-3"}):h.jsx(_a,{className:"w-3 h-3"}),U.sources.length," sources"]}),b.has(U.id)&&h.jsx("div",{className:"mt-2 space-y-1 pl-2 border-l-2 border-[#CC561E]/30 dark:border-[#CC561E]/50",children:U.sources.map((ne,ie)=>h.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 py-1 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800/50 rounded px-1",children:[h.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[9px] font-bold",children:ne.id||ie+1}),h.jsx("span",{className:"font-medium",children:ne.title}),h.jsxs("span",{className:"ml-2 text-slate-400 text-[10px]",children:["p.",ne.page_number]})]},ie))})]})]}),U.role==="user"&&h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E] flex items-center justify-center",children:h.jsx(sb,{className:"w-4 h-4 text-white"})})]},U.id)),k&&h.jsx("div",{className:"fixed z-50 pointer-events-none",style:{left:k.x,top:k.y-120},children:h.jsxs("div",{className:"w-64 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl p-4 animate-in fade-in zoom-in duration-200 origin-bottom",children:[(te=(q=n.find(U=>U.id===k.messageId))==null?void 0:q.sources)!=null&&te.find(U=>U.id===k.id)?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2 text-[#CC561E]",children:[h.jsx(Jc,{className:"w-3 h-3"}),h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Source Snippet"})]}),h.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-300 leading-relaxed italic mb-3",children:['"...',(A=(H=(I=(G=n.find(U=>U.id===k.messageId))==null?void 0:G.sources)==null?void 0:I.find(U=>U.id===k.id))==null?void 0:H.content)==null?void 0:A.slice(0,200),'..."']}),h.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 dark:border-slate-700 pt-2 text-[10px] text-slate-400",children:[h.jsx("span",{className:"font-medium truncate max-w-[120px]",children:(oe=(W=(R=n.find(U=>U.id===k.messageId))==null?void 0:R.sources)==null?void 0:W.find(U=>U.id===k.id))==null?void 0:oe.title}),h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(Uh,{className:"w-2.5 h-2.5"}),"p.",(ae=(L=(xe=n.find(U=>U.id===k.messageId))==null?void 0:xe.sources)==null?void 0:L.find(U=>U.id===k.id))==null?void 0:ae.page_number]})]})]}):h.jsx("p",{className:"text-xs text-slate-400",children:"Loading source info..."}),h.jsx("div",{className:"absolute -bottom-1 left-4 w-2 h-2 bg-white dark:bg-slate-800 border-r border-b border-slate-200 dark:border-slate-700 rotate-45"})]})}),l&&h.jsxs("div",{className:"flex gap-3",children:[h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:h.jsx(v2,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:h.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[h.jsx(Jt,{className:"w-4 h-4 animate-spin"}),"Analyzing deeply..."]})})]}),m&&h.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-300",children:m}),h.jsx("div",{ref:K})]}),h.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-b-xl",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx("input",{ref:O,type:"text",value:s,onChange:U=>a(U.target.value),onKeyPress:V,placeholder:"Ask a deep question...",disabled:l,className:"flex-1 px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#CC561E] focus:border-transparent disabled:opacity-50"}),h.jsx("button",{onClick:F,disabled:!s.trim()||l,className:"px-4 py-3 bg-[#CC561E] hover:bg-[#b34b1a] disabled:bg-slate-300 dark:disabled:bg-slate-700 text-white rounded-xl transition-all shadow-lg shadow-[#CC561E]/20 flex items-center gap-2",children:l?h.jsx(Jt,{className:"w-5 h-5 animate-spin"}):h.jsx(K3,{className:"w-5 h-5"})})]})})]})})},Mq=({userId:t,userEmail:e,onBack:n,books:r=[]})=>{var V,Z,he,Te;const[s,a]=E.useState(""),[l,c]=E.useState(!1),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState("none"),[w,C]=E.useState(!1),[k,N]=E.useState("STANDARD"),[M,_]=E.useState(""),[P,z]=E.useState(!1);if(k==="EXPLORER")return h.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-6 animate-fade-in space-y-4",children:[h.jsx("div",{className:"flex justify-start",children:h.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back to Home"})]})}),h.jsx("div",{className:"flex justify-center mb-2 md:mb-4",children:h.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center",children:[h.jsx("button",{type:"button",onClick:()=>N("STANDARD"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-500 hover:text-slate-700 dark:text-slate-400",children:"Standard"}),h.jsxs("button",{type:"button",className:"px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:[h.jsx(X0,{className:"w-4 h-4 text-[#CC561E]"})," Explorer"]})]})}),h.jsx(Aq,{userId:t,onBack:()=>N("STANDARD")})]});const K=async ve=>{if(ve.preventDefault(),!s.trim()){g("Please enter a question");return}if(!t||t.includes("@")){g("Authentication is still loading. Please wait a moment and try again.");return}c(!0),g(null),p(null),v("none");try{const Se=await CV(s,t,"STANDARD");p(Se),_(s)}catch(Se){g(Go(Se))}finally{c(!1)}},O=async ve=>{var Se;if(!(!d||w)){C(!0);try{await EV({firebase_uid:t,query:M||s,answer:d.answer,rating:ve,search_log_id:(Se=d.metadata)==null?void 0:Se.search_log_id}),v(ve===1?"liked":"disliked")}catch(Ee){console.error("Feedback failed:",Ee)}finally{C(!1)}}},F=(d==null?void 0:d.answer.replace(/## AAMA 0:[\s\S]*?(?=##)/,"").trim())||"";return h.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-3 md:p-6 space-y-4 md:space-y-6",children:[h.jsx("div",{className:"flex justify-start",children:h.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back to Home"})]})}),h.jsxs("form",{onSubmit:K,className:"space-y-3 md:space-y-4",children:[h.jsx("div",{className:"flex justify-center mb-2 md:mb-4",children:h.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center",children:[h.jsx("button",{type:"button",className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:"Standard"}),h.jsxs("button",{type:"button",onClick:()=>N("EXPLORER"),className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all flex items-center gap-1.5 md:gap-2 text-slate-500 hover:text-slate-700 dark:text-slate-400",children:[h.jsx(X0,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})," Explorer"]})]})}),h.jsxs("div",{className:"relative",children:[h.jsx(Us,{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400"}),h.jsx("input",{type:"text",value:s,onChange:ve=>a(ve.target.value),placeholder:"Ask a question about your books...",className:"w-full pl-10 md:pl-12 pr-3 md:pr-4 py-2.5 md:py-4 rounded-xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-sm md:text-base text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#CC561E] transition-all",disabled:l})]}),h.jsxs("div",{className:"text-[11px] md:text-xs text-slate-500 dark:text-slate-400",children:["Tip: Kelimeyi netletirmek iin ",h.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:"@zaman"})," gibi yazabilirsin."]}),h.jsxs("button",{type:"submit",disabled:l||!s.trim(),className:"w-full bg-[#CC561E] hover:bg-[#b34b1a] text-white text-sm md:text-base font-medium py-2.5 md:py-3 px-4 md:px-6 rounded-xl transition-all shadow-lg shadow-[#CC561E]/20 flex items-center justify-center gap-1.5 md:gap-2 disabled:bg-slate-300",children:[l?h.jsx(Jt,{className:"w-4 h-4 md:w-5 md:h-5 animate-spin"}):h.jsx(Us,{className:"w-4 h-4 md:w-5 md:h-5"}),l?"Searching...":"Search"]})]}),m&&h.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 flex items-start gap-3",children:[h.jsx(rl,{className:"w-5 h-5 text-red-600 shrink-0 mt-0.5"}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-red-900 dark:text-red-100",children:"Search Failed"}),h.jsx("p",{className:"text-sm text-red-700 mt-1",children:m})]})]}),d&&h.jsxs("div",{className:"space-y-4 md:space-y-6",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[h.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[h.jsx(Ba,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Answer"]}),h.jsx("div",{className:"max-w-none",children:F.split(`
`).map((ve,Se)=>{const Ee=ve.trim();return Ee.startsWith("## ")?h.jsx("h3",{className:"text-base md:text-lg font-bold underline decoration-[#CC561E]/50 underline-offset-4 mt-2.5 md:mt-6 mb-1 md:mb-2.5 text-slate-900 dark:text-white",children:Ee.replace(/^##\s+/,"")},Se):Ee===""?h.jsx("div",{className:"h-1 md:h-2"},Se):h.jsx("p",{className:"text-justify text-[14px] md:text-base leading-[1.55] md:leading-relaxed text-slate-700 dark:text-slate-300 mb-1.5 md:mb-2",children:ve},Se)})}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2.5 md:gap-4 pt-2.5 md:pt-4 border-t border-[#E6EAF2] dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center gap-2.5 md:gap-4",children:[h.jsx("span",{className:"text-xs md:text-sm text-slate-500 dark:text-slate-400",children:"Was this answer helpful?"}),h.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[h.jsx("button",{onClick:()=>O(1),disabled:b!=="none"||w,className:`p-1.5 md:p-2 rounded-lg transition-colors ${b==="liked"?"bg-green-100 text-green-600":"text-slate-400 hover:text-green-600"}`,children:h.jsx(hR,{className:"w-4 h-4 md:w-5 md:h-5"})}),h.jsx("button",{onClick:()=>O(0),disabled:b!=="none"||w,className:`p-1.5 md:p-2 rounded-lg transition-colors ${b==="disliked"?"bg-red-100 text-red-600":"text-slate-400 hover:text-red-600"}`,children:h.jsx(dR,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),((V=d.metadata)==null?void 0:V.status)==="analytic"&&((he=(Z=d.metadata)==null?void 0:Z.analytics)==null?void 0:he.contexts)&&d.metadata.analytics.contexts.length>0&&h.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-1.5 md:gap-2 text-[#CC561E] hover:text-[#b34b1a] font-bold text-xs md:text-sm transition-colors py-1.5 md:py-2 px-2.5 md:px-3 hover:bg-orange-50 dark:hover:bg-orange-900/10 rounded-lg",children:[h.jsx(pE,{size:14,className:"md:w-4 md:h-4"}),"See Contexts"]})]})]}),d.sources&&d.sources.length>0&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[h.jsxs("h3",{className:"text-base md:text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[h.jsx(Uh,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Sources (",d.sources.length,")"]}),h.jsx("div",{className:"space-y-1.5 md:space-y-2",children:d.sources.map((ve,Se)=>h.jsxs("div",{className:"flex items-start gap-2 md:gap-3 p-2 md:p-3 rounded-lg bg-[#F3F5FA] dark:bg-slate-700/50 hover:bg-[#F3F5FA] transition-colors",children:[h.jsx("div",{className:"flex-shrink-0 w-5 h-5 md:w-6 md:h-6 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] flex items-center justify-center text-xs md:text-sm font-medium",children:Se+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm md:text-base font-medium text-slate-900 dark:text-white truncate",children:ve.title}),h.jsxs("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:["Page ",ve.page_number]})]})]},Se))})]})]}),P&&((Te=d==null?void 0:d.metadata)==null?void 0:Te.analytics)&&h.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[h.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>z(!1)}),h.jsx("div",{className:"relative w-full max-w-2xl h-full bg-white dark:bg-gray-900 shadow-2xl flex flex-col",children:h.jsx(aM,{term:d.metadata.analytics.term,bookId:d.metadata.analytics.resolved_book_id,initialContexts:d.metadata.analytics.contexts,firebaseUid:t,onClose:()=>z(!1)})})]})]})},Ru=async()=>{const e=my().currentUser;if(!e)throw new Error("User must be logged in to use Knowledge Stream");return await e.getIdToken()},Oq=12e4,Wc=new Map,K0=new Map,oM=t=>{const e=t.anchor_type||"note",n=t.anchor_id||"",r=t.mode||"FOCUS",s=Number(t.horizon_value??.25).toFixed(2),a=(t.resource_type||"").toUpperCase(),l=(t.category||"").toUpperCase();return[t.firebase_uid,e,n,r,s,a,l].join("|")},lM=t=>t?Date.now()-t.createdAt<=Oq:!1;async function jq(t){const e=oM(t),n=Wc.get(e);if(lM(n))return;const r=K0.get(e);if(r){await r;return}const s=(async()=>{const a=await cM(t);return Wc.set(e,{response:a,createdAt:Date.now()}),a})();K0.set(e,s);try{await s}finally{K0.delete(e)}}function _q(t){const e=oM(t),n=Wc.get(e);return lM(n)?(Wc.delete(e),n.response):(Wc.delete(e),null)}async function cM(t){if(!t.firebase_uid)throw new Error("User must be authenticated");const e=await Ru(),n=await fetch(`${Xe}/api/flow/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to start flow session")}return n.json()}async function G0(t){const e=await Ru(),n=await fetch(`${Xe}/api/flow/next`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to get next batch")}return n.json()}async function Rq(t){const e=await Ru(),n=await fetch(`${Xe}/api/flow/feedback`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to send feedback")}return n.json()}async function Dq(t,e,n){const r=await Ru(),s=await fetch(`${Xe}/api/flow/adjust`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({session_id:t,horizon_value:e,firebase_uid:n})});if(!s.ok){const a=await s.json();throw new Error(a.detail||"Failed to adjust horizon")}return s.json()}async function $S(t,e,n,r,s,a){const l=await Ru(),c=await fetch(`${Xe}/api/flow/reset-anchor`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({session_id:t,anchor_type:e,anchor_id:n,firebase_uid:r,resource_type:s,category:a})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"Failed to reset anchor")}return c.json()}const VS={1:{color:"#CC561E",label:"Tight Context",icon:""},2:{color:"#e66a2e",label:"Author's Mind",icon:""},3:{color:"#b34b1a",label:"Syntopic Debate",icon:""},4:{color:"#CC561E",label:"Keif Kprs",icon:""}},Lq=({card:t,sessionId:e,firebaseUid:n,onFeedback:r})=>{const[s,a]=E.useState(!1),[l,c]=E.useState(null),d=VS[t.zone]||VS[1],p=async m=>{try{await Rq({firebase_uid:n,session_id:e,chunk_id:t.chunk_id,action:m}),c(m),r==null||r(m)}catch(g){console.error("Feedback failed:",g)}};return h.jsxs("div",{className:"flow-card",style:{"--zone-color":d.color},children:[h.jsxs("div",{className:"flow-card__top-bar",children:[h.jsxs("div",{className:"flow-card__zone-indicator",children:[h.jsx("span",{className:"zone-dot",style:{backgroundColor:d.color}}),h.jsx("span",{className:"zone-label",children:d.label})]}),t.page_number!==void 0&&t.page_number!==null&&t.page_number>0&&h.jsxs("div",{className:"flow-card__meta-item",children:[h.jsx("span",{className:"text-slate-500 mr-1.5 opacity-50",children:"#"}),h.jsxs("span",{children:["Page ",t.page_number]})]})]}),h.jsxs("div",{className:"flow-card__header",children:[h.jsx("h3",{className:"flow-card__title",children:t.title}),t.author&&h.jsxs("div",{className:"flow-card__author-pill",children:[h.jsx("span",{className:"opacity-60 italic",children:"by"})," ",t.author]})]}),h.jsx("div",{className:`flow-card__content ${s?"expanded":""}`,children:h.jsx("p",{children:t.content})}),h.jsxs("div",{className:"flow-card__footer",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flow-card__feedback",children:[h.jsx("button",{className:`feedback-btn ${l==="like"?"active like":""}`,onClick:()=>p("like"),disabled:!!l,title:"Relevant",children:h.jsx("span",{className:"btn-icon",children:""})}),h.jsx("button",{className:`feedback-btn ${l==="dislike"?"active dislike":""}`,onClick:()=>p("dislike"),disabled:!!l,title:"Not relevant",children:h.jsx("span",{className:"btn-icon",children:""})}),h.jsx("button",{className:`feedback-btn ${l==="save"?"active save":""}`,onClick:()=>p("save"),disabled:!!l,title:"Keep in Library",children:h.jsx("span",{className:"btn-icon",children:""})})]}),t.reason&&h.jsx("div",{className:"flow-card__footer-reason",children:t.reason})]}),h.jsx("button",{className:`expand-toggle ${s?"is-expanded":""}`,onClick:()=>a(!s),children:s?"Collapse":"Read More"})]}),h.jsx("style",{children:`
                .flow-card {
                    background: #ffffff;
                    border: 1px solid #E6EAF2;
                    border-left: 3px solid var(--zone-color);
                    border-radius: 20px;
                    padding: 20px;
                    margin-bottom: 12px;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                    overflow: hidden;
                }

                @media (max-width: 768px) {
                    .flow-card {
                        padding: 16px;
                        margin-bottom: 8px;
                        border-radius: 16px;
                    }
                }

                @media (min-width: 769px) {
                    .flow-card {
                            margin-bottom: 10px;
                    }
                }
                
                .dark .flow-card {
                    background: rgba(15, 23, 42, 0.5);
                    border-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    right: 0;
                    width: 150px;
                    height: 150px;
                    background: radial-gradient(circle at top right, var(--zone-color), transparent 70%);
                    opacity: 0.04;
                    pointer-events: none;
                }

                .flow-card:hover {
                    background: #ffffff;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    box-shadow: 0 12px 40px rgba(15, 23, 42, 0.08);
                }

                .dark .flow-card:hover {
                    background: rgba(15, 23, 42, 0.7);
                    border-color: rgba(204, 86, 30, 0.3);
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
                }

                .flow-card__top-bar {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 16px;
                }

                .flow-card__zone-indicator {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .zone-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 50%;
                    box-shadow: 0 0 10px var(--zone-color);
                }

                .zone-label {
                    font-size: 11px;
                    font-weight: 700;
                    letter-spacing: 0.05em;
                    text-transform: uppercase;
                    color: var(--zone-color);
                    opacity: 0.9;
                }

                @media (max-width: 768px) {
                    .zone-label {
                        font-size: 9px;
                    }
                }

                .flow-card__meta-item {
                    font-size: 12px;
                    font-weight: 600;
                    color: #64748b;
                }

                @media (max-width: 768px) {
                    .flow-card__meta-item {
                        font-size: 10px;
                    }
                }

                .flow-card__header {
                    margin-bottom: 12px;
                }

                .flow-card__title {
                    font-family: 'Outfit', 'Inter', sans-serif;
                    font-size: 17px;
                    font-weight: 700;
                    color: #1e293b;
                    line-height: 1.3;
                    margin: 0 0 8px 0;
                }

                @media (max-width: 768px) {
                    .flow-card__title {
                        font-size: 15px;
                    }
                }

                .dark .flow-card__title {
                    color: #f1f5f9;
                }

                .flow-card__author-pill {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 4px 12px;
                    background: #F3F5FA;
                    border: 1px solid #E6EAF2;
                    border-radius: 100px;
                    font-size: 12px;
                    color: #475569;
                    font-weight: 500;
                }

                .dark .flow-card__author-pill {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .flow-card__content {
                    color: #475569;
                    font-size: 15px;
                    line-height: 1.7;
                    max-height: 120px;
                    overflow: hidden;
                    position: relative;
                    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                }

                .dark .flow-card__content {
                    color: #94a3b8;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.95));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-card__content.expanded {
                    max-height: 2000px;
                    color: #111827;
                }

                .dark .flow-card__content.expanded {
                    color: #f1f5f9;
                }

                .flow-card__footer-reason {
                    font-size: 12px;
                    line-height: 1.5;
                    color: rgba(204, 86, 30, 0.7);
                    font-weight: 600;
                    font-style: italic;
                    letter-spacing: 0.02em;
                }

                @media (max-width: 768px) {
                    .flow-card__footer-reason {
                        font-size: 10px;
                    }
                }

                .flow-card__footer {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-top: 16px;
                    padding-top: 14px;
                    border-top: 1px solid #E6EAF2;
                }

                .dark .flow-card__footer {
                    border-top-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card__feedback {
                    display: flex;
                    gap: 8px;
                }

                .feedback-btn {
                    width: 38px;
                    height: 38px;
                    border-radius: 10px;
                    border: 1px solid #E6EAF2;
                    background: #ffffff;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    color: #64748b;
                }

                .dark .feedback-btn {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .feedback-btn:hover:not(:disabled) {
                    background: #F3F5FA;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    color: #1e293b;
                }

                .dark .feedback-btn:hover:not(:disabled) {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(204, 86, 30, 0.4);
                    color: #f1f5f9;
                }

                .feedback-btn.active.like { background: rgba(34, 197, 94, 0.1); color: #22c55e; border-color: rgba(34, 197, 94, 0.2); }
                .feedback-btn.active.dislike { background: rgba(239, 68, 68, 0.1); color: #ef4444; border-color: rgba(239, 68, 68, 0.2); }
                .feedback-btn.active.save { background: rgba(204, 86, 30, 0.1); color: #CC561E; border-color: rgba(204, 86, 30, 0.2); }

                .expand-toggle {
                    background: transparent;
                    border: none;
                    color: #CC561E;
                    font-size: 13px;
                    font-weight: 700;
                    cursor: pointer;
                    padding: 8px 16px;
                    border-radius: 8px;
                    transition: all 0.2s ease;
                }

                @media (max-width: 768px) {
                    .expand-toggle {
                        font-size: 11px;
                        padding: 6px 12px;
                    }
                }

                .expand-toggle:hover {
                    background: rgba(204, 86, 30, 0.1);
                    transform: translateX(4px);
                }
            `})]})},Iq=[{label:" Focus",description:"Deep context & related works"},{label:" Syntopic",description:"Similar ideas across different authors"},{label:" Discovery",description:"Unexpected connections & serendipity"}],zq=({value:t,onChange:e,disabled:n=!1})=>{const s=(a=>a<.33?0:a<.66?1:2)(t);return h.jsxs("div",{className:"horizon-slider",children:[h.jsxs("div",{className:"horizon-slider__header",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"horizon-slider__title",children:"Epistemic Horizon"}),h.jsx("span",{className:"text-[10px] text-card-foreground/70 font-medium tracking-tight",children:"Search Breadth Control"})]}),h.jsxs("div",{className:"horizon-slider__value-badge",children:[Math.round(t*100),"%"]})]}),h.jsxs("div",{className:"horizon-slider__track-container",children:[h.jsx("input",{type:"range",min:"0",max:"100",value:t*100,onChange:a=>e(parseInt(a.target.value)/100),disabled:n,className:"horizon-slider__input"}),h.jsx("div",{className:"horizon-slider__progress",style:{width:`${t*100}%`}})]}),h.jsx("div",{className:"horizon-slider__zones",children:Iq.map((a,l)=>{const c=l===s,d=a.label.split(" ")[0],p=a.label.split(" ")[1];return h.jsxs("div",{className:`horizon-slider__zone ${c?"active":""}`,onClick:()=>e(l*.333+.165),children:[h.jsx("span",{className:"zone-emoji",children:d}),h.jsx("span",{className:"zone-text",children:p}),c&&h.jsx("div",{className:"active-indicator"})]},l)})}),h.jsx("style",{children:`
                .horizon-slider {
                    background: hsl(var(--card));
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    padding: 12px;
                }

                .horizon-slider__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    margin-bottom: 12px;
                }

                .horizon-slider__title {
                    font-size: 13px;
                    font-weight: 700;
                    color: hsl(var(--card-foreground));
                    letter-spacing: -0.01em;
                    font-family: 'Outfit', sans-serif;
                }

                .horizon-slider__value-badge {
                    padding: 2px 8px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 11px;
                    font-weight: 800;
                    border-radius: 6px;
                    font-family: 'JetBrains Mono', monospace;
                }

                .horizon-slider__track-container {
                    position: relative;
                    height: 4px;
                    background: rgba(255, 255, 255, 0.08);
                    border-radius: 100px;
                    margin-bottom: 12px;
                    overflow: visible;
                }

                .horizon-slider__input {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    -webkit-appearance: none;
                    appearance: none;
                    background: transparent;
                    cursor: pointer;
                    z-index: 5;
                    margin: 0;
                    padding: 0;
                }

                .horizon-slider__input::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #fff;
                    box-shadow: 0 0 10px rgba(204, 86, 30, 0.5);
                    cursor: grab;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                    border: 3px solid #CC561E;
                }

                .horizon-slider__input::-webkit-slider-thumb:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 20px rgba(204, 86, 30, 0.7);
                }

                .horizon-slider__progress {
                    position: absolute;
                    top: 0;
                    left: 0;
                    height: 100%;
                    background: linear-gradient(90deg, #CC561E 0%, #e66a2e 100%);
                    border-radius: 100px;
                    pointer-events: none;
                    z-index: 1;
                }

                .horizon-slider__zones {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 2px;
                }

                .horizon-slider__zone {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 2px;
                    padding: 8px 2px;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    position: relative;
                }

                .horizon-slider__zone:hover {
                    background: rgba(255, 255, 255, 0.06);
                }

                .horizon-slider__zone.active {
                    background: rgba(204, 86, 30, 0.08);
                }

                .zone-emoji {
                    font-size: 14px;
                    filter: grayscale(1) opacity(0.55);
                    transition: all 0.3s ease;
                }

                .horizon-slider__zone.active .zone-emoji {
                    filter: grayscale(0) opacity(1);
                    transform: scale(1.1);
                }

                .zone-text {
                    font-size: 9px;
                    font-weight: 700;
                    color: rgba(255, 255, 255, 0.7);
                    text-transform: uppercase;
                    letter-spacing: 0.02em;
                    transition: all 0.3s ease;
                    text-align: center;
                }

                .horizon-slider__zone.active .zone-text {
                    color: rgba(255, 255, 255, 0.95);
                }

                .active-indicator {
                    position: absolute;
                    bottom: 0;
                    width: 3px;
                    height: 3px;
                    background: #CC561E;
                    border-radius: 50%;
                    box-shadow: 0 0 8px #CC561E;
                }
            `})]})},Bq=({activeFilter:t,onFilterChange:e})=>{const n=[{id:"ALL",label:"All Notes",icon:c3,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"BOOK",label:"Books",icon:nb,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"ARTICLE",label:"Articles",icon:xu,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"WEBSITE",label:"Websites",icon:$h,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:sl,color:"text-slate-400",bg:"bg-slate-500/10"}];return h.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[h.jsxs("h3",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[h.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Source Navigator"]}),h.jsx("div",{className:"space-y-1",children:n.map(r=>{const s=r.icon,a=t===r.id;return h.jsxs("button",{onClick:()=>e(r.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl transition-all duration-300 group relative overflow-hidden border bg-card text-card-foreground ${a?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[h.jsxs("div",{className:"flex items-center gap-2.5 relative z-10",children:[h.jsx("div",{className:`p-1.5 rounded-lg transition-all duration-300 ${a?"text-[#CC561E]":"text-card-foreground/70 group-hover:text-card-foreground"}`,children:h.jsx(s,{size:18})}),h.jsx("span",{className:`text-xs font-medium tracking-tight ${a?"text-card-foreground":"text-card-foreground/80 group-hover:text-card-foreground"}`,children:r.label})]}),a&&h.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r.id)})})]})},Pq=({firebaseUid:t,anchorType:e,anchorId:n,anchorLabel:r,categoryOptions:s,onClose:a})=>{const[l,c]=E.useState(null),[d,p]=E.useState([]),[m,g]=E.useState(r||"Flux"),[b,v]=E.useState(null),[w,C]=E.useState(.25),[k,N]=E.useState(!1),[M,_]=E.useState(!0),[P,z]=E.useState(null),[K,O]=E.useState(!1),[F,V]=E.useState(!1),[Z,he]=E.useState(!1),[Te,ve]=E.useState(null),[Se,Ee]=E.useState(!1),[q,te]=E.useState("ALL"),G=E.useRef(null);E.useRef(null),E.useRef(null);const I=E.useCallback(L=>L==="ALL"?"ALL_NOTES":L,[]),H=E.useCallback(async(L,ae=null,U=.25)=>{if(t){N(!0),z(null),p([]),_(!0);try{const ne=I(L),ie={firebase_uid:t,anchor_type:e,anchor_id:n,mode:"FOCUS",horizon_value:U,resource_type:ne,category:ae||void 0},Ue=_q(ie)??await cM(ie);c(Ue.session_id),p(Ue.initial_cards),g(Ue.topic_label),ve(null)}catch(ne){z(Go(ne))}finally{N(!1)}}},[t,e,n,I]);E.useEffect(()=>{t&&(K||O(!0))},[t,K]),E.useEffect(()=>{K&&H(q,b,w)},[K,q,b,H]);const A=E.useCallback(async()=>{if(!(l===null||k||!M)){N(!0);try{const L=await G0({firebase_uid:t,session_id:l,batch_size:5});p(ae=>[...ae,...L.cards]),_(L.has_more),L.pivot_info&&ve(L.pivot_info)}catch(L){console.error("Failed to load more:",L)}finally{N(!1)}}},[l,t,k,M]),R=async L=>{if(C(L),!K){O(!0);return}if(l!==null)try{await Dq(l,L,t)}catch(ae){console.error("Failed to adjust horizon:",ae)}},W=async()=>{if(!K){O(!0);return}if(l!==null){N(!0),Ee(!0),z(null),ve(null);try{const L=await $S(l,"topic","General Discovery",t,I(q),b||void 0);g(L.topic_label),L.pivot_info&&ve(L.pivot_info),p([]),_(!0);const ae=await G0({session_id:l,firebase_uid:t,batch_size:5});p(ae.cards),_(ae.has_more),ae.pivot_info&&ve(ae.pivot_info)}catch(L){z(Go(L))}finally{N(!1),Ee(!1)}}},oe=L=>{if(L!==b){if(v(L),!K){O(!0);return}l!==null&&(N(!0),$S(l,"topic","General Discovery",t||"",I(q),L||void 0).then(ae=>{p([]),g(ae.topic_label),ve(ae.pivot_info||null),_(!0),G0({session_id:l,firebase_uid:t,batch_size:5}).then(U=>{p(U.cards),_(U.has_more),U.pivot_info&&ve(U.pivot_info)}).catch(U=>{console.error("Failed to load initial batch after category pivot:",U),z(Go(U))}).finally(()=>{N(!1)})}).catch(ae=>{console.error("Failed to pivot category:",ae),z(Go(ae)),N(!1)}))}},xe=L=>{L!==q&&(te(L),K||O(!0))};return h.jsxs("div",{className:"flow-container",ref:G,children:[h.jsxs("div",{className:"flow-layout",children:[h.jsxs("aside",{className:"flow-left",children:[a&&h.jsxs("button",{onClick:a,className:"flow-left__back group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back to Home"})]}),(q==="ALL"||q==="BOOK")&&h.jsx($2,{activeCategory:b,onCategoryChange:oe,categories:s})]}),h.jsxs("div",{className:"flow-main",children:[h.jsx("div",{className:"flow-container__header",children:h.jsx("div",{className:"flow-container__title-section",children:h.jsxs("div",{className:"flow-container__mobile-actions relative flex items-center justify-between",children:[h.jsxs("div",{className:"lg:hidden flex items-center gap-2 z-10 w-1/3",children:[a&&h.jsx("button",{onClick:a,className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300","aria-label":"Back",children:h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Fs,{size:16})})}),h.jsxs("button",{onClick:()=>he(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Dg,{size:16})}),h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Keif"})]})]}),h.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none",children:h.jsx("span",{className:"text-[10px] font-extrabold uppercase tracking-[0.2em] text-[#CC561E] bg-[#CC561E]/10 px-3 py-1 rounded-md",children:"FLUX"})}),h.jsx("div",{className:"lg:hidden flex items-center justify-end gap-2 z-10 w-1/3",children:h.jsxs("button",{onClick:()=>V(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Filters"}),h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Q3,{size:16})})]})})]})})}),K&&P&&h.jsxs("div",{className:"flow-container__error",children:[h.jsxs("p",{children:[" ",P]}),h.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),K&&Te&&h.jsxs("div",{className:"flow-container__pivot",children:[h.jsx("span",{className:"pivot-icon",children:""}),h.jsx("p",{children:Te.message})]}),h.jsxs("div",{className:"flow-container__cards",children:[K?h.jsxs(h.Fragment,{children:[d.map(L=>h.jsx(Lq,{card:L,sessionId:l??"",firebaseUid:t},L.flow_id)),!k&&!P&&d.length===0&&h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[h.jsx("div",{className:"text-6xl mb-6 opacity-80",children:""}),h.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-2",children:q==="PERSONAL_NOTE"?"No Personal Notes Found":"Library Empty"}),h.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:q==="PERSONAL_NOTE"?"We couldn't find any personal notes or highlights. Try adding some content or switching to 'All Notes'.":"Your knowledge stream is waiting for content. Upload books or add notes to get started."}),h.jsx("button",{onClick:a,className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Go to Dashboard"})]})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[h.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-3",children:"Flux balatlmad"}),h.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-6",children:"Balamak iin bir filtre seebilir veya aadaki butona tklayabilirsin."}),h.jsx("button",{onClick:()=>O(!0),className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Flux Balat"})]}),K&&(d.length>0||k)&&h.jsxs("div",{className:"flow-container__load-more py-8 flex justify-center",children:[k?h.jsxs("div",{className:"flex items-center gap-3 text-slate-500",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-[#CC561E] border-t-transparent rounded-full animate-spin"}),h.jsx("span",{className:"text-sm font-medium",children:Se?"Topic is shifting...":"Loading more thoughts..."})]}):M&&h.jsxs("button",{onClick:A,className:"px-8 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 text-slate-700 dark:text-slate-300 hover:text-[#CC561E] dark:hover:text-[#CC561E] font-medium rounded-full shadow-sm hover:shadow-md transition-all duration-300 flex items-center gap-2 group",children:[h.jsx("span",{children:"Daha Fazla Gster"}),h.jsx(_a,{className:"w-4 h-4 group-hover:translate-y-0.5 transition-transform"})]}),!M&&d.length>0&&h.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:h.jsx("span",{children:" You've explored all related thoughts"})})]})]})]}),h.jsxs("div",{className:`flow-category-container ${Z?"is-open":""}`,children:[h.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>he(!1)}),h.jsx("aside",{className:"flow-category-sidebar",children:h.jsxs("div",{className:"flow-sidebar__sticky",children:[h.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-6 pb-4 border-bottom border-slate-100 dark:border-slate-800",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:h.jsx(Dg,{size:20})}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Keif Alanlar"})]}),h.jsx("button",{onClick:()=>he(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(cs,{size:20})})]}),(q==="ALL"||q==="BOOK")&&h.jsx($2,{activeCategory:b,onCategoryChange:L=>{oe(L),he(!1)},categories:s})]})})]}),h.jsxs("div",{className:`flow-sidebar-container ${F?"is-open":""}`,children:[h.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>V(!1)}),h.jsx("aside",{className:"flow-sidebar",children:h.jsxs("div",{className:"flow-sidebar__sticky",children:[h.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-6 pb-4 border-bottom border-slate-100 dark:border-slate-800",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:h.jsx(Dg,{size:20})}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Controls"})]}),h.jsx("button",{onClick:()=>V(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(cs,{size:20})})]}),h.jsx(Bq,{activeFilter:q,onFilterChange:xe}),h.jsx(zq,{value:w,onChange:R,disabled:k}),h.jsxs("button",{className:"flow-sidebar__pivot-button",onClick:W,disabled:k,children:[h.jsx("span",{className:"icon",children:""}),"Change Topic"]}),h.jsx("div",{className:"flow-sidebar__stats",children:h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-label",children:"Session ID"}),h.jsx("span",{className:"stat-value",children:l!==null?l.toString():""})]})})]})})]})]}),h.jsx("style",{children:`
                .flow-container {
                    max-width: 1280px;
                    margin: 0 auto;
                    width: 100%;
                    display: flex;
                    flex-direction: column;
                    height: 100%;
                    background: transparent;
                    position: relative;
                    padding: 24px;
                }

                @media (max-width: 768px) {
                    .flow-container {
                        padding: 12px;
                    }
                }

                .flow-container::before {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: 
                        radial-gradient(circle at 10% 20%, rgba(204, 86, 30, 0.03) 0%, transparent 40%),
                        radial-gradient(circle at 90% 80%, rgba(204, 86, 30, 0.03) 0%, transparent 40%);
                    pointer-events: none;
                    z-index: -1;
                }

                .flow-layout {
                    display: grid;
                    grid-template-columns: 150px 1fr 220px;
                    gap: 20px;
                    align-items: flex-start;
                    padding-top: 20px;
                    max-width: 1280px;
                    margin: 0 auto;
                }

                @media (max-width: 1024px) {
                    .flow-layout {
                        grid-template-columns: 1fr;
                        gap: 12px;
                        padding-top: 4px;
                    }

                    .flow-left {
                        display: none;
                    }

                    .flow-sidebar-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-end;
                    }

                    .flow-category-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-start;
                    }

                    .flow-sidebar-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-category-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-sidebar-backdrop {
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0, 0, 0, 0.5);
                        backdrop-filter: blur(4px);
                        opacity: 0;
                        transition: opacity 0.4s ease;
                        pointer-events: none;
                    }

                    .is-open .flow-sidebar-backdrop {
                        opacity: 1;
                        pointer-events: auto;
                    }

                    .flow-sidebar {
                        width: 55%;
                        min-width: 250px;
                        max-width: 400px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-sidebar {
                        background: #0f172a;
                    }

                    .flow-category-sidebar {
                        width: 25%;
                        min-width: 150px;
                        max-width: 340px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(-100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-category-sidebar {
                        background: #0f172a;
                    }

                    .is-open .flow-sidebar {
                        transform: translateX(0);
                    }

                    .is-open .flow-category-sidebar {
                        transform: translateX(0);
                    }

                    .flow-sidebar__sticky {
                        height: 100%;
                        max-height: 100vh;
                        padding: 12px;
                        overflow-y: auto;
                        position: relative;
                        top: 0 !important;
                    }

                    .flow-container__mobile-actions {
                        position: sticky;
                        top: 0;
                        z-index: 100;
                        background: rgba(255, 255, 255, 0.85);
                        backdrop-filter: blur(16px);
                        margin: -20px -20px 20px -20px;
                        padding: 12px 20px;
                        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
                        width: calc(100% + 40px);
                    }

                    .flow-mobile-actions-row {
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 8px;
                        width: 100%;
                    }

                    .flow-mobile-actions-right {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-left: auto;
                    }

                    .flow-mobile-action-btn {
                        padding: 6px 10px;
                        border-radius: 10px;
                        border: 1px solid rgba(148, 163, 184, 0.22);
                        background: rgba(255, 255, 255, 0.9);
                    }

                    .dark .flow-mobile-action-btn {
                        background: rgba(15, 23, 42, 0.9);
                        border-color: rgba(255, 255, 255, 0.12);
                    }

                    .flow-badge--title {
                        display: table;
                        margin: 4px auto 0 auto;
                        text-align: center;
                        font-size: 11px;
                        padding: 6px 14px;
                        letter-spacing: 0.14em;
                    }

                    .dark .flow-container__mobile-actions {
                        background: rgba(15, 23, 42, 0.85);
                        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
                    }
                }

                @media (min-width: 1025px) {
                    .flow-container__mobile-actions {
                        display: none;
                    }

                    .flow-category-container {
                        display: none;
                    }
                }

                .flow-sidebar__sticky {
                    position: sticky;
                    top: 24px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                }

                .flow-left {
                    position: sticky;
                    top: 24px;
                    align-self: flex-start;
                }

                .flow-left__back {
                    margin-bottom: 16px;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(248, 250, 252, 0.9));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-sidebar__pivot-button {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                    width: 100%;
                    padding: 12px;
                    background: #262D40;
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-weight: 700;
                    font-size: 13px;
                    cursor: pointer;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 4px 15px rgba(38, 45, 64, 0.25);
                }

                .flow-sidebar__pivot-button:hover:not(:disabled) {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(38, 45, 64, 0.35);
                    filter: brightness(1.08);
                }

                .flow-sidebar__pivot-button:disabled {
                    opacity: 0.4;
                    cursor: not-allowed;
                    filter: grayscale(0.5);
                }

                .flow-sidebar__stats {
                    padding: 16px;
                    background: hsl(var(--card));
                    border-radius: 16px;
                    border: 1px solid rgba(255, 255, 255, 0.08);
                }

                .stat-item {
                    display: flex;
                    justify-content: space-between;
                    font-size: 11px;
                    margin-bottom: 8px;
                }

                .stat-label { color: rgba(255, 255, 255, 0.65); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
                .stat-value { color: rgba(255, 255, 255, 0.95); font-family: 'JetBrains Mono', monospace; }

                .flow-container__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-end;
                    margin-bottom: 40px;
                    padding-bottom: 24px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }

                .flow-badge {
                    display: inline-block;
                    padding: 4px 10px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 10px;
                    font-weight: 800;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    border-radius: 6px;
                    margin-bottom: 12px;
                }

                .flow-container__title {
                    margin: 0 0 8px 0;
                    font-size: 28px;
                    font-weight: 800;
                    color: #0f172a;
                    letter-spacing: -0.02em;
                    font-family: 'Outfit', sans-serif;
                }

                .dark .flow-container__title {
                    color: #fff;
                }

                .flow-container__meta {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .meta-dot {
                    width: 4px;
                    height: 4px;
                    background: #CC561E;
                    border-radius: 50%;
                }

                .flow-container__subtitle {
                    font-size: 14px;
                    color: #64748b;
                    font-weight: 500;
                }

                .flow-container__close {
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    width: 40px;
                    height: 40px;
                    font-size: 14px;
                    color: #64748b;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .flow-container__close:hover {
                    background: rgba(239, 68, 68, 0.1);
                    color: #f87171;
                    border-color: rgba(239, 68, 68, 0.2);
                }

                .flow-container__pivot {
                    background: rgba(204, 86, 30, 0.05);
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(204, 86, 30, 0.1);
                    padding: 20px 24px;
                    border-radius: 16px;
                    margin-bottom: 32px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    animation: slideInDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
                }

                @keyframes slideInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .pivot-icon {
                    font-size: 24px;
                }

                .flow-container__pivot p {
                    margin: 0;
                    color: rgba(204, 86, 30, 0.8);
                    font-size: 14px;
                    line-height: 1.6;
                    font-weight: 500;
                }

                .flow-container__cards {
                    display: flex;
                    flex-direction: column;
                    gap: 24px;
                }

                .flow-container__loader {
                    padding: 60px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 16px;
                    color: #64748b;
                    font-size: 14px;
                    font-weight: 500;
                }

                .spinner {
                    width: 24px;
                    height: 24px;
                    border: 2px solid rgba(204, 86, 30, 0.1);
                    border-top-color: #CC561E;
                    border-radius: 50%;
                    animation: spin 0.8s linear infinite;
                }

                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            `})]})},Hq=({userId:t,userEmail:e,onLogout:n})=>{const[r,s]=E.useState([]),a=E.useRef([]),[l,c]=E.useState("list"),[d,p]=E.useState(null),[m,g]=E.useState(!1),[b,v]=E.useState(null),[w,C]=E.useState(!1),[k,N]=E.useState(null),[M,_]=E.useState("DASHBOARD"),[P,z]=E.useState(!1),[K,O]=E.useState(!0),[F,V]=E.useState(null),[Z,he]=E.useState(!0),[Te,ve]=E.useState(null),[Se,Ee]=E.useState(1),[q,te]=E.useState(""),[G,I]=E.useState("ALL"),[H,A]=E.useState("date_desc"),[R,W]=E.useState(""),[oe,xe]=E.useState({}),[L,ae]=E.useState([]),[U,ne]=E.useState(!1),ie=E.useRef(!1),je=E.useRef(0),Ue=E.useRef(!1),lt=E.useMemo(()=>{const Q=me=>me.trim().toLocaleLowerCase("tr-TR"),re=new Map(Bf.map(me=>[Q(me),me])),ue=new Map;return r.filter(me=>me.type==="BOOK").forEach(me=>{(me.tags||[]).forEach(ke=>{const we=re.get(Q(ke));we&&ue.set(we,(ue.get(we)||0)+1)})}),Bf.filter(me=>(ue.get(me)||0)>=i6)},[r]);E.useEffect(()=>{a.current=r},[r]),E.useEffect(()=>{let Q=!0;async function re(){if(!t){O(!1);return}try{const[{items:ue,lastDoc:me},ke]=await Promise.all([W0(t),HS(t)]);Q&&(s(ue),ae(ke),V(me),he(!!me),ne(!1))}catch(ue){console.error("Failed to load items:",ue)}finally{Q&&O(!1)}}return re(),()=>{Q=!1}},[t]),E.useEffect(()=>{if(!t)return;let Q=!1,re=null;je.current=Date.now(),Ue.current=!1;const ue=()=>{if(Q)return;const be=typeof document<"u"&&document.visibilityState==="hidden"?5e3:2500;re=window.setTimeout(()=>{me()},be)},me=async()=>{if(Q||Ue.current){ue();return}Ue.current=!0;try{const we=await _V(t,je.current,100),be=we.events||[],Ve=be.reduce((Ae,Qe)=>{const Pe=Number(Qe.updated_at_ms||0);return Pe>Ae?Pe:Ae},0);if(je.current=Math.max(je.current,Number(we.server_time_ms||0),Ve),be.length>0){const[{items:Ae,lastDoc:Qe},Pe]=await Promise.all([W0(t),HS(t)]);Q||(s(Ae),ae(Pe),V(Qe),he(!!Qe))}}catch(we){console.warn("Realtime polling failed (non-critical):",we)}finally{Ue.current=!1,ue()}},ke=()=>{re!==null&&window.clearTimeout(re),ue()};return ue(),document.addEventListener("visibilitychange",ke),()=>{Q=!0,re!==null&&window.clearTimeout(re),document.removeEventListener("visibilitychange",ke)}},[t]),E.useEffect(()=>{},[t]),E.useEffect(()=>{const Q=()=>{setTimeout(()=>{window.scrollTo(0,0),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},100)},re=document.querySelectorAll("input, textarea");return re.forEach(ue=>{ue.addEventListener("blur",Q)}),()=>{re.forEach(ue=>{ue.removeEventListener("blur",Q)})}},[]),E.useEffect(()=>{if(!t||ie.current)return;ie.current=!0;let Q=!1,re=null,ue=null;const me=()=>{Q||jq({firebase_uid:t,anchor_type:"topic",anchor_id:"General Discovery",mode:"FOCUS",horizon_value:.25,resource_type:"ALL_NOTES"}).catch(ke=>{console.warn("Flow prewarm failed (non-critical):",ke)})};return typeof window<"u"&&typeof window.requestIdleCallback=="function"?ue=window.requestIdleCallback(()=>me(),{timeout:2500}):re=window.setTimeout(me,1200),()=>{Q=!0,re!==null&&window.clearTimeout(re),ue!==null&&typeof window<"u"&&typeof window.cancelIdleCallback=="function"&&window.cancelIdleCallback(ue)}},[t]);const Fe=E.useCallback(async(Q,re=!1)=>{if(Pt(Q))try{await MV(t,Q.id,{title:Q.title,author:Q.author,content:Wa(Q.generalNotes||""),tags:Q.tags||[],category:Dn(Q),delete_only:re})}catch(ue){console.error("Failed to sync personal note to AI Backend:",ue)}},[t]),nt=E.useCallback(Q=>{if(!Q)return;const re=L.find(ue=>ue.id===Q);return re==null?void 0:re.name},[L]),pt=E.useCallback(async Q=>{const re={...Q,id:Q.id||Date.now().toString(),addedAt:Q.addedAt||Date.now(),highlights:[]};s(ue=>[re,...ue]),g(!1),xe({});try{await ja(t,re)}catch(ue){console.error("Failed to save item to Firestore:",ue)}(async()=>{try{if(Pt(re)){await Fe(re,!1);return}const ue=[];ue.push(`Title: ${re.title}`),ue.push(`Author: ${re.author}`),Pt(re)&&re.personalNoteCategory&&ue.push(`Category: ${re.personalNoteCategory}`),Pt(re)&&re.folderPath&&ue.push(`SubFile: ${re.folderPath}`),re.publisher&&ue.push(`Publisher: ${re.publisher}`),re.tags&&re.tags.length>0&&ue.push(`Tags: ${re.tags.join(", ")}`);const me=Pt(re)?re.generalNotes:re.summaryText||re.generalNotes;me&&ue.push(`
Content/Notes:
${me}`);const ke=ue.join(`
`);ke.length>20&&(await X5(ke,re.title,re.author,Pt(re)?VE(re):re.type,t,{book_id:re.id,tags:re.tags||[]}),console.log("Synced new item to AI Backend:",re.title))}catch(ue){console.error("Failed to sync item to AI Backend:",ue)}})(),Q.type!=="PERSONAL_NOTE"&&(async()=>{try{const ue=gp(re),me=await xy(ue),ke=xp(re,me),we=a.current.find(Pe=>Pe.id===re.id);if(!we)return;const be=(Pe,st)=>JSON.stringify(Array.isArray(Pe)?Pe:[])===JSON.stringify(Array.isArray(st)?st:[]),Ve={},Ae=Pe=>{const st=re[Pe],ft=we[Pe],It=ke[Pe];It!==void 0&&It!==st&&ft===st&&(Ve[Pe]=It)};if((()=>{const Pe=re.tags||[],st=we.tags||[],ft=ke.tags||[];be(ft,Pe)||be(st,Pe)&&(Ve.tags=ft)})(),Ae("summaryText"),Ae("publisher"),Ae("translator"),Ae("publicationYear"),Ae("isbn"),Ae("coverUrl"),Ae("pageCount"),Ae("contentLanguageMode"),Ae("contentLanguageResolved"),Ae("sourceLanguageHint"),Ae("languageDecisionReason"),Ae("languageDecisionConfidence"),Object.keys(Ve).length===0)return;s(Pe=>Pe.map(st=>st.id===re.id?{...st,...Ve}:st));try{await Yx(t,re.id,Ve)}catch(Pe){console.error("Failed to patch enriched item in Oracle:",Pe)}}catch(ue){console.error("Background enrichment failed:",ue)}})()},[Yx,Fe,t]),Me=E.useCallback(Q=>{xe({personalNoteCategory:(Q==null?void 0:Q.category)||"DAILY",personalFolderId:Q==null?void 0:Q.folderId,folderPath:(Q==null?void 0:Q.folderPath)||nt(Q==null?void 0:Q.folderId)}),v(null),g(!0)},[nt]),rt=E.useCallback(Q=>{pt({type:"PERSONAL_NOTE",title:Q.title,author:"Self",status:"On Shelf",readingStatus:"Finished",tags:[],generalNotes:Q.content,addedAt:Date.now(),personalNoteCategory:Q.category,personalFolderId:Q.folderId,folderPath:Q.folderPath||nt(Q.folderId)})},[nt,pt]),De=E.useCallback(async Q=>{if(!b)return;let re=null;if(s(ue=>ue.map(me=>me.id===b?(re={...me,...Q},re):me)),g(!1),v(null),re){try{await ja(t,re)}catch(ue){console.error("Failed to update item in Firestore:",ue)}Pt(re)&&Fe(re,!1)}},[b,Fe,t]),_e=E.useCallback(async Q=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const re=r.find(me=>me.id===Q);s(me=>me.filter(ke=>ke.id!==Q)),d===Q&&(p(null),c("list"));let ue=!1;try{await fq(t,Q),ue=!0}catch(me){console.error("Failed to delete item from Firestore:",me)}if(!(!ue||!re))try{await gS(t,re.id)}catch(me){console.error("Failed to purge item from AI Backend:",me)}},[r,d,t]),an=E.useCallback(async Q=>{if(!window.confirm(`Are you sure you want to delete ${Q.length} items?`))return;const re=r.filter(ke=>Q.includes(ke.id));s(ke=>ke.filter(we=>!Q.includes(we.id))),d&&Q.includes(d)&&(p(null),c("list"));let ue=!1;try{await hq(t,Q),ue=!0}catch(ke){console.error("Failed to delete items from Firestore:",ke)}if(!ue||re.length===0)return;(await Promise.allSettled(re.map(ke=>gS(t,ke.id)))).forEach((ke,we)=>{ke.status==="rejected"&&console.error(`Failed to purge item ${re[we].id} from AI Backend:`,ke.reason)})},[r,d,t]),on=E.useCallback(async Q=>{if(!d)return;let re=null;if(s(ue=>ue.map(me=>me.id===d?(re={...me,highlights:Q},re):me)),re){try{await ja(t,re)}catch(ue){console.error("Failed to update highlights in Firestore:",ue)}(async()=>{try{await Q5(t,re.id,re.title,re.author,re.highlights||[])}catch(ue){console.error("Failed to sync highlights to AI Backend:",ue)}})()}},[d,t]),Kn=E.useCallback(async Q=>{const re=r.findIndex(ke=>ke.id===Q);if(re===-1)return;const ue=r[re],me={...ue,isFavorite:!ue.isFavorite};s(ke=>{const we=[...ke];return we[re]=me,we});try{await ja(t,me)}catch(ke){console.error("Failed to update favorite status in Firestore:",ke)}},[r,t]),Dt=E.useCallback(async(Q,re)=>{const ue=r.findIndex(be=>be.id===Q);if(ue===-1)return;const me=r[ue],ke=me.highlights.map(be=>be.id===re?{...be,isFavorite:!be.isFavorite}:be),we={...me,highlights:ke};s(be=>{const Ve=[...be];return Ve[ue]=we,Ve});try{await ja(t,we)}catch(be){console.error("Failed to update highlight favorite status in Firestore:",be)}},[r,t]),ms=E.useCallback(Q=>{s(re=>re.map(ue=>ue.id===Q.id?Q:ue))},[]),{isEnriching:Gr,stats:Gn,startEnrichment:hn,stopEnrichment:Yn}=Nq(t,ms),Xt=r.find(Q=>Q.id===d)||void 0,Pn=r.find(Q=>Q.id===b),pn=E.useCallback(Q=>{_(Q),c("list"),p(null),Ee(1),te(""),I("ALL"),W(""),Q!=="BOOK"&&ve(null)},[]),Ht=E.useCallback(Q=>{ve(Q),I("ALL"),_("BOOK"),c("list"),p(null),Ee(1),te(""),W(""),C(!1),N(null)},[]),kn=E.useCallback(Q=>{I(Q),ve(null),_("BOOK"),c("list"),p(null),Ee(1),te(""),W(""),C(!1),N(null)},[]);E.useCallback(async()=>{if(F)try{const{items:Q,lastDoc:re}=await W0(t,1e3,F);s(ue=>[...ue,...Q]),V(re),he(!!re)}catch(Q){console.error("Error loading more items:",Q)}},[t,F]);const Kt=()=>`folder-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,aa=E.useCallback(async(Q,re)=>{const ue=re.trim();if(!ue)return null;const me=Date.now(),ke=L.filter(be=>be.category===Q).reduce((be,Ve)=>Math.max(be,Ve.order),0)+1,we={id:Kt(),category:Q,name:ue,order:ke,createdAt:me,updatedAt:me};ae(be=>[...be,we]);try{return await FS(t,we),we}catch(be){return console.error("Failed to create personal note folder:",be),ae(Ve=>Ve.filter(Ae=>Ae.id!==we.id)),null}},[L,t]),ln=E.useCallback(async(Q,re)=>{const ue=re.trim();if(!ue)return!1;const me=L,ke=Date.now();ae(we=>we.map(be=>be.id===Q?{...be,name:ue,updatedAt:ke}:be));try{return await US(t,Q,{name:ue,updatedAt:ke}),s(we=>we.map(be=>!Pt(be)||be.personalFolderId!==Q?be:{...be,folderPath:ue})),!0}catch(we){return console.error("Failed to rename personal note folder:",we),ae(me),!1}},[L,t]),Jr=E.useCallback(async Q=>{if(!L.find(we=>we.id===Q))return!1;const ue=L,me=r,ke=r.filter(we=>Pt(we)&&we.personalFolderId===Q);ae(we=>we.filter(be=>be.id!==Q)),s(we=>we.map(be=>!Pt(be)||be.personalFolderId!==Q?be:{...be,personalFolderId:void 0,folderPath:void 0}));try{return await Promise.all([...ke.map(we=>uf(t,we.id,Dn(we),void 0,void 0)),pq(t,Q)]),!0}catch(we){return console.error("Failed to delete personal note folder:",we),ae(ue),s(me),!1}},[r,L,t]),Jn=E.useCallback(async(Q,re)=>{const ue=L.find(Ae=>Ae.id===Q);if(!ue)return!1;if(ue.category===re)return!0;const me=L,ke=r,we=Date.now(),be=L.filter(Ae=>Ae.category===re&&Ae.id!==Q).reduce((Ae,Qe)=>Math.max(Ae,Qe.order),0)+1,Ve=r.filter(Ae=>Pt(Ae)&&Ae.personalFolderId===Q);ae(Ae=>Ae.map(Qe=>Qe.id!==Q?Qe:{...Qe,category:re,order:be,updatedAt:we})),s(Ae=>Ae.map(Qe=>!Pt(Qe)||Qe.personalFolderId!==Q?Qe:{...Qe,personalNoteCategory:re,personalFolderId:Q,folderPath:ue.name}));try{return await Promise.all([US(t,Q,{category:re,order:be,updatedAt:we}),...Ve.map(Ae=>uf(t,Ae.id,re,Q,ue.name))]),await Promise.all(Ve.map(Ae=>Fe({...Ae,personalNoteCategory:re,personalFolderId:Q,folderPath:ue.name},!1))),!0}catch(Ae){return console.error("Failed to move personal note folder:",Ae),ae(me),s(ke),!1}},[r,L,Fe,t]),yr=E.useCallback(async(Q,re,ue)=>{const me=r.find(Pe=>Pe.id===Q);if(!me||!Pt(me))return!1;const ke=ue?L.find(Pe=>Pe.id===ue):void 0,we=ke==null?void 0:ke.id,be=ke==null?void 0:ke.name,Ve=Dn(me),Ae=me.personalFolderId,Qe=me.folderPath;if(Ve===re&&(Ae||void 0)===(we||void 0))return!0;s(Pe=>Pe.map(st=>st.id!==Q||!Pt(st)?st:{...st,personalNoteCategory:re,personalFolderId:we,folderPath:be}));try{return await uf(t,Q,re,we,be),await Fe({...me,personalNoteCategory:re,personalFolderId:we,folderPath:be},!1),!0}catch(Pe){return console.error("Failed to move personal note:",Pe),s(st=>st.map(ft=>ft.id!==Q||!Pt(ft)?ft:{...ft,personalNoteCategory:Ve,personalFolderId:Ae,folderPath:Qe})),!1}},[r,L,Fe,t]);return E.useEffect(()=>{if(K||U)return;const Q=r.filter(me=>Pt(me)&&!!me.folderPath&&!me.personalFolderId);if(Q.length===0){ne(!0);return}let re=!1;return(async()=>{const me=new Map;L.forEach(be=>{const Ve=`${be.category}::${be.name.toLowerCase()}`;me.set(Ve,be)});const ke=[],we=[];if(Q.forEach(be=>{const Ve=Dn(be),Ae=(be.folderPath||"").trim();if(!Ae)return;const Qe=`${Ve}::${Ae.toLowerCase()}`;let Pe=me.get(Qe);if(!Pe){const st=Date.now(),ft=Math.max(...L.filter(It=>It.category===Ve).map(It=>It.order),...ke.filter(It=>It.category===Ve).map(It=>It.order),0)+1;Pe={id:Kt(),category:Ve,name:Ae,order:ft,createdAt:st,updatedAt:st},ke.push(Pe),me.set(Qe,Pe)}we.push({noteId:be.id,category:Ve,folderId:Pe.id,folderPath:Pe.name})}),!re){ke.length>0&&ae(be=>[...be,...ke]),we.length>0&&s(be=>be.map(Ve=>{const Ae=we.find(Qe=>Qe.noteId===Ve.id);return!Ae||!Pt(Ve)?Ve:{...Ve,personalNoteCategory:Ae.category,personalFolderId:Ae.folderId,folderPath:Ae.folderPath}}));try{await Promise.all([...ke.map(be=>FS(t,be)),...we.map(be=>uf(t,be.noteId,be.category,be.folderId,be.folderPath))])}catch(be){console.error("Legacy personal note folder migration failed:",be)}finally{re||ne(!0)}}})(),()=>{re=!0}},[r,U,K,L,t]),K&&r.length===0?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 text-slate-500",children:"Loading your library from cloud..."}):h.jsxs("div",{className:"flex h-screen bg-[#F7F8FB] dark:bg-[#0b0e14] overflow-hidden",children:[h.jsx(bq,{activeTab:M,onTabChange:pn,isOpen:P,onClose:()=>z(!1)}),h.jsx("main",{className:`flex-1 flex flex-col h-full w-full relative overflow-y-auto transition-all duration-300 bg-[#F7F8FB] dark:bg-[#0b0e14] noise-bg\r
`,children:M==="PROFILE"?h.jsx(kq,{email:e,userId:t,onLogout:n,onBack:()=>pn("DASHBOARD"),books:r,onStartEnrichment:hn,onStopEnrichment:Yn,isEnriching:Gr,enrichmentStats:Gn}):M==="SMART_SEARCH"?h.jsx(Eq,{userId:t,onBack:()=>pn("DASHBOARD"),books:r}):M==="RAG_SEARCH"?h.jsx(Mq,{userId:t,userEmail:e,onBack:()=>pn("DASHBOARD"),books:r}):M==="FLOW"?h.jsx(Pq,{firebaseUid:t,anchorType:"topic",anchorId:"General Discovery",categoryOptions:lt,onClose:()=>pn("DASHBOARD")}):l==="list"?h.jsx(kH,{books:r,activeTab:M,userId:t,categoryFilter:Te,onCategoryFilterChange:ve,onCategoryNavigate:Ht,onStatusNavigate:kn,onSelectBook:Q=>{p(Q.id),C(!1),c("detail")},onSelectBookWithTab:(Q,re,ue)=>{p(Q.id),C(re==="highlights"),N(ue||null),c("detail")},onAddBook:()=>{xe({}),v(null),g(!0)},personalNoteFolders:L,onCreatePersonalFolder:aa,onRenamePersonalFolder:ln,onDeletePersonalFolder:Jr,onMovePersonalFolder:Jn,onMovePersonalNote:yr,onAddPersonalNote:({category:Q,folderId:re,folderPath:ue})=>{Me({category:Q,folderId:re,folderPath:ue})},onQuickCreatePersonalNote:rt,onMobileMenuClick:()=>z(!0),onDeleteBook:_e,onDeleteMultiple:an,onToggleFavorite:Kn,onToggleHighlightFavorite:Dt,currentPage:Se,onPageChange:Ee,searchQuery:q,onSearchChange:te,statusFilter:G,onStatusFilterChange:I,sortOption:H,onSortOptionChange:A,publisherFilter:R,onPublisherFilterChange:W,onTabChange:pn}):Xt&&h.jsx(mq,{book:Xt,initialTab:w?"highlights":"info",autoEditHighlightId:k||void 0,onBack:()=>{p(null),C(!1),N(null),c("list")},onEdit:()=>{v(Xt.id),g(!0)},onDelete:()=>_e(Xt.id),onUpdateHighlights:on,onBookUpdated:ms})}),m&&h.jsx(RV,{initialType:Pn?Pn.type:M==="NOTES"||M==="DASHBOARD"||M==="PROFILE"||M==="RAG_SEARCH"||M==="SMART_SEARCH"||M==="FLOW"?"BOOK":M,initialData:Pn,noteDefaults:!Pn&&M==="PERSONAL_NOTE"?oe:void 0,onSave:b?De:pt,onCancel:()=>{g(!1),v(null),xe({})}})]})},Fq=()=>{const{user:t,loading:e,loginWithGoogle:n,logout:r}=bp();return e?h.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-500",children:"Loading..."}):t?h.jsx(P_,{children:h.jsx(Hq,{userId:t.uid,userEmail:t.email,onLogout:r})}):h.jsx("div",{className:`min-h-screen flex items-center justify-center bg-[#F7F8FB] dark:bg-[#0b0e14] transition-colors duration-300\r
`,children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 shadow-lg rounded-2xl px-8 py-10 flex flex-col items-center gap-4 border border-slate-100 dark:border-slate-800",children:[h.jsx("div",{className:"flex flex-col items-center gap-6 mb-12",children:h.jsx("img",{src:sM,alt:"TomeHub Icon",className:"h-[156px] w-auto object-contain brightness-110 drop-shadow-xl"})}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center max-w-xs",children:"Sign in with your Google account to access your library across all devices."}),h.jsx("button",{onClick:n,className:"mt-2 bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white px-5 py-2 rounded-lg text-sm font-medium shadow-md transition-colors",children:"Continue with Google"})]})})},Uq=()=>h.jsx(kV,{children:h.jsx(gq,{children:h.jsx(Fq,{})})}),uM=document.getElementById("root");if(!uM)throw new Error("Could not find root element to mount to");const $q=Ej.createRoot(uM);$q.render(h.jsx(We.StrictMode,{children:h.jsx(Uq,{})}));export{pf as A,nx as B,Bf as C,Wq as F,PE as H,Kq as I,BE as K,S3 as M,HE as N,Vq as P,qq as S,mf as W,i6 as a,Yc as b,ye as c,T4 as d,Ks as e,dE as f,_a as g,Us as h,Yq as i,h as j,E as r};
