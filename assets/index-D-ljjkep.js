(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function Xx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Tg={exports:{}},bc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s2;function SO(){if(s2)return bc;s2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var c in s)c!=="key"&&(a[c]=s[c])}else a=s;return s=a.ref,{$$typeof:t,type:r,key:l,ref:s!==void 0?s:null,props:a}}return bc.Fragment=e,bc.jsx=n,bc.jsxs=n,bc}var i2;function EO(){return i2||(i2=1,Tg.exports=SO()),Tg.exports}var h=EO(),Ag={exports:{}},Ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a2;function NO(){if(a2)return Ge;a2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),b=Symbol.iterator;function v(A){return A===null||typeof A!="object"?null:(A=b&&A[b]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,k={};function N(A,R,W){this.props=A,this.context=R,this.refs=k,this.updater=W||w}N.prototype.isReactComponent={},N.prototype.setState=function(A,R){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,R,"setState")},N.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function M(){}M.prototype=N.prototype;function _(A,R,W){this.props=A,this.context=R,this.refs=k,this.updater=W||w}var P=_.prototype=new M;P.constructor=_,C(P,N.prototype),P.isPureReactComponent=!0;var I=Array.isArray;function q(){}var j={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function G(A,R,W){var oe=W.ref;return{$$typeof:t,type:A,key:R,ref:oe!==void 0?oe:null,props:W}}function te(A,R){return G(A.type,R,A.props)}function he(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function Ne(A){var R={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(W){return R[W]})}var Se=/\/+/g;function Te(A,R){return typeof A=="object"&&A!==null&&A.key!=null?Ne(""+A.key):R.toString(36)}function pe(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(q,q):(A.status="pending",A.then(function(R){A.status==="pending"&&(A.status="fulfilled",A.value=R)},function(R){A.status==="pending"&&(A.status="rejected",A.reason=R)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function U(A,R,W,oe,be){var L=typeof A;(L==="undefined"||L==="boolean")&&(A=null);var ae=!1;if(A===null)ae=!0;else switch(L){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(A.$$typeof){case t:case e:ae=!0;break;case m:return ae=A._init,U(ae(A._payload),R,W,oe,be)}}if(ae)return be=be(A),ae=oe===""?"."+Te(A,0):oe,I(be)?(W="",ae!=null&&(W=ae.replace(Se,"$&/")+"/"),U(be,R,W,"",function(ie){return ie})):be!=null&&(he(be)&&(be=te(be,W+(be.key==null||A&&A.key===be.key?"":(""+be.key).replace(Se,"$&/")+"/")+ae)),R.push(be)),1;ae=0;var $=oe===""?".":oe+":";if(I(A))for(var ne=0;ne<A.length;ne++)oe=A[ne],L=$+Te(oe,ne),ae+=U(oe,R,W,L,be);else if(ne=v(A),typeof ne=="function")for(A=ne.call(A),ne=0;!(oe=A.next()).done;)oe=oe.value,L=$+Te(oe,ne++),ae+=U(oe,R,W,L,be);else if(L==="object"){if(typeof A.then=="function")return U(pe(A),R,W,oe,be);throw R=String(A),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.")}return ae}function Z(A,R,W){if(A==null)return A;var oe=[],be=0;return U(A,oe,"","",function(L){return R.call(W,L,be++)}),oe}function K(A){if(A._status===-1){var R=A._result;R=R(),R.then(function(W){(A._status===0||A._status===-1)&&(A._status=1,A._result=W)},function(W){(A._status===0||A._status===-1)&&(A._status=2,A._result=W)}),A._status===-1&&(A._status=0,A._result=R)}if(A._status===1)return A._result.default;throw A._result}var z=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(R))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},H={map:Z,forEach:function(A,R,W){Z(A,function(){R.apply(this,arguments)},W)},count:function(A){var R=0;return Z(A,function(){R++}),R},toArray:function(A){return Z(A,function(R){return R})||[]},only:function(A){if(!he(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Ge.Activity=g,Ge.Children=H,Ge.Component=N,Ge.Fragment=n,Ge.Profiler=s,Ge.PureComponent=_,Ge.StrictMode=r,Ge.Suspense=d,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(A){return j.H.useMemoCache(A)}},Ge.cache=function(A){return function(){return A.apply(null,arguments)}},Ge.cacheSignal=function(){return null},Ge.cloneElement=function(A,R,W){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var oe=C({},A.props),be=A.key;if(R!=null)for(L in R.key!==void 0&&(be=""+R.key),R)!F.call(R,L)||L==="key"||L==="__self"||L==="__source"||L==="ref"&&R.ref===void 0||(oe[L]=R[L]);var L=arguments.length-2;if(L===1)oe.children=W;else if(1<L){for(var ae=Array(L),$=0;$<L;$++)ae[$]=arguments[$+2];oe.children=ae}return G(A.type,be,oe)},Ge.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:a,_context:A},A},Ge.createElement=function(A,R,W){var oe,be={},L=null;if(R!=null)for(oe in R.key!==void 0&&(L=""+R.key),R)F.call(R,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(be[oe]=R[oe]);var ae=arguments.length-2;if(ae===1)be.children=W;else if(1<ae){for(var $=Array(ae),ne=0;ne<ae;ne++)$[ne]=arguments[ne+2];be.children=$}if(A&&A.defaultProps)for(oe in ae=A.defaultProps,ae)be[oe]===void 0&&(be[oe]=ae[oe]);return G(A,L,be)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(A){return{$$typeof:c,render:A}},Ge.isValidElement=he,Ge.lazy=function(A){return{$$typeof:m,_payload:{_status:-1,_result:A},_init:K}},Ge.memo=function(A,R){return{$$typeof:p,type:A,compare:R===void 0?null:R}},Ge.startTransition=function(A){var R=j.T,W={};j.T=W;try{var oe=A(),be=j.S;be!==null&&be(W,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(q,z)}catch(L){z(L)}finally{R!==null&&W.types!==null&&(R.types=W.types),j.T=R}},Ge.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Ge.use=function(A){return j.H.use(A)},Ge.useActionState=function(A,R,W){return j.H.useActionState(A,R,W)},Ge.useCallback=function(A,R){return j.H.useCallback(A,R)},Ge.useContext=function(A){return j.H.useContext(A)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(A,R){return j.H.useDeferredValue(A,R)},Ge.useEffect=function(A,R){return j.H.useEffect(A,R)},Ge.useEffectEvent=function(A){return j.H.useEffectEvent(A)},Ge.useId=function(){return j.H.useId()},Ge.useImperativeHandle=function(A,R,W){return j.H.useImperativeHandle(A,R,W)},Ge.useInsertionEffect=function(A,R){return j.H.useInsertionEffect(A,R)},Ge.useLayoutEffect=function(A,R){return j.H.useLayoutEffect(A,R)},Ge.useMemo=function(A,R){return j.H.useMemo(A,R)},Ge.useOptimistic=function(A,R){return j.H.useOptimistic(A,R)},Ge.useReducer=function(A,R,W){return j.H.useReducer(A,R,W)},Ge.useRef=function(A){return j.H.useRef(A)},Ge.useState=function(A){return j.H.useState(A)},Ge.useSyncExternalStore=function(A,R,W){return j.H.useSyncExternalStore(A,R,W)},Ge.useTransition=function(){return j.H.useTransition()},Ge.version="19.2.0",Ge}var o2;function pu(){return o2||(o2=1,Ag.exports=NO()),Ag.exports}var E=pu();const We=Xx(E);var Mg={exports:{}},yc={},jg={exports:{}},Og={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l2;function TO(){return l2||(l2=1,(function(t){function e(U,Z){var K=U.length;U.push(Z);e:for(;0<K;){var z=K-1>>>1,H=U[z];if(0<s(H,Z))U[z]=Z,U[K]=H,K=z;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var Z=U[0],K=U.pop();if(K!==Z){U[0]=K;e:for(var z=0,H=U.length,A=H>>>1;z<A;){var R=2*(z+1)-1,W=U[R],oe=R+1,be=U[oe];if(0>s(W,K))oe<H&&0>s(be,W)?(U[z]=be,U[oe]=K,z=oe):(U[z]=W,U[R]=K,z=R);else if(oe<H&&0>s(be,K))U[z]=be,U[oe]=K,z=oe;else break e}}return Z}function s(U,Z){var K=U.sortIndex-Z.sortIndex;return K!==0?K:U.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],p=[],m=1,g=null,b=3,v=!1,w=!1,C=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function P(U){for(var Z=n(p);Z!==null;){if(Z.callback===null)r(p);else if(Z.startTime<=U)r(p),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=n(p)}}function I(U){if(C=!1,P(U),!w)if(n(d)!==null)w=!0,q||(q=!0,Ne());else{var Z=n(p);Z!==null&&pe(I,Z.startTime-U)}}var q=!1,j=-1,F=5,G=-1;function te(){return k?!0:!(t.unstable_now()-G<F)}function he(){if(k=!1,q){var U=t.unstable_now();G=U;var Z=!0;try{e:{w=!1,C&&(C=!1,M(j),j=-1),v=!0;var K=b;try{t:{for(P(U),g=n(d);g!==null&&!(g.expirationTime>U&&te());){var z=g.callback;if(typeof z=="function"){g.callback=null,b=g.priorityLevel;var H=z(g.expirationTime<=U);if(U=t.unstable_now(),typeof H=="function"){g.callback=H,P(U),Z=!0;break t}g===n(d)&&r(d),P(U)}else r(d);g=n(d)}if(g!==null)Z=!0;else{var A=n(p);A!==null&&pe(I,A.startTime-U),Z=!1}}break e}finally{g=null,b=K,v=!1}Z=void 0}}finally{Z?Ne():q=!1}}}var Ne;if(typeof _=="function")Ne=function(){_(he)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Te=Se.port2;Se.port1.onmessage=he,Ne=function(){Te.postMessage(null)}}else Ne=function(){N(he,0)};function pe(U,Z){j=N(function(){U(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(U){switch(b){case 1:case 2:case 3:var Z=3;break;default:Z=b}var K=b;b=Z;try{return U()}finally{b=K}},t.unstable_requestPaint=function(){k=!0},t.unstable_runWithPriority=function(U,Z){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var K=b;b=U;try{return Z()}finally{b=K}},t.unstable_scheduleCallback=function(U,Z,K){var z=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?z+K:z):K=z,U){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=K+H,U={id:m++,callback:Z,priorityLevel:U,startTime:K,expirationTime:H,sortIndex:-1},K>z?(U.sortIndex=K,e(p,U),n(d)===null&&U===n(p)&&(C?(M(j),j=-1):C=!0,pe(I,K-z))):(U.sortIndex=H,e(d,U),w||v||(w=!0,q||(q=!0,Ne()))),U},t.unstable_shouldYield=te,t.unstable_wrapCallback=function(U){var Z=b;return function(){var K=b;b=Z;try{return U.apply(this,arguments)}finally{b=K}}}})(Og)),Og}var c2;function AO(){return c2||(c2=1,jg.exports=TO()),jg.exports}var _g={exports:{}},Rn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2;function MO(){if(u2)return Rn;u2=1;var t=pu();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,p,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:d,containerInfo:p,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Rn.createPortal=function(d,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(d,p,null,m)},Rn.flushSync=function(d){var p=l.T,m=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=p,r.p=m,r.d.f()}},Rn.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(d,p))},Rn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Rn.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var m=p.as,g=c(m,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,v=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?r.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):m==="script"&&r.d.X(d,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Rn.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=c(p.as,p.crossOrigin);r.d.M(d,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(d)},Rn.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,g=c(m,p.crossOrigin);r.d.L(d,m,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Rn.preloadModule=function(d,p){if(typeof d=="string")if(p){var m=c(p.as,p.crossOrigin);r.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(d)},Rn.requestFormReset=function(d){r.d.r(d)},Rn.unstable_batchedUpdates=function(d,p){return d(p)},Rn.useFormState=function(d,p,m){return l.H.useFormState(d,p,m)},Rn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Rn.version="19.2.0",Rn}var d2;function KS(){if(d2)return _g.exports;d2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_g.exports=MO(),_g.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f2;function jO(){if(f2)return yc;f2=1;var t=AO(),e=pu(),n=KS();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function c(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function d(i){if(a(i)!==i)throw Error(r(188))}function p(i){var o=i.alternate;if(!o){if(o=a(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,f=o;;){var x=u.return;if(x===null)break;var y=x.alternate;if(y===null){if(f=x.return,f!==null){u=f;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===u)return d(x),i;if(y===f)return d(x),o;y=y.sibling}throw Error(r(188))}if(u.return!==f.return)u=x,f=y;else{for(var S=!1,T=x.child;T;){if(T===u){S=!0,u=x,f=y;break}if(T===f){S=!0,f=x,u=y;break}T=T.sibling}if(!S){for(T=y.child;T;){if(T===u){S=!0,u=y,f=x;break}if(T===f){S=!0,f=y,u=x;break}T=T.sibling}if(!S)throw Error(r(189))}}if(u.alternate!==f)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function m(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=m(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),_=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),he=Symbol.iterator;function Ne(i){return i===null||typeof i!="object"?null:(i=he&&i[he]||i["@@iterator"],typeof i=="function"?i:null)}var Se=Symbol.for("react.client.reference");function Te(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Se?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case N:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case q:return"SuspenseList";case G:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case _:return i.displayName||"Context";case M:return(i._context.displayName||"Context")+".Consumer";case P:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case j:return o=i.displayName||null,o!==null?o:Te(i.type)||"Memo";case F:o=i._payload,i=i._init;try{return Te(i(o))}catch{}}return null}var pe=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},z=[],H=-1;function A(i){return{current:i}}function R(i){0>H||(i.current=z[H],z[H]=null,H--)}function W(i,o){H++,z[H]=i.current,i.current=o}var oe=A(null),be=A(null),L=A(null),ae=A(null);function $(i,o){switch(W(L,o),W(be,i),W(oe,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?Tw(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=Tw(o),i=Aw(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}R(oe),W(oe,i)}function ne(){R(oe),R(be),R(L)}function ie(i){i.memoizedState!==null&&W(ae,i);var o=oe.current,u=Aw(o,i.type);o!==u&&(W(be,i),W(oe,u))}function Oe(i){be.current===i&&(R(oe),R(be)),ae.current===i&&(R(ae),pc._currentValue=K)}var $e,lt;function Ue(i){if($e===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);$e=o&&o[1]||"",lt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$e+i+lt}var rt=!1;function pt(i,o){if(!i||rt)return"";rt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(se){var ee=se}Reflect.construct(i,[],de)}else{try{de.call()}catch(se){ee=se}i.call(de.prototype)}}else{try{throw Error()}catch(se){ee=se}(de=i())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(se){if(se&&ee&&typeof se.stack=="string")return[se.stack,ee.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),S=y[0],T=y[1];if(S&&T){var D=S.split(`
`),X=T.split(`
`);for(x=f=0;f<D.length&&!D[f].includes("DetermineComponentFrameRoot");)f++;for(;x<X.length&&!X[x].includes("DetermineComponentFrameRoot");)x++;if(f===D.length||x===X.length)for(f=D.length-1,x=X.length-1;1<=f&&0<=x&&D[f]!==X[x];)x--;for(;1<=f&&0<=x;f--,x--)if(D[f]!==X[x]){if(f!==1||x!==1)do if(f--,x--,0>x||D[f]!==X[x]){var le=`
`+D[f].replace(" at new "," at ");return i.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",i.displayName)),le}while(1<=f&&0<=x);break}}}finally{rt=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?Ue(u):""}function Me(i,o){switch(i.tag){case 26:case 27:case 5:return Ue(i.type);case 16:return Ue("Lazy");case 13:return i.child!==o&&o!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return pt(i.type,!1);case 11:return pt(i.type.render,!1);case 1:return pt(i.type,!0);case 31:return Ue("Activity");default:return""}}function st(i){try{var o="",u=null;do o+=Me(i,u),u=i,i=i.return;while(i);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var De=Object.prototype.hasOwnProperty,_e=t.unstable_scheduleCallback,an=t.unstable_cancelCallback,on=t.unstable_shouldYield,Gn=t.unstable_requestPaint,Dt=t.unstable_now,gs=t.unstable_getCurrentPriorityLevel,Yr=t.unstable_ImmediatePriority,Kn=t.unstable_UserBlockingPriority,hn=t.unstable_NormalPriority,Yn=t.unstable_LowPriority,Jr=t.unstable_IdlePriority,Jt=t.log,Pn=t.unstable_setDisableYieldValue,pn=null,Ht=null;function kn(i){if(typeof Jt=="function"&&Pn(i),Ht&&typeof Ht.setStrictMode=="function")try{Ht.setStrictMode(pn,i)}catch{}}var Gt=Math.clz32?Math.clz32:Xr,oa=Math.log,ln=Math.LN2;function Xr(i){return i>>>=0,i===0?32:31-(oa(i)/ln|0)|0}var Jn=256,yr=262144,Q=4194304;function re(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ue(i,o,u){var f=i.pendingLanes;if(f===0)return 0;var x=0,y=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var T=f&134217727;return T!==0?(f=T&~y,f!==0?x=re(f):(S&=T,S!==0?x=re(S):u||(u=T&~i,u!==0&&(x=re(u))))):(T=f&~y,T!==0?x=re(T):S!==0?x=re(S):u||(u=f&~i,u!==0&&(x=re(u)))),x===0?0:o!==0&&o!==x&&(o&y)===0&&(y=x&-x,u=o&-o,y>=u||y===32&&(u&4194048)!==0)?o:x}function me(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function ke(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ce(){var i=Q;return Q<<=1,(Q&62914560)===0&&(Q=4194304),i}function ye(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function He(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ae(i,o,u,f,x,y){var S=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var T=i.entanglements,D=i.expirationTimes,X=i.hiddenUpdates;for(u=S&~u;0<u;){var le=31-Gt(u),de=1<<le;T[le]=0,D[le]=-1;var ee=X[le];if(ee!==null)for(X[le]=null,le=0;le<ee.length;le++){var se=ee[le];se!==null&&(se.lane&=-536870913)}u&=~de}f!==0&&Qe(i,f,0),y!==0&&x===0&&i.tag!==0&&(i.suspendedLanes|=y&~(S&~o))}function Qe(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var f=31-Gt(o);i.entangledLanes|=o,i.entanglements[f]=i.entanglements[f]|1073741824|u&261930}function Pe(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var f=31-Gt(u),x=1<<f;x&o|i[f]&o&&(i[f]|=o),u&=~x}}function Ye(i,o){var u=o&-o;return u=(u&42)!==0?1:ft(u),(u&(i.suspendedLanes|o))!==0?0:u}function ft(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function It(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Cn(){var i=Z.p;return i!==0?i:(i=window.event,i===void 0?32:Xw(i.type))}function or(i,o){var u=Z.p;try{return Z.p=i,o()}finally{Z.p=u}}var Hn=Math.random().toString(36).slice(2),cn="__reactFiber$"+Hn,mn="__reactProps$"+Hn,ti="__reactContainer$"+Hn,Sl="__reactEvents$"+Hn,vp="__reactListeners$"+Hn,wp="__reactHandles$"+Hn,El="__reactResources$"+Hn,ni="__reactMarker$"+Hn;function Nl(i){delete i[cn],delete i[mn],delete i[Sl],delete i[vp],delete i[wp]}function ri(i){var o=i[cn];if(o)return o;for(var u=i.parentNode;u;){if(o=u[ti]||u[cn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=Lw(i);i!==null;){if(u=i[cn])return u;i=Lw(i)}return o}i=u,u=i.parentNode}return null}function si(i){if(i=i[cn]||i[ti]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function la(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function ii(i){var o=i[El];return o||(o=i[El]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Xt(i){i[ni]=!0}var Fn=new Set,Du={};function vr(i,o){xs(i,o),xs(i+"Capture",o)}function xs(i,o){for(Du[i]=o,i=0;i<o.length;i++)Fn.add(o[i])}var Tl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Al={},Ml={};function kp(i){return De.call(Ml,i)?!0:De.call(Al,i)?!1:Tl.test(i)?Ml[i]=!0:(Al[i]=!0,!1)}function jl(i,o,u){if(kp(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function ro(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Y(i,o,u,f){if(f===null)i.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+f)}}function O(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function we(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ge(i,o,u){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,y=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return x.call(this)},set:function(S){u=""+S,y.call(this,S)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ze(i){if(!i._valueTracker){var o=we(i)?"checked":"value";i._valueTracker=ge(i,o,""+i[o])}}function wt(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return i&&(f=we(i)?i.checked?"true":"false":i.value),i=f,i!==u?(o.setValue(i),!0):!1}function zt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Qr=/[\n"\\]/g;function Bt(i){return i.replace(Qr,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function lr(i,o,u,f,x,y,S,T){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),o!=null?S==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+O(o)):i.value!==""+O(o)&&(i.value=""+O(o)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),o!=null?ca(i,S,O(o)):u!=null?ca(i,S,O(u)):f!=null&&i.removeAttribute("value"),x==null&&y!=null&&(i.defaultChecked=!!y),x!=null&&(i.checked=x&&typeof x!="function"&&typeof x!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+O(T):i.removeAttribute("name")}function Zr(i,o,u,f,x,y,S,T){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),o!=null||u!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){Ze(i);return}u=u!=null?""+O(u):"",o=o!=null?""+O(o):u,T||o===i.value||(i.value=o),i.defaultValue=o}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=T?i.checked:!!f,i.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S),Ze(i)}function ca(i,o,u){o==="number"&&zt(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function so(i,o,u,f){if(i=i.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<i.length;u++)x=o.hasOwnProperty("$"+i[u].value),i[u].selected!==x&&(i[u].selected=x),x&&f&&(i[u].defaultSelected=!0)}else{for(u=""+O(u),o=null,x=0;x<i.length;x++){if(i[x].value===u){i[x].selected=!0,f&&(i[x].defaultSelected=!0);return}o!==null||i[x].disabled||(o=i[x])}o!==null&&(o.selected=!0)}}function ky(i,o,u){if(o!=null&&(o=""+O(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+O(u):""}function Cy(i,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(r(92));if(pe(f)){if(1<f.length)throw Error(r(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=O(o),i.defaultValue=u,f=i.textContent,f===u&&f!==""&&f!==null&&(i.value=f),Ze(i)}function io(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var yM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sy(i,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":f?i.setProperty(o,u):typeof u!="number"||u===0||yM.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function Ey(i,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var x in o)f=o[x],o.hasOwnProperty(x)&&u[x]!==f&&Sy(i,x,f)}else for(var y in o)o.hasOwnProperty(y)&&Sy(i,y,o[y])}function Cp(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lu(i){return wM.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function bs(){}var Sp=null;function Ep(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ao=null,oo=null;function Ny(i){var o=si(i);if(o&&(i=o.stateNode)){var u=i[mn]||null;e:switch(i=o.stateNode,o.type){case"input":if(lr(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Bt(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==i&&f.form===i.form){var x=f[mn]||null;if(!x)throw Error(r(90));lr(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===i.form&&wt(f)}break e;case"textarea":ky(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&so(i,!!u.multiple,o,!1)}}}var Np=!1;function Ty(i,o,u){if(Np)return i(o,u);Np=!0;try{var f=i(o);return f}finally{if(Np=!1,(ao!==null||oo!==null)&&(kd(),ao&&(o=ao,i=oo,oo=ao=null,Ny(o),i)))for(o=0;o<i.length;o++)Ny(i[o])}}function Ol(i,o){var u=i.stateNode;if(u===null)return null;var f=u[mn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tp=!1;if(ys)try{var _l={};Object.defineProperty(_l,"passive",{get:function(){Tp=!0}}),window.addEventListener("test",_l,_l),window.removeEventListener("test",_l,_l)}catch{Tp=!1}var ai=null,Ap=null,Iu=null;function Ay(){if(Iu)return Iu;var i,o=Ap,u=o.length,f,x="value"in ai?ai.value:ai.textContent,y=x.length;for(i=0;i<u&&o[i]===x[i];i++);var S=u-i;for(f=1;f<=S&&o[u-f]===x[y-f];f++);return Iu=x.slice(i,1<f?1-f:void 0)}function zu(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Bu(){return!0}function My(){return!1}function Xn(i){function o(u,f,x,y,S){this._reactName=u,this._targetInst=x,this.type=f,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(u=i[T],this[T]=u?u(y):y[T]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Bu:My,this.isPropagationStopped=My,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Bu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Bu)},persist:function(){},isPersistent:Bu}),o}var ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pu=Xn(ua),Rl=g({},ua,{view:0,detail:0}),kM=Xn(Rl),Mp,jp,Dl,Hu=g({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_p,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Dl&&(Dl&&i.type==="mousemove"?(Mp=i.screenX-Dl.screenX,jp=i.screenY-Dl.screenY):jp=Mp=0,Dl=i),Mp)},movementY:function(i){return"movementY"in i?i.movementY:jp}}),jy=Xn(Hu),CM=g({},Hu,{dataTransfer:0}),SM=Xn(CM),EM=g({},Rl,{relatedTarget:0}),Op=Xn(EM),NM=g({},ua,{animationName:0,elapsedTime:0,pseudoElement:0}),TM=Xn(NM),AM=g({},ua,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),MM=Xn(AM),jM=g({},ua,{data:0}),Oy=Xn(jM),OM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_M={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DM(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=RM[i])?!!o[i]:!1}function _p(){return DM}var LM=g({},Rl,{key:function(i){if(i.key){var o=OM[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=zu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?_M[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_p,charCode:function(i){return i.type==="keypress"?zu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?zu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),IM=Xn(LM),zM=g({},Hu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_y=Xn(zM),BM=g({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_p}),PM=Xn(BM),HM=g({},ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),FM=Xn(HM),UM=g({},Hu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),$M=Xn(UM),VM=g({},ua,{newState:0,oldState:0}),qM=Xn(VM),WM=[9,13,27,32],Rp=ys&&"CompositionEvent"in window,Ll=null;ys&&"documentMode"in document&&(Ll=document.documentMode);var GM=ys&&"TextEvent"in window&&!Ll,Ry=ys&&(!Rp||Ll&&8<Ll&&11>=Ll),Dy=" ",Ly=!1;function Iy(i,o){switch(i){case"keyup":return WM.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zy(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var lo=!1;function KM(i,o){switch(i){case"compositionend":return zy(o);case"keypress":return o.which!==32?null:(Ly=!0,Dy);case"textInput":return i=o.data,i===Dy&&Ly?null:i;default:return null}}function YM(i,o){if(lo)return i==="compositionend"||!Rp&&Iy(i,o)?(i=Ay(),Iu=Ap=ai=null,lo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ry&&o.locale!=="ko"?null:o.data;default:return null}}var JM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function By(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!JM[i.type]:o==="textarea"}function Py(i,o,u,f){ao?oo?oo.push(f):oo=[f]:ao=f,o=Md(o,"onChange"),0<o.length&&(u=new Pu("onChange","change",null,u,f),i.push({event:u,listeners:o}))}var Il=null,zl=null;function XM(i){ww(i,0)}function Fu(i){var o=la(i);if(wt(o))return i}function Hy(i,o){if(i==="change")return o}var Fy=!1;if(ys){var Dp;if(ys){var Lp="oninput"in document;if(!Lp){var Uy=document.createElement("div");Uy.setAttribute("oninput","return;"),Lp=typeof Uy.oninput=="function"}Dp=Lp}else Dp=!1;Fy=Dp&&(!document.documentMode||9<document.documentMode)}function $y(){Il&&(Il.detachEvent("onpropertychange",Vy),zl=Il=null)}function Vy(i){if(i.propertyName==="value"&&Fu(zl)){var o=[];Py(o,zl,i,Ep(i)),Ty(XM,o)}}function QM(i,o,u){i==="focusin"?($y(),Il=o,zl=u,Il.attachEvent("onpropertychange",Vy)):i==="focusout"&&$y()}function ZM(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Fu(zl)}function ej(i,o){if(i==="click")return Fu(o)}function tj(i,o){if(i==="input"||i==="change")return Fu(o)}function nj(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var cr=typeof Object.is=="function"?Object.is:nj;function Bl(i,o){if(cr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var x=u[f];if(!De.call(o,x)||!cr(i[x],o[x]))return!1}return!0}function qy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Wy(i,o){var u=qy(i);i=0;for(var f;u;){if(u.nodeType===3){if(f=i+u.textContent.length,i<=o&&f>=o)return{node:u,offset:o-i};i=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=qy(u)}}function Gy(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Gy(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ky(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=zt(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=zt(i.document)}return o}function Ip(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var rj=ys&&"documentMode"in document&&11>=document.documentMode,co=null,zp=null,Pl=null,Bp=!1;function Yy(i,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Bp||co==null||co!==zt(f)||(f=co,"selectionStart"in f&&Ip(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Pl&&Bl(Pl,f)||(Pl=f,f=Md(zp,"onSelect"),0<f.length&&(o=new Pu("onSelect","select",null,o,u),i.push({event:o,listeners:f}),o.target=co)))}function da(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var uo={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionrun:da("Transition","TransitionRun"),transitionstart:da("Transition","TransitionStart"),transitioncancel:da("Transition","TransitionCancel"),transitionend:da("Transition","TransitionEnd")},Pp={},Jy={};ys&&(Jy=document.createElement("div").style,"AnimationEvent"in window||(delete uo.animationend.animation,delete uo.animationiteration.animation,delete uo.animationstart.animation),"TransitionEvent"in window||delete uo.transitionend.transition);function fa(i){if(Pp[i])return Pp[i];if(!uo[i])return i;var o=uo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in Jy)return Pp[i]=o[u];return i}var Xy=fa("animationend"),Qy=fa("animationiteration"),Zy=fa("animationstart"),sj=fa("transitionrun"),ij=fa("transitionstart"),aj=fa("transitioncancel"),e1=fa("transitionend"),t1=new Map,Hp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hp.push("scrollEnd");function zr(i,o){t1.set(i,o),vr(o,[i])}var Uu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},wr=[],fo=0,Fp=0;function $u(){for(var i=fo,o=Fp=fo=0;o<i;){var u=wr[o];wr[o++]=null;var f=wr[o];wr[o++]=null;var x=wr[o];wr[o++]=null;var y=wr[o];if(wr[o++]=null,f!==null&&x!==null){var S=f.pending;S===null?x.next=x:(x.next=S.next,S.next=x),f.pending=x}y!==0&&n1(u,x,y)}}function Vu(i,o,u,f){wr[fo++]=i,wr[fo++]=o,wr[fo++]=u,wr[fo++]=f,Fp|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function Up(i,o,u,f){return Vu(i,o,u,f),qu(i)}function ha(i,o){return Vu(i,null,null,o),qu(i)}function n1(i,o,u){i.lanes|=u;var f=i.alternate;f!==null&&(f.lanes|=u);for(var x=!1,y=i.return;y!==null;)y.childLanes|=u,f=y.alternate,f!==null&&(f.childLanes|=u),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(x=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,x&&o!==null&&(x=31-Gt(u),i=y.hiddenUpdates,f=i[x],f===null?i[x]=[o]:f.push(o),o.lane=u|536870912),y):null}function qu(i){if(50<oc)throw oc=0,Xm=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var ho={};function oj(i,o,u,f){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(i,o,u,f){return new oj(i,o,u,f)}function $p(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vs(i,o){var u=i.alternate;return u===null?(u=ur(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function r1(i,o){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Wu(i,o,u,f,x,y){var S=0;if(f=i,typeof i=="function")$p(i)&&(S=1);else if(typeof i=="string")S=fO(i,u,oe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case G:return i=ur(31,u,o,x),i.elementType=G,i.lanes=y,i;case C:return pa(u.children,x,y,o);case k:S=8,x|=24;break;case N:return i=ur(12,u,o,x|2),i.elementType=N,i.lanes=y,i;case I:return i=ur(13,u,o,x),i.elementType=I,i.lanes=y,i;case q:return i=ur(19,u,o,x),i.elementType=q,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case _:S=10;break e;case M:S=9;break e;case P:S=11;break e;case j:S=14;break e;case F:S=16,f=null;break e}S=29,u=Error(r(130,i===null?"null":typeof i,"")),f=null}return o=ur(S,u,o,x),o.elementType=i,o.type=f,o.lanes=y,o}function pa(i,o,u,f){return i=ur(7,i,f,o),i.lanes=u,i}function Vp(i,o,u){return i=ur(6,i,null,o),i.lanes=u,i}function s1(i){var o=ur(18,null,null,0);return o.stateNode=i,o}function qp(i,o,u){return o=ur(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var i1=new WeakMap;function kr(i,o){if(typeof i=="object"&&i!==null){var u=i1.get(i);return u!==void 0?u:(o={value:i,source:o,stack:st(o)},i1.set(i,o),o)}return{value:i,source:o,stack:st(o)}}var po=[],mo=0,Gu=null,Hl=0,Cr=[],Sr=0,oi=null,es=1,ts="";function ws(i,o){po[mo++]=Hl,po[mo++]=Gu,Gu=i,Hl=o}function a1(i,o,u){Cr[Sr++]=es,Cr[Sr++]=ts,Cr[Sr++]=oi,oi=i;var f=es;i=ts;var x=32-Gt(f)-1;f&=~(1<<x),u+=1;var y=32-Gt(o)+x;if(30<y){var S=x-x%5;y=(f&(1<<S)-1).toString(32),f>>=S,x-=S,es=1<<32-Gt(o)+x|u<<x|f,ts=y+i}else es=1<<y|u<<x|f,ts=i}function Wp(i){i.return!==null&&(ws(i,1),a1(i,1,0))}function Gp(i){for(;i===Gu;)Gu=po[--mo],po[mo]=null,Hl=po[--mo],po[mo]=null;for(;i===oi;)oi=Cr[--Sr],Cr[Sr]=null,ts=Cr[--Sr],Cr[Sr]=null,es=Cr[--Sr],Cr[Sr]=null}function o1(i,o){Cr[Sr++]=es,Cr[Sr++]=ts,Cr[Sr++]=oi,es=o.id,ts=o.overflow,oi=i}var Sn=null,At=null,ot=!1,li=null,Er=!1,Kp=Error(r(519));function ci(i){var o=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fl(kr(o,i)),Kp}function l1(i){var o=i.stateNode,u=i.type,f=i.memoizedProps;switch(o[cn]=i,o[mn]=f,u){case"dialog":tt("cancel",o),tt("close",o);break;case"iframe":case"object":case"embed":tt("load",o);break;case"video":case"audio":for(u=0;u<cc.length;u++)tt(cc[u],o);break;case"source":tt("error",o);break;case"img":case"image":case"link":tt("error",o),tt("load",o);break;case"details":tt("toggle",o);break;case"input":tt("invalid",o),Zr(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":tt("invalid",o);break;case"textarea":tt("invalid",o),Cy(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||Ew(o.textContent,u)?(f.popover!=null&&(tt("beforetoggle",o),tt("toggle",o)),f.onScroll!=null&&tt("scroll",o),f.onScrollEnd!=null&&tt("scrollend",o),f.onClick!=null&&(o.onclick=bs),o=!0):o=!1,o||ci(i,!0)}function c1(i){for(Sn=i.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:Er=!1;return;case 27:case 3:Er=!0;return;default:Sn=Sn.return}}function go(i){if(i!==Sn)return!1;if(!ot)return c1(i),ot=!0,!1;var o=i.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||fg(i.type,i.memoizedProps)),u=!u),u&&At&&ci(i),c1(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));At=Dw(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));At=Dw(i)}else o===27?(o=At,Ci(i.type)?(i=xg,xg=null,At=i):At=o):At=Sn?Tr(i.stateNode.nextSibling):null;return!0}function ma(){At=Sn=null,ot=!1}function Yp(){var i=li;return i!==null&&(tr===null?tr=i:tr.push.apply(tr,i),li=null),i}function Fl(i){li===null?li=[i]:li.push(i)}var Jp=A(null),ga=null,ks=null;function ui(i,o,u){W(Jp,o._currentValue),o._currentValue=u}function Cs(i){i._currentValue=Jp.current,R(Jp)}function Xp(i,o,u){for(;i!==null;){var f=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),i===u)break;i=i.return}}function Qp(i,o,u,f){var x=i.child;for(x!==null&&(x.return=i);x!==null;){var y=x.dependencies;if(y!==null){var S=x.child;y=y.firstContext;e:for(;y!==null;){var T=y;y=x;for(var D=0;D<o.length;D++)if(T.context===o[D]){y.lanes|=u,T=y.alternate,T!==null&&(T.lanes|=u),Xp(y.return,u,i),f||(S=null);break e}y=T.next}}else if(x.tag===18){if(S=x.return,S===null)throw Error(r(341));S.lanes|=u,y=S.alternate,y!==null&&(y.lanes|=u),Xp(S,u,i),S=null}else S=x.child;if(S!==null)S.return=x;else for(S=x;S!==null;){if(S===i){S=null;break}if(x=S.sibling,x!==null){x.return=S.return,S=x;break}S=S.return}x=S}}function xo(i,o,u,f){i=null;for(var x=o,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var S=x.alternate;if(S===null)throw Error(r(387));if(S=S.memoizedProps,S!==null){var T=x.type;cr(x.pendingProps.value,S.value)||(i!==null?i.push(T):i=[T])}}else if(x===ae.current){if(S=x.alternate,S===null)throw Error(r(387));S.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(i!==null?i.push(pc):i=[pc])}x=x.return}i!==null&&Qp(o,i,u,f),o.flags|=262144}function Ku(i){for(i=i.firstContext;i!==null;){if(!cr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function xa(i){ga=i,ks=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function En(i){return u1(ga,i)}function Yu(i,o){return ga===null&&xa(i),u1(i,o)}function u1(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ks===null){if(i===null)throw Error(r(308));ks=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else ks=ks.next=o;return u}var lj=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,f){i.push(f)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},cj=t.unstable_scheduleCallback,uj=t.unstable_NormalPriority,Qt={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new lj,data:new Map,refCount:0}}function Ul(i){i.refCount--,i.refCount===0&&cj(uj,function(){i.controller.abort()})}var $l=null,em=0,bo=0,yo=null;function dj(i,o){if($l===null){var u=$l=[];em=0,bo=rg(),yo={status:"pending",value:void 0,then:function(f){u.push(f)}}}return em++,o.then(d1,d1),o}function d1(){if(--em===0&&$l!==null){yo!==null&&(yo.status="fulfilled");var i=$l;$l=null,bo=0,yo=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function fj(i,o){var u=[],f={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return i.then(function(){f.status="fulfilled",f.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(f.status="rejected",f.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),f}var f1=U.S;U.S=function(i,o){Yv=Dt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&dj(i,o),f1!==null&&f1(i,o)};var ba=A(null);function tm(){var i=ba.current;return i!==null?i:kt.pooledCache}function Ju(i,o){o===null?W(ba,ba.current):W(ba,o.pool)}function h1(){var i=tm();return i===null?null:{parent:Qt._currentValue,pool:i}}var vo=Error(r(460)),nm=Error(r(474)),Xu=Error(r(542)),Qu={then:function(){}};function p1(i){return i=i.status,i==="fulfilled"||i==="rejected"}function m1(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(bs,bs),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,x1(i),i;default:if(typeof o.status=="string")o.then(bs,bs);else{if(i=kt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(f){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=f}},function(f){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,x1(i),i}throw va=o,vo}}function ya(i){try{var o=i._init;return o(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(va=u,vo):u}}var va=null;function g1(){if(va===null)throw Error(r(459));var i=va;return va=null,i}function x1(i){if(i===vo||i===Xu)throw Error(r(483))}var wo=null,Vl=0;function Zu(i){var o=Vl;return Vl+=1,wo===null&&(wo=[]),m1(wo,i,o)}function ql(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function ed(i,o){throw o.$$typeof===b?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function b1(i){function o(V,B){if(i){var J=V.deletions;J===null?(V.deletions=[B],V.flags|=16):J.push(B)}}function u(V,B){if(!i)return null;for(;B!==null;)o(V,B),B=B.sibling;return null}function f(V){for(var B=new Map;V!==null;)V.key!==null?B.set(V.key,V):B.set(V.index,V),V=V.sibling;return B}function x(V,B){return V=vs(V,B),V.index=0,V.sibling=null,V}function y(V,B,J){return V.index=J,i?(J=V.alternate,J!==null?(J=J.index,J<B?(V.flags|=67108866,B):J):(V.flags|=67108866,B)):(V.flags|=1048576,B)}function S(V){return i&&V.alternate===null&&(V.flags|=67108866),V}function T(V,B,J,ce){return B===null||B.tag!==6?(B=Vp(J,V.mode,ce),B.return=V,B):(B=x(B,J),B.return=V,B)}function D(V,B,J,ce){var Ie=J.type;return Ie===C?le(V,B,J.props.children,ce,J.key):B!==null&&(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===F&&ya(Ie)===B.type)?(B=x(B,J.props),ql(B,J),B.return=V,B):(B=Wu(J.type,J.key,J.props,null,V.mode,ce),ql(B,J),B.return=V,B)}function X(V,B,J,ce){return B===null||B.tag!==4||B.stateNode.containerInfo!==J.containerInfo||B.stateNode.implementation!==J.implementation?(B=qp(J,V.mode,ce),B.return=V,B):(B=x(B,J.children||[]),B.return=V,B)}function le(V,B,J,ce,Ie){return B===null||B.tag!==7?(B=pa(J,V.mode,ce,Ie),B.return=V,B):(B=x(B,J),B.return=V,B)}function de(V,B,J){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Vp(""+B,V.mode,J),B.return=V,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case v:return J=Wu(B.type,B.key,B.props,null,V.mode,J),ql(J,B),J.return=V,J;case w:return B=qp(B,V.mode,J),B.return=V,B;case F:return B=ya(B),de(V,B,J)}if(pe(B)||Ne(B))return B=pa(B,V.mode,J,null),B.return=V,B;if(typeof B.then=="function")return de(V,Zu(B),J);if(B.$$typeof===_)return de(V,Yu(V,B),J);ed(V,B)}return null}function ee(V,B,J,ce){var Ie=B!==null?B.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Ie!==null?null:T(V,B,""+J,ce);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case v:return J.key===Ie?D(V,B,J,ce):null;case w:return J.key===Ie?X(V,B,J,ce):null;case F:return J=ya(J),ee(V,B,J,ce)}if(pe(J)||Ne(J))return Ie!==null?null:le(V,B,J,ce,null);if(typeof J.then=="function")return ee(V,B,Zu(J),ce);if(J.$$typeof===_)return ee(V,B,Yu(V,J),ce);ed(V,J)}return null}function se(V,B,J,ce,Ie){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return V=V.get(J)||null,T(B,V,""+ce,Ie);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return V=V.get(ce.key===null?J:ce.key)||null,D(B,V,ce,Ie);case w:return V=V.get(ce.key===null?J:ce.key)||null,X(B,V,ce,Ie);case F:return ce=ya(ce),se(V,B,J,ce,Ie)}if(pe(ce)||Ne(ce))return V=V.get(J)||null,le(B,V,ce,Ie,null);if(typeof ce.then=="function")return se(V,B,J,Zu(ce),Ie);if(ce.$$typeof===_)return se(V,B,J,Yu(B,ce),Ie);ed(B,ce)}return null}function je(V,B,J,ce){for(var Ie=null,ct=null,Re=B,Je=B=0,at=null;Re!==null&&Je<J.length;Je++){Re.index>Je?(at=Re,Re=null):at=Re.sibling;var ut=ee(V,Re,J[Je],ce);if(ut===null){Re===null&&(Re=at);break}i&&Re&&ut.alternate===null&&o(V,Re),B=y(ut,B,Je),ct===null?Ie=ut:ct.sibling=ut,ct=ut,Re=at}if(Je===J.length)return u(V,Re),ot&&ws(V,Je),Ie;if(Re===null){for(;Je<J.length;Je++)Re=de(V,J[Je],ce),Re!==null&&(B=y(Re,B,Je),ct===null?Ie=Re:ct.sibling=Re,ct=Re);return ot&&ws(V,Je),Ie}for(Re=f(Re);Je<J.length;Je++)at=se(Re,V,Je,J[Je],ce),at!==null&&(i&&at.alternate!==null&&Re.delete(at.key===null?Je:at.key),B=y(at,B,Je),ct===null?Ie=at:ct.sibling=at,ct=at);return i&&Re.forEach(function(Ai){return o(V,Ai)}),ot&&ws(V,Je),Ie}function Fe(V,B,J,ce){if(J==null)throw Error(r(151));for(var Ie=null,ct=null,Re=B,Je=B=0,at=null,ut=J.next();Re!==null&&!ut.done;Je++,ut=J.next()){Re.index>Je?(at=Re,Re=null):at=Re.sibling;var Ai=ee(V,Re,ut.value,ce);if(Ai===null){Re===null&&(Re=at);break}i&&Re&&Ai.alternate===null&&o(V,Re),B=y(Ai,B,Je),ct===null?Ie=Ai:ct.sibling=Ai,ct=Ai,Re=at}if(ut.done)return u(V,Re),ot&&ws(V,Je),Ie;if(Re===null){for(;!ut.done;Je++,ut=J.next())ut=de(V,ut.value,ce),ut!==null&&(B=y(ut,B,Je),ct===null?Ie=ut:ct.sibling=ut,ct=ut);return ot&&ws(V,Je),Ie}for(Re=f(Re);!ut.done;Je++,ut=J.next())ut=se(Re,V,Je,ut.value,ce),ut!==null&&(i&&ut.alternate!==null&&Re.delete(ut.key===null?Je:ut.key),B=y(ut,B,Je),ct===null?Ie=ut:ct.sibling=ut,ct=ut);return i&&Re.forEach(function(CO){return o(V,CO)}),ot&&ws(V,Je),Ie}function yt(V,B,J,ce){if(typeof J=="object"&&J!==null&&J.type===C&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case v:e:{for(var Ie=J.key;B!==null;){if(B.key===Ie){if(Ie=J.type,Ie===C){if(B.tag===7){u(V,B.sibling),ce=x(B,J.props.children),ce.return=V,V=ce;break e}}else if(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===F&&ya(Ie)===B.type){u(V,B.sibling),ce=x(B,J.props),ql(ce,J),ce.return=V,V=ce;break e}u(V,B);break}else o(V,B);B=B.sibling}J.type===C?(ce=pa(J.props.children,V.mode,ce,J.key),ce.return=V,V=ce):(ce=Wu(J.type,J.key,J.props,null,V.mode,ce),ql(ce,J),ce.return=V,V=ce)}return S(V);case w:e:{for(Ie=J.key;B!==null;){if(B.key===Ie)if(B.tag===4&&B.stateNode.containerInfo===J.containerInfo&&B.stateNode.implementation===J.implementation){u(V,B.sibling),ce=x(B,J.children||[]),ce.return=V,V=ce;break e}else{u(V,B);break}else o(V,B);B=B.sibling}ce=qp(J,V.mode,ce),ce.return=V,V=ce}return S(V);case F:return J=ya(J),yt(V,B,J,ce)}if(pe(J))return je(V,B,J,ce);if(Ne(J)){if(Ie=Ne(J),typeof Ie!="function")throw Error(r(150));return J=Ie.call(J),Fe(V,B,J,ce)}if(typeof J.then=="function")return yt(V,B,Zu(J),ce);if(J.$$typeof===_)return yt(V,B,Yu(V,J),ce);ed(V,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,B!==null&&B.tag===6?(u(V,B.sibling),ce=x(B,J),ce.return=V,V=ce):(u(V,B),ce=Vp(J,V.mode,ce),ce.return=V,V=ce),S(V)):u(V,B)}return function(V,B,J,ce){try{Vl=0;var Ie=yt(V,B,J,ce);return wo=null,Ie}catch(Re){if(Re===vo||Re===Xu)throw Re;var ct=ur(29,Re,null,V.mode);return ct.lanes=ce,ct.return=V,ct}finally{}}}var wa=b1(!0),y1=b1(!1),di=!1;function rm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function fi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function hi(i,o,u){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(dt&2)!==0){var x=f.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),f.pending=o,o=qu(i),n1(i,null,u),o}return Vu(i,f,o,u),qu(i)}function Wl(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=i.pendingLanes,u|=f,o.lanes=u,Pe(i,u)}}function im(i,o){var u=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var x=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};y===null?x=y=S:y=y.next=S,u=u.next}while(u!==null);y===null?x=y=o:y=y.next=o}else x=y=o;u={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var am=!1;function Gl(){if(am){var i=yo;if(i!==null)throw i}}function Kl(i,o,u,f){am=!1;var x=i.updateQueue;di=!1;var y=x.firstBaseUpdate,S=x.lastBaseUpdate,T=x.shared.pending;if(T!==null){x.shared.pending=null;var D=T,X=D.next;D.next=null,S===null?y=X:S.next=X,S=D;var le=i.alternate;le!==null&&(le=le.updateQueue,T=le.lastBaseUpdate,T!==S&&(T===null?le.firstBaseUpdate=X:T.next=X,le.lastBaseUpdate=D))}if(y!==null){var de=x.baseState;S=0,le=X=D=null,T=y;do{var ee=T.lane&-536870913,se=ee!==T.lane;if(se?(it&ee)===ee:(f&ee)===ee){ee!==0&&ee===bo&&(am=!0),le!==null&&(le=le.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var je=i,Fe=T;ee=o;var yt=u;switch(Fe.tag){case 1:if(je=Fe.payload,typeof je=="function"){de=je.call(yt,de,ee);break e}de=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Fe.payload,ee=typeof je=="function"?je.call(yt,de,ee):je,ee==null)break e;de=g({},de,ee);break e;case 2:di=!0}}ee=T.callback,ee!==null&&(i.flags|=64,se&&(i.flags|=8192),se=x.callbacks,se===null?x.callbacks=[ee]:se.push(ee))}else se={lane:ee,tag:T.tag,payload:T.payload,callback:T.callback,next:null},le===null?(X=le=se,D=de):le=le.next=se,S|=ee;if(T=T.next,T===null){if(T=x.shared.pending,T===null)break;se=T,T=se.next,se.next=null,x.lastBaseUpdate=se,x.shared.pending=null}}while(!0);le===null&&(D=de),x.baseState=D,x.firstBaseUpdate=X,x.lastBaseUpdate=le,y===null&&(x.shared.lanes=0),bi|=S,i.lanes=S,i.memoizedState=de}}function v1(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function w1(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)v1(u[i],o)}var ko=A(null),td=A(0);function k1(i,o){i=_s,W(td,i),W(ko,o),_s=i|o.baseLanes}function om(){W(td,_s),W(ko,ko.current)}function lm(){_s=td.current,R(ko),R(td)}var dr=A(null),Nr=null;function pi(i){var o=i.alternate;W(Kt,Kt.current&1),W(dr,i),Nr===null&&(o===null||ko.current!==null||o.memoizedState!==null)&&(Nr=i)}function cm(i){W(Kt,Kt.current),W(dr,i),Nr===null&&(Nr=i)}function C1(i){i.tag===22?(W(Kt,Kt.current),W(dr,i),Nr===null&&(Nr=i)):mi()}function mi(){W(Kt,Kt.current),W(dr,dr.current)}function fr(i){R(dr),Nr===i&&(Nr=null),R(Kt)}var Kt=A(0);function nd(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||mg(u)||gg(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ss=0,Ke=null,xt=null,Zt=null,rd=!1,Co=!1,ka=!1,sd=0,Yl=0,So=null,hj=0;function Ft(){throw Error(r(321))}function um(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!cr(i[u],o[u]))return!1;return!0}function dm(i,o,u,f,x,y){return Ss=y,Ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,U.H=i===null||i.memoizedState===null?av:Nm,ka=!1,y=u(f,x),ka=!1,Co&&(y=E1(o,u,f,x)),S1(i),y}function S1(i){U.H=Ql;var o=xt!==null&&xt.next!==null;if(Ss=0,Zt=xt=Ke=null,rd=!1,Yl=0,So=null,o)throw Error(r(300));i===null||en||(i=i.dependencies,i!==null&&Ku(i)&&(en=!0))}function E1(i,o,u,f){Ke=i;var x=0;do{if(Co&&(So=null),Yl=0,Co=!1,25<=x)throw Error(r(301));if(x+=1,Zt=xt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}U.H=ov,y=o(u,f)}while(Co);return y}function pj(){var i=U.H,o=i.useState()[0];return o=typeof o.then=="function"?Jl(o):o,i=i.useState()[0],(xt!==null?xt.memoizedState:null)!==i&&(Ke.flags|=1024),o}function fm(){var i=sd!==0;return sd=0,i}function hm(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function pm(i){if(rd){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}rd=!1}Ss=0,Zt=xt=Ke=null,Co=!1,Yl=sd=0,So=null}function Un(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Ke.memoizedState=Zt=i:Zt=Zt.next=i,Zt}function Yt(){if(xt===null){var i=Ke.alternate;i=i!==null?i.memoizedState:null}else i=xt.next;var o=Zt===null?Ke.memoizedState:Zt.next;if(o!==null)Zt=o,xt=i;else{if(i===null)throw Ke.alternate===null?Error(r(467)):Error(r(310));xt=i,i={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Zt===null?Ke.memoizedState=Zt=i:Zt=Zt.next=i}return Zt}function id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jl(i){var o=Yl;return Yl+=1,So===null&&(So=[]),i=m1(So,i,o),o=Ke,(Zt===null?o.memoizedState:Zt.next)===null&&(o=o.alternate,U.H=o===null||o.memoizedState===null?av:Nm),i}function ad(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Jl(i);if(i.$$typeof===_)return En(i)}throw Error(r(438,String(i)))}function mm(i){var o=null,u=Ke.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Ke.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=id(),Ke.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),f=0;f<i;f++)u[f]=te;return o.index++,u}function Es(i,o){return typeof o=="function"?o(i):o}function od(i){var o=Yt();return gm(o,xt,i)}function gm(i,o,u){var f=i.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=u;var x=i.baseQueue,y=f.pending;if(y!==null){if(x!==null){var S=x.next;x.next=y.next,y.next=S}o.baseQueue=x=y,f.pending=null}if(y=i.baseState,x===null)i.memoizedState=y;else{o=x.next;var T=S=null,D=null,X=o,le=!1;do{var de=X.lane&-536870913;if(de!==X.lane?(it&de)===de:(Ss&de)===de){var ee=X.revertLane;if(ee===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),de===bo&&(le=!0);else if((Ss&ee)===ee){X=X.next,ee===bo&&(le=!0);continue}else de={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},D===null?(T=D=de,S=y):D=D.next=de,Ke.lanes|=ee,bi|=ee;de=X.action,ka&&u(y,de),y=X.hasEagerState?X.eagerState:u(y,de)}else ee={lane:de,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},D===null?(T=D=ee,S=y):D=D.next=ee,Ke.lanes|=de,bi|=de;X=X.next}while(X!==null&&X!==o);if(D===null?S=y:D.next=T,!cr(y,i.memoizedState)&&(en=!0,le&&(u=yo,u!==null)))throw u;i.memoizedState=y,i.baseState=S,i.baseQueue=D,f.lastRenderedState=y}return x===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function xm(i){var o=Yt(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var f=u.dispatch,x=u.pending,y=o.memoizedState;if(x!==null){u.pending=null;var S=x=x.next;do y=i(y,S.action),S=S.next;while(S!==x);cr(y,o.memoizedState)||(en=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,f]}function N1(i,o,u){var f=Ke,x=Yt(),y=ot;if(y){if(u===void 0)throw Error(r(407));u=u()}else u=o();var S=!cr((xt||x).memoizedState,u);if(S&&(x.memoizedState=u,en=!0),x=x.queue,vm(M1.bind(null,f,x,i),[i]),x.getSnapshot!==o||S||Zt!==null&&Zt.memoizedState.tag&1){if(f.flags|=2048,Eo(9,{destroy:void 0},A1.bind(null,f,x,u,o),null),kt===null)throw Error(r(349));y||(Ss&127)!==0||T1(f,o,u)}return u}function T1(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=Ke.updateQueue,o===null?(o=id(),Ke.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function A1(i,o,u,f){o.value=u,o.getSnapshot=f,j1(o)&&O1(i)}function M1(i,o,u){return u(function(){j1(o)&&O1(i)})}function j1(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!cr(i,u)}catch{return!0}}function O1(i){var o=ha(i,2);o!==null&&nr(o,i,2)}function bm(i){var o=Un();if(typeof i=="function"){var u=i;if(i=u(),ka){kn(!0);try{u()}finally{kn(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:i},o}function _1(i,o,u,f){return i.baseState=u,gm(i,xt,typeof f=="function"?f:Es)}function mj(i,o,u,f,x){if(ud(i))throw Error(r(485));if(i=o.action,i!==null){var y={payload:x,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};U.T!==null?u(!0):y.isTransition=!1,f(y),u=o.pending,u===null?(y.next=o.pending=y,R1(o,y)):(y.next=u.next,o.pending=u.next=y)}}function R1(i,o){var u=o.action,f=o.payload,x=i.state;if(o.isTransition){var y=U.T,S={};U.T=S;try{var T=u(x,f),D=U.S;D!==null&&D(S,T),D1(i,o,T)}catch(X){ym(i,o,X)}finally{y!==null&&S.types!==null&&(y.types=S.types),U.T=y}}else try{y=u(x,f),D1(i,o,y)}catch(X){ym(i,o,X)}}function D1(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){L1(i,o,f)},function(f){return ym(i,o,f)}):L1(i,o,u)}function L1(i,o,u){o.status="fulfilled",o.value=u,I1(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,R1(i,u)))}function ym(i,o,u){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,I1(o),o=o.next;while(o!==f)}i.action=null}function I1(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function z1(i,o){return o}function B1(i,o){if(ot){var u=kt.formState;if(u!==null){e:{var f=Ke;if(ot){if(At){t:{for(var x=At,y=Er;x.nodeType!==8;){if(!y){x=null;break t}if(x=Tr(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){At=Tr(x.nextSibling),f=x.data==="F!";break e}}ci(f)}f=!1}f&&(o=u[0])}}return u=Un(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:z1,lastRenderedState:o},u.queue=f,u=rv.bind(null,Ke,f),f.dispatch=u,f=bm(!1),y=Em.bind(null,Ke,!1,f.queue),f=Un(),x={state:o,dispatch:null,action:i,pending:null},f.queue=x,u=mj.bind(null,Ke,x,y,u),x.dispatch=u,f.memoizedState=i,[o,u,!1]}function P1(i){var o=Yt();return H1(o,xt,i)}function H1(i,o,u){if(o=gm(i,o,z1)[0],i=od(Es)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Jl(o)}catch(S){throw S===vo?Xu:S}else f=o;o=Yt();var x=o.queue,y=x.dispatch;return u!==o.memoizedState&&(Ke.flags|=2048,Eo(9,{destroy:void 0},gj.bind(null,x,u),null)),[f,y,i]}function gj(i,o){i.action=o}function F1(i){var o=Yt(),u=xt;if(u!==null)return H1(o,u,i);Yt(),o=o.memoizedState,u=Yt();var f=u.queue.dispatch;return u.memoizedState=i,[o,f,!1]}function Eo(i,o,u,f){return i={tag:i,create:u,deps:f,inst:o,next:null},o=Ke.updateQueue,o===null&&(o=id(),Ke.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(f=u.next,u.next=i,i.next=f,o.lastEffect=i),i}function U1(){return Yt().memoizedState}function ld(i,o,u,f){var x=Un();Ke.flags|=i,x.memoizedState=Eo(1|o,{destroy:void 0},u,f===void 0?null:f)}function cd(i,o,u,f){var x=Yt();f=f===void 0?null:f;var y=x.memoizedState.inst;xt!==null&&f!==null&&um(f,xt.memoizedState.deps)?x.memoizedState=Eo(o,y,u,f):(Ke.flags|=i,x.memoizedState=Eo(1|o,y,u,f))}function $1(i,o){ld(8390656,8,i,o)}function vm(i,o){cd(2048,8,i,o)}function xj(i){Ke.flags|=4;var o=Ke.updateQueue;if(o===null)o=id(),Ke.updateQueue=o,o.events=[i];else{var u=o.events;u===null?o.events=[i]:u.push(i)}}function V1(i){var o=Yt().memoizedState;return xj({ref:o,nextImpl:i}),function(){if((dt&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}function q1(i,o){return cd(4,2,i,o)}function W1(i,o){return cd(4,4,i,o)}function G1(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function K1(i,o,u){u=u!=null?u.concat([i]):null,cd(4,4,G1.bind(null,o,i),u)}function wm(){}function Y1(i,o){var u=Yt();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&um(o,f[1])?f[0]:(u.memoizedState=[i,o],i)}function J1(i,o){var u=Yt();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&um(o,f[1]))return f[0];if(f=i(),ka){kn(!0);try{i()}finally{kn(!1)}}return u.memoizedState=[f,o],f}function km(i,o,u){return u===void 0||(Ss&1073741824)!==0&&(it&261930)===0?i.memoizedState=o:(i.memoizedState=u,i=Xv(),Ke.lanes|=i,bi|=i,u)}function X1(i,o,u,f){return cr(u,o)?u:ko.current!==null?(i=km(i,u,f),cr(i,o)||(en=!0),i):(Ss&42)===0||(Ss&1073741824)!==0&&(it&261930)===0?(en=!0,i.memoizedState=u):(i=Xv(),Ke.lanes|=i,bi|=i,o)}function Q1(i,o,u,f,x){var y=Z.p;Z.p=y!==0&&8>y?y:8;var S=U.T,T={};U.T=T,Em(i,!1,o,u);try{var D=x(),X=U.S;if(X!==null&&X(T,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var le=fj(D,f);Xl(i,o,le,mr(i))}else Xl(i,o,f,mr(i))}catch(de){Xl(i,o,{then:function(){},status:"rejected",reason:de},mr())}finally{Z.p=y,S!==null&&T.types!==null&&(S.types=T.types),U.T=S}}function bj(){}function Cm(i,o,u,f){if(i.tag!==5)throw Error(r(476));var x=Z1(i).queue;Q1(i,x,o,K,u===null?bj:function(){return ev(i),u(f)})}function Z1(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:K},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function ev(i){var o=Z1(i);o.next===null&&(o=i.alternate.memoizedState),Xl(i,o.next.queue,{},mr())}function Sm(){return En(pc)}function tv(){return Yt().memoizedState}function nv(){return Yt().memoizedState}function yj(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=mr();i=fi(u);var f=hi(o,i,u);f!==null&&(nr(f,o,u),Wl(f,o,u)),o={cache:Zp()},i.payload=o;return}o=o.return}}function vj(i,o,u){var f=mr();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ud(i)?sv(o,u):(u=Up(i,o,u,f),u!==null&&(nr(u,i,f),iv(u,o,f)))}function rv(i,o,u){var f=mr();Xl(i,o,u,f)}function Xl(i,o,u,f){var x={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ud(i))sv(o,x);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var S=o.lastRenderedState,T=y(S,u);if(x.hasEagerState=!0,x.eagerState=T,cr(T,S))return Vu(i,o,x,0),kt===null&&$u(),!1}catch{}finally{}if(u=Up(i,o,x,f),u!==null)return nr(u,i,f),iv(u,o,f),!0}return!1}function Em(i,o,u,f){if(f={lane:2,revertLane:rg(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ud(i)){if(o)throw Error(r(479))}else o=Up(i,u,f,2),o!==null&&nr(o,i,2)}function ud(i){var o=i.alternate;return i===Ke||o!==null&&o===Ke}function sv(i,o){Co=rd=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function iv(i,o,u){if((u&4194048)!==0){var f=o.lanes;f&=i.pendingLanes,u|=f,o.lanes=u,Pe(i,u)}}var Ql={readContext:En,use:ad,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft};Ql.useEffectEvent=Ft;var av={readContext:En,use:ad,useCallback:function(i,o){return Un().memoizedState=[i,o===void 0?null:o],i},useContext:En,useEffect:$1,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,ld(4194308,4,G1.bind(null,o,i),u)},useLayoutEffect:function(i,o){return ld(4194308,4,i,o)},useInsertionEffect:function(i,o){ld(4,2,i,o)},useMemo:function(i,o){var u=Un();o=o===void 0?null:o;var f=i();if(ka){kn(!0);try{i()}finally{kn(!1)}}return u.memoizedState=[f,o],f},useReducer:function(i,o,u){var f=Un();if(u!==void 0){var x=u(o);if(ka){kn(!0);try{u(o)}finally{kn(!1)}}}else x=o;return f.memoizedState=f.baseState=x,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},f.queue=i,i=i.dispatch=vj.bind(null,Ke,i),[f.memoizedState,i]},useRef:function(i){var o=Un();return i={current:i},o.memoizedState=i},useState:function(i){i=bm(i);var o=i.queue,u=rv.bind(null,Ke,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:wm,useDeferredValue:function(i,o){var u=Un();return km(u,i,o)},useTransition:function(){var i=bm(!1);return i=Q1.bind(null,Ke,i.queue,!0,!1),Un().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var f=Ke,x=Un();if(ot){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),kt===null)throw Error(r(349));(it&127)!==0||T1(f,o,u)}x.memoizedState=u;var y={value:u,getSnapshot:o};return x.queue=y,$1(M1.bind(null,f,y,i),[i]),f.flags|=2048,Eo(9,{destroy:void 0},A1.bind(null,f,y,u,o),null),u},useId:function(){var i=Un(),o=kt.identifierPrefix;if(ot){var u=ts,f=es;u=(f&~(1<<32-Gt(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=sd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=hj++,o="_"+o+"r_"+u.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:Sm,useFormState:B1,useActionState:B1,useOptimistic:function(i){var o=Un();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Em.bind(null,Ke,!0,u),u.dispatch=o,[i,o]},useMemoCache:mm,useCacheRefresh:function(){return Un().memoizedState=yj.bind(null,Ke)},useEffectEvent:function(i){var o=Un(),u={impl:i};return o.memoizedState=u,function(){if((dt&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}},Nm={readContext:En,use:ad,useCallback:Y1,useContext:En,useEffect:vm,useImperativeHandle:K1,useInsertionEffect:q1,useLayoutEffect:W1,useMemo:J1,useReducer:od,useRef:U1,useState:function(){return od(Es)},useDebugValue:wm,useDeferredValue:function(i,o){var u=Yt();return X1(u,xt.memoizedState,i,o)},useTransition:function(){var i=od(Es)[0],o=Yt().memoizedState;return[typeof i=="boolean"?i:Jl(i),o]},useSyncExternalStore:N1,useId:tv,useHostTransitionStatus:Sm,useFormState:P1,useActionState:P1,useOptimistic:function(i,o){var u=Yt();return _1(u,xt,i,o)},useMemoCache:mm,useCacheRefresh:nv};Nm.useEffectEvent=V1;var ov={readContext:En,use:ad,useCallback:Y1,useContext:En,useEffect:vm,useImperativeHandle:K1,useInsertionEffect:q1,useLayoutEffect:W1,useMemo:J1,useReducer:xm,useRef:U1,useState:function(){return xm(Es)},useDebugValue:wm,useDeferredValue:function(i,o){var u=Yt();return xt===null?km(u,i,o):X1(u,xt.memoizedState,i,o)},useTransition:function(){var i=xm(Es)[0],o=Yt().memoizedState;return[typeof i=="boolean"?i:Jl(i),o]},useSyncExternalStore:N1,useId:tv,useHostTransitionStatus:Sm,useFormState:F1,useActionState:F1,useOptimistic:function(i,o){var u=Yt();return xt!==null?_1(u,xt,i,o):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:mm,useCacheRefresh:nv};ov.useEffectEvent=V1;function Tm(i,o,u,f){o=i.memoizedState,u=u(f,o),u=u==null?o:g({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Am={enqueueSetState:function(i,o,u){i=i._reactInternals;var f=mr(),x=fi(f);x.payload=o,u!=null&&(x.callback=u),o=hi(i,x,f),o!==null&&(nr(o,i,f),Wl(o,i,f))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var f=mr(),x=fi(f);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=hi(i,x,f),o!==null&&(nr(o,i,f),Wl(o,i,f))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=mr(),f=fi(u);f.tag=2,o!=null&&(f.callback=o),o=hi(i,f,u),o!==null&&(nr(o,i,u),Wl(o,i,u))}};function lv(i,o,u,f,x,y,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,y,S):o.prototype&&o.prototype.isPureReactComponent?!Bl(u,f)||!Bl(x,y):!0}function cv(i,o,u,f){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==i&&Am.enqueueReplaceState(o,o.state,null)}function Ca(i,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(i=i.defaultProps){u===o&&(u=g({},u));for(var x in i)u[x]===void 0&&(u[x]=i[x])}return u}function uv(i){Uu(i)}function dv(i){console.error(i)}function fv(i){Uu(i)}function dd(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function hv(i,o,u){try{var f=i.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Mm(i,o,u){return u=fi(u),u.tag=3,u.payload={element:null},u.callback=function(){dd(i,o)},u}function pv(i){return i=fi(i),i.tag=3,i}function mv(i,o,u,f){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var y=f.value;i.payload=function(){return x(y)},i.callback=function(){hv(o,u,f)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){hv(o,u,f),typeof x!="function"&&(yi===null?yi=new Set([this]):yi.add(this));var T=f.stack;this.componentDidCatch(f.value,{componentStack:T!==null?T:""})})}function wj(i,o,u,f,x){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&xo(o,u,x,!0),u=dr.current,u!==null){switch(u.tag){case 31:case 13:return Nr===null?Cd():u.alternate===null&&Ut===0&&(Ut=3),u.flags&=-257,u.flags|=65536,u.lanes=x,f===Qu?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),eg(i,f,x)),!1;case 22:return u.flags|=65536,f===Qu?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),eg(i,f,x)),!1}throw Error(r(435,u.tag))}return eg(i,f,x),Cd(),!1}if(ot)return o=dr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,f!==Kp&&(i=Error(r(422),{cause:f}),Fl(kr(i,u)))):(f!==Kp&&(o=Error(r(423),{cause:f}),Fl(kr(o,u))),i=i.current.alternate,i.flags|=65536,x&=-x,i.lanes|=x,f=kr(f,u),x=Mm(i.stateNode,f,x),im(i,x),Ut!==4&&(Ut=2)),!1;var y=Error(r(520),{cause:f});if(y=kr(y,u),ac===null?ac=[y]:ac.push(y),Ut!==4&&(Ut=2),o===null)return!0;f=kr(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=x&-x,u.lanes|=i,i=Mm(u.stateNode,f,i),im(u,i),!1;case 1:if(o=u.type,y=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(yi===null||!yi.has(y))))return u.flags|=65536,x&=-x,u.lanes|=x,x=pv(x),mv(x,i,u,f),im(u,x),!1}u=u.return}while(u!==null);return!1}var jm=Error(r(461)),en=!1;function Nn(i,o,u,f){o.child=i===null?y1(o,null,u,f):wa(o,i.child,u,f)}function gv(i,o,u,f,x){u=u.render;var y=o.ref;if("ref"in f){var S={};for(var T in f)T!=="ref"&&(S[T]=f[T])}else S=f;return xa(o),f=dm(i,o,u,S,y,x),T=fm(),i!==null&&!en?(hm(i,o,x),Ns(i,o,x)):(ot&&T&&Wp(o),o.flags|=1,Nn(i,o,f,x),o.child)}function xv(i,o,u,f,x){if(i===null){var y=u.type;return typeof y=="function"&&!$p(y)&&y.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=y,bv(i,o,y,f,x)):(i=Wu(u.type,null,f,o,o.mode,x),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,!Bm(i,x)){var S=y.memoizedProps;if(u=u.compare,u=u!==null?u:Bl,u(S,f)&&i.ref===o.ref)return Ns(i,o,x)}return o.flags|=1,i=vs(y,f),i.ref=o.ref,i.return=o,o.child=i}function bv(i,o,u,f,x){if(i!==null){var y=i.memoizedProps;if(Bl(y,f)&&i.ref===o.ref)if(en=!1,o.pendingProps=f=y,Bm(i,x))(i.flags&131072)!==0&&(en=!0);else return o.lanes=i.lanes,Ns(i,o,x)}return Om(i,o,u,f,x)}function yv(i,o,u,f){var x=f.children,y=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|u:u,i!==null){for(f=o.child=i.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~y}else f=0,o.child=null;return vv(i,o,y,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Ju(o,y!==null?y.cachePool:null),y!==null?k1(o,y):om(),C1(o);else return f=o.lanes=536870912,vv(i,o,y!==null?y.baseLanes|u:u,u,f)}else y!==null?(Ju(o,y.cachePool),k1(o,y),mi(),o.memoizedState=null):(i!==null&&Ju(o,null),om(),mi());return Nn(i,o,x,u),o.child}function Zl(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function vv(i,o,u,f,x){var y=tm();return y=y===null?null:{parent:Qt._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},i!==null&&Ju(o,null),om(),C1(o),i!==null&&xo(i,o,f,!0),o.childLanes=x,null}function fd(i,o){return o=pd({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function wv(i,o,u){return wa(o,i.child,null,u),i=fd(o,o.pendingProps),i.flags|=2,fr(o),o.memoizedState=null,i}function kj(i,o,u){var f=o.pendingProps,x=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(ot){if(f.mode==="hidden")return i=fd(o,f),o.lanes=536870912,Zl(null,i);if(cm(o),(i=At)?(i=Rw(i,Er),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:oi!==null?{id:es,overflow:ts}:null,retryLane:536870912,hydrationErrors:null},u=s1(i),u.return=o,o.child=u,Sn=o,At=null)):i=null,i===null)throw ci(o);return o.lanes=536870912,null}return fd(o,f)}var y=i.memoizedState;if(y!==null){var S=y.dehydrated;if(cm(o),x)if(o.flags&256)o.flags&=-257,o=wv(i,o,u);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(r(558));else if(en||xo(i,o,u,!1),x=(u&i.childLanes)!==0,en||x){if(f=kt,f!==null&&(S=Ye(f,u),S!==0&&S!==y.retryLane))throw y.retryLane=S,ha(i,S),nr(f,i,S),jm;Cd(),o=wv(i,o,u)}else i=y.treeContext,At=Tr(S.nextSibling),Sn=o,ot=!0,li=null,Er=!1,i!==null&&o1(o,i),o=fd(o,f),o.flags|=4096;return o}return i=vs(i.child,{mode:f.mode,children:f.children}),i.ref=o.ref,o.child=i,i.return=o,i}function hd(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(o.flags|=4194816)}}function Om(i,o,u,f,x){return xa(o),u=dm(i,o,u,f,void 0,x),f=fm(),i!==null&&!en?(hm(i,o,x),Ns(i,o,x)):(ot&&f&&Wp(o),o.flags|=1,Nn(i,o,u,x),o.child)}function kv(i,o,u,f,x,y){return xa(o),o.updateQueue=null,u=E1(o,f,u,x),S1(i),f=fm(),i!==null&&!en?(hm(i,o,y),Ns(i,o,y)):(ot&&f&&Wp(o),o.flags|=1,Nn(i,o,u,y),o.child)}function Cv(i,o,u,f,x){if(xa(o),o.stateNode===null){var y=ho,S=u.contextType;typeof S=="object"&&S!==null&&(y=En(S)),y=new u(f,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Am,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=f,y.state=o.memoizedState,y.refs={},rm(o),S=u.contextType,y.context=typeof S=="object"&&S!==null?En(S):ho,y.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Tm(o,u,S,f),y.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&Am.enqueueReplaceState(y,y.state,null),Kl(o,f,y,x),Gl(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(i===null){y=o.stateNode;var T=o.memoizedProps,D=Ca(u,T);y.props=D;var X=y.context,le=u.contextType;S=ho,typeof le=="object"&&le!==null&&(S=En(le));var de=u.getDerivedStateFromProps;le=typeof de=="function"||typeof y.getSnapshotBeforeUpdate=="function",T=o.pendingProps!==T,le||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T||X!==S)&&cv(o,y,f,S),di=!1;var ee=o.memoizedState;y.state=ee,Kl(o,f,y,x),Gl(),X=o.memoizedState,T||ee!==X||di?(typeof de=="function"&&(Tm(o,u,de,f),X=o.memoizedState),(D=di||lv(o,u,D,f,ee,X,S))?(le||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=X),y.props=f,y.state=X,y.context=S,f=D):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{y=o.stateNode,sm(i,o),S=o.memoizedProps,le=Ca(u,S),y.props=le,de=o.pendingProps,ee=y.context,X=u.contextType,D=ho,typeof X=="object"&&X!==null&&(D=En(X)),T=u.getDerivedStateFromProps,(X=typeof T=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==de||ee!==D)&&cv(o,y,f,D),di=!1,ee=o.memoizedState,y.state=ee,Kl(o,f,y,x),Gl();var se=o.memoizedState;S!==de||ee!==se||di||i!==null&&i.dependencies!==null&&Ku(i.dependencies)?(typeof T=="function"&&(Tm(o,u,T,f),se=o.memoizedState),(le=di||lv(o,u,le,f,ee,se,D)||i!==null&&i.dependencies!==null&&Ku(i.dependencies))?(X||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,se,D),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,se,D)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=se),y.props=f,y.state=se,y.context=D,f=le):(typeof y.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(o.flags|=1024),f=!1)}return y=f,hd(i,o),f=(o.flags&128)!==0,y||f?(y=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,i!==null&&f?(o.child=wa(o,i.child,null,x),o.child=wa(o,null,u,x)):Nn(i,o,u,x),o.memoizedState=y.state,i=o.child):i=Ns(i,o,x),i}function Sv(i,o,u,f){return ma(),o.flags|=256,Nn(i,o,u,f),o.child}var _m={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rm(i){return{baseLanes:i,cachePool:h1()}}function Dm(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=pr),i}function Ev(i,o,u){var f=o.pendingProps,x=!1,y=(o.flags&128)!==0,S;if((S=y)||(S=i!==null&&i.memoizedState===null?!1:(Kt.current&2)!==0),S&&(x=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,i===null){if(ot){if(x?pi(o):mi(),(i=At)?(i=Rw(i,Er),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:oi!==null?{id:es,overflow:ts}:null,retryLane:536870912,hydrationErrors:null},u=s1(i),u.return=o,o.child=u,Sn=o,At=null)):i=null,i===null)throw ci(o);return gg(i)?o.lanes=32:o.lanes=536870912,null}var T=f.children;return f=f.fallback,x?(mi(),x=o.mode,T=pd({mode:"hidden",children:T},x),f=pa(f,x,u,null),T.return=o,f.return=o,T.sibling=f,o.child=T,f=o.child,f.memoizedState=Rm(u),f.childLanes=Dm(i,S,u),o.memoizedState=_m,Zl(null,f)):(pi(o),Lm(o,T))}var D=i.memoizedState;if(D!==null&&(T=D.dehydrated,T!==null)){if(y)o.flags&256?(pi(o),o.flags&=-257,o=Im(i,o,u)):o.memoizedState!==null?(mi(),o.child=i.child,o.flags|=128,o=null):(mi(),T=f.fallback,x=o.mode,f=pd({mode:"visible",children:f.children},x),T=pa(T,x,u,null),T.flags|=2,f.return=o,T.return=o,f.sibling=T,o.child=f,wa(o,i.child,null,u),f=o.child,f.memoizedState=Rm(u),f.childLanes=Dm(i,S,u),o.memoizedState=_m,o=Zl(null,f));else if(pi(o),gg(T)){if(S=T.nextSibling&&T.nextSibling.dataset,S)var X=S.dgst;S=X,f=Error(r(419)),f.stack="",f.digest=S,Fl({value:f,source:null,stack:null}),o=Im(i,o,u)}else if(en||xo(i,o,u,!1),S=(u&i.childLanes)!==0,en||S){if(S=kt,S!==null&&(f=Ye(S,u),f!==0&&f!==D.retryLane))throw D.retryLane=f,ha(i,f),nr(S,i,f),jm;mg(T)||Cd(),o=Im(i,o,u)}else mg(T)?(o.flags|=192,o.child=i.child,o=null):(i=D.treeContext,At=Tr(T.nextSibling),Sn=o,ot=!0,li=null,Er=!1,i!==null&&o1(o,i),o=Lm(o,f.children),o.flags|=4096);return o}return x?(mi(),T=f.fallback,x=o.mode,D=i.child,X=D.sibling,f=vs(D,{mode:"hidden",children:f.children}),f.subtreeFlags=D.subtreeFlags&65011712,X!==null?T=vs(X,T):(T=pa(T,x,u,null),T.flags|=2),T.return=o,f.return=o,f.sibling=T,o.child=f,Zl(null,f),f=o.child,T=i.child.memoizedState,T===null?T=Rm(u):(x=T.cachePool,x!==null?(D=Qt._currentValue,x=x.parent!==D?{parent:D,pool:D}:x):x=h1(),T={baseLanes:T.baseLanes|u,cachePool:x}),f.memoizedState=T,f.childLanes=Dm(i,S,u),o.memoizedState=_m,Zl(i.child,f)):(pi(o),u=i.child,i=u.sibling,u=vs(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,i!==null&&(S=o.deletions,S===null?(o.deletions=[i],o.flags|=16):S.push(i)),o.child=u,o.memoizedState=null,u)}function Lm(i,o){return o=pd({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function pd(i,o){return i=ur(22,i,null,o),i.lanes=0,i}function Im(i,o,u){return wa(o,i.child,null,u),i=Lm(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Nv(i,o,u){i.lanes|=o;var f=i.alternate;f!==null&&(f.lanes|=o),Xp(i.return,o,u)}function zm(i,o,u,f,x,y){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:x,treeForkCount:y}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=u,S.tailMode=x,S.treeForkCount=y)}function Tv(i,o,u){var f=o.pendingProps,x=f.revealOrder,y=f.tail;f=f.children;var S=Kt.current,T=(S&2)!==0;if(T?(S=S&1|2,o.flags|=128):S&=1,W(Kt,S),Nn(i,o,f,u),f=ot?Hl:0,!T&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Nv(i,u,o);else if(i.tag===19)Nv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(x){case"forwards":for(u=o.child,x=null;u!==null;)i=u.alternate,i!==null&&nd(i)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),zm(o,!1,x,u,y,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(i=x.alternate,i!==null&&nd(i)===null){o.child=x;break}i=x.sibling,x.sibling=u,u=x,x=i}zm(o,!0,u,null,y,f);break;case"together":zm(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function Ns(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),bi|=o.lanes,(u&o.childLanes)===0)if(i!==null){if(xo(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=vs(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=vs(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function Bm(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&Ku(i)))}function Cj(i,o,u){switch(o.tag){case 3:$(o,o.stateNode.containerInfo),ui(o,Qt,i.memoizedState.cache),ma();break;case 27:case 5:ie(o);break;case 4:$(o,o.stateNode.containerInfo);break;case 10:ui(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,cm(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(pi(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Ev(i,o,u):(pi(o),i=Ns(i,o,u),i!==null?i.sibling:null);pi(o);break;case 19:var x=(i.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(xo(i,o,u,!1),f=(u&o.childLanes)!==0),x){if(f)return Tv(i,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),W(Kt,Kt.current),f)break;return null;case 22:return o.lanes=0,yv(i,o,u,o.pendingProps);case 24:ui(o,Qt,i.memoizedState.cache)}return Ns(i,o,u)}function Av(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)en=!0;else{if(!Bm(i,u)&&(o.flags&128)===0)return en=!1,Cj(i,o,u);en=(i.flags&131072)!==0}else en=!1,ot&&(o.flags&1048576)!==0&&a1(o,Hl,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(i=ya(o.elementType),o.type=i,typeof i=="function")$p(i)?(f=Ca(i,f),o.tag=1,o=Cv(null,o,i,f,u)):(o.tag=0,o=Om(null,o,i,f,u));else{if(i!=null){var x=i.$$typeof;if(x===P){o.tag=11,o=gv(null,o,i,f,u);break e}else if(x===j){o.tag=14,o=xv(null,o,i,f,u);break e}}throw o=Te(i)||i,Error(r(306,o,""))}}return o;case 0:return Om(i,o,o.type,o.pendingProps,u);case 1:return f=o.type,x=Ca(f,o.pendingProps),Cv(i,o,f,x,u);case 3:e:{if($(o,o.stateNode.containerInfo),i===null)throw Error(r(387));f=o.pendingProps;var y=o.memoizedState;x=y.element,sm(i,o),Kl(o,f,null,u);var S=o.memoizedState;if(f=S.cache,ui(o,Qt,f),f!==y.cache&&Qp(o,[Qt],u,!0),Gl(),f=S.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=Sv(i,o,f,u);break e}else if(f!==x){x=kr(Error(r(424)),o),Fl(x),o=Sv(i,o,f,u);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(At=Tr(i.firstChild),Sn=o,ot=!0,li=null,Er=!0,u=y1(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(ma(),f===x){o=Ns(i,o,u);break e}Nn(i,o,f,u)}o=o.child}return o;case 26:return hd(i,o),i===null?(u=Pw(o.type,null,o.pendingProps,null))?o.memoizedState=u:ot||(u=o.type,i=o.pendingProps,f=jd(L.current).createElement(u),f[cn]=o,f[mn]=i,Tn(f,u,i),Xt(f),o.stateNode=f):o.memoizedState=Pw(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return ie(o),i===null&&ot&&(f=o.stateNode=Iw(o.type,o.pendingProps,L.current),Sn=o,Er=!0,x=At,Ci(o.type)?(xg=x,At=Tr(f.firstChild)):At=x),Nn(i,o,o.pendingProps.children,u),hd(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&ot&&((x=f=At)&&(f=Zj(f,o.type,o.pendingProps,Er),f!==null?(o.stateNode=f,Sn=o,At=Tr(f.firstChild),Er=!1,x=!0):x=!1),x||ci(o)),ie(o),x=o.type,y=o.pendingProps,S=i!==null?i.memoizedProps:null,f=y.children,fg(x,y)?f=null:S!==null&&fg(x,S)&&(o.flags|=32),o.memoizedState!==null&&(x=dm(i,o,pj,null,null,u),pc._currentValue=x),hd(i,o),Nn(i,o,f,u),o.child;case 6:return i===null&&ot&&((i=u=At)&&(u=eO(u,o.pendingProps,Er),u!==null?(o.stateNode=u,Sn=o,At=null,i=!0):i=!1),i||ci(o)),null;case 13:return Ev(i,o,u);case 4:return $(o,o.stateNode.containerInfo),f=o.pendingProps,i===null?o.child=wa(o,null,f,u):Nn(i,o,f,u),o.child;case 11:return gv(i,o,o.type,o.pendingProps,u);case 7:return Nn(i,o,o.pendingProps,u),o.child;case 8:return Nn(i,o,o.pendingProps.children,u),o.child;case 12:return Nn(i,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,ui(o,o.type,f.value),Nn(i,o,f.children,u),o.child;case 9:return x=o.type._context,f=o.pendingProps.children,xa(o),x=En(x),f=f(x),o.flags|=1,Nn(i,o,f,u),o.child;case 14:return xv(i,o,o.type,o.pendingProps,u);case 15:return bv(i,o,o.type,o.pendingProps,u);case 19:return Tv(i,o,u);case 31:return kj(i,o,u);case 22:return yv(i,o,u,o.pendingProps);case 24:return xa(o),f=En(Qt),i===null?(x=tm(),x===null&&(x=kt,y=Zp(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=u),x=y),o.memoizedState={parent:f,cache:x},rm(o),ui(o,Qt,x)):((i.lanes&u)!==0&&(sm(i,o),Kl(o,null,null,u),Gl()),x=i.memoizedState,y=o.memoizedState,x.parent!==f?(x={parent:f,cache:f},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),ui(o,Qt,f)):(f=y.cache,ui(o,Qt,f),f!==x.cache&&Qp(o,[Qt],u,!0))),Nn(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Ts(i){i.flags|=4}function Pm(i,o,u,f,x){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(x&335544128)===x)if(i.stateNode.complete)i.flags|=8192;else if(tw())i.flags|=8192;else throw va=Qu,nm}else i.flags&=-16777217}function Mv(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Vw(o))if(tw())i.flags|=8192;else throw va=Qu,nm}function md(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Ce():536870912,i.lanes|=o,Mo|=o)}function ec(i,o){if(!ot)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Mt(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,f=0;if(o)for(var x=i.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)u|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=f,i.childLanes=u,o}function Sj(i,o,u){var f=o.pendingProps;switch(Gp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(o),null;case 1:return Mt(o),null;case 3:return u=o.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),Cs(Qt),ne(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(go(o)?Ts(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Yp())),Mt(o),null;case 26:var x=o.type,y=o.memoizedState;return i===null?(Ts(o),y!==null?(Mt(o),Mv(o,y)):(Mt(o),Pm(o,x,null,f,u))):y?y!==i.memoizedState?(Ts(o),Mt(o),Mv(o,y)):(Mt(o),o.flags&=-16777217):(i=i.memoizedProps,i!==f&&Ts(o),Mt(o),Pm(o,x,i,f,u)),null;case 27:if(Oe(o),u=L.current,x=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==f&&Ts(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Mt(o),null}i=oe.current,go(o)?l1(o):(i=Iw(x,f,u),o.stateNode=i,Ts(o))}return Mt(o),null;case 5:if(Oe(o),x=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==f&&Ts(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Mt(o),null}if(y=oe.current,go(o))l1(o);else{var S=jd(L.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?S.createElement(x,{is:f.is}):S.createElement(x)}}y[cn]=o,y[mn]=f;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=y;e:switch(Tn(y,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ts(o)}}return Mt(o),Pm(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,u),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==f&&Ts(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(r(166));if(i=L.current,go(o)){if(i=o.stateNode,u=o.memoizedProps,f=null,x=Sn,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}i[cn]=o,i=!!(i.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||Ew(i.nodeValue,u)),i||ci(o,!0)}else i=jd(i).createTextNode(f),i[cn]=o,o.stateNode=i}return Mt(o),null;case 31:if(u=o.memoizedState,i===null||i.memoizedState!==null){if(f=go(o),u!==null){if(i===null){if(!f)throw Error(r(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[cn]=o}else ma(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mt(o),i=!1}else u=Yp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return o.flags&256?(fr(o),o):(fr(o),null);if((o.flags&128)!==0)throw Error(r(558))}return Mt(o),null;case 13:if(f=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(x=go(o),f!==null&&f.dehydrated!==null){if(i===null){if(!x)throw Error(r(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[cn]=o}else ma(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Mt(o),x=!1}else x=Yp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(fr(o),o):(fr(o),null)}return fr(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,i=i!==null&&i.memoizedState!==null,u&&(f=o.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==x&&(f.flags|=2048)),u!==i&&u&&(o.child.flags|=8192),md(o,o.updateQueue),Mt(o),null);case 4:return ne(),i===null&&og(o.stateNode.containerInfo),Mt(o),null;case 10:return Cs(o.type),Mt(o),null;case 19:if(R(Kt),f=o.memoizedState,f===null)return Mt(o),null;if(x=(o.flags&128)!==0,y=f.rendering,y===null)if(x)ec(f,!1);else{if(Ut!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(y=nd(i),y!==null){for(o.flags|=128,ec(f,!1),i=y.updateQueue,o.updateQueue=i,md(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)r1(u,i),u=u.sibling;return W(Kt,Kt.current&1|2),ot&&ws(o,f.treeForkCount),o.child}i=i.sibling}f.tail!==null&&Dt()>vd&&(o.flags|=128,x=!0,ec(f,!1),o.lanes=4194304)}else{if(!x)if(i=nd(y),i!==null){if(o.flags|=128,x=!0,i=i.updateQueue,o.updateQueue=i,md(o,i),ec(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!ot)return Mt(o),null}else 2*Dt()-f.renderingStartTime>vd&&u!==536870912&&(o.flags|=128,x=!0,ec(f,!1),o.lanes=4194304);f.isBackwards?(y.sibling=o.child,o.child=y):(i=f.last,i!==null?i.sibling=y:o.child=y,f.last=y)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Dt(),i.sibling=null,u=Kt.current,W(Kt,x?u&1|2:u&1),ot&&ws(o,f.treeForkCount),i):(Mt(o),null);case 22:case 23:return fr(o),lm(),f=o.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(Mt(o),o.subtreeFlags&6&&(o.flags|=8192)):Mt(o),u=o.updateQueue,u!==null&&md(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),i!==null&&R(ba),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Cs(Qt),Mt(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function Ej(i,o){switch(Gp(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Cs(Qt),ne(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Oe(o),null;case 31:if(o.memoizedState!==null){if(fr(o),o.alternate===null)throw Error(r(340));ma()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(fr(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));ma()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return R(Kt),null;case 4:return ne(),null;case 10:return Cs(o.type),null;case 22:case 23:return fr(o),lm(),i!==null&&R(ba),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return Cs(Qt),null;case 25:return null;default:return null}}function jv(i,o){switch(Gp(o),o.tag){case 3:Cs(Qt),ne();break;case 26:case 27:case 5:Oe(o);break;case 4:ne();break;case 31:o.memoizedState!==null&&fr(o);break;case 13:fr(o);break;case 19:R(Kt);break;case 10:Cs(o.type);break;case 22:case 23:fr(o),lm(),i!==null&&R(ba);break;case 24:Cs(Qt)}}function tc(i,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var x=f.next;u=x;do{if((u.tag&i)===i){f=void 0;var y=u.create,S=u.inst;f=y(),S.destroy=f}u=u.next}while(u!==x)}}catch(T){gt(o,o.return,T)}}function gi(i,o,u){try{var f=o.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var y=x.next;f=y;do{if((f.tag&i)===i){var S=f.inst,T=S.destroy;if(T!==void 0){S.destroy=void 0,x=o;var D=u,X=T;try{X()}catch(le){gt(x,D,le)}}}f=f.next}while(f!==y)}}catch(le){gt(o,o.return,le)}}function Ov(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{w1(o,u)}catch(f){gt(i,i.return,f)}}}function _v(i,o,u){u.props=Ca(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(f){gt(i,o,f)}}function nc(i,o){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof u=="function"?i.refCleanup=u(f):u.current=f}}catch(x){gt(i,o,x)}}function ns(i,o){var u=i.ref,f=i.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(x){gt(i,o,x)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){gt(i,o,x)}else u.current=null}function Rv(i){var o=i.type,u=i.memoizedProps,f=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(x){gt(i,i.return,x)}}function Hm(i,o,u){try{var f=i.stateNode;Gj(f,i.type,u,o),f[mn]=o}catch(x){gt(i,i.return,x)}}function Dv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ci(i.type)||i.tag===4}function Fm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ci(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Um(i,o,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(i),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=bs));else if(f!==4&&(f===27&&Ci(i.type)&&(u=i.stateNode,o=null),i=i.child,i!==null))for(Um(i,o,u),i=i.sibling;i!==null;)Um(i,o,u),i=i.sibling}function gd(i,o,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(f!==4&&(f===27&&Ci(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(gd(i,o,u),i=i.sibling;i!==null;)gd(i,o,u),i=i.sibling}function Lv(i){var o=i.stateNode,u=i.memoizedProps;try{for(var f=i.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Tn(o,f,u),o[cn]=i,o[mn]=u}catch(y){gt(i,i.return,y)}}var As=!1,tn=!1,$m=!1,Iv=typeof WeakSet=="function"?WeakSet:Set,gn=null;function Nj(i,o){if(i=i.containerInfo,ug=zd,i=Ky(i),Ip(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var x=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var S=0,T=-1,D=-1,X=0,le=0,de=i,ee=null;t:for(;;){for(var se;de!==u||x!==0&&de.nodeType!==3||(T=S+x),de!==y||f!==0&&de.nodeType!==3||(D=S+f),de.nodeType===3&&(S+=de.nodeValue.length),(se=de.firstChild)!==null;)ee=de,de=se;for(;;){if(de===i)break t;if(ee===u&&++X===x&&(T=S),ee===y&&++le===f&&(D=S),(se=de.nextSibling)!==null)break;de=ee,ee=de.parentNode}de=se}u=T===-1||D===-1?null:{start:T,end:D}}else u=null}u=u||{start:0,end:0}}else u=null;for(dg={focusedElem:i,selectionRange:u},zd=!1,gn=o;gn!==null;)if(o=gn,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,gn=i;else for(;gn!==null;){switch(o=gn,y=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)x=i[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,u=o,x=y.memoizedProps,y=y.memoizedState,f=u.stateNode;try{var je=Ca(u.type,x);i=f.getSnapshotBeforeUpdate(je,y),f.__reactInternalSnapshotBeforeUpdate=i}catch(Fe){gt(u,u.return,Fe)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)pg(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":pg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,gn=i;break}gn=o.return}}function zv(i,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:js(i,u),f&4&&tc(5,u);break;case 1:if(js(i,u),f&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(S){gt(u,u.return,S)}else{var x=Ca(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(x,o,i.__reactInternalSnapshotBeforeUpdate)}catch(S){gt(u,u.return,S)}}f&64&&Ov(u),f&512&&nc(u,u.return);break;case 3:if(js(i,u),f&64&&(i=u.updateQueue,i!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{w1(i,o)}catch(S){gt(u,u.return,S)}}break;case 27:o===null&&f&4&&Lv(u);case 26:case 5:js(i,u),o===null&&f&4&&Rv(u),f&512&&nc(u,u.return);break;case 12:js(i,u);break;case 31:js(i,u),f&4&&Hv(i,u);break;case 13:js(i,u),f&4&&Fv(i,u),f&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=Lj.bind(null,u),tO(i,u))));break;case 22:if(f=u.memoizedState!==null||As,!f){o=o!==null&&o.memoizedState!==null||tn,x=As;var y=tn;As=f,(tn=o)&&!y?Os(i,u,(u.subtreeFlags&8772)!==0):js(i,u),As=x,tn=y}break;case 30:break;default:js(i,u)}}function Bv(i){var o=i.alternate;o!==null&&(i.alternate=null,Bv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Nl(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Lt=null,Qn=!1;function Ms(i,o,u){for(u=u.child;u!==null;)Pv(i,o,u),u=u.sibling}function Pv(i,o,u){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(pn,u)}catch{}switch(u.tag){case 26:tn||ns(u,o),Ms(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:tn||ns(u,o);var f=Lt,x=Qn;Ci(u.type)&&(Lt=u.stateNode,Qn=!1),Ms(i,o,u),dc(u.stateNode),Lt=f,Qn=x;break;case 5:tn||ns(u,o);case 6:if(f=Lt,x=Qn,Lt=null,Ms(i,o,u),Lt=f,Qn=x,Lt!==null)if(Qn)try{(Lt.nodeType===9?Lt.body:Lt.nodeName==="HTML"?Lt.ownerDocument.body:Lt).removeChild(u.stateNode)}catch(y){gt(u,o,y)}else try{Lt.removeChild(u.stateNode)}catch(y){gt(u,o,y)}break;case 18:Lt!==null&&(Qn?(i=Lt,Ow(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),zo(i)):Ow(Lt,u.stateNode));break;case 4:f=Lt,x=Qn,Lt=u.stateNode.containerInfo,Qn=!0,Ms(i,o,u),Lt=f,Qn=x;break;case 0:case 11:case 14:case 15:gi(2,u,o),tn||gi(4,u,o),Ms(i,o,u);break;case 1:tn||(ns(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&_v(u,o,f)),Ms(i,o,u);break;case 21:Ms(i,o,u);break;case 22:tn=(f=tn)||u.memoizedState!==null,Ms(i,o,u),tn=f;break;default:Ms(i,o,u)}}function Hv(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{zo(i)}catch(u){gt(o,o.return,u)}}}function Fv(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{zo(i)}catch(u){gt(o,o.return,u)}}function Tj(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Iv),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Iv),o;default:throw Error(r(435,i.tag))}}function xd(i,o){var u=Tj(i);o.forEach(function(f){if(!u.has(f)){u.add(f);var x=Ij.bind(null,i,f);f.then(x,x)}})}function Zn(i,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var x=u[f],y=i,S=o,T=S;e:for(;T!==null;){switch(T.tag){case 27:if(Ci(T.type)){Lt=T.stateNode,Qn=!1;break e}break;case 5:Lt=T.stateNode,Qn=!1;break e;case 3:case 4:Lt=T.stateNode.containerInfo,Qn=!0;break e}T=T.return}if(Lt===null)throw Error(r(160));Pv(y,S,x),Lt=null,Qn=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Uv(o,i),o=o.sibling}var Br=null;function Uv(i,o){var u=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Zn(o,i),er(i),f&4&&(gi(3,i,i.return),tc(3,i),gi(5,i,i.return));break;case 1:Zn(o,i),er(i),f&512&&(tn||u===null||ns(u,u.return)),f&64&&As&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var x=Br;if(Zn(o,i),er(i),f&512&&(tn||u===null||ns(u,u.return)),f&4){var y=u!==null?u.memoizedState:null;if(f=i.memoizedState,u===null)if(f===null)if(i.stateNode===null){e:{f=i.type,u=i.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":y=x.getElementsByTagName("title")[0],(!y||y[ni]||y[cn]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(f),x.head.insertBefore(y,x.querySelector("head > title"))),Tn(y,f,u),y[cn]=i,Xt(y),f=y;break e;case"link":var S=Uw("link","href",x).get(f+(u.href||""));if(S){for(var T=0;T<S.length;T++)if(y=S[T],y.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&y.getAttribute("rel")===(u.rel==null?null:u.rel)&&y.getAttribute("title")===(u.title==null?null:u.title)&&y.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(T,1);break t}}y=x.createElement(f),Tn(y,f,u),x.head.appendChild(y);break;case"meta":if(S=Uw("meta","content",x).get(f+(u.content||""))){for(T=0;T<S.length;T++)if(y=S[T],y.getAttribute("content")===(u.content==null?null:""+u.content)&&y.getAttribute("name")===(u.name==null?null:u.name)&&y.getAttribute("property")===(u.property==null?null:u.property)&&y.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&y.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(T,1);break t}}y=x.createElement(f),Tn(y,f,u),x.head.appendChild(y);break;default:throw Error(r(468,f))}y[cn]=i,Xt(y),f=y}i.stateNode=f}else $w(x,i.type,i.stateNode);else i.stateNode=Fw(x,f,i.memoizedProps);else y!==f?(y===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):y.count--,f===null?$w(x,i.type,i.stateNode):Fw(x,f,i.memoizedProps)):f===null&&i.stateNode!==null&&Hm(i,i.memoizedProps,u.memoizedProps)}break;case 27:Zn(o,i),er(i),f&512&&(tn||u===null||ns(u,u.return)),u!==null&&f&4&&Hm(i,i.memoizedProps,u.memoizedProps);break;case 5:if(Zn(o,i),er(i),f&512&&(tn||u===null||ns(u,u.return)),i.flags&32){x=i.stateNode;try{io(x,"")}catch(je){gt(i,i.return,je)}}f&4&&i.stateNode!=null&&(x=i.memoizedProps,Hm(i,x,u!==null?u.memoizedProps:x)),f&1024&&($m=!0);break;case 6:if(Zn(o,i),er(i),f&4){if(i.stateNode===null)throw Error(r(162));f=i.memoizedProps,u=i.stateNode;try{u.nodeValue=f}catch(je){gt(i,i.return,je)}}break;case 3:if(Rd=null,x=Br,Br=Od(o.containerInfo),Zn(o,i),Br=x,er(i),f&4&&u!==null&&u.memoizedState.isDehydrated)try{zo(o.containerInfo)}catch(je){gt(i,i.return,je)}$m&&($m=!1,$v(i));break;case 4:f=Br,Br=Od(i.stateNode.containerInfo),Zn(o,i),er(i),Br=f;break;case 12:Zn(o,i),er(i);break;case 31:Zn(o,i),er(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 13:Zn(o,i),er(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(yd=Dt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 22:x=i.memoizedState!==null;var D=u!==null&&u.memoizedState!==null,X=As,le=tn;if(As=X||x,tn=le||D,Zn(o,i),tn=le,As=X,er(i),f&8192)e:for(o=i.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||D||As||tn||Sa(i)),u=null,o=i;;){if(o.tag===5||o.tag===26){if(u===null){D=u=o;try{if(y=D.stateNode,x)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{T=D.stateNode;var de=D.memoizedProps.style,ee=de!=null&&de.hasOwnProperty("display")?de.display:null;T.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(je){gt(D,D.return,je)}}}else if(o.tag===6){if(u===null){D=o;try{D.stateNode.nodeValue=x?"":D.memoizedProps}catch(je){gt(D,D.return,je)}}}else if(o.tag===18){if(u===null){D=o;try{var se=D.stateNode;x?_w(se,!0):_w(D.stateNode,!1)}catch(je){gt(D,D.return,je)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=i.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,xd(i,u))));break;case 19:Zn(o,i),er(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,xd(i,f)));break;case 30:break;case 21:break;default:Zn(o,i),er(i)}}function er(i){var o=i.flags;if(o&2){try{for(var u,f=i.return;f!==null;){if(Dv(f)){u=f;break}f=f.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var x=u.stateNode,y=Fm(i);gd(i,y,x);break;case 5:var S=u.stateNode;u.flags&32&&(io(S,""),u.flags&=-33);var T=Fm(i);gd(i,T,S);break;case 3:case 4:var D=u.stateNode.containerInfo,X=Fm(i);Um(i,X,D);break;default:throw Error(r(161))}}catch(le){gt(i,i.return,le)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function $v(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;$v(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function js(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)zv(i,o.alternate,o),o=o.sibling}function Sa(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:gi(4,o,o.return),Sa(o);break;case 1:ns(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&_v(o,o.return,u),Sa(o);break;case 27:dc(o.stateNode);case 26:case 5:ns(o,o.return),Sa(o);break;case 22:o.memoizedState===null&&Sa(o);break;case 30:Sa(o);break;default:Sa(o)}i=i.sibling}}function Os(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,x=i,y=o,S=y.flags;switch(y.tag){case 0:case 11:case 15:Os(x,y,u),tc(4,y);break;case 1:if(Os(x,y,u),f=y,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(X){gt(f,f.return,X)}if(f=y,x=f.updateQueue,x!==null){var T=f.stateNode;try{var D=x.shared.hiddenCallbacks;if(D!==null)for(x.shared.hiddenCallbacks=null,x=0;x<D.length;x++)v1(D[x],T)}catch(X){gt(f,f.return,X)}}u&&S&64&&Ov(y),nc(y,y.return);break;case 27:Lv(y);case 26:case 5:Os(x,y,u),u&&f===null&&S&4&&Rv(y),nc(y,y.return);break;case 12:Os(x,y,u);break;case 31:Os(x,y,u),u&&S&4&&Hv(x,y);break;case 13:Os(x,y,u),u&&S&4&&Fv(x,y);break;case 22:y.memoizedState===null&&Os(x,y,u),nc(y,y.return);break;case 30:break;default:Os(x,y,u)}o=o.sibling}}function Vm(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&Ul(u))}function qm(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Ul(i))}function Pr(i,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Vv(i,o,u,f),o=o.sibling}function Vv(i,o,u,f){var x=o.flags;switch(o.tag){case 0:case 11:case 15:Pr(i,o,u,f),x&2048&&tc(9,o);break;case 1:Pr(i,o,u,f);break;case 3:Pr(i,o,u,f),x&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Ul(i)));break;case 12:if(x&2048){Pr(i,o,u,f),i=o.stateNode;try{var y=o.memoizedProps,S=y.id,T=y.onPostCommit;typeof T=="function"&&T(S,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(D){gt(o,o.return,D)}}else Pr(i,o,u,f);break;case 31:Pr(i,o,u,f);break;case 13:Pr(i,o,u,f);break;case 23:break;case 22:y=o.stateNode,S=o.alternate,o.memoizedState!==null?y._visibility&2?Pr(i,o,u,f):rc(i,o):y._visibility&2?Pr(i,o,u,f):(y._visibility|=2,No(i,o,u,f,(o.subtreeFlags&10256)!==0||!1)),x&2048&&Vm(S,o);break;case 24:Pr(i,o,u,f),x&2048&&qm(o.alternate,o);break;default:Pr(i,o,u,f)}}function No(i,o,u,f,x){for(x=x&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=i,S=o,T=u,D=f,X=S.flags;switch(S.tag){case 0:case 11:case 15:No(y,S,T,D,x),tc(8,S);break;case 23:break;case 22:var le=S.stateNode;S.memoizedState!==null?le._visibility&2?No(y,S,T,D,x):rc(y,S):(le._visibility|=2,No(y,S,T,D,x)),x&&X&2048&&Vm(S.alternate,S);break;case 24:No(y,S,T,D,x),x&&X&2048&&qm(S.alternate,S);break;default:No(y,S,T,D,x)}o=o.sibling}}function rc(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,f=o,x=f.flags;switch(f.tag){case 22:rc(u,f),x&2048&&Vm(f.alternate,f);break;case 24:rc(u,f),x&2048&&qm(f.alternate,f);break;default:rc(u,f)}o=o.sibling}}var sc=8192;function To(i,o,u){if(i.subtreeFlags&sc)for(i=i.child;i!==null;)qv(i,o,u),i=i.sibling}function qv(i,o,u){switch(i.tag){case 26:To(i,o,u),i.flags&sc&&i.memoizedState!==null&&hO(u,Br,i.memoizedState,i.memoizedProps);break;case 5:To(i,o,u);break;case 3:case 4:var f=Br;Br=Od(i.stateNode.containerInfo),To(i,o,u),Br=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=sc,sc=16777216,To(i,o,u),sc=f):To(i,o,u));break;default:To(i,o,u)}}function Wv(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function ic(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];gn=f,Kv(f,i)}Wv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Gv(i),i=i.sibling}function Gv(i){switch(i.tag){case 0:case 11:case 15:ic(i),i.flags&2048&&gi(9,i,i.return);break;case 3:ic(i);break;case 12:ic(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,bd(i)):ic(i);break;default:ic(i)}}function bd(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];gn=f,Kv(f,i)}Wv(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:gi(8,o,o.return),bd(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,bd(o));break;default:bd(o)}i=i.sibling}}function Kv(i,o){for(;gn!==null;){var u=gn;switch(u.tag){case 0:case 11:case 15:gi(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ul(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,gn=f;else e:for(u=i;gn!==null;){f=gn;var x=f.sibling,y=f.return;if(Bv(f),f===u){gn=null;break e}if(x!==null){x.return=y,gn=x;break e}gn=y}}}var Aj={getCacheForType:function(i){var o=En(Qt),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u},cacheSignal:function(){return En(Qt).controller.signal}},Mj=typeof WeakMap=="function"?WeakMap:Map,dt=0,kt=null,et=null,it=0,mt=0,hr=null,xi=!1,Ao=!1,Wm=!1,_s=0,Ut=0,bi=0,Ea=0,Gm=0,pr=0,Mo=0,ac=null,tr=null,Km=!1,yd=0,Yv=0,vd=1/0,wd=null,yi=null,un=0,vi=null,jo=null,Rs=0,Ym=0,Jm=null,Jv=null,oc=0,Xm=null;function mr(){return(dt&2)!==0&&it!==0?it&-it:U.T!==null?rg():Cn()}function Xv(){if(pr===0)if((it&536870912)===0||ot){var i=yr;yr<<=1,(yr&3932160)===0&&(yr=262144),pr=i}else pr=536870912;return i=dr.current,i!==null&&(i.flags|=32),pr}function nr(i,o,u){(i===kt&&(mt===2||mt===9)||i.cancelPendingCommit!==null)&&(Oo(i,0),wi(i,it,pr,!1)),He(i,u),((dt&2)===0||i!==kt)&&(i===kt&&((dt&2)===0&&(Ea|=u),Ut===4&&wi(i,it,pr,!1)),rs(i))}function Qv(i,o,u){if((dt&6)!==0)throw Error(r(327));var f=!u&&(o&127)===0&&(o&i.expiredLanes)===0||me(i,o),x=f?_j(i,o):Zm(i,o,!0),y=f;do{if(x===0){Ao&&!f&&wi(i,o,0,!1);break}else{if(u=i.current.alternate,y&&!jj(u)){x=Zm(i,o,!1),y=!1;continue}if(x===2){if(y=o,i.errorRecoveryDisabledLanes&y)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var T=i;x=ac;var D=T.current.memoizedState.isDehydrated;if(D&&(Oo(T,S).flags|=256),S=Zm(T,S,!1),S!==2){if(Wm&&!D){T.errorRecoveryDisabledLanes|=y,Ea|=y,x=4;break e}y=tr,tr=x,y!==null&&(tr===null?tr=y:tr.push.apply(tr,y))}x=S}if(y=!1,x!==2)continue}}if(x===1){Oo(i,0),wi(i,o,0,!0);break}e:{switch(f=i,y=x,y){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:wi(f,o,pr,!xi);break e;case 2:tr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(x=yd+300-Dt(),10<x)){if(wi(f,o,pr,!xi),ue(f,0,!0)!==0)break e;Rs=o,f.timeoutHandle=Mw(Zv.bind(null,f,u,tr,wd,Km,o,pr,Ea,Mo,xi,y,"Throttled",-0,0),x);break e}Zv(f,u,tr,wd,Km,o,pr,Ea,Mo,xi,y,null,-0,0)}}break}while(!0);rs(i)}function Zv(i,o,u,f,x,y,S,T,D,X,le,de,ee,se){if(i.timeoutHandle=-1,de=o.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:bs},qv(o,y,de);var je=(y&62914560)===y?yd-Dt():(y&4194048)===y?Yv-Dt():0;if(je=pO(de,je),je!==null){Rs=y,i.cancelPendingCommit=je(ow.bind(null,i,o,y,u,f,x,S,T,D,le,de,null,ee,se)),wi(i,y,S,!X);return}}ow(i,o,y,u,f,x,S,T,D)}function jj(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var x=u[f],y=x.getSnapshot;x=x.value;try{if(!cr(y(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function wi(i,o,u,f){o&=~Gm,o&=~Ea,i.suspendedLanes|=o,i.pingedLanes&=~o,f&&(i.warmLanes|=o),f=i.expirationTimes;for(var x=o;0<x;){var y=31-Gt(x),S=1<<y;f[y]=-1,x&=~S}u!==0&&Qe(i,u,o)}function kd(){return(dt&6)===0?(lc(0),!1):!0}function Qm(){if(et!==null){if(mt===0)var i=et.return;else i=et,ks=ga=null,pm(i),wo=null,Vl=0,i=et;for(;i!==null;)jv(i.alternate,i),i=i.return;et=null}}function Oo(i,o){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,Jj(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Rs=0,Qm(),kt=i,et=u=vs(i.current,null),it=o,mt=0,hr=null,xi=!1,Ao=me(i,o),Wm=!1,Mo=pr=Gm=Ea=bi=Ut=0,tr=ac=null,Km=!1,(o&8)!==0&&(o|=o&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=o;0<f;){var x=31-Gt(f),y=1<<x;o|=i[x],f&=~y}return _s=o,$u(),u}function ew(i,o){Ke=null,U.H=Ql,o===vo||o===Xu?(o=g1(),mt=3):o===nm?(o=g1(),mt=4):mt=o===jm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,hr=o,et===null&&(Ut=1,dd(i,kr(o,i.current)))}function tw(){var i=dr.current;return i===null?!0:(it&4194048)===it?Nr===null:(it&62914560)===it||(it&536870912)!==0?i===Nr:!1}function nw(){var i=U.H;return U.H=Ql,i===null?Ql:i}function rw(){var i=U.A;return U.A=Aj,i}function Cd(){Ut=4,xi||(it&4194048)!==it&&dr.current!==null||(Ao=!0),(bi&134217727)===0&&(Ea&134217727)===0||kt===null||wi(kt,it,pr,!1)}function Zm(i,o,u){var f=dt;dt|=2;var x=nw(),y=rw();(kt!==i||it!==o)&&(wd=null,Oo(i,o)),o=!1;var S=Ut;e:do try{if(mt!==0&&et!==null){var T=et,D=hr;switch(mt){case 8:Qm(),S=6;break e;case 3:case 2:case 9:case 6:dr.current===null&&(o=!0);var X=mt;if(mt=0,hr=null,_o(i,T,D,X),u&&Ao){S=0;break e}break;default:X=mt,mt=0,hr=null,_o(i,T,D,X)}}Oj(),S=Ut;break}catch(le){ew(i,le)}while(!0);return o&&i.shellSuspendCounter++,ks=ga=null,dt=f,U.H=x,U.A=y,et===null&&(kt=null,it=0,$u()),S}function Oj(){for(;et!==null;)sw(et)}function _j(i,o){var u=dt;dt|=2;var f=nw(),x=rw();kt!==i||it!==o?(wd=null,vd=Dt()+500,Oo(i,o)):Ao=me(i,o);e:do try{if(mt!==0&&et!==null){o=et;var y=hr;t:switch(mt){case 1:mt=0,hr=null,_o(i,o,y,1);break;case 2:case 9:if(p1(y)){mt=0,hr=null,iw(o);break}o=function(){mt!==2&&mt!==9||kt!==i||(mt=7),rs(i)},y.then(o,o);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:p1(y)?(mt=0,hr=null,iw(o)):(mt=0,hr=null,_o(i,o,y,7));break;case 5:var S=null;switch(et.tag){case 26:S=et.memoizedState;case 5:case 27:var T=et;if(S?Vw(S):T.stateNode.complete){mt=0,hr=null;var D=T.sibling;if(D!==null)et=D;else{var X=T.return;X!==null?(et=X,Sd(X)):et=null}break t}}mt=0,hr=null,_o(i,o,y,5);break;case 6:mt=0,hr=null,_o(i,o,y,6);break;case 8:Qm(),Ut=6;break e;default:throw Error(r(462))}}Rj();break}catch(le){ew(i,le)}while(!0);return ks=ga=null,U.H=f,U.A=x,dt=u,et!==null?0:(kt=null,it=0,$u(),Ut)}function Rj(){for(;et!==null&&!on();)sw(et)}function sw(i){var o=Av(i.alternate,i,_s);i.memoizedProps=i.pendingProps,o===null?Sd(i):et=o}function iw(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=kv(u,o,o.pendingProps,o.type,void 0,it);break;case 11:o=kv(u,o,o.pendingProps,o.type.render,o.ref,it);break;case 5:pm(o);default:jv(u,o),o=et=r1(o,_s),o=Av(u,o,_s)}i.memoizedProps=i.pendingProps,o===null?Sd(i):et=o}function _o(i,o,u,f){ks=ga=null,pm(o),wo=null,Vl=0;var x=o.return;try{if(wj(i,x,o,u,it)){Ut=1,dd(i,kr(u,i.current)),et=null;return}}catch(y){if(x!==null)throw et=x,y;Ut=1,dd(i,kr(u,i.current)),et=null;return}o.flags&32768?(ot||f===1?i=!0:Ao||(it&536870912)!==0?i=!1:(xi=i=!0,(f===2||f===9||f===3||f===6)&&(f=dr.current,f!==null&&f.tag===13&&(f.flags|=16384))),aw(o,i)):Sd(o)}function Sd(i){var o=i;do{if((o.flags&32768)!==0){aw(o,xi);return}i=o.return;var u=Sj(o.alternate,o,_s);if(u!==null){et=u;return}if(o=o.sibling,o!==null){et=o;return}et=o=i}while(o!==null);Ut===0&&(Ut=5)}function aw(i,o){do{var u=Ej(i.alternate,i);if(u!==null){u.flags&=32767,et=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){et=i;return}et=i=u}while(i!==null);Ut=6,et=null}function ow(i,o,u,f,x,y,S,T,D){i.cancelPendingCommit=null;do Ed();while(un!==0);if((dt&6)!==0)throw Error(r(327));if(o!==null){if(o===i.current)throw Error(r(177));if(y=o.lanes|o.childLanes,y|=Fp,Ae(i,u,y,S,T,D),i===kt&&(et=kt=null,it=0),jo=o,vi=i,Rs=u,Ym=y,Jm=x,Jv=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,zj(hn,function(){return fw(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=U.T,U.T=null,x=Z.p,Z.p=2,S=dt,dt|=4;try{Nj(i,o,u)}finally{dt=S,Z.p=x,U.T=f}}un=1,lw(),cw(),uw()}}function lw(){if(un===1){un=0;var i=vi,o=jo,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=U.T,U.T=null;var f=Z.p;Z.p=2;var x=dt;dt|=4;try{Uv(o,i);var y=dg,S=Ky(i.containerInfo),T=y.focusedElem,D=y.selectionRange;if(S!==T&&T&&T.ownerDocument&&Gy(T.ownerDocument.documentElement,T)){if(D!==null&&Ip(T)){var X=D.start,le=D.end;if(le===void 0&&(le=X),"selectionStart"in T)T.selectionStart=X,T.selectionEnd=Math.min(le,T.value.length);else{var de=T.ownerDocument||document,ee=de&&de.defaultView||window;if(ee.getSelection){var se=ee.getSelection(),je=T.textContent.length,Fe=Math.min(D.start,je),yt=D.end===void 0?Fe:Math.min(D.end,je);!se.extend&&Fe>yt&&(S=yt,yt=Fe,Fe=S);var V=Wy(T,Fe),B=Wy(T,yt);if(V&&B&&(se.rangeCount!==1||se.anchorNode!==V.node||se.anchorOffset!==V.offset||se.focusNode!==B.node||se.focusOffset!==B.offset)){var J=de.createRange();J.setStart(V.node,V.offset),se.removeAllRanges(),Fe>yt?(se.addRange(J),se.extend(B.node,B.offset)):(J.setEnd(B.node,B.offset),se.addRange(J))}}}}for(de=[],se=T;se=se.parentNode;)se.nodeType===1&&de.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<de.length;T++){var ce=de[T];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}zd=!!ug,dg=ug=null}finally{dt=x,Z.p=f,U.T=u}}i.current=o,un=2}}function cw(){if(un===2){un=0;var i=vi,o=jo,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=U.T,U.T=null;var f=Z.p;Z.p=2;var x=dt;dt|=4;try{zv(i,o.alternate,o)}finally{dt=x,Z.p=f,U.T=u}}un=3}}function uw(){if(un===4||un===3){un=0,Gn();var i=vi,o=jo,u=Rs,f=Jv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?un=5:(un=0,jo=vi=null,dw(i,i.pendingLanes));var x=i.pendingLanes;if(x===0&&(yi=null),It(u),o=o.stateNode,Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(pn,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=U.T,x=Z.p,Z.p=2,U.T=null;try{for(var y=i.onRecoverableError,S=0;S<f.length;S++){var T=f[S];y(T.value,{componentStack:T.stack})}}finally{U.T=o,Z.p=x}}(Rs&3)!==0&&Ed(),rs(i),x=i.pendingLanes,(u&261930)!==0&&(x&42)!==0?i===Xm?oc++:(oc=0,Xm=i):oc=0,lc(0)}}function dw(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Ul(o)))}function Ed(){return lw(),cw(),uw(),fw()}function fw(){if(un!==5)return!1;var i=vi,o=Ym;Ym=0;var u=It(Rs),f=U.T,x=Z.p;try{Z.p=32>u?32:u,U.T=null,u=Jm,Jm=null;var y=vi,S=Rs;if(un=0,jo=vi=null,Rs=0,(dt&6)!==0)throw Error(r(331));var T=dt;if(dt|=4,Gv(y.current),Vv(y,y.current,S,u),dt=T,lc(0,!1),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(pn,y)}catch{}return!0}finally{Z.p=x,U.T=f,dw(i,o)}}function hw(i,o,u){o=kr(u,o),o=Mm(i.stateNode,o,2),i=hi(i,o,2),i!==null&&(He(i,2),rs(i))}function gt(i,o,u){if(i.tag===3)hw(i,i,u);else for(;o!==null;){if(o.tag===3){hw(o,i,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(yi===null||!yi.has(f))){i=kr(u,i),u=pv(2),f=hi(o,u,2),f!==null&&(mv(u,f,o,i),He(f,2),rs(f));break}}o=o.return}}function eg(i,o,u){var f=i.pingCache;if(f===null){f=i.pingCache=new Mj;var x=new Set;f.set(o,x)}else x=f.get(o),x===void 0&&(x=new Set,f.set(o,x));x.has(u)||(Wm=!0,x.add(u),i=Dj.bind(null,i,o,u),o.then(i,i))}function Dj(i,o,u){var f=i.pingCache;f!==null&&f.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,kt===i&&(it&u)===u&&(Ut===4||Ut===3&&(it&62914560)===it&&300>Dt()-yd?(dt&2)===0&&Oo(i,0):Gm|=u,Mo===it&&(Mo=0)),rs(i)}function pw(i,o){o===0&&(o=Ce()),i=ha(i,o),i!==null&&(He(i,o),rs(i))}function Lj(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),pw(i,u)}function Ij(i,o){var u=0;switch(i.tag){case 31:case 13:var f=i.stateNode,x=i.memoizedState;x!==null&&(u=x.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(o),pw(i,u)}function zj(i,o){return _e(i,o)}var Nd=null,Ro=null,tg=!1,Td=!1,ng=!1,ki=0;function rs(i){i!==Ro&&i.next===null&&(Ro===null?Nd=Ro=i:Ro=Ro.next=i),Td=!0,tg||(tg=!0,Pj())}function lc(i,o){if(!ng&&Td){ng=!0;do for(var u=!1,f=Nd;f!==null;){if(i!==0){var x=f.pendingLanes;if(x===0)var y=0;else{var S=f.suspendedLanes,T=f.pingedLanes;y=(1<<31-Gt(42|i)+1)-1,y&=x&~(S&~T),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(u=!0,bw(f,y))}else y=it,y=ue(f,f===kt?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||me(f,y)||(u=!0,bw(f,y));f=f.next}while(u);ng=!1}}function Bj(){mw()}function mw(){Td=tg=!1;var i=0;ki!==0&&Yj()&&(i=ki);for(var o=Dt(),u=null,f=Nd;f!==null;){var x=f.next,y=gw(f,o);y===0?(f.next=null,u===null?Nd=x:u.next=x,x===null&&(Ro=u)):(u=f,(i!==0||(y&3)!==0)&&(Td=!0)),f=x}un!==0&&un!==5||lc(i),ki!==0&&(ki=0)}function gw(i,o){for(var u=i.suspendedLanes,f=i.pingedLanes,x=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var S=31-Gt(y),T=1<<S,D=x[S];D===-1?((T&u)===0||(T&f)!==0)&&(x[S]=ke(T,o)):D<=o&&(i.expiredLanes|=T),y&=~T}if(o=kt,u=it,u=ue(i,i===o?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,u===0||i===o&&(mt===2||mt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&an(f),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||me(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(f!==null&&an(f),It(u)){case 2:case 8:u=Kn;break;case 32:u=hn;break;case 268435456:u=Jr;break;default:u=hn}return f=xw.bind(null,i),u=_e(u,f),i.callbackPriority=o,i.callbackNode=u,o}return f!==null&&f!==null&&an(f),i.callbackPriority=2,i.callbackNode=null,2}function xw(i,o){if(un!==0&&un!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Ed()&&i.callbackNode!==u)return null;var f=it;return f=ue(i,i===kt?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(Qv(i,f,o),gw(i,Dt()),i.callbackNode!=null&&i.callbackNode===u?xw.bind(null,i):null)}function bw(i,o){if(Ed())return null;Qv(i,o,!0)}function Pj(){Xj(function(){(dt&6)!==0?_e(Yr,Bj):mw()})}function rg(){if(ki===0){var i=bo;i===0&&(i=Jn,Jn<<=1,(Jn&261888)===0&&(Jn=256)),ki=i}return ki}function yw(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Lu(""+i)}function vw(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function Hj(i,o,u,f,x){if(o==="submit"&&u&&u.stateNode===x){var y=yw((x[mn]||null).action),S=f.submitter;S&&(o=(o=S[mn]||null)?yw(o.formAction):S.getAttribute("formAction"),o!==null&&(y=o,S=null));var T=new Pu("action","action",null,f,x);i.push({event:T,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ki!==0){var D=S?vw(x,S):new FormData(x);Cm(u,{pending:!0,data:D,method:x.method,action:y},null,D)}}else typeof y=="function"&&(T.preventDefault(),D=S?vw(x,S):new FormData(x),Cm(u,{pending:!0,data:D,method:x.method,action:y},y,D))},currentTarget:x}]})}}for(var sg=0;sg<Hp.length;sg++){var ig=Hp[sg],Fj=ig.toLowerCase(),Uj=ig[0].toUpperCase()+ig.slice(1);zr(Fj,"on"+Uj)}zr(Xy,"onAnimationEnd"),zr(Qy,"onAnimationIteration"),zr(Zy,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(sj,"onTransitionRun"),zr(ij,"onTransitionStart"),zr(aj,"onTransitionCancel"),zr(e1,"onTransitionEnd"),xs("onMouseEnter",["mouseout","mouseover"]),xs("onMouseLeave",["mouseout","mouseover"]),xs("onPointerEnter",["pointerout","pointerover"]),xs("onPointerLeave",["pointerout","pointerover"]),vr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vr("onBeforeInput",["compositionend","keypress","textInput","paste"]),vr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$j=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cc));function ww(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var f=i[u],x=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var S=f.length-1;0<=S;S--){var T=f[S],D=T.instance,X=T.currentTarget;if(T=T.listener,D!==y&&x.isPropagationStopped())break e;y=T,x.currentTarget=X;try{y(x)}catch(le){Uu(le)}x.currentTarget=null,y=D}else for(S=0;S<f.length;S++){if(T=f[S],D=T.instance,X=T.currentTarget,T=T.listener,D!==y&&x.isPropagationStopped())break e;y=T,x.currentTarget=X;try{y(x)}catch(le){Uu(le)}x.currentTarget=null,y=D}}}}function tt(i,o){var u=o[Sl];u===void 0&&(u=o[Sl]=new Set);var f=i+"__bubble";u.has(f)||(kw(o,i,2,!1),u.add(f))}function ag(i,o,u){var f=0;o&&(f|=4),kw(u,i,f,o)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function og(i){if(!i[Ad]){i[Ad]=!0,Fn.forEach(function(u){u!=="selectionchange"&&($j.has(u)||ag(u,!1,i),ag(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Ad]||(o[Ad]=!0,ag("selectionchange",!1,o))}}function kw(i,o,u,f){switch(Xw(o)){case 2:var x=xO;break;case 8:x=bO;break;default:x=kg}u=x.bind(null,o,u,i),x=void 0,!Tp||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),f?x!==void 0?i.addEventListener(o,u,{capture:!0,passive:x}):i.addEventListener(o,u,!0):x!==void 0?i.addEventListener(o,u,{passive:x}):i.addEventListener(o,u,!1)}function lg(i,o,u,f,x){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var T=f.stateNode.containerInfo;if(T===x)break;if(S===4)for(S=f.return;S!==null;){var D=S.tag;if((D===3||D===4)&&S.stateNode.containerInfo===x)return;S=S.return}for(;T!==null;){if(S=ri(T),S===null)return;if(D=S.tag,D===5||D===6||D===26||D===27){f=y=S;continue e}T=T.parentNode}}f=f.return}Ty(function(){var X=y,le=Ep(u),de=[];e:{var ee=t1.get(i);if(ee!==void 0){var se=Pu,je=i;switch(i){case"keypress":if(zu(u)===0)break e;case"keydown":case"keyup":se=IM;break;case"focusin":je="focus",se=Op;break;case"focusout":je="blur",se=Op;break;case"beforeblur":case"afterblur":se=Op;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=jy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=SM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=PM;break;case Xy:case Qy:case Zy:se=TM;break;case e1:se=FM;break;case"scroll":case"scrollend":se=kM;break;case"wheel":se=$M;break;case"copy":case"cut":case"paste":se=MM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=_y;break;case"toggle":case"beforetoggle":se=qM}var Fe=(o&4)!==0,yt=!Fe&&(i==="scroll"||i==="scrollend"),V=Fe?ee!==null?ee+"Capture":null:ee;Fe=[];for(var B=X,J;B!==null;){var ce=B;if(J=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||J===null||V===null||(ce=Ol(B,V),ce!=null&&Fe.push(uc(B,ce,J))),yt)break;B=B.return}0<Fe.length&&(ee=new se(ee,je,null,u,le),de.push({event:ee,listeners:Fe}))}}if((o&7)===0){e:{if(ee=i==="mouseover"||i==="pointerover",se=i==="mouseout"||i==="pointerout",ee&&u!==Sp&&(je=u.relatedTarget||u.fromElement)&&(ri(je)||je[ti]))break e;if((se||ee)&&(ee=le.window===le?le:(ee=le.ownerDocument)?ee.defaultView||ee.parentWindow:window,se?(je=u.relatedTarget||u.toElement,se=X,je=je?ri(je):null,je!==null&&(yt=a(je),Fe=je.tag,je!==yt||Fe!==5&&Fe!==27&&Fe!==6)&&(je=null)):(se=null,je=X),se!==je)){if(Fe=jy,ce="onMouseLeave",V="onMouseEnter",B="mouse",(i==="pointerout"||i==="pointerover")&&(Fe=_y,ce="onPointerLeave",V="onPointerEnter",B="pointer"),yt=se==null?ee:la(se),J=je==null?ee:la(je),ee=new Fe(ce,B+"leave",se,u,le),ee.target=yt,ee.relatedTarget=J,ce=null,ri(le)===X&&(Fe=new Fe(V,B+"enter",je,u,le),Fe.target=J,Fe.relatedTarget=yt,ce=Fe),yt=ce,se&&je)t:{for(Fe=Vj,V=se,B=je,J=0,ce=V;ce;ce=Fe(ce))J++;ce=0;for(var Ie=B;Ie;Ie=Fe(Ie))ce++;for(;0<J-ce;)V=Fe(V),J--;for(;0<ce-J;)B=Fe(B),ce--;for(;J--;){if(V===B||B!==null&&V===B.alternate){Fe=V;break t}V=Fe(V),B=Fe(B)}Fe=null}else Fe=null;se!==null&&Cw(de,ee,se,Fe,!1),je!==null&&yt!==null&&Cw(de,yt,je,Fe,!0)}}e:{if(ee=X?la(X):window,se=ee.nodeName&&ee.nodeName.toLowerCase(),se==="select"||se==="input"&&ee.type==="file")var ct=Hy;else if(By(ee))if(Fy)ct=tj;else{ct=ZM;var Re=QM}else se=ee.nodeName,!se||se.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?X&&Cp(X.elementType)&&(ct=Hy):ct=ej;if(ct&&(ct=ct(i,X))){Py(de,ct,u,le);break e}Re&&Re(i,ee,X),i==="focusout"&&X&&ee.type==="number"&&X.memoizedProps.value!=null&&ca(ee,"number",ee.value)}switch(Re=X?la(X):window,i){case"focusin":(By(Re)||Re.contentEditable==="true")&&(co=Re,zp=X,Pl=null);break;case"focusout":Pl=zp=co=null;break;case"mousedown":Bp=!0;break;case"contextmenu":case"mouseup":case"dragend":Bp=!1,Yy(de,u,le);break;case"selectionchange":if(rj)break;case"keydown":case"keyup":Yy(de,u,le)}var Je;if(Rp)e:{switch(i){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else lo?Iy(i,u)&&(at="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(at="onCompositionStart");at&&(Ry&&u.locale!=="ko"&&(lo||at!=="onCompositionStart"?at==="onCompositionEnd"&&lo&&(Je=Ay()):(ai=le,Ap="value"in ai?ai.value:ai.textContent,lo=!0)),Re=Md(X,at),0<Re.length&&(at=new Oy(at,i,null,u,le),de.push({event:at,listeners:Re}),Je?at.data=Je:(Je=zy(u),Je!==null&&(at.data=Je)))),(Je=GM?KM(i,u):YM(i,u))&&(at=Md(X,"onBeforeInput"),0<at.length&&(Re=new Oy("onBeforeInput","beforeinput",null,u,le),de.push({event:Re,listeners:at}),Re.data=Je)),Hj(de,i,X,u,le)}ww(de,o)})}function uc(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Md(i,o){for(var u=o+"Capture",f=[];i!==null;){var x=i,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=Ol(i,u),x!=null&&f.unshift(uc(i,x,y)),x=Ol(i,o),x!=null&&f.push(uc(i,x,y))),i.tag===3)return f;i=i.return}return[]}function Vj(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Cw(i,o,u,f,x){for(var y=o._reactName,S=[];u!==null&&u!==f;){var T=u,D=T.alternate,X=T.stateNode;if(T=T.tag,D!==null&&D===f)break;T!==5&&T!==26&&T!==27||X===null||(D=X,x?(X=Ol(u,y),X!=null&&S.unshift(uc(u,X,D))):x||(X=Ol(u,y),X!=null&&S.push(uc(u,X,D)))),u=u.return}S.length!==0&&i.push({event:o,listeners:S})}var qj=/\r\n?/g,Wj=/\u0000|\uFFFD/g;function Sw(i){return(typeof i=="string"?i:""+i).replace(qj,`
`).replace(Wj,"")}function Ew(i,o){return o=Sw(o),Sw(i)===o}function bt(i,o,u,f,x,y){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||io(i,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&io(i,""+f);break;case"className":ro(i,"class",f);break;case"tabIndex":ro(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ro(i,u,f);break;case"style":Ey(i,f,y);break;case"data":if(o!=="object"){ro(i,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=Lu(""+f),i.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(u==="formAction"?(o!=="input"&&bt(i,o,"name",x.name,x,null),bt(i,o,"formEncType",x.formEncType,x,null),bt(i,o,"formMethod",x.formMethod,x,null),bt(i,o,"formTarget",x.formTarget,x,null)):(bt(i,o,"encType",x.encType,x,null),bt(i,o,"method",x.method,x,null),bt(i,o,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=Lu(""+f),i.setAttribute(u,f);break;case"onClick":f!=null&&(i.onclick=bs);break;case"onScroll":f!=null&&tt("scroll",i);break;case"onScrollEnd":f!=null&&tt("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}u=Lu(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""+f):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":f===!0?i.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,f):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(u,f):i.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(u):i.setAttribute(u,f);break;case"popover":tt("beforetoggle",i),tt("toggle",i),jl(i,"popover",f);break;case"xlinkActuate":Y(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Y(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Y(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Y(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Y(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Y(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Y(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Y(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Y(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":jl(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=vM.get(u)||u,jl(i,u,f))}}function cg(i,o,u,f,x,y){switch(u){case"style":Ey(i,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(x.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof f=="string"?io(i,f):(typeof f=="number"||typeof f=="bigint")&&io(i,""+f);break;case"onScroll":f!=null&&tt("scroll",i);break;case"onScrollEnd":f!=null&&tt("scrollend",i);break;case"onClick":f!=null&&(i.onclick=bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Du.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),y=i[mn]||null,y=y!=null?y[u]:null,typeof y=="function"&&i.removeEventListener(o,y,x),typeof f=="function")){typeof y!="function"&&y!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,f,x);break e}u in i?i[u]=f:f===!0?i.setAttribute(u,""):jl(i,u,f)}}}function Tn(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tt("error",i),tt("load",i);var f=!1,x=!1,y;for(y in u)if(u.hasOwnProperty(y)){var S=u[y];if(S!=null)switch(y){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:bt(i,o,y,S,u,null)}}x&&bt(i,o,"srcSet",u.srcSet,u,null),f&&bt(i,o,"src",u.src,u,null);return;case"input":tt("invalid",i);var T=y=S=x=null,D=null,X=null;for(f in u)if(u.hasOwnProperty(f)){var le=u[f];if(le!=null)switch(f){case"name":x=le;break;case"type":S=le;break;case"checked":D=le;break;case"defaultChecked":X=le;break;case"value":y=le;break;case"defaultValue":T=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(137,o));break;default:bt(i,o,f,le,u,null)}}Zr(i,y,T,D,X,S,x,!1);return;case"select":tt("invalid",i),f=S=y=null;for(x in u)if(u.hasOwnProperty(x)&&(T=u[x],T!=null))switch(x){case"value":y=T;break;case"defaultValue":S=T;break;case"multiple":f=T;default:bt(i,o,x,T,u,null)}o=y,u=S,i.multiple=!!f,o!=null?so(i,!!f,o,!1):u!=null&&so(i,!!f,u,!0);return;case"textarea":tt("invalid",i),y=x=f=null;for(S in u)if(u.hasOwnProperty(S)&&(T=u[S],T!=null))switch(S){case"value":f=T;break;case"defaultValue":x=T;break;case"children":y=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:bt(i,o,S,T,u,null)}Cy(i,f,x,y);return;case"option":for(D in u)if(u.hasOwnProperty(D)&&(f=u[D],f!=null))switch(D){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:bt(i,o,D,f,u,null)}return;case"dialog":tt("beforetoggle",i),tt("toggle",i),tt("cancel",i),tt("close",i);break;case"iframe":case"object":tt("load",i);break;case"video":case"audio":for(f=0;f<cc.length;f++)tt(cc[f],i);break;case"image":tt("error",i),tt("load",i);break;case"details":tt("toggle",i);break;case"embed":case"source":case"link":tt("error",i),tt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in u)if(u.hasOwnProperty(X)&&(f=u[X],f!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:bt(i,o,X,f,u,null)}return;default:if(Cp(o)){for(le in u)u.hasOwnProperty(le)&&(f=u[le],f!==void 0&&cg(i,o,le,f,u,void 0));return}}for(T in u)u.hasOwnProperty(T)&&(f=u[T],f!=null&&bt(i,o,T,f,u,null))}function Gj(i,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,S=null,T=null,D=null,X=null,le=null;for(se in u){var de=u[se];if(u.hasOwnProperty(se)&&de!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":D=de;default:f.hasOwnProperty(se)||bt(i,o,se,null,f,de)}}for(var ee in f){var se=f[ee];if(de=u[ee],f.hasOwnProperty(ee)&&(se!=null||de!=null))switch(ee){case"type":y=se;break;case"name":x=se;break;case"checked":X=se;break;case"defaultChecked":le=se;break;case"value":S=se;break;case"defaultValue":T=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,o));break;default:se!==de&&bt(i,o,ee,se,f,de)}}lr(i,S,T,D,X,le,y,x);return;case"select":se=S=T=ee=null;for(y in u)if(D=u[y],u.hasOwnProperty(y)&&D!=null)switch(y){case"value":break;case"multiple":se=D;default:f.hasOwnProperty(y)||bt(i,o,y,null,f,D)}for(x in f)if(y=f[x],D=u[x],f.hasOwnProperty(x)&&(y!=null||D!=null))switch(x){case"value":ee=y;break;case"defaultValue":T=y;break;case"multiple":S=y;default:y!==D&&bt(i,o,x,y,f,D)}o=T,u=S,f=se,ee!=null?so(i,!!u,ee,!1):!!f!=!!u&&(o!=null?so(i,!!u,o,!0):so(i,!!u,u?[]:"",!1));return;case"textarea":se=ee=null;for(T in u)if(x=u[T],u.hasOwnProperty(T)&&x!=null&&!f.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:bt(i,o,T,null,f,x)}for(S in f)if(x=f[S],y=u[S],f.hasOwnProperty(S)&&(x!=null||y!=null))switch(S){case"value":ee=x;break;case"defaultValue":se=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==y&&bt(i,o,S,x,f,y)}ky(i,ee,se);return;case"option":for(var je in u)if(ee=u[je],u.hasOwnProperty(je)&&ee!=null&&!f.hasOwnProperty(je))switch(je){case"selected":i.selected=!1;break;default:bt(i,o,je,null,f,ee)}for(D in f)if(ee=f[D],se=u[D],f.hasOwnProperty(D)&&ee!==se&&(ee!=null||se!=null))switch(D){case"selected":i.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:bt(i,o,D,ee,f,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in u)ee=u[Fe],u.hasOwnProperty(Fe)&&ee!=null&&!f.hasOwnProperty(Fe)&&bt(i,o,Fe,null,f,ee);for(X in f)if(ee=f[X],se=u[X],f.hasOwnProperty(X)&&ee!==se&&(ee!=null||se!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,o));break;default:bt(i,o,X,ee,f,se)}return;default:if(Cp(o)){for(var yt in u)ee=u[yt],u.hasOwnProperty(yt)&&ee!==void 0&&!f.hasOwnProperty(yt)&&cg(i,o,yt,void 0,f,ee);for(le in f)ee=f[le],se=u[le],!f.hasOwnProperty(le)||ee===se||ee===void 0&&se===void 0||cg(i,o,le,ee,f,se);return}}for(var V in u)ee=u[V],u.hasOwnProperty(V)&&ee!=null&&!f.hasOwnProperty(V)&&bt(i,o,V,null,f,ee);for(de in f)ee=f[de],se=u[de],!f.hasOwnProperty(de)||ee===se||ee==null&&se==null||bt(i,o,de,ee,f,se)}function Nw(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kj(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var x=u[f],y=x.transferSize,S=x.initiatorType,T=x.duration;if(y&&T&&Nw(S)){for(S=0,T=x.responseEnd,f+=1;f<u.length;f++){var D=u[f],X=D.startTime;if(X>T)break;var le=D.transferSize,de=D.initiatorType;le&&Nw(de)&&(D=D.responseEnd,S+=le*(D<T?1:(T-X)/(D-X)))}if(--f,o+=8*(y+S)/(x.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var ug=null,dg=null;function jd(i){return i.nodeType===9?i:i.ownerDocument}function Tw(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Aw(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function fg(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var hg=null;function Yj(){var i=window.event;return i&&i.type==="popstate"?i===hg?!1:(hg=i,!0):(hg=null,!1)}var Mw=typeof setTimeout=="function"?setTimeout:void 0,Jj=typeof clearTimeout=="function"?clearTimeout:void 0,jw=typeof Promise=="function"?Promise:void 0,Xj=typeof queueMicrotask=="function"?queueMicrotask:typeof jw<"u"?function(i){return jw.resolve(null).then(i).catch(Qj)}:Mw;function Qj(i){setTimeout(function(){throw i})}function Ci(i){return i==="head"}function Ow(i,o){var u=o,f=0;do{var x=u.nextSibling;if(i.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(f===0){i.removeChild(x),zo(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")dc(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,dc(u);for(var y=u.firstChild;y;){var S=y.nextSibling,T=y.nodeName;y[ni]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||u.removeChild(y),y=S}}else u==="body"&&dc(i.ownerDocument.body);u=x}while(u);zo(o)}function _w(i,o){var u=i;i=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=f}while(u)}function pg(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":pg(u),Nl(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function Zj(i,o,u,f){for(;i.nodeType===1;){var x=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[ni])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==x.rel||i.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||i.getAttribute("title")!==(x.title==null?null:x.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(x.src==null?null:x.src)||i.getAttribute("type")!==(x.type==null?null:x.type)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Tr(i.nextSibling),i===null)break}return null}function eO(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Tr(i.nextSibling),i===null))return null;return i}function Rw(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Tr(i.nextSibling),i===null))return null;return i}function mg(i){return i.data==="$?"||i.data==="$~"}function gg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function tO(i,o){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function Tr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var xg=null;function Dw(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(o===0)return Tr(i.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}i=i.nextSibling}return null}function Lw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return i;o--}else u!=="/$"&&u!=="/&"||o++}i=i.previousSibling}return null}function Iw(i,o,u){switch(o=jd(u),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function dc(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);Nl(i)}var Ar=new Map,zw=new Set;function Od(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ds=Z.d;Z.d={f:nO,r:rO,D:sO,C:iO,L:aO,m:oO,X:cO,S:lO,M:uO};function nO(){var i=Ds.f(),o=kd();return i||o}function rO(i){var o=si(i);o!==null&&o.tag===5&&o.type==="form"?ev(o):Ds.r(i)}var Do=typeof document>"u"?null:document;function Bw(i,o,u){var f=Do;if(f&&typeof o=="string"&&o){var x=Bt(o);x='link[rel="'+i+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),zw.has(x)||(zw.add(x),i={rel:i,crossOrigin:u,href:o},f.querySelector(x)===null&&(o=f.createElement("link"),Tn(o,"link",i),Xt(o),f.head.appendChild(o)))}}function sO(i){Ds.D(i),Bw("dns-prefetch",i,null)}function iO(i,o){Ds.C(i,o),Bw("preconnect",i,o)}function aO(i,o,u){Ds.L(i,o,u);var f=Do;if(f&&i&&o){var x='link[rel="preload"][as="'+Bt(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Bt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Bt(u.imageSizes)+'"]')):x+='[href="'+Bt(i)+'"]';var y=x;switch(o){case"style":y=Lo(i);break;case"script":y=Io(i)}Ar.has(y)||(i=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),Ar.set(y,i),f.querySelector(x)!==null||o==="style"&&f.querySelector(fc(y))||o==="script"&&f.querySelector(hc(y))||(o=f.createElement("link"),Tn(o,"link",i),Xt(o),f.head.appendChild(o)))}}function oO(i,o){Ds.m(i,o);var u=Do;if(u&&i){var f=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+Bt(f)+'"][href="'+Bt(i)+'"]',y=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Io(i)}if(!Ar.has(y)&&(i=g({rel:"modulepreload",href:i},o),Ar.set(y,i),u.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(hc(y)))return}f=u.createElement("link"),Tn(f,"link",i),Xt(f),u.head.appendChild(f)}}}function lO(i,o,u){Ds.S(i,o,u);var f=Do;if(f&&i){var x=ii(f).hoistableStyles,y=Lo(i);o=o||"default";var S=x.get(y);if(!S){var T={loading:0,preload:null};if(S=f.querySelector(fc(y)))T.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},u),(u=Ar.get(y))&&bg(i,u);var D=S=f.createElement("link");Xt(D),Tn(D,"link",i),D._p=new Promise(function(X,le){D.onload=X,D.onerror=le}),D.addEventListener("load",function(){T.loading|=1}),D.addEventListener("error",function(){T.loading|=2}),T.loading|=4,_d(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:T},x.set(y,S)}}}function cO(i,o){Ds.X(i,o);var u=Do;if(u&&i){var f=ii(u).hoistableScripts,x=Io(i),y=f.get(x);y||(y=u.querySelector(hc(x)),y||(i=g({src:i,async:!0},o),(o=Ar.get(x))&&yg(i,o),y=u.createElement("script"),Xt(y),Tn(y,"link",i),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function uO(i,o){Ds.M(i,o);var u=Do;if(u&&i){var f=ii(u).hoistableScripts,x=Io(i),y=f.get(x);y||(y=u.querySelector(hc(x)),y||(i=g({src:i,async:!0,type:"module"},o),(o=Ar.get(x))&&yg(i,o),y=u.createElement("script"),Xt(y),Tn(y,"link",i),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function Pw(i,o,u,f){var x=(x=L.current)?Od(x):null;if(!x)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Lo(u.href),u=ii(x).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Lo(u.href);var y=ii(x).hoistableStyles,S=y.get(i);if(S||(x=x.ownerDocument||x,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,S),(y=x.querySelector(fc(i)))&&!y._p&&(S.instance=y,S.state.loading=5),Ar.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ar.set(i,u),y||dO(x,i,u,S.state))),o&&f===null)throw Error(r(528,""));return S}if(o&&f!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Io(u),u=ii(x).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Lo(i){return'href="'+Bt(i)+'"'}function fc(i){return'link[rel="stylesheet"]['+i+"]"}function Hw(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function dO(i,o,u,f){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=i.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),Tn(o,"link",u),Xt(o),i.head.appendChild(o))}function Io(i){return'[src="'+Bt(i)+'"]'}function hc(i){return"script[async]"+i}function Fw(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=i.querySelector('style[data-href~="'+Bt(u.href)+'"]');if(f)return o.instance=f,Xt(f),f;var x=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),Xt(f),Tn(f,"style",x),_d(f,u.precedence,i),o.instance=f;case"stylesheet":x=Lo(u.href);var y=i.querySelector(fc(x));if(y)return o.state.loading|=4,o.instance=y,Xt(y),y;f=Hw(u),(x=Ar.get(x))&&bg(f,x),y=(i.ownerDocument||i).createElement("link"),Xt(y);var S=y;return S._p=new Promise(function(T,D){S.onload=T,S.onerror=D}),Tn(y,"link",f),o.state.loading|=4,_d(y,u.precedence,i),o.instance=y;case"script":return y=Io(u.src),(x=i.querySelector(hc(y)))?(o.instance=x,Xt(x),x):(f=u,(x=Ar.get(y))&&(f=g({},u),yg(f,x)),i=i.ownerDocument||i,x=i.createElement("script"),Xt(x),Tn(x,"link",f),i.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,_d(f,u.precedence,i));return o.instance}function _d(i,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,y=x,S=0;S<f.length;S++){var T=f[S];if(T.dataset.precedence===o)y=T;else if(y!==x)break}y?y.parentNode.insertBefore(i,y.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function bg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function yg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Rd=null;function Uw(i,o,u){if(Rd===null){var f=new Map,x=Rd=new Map;x.set(u,f)}else x=Rd,f=x.get(u),f||(f=new Map,x.set(u,f));if(f.has(i))return f;for(f.set(i,null),u=u.getElementsByTagName(i),x=0;x<u.length;x++){var y=u[x];if(!(y[ni]||y[cn]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(o)||"";S=i+S;var T=f.get(S);T?T.push(y):f.set(S,[y])}}return f}function $w(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function fO(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Vw(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function hO(i,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=Lo(f.href),y=o.querySelector(fc(x));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=Dd.bind(i),o.then(i,i)),u.state.loading|=4,u.instance=y,Xt(y);return}y=o.ownerDocument||o,f=Hw(f),(x=Ar.get(x))&&bg(f,x),y=y.createElement("link"),Xt(y);var S=y;S._p=new Promise(function(T,D){S.onload=T,S.onerror=D}),Tn(y,"link",f),u.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=Dd.bind(i),o.addEventListener("load",u),o.addEventListener("error",u))}}var vg=0;function pO(i,o){return i.stylesheets&&i.count===0&&Id(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var f=setTimeout(function(){if(i.stylesheets&&Id(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+o);0<i.imgBytes&&vg===0&&(vg=62500*Kj());var x=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Id(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>vg?50:800)+o);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function Dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Id(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ld=null;function Id(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ld=new Map,o.forEach(mO,i),Ld=null,Dd.call(i))}function mO(i,o){if(!(o.state.loading&4)){var u=Ld.get(i);if(u)var f=u.get(null);else{u=new Map,Ld.set(i,u);for(var x=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var S=x[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),f=S)}f&&u.set(null,f)}x=o.instance,S=x.getAttribute("data-precedence"),y=u.get(S)||f,y===f&&u.set(null,x),u.set(S,x),this.count++,f=Dd.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),y?y.parentNode.insertBefore(x,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(x,i.firstChild)),o.state.loading|=4}}var pc={$$typeof:_,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function gO(i,o,u,f,x,y,S,T,D){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.hiddenUpdates=ye(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function qw(i,o,u,f,x,y,S,T,D,X,le,de){return i=new gO(i,o,u,S,D,X,le,de,T),o=1,y===!0&&(o|=24),y=ur(3,null,null,o),i.current=y,y.stateNode=i,o=Zp(),o.refCount++,i.pooledCache=o,o.refCount++,y.memoizedState={element:f,isDehydrated:u,cache:o},rm(y),i}function Ww(i){return i?(i=ho,i):ho}function Gw(i,o,u,f,x,y){x=Ww(x),f.context===null?f.context=x:f.pendingContext=x,f=fi(o),f.payload={element:u},y=y===void 0?null:y,y!==null&&(f.callback=y),u=hi(i,f,o),u!==null&&(nr(u,i,o),Wl(u,i,o))}function Kw(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function wg(i,o){Kw(i,o),(i=i.alternate)&&Kw(i,o)}function Yw(i){if(i.tag===13||i.tag===31){var o=ha(i,67108864);o!==null&&nr(o,i,67108864),wg(i,67108864)}}function Jw(i){if(i.tag===13||i.tag===31){var o=mr();o=ft(o);var u=ha(i,o);u!==null&&nr(u,i,o),wg(i,o)}}var zd=!0;function xO(i,o,u,f){var x=U.T;U.T=null;var y=Z.p;try{Z.p=2,kg(i,o,u,f)}finally{Z.p=y,U.T=x}}function bO(i,o,u,f){var x=U.T;U.T=null;var y=Z.p;try{Z.p=8,kg(i,o,u,f)}finally{Z.p=y,U.T=x}}function kg(i,o,u,f){if(zd){var x=Cg(f);if(x===null)lg(i,o,f,Bd,u),Qw(i,f);else if(vO(x,i,o,u,f))f.stopPropagation();else if(Qw(i,f),o&4&&-1<yO.indexOf(i)){for(;x!==null;){var y=si(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=re(y.pendingLanes);if(S!==0){var T=y;for(T.pendingLanes|=2,T.entangledLanes|=2;S;){var D=1<<31-Gt(S);T.entanglements[1]|=D,S&=~D}rs(y),(dt&6)===0&&(vd=Dt()+500,lc(0))}}break;case 31:case 13:T=ha(y,2),T!==null&&nr(T,y,2),kd(),wg(y,2)}if(y=Cg(f),y===null&&lg(i,o,f,Bd,u),y===x)break;x=y}x!==null&&f.stopPropagation()}else lg(i,o,f,null,u)}}function Cg(i){return i=Ep(i),Sg(i)}var Bd=null;function Sg(i){if(Bd=null,i=ri(i),i!==null){var o=a(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=l(o),i!==null)return i;i=null}else if(u===31){if(i=c(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Bd=i,null}function Xw(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gs()){case Yr:return 2;case Kn:return 8;case hn:case Yn:return 32;case Jr:return 268435456;default:return 32}default:return 32}}var Eg=!1,Si=null,Ei=null,Ni=null,mc=new Map,gc=new Map,Ti=[],yO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qw(i,o){switch(i){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":Ei=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":mc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(o.pointerId)}}function xc(i,o,u,f,x,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:y,targetContainers:[x]},o!==null&&(o=si(o),o!==null&&Yw(o)),i):(i.eventSystemFlags|=f,o=i.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),i)}function vO(i,o,u,f,x){switch(o){case"focusin":return Si=xc(Si,i,o,u,f,x),!0;case"dragenter":return Ei=xc(Ei,i,o,u,f,x),!0;case"mouseover":return Ni=xc(Ni,i,o,u,f,x),!0;case"pointerover":var y=x.pointerId;return mc.set(y,xc(mc.get(y)||null,i,o,u,f,x)),!0;case"gotpointercapture":return y=x.pointerId,gc.set(y,xc(gc.get(y)||null,i,o,u,f,x)),!0}return!1}function Zw(i){var o=ri(i.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){i.blockedOn=o,or(i.priority,function(){Jw(u)});return}}else if(o===31){if(o=c(u),o!==null){i.blockedOn=o,or(i.priority,function(){Jw(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pd(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=Cg(i.nativeEvent);if(u===null){u=i.nativeEvent;var f=new u.constructor(u.type,u);Sp=f,u.target.dispatchEvent(f),Sp=null}else return o=si(u),o!==null&&Yw(o),i.blockedOn=u,!1;o.shift()}return!0}function e2(i,o,u){Pd(i)&&u.delete(o)}function wO(){Eg=!1,Si!==null&&Pd(Si)&&(Si=null),Ei!==null&&Pd(Ei)&&(Ei=null),Ni!==null&&Pd(Ni)&&(Ni=null),mc.forEach(e2),gc.forEach(e2)}function Hd(i,o){i.blockedOn===o&&(i.blockedOn=null,Eg||(Eg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,wO)))}var Fd=null;function t2(i){Fd!==i&&(Fd=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Fd===i&&(Fd=null);for(var o=0;o<i.length;o+=3){var u=i[o],f=i[o+1],x=i[o+2];if(typeof f!="function"){if(Sg(f||u)===null)continue;break}var y=si(u);y!==null&&(i.splice(o,3),o-=3,Cm(y,{pending:!0,data:x,method:u.method,action:f},f,x))}}))}function zo(i){function o(D){return Hd(D,i)}Si!==null&&Hd(Si,i),Ei!==null&&Hd(Ei,i),Ni!==null&&Hd(Ni,i),mc.forEach(o),gc.forEach(o);for(var u=0;u<Ti.length;u++){var f=Ti[u];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Ti.length&&(u=Ti[0],u.blockedOn===null);)Zw(u),u.blockedOn===null&&Ti.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var x=u[f],y=u[f+1],S=x[mn]||null;if(typeof y=="function")S||t2(u);else if(S){var T=null;if(y&&y.hasAttribute("formAction")){if(x=y,S=y[mn]||null)T=S.formAction;else if(Sg(x)!==null)continue}else T=S.action;typeof T=="function"?u[f+1]=T:(u.splice(f,3),f-=3),t2(u)}}}function n2(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return x=S})},focusReset:"manual",scroll:"manual"})}function o(){x!==null&&(x(),x=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),x!==null&&(x(),x=null)}}}function Ng(i){this._internalRoot=i}Ud.prototype.render=Ng.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,f=mr();Gw(u,f,i,o,null,null)},Ud.prototype.unmount=Ng.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Gw(i.current,2,null,i,null,null),kd(),o[ti]=null}};function Ud(i){this._internalRoot=i}Ud.prototype.unstable_scheduleHydration=function(i){if(i){var o=Cn();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ti.length&&o!==0&&o<Ti[u].priority;u++);Ti.splice(u,0,i),u===0&&Zw(i)}};var r2=e.version;if(r2!=="19.2.0")throw Error(r(527,r2,"19.2.0"));Z.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(o),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var kO={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$d.isDisabled&&$d.supportsFiber)try{pn=$d.inject(kO),Ht=$d}catch{}}return yc.createRoot=function(i,o){if(!s(i))throw Error(r(299));var u=!1,f="",x=uv,y=dv,S=fv;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=qw(i,1,!1,null,null,u,f,null,x,y,S,n2),i[ti]=o.current,og(i),new Ng(o)},yc.hydrateRoot=function(i,o,u){if(!s(i))throw Error(r(299));var f=!1,x="",y=uv,S=dv,T=fv,D=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(T=u.onRecoverableError),u.formState!==void 0&&(D=u.formState)),o=qw(i,1,!0,o,u??null,f,x,D,y,S,T,n2),o.context=Ww(null),u=o.current,f=mr(),f=ft(f),x=fi(f),x.callback=null,hi(u,x,f),u=f,o.current.lanes=u,He(o,u),rs(o),i[ti]=o.current,og(i),new Ud(o)},yc.version="19.2.0",yc}var h2;function OO(){if(h2)return Mg.exports;h2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Mg.exports=jO(),Mg.exports}var _O=OO();const RO=Xx(_O);/**
 * react-router v7.13.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var p2="popstate";function m2(t){return typeof t=="object"&&t!=null&&"pathname"in t&&"search"in t&&"hash"in t&&"state"in t&&"key"in t}function DO(t={}){function e(s,a){let{pathname:l="/",search:c="",hash:d=""}=xl(s.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),X0("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){let l=s.document.querySelector("base"),c="";if(l&&l.getAttribute("href")){let d=s.location.href,p=d.indexOf("#");c=p===-1?d:d.slice(0,p)}return c+"#"+(typeof a=="string"?a:Kc(a))}function r(s,a){qr(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return IO(e,n,r,t)}function fn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LO(){return Math.random().toString(36).substring(2,10)}function g2(t,e){return{usr:t.state,key:t.key,idx:e,masked:t.unstable_mask?{pathname:t.pathname,search:t.search,hash:t.hash}:void 0}}function X0(t,e,n=null,r,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?xl(e):e,state:n,key:e&&e.key||r||LO(),unstable_mask:s}}function Kc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function IO(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,c="POP",d=null,p=m();p==null&&(p=0,l.replaceState({...l.state,idx:p},""));function m(){return(l.state||{idx:null}).idx}function g(){c="POP";let k=m(),N=k==null?null:k-p;p=k,d&&d({action:c,location:C.location,delta:N})}function b(k,N){c="PUSH";let M=m2(k)?k:X0(C.location,k,N);n&&n(M,k),p=m()+1;let _=g2(M,p),P=C.createHref(M.unstable_mask||M);try{l.pushState(_,"",P)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(P)}a&&d&&d({action:c,location:C.location,delta:1})}function v(k,N){c="REPLACE";let M=m2(k)?k:X0(C.location,k,N);n&&n(M,k),p=m();let _=g2(M,p),P=C.createHref(M.unstable_mask||M);l.replaceState(_,"",P),a&&d&&d({action:c,location:C.location,delta:0})}function w(k){return zO(k)}let C={get action(){return c},get location(){return t(s,l)},listen(k){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(p2,g),d=k,()=>{s.removeEventListener(p2,g),d=null}},createHref(k){return e(s,k)},createURL:w,encodeLocation(k){let N=w(k);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:b,replace:v,go(k){return l.go(k)}};return C}function zO(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),fn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Kc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function YS(t,e,n="/"){return BO(t,e,n,!1)}function BO(t,e,n,r){let s=typeof e=="string"?xl(e):e,a=Ys(s.pathname||"/",n);if(a==null)return null;let l=JS(t);PO(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let p=JO(a);c=KO(l[d],p,r)}return c}function JS(t,e=[],n=[],r="",s=!1){let a=(l,c,d=s,p)=>{let m={relativePath:p===void 0?l.path||"":p,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(r)&&d)return;fn(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length)}let g=cs([r,m.relativePath]),b=n.concat(m);l.children&&l.children.length>0&&(fn(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),JS(l.children,e,b,g,d)),!(l.path==null&&!l.index)&&e.push({path:g,score:WO(g,l.index),routesMeta:b})};return t.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))a(l,c);else for(let p of XS(l.path))a(l,c,!0,p)}),e}function XS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=XS(r.join("/")),c=[];return c.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function PO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:GO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var HO=/^:[\w-]+$/,FO=3,UO=2,$O=1,VO=10,qO=-2,x2=t=>t==="*";function WO(t,e){let n=t.split("/"),r=n.length;return n.some(x2)&&(r+=qO),e&&(r+=UO),n.filter(s=>!x2(s)).reduce((s,a)=>s+(HO.test(a)?FO:a===""?$O:VO),r)}function GO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function KO(t,e,n=!1){let{routesMeta:r}=t,s={},a="/",l=[];for(let c=0;c<r.length;++c){let d=r[c],p=c===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=Tf({path:d.relativePath,caseSensitive:d.caseSensitive,end:p},m),b=d.route;if(!g&&p&&n&&!r[r.length-1].route.index&&(g=Tf({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!g)return null;Object.assign(s,g.params),l.push({params:s,pathname:cs([a,g.pathname]),pathnameBase:e_(cs([a,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(a=cs([a,g.pathnameBase]))}return l}function Tf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=YO(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((p,{paramName:m,isOptional:g},b)=>{if(m==="*"){let w=c[b]||"";l=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const v=c[b];return g&&!v?p[m]=void 0:p[m]=(v||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:l,pattern:t}}function YO(t,e=!1,n=!0){qr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d,p,m)=>{if(r.push({paramName:c,isOptional:d!=null}),d){let g=m.charAt(p+l.length);return g&&g!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ys(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var XO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function QO(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?xl(t):t,a;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?a=b2(n.substring(1),"/"):a=b2(n,e)):a=e,{pathname:a,search:t_(r),hash:n_(s)}}function b2(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Rg(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function QS(t){let e=ZO(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function Qx(t,e,n,r=!1){let s;typeof t=="string"?s=xl(t):(s={...t},fn(!s.pathname||!s.pathname.includes("?"),Rg("?","pathname","search",s)),fn(!s.pathname||!s.pathname.includes("#"),Rg("#","pathname","hash",s)),fn(!s.search||!s.search.includes("#"),Rg("#","search","hash",s)));let a=t===""||s.pathname==="",l=a?"/":s.pathname,c;if(l==null)c=n;else{let g=e.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;s.pathname=b.join("/")}c=g>=0?e[g]:"/"}let d=QO(s,c),p=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(p||m)&&(d.pathname+="/"),d}var cs=t=>t.join("/").replace(/\/\/+/g,"/"),e_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),t_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,n_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,r_=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function s_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function i_(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var ZS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function eE(t,e){let n=t;if(typeof n!="string"||!XO.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,s=!1;if(ZS)try{let a=new URL(window.location.href),l=n.startsWith("//")?new URL(a.protocol+n):new URL(n),c=Ys(l.pathname,e);l.origin===a.origin&&c!=null?n=c+l.search+l.hash:s=!0}catch{qr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var tE=["POST","PUT","PATCH","DELETE"];new Set(tE);var a_=["GET",...tE];new Set(a_);var bl=E.createContext(null);bl.displayName="DataRouter";var Hh=E.createContext(null);Hh.displayName="DataRouterState";var o_=E.createContext(!1),nE=E.createContext({isTransitioning:!1});nE.displayName="ViewTransition";var l_=E.createContext(new Map);l_.displayName="Fetchers";var c_=E.createContext(null);c_.displayName="Await";var Ir=E.createContext(null);Ir.displayName="Navigation";var Fh=E.createContext(null);Fh.displayName="Location";var Zs=E.createContext({outlet:null,matches:[],isDataRoute:!1});Zs.displayName="Route";var Zx=E.createContext(null);Zx.displayName="RouteError";var rE="REACT_ROUTER_ERROR",u_="REDIRECT",d_="ROUTE_ERROR_RESPONSE";function f_(t){if(t.startsWith(`${rE}:${u_}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function h_(t){if(t.startsWith(`${rE}:${d_}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new r_(e.status,e.statusText,e.data)}catch{}}function p_(t,{relative:e}={}){fn(mu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=E.useContext(Ir),{hash:s,pathname:a,search:l}=gu(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:cs([n,a])),r.createHref({pathname:c,search:l,hash:s})}function mu(){return E.useContext(Fh)!=null}function ea(){return fn(mu(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Fh).location}var sE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function iE(t){E.useContext(Ir).static||E.useLayoutEffect(t)}function m_(){let{isDataRoute:t}=E.useContext(Zs);return t?A_():g_()}function g_(){fn(mu(),"useNavigate() may be used only in the context of a <Router> component.");let t=E.useContext(bl),{basename:e,navigator:n}=E.useContext(Ir),{matches:r}=E.useContext(Zs),{pathname:s}=ea(),a=JSON.stringify(QS(r)),l=E.useRef(!1);return iE(()=>{l.current=!0}),E.useCallback((d,p={})=>{if(qr(l.current,sE),!l.current)return;if(typeof d=="number"){n.go(d);return}let m=Qx(d,JSON.parse(a),s,p.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:cs([e,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[e,n,a,s,t])}E.createContext(null);function gu(t,{relative:e}={}){let{matches:n}=E.useContext(Zs),{pathname:r}=ea(),s=JSON.stringify(QS(n));return E.useMemo(()=>Qx(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function x_(t,e,n){fn(mu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=E.useContext(Ir),{matches:s}=E.useContext(Zs),a=s[s.length-1],l=a?a.params:{},c=a?a.pathname:"/",d=a?a.pathnameBase:"/",p=a&&a.route;{let k=p&&p.path||"";oE(c,!p||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let m=ea(),g;g=m;let b=g.pathname||"/",v=b;if(d!=="/"){let k=d.replace(/^\//,"").split("/");v="/"+b.replace(/^\//,"").split("/").slice(k.length).join("/")}let w=YS(t,{pathname:v});return qr(p||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),qr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),k_(w&&w.map(k=>Object.assign({},k,{params:Object.assign({},l,k.params),pathname:cs([d,r.encodeLocation?r.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?d:cs([d,r.encodeLocation?r.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),s,n)}function b_(){let t=T_(),e=s_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:a},"ErrorBoundary")," or"," ",E.createElement("code",{style:a},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),n?E.createElement("pre",{style:s},n):null,l)}var y_=E.createElement(b_,null),aE=class extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=h_(t.digest);n&&(t=n)}let e=t!==void 0?E.createElement(Zs.Provider,{value:this.props.routeContext},E.createElement(Zx.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?E.createElement(v_,{error:t},e):e}};aE.contextType=o_;var Dg=new WeakMap;function v_({children:t,error:e}){let{basename:n}=E.useContext(Ir);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=f_(e.digest);if(r){let s=Dg.get(e);if(s)throw s;let a=eE(r.location,n);if(ZS&&!Dg.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw Dg.set(e,l),l}return E.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function w_({routeContext:t,match:e,children:n}){let r=E.useContext(bl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(Zs.Provider,{value:t},n)}function k_(t,e=[],n){let r=n==null?void 0:n.state;if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,a=r==null?void 0:r.errors;if(a!=null){let m=s.findIndex(g=>g.route.id&&(a==null?void 0:a[g.route.id])!==void 0);fn(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,m+1))}let l=!1,c=-1;if(n&&r){l=r.renderFallback;for(let m=0;m<s.length;m++){let g=s[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(c=m),g.route.id){let{loaderData:b,errors:v}=r,w=g.route.loader&&!b.hasOwnProperty(g.route.id)&&(!v||v[g.route.id]===void 0);if(g.route.lazy||w){n.isStatic&&(l=!0),c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}}let d=n==null?void 0:n.onError,p=r&&d?(m,g)=>{var b,v;d(m,{location:r.location,params:((v=(b=r.matches)==null?void 0:b[0])==null?void 0:v.params)??{},unstable_pattern:i_(r.matches),errorInfo:g})}:void 0;return s.reduceRight((m,g,b)=>{let v,w=!1,C=null,k=null;r&&(v=a&&g.route.id?a[g.route.id]:void 0,C=g.route.errorElement||y_,l&&(c<0&&b===0?(oE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,k=null):c===b&&(w=!0,k=g.route.hydrateFallbackElement||null)));let N=e.concat(s.slice(0,b+1)),M=()=>{let _;return v?_=C:w?_=k:g.route.Component?_=E.createElement(g.route.Component,null):g.route.element?_=g.route.element:_=m,E.createElement(w_,{match:g,routeContext:{outlet:m,matches:N,isDataRoute:r!=null},children:_})};return r&&(g.route.ErrorBoundary||g.route.errorElement||b===0)?E.createElement(aE,{location:r.location,revalidation:r.revalidation,component:C,error:v,children:M(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:p}):M()},null)}function eb(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function C_(t){let e=E.useContext(bl);return fn(e,eb(t)),e}function S_(t){let e=E.useContext(Hh);return fn(e,eb(t)),e}function E_(t){let e=E.useContext(Zs);return fn(e,eb(t)),e}function tb(t){let e=E_(t),n=e.matches[e.matches.length-1];return fn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function N_(){return tb("useRouteId")}function T_(){var r;let t=E.useContext(Zx),e=S_("useRouteError"),n=tb("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function A_(){let{router:t}=C_("useNavigate"),e=tb("useNavigate"),n=E.useRef(!1);return iE(()=>{n.current=!0}),E.useCallback(async(s,a={})=>{qr(n.current,sE),n.current&&(typeof s=="number"?await t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var y2={};function oE(t,e,n){!e&&!y2[t]&&(y2[t]=!0,qr(!1,n))}E.memo(M_);function M_({routes:t,future:e,state:n,isStatic:r,onError:s}){return x_(t,void 0,{state:n,isStatic:r,onError:s})}function j_({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:a=!1,unstable_useTransitions:l}){fn(!mu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:s,static:a,unstable_useTransitions:l,future:{}}),[c,s,a,l]);typeof n=="string"&&(n=xl(n));let{pathname:p="/",search:m="",hash:g="",state:b=null,key:v="default",unstable_mask:w}=n,C=E.useMemo(()=>{let k=Ys(p,c);return k==null?null:{location:{pathname:k,search:m,hash:g,state:b,key:v,unstable_mask:w},navigationType:r}},[c,p,m,g,b,v,r,w]);return qr(C!=null,`<Router basename="${c}"> is not able to match the URL "${p}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:E.createElement(Ir.Provider,{value:d},E.createElement(Fh.Provider,{children:e,value:C}))}var df="get",ff="application/x-www-form-urlencoded";function Uh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function O_(t){return Uh(t)&&t.tagName.toLowerCase()==="button"}function __(t){return Uh(t)&&t.tagName.toLowerCase()==="form"}function R_(t){return Uh(t)&&t.tagName.toLowerCase()==="input"}function D_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function L_(t,e){return t.button===0&&(!e||e==="_self")&&!D_(t)}var Vd=null;function I_(){if(Vd===null)try{new FormData(document.createElement("form"),0),Vd=!1}catch{Vd=!0}return Vd}var z_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Lg(t){return t!=null&&!z_.has(t)?(qr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ff}"`),null):t}function B_(t,e){let n,r,s,a,l;if(__(t)){let c=t.getAttribute("action");r=c?Ys(c,e):null,n=t.getAttribute("method")||df,s=Lg(t.getAttribute("enctype"))||ff,a=new FormData(t)}else if(O_(t)||R_(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||c.getAttribute("action");if(r=d?Ys(d,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||df,s=Lg(t.getAttribute("formenctype"))||Lg(c.getAttribute("enctype"))||ff,a=new FormData(c,t),!I_()){let{name:p,type:m,value:g}=t;if(m==="image"){let b=p?`${p}.`:"";a.append(`${b}x`,"0"),a.append(`${b}y`,"0")}else p&&a.append(p,g)}}else{if(Uh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=df,r=null,s=ff,l=t}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function nb(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function P_(t,e,n,r){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${r}`:s.pathname=`${s.pathname}.${r}`:s.pathname==="/"?s.pathname=`_root.${r}`:e&&Ys(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}async function H_(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function F_(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function U_(t,e,n){let r=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await H_(a,n);return l.links?l.links():[]}return[]}));return W_(r.flat(1).filter(F_).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function v2(t,e,n,r,s,a){let l=(d,p)=>n[p]?d.route.id!==n[p].route.id:!0,c=(d,p)=>{var m;return n[p].pathname!==d.pathname||((m=n[p].route.path)==null?void 0:m.endsWith("*"))&&n[p].params["*"]!==d.params["*"]};return a==="assets"?e.filter((d,p)=>l(d,p)||c(d,p)):a==="data"?e.filter((d,p)=>{var g;let m=r.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,p)||c(d,p))return!0;if(d.route.shouldRevalidate){let b=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((g=n[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function $_(t,e,{includeHydrateFallback:n}={}){return V_(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function V_(t){return[...new Set(t)]}function q_(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function W_(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let a=JSON.stringify(q_(s));return n.has(a)||(n.add(a),r.push({key:a,link:s})),r},[])}function lE(){let t=E.useContext(bl);return nb(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function G_(){let t=E.useContext(Hh);return nb(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rb=E.createContext(void 0);rb.displayName="FrameworkContext";function cE(){let t=E.useContext(rb);return nb(t,"You must render this element inside a <HydratedRouter> element"),t}function K_(t,e){let n=E.useContext(rb),[r,s]=E.useState(!1),[a,l]=E.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:p,onMouseLeave:m,onTouchStart:g}=e,b=E.useRef(null);E.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let C=N=>{N.forEach(M=>{l(M.isIntersecting)})},k=new IntersectionObserver(C,{threshold:.5});return b.current&&k.observe(b.current),()=>{k.disconnect()}}},[t]),E.useEffect(()=>{if(r){let C=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(C)}}},[r]);let v=()=>{s(!0)},w=()=>{s(!1),l(!1)};return n?t!=="intent"?[a,b,{}]:[a,b,{onFocus:vc(c,v),onBlur:vc(d,w),onMouseEnter:vc(p,v),onMouseLeave:vc(m,w),onTouchStart:vc(g,v)}]:[!1,b,{}]}function vc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Y_({page:t,...e}){let{router:n}=lE(),r=E.useMemo(()=>YS(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?E.createElement(X_,{page:t,matches:r,...e}):null}function J_(t){let{manifest:e,routeModules:n}=cE(),[r,s]=E.useState([]);return E.useEffect(()=>{let a=!1;return U_(t,e,n).then(l=>{a||s(l)}),()=>{a=!0}},[t,e,n]),r}function X_({page:t,matches:e,...n}){let r=ea(),{future:s,manifest:a,routeModules:l}=cE(),{basename:c}=lE(),{loaderData:d,matches:p}=G_(),m=E.useMemo(()=>v2(t,e,p,a,r,"data"),[t,e,p,a,r]),g=E.useMemo(()=>v2(t,e,p,a,r,"assets"),[t,e,p,a,r]),b=E.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let C=new Set,k=!1;if(e.forEach(M=>{var P;let _=a.routes[M.route.id];!_||!_.hasLoader||(!m.some(I=>I.route.id===M.route.id)&&M.route.id in d&&((P=l[M.route.id])!=null&&P.shouldRevalidate)||_.hasClientLoader?k=!0:C.add(M.route.id))}),C.size===0)return[];let N=P_(t,c,s.unstable_trailingSlashAwareDataRequests,"data");return k&&C.size>0&&N.searchParams.set("_routes",e.filter(M=>C.has(M.route.id)).map(M=>M.route.id).join(",")),[N.pathname+N.search]},[c,s.unstable_trailingSlashAwareDataRequests,d,r,a,m,e,t,l]),v=E.useMemo(()=>$_(g,a),[g,a]),w=J_(g);return E.createElement(E.Fragment,null,b.map(C=>E.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),v.map(C=>E.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),w.map(({key:C,link:k})=>E.createElement("link",{key:C,nonce:n.nonce,...k,crossOrigin:k.crossOrigin??n.crossOrigin})))}function Q_(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Z_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Z_&&(window.__reactRouterVersion="7.13.1")}catch{}function e4({basename:t,children:e,unstable_useTransitions:n,window:r}){let s=E.useRef();s.current==null&&(s.current=DO({window:r,v5Compat:!0}));let a=s.current,[l,c]=E.useState({action:a.action,location:a.location}),d=E.useCallback(p=>{n===!1?c(p):E.startTransition(()=>c(p))},[n]);return E.useLayoutEffect(()=>a.listen(d),[a,d]),E.createElement(j_,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:n})}var uE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dE=E.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,unstable_mask:c,state:d,target:p,to:m,preventScrollReset:g,viewTransition:b,unstable_defaultShouldRevalidate:v,...w},C){let{basename:k,navigator:N,unstable_useTransitions:M}=E.useContext(Ir),_=typeof m=="string"&&uE.test(m),P=eE(m,k);m=P.to;let I=p_(m,{relative:s}),q=ea(),j=null;if(c){let pe=Qx(c,[],q.unstable_mask?q.unstable_mask.pathname:"/",!0);k!=="/"&&(pe.pathname=pe.pathname==="/"?k:cs([k,pe.pathname])),j=N.createHref(pe)}let[F,G,te]=K_(r,w),he=s4(m,{replace:l,unstable_mask:c,state:d,target:p,preventScrollReset:g,relative:s,viewTransition:b,unstable_defaultShouldRevalidate:v,unstable_useTransitions:M});function Ne(pe){e&&e(pe),pe.defaultPrevented||he(pe)}let Se=!(P.isExternal||a),Te=E.createElement("a",{...w,...te,href:(Se?j:void 0)||P.absoluteURL||I,onClick:Se?Ne:e,ref:Q_(C,G),target:p,"data-discover":!_&&n==="render"?"true":void 0});return F&&!_?E.createElement(E.Fragment,null,Te,E.createElement(Y_,{page:I})):Te});dE.displayName="Link";var t4=E.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:c,children:d,...p},m){let g=gu(l,{relative:p.relative}),b=ea(),v=E.useContext(Hh),{navigator:w,basename:C}=E.useContext(Ir),k=v!=null&&c4(g)&&c===!0,N=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,M=b.pathname,_=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(M=M.toLowerCase(),_=_?_.toLowerCase():null,N=N.toLowerCase()),_&&C&&(_=Ys(_,C)||_);const P=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let I=M===N||!s&&M.startsWith(N)&&M.charAt(P)==="/",q=_!=null&&(_===N||!s&&_.startsWith(N)&&_.charAt(N.length)==="/"),j={isActive:I,isPending:q,isTransitioning:k},F=I?e:void 0,G;typeof r=="function"?G=r(j):G=[r,I?"active":null,q?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let te=typeof a=="function"?a(j):a;return E.createElement(dE,{...p,"aria-current":F,className:G,ref:m,style:te,to:l,viewTransition:c},typeof d=="function"?d(j):d)});t4.displayName="NavLink";var n4=E.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:a,method:l=df,action:c,onSubmit:d,relative:p,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:b,...v},w)=>{let{unstable_useTransitions:C}=E.useContext(Ir),k=o4(),N=l4(c,{relative:p}),M=l.toLowerCase()==="get"?"get":"post",_=typeof c=="string"&&uE.test(c),P=I=>{if(d&&d(I),I.defaultPrevented)return;I.preventDefault();let q=I.nativeEvent.submitter,j=(q==null?void 0:q.getAttribute("formmethod"))||l,F=()=>k(q||I.currentTarget,{fetcherKey:e,method:j,navigate:n,replace:s,state:a,relative:p,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:b});C&&n!==!1?E.startTransition(()=>F()):F()};return E.createElement("form",{ref:w,method:M,action:N,onSubmit:r?d:P,...v,"data-discover":!_&&t==="render"?"true":void 0})});n4.displayName="Form";function r4(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fE(t){let e=E.useContext(bl);return fn(e,r4(t)),e}function s4(t,{target:e,replace:n,unstable_mask:r,state:s,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d,unstable_useTransitions:p}={}){let m=m_(),g=ea(),b=gu(t,{relative:l});return E.useCallback(v=>{if(L_(v,e)){v.preventDefault();let w=n!==void 0?n:Kc(g)===Kc(b),C=()=>m(t,{replace:w,unstable_mask:r,state:s,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d});p?E.startTransition(()=>C()):C()}},[g,m,b,n,r,s,e,t,a,l,c,d,p])}var i4=0,a4=()=>`__${String(++i4)}__`;function o4(){let{router:t}=fE("useSubmit"),{basename:e}=E.useContext(Ir),n=N_(),r=t.fetch,s=t.navigate;return E.useCallback(async(a,l={})=>{let{action:c,method:d,encType:p,formData:m,body:g}=B_(a,e);if(l.navigate===!1){let b=l.fetcherKey||a4();await r(b,n,l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:g,formMethod:l.method||d,formEncType:l.encType||p,flushSync:l.flushSync})}else await s(l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:g,formMethod:l.method||d,formEncType:l.encType||p,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,s,e,n])}function l4(t,{relative:e}={}){let{basename:n}=E.useContext(Ir),r=E.useContext(Zs);fn(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...gu(t||".",{relative:e})},l=ea();if(t==null){a.search=l.search;let c=new URLSearchParams(a.search),d=c.getAll("index");if(d.some(m=>m==="")){c.delete("index"),d.filter(g=>g).forEach(g=>c.append("index",g));let m=c.toString();a.search=m?`?${m}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:cs([n,a.pathname])),Kc(a)}function c4(t,{relative:e}={}){let n=E.useContext(nE);fn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=fE("useViewTransitionState"),s=gu(t,{relative:e});if(!n.isTransitioning)return!1;let a=Ys(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Ys(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Tf(s.pathname,l)!=null||Tf(s.pathname,a)!=null}var qo=KS();const u4=Xx(qo),d4="modulepreload",f4=function(t){return"/"+t},w2={},tl=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(p){return Promise.all(p.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=l(n.map(p=>{if(p=f4(p),p in w2)return;w2[p]=!0;const m=p.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${g}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":d4,m||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),m)return new Promise((v,w)=>{b.addEventListener("load",v),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),p4=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),k2=t=>{const e=p4(t);return e.charAt(0).toUpperCase()+e.slice(1)},hE=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),m4=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var g4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=E.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:l,...c},d)=>E.createElement("svg",{ref:d,...g4,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:hE("lucide",s),...!a&&!m4(c)&&{"aria-hidden":"true"},...c},[...l.map(([p,m])=>E.createElement(p,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=(t,e)=>{const n=E.forwardRef(({className:r,...s},a)=>E.createElement(x4,{ref:a,iconNode:e,className:hE(`lucide-${h4(k2(t))}`,`lucide-${t}`,r),...s}));return n.displayName=k2(t),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],pE=ve("arrow-left",b4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],v4=ve("arrow-up-down",y4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],k4=ve("bold",w4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Pa=ve("book-open",C4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],sb=ve("book",S4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],C2=ve("bot",E4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],T4=ve("brain",N4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],nl=ve("calendar",A4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Q0=ve("camera",M4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ib=ve("check",j4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ra=ve("chevron-down",O4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Wi=ve("chevron-left",_4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],mE=ve("chevron-right",R4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],gE=ve("chevron-up",D4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rl=ve("circle-alert",L4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Yc=ve("circle-check-big",I4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],B4=ve("circle-question-mark",z4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],H4=ve("clock-3",P4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],U4=ve("clock",F4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],V4=ve("columns-3",$4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xE=ve("compass",q4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],G4=ve("database",W4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Y4=ve("download",K4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],X4=ve("eraser",J4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],$h=ve("external-link",Q4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],S2=ve("eye",Z4);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],bE=ve("file-braces",e3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"11.5",cy:"14.5",r:"2.5",key:"1bq0ko"}],["path",{d:"M13.3 16.3 15 18",key:"2quom7"}]],n3=ve("file-search",t3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xu=ve("file-text",r3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],i3=ve("folder-plus",s3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],E2=ve("folder",a3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],l3=ve("funnel",o3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],u3=ve("gauge",c3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Vh=ve("globe",d3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],N2=ve("grip-vertical",f3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Af=ve("hash",h3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],m3=ve("heading-1",p3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],x3=ve("heading-2",g3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],T2=ve("image",b3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],v3=ve("info",y3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],k3=ve("italic",w3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],S3=ve("layers",C3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]],yE=ve("layout-panel-left",E3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],vE=ve("library",N3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],A2=ve("link",T3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],M2=ve("list-filter",A3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],j3=ve("list-ordered",M3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],_3=ve("list",O3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],nn=ve("loader-circle",R3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],L3=ve("log-out",D3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],z3=ve("map-pin",I3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],P3=ve("menu",B3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Z0=ve("message-circle",H3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],U3=ve("moon",F3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],V3=ve("palette",$3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],Mf=ve("pen-tool",q3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],jf=ve("pen",W3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],j2=ve("pencil-line",G3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Y3=ve("pencil",K3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],wE=ve("play",J3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ex=ve("plus",X3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],Jc=ve("quote",Q3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],kE=ve("rotate-ccw",Z3);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],tR=ve("rows-3",eR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rR=ve("save",nR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],iR=ve("scan-line",sR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Us=ve("search",aR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],lR=ve("send",oR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Ig=ve("settings-2",cR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],dR=ve("skip-forward",uR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],hR=ve("sliders-horizontal",fR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ws=ve("sparkles",pR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gR=ve("square-check-big",mR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],bR=ve("square",xR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Bo=ve("star",yR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],sl=ve("sticky-note",vR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],kR=ve("sun",wR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],SR=ve("table-2",CR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],NR=ve("thumbs-down",ER);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],AR=ve("thumbs-up",TR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ha=ve("trash-2",MR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ui=ve("triangle-alert",jR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],_R=ve("type",OR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],DR=ve("underline",RR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Of=ve("upload",LR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ab=ve("user",IR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],BR=ve("wand-sparkles",zR);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ds=ve("x",PR),qh=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yl(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function ob(t){return"nodeType"in t}function Wn(t){var e,n;return t?yl(t)?t:ob(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function lb(t){const{Document:e}=Wn(t);return t instanceof e}function bu(t){return yl(t)?!1:t instanceof Wn(t).HTMLElement}function CE(t){return t instanceof Wn(t).SVGElement}function vl(t){return t?yl(t)?t.document:ob(t)?lb(t)?t:bu(t)||CE(t)?t.ownerDocument:document:document:document}const Js=qh?E.useLayoutEffect:E.useEffect;function Wh(t){const e=E.useRef(t);return Js(()=>{e.current=t}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function HR(){const t=E.useRef(null),e=E.useCallback((r,s)=>{t.current=setInterval(r,s)},[]),n=E.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Xc(t,e){e===void 0&&(e=[t]);const n=E.useRef(t);return Js(()=>{n.current!==t&&(n.current=t)},e),n}function yu(t,e){const n=E.useRef();return E.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function _f(t){const e=Wh(t),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(e==null||e(s,n.current)),n.current=s},[]);return[n,r]}function Rf(t){const e=E.useRef();return E.useEffect(()=>{e.current=t},[t]),e.current}let zg={};function Gh(t,e){return E.useMemo(()=>{if(e)return e;const n=zg[t]==null?0:zg[t]+1;return zg[t]=n,t+"-"+n},[t,e])}function SE(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((a,l)=>{const c=Object.entries(l);for(const[d,p]of c){const m=a[d];m!=null&&(a[d]=m+t*p)}return a},{...e})}}const Ko=SE(1),Df=SE(-1);function FR(t){return"clientX"in t&&"clientY"in t}function cb(t){if(!t)return!1;const{KeyboardEvent:e}=Wn(t.target);return e&&t instanceof e}function UR(t){if(!t)return!1;const{TouchEvent:e}=Wn(t.target);return e&&t instanceof e}function Lf(t){if(UR(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return FR(t)?{x:t.clientX,y:t.clientY}:null}const il=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[il.Translate.toString(t),il.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),O2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function $R(t){return t.matches(O2)?t:t.querySelector(O2)}const VR={display:"none"};function qR(t){let{id:e,value:n}=t;return We.createElement("div",{id:e,style:VR},n)}function WR(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return We.createElement("div",{id:e,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function GR(){const[t,e]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const EE=E.createContext(null);function KR(t){const e=E.useContext(EE);E.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function YR(){const[t]=E.useState(()=>new Set),e=E.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[E.useCallback(r=>{let{type:s,event:a}=r;t.forEach(l=>{var c;return(c=l[s])==null?void 0:c.call(l,a)})},[t]),e]}const JR={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},XR={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function QR(t){let{announcements:e=XR,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=JR}=t;const{announce:a,announcement:l}=GR(),c=Gh("DndLiveRegion"),[d,p]=E.useState(!1);if(E.useEffect(()=>{p(!0)},[]),KR(E.useMemo(()=>({onDragStart(g){let{active:b}=g;a(e.onDragStart({active:b}))},onDragMove(g){let{active:b,over:v}=g;e.onDragMove&&a(e.onDragMove({active:b,over:v}))},onDragOver(g){let{active:b,over:v}=g;a(e.onDragOver({active:b,over:v}))},onDragEnd(g){let{active:b,over:v}=g;a(e.onDragEnd({active:b,over:v}))},onDragCancel(g){let{active:b,over:v}=g;a(e.onDragCancel({active:b,over:v}))}}),[a,e])),!d)return null;const m=We.createElement(We.Fragment,null,We.createElement(qR,{id:r,value:s.draggable}),We.createElement(WR,{id:c,announcement:l}));return n?qo.createPortal(m,n):m}var dn;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(dn||(dn={}));function If(){}function _2(t,e){return E.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function ZR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return E.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Wr=Object.freeze({x:0,y:0});function e6(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function t6(t,e){const n=Lf(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function n6(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function r6(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function s6(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function R2(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const i6=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=R2(e,e.left,e.top),a=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const p=e6(R2(d),s);a.push({id:c,data:{droppableContainer:l,value:p}})}}return a.sort(n6)};function a6(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),l=s-r,c=a-n;if(r<s&&n<a){const d=e.width*e.height,p=t.width*t.height,m=l*c,g=m/(d+p-m);return Number(g.toFixed(4))}return 0}const o6=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const s=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=a6(c,e);d>0&&s.push({id:l,data:{droppableContainer:a,value:d}})}}return s.sort(r6)};function l6(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function NE(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Wr}function c6(t){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((l,c)=>({...l,top:l.top+t*c.y,bottom:l.bottom+t*c.y,left:l.left+t*c.x,right:l.right+t*c.x}),{...n})}}const u6=c6(1);function TE(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function d6(t,e,n){const r=TE(e);if(!r)return t;const{scaleX:s,scaleY:a,x:l,y:c}=r,d=t.left-l-(1-s)*parseFloat(n),p=t.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=s?t.width/s:t.width,g=a?t.height/a:t.height;return{width:m,height:g,top:p,right:d+m,bottom:p+g,left:d}}const f6={ignoreTransform:!1};function vu(t,e){e===void 0&&(e=f6);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:p,transformOrigin:m}=Wn(t).getComputedStyle(t);p&&(n=d6(n,p,m))}const{top:r,left:s,width:a,height:l,bottom:c,right:d}=n;return{top:r,left:s,width:a,height:l,bottom:c,right:d}}function D2(t){return vu(t,{ignoreTransform:!0})}function h6(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function p6(t,e){return e===void 0&&(e=Wn(t).getComputedStyle(t)),e.position==="fixed"}function m6(t,e){e===void 0&&(e=Wn(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=e[s];return typeof a=="string"?n.test(a):!1})}function ub(t,e){const n=[];function r(s){if(e!=null&&n.length>=e||!s)return n;if(lb(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!bu(s)||CE(s)||n.includes(s))return n;const a=Wn(t).getComputedStyle(s);return s!==t&&m6(s,a)&&n.push(s),p6(s,a)?n:r(s.parentNode)}return t?r(t):n}function AE(t){const[e]=ub(t,1);return e??null}function Bg(t){return!qh||!t?null:yl(t)?t:ob(t)?lb(t)||t===vl(t).scrollingElement?window:bu(t)?t:null:null}function ME(t){return yl(t)?t.scrollX:t.scrollLeft}function jE(t){return yl(t)?t.scrollY:t.scrollTop}function tx(t){return{x:ME(t),y:jE(t)}}var xn;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(xn||(xn={}));function OE(t){return!qh||!t?!1:t===document.scrollingElement}function _E(t){const e={x:0,y:0},n=OE(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},s=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,l=t.scrollTop>=r.y,c=t.scrollLeft>=r.x;return{isTop:s,isLeft:a,isBottom:l,isRight:c,maxScroll:r,minScroll:e}}const g6={x:.2,y:.2};function x6(t,e,n,r,s){let{top:a,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),s===void 0&&(s=g6);const{isTop:p,isBottom:m,isLeft:g,isRight:b}=_E(t),v={x:0,y:0},w={x:0,y:0},C={height:e.height*s.y,width:e.width*s.x};return!p&&a<=e.top+C.height?(v.y=xn.Backward,w.y=r*Math.abs((e.top+C.height-a)/C.height)):!m&&d>=e.bottom-C.height&&(v.y=xn.Forward,w.y=r*Math.abs((e.bottom-C.height-d)/C.height)),!b&&c>=e.right-C.width?(v.x=xn.Forward,w.x=r*Math.abs((e.right-C.width-c)/C.width)):!g&&l<=e.left+C.width&&(v.x=xn.Backward,w.x=r*Math.abs((e.left+C.width-l)/C.width)),{direction:v,speed:w}}function b6(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:e,left:n,right:r,bottom:s}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:s,width:t.clientWidth,height:t.clientHeight}}function RE(t){return t.reduce((e,n)=>Ko(e,tx(n)),Wr)}function y6(t){return t.reduce((e,n)=>e+ME(n),0)}function v6(t){return t.reduce((e,n)=>e+jE(n),0)}function DE(t,e){if(e===void 0&&(e=vu),!t)return;const{top:n,left:r,bottom:s,right:a}=e(t);AE(t)&&(s<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const w6=[["x",["left","right"],y6],["y",["top","bottom"],v6]];class db{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ub(n),s=RE(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,l,c]of w6)for(const d of l)Object.defineProperty(this,d,{get:()=>{const p=c(r),m=s[a]-p;return this.rect[d]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Oc{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var s;(s=this.target)==null||s.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function k6(t){const{EventTarget:e}=Wn(t);return t instanceof e?t:vl(t)}function Pg(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Or;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Or||(Or={}));function L2(t){t.preventDefault()}function C6(t){t.stopPropagation()}var Ct;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ct||(Ct={}));const LE={start:[Ct.Space,Ct.Enter],cancel:[Ct.Esc],end:[Ct.Space,Ct.Enter,Ct.Tab]},S6=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Ct.Right:return{...n,x:n.x+25};case Ct.Left:return{...n,x:n.x-25};case Ct.Down:return{...n,y:n.y+25};case Ct.Up:return{...n,y:n.y-25}}};class IE{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new Oc(vl(n)),this.windowListeners=new Oc(Wn(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Or.Resize,this.handleCancel),this.windowListeners.add(Or.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Or.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&DE(r),n(Wr)}handleKeyDown(e){if(cb(e)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:a=LE,coordinateGetter:l=S6,scrollBehavior:c="smooth"}=s,{code:d}=e;if(a.end.includes(d)){this.handleEnd(e);return}if(a.cancel.includes(d)){this.handleCancel(e);return}const{collisionRect:p}=r.current,m=p?{x:p.left,y:p.top}:Wr;this.referenceCoordinates||(this.referenceCoordinates=m);const g=l(e,{active:n,context:r.current,currentCoordinates:m});if(g){const b=Df(g,m),v={x:0,y:0},{scrollableAncestors:w}=r.current;for(const C of w){const k=e.code,{isTop:N,isRight:M,isLeft:_,isBottom:P,maxScroll:I,minScroll:q}=_E(C),j=b6(C),F={x:Math.min(k===Ct.Right?j.right-j.width/2:j.right,Math.max(k===Ct.Right?j.left:j.left+j.width/2,g.x)),y:Math.min(k===Ct.Down?j.bottom-j.height/2:j.bottom,Math.max(k===Ct.Down?j.top:j.top+j.height/2,g.y))},G=k===Ct.Right&&!M||k===Ct.Left&&!_,te=k===Ct.Down&&!P||k===Ct.Up&&!N;if(G&&F.x!==g.x){const he=C.scrollLeft+b.x,Ne=k===Ct.Right&&he<=I.x||k===Ct.Left&&he>=q.x;if(Ne&&!b.y){C.scrollTo({left:he,behavior:c});return}Ne?v.x=C.scrollLeft-he:v.x=k===Ct.Right?C.scrollLeft-I.x:C.scrollLeft-q.x,v.x&&C.scrollBy({left:-v.x,behavior:c});break}else if(te&&F.y!==g.y){const he=C.scrollTop+b.y,Ne=k===Ct.Down&&he<=I.y||k===Ct.Up&&he>=q.y;if(Ne&&!b.x){C.scrollTo({top:he,behavior:c});return}Ne?v.y=C.scrollTop-he:v.y=k===Ct.Down?C.scrollTop-I.y:C.scrollTop-q.y,v.y&&C.scrollBy({top:-v.y,behavior:c});break}}this.handleMove(e,Ko(Df(g,this.referenceCoordinates),v))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}IE.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=LE,onActivation:s}=e,{active:a}=n;const{code:l}=t.nativeEvent;if(r.start.includes(l)){const c=a.activatorNode.current;return c&&t.target!==c?!1:(t.preventDefault(),s==null||s({event:t.nativeEvent}),!0)}return!1}}];function I2(t){return!!(t&&"distance"in t)}function z2(t){return!!(t&&"delay"in t)}class fb{constructor(e,n,r){var s;r===void 0&&(r=k6(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:a}=e,{target:l}=a;this.props=e,this.events=n,this.document=vl(l),this.documentListeners=new Oc(this.document),this.listeners=new Oc(r),this.windowListeners=new Oc(Wn(l)),this.initialCoordinates=(s=Lf(a))!=null?s:Wr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Or.Resize,this.handleCancel),this.windowListeners.add(Or.DragStart,L2),this.windowListeners.add(Or.VisibilityChange,this.handleCancel),this.windowListeners.add(Or.ContextMenu,L2),this.documentListeners.add(Or.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(z2(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(I2(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Or.Click,C6,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Or.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:l,options:{activationConstraint:c}}=a;if(!s)return;const d=(n=Lf(e))!=null?n:Wr,p=Df(s,d);if(!r&&c){if(I2(c)){if(c.tolerance!=null&&Pg(p,c.tolerance))return this.handleCancel();if(Pg(p,c.distance))return this.handleStart()}if(z2(c)&&Pg(p,c.tolerance))return this.handleCancel();this.handlePending(c,p);return}e.cancelable&&e.preventDefault(),l(d)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Ct.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const E6={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class hb extends fb{constructor(e){const{event:n}=e,r=vl(n.target);super(e,E6,r)}}hb.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const N6={move:{name:"mousemove"},end:{name:"mouseup"}};var nx;(function(t){t[t.RightClick=2]="RightClick"})(nx||(nx={}));class T6 extends fb{constructor(e){super(e,N6,vl(e.event.target))}}T6.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===nx.RightClick?!1:(r==null||r({event:n}),!0)}}];const Hg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class zE extends fb{constructor(e){super(e,Hg)}static setup(){return window.addEventListener(Hg.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Hg.move.name,e)};function e(){}}}zE.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var _c;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(_c||(_c={}));var zf;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(zf||(zf={}));function A6(t){let{acceleration:e,activator:n=_c.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:l=5,order:c=zf.TreeOrder,pointerCoordinates:d,scrollableAncestors:p,scrollableAncestorRects:m,delta:g,threshold:b}=t;const v=j6({delta:g,disabled:!a}),[w,C]=HR(),k=E.useRef({x:0,y:0}),N=E.useRef({x:0,y:0}),M=E.useMemo(()=>{switch(n){case _c.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case _c.DraggableRect:return s}},[n,s,d]),_=E.useRef(null),P=E.useCallback(()=>{const q=_.current;if(!q)return;const j=k.current.x*N.current.x,F=k.current.y*N.current.y;q.scrollBy(j,F)},[]),I=E.useMemo(()=>c===zf.TreeOrder?[...p].reverse():p,[c,p]);E.useEffect(()=>{if(!a||!p.length||!M){C();return}for(const q of I){if((r==null?void 0:r(q))===!1)continue;const j=p.indexOf(q),F=m[j];if(!F)continue;const{direction:G,speed:te}=x6(q,F,M,e,b);for(const he of["x","y"])v[he][G[he]]||(te[he]=0,G[he]=0);if(te.x>0||te.y>0){C(),_.current=q,w(P,l),k.current=te,N.current=G;return}}k.current={x:0,y:0},N.current={x:0,y:0},C()},[e,P,r,C,a,l,JSON.stringify(M),JSON.stringify(v),w,p,I,m,JSON.stringify(b)])}const M6={x:{[xn.Backward]:!1,[xn.Forward]:!1},y:{[xn.Backward]:!1,[xn.Forward]:!1}};function j6(t){let{delta:e,disabled:n}=t;const r=Rf(e);return yu(s=>{if(n||!r||!s)return M6;const a={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[xn.Backward]:s.x[xn.Backward]||a.x===-1,[xn.Forward]:s.x[xn.Forward]||a.x===1},y:{[xn.Backward]:s.y[xn.Backward]||a.y===-1,[xn.Forward]:s.y[xn.Forward]||a.y===1}}},[n,e,r])}function O6(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return yu(s=>{var a;return e==null?null:(a=r??s)!=null?a:null},[r,e])}function _6(t,e){return E.useMemo(()=>t.reduce((n,r)=>{const{sensor:s}=r,a=s.activators.map(l=>({eventName:l.eventName,handler:e(l.handler,r)}));return[...n,...a]},[]),[t,e])}var Qc;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Qc||(Qc={}));var rx;(function(t){t.Optimized="optimized"})(rx||(rx={}));const B2=new Map;function R6(t,e){let{dragging:n,dependencies:r,config:s}=e;const[a,l]=E.useState(null),{frequency:c,measure:d,strategy:p}=s,m=E.useRef(t),g=k(),b=Xc(g),v=E.useCallback(function(N){N===void 0&&(N=[]),!b.current&&l(M=>M===null?N:M.concat(N.filter(_=>!M.includes(_))))},[b]),w=E.useRef(null),C=yu(N=>{if(g&&!n)return B2;if(!N||N===B2||m.current!==t||a!=null){const M=new Map;for(let _ of t){if(!_)continue;if(a&&a.length>0&&!a.includes(_.id)&&_.rect.current){M.set(_.id,_.rect.current);continue}const P=_.node.current,I=P?new db(d(P),P):null;_.rect.current=I,I&&M.set(_.id,I)}return M}return N},[t,a,n,g,d]);return E.useEffect(()=>{m.current=t},[t]),E.useEffect(()=>{g||v()},[n,g]),E.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),E.useEffect(()=>{g||typeof c!="number"||w.current!==null||(w.current=setTimeout(()=>{v(),w.current=null},c))},[c,g,v,...r]),{droppableRects:C,measureDroppableContainers:v,measuringScheduled:a!=null};function k(){switch(p){case Qc.Always:return!1;case Qc.BeforeDragging:return n;default:return!n}}}function pb(t,e){return yu(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function D6(t,e){return pb(t,e)}function L6(t){let{callback:e,disabled:n}=t;const r=Wh(e),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Kh(t){let{callback:e,disabled:n}=t;const r=Wh(e),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function I6(t){return new db(vu(t),t)}function P2(t,e,n){e===void 0&&(e=I6);const[r,s]=E.useState(null);function a(){s(d=>{if(!t)return null;if(t.isConnected===!1){var p;return(p=d??n)!=null?p:null}const m=e(t);return JSON.stringify(d)===JSON.stringify(m)?d:m})}const l=L6({callback(d){if(t)for(const p of d){const{type:m,target:g}=p;if(m==="childList"&&g instanceof HTMLElement&&g.contains(t)){a();break}}}}),c=Kh({callback:a});return Js(()=>{a(),t?(c==null||c.observe(t),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[t]),r}function z6(t){const e=pb(t);return NE(t,e)}const H2=[];function B6(t){const e=E.useRef(t),n=yu(r=>t?r&&r!==H2&&t&&e.current&&t.parentNode===e.current.parentNode?r:ub(t):H2,[t]);return E.useEffect(()=>{e.current=t},[t]),n}function P6(t){const[e,n]=E.useState(null),r=E.useRef(t),s=E.useCallback(a=>{const l=Bg(a.target);l&&n(c=>c?(c.set(l,tx(l)),new Map(c)):null)},[]);return E.useEffect(()=>{const a=r.current;if(t!==a){l(a);const c=t.map(d=>{const p=Bg(d);return p?(p.addEventListener("scroll",s,{passive:!0}),[p,tx(p)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=t}return()=>{l(t),l(a)};function l(c){c.forEach(d=>{const p=Bg(d);p==null||p.removeEventListener("scroll",s)})}},[s,t]),E.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,l)=>Ko(a,l),Wr):RE(t):Wr,[t,e])}function F2(t,e){e===void 0&&(e=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},e),E.useEffect(()=>{const r=t!==Wr;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Df(t,n.current):Wr}function H6(t){E.useEffect(()=>{if(!qh)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function F6(t,e){return E.useMemo(()=>t.reduce((n,r)=>{let{eventName:s,handler:a}=r;return n[s]=l=>{a(l,e)},n},{}),[t,e])}function BE(t){return E.useMemo(()=>t?h6(t):null,[t])}const U2=[];function U6(t,e){e===void 0&&(e=vu);const[n]=t,r=BE(n?Wn(n):null),[s,a]=E.useState(U2);function l(){a(()=>t.length?t.map(d=>OE(d)?r:new db(e(d),d)):U2)}const c=Kh({callback:l});return Js(()=>{c==null||c.disconnect(),l(),t.forEach(d=>c==null?void 0:c.observe(d))},[t]),s}function PE(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return bu(e)?e:t}function $6(t){let{measure:e}=t;const[n,r]=E.useState(null),s=E.useCallback(p=>{for(const{target:m}of p)if(bu(m)){r(g=>{const b=e(m);return g?{...g,width:b.width,height:b.height}:b});break}},[e]),a=Kh({callback:s}),l=E.useCallback(p=>{const m=PE(p);a==null||a.disconnect(),m&&(a==null||a.observe(m)),r(m?e(m):null)},[e,a]),[c,d]=_f(l);return E.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const V6=[{sensor:hb,options:{}},{sensor:IE,options:{}}],q6={current:{}},hf={draggable:{measure:D2},droppable:{measure:D2,strategy:Qc.WhileDragging,frequency:rx.Optimized},dragOverlay:{measure:vu}};class Rc extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const W6={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Rc,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:If},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:hf,measureDroppableContainers:If,windowRect:null,measuringScheduled:!1},HE={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:If,draggableNodes:new Map,over:null,measureDroppableContainers:If},wu=E.createContext(HE),FE=E.createContext(W6);function G6(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Rc}}}function K6(t,e){switch(e.type){case dn.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case dn.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case dn.DragEnd:case dn.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dn.RegisterDroppable:{const{element:n}=e,{id:r}=n,s=new Rc(t.droppable.containers);return s.set(r,n),{...t,droppable:{...t.droppable,containers:s}}}case dn.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=e,a=t.droppable.containers.get(n);if(!a||r!==a.key)return t;const l=new Rc(t.droppable.containers);return l.set(n,{...a,disabled:s}),{...t,droppable:{...t.droppable,containers:l}}}case dn.UnregisterDroppable:{const{id:n,key:r}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const a=new Rc(t.droppable.containers);return a.delete(n),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function Y6(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(wu),a=Rf(r),l=Rf(n==null?void 0:n.id);return E.useEffect(()=>{if(!e&&!r&&a&&l!=null){if(!cb(a)||document.activeElement===a.target)return;const c=s.get(l);if(!c)return;const{activatorNode:d,node:p}=c;if(!d.current&&!p.current)return;requestAnimationFrame(()=>{for(const m of[d.current,p.current]){if(!m)continue;const g=$R(m);if(g){g.focus();break}}})}},[r,e,s,l,a]),null}function UE(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((s,a)=>a({transform:s,...r}),n):n}function J6(t){return E.useMemo(()=>({draggable:{...hf.draggable,...t==null?void 0:t.draggable},droppable:{...hf.droppable,...t==null?void 0:t.droppable},dragOverlay:{...hf.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function X6(t){let{activeNode:e,measure:n,initialRect:r,config:s=!0}=t;const a=E.useRef(!1),{x:l,y:c}=typeof s=="boolean"?{x:s,y:s}:s;Js(()=>{if(!l&&!c||!e){a.current=!1;return}if(a.current||!r)return;const p=e==null?void 0:e.node.current;if(!p||p.isConnected===!1)return;const m=n(p),g=NE(m,r);if(l||(g.x=0),c||(g.y=0),a.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const b=AE(p);b&&b.scrollBy({top:g.y,left:g.x})}},[e,l,c,r,n])}const Yh=E.createContext({...Wr,scaleX:1,scaleY:1});var _i;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(_i||(_i={}));const Q6=E.memo(function(e){var n,r,s,a;let{id:l,accessibility:c,autoScroll:d=!0,children:p,sensors:m=V6,collisionDetection:g=o6,measuring:b,modifiers:v,...w}=e;const C=E.useReducer(K6,void 0,G6),[k,N]=C,[M,_]=YR(),[P,I]=E.useState(_i.Uninitialized),q=P===_i.Initialized,{draggable:{active:j,nodes:F,translate:G},droppable:{containers:te}}=k,he=j!=null?F.get(j):null,Ne=E.useRef({initial:null,translated:null}),Se=E.useMemo(()=>{var Q;return j!=null?{id:j,data:(Q=he==null?void 0:he.data)!=null?Q:q6,rect:Ne}:null},[j,he]),Te=E.useRef(null),[pe,U]=E.useState(null),[Z,K]=E.useState(null),z=Xc(w,Object.values(w)),H=Gh("DndDescribedBy",l),A=E.useMemo(()=>te.getEnabled(),[te]),R=J6(b),{droppableRects:W,measureDroppableContainers:oe,measuringScheduled:be}=R6(A,{dragging:q,dependencies:[G.x,G.y],config:R.droppable}),L=O6(F,j),ae=E.useMemo(()=>Z?Lf(Z):null,[Z]),$=yr(),ne=D6(L,R.draggable.measure);X6({activeNode:j!=null?F.get(j):null,config:$.layoutShiftCompensation,initialRect:ne,measure:R.draggable.measure});const ie=P2(L,R.draggable.measure,ne),Oe=P2(L?L.parentElement:null),$e=E.useRef({activatorEvent:null,active:null,activeNode:L,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:F,draggingNode:null,draggingNodeRect:null,droppableContainers:te,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),lt=te.getNodeFor((n=$e.current.over)==null?void 0:n.id),Ue=$6({measure:R.dragOverlay.measure}),rt=(r=Ue.nodeRef.current)!=null?r:L,pt=q?(s=Ue.rect)!=null?s:ie:null,Me=!!(Ue.nodeRef.current&&Ue.rect),st=z6(Me?null:ie),De=BE(rt?Wn(rt):null),_e=B6(q?lt??L:null),an=U6(_e),on=UE(v,{transform:{x:G.x-st.x,y:G.y-st.y,scaleX:1,scaleY:1},activatorEvent:Z,active:Se,activeNodeRect:ie,containerNodeRect:Oe,draggingNodeRect:pt,over:$e.current.over,overlayNodeRect:Ue.rect,scrollableAncestors:_e,scrollableAncestorRects:an,windowRect:De}),Gn=ae?Ko(ae,G):null,Dt=P6(_e),gs=F2(Dt),Yr=F2(Dt,[ie]),Kn=Ko(on,gs),hn=pt?u6(pt,on):null,Yn=Se&&hn?g({active:Se,collisionRect:hn,droppableRects:W,droppableContainers:A,pointerCoordinates:Gn}):null,Jr=s6(Yn,"id"),[Jt,Pn]=E.useState(null),pn=Me?on:Ko(on,Yr),Ht=l6(pn,(a=Jt==null?void 0:Jt.rect)!=null?a:null,ie),kn=E.useRef(null),Gt=E.useCallback((Q,re)=>{let{sensor:ue,options:me}=re;if(Te.current==null)return;const ke=F.get(Te.current);if(!ke)return;const Ce=Q.nativeEvent,ye=new ue({active:Te.current,activeNode:ke,event:Ce,options:me,context:$e,onAbort(Ae){if(!F.get(Ae))return;const{onDragAbort:Pe}=z.current,Ye={id:Ae};Pe==null||Pe(Ye),M({type:"onDragAbort",event:Ye})},onPending(Ae,Qe,Pe,Ye){if(!F.get(Ae))return;const{onDragPending:It}=z.current,Cn={id:Ae,constraint:Qe,initialCoordinates:Pe,offset:Ye};It==null||It(Cn),M({type:"onDragPending",event:Cn})},onStart(Ae){const Qe=Te.current;if(Qe==null)return;const Pe=F.get(Qe);if(!Pe)return;const{onDragStart:Ye}=z.current,ft={activatorEvent:Ce,active:{id:Qe,data:Pe.data,rect:Ne}};qo.unstable_batchedUpdates(()=>{Ye==null||Ye(ft),I(_i.Initializing),N({type:dn.DragStart,initialCoordinates:Ae,active:Qe}),M({type:"onDragStart",event:ft}),U(kn.current),K(Ce)})},onMove(Ae){N({type:dn.DragMove,coordinates:Ae})},onEnd:He(dn.DragEnd),onCancel:He(dn.DragCancel)});kn.current=ye;function He(Ae){return async function(){const{active:Pe,collisions:Ye,over:ft,scrollAdjustedTranslate:It}=$e.current;let Cn=null;if(Pe&&It){const{cancelDrop:or}=z.current;Cn={activatorEvent:Ce,active:Pe,collisions:Ye,delta:It,over:ft},Ae===dn.DragEnd&&typeof or=="function"&&await Promise.resolve(or(Cn))&&(Ae=dn.DragCancel)}Te.current=null,qo.unstable_batchedUpdates(()=>{N({type:Ae}),I(_i.Uninitialized),Pn(null),U(null),K(null),kn.current=null;const or=Ae===dn.DragEnd?"onDragEnd":"onDragCancel";if(Cn){const Hn=z.current[or];Hn==null||Hn(Cn),M({type:or,event:Cn})}})}}},[F]),oa=E.useCallback((Q,re)=>(ue,me)=>{const ke=ue.nativeEvent,Ce=F.get(me);if(Te.current!==null||!Ce||ke.dndKit||ke.defaultPrevented)return;const ye={active:Ce};Q(ue,re.options,ye)===!0&&(ke.dndKit={capturedBy:re.sensor},Te.current=me,Gt(ue,re))},[F,Gt]),ln=_6(m,oa);H6(m),Js(()=>{ie&&P===_i.Initializing&&I(_i.Initialized)},[ie,P]),E.useEffect(()=>{const{onDragMove:Q}=z.current,{active:re,activatorEvent:ue,collisions:me,over:ke}=$e.current;if(!re||!ue)return;const Ce={active:re,activatorEvent:ue,collisions:me,delta:{x:Kn.x,y:Kn.y},over:ke};qo.unstable_batchedUpdates(()=>{Q==null||Q(Ce),M({type:"onDragMove",event:Ce})})},[Kn.x,Kn.y]),E.useEffect(()=>{const{active:Q,activatorEvent:re,collisions:ue,droppableContainers:me,scrollAdjustedTranslate:ke}=$e.current;if(!Q||Te.current==null||!re||!ke)return;const{onDragOver:Ce}=z.current,ye=me.get(Jr),He=ye&&ye.rect.current?{id:ye.id,rect:ye.rect.current,data:ye.data,disabled:ye.disabled}:null,Ae={active:Q,activatorEvent:re,collisions:ue,delta:{x:ke.x,y:ke.y},over:He};qo.unstable_batchedUpdates(()=>{Pn(He),Ce==null||Ce(Ae),M({type:"onDragOver",event:Ae})})},[Jr]),Js(()=>{$e.current={activatorEvent:Z,active:Se,activeNode:L,collisionRect:hn,collisions:Yn,droppableRects:W,draggableNodes:F,draggingNode:rt,draggingNodeRect:pt,droppableContainers:te,over:Jt,scrollableAncestors:_e,scrollAdjustedTranslate:Kn},Ne.current={initial:pt,translated:hn}},[Se,L,Yn,hn,F,rt,pt,W,te,Jt,_e,Kn]),A6({...$,delta:G,draggingRect:hn,pointerCoordinates:Gn,scrollableAncestors:_e,scrollableAncestorRects:an});const Xr=E.useMemo(()=>({active:Se,activeNode:L,activeNodeRect:ie,activatorEvent:Z,collisions:Yn,containerNodeRect:Oe,dragOverlay:Ue,draggableNodes:F,droppableContainers:te,droppableRects:W,over:Jt,measureDroppableContainers:oe,scrollableAncestors:_e,scrollableAncestorRects:an,measuringConfiguration:R,measuringScheduled:be,windowRect:De}),[Se,L,ie,Z,Yn,Oe,Ue,F,te,W,Jt,oe,_e,an,R,be,De]),Jn=E.useMemo(()=>({activatorEvent:Z,activators:ln,active:Se,activeNodeRect:ie,ariaDescribedById:{draggable:H},dispatch:N,draggableNodes:F,over:Jt,measureDroppableContainers:oe}),[Z,ln,Se,ie,N,H,F,Jt,oe]);return We.createElement(EE.Provider,{value:_},We.createElement(wu.Provider,{value:Jn},We.createElement(FE.Provider,{value:Xr},We.createElement(Yh.Provider,{value:Ht},p)),We.createElement(Y6,{disabled:(c==null?void 0:c.restoreFocus)===!1})),We.createElement(QR,{...c,hiddenTextDescribedById:H}));function yr(){const Q=(pe==null?void 0:pe.autoScrollEnabled)===!1,re=typeof d=="object"?d.enabled===!1:d===!1,ue=q&&!Q&&!re;return typeof d=="object"?{...d,enabled:ue}:{enabled:ue}}}),Z6=E.createContext(null),$2="button",eD="Draggable";function tD(t){let{id:e,data:n,disabled:r=!1,attributes:s}=t;const a=Gh(eD),{activators:l,activatorEvent:c,active:d,activeNodeRect:p,ariaDescribedById:m,draggableNodes:g,over:b}=E.useContext(wu),{role:v=$2,roleDescription:w="draggable",tabIndex:C=0}=s??{},k=(d==null?void 0:d.id)===e,N=E.useContext(k?Yh:Z6),[M,_]=_f(),[P,I]=_f(),q=F6(l,e),j=Xc(n);Js(()=>(g.set(e,{id:e,key:a,node:M,activatorNode:P,data:j}),()=>{const G=g.get(e);G&&G.key===a&&g.delete(e)}),[g,e]);const F=E.useMemo(()=>({role:v,tabIndex:C,"aria-disabled":r,"aria-pressed":k&&v===$2?!0:void 0,"aria-roledescription":w,"aria-describedby":m.draggable}),[r,v,C,k,w,m.draggable]);return{active:d,activatorEvent:c,activeNodeRect:p,attributes:F,isDragging:k,listeners:r?void 0:q,node:M,over:b,setNodeRef:_,setActivatorNodeRef:I,transform:N}}function nD(){return E.useContext(FE)}const rD="Droppable",sD={timeout:25};function iD(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:s}=t;const a=Gh(rD),{active:l,dispatch:c,over:d,measureDroppableContainers:p}=E.useContext(wu),m=E.useRef({disabled:n}),g=E.useRef(!1),b=E.useRef(null),v=E.useRef(null),{disabled:w,updateMeasurementsFor:C,timeout:k}={...sD,...s},N=Xc(C??r),M=E.useCallback(()=>{if(!g.current){g.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{p(Array.isArray(N.current)?N.current:[N.current]),v.current=null},k)},[k]),_=Kh({callback:M,disabled:w||!l}),P=E.useCallback((F,G)=>{_&&(G&&(_.unobserve(G),g.current=!1),F&&_.observe(F))},[_]),[I,q]=_f(P),j=Xc(e);return E.useEffect(()=>{!_||!I.current||(_.disconnect(),g.current=!1,_.observe(I.current))},[I,_]),E.useEffect(()=>(c({type:dn.RegisterDroppable,element:{id:r,key:a,disabled:n,node:I,rect:b,data:j}}),()=>c({type:dn.UnregisterDroppable,key:a,id:r})),[r]),E.useEffect(()=>{n!==m.current.disabled&&(c({type:dn.SetDroppableDisabled,id:r,key:a,disabled:n}),m.current.disabled=n)},[r,a,n,c]),{active:l,rect:b,isOver:(d==null?void 0:d.id)===r,node:I,over:d,setNodeRef:q}}function aD(t){let{animation:e,children:n}=t;const[r,s]=E.useState(null),[a,l]=E.useState(null),c=Rf(n);return!n&&!r&&c&&s(c),Js(()=>{if(!a)return;const d=r==null?void 0:r.key,p=r==null?void 0:r.props.id;if(d==null||p==null){s(null);return}Promise.resolve(e(p,a)).then(()=>{s(null)})},[e,r,a]),We.createElement(We.Fragment,null,n,r?E.cloneElement(r,{ref:l}):null)}const oD={x:0,y:0,scaleX:1,scaleY:1};function lD(t){let{children:e}=t;return We.createElement(wu.Provider,{value:HE},We.createElement(Yh.Provider,{value:oD},e))}const cD={position:"fixed",touchAction:"none"},uD=t=>cb(t)?"transform 250ms ease":void 0,dD=E.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:s,children:a,className:l,rect:c,style:d,transform:p,transition:m=uD}=t;if(!c)return null;const g=s?p:{...p,scaleX:1,scaleY:1},b={...cD,width:c.width,height:c.height,top:c.top,left:c.left,transform:il.Transform.toString(g),transformOrigin:s&&r?t6(r,c):void 0,transition:typeof m=="function"?m(r):m,...d};return We.createElement(n,{className:l,style:b,ref:e},a)}),fD=t=>e=>{let{active:n,dragOverlay:r}=e;const s={},{styles:a,className:l}=t;if(a!=null&&a.active)for(const[c,d]of Object.entries(a.active))d!==void 0&&(s[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(a!=null&&a.dragOverlay)for(const[c,d]of Object.entries(a.dragOverlay))d!==void 0&&r.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&r.node.classList.add(l.dragOverlay),function(){for(const[d,p]of Object.entries(s))n.node.style.setProperty(d,p);l!=null&&l.active&&n.node.classList.remove(l.active)}},hD=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:il.Transform.toString(e)},{transform:il.Transform.toString(n)}]},pD={duration:250,easing:"ease",keyframes:hD,sideEffects:fD({styles:{active:{opacity:"0"}}})};function mD(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=t;return Wh((a,l)=>{if(e===null)return;const c=n.get(a);if(!c)return;const d=c.node.current;if(!d)return;const p=PE(l);if(!p)return;const{transform:m}=Wn(l).getComputedStyle(l),g=TE(m);if(!g)return;const b=typeof e=="function"?e:gD(e);return DE(d,s.draggable.measure),b({active:{id:a,data:c.data,node:d,rect:s.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:s.dragOverlay.measure(p)},droppableContainers:r,measuringConfiguration:s,transform:g})})}function gD(t){const{duration:e,easing:n,sideEffects:r,keyframes:s}={...pD,...t};return a=>{let{active:l,dragOverlay:c,transform:d,...p}=a;if(!e)return;const m={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},g={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},b={x:d.x-m.x,y:d.y-m.y,...g},v=s({...p,active:l,dragOverlay:c,transform:{initial:d,final:b}}),[w]=v,C=v[v.length-1];if(JSON.stringify(w)===JSON.stringify(C))return;const k=r==null?void 0:r({active:l,dragOverlay:c,...p}),N=c.node.animate(v,{duration:e,easing:n,fill:"forwards"});return new Promise(M=>{N.onfinish=()=>{k==null||k(),M()}})}}let V2=0;function xD(t){return E.useMemo(()=>{if(t!=null)return V2++,V2},[t])}const bD=We.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:s,transition:a,modifiers:l,wrapperElement:c="div",className:d,zIndex:p=999}=t;const{activatorEvent:m,active:g,activeNodeRect:b,containerNodeRect:v,draggableNodes:w,droppableContainers:C,dragOverlay:k,over:N,measuringConfiguration:M,scrollableAncestors:_,scrollableAncestorRects:P,windowRect:I}=nD(),q=E.useContext(Yh),j=xD(g==null?void 0:g.id),F=UE(l,{activatorEvent:m,active:g,activeNodeRect:b,containerNodeRect:v,draggingNodeRect:k.rect,over:N,overlayNodeRect:k.rect,scrollableAncestors:_,scrollableAncestorRects:P,transform:q,windowRect:I}),G=pb(b),te=mD({config:r,draggableNodes:w,droppableContainers:C,measuringConfiguration:M}),he=G?k.setRef:void 0;return We.createElement(lD,null,We.createElement(aD,{animation:te},g&&j?We.createElement(dD,{key:j,id:g.id,ref:he,as:c,activatorEvent:m,adjustScale:e,className:d,transition:a,rect:G,style:{zIndex:p,...s},transform:F},n):null))});function yD(t,e,n){const r={...t};return e.top+t.y<=n.top?r.y=n.top-e.top:e.bottom+t.y>=n.top+n.height&&(r.y=n.top+n.height-e.bottom),e.left+t.x<=n.left?r.x=n.left-e.left:e.right+t.x>=n.left+n.width&&(r.x=n.left+n.width-e.right),r}const q2=t=>{let{transform:e,draggingNodeRect:n,windowRect:r}=t;return!n||!r?e:yD(e,n,r)},vD=4,Bf=["Felsefe","Sosyoloji","Psikoloji","Bilim ve Teknoloji","Din ve nan","Tarih","nceleme ve Aratrma","Ekonomi ve Hukuk","Trk Edebiyat","Dnya Edebiyat","Sanat ve Kltr","Dier"],W2=({activeCategory:t,onCategoryChange:e,categories:n=Bf})=>h.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[h.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[h.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Discovery Areas"]}),h.jsxs("div",{className:"space-y-1",children:[h.jsxs("button",{onClick:()=>e(null),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===null?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[h.jsx("span",{className:t===null?"text-card-foreground":"text-card-foreground/80",children:"All Categories"}),t===null&&h.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]}),n.map(r=>h.jsxs("button",{onClick:()=>e(r),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl text-xs font-medium transition-all duration-300 border bg-card text-card-foreground ${t===r?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[h.jsx("span",{className:t===r?"text-card-foreground":"text-card-foreground/80",children:r}),t===r&&h.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r))]})]}),$E=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"kb-grad-orange",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[h.jsx("stop",{offset:"0%",stopColor:"#CC561E"}),h.jsx("stop",{offset:"100%",stopColor:"#A44319"})]})}),h.jsx("rect",{x:"2",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"}),h.jsx("rect",{x:"9",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"16",y:"2",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),h.jsx("rect",{x:"2",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)"}),h.jsx("rect",{x:"16",y:"9",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"2",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.2"}),h.jsx("rect",{x:"9",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.4"}),h.jsx("rect",{x:"16",y:"16",width:"6",height:"6",rx:"2",fill:"url(#kb-grad-orange)",fillOpacity:"0.8"})]}),VE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M12 20H21",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M16.5 3.5C17.3284 2.67157 18.6716 2.67157 19.5 3.5C20.3284 4.32843 20.3284 5.67157 19.5 6.5L7 19L3 20L4 16L16.5 3.5Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M15 5L19 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),sx=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"3",y:"6",width:"4",height:"12",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M4 9H6",stroke:"#CC561E",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("rect",{x:"8",y:"4",width:"4",height:"14",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.3"}),h.jsx("path",{d:"M9 7H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),h.jsx("path",{d:"M9 15H11",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round"}),h.jsx("rect",{x:"13",y:"7",width:"4",height:"11",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"18",y:"5",width:"4",height:"13",rx:"0.5",transform:"rotate(12 18 5)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M2 19H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.3"})]}),pf=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M4 4H14L20 10V20H4V4Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M14 4V10H20",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round"}),h.jsx("path",{d:"M8 14H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M8 17H12",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),mf=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"11",cy:"11",r:"9",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("ellipse",{cx:"11",cy:"11",rx:"3.5",ry:"9",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M2 11H20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M11 2V20",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.6"}),h.jsx("path",{d:"M16 14L22 17L19 18L21 21L19 22L17 19L14 22V14Z",fill:"#CC561E",stroke:"#000",strokeWidth:"0.5"})]}),qE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"5",y:"5",width:"14",height:"15",rx:"1.5",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.3",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M3 4C3 3.44772 3.44772 3 4 3H19C19.5523 3 20 3.44772 20 4V20C20 20.5523 19.5523 21 19 21H4C3.44772 21 3 20.5523 3 20V4Z",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.15"}),h.jsx("path",{d:"M5 1V5M9 1V5M13 1V5M17 1V5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M7 9H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M7 12H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M7 15H16",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M16 21L20 17",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),nW=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M6 20V14",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M12 20V10",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M18 20V5",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M4 14L10 8L15 13L21 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M21 4H16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M21 4V9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),rW=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"5",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"13",y:"5",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"5",y:"13",width:"6",height:"6",rx:"2",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"16",y:"13",width:"6",height:"6",rx:"2",transform:"rotate(45 16 16)",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.1"})]}),sW=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#CC561E",strokeWidth:"2",strokeOpacity:"0.8"}),h.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"#CC561E",strokeWidth:"1.5",strokeOpacity:"0.5"}),h.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M19 5L13.5 10.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M19 5L20 9",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M19 5L15 4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"})]}),iW=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M21 8V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M23 3H1V8H23V3Z",stroke:"#CC561E",strokeWidth:"2",strokeLinejoin:"round",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("rect",{x:"10",y:"12",width:"4",height:"2",rx:"0.5",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("path",{d:"M7 16H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("path",{d:"M7 19H17",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.4"})]}),Pf=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("circle",{cx:"11",cy:"11",r:"7",stroke:"#CC561E",strokeWidth:"2.5",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M14.5 7.5C14.5 7.5 13.5 6.5 11 6.5",stroke:"#fff",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.7"}),h.jsx("circle",{cx:"11",cy:"11",r:"4",stroke:"#CC561E",strokeWidth:"1",strokeOpacity:"0.3"}),h.jsx("path",{d:"M16 16L20 20",stroke:"#CC561E",strokeWidth:"3",strokeLinecap:"round"}),h.jsx("path",{d:"M17 17L19 19",stroke:"#fff",strokeWidth:"1",strokeLinecap:"round",strokeOpacity:"0.5"}),h.jsx("circle",{cx:"18",cy:"6",r:"1.5",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("circle",{cx:"21",cy:"9",r:"1",fill:"#CC561E",fillOpacity:"0.4"})]}),WE=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("rect",{x:"4",y:"6",width:"16",height:"15",rx:"4",stroke:"#CC561E",strokeWidth:"2",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M12 6V3",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round"}),h.jsx("circle",{cx:"12",cy:"3",r:"2",stroke:"#CC561E",strokeWidth:"1.5"}),h.jsx("circle",{cx:"12",cy:"3",r:"0.5",fill:"#CC561E"}),h.jsx("rect",{x:"7",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("rect",{x:"14",y:"11",width:"3",height:"3",rx:"1",fill:"#CC561E",fillOpacity:"0.8"}),h.jsx("path",{d:"M9 16C9 16 10 17 12 17C14 17 15 16 15 16",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:"0.6"}),h.jsx("path",{d:"M2 13H4",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"}),h.jsx("path",{d:"M20 13H22",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",strokeOpacity:"0.4"})]}),wD=({className:t,size:e=24})=>h.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[h.jsx("path",{d:"M2 6C6 6 6 10 10 10C14 10 14 6 18 6C20 6 21 7 22 8",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.05"}),h.jsx("path",{d:"M2 12C6 12 6 16 10 16C14 16 14 12 18 12C20 12 21 13 22 14",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.1"}),h.jsx("path",{d:"M2 18C6 18 6 22 10 22C14 22 14 18 18 18C20 18 21 19 22 20",stroke:"#CC561E",strokeWidth:"2",strokeLinecap:"round",fill:"#CC561E",fillOpacity:"0.2"}),h.jsx("path",{d:"M10 4V20",stroke:"#CC561E",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"2 4",strokeOpacity:"0.5"})]});function Jh(t){const e=typeof t=="string"?t.trim().toLowerCase():"";return e==="insight"||e==="note"?"insight":"highlight"}function GE(t){return Jh(t)==="insight"}const KE="PRIVATE";function Xh(t){const e=typeof t=="string"?t.trim().toUpperCase():"";return e==="DAILY"?"DAILY":e==="IDEAS"?"IDEAS":KE}function Pt(t){return t.type==="PERSONAL_NOTE"}function Dn(t){return Pt(t)?Xh(t.personalNoteCategory):KE}function YE(t){return Pt(t)&&Dn(t)==="IDEAS"}function JE(t){return YE(t)?"INSIGHT":"PERSONAL_NOTE"}function XE(t){return typeof t!="string"?void 0:t.trim().replace(/\s+/g," ")||void 0}function QE(t){return typeof t!="string"?void 0:t.trim()||void 0}const kD=/<\/?[a-z][\s\S]*>/i,ZE=t=>kD.test(t),Na=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Ta=t=>t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(.+?)__/g,"<u>$1</u>").replace(/_(.+?)_/g,"<em>$1</em>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,'<code class="px-1 py-0.5 rounded bg-slate-100 text-slate-700">$1</code>'),CD=t=>{if(typeof window>"u")return t;const n=new DOMParser().parseFromString(t,"text/html");return n.querySelectorAll("script,style,iframe,object,embed").forEach(r=>r.remove()),n.body.querySelectorAll("*").forEach(r=>{[...r.attributes].forEach(s=>{const a=s.name.toLowerCase(),l=s.value.toLowerCase();a.startsWith("on")&&r.removeAttribute(s.name),(a==="href"||a==="src")&&l.startsWith("javascript:")&&r.removeAttribute(s.name)})}),n.body.innerHTML},al=t=>{if(!t)return"";if(ZE(t)){const e=t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/(p|div|li|h1|h2|h3|h4|h5|h6|blockquote|pre|tr|td|th|ul|ol)>/gi,`
`);return typeof window<"u"?(new DOMParser().parseFromString(e,"text/html").body.textContent||"").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).trim():e.replace(/<[^>]*>/g," ").replace(/\r\n/g,`
`).replace(/[ \t]+\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]{2,}/g," ").trim()}return t.replace(/^#{1,6}\s+/gm,"").replace(/^\s*-\s\[(?: |x|X)\]\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/^\s*>\s?/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\s+\n/g,`
`).trim()},Hf=t=>al(t).trim().length>0,mb=t=>{if(!Hf(t))return'<p class="text-slate-400 italic">No content added.</p>';if(ZE(t))return CD(t);const e=t.split(`
`);let n="",r=null;const s=()=>{r&&(n+=`</${r}>`,r=null)};for(const a of e){if(!a.trim()){s(),n+='<div class="h-2"></div>';continue}const l=a.match(/^\s*#\s+(.+)/),c=a.match(/^\s*##\s+(.+)/),d=a.match(/^\s*-\s\[( |x|X)\]\s+(.+)/),p=a.match(/^\s*-\s+(.+)/),m=a.match(/^\s*\d+\.\s+(.+)/),g=a.match(/^\s*>\s+(.+)/);if(l){s(),n+=`<h1 class="text-xl font-bold mt-3 mb-1.5">${Ta(Na(l[1]))}</h1>`;continue}if(c){s(),n+=`<h2 class="text-lg font-semibold mt-3 mb-1.5">${Ta(Na(c[1]))}</h2>`;continue}if(g){s(),n+=`<blockquote class="border-l-2 border-[#CC561E]/40 pl-3 italic text-slate-600 my-1">${Ta(Na(g[1]))}</blockquote>`;continue}if(d){r!=="ul"&&(s(),r="ul",n+='<ul class="space-y-1 my-1">');const b=d[1].toLowerCase()==="x";n+=`<li class="text-sm flex items-start gap-2"><span class="mt-0.5">${b?"&#9745;":"&#9744;"}</span><span>${Ta(Na(d[2]))}</span></li>`;continue}if(p){r!=="ul"&&(s(),r="ul",n+='<ul class="list-disc pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${Ta(Na(p[1]))}</li>`;continue}if(m){r!=="ol"&&(s(),r="ol",n+='<ol class="list-decimal pl-5 space-y-1 my-1">'),n+=`<li class="text-sm">${Ta(Na(m[1]))}</li>`;continue}s(),n+=`<p class="text-sm leading-relaxed my-1">${Ta(Na(a.trim()))}</p>`}return s(),n};var Fg={exports:{}},Ug={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G2;function SD(){if(G2)return Ug;G2=1;var t=pu();function e(g,b){return g===b&&(g!==0||1/g===1/b)||g!==g&&b!==b}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,a=t.useLayoutEffect,l=t.useDebugValue;function c(g,b){var v=b(),w=r({inst:{value:v,getSnapshot:b}}),C=w[0].inst,k=w[1];return a(function(){C.value=v,C.getSnapshot=b,d(C)&&k({inst:C})},[g,v,b]),s(function(){return d(C)&&k({inst:C}),g(function(){d(C)&&k({inst:C})})},[g]),l(v),v}function d(g){var b=g.getSnapshot;g=g.value;try{var v=b();return!n(g,v)}catch{return!0}}function p(g,b){return b()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return Ug.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:m,Ug}var K2;function eN(){return K2||(K2=1,Fg.exports=SD()),Fg.exports}var tN=eN();function An(t){this.content=t}An.prototype={constructor:An,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),a=r.content.slice();return s==-1?a.push(n||t,e):(a[s+1]=e,n&&(a[s]=n)),new An(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new An(n)},addToStart:function(t,e){return new An([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new An(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),a=r.find(t);return s.splice(a==-1?s.length:a,0,e,n),new An(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=An.from(t),t.size?new An(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=An.from(t),t.size?new An(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=An.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};An.from=function(t){if(t instanceof An)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new An(e)};function nN(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),a=e.child(r);if(s==a){n+=s.nodeSize;continue}if(!s.sameMarkup(a))return n;if(s.isText&&s.text!=a.text){for(let l=0;s.text[l]==a.text[l];l++)n++;return n}if(s.content.size||a.content.size){let l=nN(s.content,a.content,n+1);if(l!=null)return l}n+=s.nodeSize}}function rN(t,e,n,r){for(let s=t.childCount,a=e.childCount;;){if(s==0||a==0)return s==a?null:{a:n,b:r};let l=t.child(--s),c=e.child(--a),d=l.nodeSize;if(l==c){n-=d,r-=d;continue}if(!l.sameMarkup(c))return{a:n,b:r};if(l.isText&&l.text!=c.text){let p=0,m=Math.min(l.text.length,c.text.length);for(;p<m&&l.text[l.text.length-p-1]==c.text[c.text.length-p-1];)p++,n--,r--;return{a:n,b:r}}if(l.content.size||c.content.size){let p=rN(l.content,c.content,n-1,r-1);if(p)return p}n-=d,r-=d}}class fe{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,a){for(let l=0,c=0;c<n;l++){let d=this.content[l],p=c+d.nodeSize;if(p>e&&r(d,s+c,a||null,l)!==!1&&d.content.size){let m=c+1;d.nodesBetween(Math.max(0,e-m),Math.min(d.content.size,n-m),r,s+m)}c=p}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let a="",l=!0;return this.nodesBetween(e,n,(c,d)=>{let p=c.isText?c.text.slice(Math.max(e,d)-d,n-d):c.isLeaf?s?typeof s=="function"?s(c):s:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&p||c.isTextblock)&&r&&(l?l=!1:a+=r),a+=p},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),a=1);a<e.content.length;a++)s.push(e.content[a]);return new fe(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let a=0,l=0;l<n;a++){let c=this.content[a],d=l+c.nodeSize;d>e&&((l<e||d>n)&&(c.isText?c=c.cut(Math.max(0,e-l),Math.min(c.text.length,n-l)):c=c.cut(Math.max(0,e-l-1),Math.min(c.content.size,n-l-1))),r.push(c),s+=c.nodeSize),l=d}return new fe(r,s)}cutByIndex(e,n){return e==n?fe.empty:e==0&&n==this.content.length?this:new fe(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),a=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new fe(s,a)}addToStart(e){return new fe([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new fe(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return nN(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return rN(this,e,n,r)}findIndex(e){if(e==0)return qd(0,e);if(e==this.size)return qd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),a=r+s.nodeSize;if(a>=e)return a==e?qd(n+1,a):qd(n,r);r=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return fe.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new fe(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return fe.empty;let n,r=0;for(let s=0;s<e.length;s++){let a=e[s];r+=a.nodeSize,s&&a.isText&&e[s-1].sameMarkup(a)?(n||(n=e.slice(0,s)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new fe(n||e,r)}static from(e){if(!e)return fe.empty;if(e instanceof fe)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new fe([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}fe.empty=new fe([],0);const $g={index:0,offset:0};function qd(t,e){return $g.index=t,$g.offset=e,$g}function Ff(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Ff(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Ff(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Et=class ix{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let a=e[s];if(this.eq(a))return e;if(this.type.excludes(a.type))n||(n=e.slice(0,s));else{if(a.type.excludes(this.type))return e;!r&&a.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(a)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ff(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ix.none;if(e instanceof ix)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};Et.none=[];class Uf extends Error{}class Ee{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=iN(this.content,e+this.openStart,n);return r&&new Ee(r,this.openStart,this.openEnd)}removeBetween(e,n){return new Ee(sN(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return Ee.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ee(fe.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let a=e.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=e.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)s++;return new Ee(e,r,s)}}Ee.empty=new Ee(fe.empty,0,0);function sN(t,e,n){let{index:r,offset:s}=t.findIndex(e),a=t.maybeChild(r),{index:l,offset:c}=t.findIndex(n);if(s==e||a.isText){if(c!=n&&!t.child(l).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=l)throw new RangeError("Removing non-flat range");return t.replaceChild(r,a.copy(sN(a.content,e-s-1,n-s-1)))}function iN(t,e,n,r){let{index:s,offset:a}=t.findIndex(e),l=t.maybeChild(s);if(a==e||l.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let c=iN(l.content,e-a-1,n,l);return c&&t.replaceChild(s,l.copy(c))}function ED(t,e,n){if(n.openStart>t.depth)throw new Uf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Uf("Inconsistent open depths");return aN(t,e,n,0)}function aN(t,e,n,r){let s=t.index(r),a=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let l=aN(t,e,n,r+1);return a.copy(a.content.replaceChild(s,l))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let l=t.parent,c=l.content;return Ua(l,c.cut(0,t.parentOffset).append(n.content).append(c.cut(e.parentOffset)))}else{let{start:l,end:c}=ND(n,t);return Ua(a,lN(t,l,c,e,r))}else return Ua(a,$f(t,e,r))}function oN(t,e){if(!e.type.compatibleContent(t.type))throw new Uf("Cannot join "+e.type.name+" onto "+t.type.name)}function ax(t,e,n){let r=t.node(n);return oN(r,e.node(n)),r}function Fa(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Dc(t,e,n,r){let s=(e||t).node(n),a=0,l=e?e.index(n):s.childCount;t&&(a=t.index(n),t.depth>n?a++:t.textOffset&&(Fa(t.nodeAfter,r),a++));for(let c=a;c<l;c++)Fa(s.child(c),r);e&&e.depth==n&&e.textOffset&&Fa(e.nodeBefore,r)}function Ua(t,e){return t.type.checkContent(e),t.copy(e)}function lN(t,e,n,r,s){let a=t.depth>s&&ax(t,e,s+1),l=r.depth>s&&ax(n,r,s+1),c=[];return Dc(null,t,s,c),a&&l&&e.index(s)==n.index(s)?(oN(a,l),Fa(Ua(a,lN(t,e,n,r,s+1)),c)):(a&&Fa(Ua(a,$f(t,e,s+1)),c),Dc(e,n,s,c),l&&Fa(Ua(l,$f(n,r,s+1)),c)),Dc(r,null,s,c),new fe(c)}function $f(t,e,n){let r=[];if(Dc(null,t,n,r),t.depth>n){let s=ax(t,e,n+1);Fa(Ua(s,$f(t,e,n+1)),r)}return Dc(e,null,n,r),new fe(r)}function ND(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let a=n-1;a>=0;a--)s=e.node(a).copy(fe.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Zc{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let a=0;a<e;a++)s+=r.child(a).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Et.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let c=r;r=s,s=c}let a=r.marks;for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!s||!a[l].isInSet(s.marks))&&(a=a[l--].removeFromSet(a));return a}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!s||!r[a].isInSet(s.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Vf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,a=n;for(let l=e;;){let{index:c,offset:d}=l.content.findIndex(a),p=a-d;if(r.push(l,c,s+d),!p||(l=l.child(c),l.isText))break;a=p-1,s+=d+1}return new Zc(n,r,a)}static resolveCached(e,n){let r=Y2.get(e);if(r)for(let a=0;a<r.elts.length;a++){let l=r.elts[a];if(l.pos==n)return l}else Y2.set(e,r=new TD);let s=r.elts[r.i]=Zc.resolve(e,n);return r.i=(r.i+1)%AD,s}}class TD{constructor(){this.elts=[],this.i=0}}const AD=12,Y2=new WeakMap;class Vf{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const MD=Object.create(null);class $r{constructor(e,n,r,s=Et.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||fe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Ff(this.attrs,n||e.defaultAttrs||MD)&&Et.sameSet(this.marks,r||Et.none)}copy(e=null){return e==this.content?this:new $r(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new $r(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return Ee.empty;let s=this.resolve(e),a=this.resolve(n),l=r?0:s.sharedDepth(n),c=s.start(l),p=s.node(l).content.cut(s.pos-c,a.pos-c);return new Ee(p,s.depth-l,a.depth-l)}replace(e,n,r){return ED(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Zc.resolveCached(this,e)}resolveNoCache(e){return Zc.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,a=>(r.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),cN(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=fe.empty,s=0,a=r.childCount){let l=this.contentMatchAt(e).matchFragment(r,s,a),c=l&&l.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(let d=s;d<a;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(e).matchType(r),l=a&&a.matchFragment(this.content,n);return l?l.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Et.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Et.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=fe.fromJSON(e,n.content),a=e.nodeType(n.type).create(n.attrs,s,r);return a.type.checkAttrs(a.attrs),a}}$r.prototype.text=void 0;class qf extends $r{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):cN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new qf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new qf(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function cN(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Ga{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new jD(e,n);if(r.next==null)return Ga.empty;let s=uN(r);r.next&&r.err("Unexpected trailing text");let a=zD(ID(s));return BD(a,r),a}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let a=n;s&&a<r;a++)s=s.matchType(e.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function a(l,c){let d=l.matchFragment(e,r);if(d&&(!n||d.validEnd))return fe.from(c.map(p=>p.createAndFill()));for(let p=0;p<l.next.length;p++){let{type:m,next:g}=l.next[p];if(!(m.isText||m.hasRequiredAttrs())&&s.indexOf(g)==-1){s.push(g);let b=a(g,c.concat(m));if(b)return b}}return null}return a(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),a=s.match;if(a.matchType(e)){let l=[];for(let c=s;c.type;c=c.via)l.push(c.type);return l.reverse()}for(let l=0;l<a.next.length;l++){let{type:c,next:d}=a.next[l];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in n)&&(!s.type||d.validEnd)&&(r.push({match:c.contentMatch,type:c,via:s}),n[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let a=s+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)a+=(l?", ":"")+r.next[l].type.name+"->"+e.indexOf(r.next[l].next);return a}).join(`
`)}}Ga.empty=new Ga(!0);class jD{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function uN(t){let e=[];do e.push(OD(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function OD(t){let e=[];do e.push(_D(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function _D(t){let e=LD(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=RD(t,e);else break;return e}function J2(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function RD(t,e){let n=J2(t),r=n;return t.eat(",")&&(t.next!="}"?r=J2(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function DD(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let a in n){let l=n[a];l.isInGroup(e)&&s.push(l)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function LD(t){if(t.eat("(")){let e=uN(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=DD(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function ID(t){let e=[[]];return s(a(t,0),n()),e;function n(){return e.push([])-1}function r(l,c,d){let p={term:d,to:c};return e[l].push(p),p}function s(l,c){l.forEach(d=>d.to=c)}function a(l,c){if(l.type=="choice")return l.exprs.reduce((d,p)=>d.concat(a(p,c)),[]);if(l.type=="seq")for(let d=0;;d++){let p=a(l.exprs[d],c);if(d==l.exprs.length-1)return p;s(p,c=n())}else if(l.type=="star"){let d=n();return r(c,d),s(a(l.expr,d),d),[r(d)]}else if(l.type=="plus"){let d=n();return s(a(l.expr,c),d),s(a(l.expr,d),d),[r(d)]}else{if(l.type=="opt")return[r(c)].concat(a(l.expr,c));if(l.type=="range"){let d=c;for(let p=0;p<l.min;p++){let m=n();s(a(l.expr,d),m),d=m}if(l.max==-1)s(a(l.expr,d),d);else for(let p=l.min;p<l.max;p++){let m=n();r(d,m),s(a(l.expr,d),m),d=m}return[r(d)]}else{if(l.type=="name")return[r(c,void 0,l.value)];throw new Error("Unknown expr type")}}}}function dN(t,e){return e-t}function X2(t,e){let n=[];return r(e),n.sort(dN);function r(s){let a=t[s];if(a.length==1&&!a[0].term)return r(a[0].to);n.push(s);for(let l=0;l<a.length;l++){let{term:c,to:d}=a[l];!c&&n.indexOf(d)==-1&&r(d)}}}function zD(t){let e=Object.create(null);return n(X2(t,0));function n(r){let s=[];r.forEach(l=>{t[l].forEach(({term:c,to:d})=>{if(!c)return;let p;for(let m=0;m<s.length;m++)s[m][0]==c&&(p=s[m][1]);X2(t,d).forEach(m=>{p||s.push([c,p=[]]),p.indexOf(m)==-1&&p.push(m)})})});let a=e[r.join(",")]=new Ga(r.indexOf(t.length-1)>-1);for(let l=0;l<s.length;l++){let c=s[l][1].sort(dN);a.next.push({type:s[l][0],next:e[c.join(",")]||n(c)})}return a}}function BD(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],a=!s.validEnd,l=[];for(let c=0;c<s.next.length;c++){let{type:d,next:p}=s.next[c];l.push(d.name),a&&!(d.isText||d.hasRequiredAttrs())&&(a=!1),r.indexOf(p)==-1&&r.push(p)}a&&e.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function fN(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function hN(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let a=t[r];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function pN(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let a=t[s];a.validate&&a.validate(e[s])}}function mN(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new HD(t,r,e[r]);return n}let Q2=class gN{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=mN(e,r.attrs),this.defaultAttrs=fN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ga.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:hN(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new $r(this,this.computeAttrs(e),fe.from(n),Et.setFrom(r))}createChecked(e=null,n,r){return n=fe.from(n),this.checkContent(n),new $r(this,this.computeAttrs(e),n,Et.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=fe.from(n),n.size){let l=this.contentMatch.fillBefore(n);if(!l)return null;n=l.append(n)}let s=this.contentMatch.matchFragment(n),a=s&&s.fillBefore(fe.empty,!0);return a?new $r(this,e,n.append(a),Et.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){pN(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Et.none:e}static compile(e,n){let r=Object.create(null);e.forEach((a,l)=>r[a]=new gN(a,n,l));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function PD(t,e,n){let r=n.split("|");return s=>{let a=s===null?"null":typeof s;if(r.indexOf(a)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${a}`)}}class HD{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?PD(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Qh{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=mN(e,s.attrs),this.excluded=null;let a=fN(this.attrs);this.instance=a?new Et(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Et(this,hN(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((a,l)=>r[a]=new Qh(a,s++,n,l)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){pN(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class xN{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=An.from(e.nodes),n.marks=An.from(e.marks||{}),this.nodes=Q2.compile(this.spec.nodes,this),this.marks=Qh.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],l=a.spec.content||"",c=a.spec.marks;if(a.contentMatch=r[l]||(r[l]=Ga.parse(l,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=c=="_"?null:c?Z2(this,c.split(" ")):c==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],l=a.spec.excludes;a.excluded=l==null?[a]:l==""?[]:Z2(this,l.split(" "))}this.nodeFromJSON=s=>$r.fromJSON(this,s),this.markFromJSON=s=>Et.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Q2){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new qf(r,r.defaultAttrs,e,Et.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Z2(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],a=t.marks[s],l=a;if(a)n.push(a);else for(let c in t.marks){let d=t.marks[c];(s=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(s)>-1)&&n.push(l=d)}if(!l)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function FD(t){return t.tag!=null}function UD(t){return t.style!=null}let Lc=class ox{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(FD(s))this.tags.push(s);else if(UD(s)){let a=/[^=]*/.exec(s.style)[0];r.indexOf(a)<0&&r.push(a),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let a=e.nodes[s.node];return a.contentMatch.matchType(a)})}parse(e,n={}){let r=new tk(this,n,!1);return r.addAll(e,Et.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new tk(this,n,!0);return r.addAll(e,Et.none,n.from,n.to),Ee.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(qD(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){let l=a.getAttrs(e);if(l===!1)continue;a.attrs=l||void 0}return a}}}matchStyle(e,n,r,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let l=this.styles[a],c=l.style;if(!(c.indexOf(e)!=0||l.context&&!r.matchesContext(l.context)||c.length>e.length&&(c.charCodeAt(e.length)!=61||c.slice(e.length+1)!=n))){if(l.getAttrs){let d=l.getAttrs(n);if(d===!1)continue;l.attrs=d||void 0}return l}}}static schemaRules(e){let n=[];function r(s){let a=s.priority==null?50:s.priority,l=0;for(;l<n.length;l++){let c=n[l];if((c.priority==null?50:c.priority)<a)break}n.splice(l,0,s)}for(let s in e.marks){let a=e.marks[s].spec.parseDOM;a&&a.forEach(l=>{r(l=nk(l)),l.mark||l.ignore||l.clearMark||(l.mark=s)})}for(let s in e.nodes){let a=e.nodes[s].spec.parseDOM;a&&a.forEach(l=>{r(l=nk(l)),l.node||l.ignore||l.mark||(l.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ox(e,ox.schemaRules(e)))}};const bN={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},$D={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},yN={ol:!0,ul:!0},eu=1,lx=2,Ic=4;function ek(t,e,n){return e!=null?(e?eu:0)|(e==="full"?lx:0):t&&t.whitespace=="pre"?eu|lx:n&~Ic}class Wd{constructor(e,n,r,s,a,l){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=l,this.content=[],this.activeMarks=Et.none,this.match=a||(l&Ic?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(fe.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&eu)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let n=fe.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(fe.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!bN.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class tk{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,a,l=ek(null,n.preserveWhitespace,0)|(r?Ic:0);s?a=new Wd(s.type,s.attrs,Et.none,!0,n.topMatch||s.type.contentMatch,l):r?a=new Wd(null,null,Et.none,!0,null,l):a=new Wd(e.schema.topNodeType,null,Et.none,!0,null,l),this.nodes=[a],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,a=s.options&lx?"full":this.localPreserveWS||(s.options&eu)>0,{schema:l}=this.parser;if(a==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(a)if(a==="full")r=r.replace(/\r\n?/g,`
`);else if(l.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(l.linebreakReplacement.create())){let c=r.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(l.linebreakReplacement.create(),n,!0),c[d]&&this.insertNode(l.text(c[d]),n,!/\S/.test(c[d]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let c=s.content[s.content.length-1],d=e.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(r=r.slice(1))}r&&this.insertNode(l.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let l=e.nodeName.toLowerCase(),c;yN.hasOwnProperty(l)&&this.parser.normalizeLists&&VD(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(c=this.parser.matchTag(e,this,r));e:if(d?d.ignore:$D.hasOwnProperty(l))this.findInside(e),this.ignoreFallback(e,n);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let p,m=this.needsBlock;if(bN.hasOwnProperty(l))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),p=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let g=d&&d.skip?n:this.readStyles(e,n);g&&this.addAll(e,g),p&&this.sync(a),this.needsBlock=m}else{let p=this.readStyles(e,n);p&&this.addElementByRule(e,d,p,d.consuming===!1?c:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let a=this.parser.matchedStyles[s],l=r.getPropertyValue(a);if(l)for(let c=void 0;;){let d=this.parser.matchStyle(a,l,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?n=n.filter(p=>!d.clearMark(p)):n=n.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return n}addElementByRule(e,n,r,s){let a,l;if(n.node)if(l=this.parser.schema.nodes[n.node],l.isLeaf)this.insertNode(l.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let d=this.enter(l,n.attrs||null,r,n.preserveWhitespace);d&&(a=!0,r=d)}else{let d=this.parser.schema.marks[n.mark];r=r.concat(d.create(n.attrs))}let c=this.top;if(l&&l.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=e;typeof n.contentElement=="string"?d=e.querySelector(n.contentElement):typeof n.contentElement=="function"?d=n.contentElement(e):n.contentElement&&(d=n.contentElement),this.findAround(e,d,!0),this.addAll(d,r),this.findAround(e,d,!1)}a&&this.sync(c)&&this.open--}addAll(e,n,r,s){let a=r||0;for(let l=r?e.childNodes[r]:e.firstChild,c=s==null?null:e.childNodes[s];l!=c;l=l.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(l,n);this.findAtPoint(e,a)}findPlace(e,n,r){let s,a;for(let l=this.open,c=0;l>=0;l--){let d=this.nodes[l],p=d.findWrapping(e);if(p&&(!s||s.length>p.length+c)&&(s=p,a=d,!p.length))break;if(d.solid){if(r)break;c+=2}}if(!s)return null;this.sync(a);for(let l=0;l<s.length;l++)n=this.enterInner(s[l],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(n=this.enterInner(a,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let l=Et.none;for(let c of s.concat(e.marks))(a.type?a.type.allowsMarkType(c.type):rk(c.type,e.type))&&(l=c.addToSet(l));return a.content.push(e.mark(l)),!0}return!1}enter(e,n,r,s){let a=this.findPlace(e.create(n),r,!1);return a&&(a=this.enterInner(e,n,r,!0,s)),a}enterInner(e,n,r,s=!1,a){this.closeExtra();let l=this.top;l.match=l.match&&l.match.matchType(e);let c=ek(e,a,l.options);l.options&Ic&&l.content.length==0&&(c|=Ic);let d=Et.none;return r=r.filter(p=>(l.type?l.type.allowsMarkType(p.type):rk(p.type,e))?(d=p.addToSet(d),!1):!0),this.nodes.push(new Wd(e,n,d,s,null,c)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=eu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(s?0:1),l=(c,d)=>{for(;c>=0;c--){let p=n[c];if(p==""){if(c==n.length-1||c==0)continue;for(;d>=a;d--)if(l(c-1,d))return!0;return!1}else{let m=d>0||d==0&&s?this.nodes[d].type:r&&d>=a?r.node(d-a).type:null;if(!m||m.name!=p&&!m.isInGroup(p))return!1;d--}}return!0};return l(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function VD(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&yN.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function qD(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function nk(t){let e={};for(let n in t)e[n]=t[n];return e}function rk(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let a=[],l=c=>{a.push(c);for(let d=0;d<c.edgeCount;d++){let{type:p,next:m}=c.edge(d);if(p==e||a.indexOf(m)<0&&l(m))return!0}};if(l(s.contentMatch))return!0}}class to{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Vg(n).createDocumentFragment());let s=r,a=[];return e.forEach(l=>{if(a.length||l.marks.length){let c=0,d=0;for(;c<a.length&&d<l.marks.length;){let p=l.marks[d];if(!this.marks[p.type.name]){d++;continue}if(!p.eq(a[c][0])||p.type.spec.spanning===!1)break;c++,d++}for(;c<a.length;)s=a.pop()[1];for(;d<l.marks.length;){let p=l.marks[d++],m=this.serializeMark(p,l.isInline,n);m&&(a.push([p,s]),s.appendChild(m.dom),s=m.contentDOM||m.dom)}}s.appendChild(this.serializeNodeInner(l,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=gf(Vg(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let a=this.serializeMark(e.marks[s],e.isInline,n);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&gf(Vg(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return gf(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new to(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=sk(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return sk(e.marks)}}function sk(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Vg(t){return t.document||window.document}const ik=new WeakMap;function WD(t){let e=ik.get(t);return e===void 0&&ik.set(t,e=GD(t)),e}function GD(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function gf(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],a;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(a=WD(r))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=s.indexOf(" ");l>0&&(n=s.slice(0,l),s=s.slice(l+1));let c,d=n?t.createElementNS(n,s):t.createElement(s),p=e[1],m=1;if(p&&typeof p=="object"&&p.nodeType==null&&!Array.isArray(p)){m=2;for(let g in p)if(p[g]!=null){let b=g.indexOf(" ");b>0?d.setAttributeNS(g.slice(0,b),g.slice(b+1),p[g]):g=="style"&&d.style?d.style.cssText=p[g]:d.setAttribute(g,p[g])}}for(let g=m;g<e.length;g++){let b=e[g];if(b===0){if(g<e.length-1||g>m)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:v,contentDOM:w}=gf(t,b,n,r);if(d.appendChild(v),w){if(c)throw new RangeError("Multiple content holes");c=w}}}return{dom:d,contentDOM:c}}const vN=65535,wN=Math.pow(2,16);function KD(t,e){return t+e*wN}function ak(t){return t&vN}function YD(t){return(t-(t&vN))/wN}const kN=1,CN=2,xf=4,SN=8;class cx{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&SN)>0}get deletedBefore(){return(this.delInfo&(kN|xf))>0}get deletedAfter(){return(this.delInfo&(CN|xf))>0}get deletedAcross(){return(this.delInfo&xf)>0}}class gr{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&gr.empty)return gr.empty}recover(e){let n=0,r=ak(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+YD(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?s:0);if(d>e)break;let p=this.ranges[c+a],m=this.ranges[c+l],g=d+p;if(e<=g){let b=p?e==d?-1:e==g?1:n:n,v=d+s+(b<0?0:m);if(r)return v;let w=e==(n<0?d:g)?null:KD(c/3,e-d),C=e==d?CN:e==g?kN:xf;return(n<0?e!=d:e!=g)&&(C|=SN),new cx(v,C,w)}s+=m-p}return r?e+s:new cx(e+s,0,null)}touches(e,n){let r=0,s=ak(n),a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?r:0);if(d>e)break;let p=this.ranges[c+a],m=d+p;if(e<=m&&c==s*3)return!0;r+=this.ranges[c+l]-p}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let l=this.ranges[s],c=l-(this.inverted?a:0),d=l+(this.inverted?0:a),p=this.ranges[s+n],m=this.ranges[s+r];e(c,c+p,d,d+m),a+=m-p}}invert(){return new gr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?gr.empty:new gr(e<0?[0,-e,0]:[0,0,e])}}gr.empty=new gr([]);class tu{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new tu(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new tu;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let a=this.from;a<this.to;a++){let l=this._maps[a],c=l.mapResult(e,n);if(c.recover!=null){let d=this.getMirror(a);if(d!=null&&d>a&&d<this.to){a=d,e=this._maps[d].recover(c.recover);continue}}s|=c.delInfo,e=c.pos}return r?e:new cx(e,s,null)}}const qg=Object.create(null);class Bn{getMap(){return gr.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=qg[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in qg)throw new RangeError("Duplicate use of step JSON ID "+e);return qg[e]=n,n.prototype.jsonID=e,n}}class rn{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new rn(e,null)}static fail(e){return new rn(null,e)}static fromReplace(e,n,r,s){try{return rn.ok(e.replace(n,r,s))}catch(a){if(a instanceof Uf)return rn.fail(a.message);throw a}}}function gb(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let a=t.child(s);a.content.size&&(a=a.copy(gb(a.content,e,a))),a.isInline&&(a=e(a,n,s)),r.push(a)}return fe.fromArray(r)}class $i extends Bn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),a=new Ee(gb(n.content,(l,c)=>!l.isAtom||!c.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),s),n.openStart,n.openEnd);return rn.fromReplace(e,this.from,this.to,a)}invert(){return new Fr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new $i(n.pos,r.pos,this.mark)}merge(e){return e instanceof $i&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $i(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $i(n.from,n.to,e.markFromJSON(n.mark))}}Bn.jsonID("addMark",$i);class Fr extends Bn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new Ee(gb(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return rn.fromReplace(e,this.from,this.to,r)}invert(){return new $i(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Fr(n.pos,r.pos,this.mark)}merge(e){return e instanceof Fr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Fr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Fr(n.from,n.to,e.markFromJSON(n.mark))}}Bn.jsonID("removeMark",Fr);class Vi extends Bn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return rn.fromReplace(e,this.pos,this.pos+1,new Ee(fe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new Vi(this.pos,n.marks[s]);return new Vi(this.pos,this.mark)}}return new Ka(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Vi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Vi(n.pos,e.markFromJSON(n.mark))}}Bn.jsonID("addNodeMark",Vi);class Ka extends Bn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return rn.fromReplace(e,this.pos,this.pos+1,new Ee(fe.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Vi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ka(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ka(n.pos,e.markFromJSON(n.mark))}}Bn.jsonID("removeNodeMark",Ka);class bn extends Bn{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&ux(e,this.from,this.to)?rn.fail("Structure replace would overwrite content"):rn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new gr([this.from,this.to-this.from,this.slice.size])}invert(e){return new bn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new bn(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof bn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?Ee.empty:new Ee(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new bn(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?Ee.empty:new Ee(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new bn(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new bn(n.from,n.to,Ee.fromJSON(e,n.slice),!!n.structure)}}Bn.jsonID("replace",bn);class vn extends Bn{constructor(e,n,r,s,a,l,c=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=a,this.insert=l,this.structure=c}apply(e){if(this.structure&&(ux(e,this.from,this.gapFrom)||ux(e,this.gapTo,this.to)))return rn.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return rn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?rn.fromReplace(e,this.from,this.to,r):rn.fail("Content does not fit in gap")}getMap(){return new gr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new vn(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||a>r.pos?null:new vn(n.pos,r.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new vn(n.from,n.to,n.gapFrom,n.gapTo,Ee.fromJSON(e,n.slice),n.insert,!!n.structure)}}Bn.jsonID("replaceAround",vn);function ux(t,e,n){let r=t.resolve(e),s=n-e,a=r.depth;for(;s>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,s--;if(s>0){let l=r.node(a).maybeChild(r.indexAfter(a));for(;s>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,s--}}return!1}function JD(t,e,n,r){let s=[],a=[],l,c;t.doc.nodesBetween(e,n,(d,p,m)=>{if(!d.isInline)return;let g=d.marks;if(!r.isInSet(g)&&m.type.allowsMarkType(r.type)){let b=Math.max(p,e),v=Math.min(p+d.nodeSize,n),w=r.addToSet(g);for(let C=0;C<g.length;C++)g[C].isInSet(w)||(l&&l.to==b&&l.mark.eq(g[C])?l.to=v:s.push(l=new Fr(b,v,g[C])));c&&c.to==b?c.to=v:a.push(c=new $i(b,v,r))}}),s.forEach(d=>t.step(d)),a.forEach(d=>t.step(d))}function XD(t,e,n,r){let s=[],a=0;t.doc.nodesBetween(e,n,(l,c)=>{if(!l.isInline)return;a++;let d=null;if(r instanceof Qh){let p=l.marks,m;for(;m=r.isInSet(p);)(d||(d=[])).push(m),p=m.removeFromSet(p)}else r?r.isInSet(l.marks)&&(d=[r]):d=l.marks;if(d&&d.length){let p=Math.min(c+l.nodeSize,n);for(let m=0;m<d.length;m++){let g=d[m],b;for(let v=0;v<s.length;v++){let w=s[v];w.step==a-1&&g.eq(s[v].style)&&(b=w)}b?(b.to=p,b.step=a):s.push({style:g,from:Math.max(c,e),to:p,step:a})}}}),s.forEach(l=>t.step(new Fr(l.from,l.to,l.style)))}function xb(t,e,n,r=n.contentMatch,s=!0){let a=t.doc.nodeAt(e),l=[],c=e+1;for(let d=0;d<a.childCount;d++){let p=a.child(d),m=c+p.nodeSize,g=r.matchType(p.type);if(!g)l.push(new bn(c,m,Ee.empty));else{r=g;for(let b=0;b<p.marks.length;b++)n.allowsMarkType(p.marks[b].type)||t.step(new Fr(c,m,p.marks[b]));if(s&&p.isText&&n.whitespace!="pre"){let b,v=/\r?\n|\r/g,w;for(;b=v.exec(p.text);)w||(w=new Ee(fe.from(n.schema.text(" ",n.allowedMarks(p.marks))),0,0)),l.push(new bn(c+b.index,c+b.index+b[0].length,w))}}c=m}if(!r.validEnd){let d=r.fillBefore(fe.empty,!0);t.replace(c,c,new Ee(d,0,0))}for(let d=l.length-1;d>=0;d--)t.step(l[d])}function QD(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function wl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,a=0;;--r){let l=t.$from.node(r),c=t.$from.index(r)+s,d=t.$to.indexAfter(r)-a;if(r<t.depth&&l.canReplace(c,d,n))return r;if(r==0||l.type.spec.isolating||!QD(l,c,d))break;c&&(s=1),d<l.childCount&&(a=1)}return null}function ZD(t,e,n){let{$from:r,$to:s,depth:a}=e,l=r.before(a+1),c=s.after(a+1),d=l,p=c,m=fe.empty,g=0;for(let w=a,C=!1;w>n;w--)C||r.index(w)>0?(C=!0,m=fe.from(r.node(w).copy(m)),g++):d--;let b=fe.empty,v=0;for(let w=a,C=!1;w>n;w--)C||s.after(w+1)<s.end(w)?(C=!0,b=fe.from(s.node(w).copy(b)),v++):p++;t.step(new vn(d,p,l,c,new Ee(m.append(b),g,v),m.size-g,!0))}function bb(t,e,n=null,r=t){let s=eL(t,e),a=s&&tL(r,e);return a?s.map(ok).concat({type:e,attrs:n}).concat(a.map(ok)):null}function ok(t){return{type:t,attrs:null}}function eL(t,e){let{parent:n,startIndex:r,endIndex:s}=t,a=n.contentMatchAt(r).findWrapping(e);if(!a)return null;let l=a.length?a[0]:e;return n.canReplaceWith(r,s,l)?a:null}function tL(t,e){let{parent:n,startIndex:r,endIndex:s}=t,a=n.child(r),l=e.contentMatch.findWrapping(a.type);if(!l)return null;let d=(l.length?l[l.length-1]:e).contentMatch;for(let p=r;d&&p<s;p++)d=d.matchType(n.child(p).type);return!d||!d.validEnd?null:l}function nL(t,e,n){let r=fe.empty;for(let l=n.length-1;l>=0;l--){if(r.size){let c=n[l].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=fe.from(n[l].type.create(n[l].attrs,r))}let s=e.start,a=e.end;t.step(new vn(s,a,s,a,new Ee(r,0,0),n.length,!0))}function rL(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,n,(l,c)=>{let d=typeof s=="function"?s(l):s;if(l.isTextblock&&!l.hasMarkup(r,d)&&sL(t.doc,t.mapping.slice(a).map(c),r)){let p=null;if(r.schema.linebreakReplacement){let v=r.whitespace=="pre",w=!!r.contentMatch.matchType(r.schema.linebreakReplacement);v&&!w?p=!1:!v&&w&&(p=!0)}p===!1&&NN(t,l,c,a),xb(t,t.mapping.slice(a).map(c,1),r,void 0,p===null);let m=t.mapping.slice(a),g=m.map(c,1),b=m.map(c+l.nodeSize,1);return t.step(new vn(g,b,g+1,b-1,new Ee(fe.from(r.create(d,null,l.marks)),0,0),1,!0)),p===!0&&EN(t,l,c,a),!1}})}function EN(t,e,n,r){e.forEach((s,a)=>{if(s.isText){let l,c=/\r?\n|\r/g;for(;l=c.exec(s.text);){let d=t.mapping.slice(r).map(n+1+a+l.index);t.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function NN(t,e,n,r){e.forEach((s,a)=>{if(s.type==s.type.schema.linebreakReplacement){let l=t.mapping.slice(r).map(n+1+a);t.replaceWith(l,l+1,e.type.schema.text(`
`))}})}function sL(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function iL(t,e,n,r,s){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");n||(n=a.type);let l=n.create(r,null,s||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,l);if(!n.validContent(a.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new vn(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new Ee(fe.from(l),0,0),1,!0))}function Gs(t,e,n=1,r){let s=t.resolve(e),a=s.depth-n,l=r&&r[r.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!l.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let p=s.depth-1,m=n-2;p>a;p--,m--){let g=s.node(p),b=s.index(p);if(g.type.spec.isolating)return!1;let v=g.content.cutByIndex(b,g.childCount),w=r&&r[m+1];w&&(v=v.replaceChild(0,w.type.create(w.attrs)));let C=r&&r[m]||g;if(!g.canReplace(b+1,g.childCount)||!C.type.validContent(v))return!1}let c=s.indexAfter(a),d=r&&r[0];return s.node(a).canReplaceWith(c,c,d?d.type:s.node(a+1).type)}function aL(t,e,n=1,r){let s=t.doc.resolve(e),a=fe.empty,l=fe.empty;for(let c=s.depth,d=s.depth-n,p=n-1;c>d;c--,p--){a=fe.from(s.node(c).copy(a));let m=r&&r[p];l=fe.from(m?m.type.create(m.attrs,l):s.node(c).copy(l))}t.step(new bn(e,e,new Ee(a.append(l),n,n),!0))}function ta(t,e){let n=t.resolve(e),r=n.index();return TN(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function oL(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let a=e.child(s),l=a.type==r?t.type.schema.nodes.text:a.type;if(n=n.matchType(l),!n||!t.type.allowsMarks(a.marks))return!1}return n.validEnd}function TN(t,e){return!!(t&&e&&!t.isLeaf&&oL(t,e))}function Zh(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let a,l,c=r.index(s);if(s==r.depth?(a=r.nodeBefore,l=r.nodeAfter):n>0?(a=r.node(s+1),c++,l=r.node(s).maybeChild(c)):(a=r.node(s).maybeChild(c-1),l=r.node(s+1)),a&&!a.isTextblock&&TN(a,l)&&r.node(s).canReplace(c,c+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function lL(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,a=t.doc.resolve(e-n),l=a.node().type;if(s&&l.inlineContent){let m=l.whitespace=="pre",g=!!l.contentMatch.matchType(s);m&&!g?r=!1:!m&&g&&(r=!0)}let c=t.steps.length;if(r===!1){let m=t.doc.resolve(e+n);NN(t,m.node(),m.before(),c)}l.inlineContent&&xb(t,e+n-1,l,a.node().contentMatchAt(a.index()),r==null);let d=t.mapping.slice(c),p=d.map(e-n);if(t.step(new bn(p,d.map(e+n,-1),Ee.empty,!0)),r===!0){let m=t.doc.resolve(p);EN(t,m.node(),m.before(),t.steps.length)}return t}function cL(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let a=r.index(s);if(r.node(s).canReplaceWith(a,a,n))return r.before(s+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}return null}function AN(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let a=0;a<n.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(n.openStart==0&&n.size?2:1);a++)for(let l=r.depth;l>=0;l--){let c=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,d=r.index(l)+(c>0?1:0),p=r.node(l),m=!1;if(a==1)m=p.canReplace(d,d,s);else{let g=p.contentMatchAt(d).findWrapping(s.firstChild.type);m=g&&p.canReplaceWith(d,d,g[0])}if(m)return c==0?r.pos:c<0?r.before(l+1):r.after(l+1)}return null}function ep(t,e,n=e,r=Ee.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),a=t.resolve(n);return MN(s,a,r)?new bn(e,n,r):new uL(s,a,r).fit()}function MN(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class uL{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=fe.empty;for(let s=0;s<=e.depth;s++){let a=e.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=fe.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let p=this.findFittable();p?this.placeNodes(p):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let a=this.placed,l=r.depth,c=s.depth;for(;l&&c&&a.childCount==1;)a=a.firstChild.content,l--,c--;let d=new Ee(a,l,c);return e>-1?new vn(r.pos,e,this.$to.pos,this.$to.end(),d,n):d.size||r.pos!=this.$to.pos?new bn(r.pos,s.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let a=n.firstChild;if(n.childCount>1&&(s=0),a.type.spec.isolating&&s<=r){e=r;break}n=a.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,a=null;r?(a=Wg(this.unplaced.content,r-1).firstChild,s=a.content):s=this.unplaced.content;let l=s.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:p}=this.frontier[c],m,g=null;if(n==1&&(l?p.matchType(l.type)||(g=p.fillBefore(fe.from(l),!1)):a&&d.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:c,parent:a,inject:g};if(n==2&&l&&(m=p.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:c,parent:a,wrap:m};if(a&&p.matchType(a.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Wg(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Ee(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Wg(e,n);if(s.childCount<=1&&n>0){let a=e.size-n<=n+s.size;this.unplaced=new Ee(Ec(e,n-1,1),n-1,a?n-1:r)}else this.unplaced=new Ee(Ec(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:a}){for(;this.depth>n;)this.closeFrontierNode();if(a)for(let C=0;C<a.length;C++)this.openFrontierNode(a[C]);let l=this.unplaced,c=r?r.content:l.content,d=l.openStart-e,p=0,m=[],{match:g,type:b}=this.frontier[n];if(s){for(let C=0;C<s.childCount;C++)m.push(s.child(C));g=g.matchFragment(s)}let v=c.size+e-(l.content.size-l.openEnd);for(;p<c.childCount;){let C=c.child(p),k=g.matchType(C.type);if(!k)break;p++,(p>1||d==0||C.content.size)&&(g=k,m.push(jN(C.mark(b.allowedMarks(C.marks)),p==1?d:0,p==c.childCount?v:-1)))}let w=p==c.childCount;w||(v=-1),this.placed=Nc(this.placed,n,fe.from(m)),this.frontier[n].match=g,w&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let C=0,k=c;C<v;C++){let N=k.lastChild;this.frontier.push({type:N.type,match:N.contentMatchAt(N.childCount)}),k=N.content}this.unplaced=w?e==0?Ee.empty:new Ee(Ec(l.content,e-1,1),e-1,v<0?l.openEnd:e-1):new Ee(Ec(l.content,e,p),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Gg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],a=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),l=Gg(e,n,s,r,a);if(l){for(let c=n-1;c>=0;c--){let{match:d,type:p}=this.frontier[c],m=Gg(e,c,p,d,!0);if(!m||m.childCount)continue e}return{depth:n,fit:l,move:a?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Nc(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),a=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,a)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Nc(this.placed,this.depth,fe.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(fe.empty,!0);n.childCount&&(this.placed=Nc(this.placed,this.frontier.length,n))}}function Ec(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Ec(t.firstChild.content,e-1,n)))}function Nc(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Nc(t.lastChild.content,e-1,n)))}function Wg(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function jN(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,jN(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(fe.empty,!0)))),t.copy(r)}function Gg(t,e,n,r,s){let a=t.node(e),l=s?t.indexAfter(e):t.index(e);if(l==a.childCount&&!n.compatibleContent(a.type))return null;let c=r.fillBefore(a.content,!0,l);return c&&!dL(n,a.content,l)?c:null}function dL(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function fL(t){return t.spec.defining||t.spec.definingForContent}function hL(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),a=t.doc.resolve(n);if(MN(s,a,r))return t.step(new bn(e,n,r));let l=_N(s,a);l[l.length-1]==0&&l.pop();let c=-(s.depth+1);l.unshift(c);for(let b=s.depth,v=s.pos-1;b>0;b--,v--){let w=s.node(b).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;l.indexOf(b)>-1?c=b:s.before(b)==v&&l.splice(1,0,-b)}let d=l.indexOf(c),p=[],m=r.openStart;for(let b=r.content,v=0;;v++){let w=b.firstChild;if(p.push(w),v==r.openStart)break;b=w.content}for(let b=m-1;b>=0;b--){let v=p[b],w=fL(v.type);if(w&&!v.sameMarkup(s.node(Math.abs(c)-1)))m=b;else if(w||!v.type.isTextblock)break}for(let b=r.openStart;b>=0;b--){let v=(b+m+1)%(r.openStart+1),w=p[v];if(w)for(let C=0;C<l.length;C++){let k=l[(C+d)%l.length],N=!0;k<0&&(N=!1,k=-k);let M=s.node(k-1),_=s.index(k-1);if(M.canReplaceWith(_,_,w.type,w.marks))return t.replace(s.before(k),N?a.after(k):n,new Ee(ON(r.content,0,r.openStart,v),v,r.openEnd))}}let g=t.steps.length;for(let b=l.length-1;b>=0&&(t.replace(e,n,r),!(t.steps.length>g));b--){let v=l[b];v<0||(e=s.before(v),n=a.after(v))}}function ON(t,e,n,r,s){if(e<n){let a=t.firstChild;t=t.replaceChild(0,a.copy(ON(a.content,e+1,n,r,a)))}if(e>r){let a=s.contentMatchAt(0),l=a.fillBefore(t).append(t);t=l.append(a.matchFragment(l).fillBefore(fe.empty,!0))}return t}function pL(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=cL(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new Ee(fe.from(r),0,0))}function mL(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),a=_N(r,s);for(let l=0;l<a.length;l++){let c=a[l],d=l==a.length-1;if(d&&c==0||r.node(c).type.contentMatch.validEnd)return t.delete(r.start(c),s.end(c));if(c>0&&(d||r.node(c-1).canReplace(r.index(c-1),s.indexAfter(c-1))))return t.delete(r.before(c),s.after(c))}for(let l=1;l<=r.depth&&l<=s.depth;l++)if(e-r.start(l)==r.depth-l&&n>r.end(l)&&s.end(l)-n!=s.depth-l&&r.start(l-1)==s.start(l-1)&&r.node(l-1).canReplace(r.index(l-1),s.index(l-1)))return t.delete(r.before(l),n);t.delete(e,n)}function _N(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let a=t.start(s);if(a<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(a==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==a-1)&&n.push(s)}return n}class Yo extends Bn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return rn.fail("No node at attribute step's position");let r=Object.create(null);for(let a in n.attrs)r[a]=n.attrs[a];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return rn.fromReplace(e,this.pos,this.pos+1,new Ee(fe.from(s),0,n.isLeaf?0:1))}getMap(){return gr.empty}invert(e){return new Yo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Yo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Yo(n.pos,n.attr,n.value)}}Bn.jsonID("attr",Yo);class nu extends Bn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return rn.ok(r)}getMap(){return gr.empty}invert(e){return new nu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new nu(n.attr,n.value)}}Bn.jsonID("docAttr",nu);let ol=class extends Error{};ol=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};ol.prototype=Object.create(Error.prototype);ol.prototype.constructor=ol;ol.prototype.name="TransformError";class yb{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new tu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new ol(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let s=this.mapping.maps[r];r&&(e=s.map(e,1),n=s.map(n,-1)),s.forEach((a,l,c,d)=>{e=Math.min(e,c),n=Math.max(n,d)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=Ee.empty){let s=ep(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new Ee(fe.from(r),0,0))}delete(e,n){return this.replace(e,n,Ee.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return hL(this,e,n,r),this}replaceRangeWith(e,n,r){return pL(this,e,n,r),this}deleteRange(e,n){return mL(this,e,n),this}lift(e,n){return ZD(this,e,n),this}join(e,n=1){return lL(this,e,n),this}wrap(e,n){return nL(this,e,n),this}setBlockType(e,n=e,r,s=null){return rL(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return iL(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Yo(e,n,r)),this}setDocAttribute(e,n){return this.step(new nu(e,n)),this}addNodeMark(e,n){return this.step(new Vi(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Et)n.isInSet(r.marks)&&this.step(new Ka(e,n));else{let s=r.marks,a,l=[];for(;a=n.isInSet(s);)l.push(new Ka(e,a)),s=a.removeFromSet(s);for(let c=l.length-1;c>=0;c--)this.step(l[c])}return this}split(e,n=1,r){return aL(this,e,n,r),this}addMark(e,n,r){return JD(this,e,n,r),this}removeMark(e,n,r){return XD(this,e,n,r),this}clearIncompatible(e,n,r){return xb(this,e,n,r),this}}const Kg=Object.create(null);class Ve{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new RN(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=Ee.empty){let r=n.content.lastChild,s=null;for(let c=0;c<n.openEnd;c++)s=r,r=r.lastChild;let a=e.steps.length,l=this.ranges;for(let c=0;c<l.length;c++){let{$from:d,$to:p}=l[c],m=e.mapping.slice(a);e.replaceRange(m.map(d.pos),m.map(p.pos),c?Ee.empty:n),c==0&&uk(e,a,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=e.mapping.slice(r),p=d.map(l.pos),m=d.map(c.pos);a?e.deleteRange(p,m):(e.replaceRangeWith(p,m,n),uk(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new Be(e):Fo(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let a=e.depth-1;a>=0;a--){let l=n<0?Fo(e.node(0),e.node(a),e.before(a+1),e.index(a),n,r):Fo(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,n,r);if(l)return l}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new br(e.node(0))}static atStart(e){return Fo(e,e,0,0,1)||new br(e)}static atEnd(e){return Fo(e,e,e.content.size,e.childCount,-1)||new br(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Kg[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Kg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Kg[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Be.between(this.$anchor,this.$head).getBookmark()}}Ve.prototype.visible=!0;class RN{constructor(e,n){this.$from=e,this.$to=n}}let lk=!1;function ck(t){!lk&&!t.parent.inlineContent&&(lk=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Be extends Ve{constructor(e,n=e){ck(e),ck(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ve.near(r);let s=e.resolve(n.map(this.anchor));return new Be(s.parent.inlineContent?s:r,r)}replace(e,n=Ee.empty){if(super.replace(e,n),n==Ee.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Be&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new tp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Be(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let a=Ve.findFrom(n,r,!0)||Ve.findFrom(n,-r,!0);if(a)n=a.$head;else return Ve.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(Ve.findFrom(e,-r,!0)||Ve.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new Be(e,n)}}Ve.jsonID("text",Be);class tp{constructor(e,n){this.anchor=e,this.head=n}map(e){return new tp(e.map(this.anchor),e.map(this.head))}resolve(e){return Be.between(e.resolve(this.anchor),e.resolve(this.head))}}class ze extends Ve{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),a=e.resolve(s);return r?Ve.near(a):new ze(a)}content(){return new Ee(fe.from(this.node),0,0)}eq(e){return e instanceof ze&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new vb(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ze(e.resolve(n.anchor))}static create(e,n){return new ze(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ze.prototype.visible=!1;Ve.jsonID("node",ze);class vb{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new tp(r,r):new vb(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ze.isSelectable(r)?new ze(n):Ve.near(n)}}class br extends Ve{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=Ee.empty){if(n==Ee.empty){e.delete(0,e.doc.content.size);let r=Ve.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new br(e)}map(e){return new br(e)}eq(e){return e instanceof br}getBookmark(){return gL}}Ve.jsonID("all",br);const gL={map(){return this},resolve(t){return new br(t)}};function Fo(t,e,n,r,s,a=!1){if(e.inlineContent)return Be.create(t,n);for(let l=r-(s>0?0:1);s>0?l<e.childCount:l>=0;l+=s){let c=e.child(l);if(c.isAtom){if(!a&&ze.isSelectable(c))return ze.create(t,n-(s<0?c.nodeSize:0))}else{let d=Fo(t,c,n+s,s<0?c.childCount:0,s,a);if(d)return d}n+=c.nodeSize*s}return null}function uk(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof bn||s instanceof vn))return;let a=t.mapping.maps[r],l;a.forEach((c,d,p,m)=>{l==null&&(l=m)}),t.setSelection(Ve.near(t.doc.resolve(l),n))}const dk=1,Gd=2,fk=4;class xL extends yb{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|dk)&~Gd,this.storedMarks=null,this}get selectionSet(){return(this.updated&dk)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Gd,this}ensureMarks(e){return Et.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Gd)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Gd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Et.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let a=this.storedMarks;if(!a){let l=this.doc.resolve(n);a=r==n?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,a)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Ve.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=fk,this}get scrolledIntoView(){return(this.updated&fk)>0}}function hk(t,e){return!e||!t?t:t.bind(e)}class Tc{constructor(e,n,r){this.name=e,this.init=hk(n.init,r),this.apply=hk(n.apply,r)}}const bL=[new Tc("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Tc("selection",{init(t,e){return t.selection||Ve.atStart(e.doc)},apply(t){return t.selection}}),new Tc("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Tc("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Yg{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=bL.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Tc(r.key,r.spec.state,r))})}}class Wo{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let a=!1;for(let l=0;l<this.config.plugins.length;l++){let c=this.config.plugins[l];if(c.spec.appendTransaction){let d=s?s[l].n:0,p=s?s[l].state:this,m=d<n.length&&c.spec.appendTransaction.call(c,d?n.slice(d):n,p,r);if(m&&r.filterTransaction(m,l)){if(m.setMeta("appendedTransaction",e),!s){s=[];for(let g=0;g<this.config.plugins.length;g++)s.push(g<l?{state:r,n:n.length}:{state:this,n:0})}n.push(m),r=r.applyInner(m),a=!0}s&&(s[l]={state:r,n:n.length})}}if(!a)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Wo(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let a=r[s];n[a.name]=a.apply(e,this[a.name],this,n)}return n}get tr(){return new xL(this)}static create(e){let n=new Yg(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Wo(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new Yg(this.schema,e.plugins),r=n.fields,s=new Wo(n);for(let a=0;a<r.length;a++){let l=r[a].name;s[l]=this.hasOwnProperty(l)?this[l]:r[a].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],a=s.spec.state;a&&a.toJSON&&(n[r]=a.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Yg(e.schema,e.plugins),a=new Wo(s);return s.fields.forEach(l=>{if(l.name=="doc")a.doc=$r.fromJSON(e.schema,n.doc);else if(l.name=="selection")a.selection=Ve.fromJSON(a.doc,n.selection);else if(l.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let c in r){let d=r[c],p=d.spec.state;if(d.key==l.name&&p&&p.fromJSON&&Object.prototype.hasOwnProperty.call(n,c)){a[l.name]=p.fromJSON.call(d,e,n[c],a);return}}a[l.name]=l.init(e,a)}}),a}}function DN(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=DN(s,e,{})),n[r]=s}return n}class _t{constructor(e){this.spec=e,this.props={},e.props&&DN(e.props,this,this.props),this.key=e.key?e.key.key:LN("plugin")}getState(e){return e[this.key]}}const Jg=Object.create(null);function LN(t){return t in Jg?t+"$"+ ++Jg[t]:(Jg[t]=0,t+"$")}class Wt{constructor(e="key"){this.key=LN(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const wb=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function IN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const zN=(t,e,n)=>{let r=IN(t,n);if(!r)return!1;let s=kb(r);if(!s){let l=r.blockRange(),c=l&&wl(l);return c==null?!1:(e&&e(t.tr.lift(l,c).scrollIntoView()),!0)}let a=s.nodeBefore;if(WN(t,s,e,-1))return!0;if(r.parent.content.size==0&&(ll(a,"end")||ze.isSelectable(a)))for(let l=r.depth;;l--){let c=ep(t.doc,r.before(l),r.after(l),Ee.empty);if(c&&c.slice.size<c.to-c.from){if(e){let d=t.tr.step(c);d.setSelection(ll(a,"end")?Ve.findFrom(d.doc.resolve(d.mapping.map(s.pos,-1)),-1):ze.create(d.doc,s.pos-a.nodeSize)),e(d.scrollIntoView())}return!0}if(l==1||r.node(l-1).childCount>1)break}return a.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1},yL=(t,e,n)=>{let r=IN(t,n);if(!r)return!1;let s=kb(r);return s?BN(t,s,e):!1},vL=(t,e,n)=>{let r=HN(t,n);if(!r)return!1;let s=Cb(r);return s?BN(t,s,e):!1};function BN(t,e,n){let r=e.nodeBefore,s=r,a=e.pos-1;for(;!s.isTextblock;a--){if(s.type.spec.isolating)return!1;let m=s.lastChild;if(!m)return!1;s=m}let l=e.nodeAfter,c=l,d=e.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let m=c.firstChild;if(!m)return!1;c=m}let p=ep(t.doc,a,d,Ee.empty);if(!p||p.from!=a||p instanceof bn&&p.slice.size>=d-a)return!1;if(n){let m=t.tr.step(p);m.setSelection(Be.create(m.doc,a)),n(m.scrollIntoView())}return!0}function ll(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const PN=(t,e,n)=>{let{$head:r,empty:s}=t.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;a=kb(r)}let l=a&&a.nodeBefore;return!l||!ze.isSelectable(l)?!1:(e&&e(t.tr.setSelection(ze.create(t.doc,a.pos-l.nodeSize)).scrollIntoView()),!0)};function kb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function HN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const FN=(t,e,n)=>{let r=HN(t,n);if(!r)return!1;let s=Cb(r);if(!s)return!1;let a=s.nodeAfter;if(WN(t,s,e,1))return!0;if(r.parent.content.size==0&&(ll(a,"start")||ze.isSelectable(a))){let l=ep(t.doc,r.before(),r.after(),Ee.empty);if(l&&l.slice.size<l.to-l.from){if(e){let c=t.tr.step(l);c.setSelection(ll(a,"start")?Ve.findFrom(c.doc.resolve(c.mapping.map(s.pos)),1):ze.create(c.doc,c.mapping.map(s.pos))),e(c.scrollIntoView())}return!0}}return a.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},UN=(t,e,n)=>{let{$head:r,empty:s}=t.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;a=Cb(r)}let l=a&&a.nodeAfter;return!l||!ze.isSelectable(l)?!1:(e&&e(t.tr.setSelection(ze.create(t.doc,a.pos)).scrollIntoView()),!0)};function Cb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const wL=(t,e)=>{let n=t.selection,r=n instanceof ze,s;if(r){if(n.node.isTextblock||!ta(t.doc,n.from))return!1;s=n.from}else if(s=Zh(t.doc,n.from,-1),s==null)return!1;if(e){let a=t.tr.join(s);r&&a.setSelection(ze.create(a.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},kL=(t,e)=>{let n=t.selection,r;if(n instanceof ze){if(n.node.isTextblock||!ta(t.doc,n.to))return!1;r=n.to}else if(r=Zh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},CL=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),a=s&&wl(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)},$N=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Sb(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const SL=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),a=n.indexAfter(-1),l=Sb(s.contentMatchAt(a));if(!l||!s.canReplaceWith(a,a,l))return!1;if(e){let c=n.after(),d=t.tr.replaceWith(c,c,l.createAndFill());d.setSelection(Ve.near(d.doc.resolve(c),1)),e(d.scrollIntoView())}return!0},VN=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof br||r.parent.inlineContent||s.parent.inlineContent)return!1;let a=Sb(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let l=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,c=t.tr.insert(l,a.createAndFill());c.setSelection(Be.create(c.doc,l+1)),e(c.scrollIntoView())}return!0},qN=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if(Gs(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let r=n.blockRange(),s=r&&wl(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function EL(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof ze&&e.selection.node.isBlock)return!r.parentOffset||!Gs(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let a=[],l,c,d=!1,p=!1;for(let v=r.depth;;v--)if(r.node(v).isBlock){d=r.end(v)==r.pos+(r.depth-v),p=r.start(v)==r.pos-(r.depth-v),c=Sb(r.node(v-1).contentMatchAt(r.indexAfter(v-1))),a.unshift(d&&c?{type:c}:null),l=v;break}else{if(v==1)return!1;a.unshift(null)}let m=e.tr;(e.selection instanceof Be||e.selection instanceof br)&&m.deleteSelection();let g=m.mapping.map(r.pos),b=Gs(m.doc,g,a.length,a);if(b||(a[0]=c?{type:c}:null,b=Gs(m.doc,g,a.length,a)),!b)return!1;if(m.split(g,a.length,a),!d&&p&&r.node(l).type!=c){let v=m.mapping.map(r.before(l)),w=m.doc.resolve(v);c&&r.node(l-1).canReplaceWith(w.index(),w.index()+1,c)&&m.setNodeMarkup(m.mapping.map(r.before(l)),c)}return n&&n(m.scrollIntoView()),!0}}const NL=EL(),TL=(t,e)=>{let{$from:n,to:r}=t.selection,s,a=n.sharedDepth(r);return a==0?!1:(s=n.before(a),e&&e(t.tr.setSelection(ze.create(t.doc,s))),!0)};function AL(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,a=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(a-1,a)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(s.isTextblock||ta(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function WN(t,e,n,r){let s=e.nodeBefore,a=e.nodeAfter,l,c,d=s.type.spec.isolating||a.type.spec.isolating;if(!d&&AL(t,e,n))return!0;let p=!d&&e.parent.canReplace(e.index(),e.index()+1);if(p&&(l=(c=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&c.matchType(l[0]||a.type).validEnd){if(n){let v=e.pos+a.nodeSize,w=fe.empty;for(let N=l.length-1;N>=0;N--)w=fe.from(l[N].create(null,w));w=fe.from(s.copy(w));let C=t.tr.step(new vn(e.pos-1,v,e.pos,v,new Ee(w,1,0),l.length,!0)),k=C.doc.resolve(v+2*l.length);k.nodeAfter&&k.nodeAfter.type==s.type&&ta(C.doc,k.pos)&&C.join(k.pos),n(C.scrollIntoView())}return!0}let m=a.type.spec.isolating||r>0&&d?null:Ve.findFrom(e,1),g=m&&m.$from.blockRange(m.$to),b=g&&wl(g);if(b!=null&&b>=e.depth)return n&&n(t.tr.lift(g,b).scrollIntoView()),!0;if(p&&ll(a,"start",!0)&&ll(s,"end")){let v=s,w=[];for(;w.push(v),!v.isTextblock;)v=v.lastChild;let C=a,k=1;for(;!C.isTextblock;C=C.firstChild)k++;if(v.canReplace(v.childCount,v.childCount,C.content)){if(n){let N=fe.empty;for(let _=w.length-1;_>=0;_--)N=fe.from(w[_].copy(N));let M=t.tr.step(new vn(e.pos-w.length,e.pos+a.nodeSize,e.pos+k,e.pos+a.nodeSize-k,new Ee(N,w.length,0),0,!0));n(M.scrollIntoView())}return!0}}return!1}function GN(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(n&&n(e.tr.setSelection(Be.create(e.doc,t<0?s.start(a):s.end(a)))),!0):!1}}const ML=GN(-1),jL=GN(1);function OL(t,e=null){return function(n,r){let{$from:s,$to:a}=n.selection,l=s.blockRange(a),c=l&&bb(l,t,e);return c?(r&&r(n.tr.wrap(l,c).scrollIntoView()),!0):!1}}function pk(t,e=null){return function(n,r){let s=!1;for(let a=0;a<n.selection.ranges.length&&!s;a++){let{$from:{pos:l},$to:{pos:c}}=n.selection.ranges[a];n.doc.nodesBetween(l,c,(d,p)=>{if(s)return!1;if(!(!d.isTextblock||d.hasMarkup(t,e)))if(d.type==t)s=!0;else{let m=n.doc.resolve(p),g=m.index();s=m.parent.canReplaceWith(g,g+1,t)}})}if(!s)return!1;if(r){let a=n.tr;for(let l=0;l<n.selection.ranges.length;l++){let{$from:{pos:c},$to:{pos:d}}=n.selection.ranges[l];a.setBlockType(c,d,t,e)}r(a.scrollIntoView())}return!0}}function Eb(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}Eb(wb,zN,PN);Eb(wb,FN,UN);Eb($N,VN,qN,NL);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function _L(t,e=null){return function(n,r){let{$from:s,$to:a}=n.selection,l=s.blockRange(a);if(!l)return!1;let c=r?n.tr:null;return RL(c,l,t,e)?(r&&r(c.scrollIntoView()),!0):!1}}function RL(t,e,n,r=null){let s=!1,a=e,l=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=l.resolve(e.start-2);a=new Vf(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new Vf(e.$from,l.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let c=bb(a,n,r,e);return c?(t&&DL(t,e,c,s,n),!0):!1}function DL(t,e,n,r,s){let a=fe.empty;for(let m=n.length-1;m>=0;m--)a=fe.from(n[m].type.create(n[m].attrs,a));t.step(new vn(e.start-(r?2:0),e.end,e.start,e.end,new Ee(a,0,0),n.length,!0));let l=0;for(let m=0;m<n.length;m++)n[m].type==s&&(l=m+1);let c=n.length-l,d=e.start+n.length-(r?2:0),p=e.parent;for(let m=e.startIndex,g=e.endIndex,b=!0;m<g;m++,b=!1)!b&&Gs(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=p.child(m).nodeSize;return t}function LL(t){return function(e,n){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,l=>l.childCount>0&&l.firstChild.type==t);return a?n?r.node(a.depth-1).type==t?IL(e,n,t,a):zL(e,n,a):!0:!1}}function IL(t,e,n,r){let s=t.tr,a=r.end,l=r.$to.end(r.depth);a<l&&(s.step(new vn(a-1,l,a,l,new Ee(fe.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Vf(s.doc.resolve(r.$from.pos),s.doc.resolve(l),r.depth));const c=wl(r);if(c==null)return!1;s.lift(r,c);let d=s.doc.resolve(s.mapping.map(a,-1)-1);return ta(s.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&s.join(d.pos),e(s.scrollIntoView()),!0}function zL(t,e,n){let r=t.tr,s=n.parent;for(let v=n.end,w=n.endIndex-1,C=n.startIndex;w>C;w--)v-=s.child(w).nodeSize,r.delete(v-1,v+1);let a=r.doc.resolve(n.start),l=a.nodeAfter;if(r.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let c=n.startIndex==0,d=n.endIndex==s.childCount,p=a.node(-1),m=a.index(-1);if(!p.canReplace(m+(c?0:1),m+1,l.content.append(d?fe.empty:fe.from(s))))return!1;let g=a.pos,b=g+l.nodeSize;return r.step(new vn(g-(c?1:0),b+(d?1:0),g+1,b-1,new Ee((c?fe.empty:fe.from(s.copy(fe.empty))).append(d?fe.empty:fe.from(s.copy(fe.empty))),c?0:1,d?0:1),c?0:1)),e(r.scrollIntoView()),!0}function BL(t){return function(e,n){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,p=>p.childCount>0&&p.firstChild.type==t);if(!a)return!1;let l=a.startIndex;if(l==0)return!1;let c=a.parent,d=c.child(l-1);if(d.type!=t)return!1;if(n){let p=d.lastChild&&d.lastChild.type==c.type,m=fe.from(p?t.create():null),g=new Ee(fe.from(t.create(null,fe.from(c.type.create(null,m)))),p?3:1,0),b=a.start,v=a.end;n(e.tr.step(new vn(b-(p?3:1),v,b,v,g,1,!0)).scrollIntoView())}return!0}}const Mn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},cl=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let dx=null;const Hs=function(t,e,n){let r=dx||(dx=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},PL=function(){dx=null},Ya=function(t,e,n,r){return n&&(mk(t,e,n,r,-1)||mk(t,e,n,r,1))},HL=/^(img|br|input|textarea|hr)$/i;function mk(t,e,n,r,s){for(var a;;){if(t==n&&e==r)return!0;if(e==(s<0?0:Rr(t))){let l=t.parentNode;if(!l||l.nodeType!=1||ku(t)||HL.test(t.nodeName)||t.contentEditable=="false")return!1;e=Mn(t)+(s<0?0:1),t=l}else if(t.nodeType==1){let l=t.childNodes[e+(s<0?-1:0)];if(l.nodeType==1&&l.contentEditable=="false")if(!((a=l.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=s;else return!1;else t=l,e=s<0?Rr(t):0}else return!1}}function Rr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function FL(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Rr(t)}else if(t.parentNode&&!ku(t))e=Mn(t),t=t.parentNode;else return null}}function UL(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!ku(t))e=Mn(t)+1,t=t.parentNode;else return null}}function $L(t,e,n){for(let r=e==0,s=e==Rr(t);r||s;){if(t==n)return!0;let a=Mn(t);if(t=t.parentNode,!t)return!1;r=r&&a==0,s=s&&a==Rr(t)}}function ku(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const np=function(t){return t.focusNode&&Ya(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Oa(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function VL(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function qL(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Rr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Rr(r.startContainer),r.startOffset)}}}const fs=typeof navigator<"u"?navigator:null,gk=typeof document<"u"?document:null,na=fs&&fs.userAgent||"",fx=/Edge\/(\d+)/.exec(na),KN=/MSIE \d/.exec(na),hx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(na),ar=!!(KN||hx||fx),Gi=KN?document.documentMode:hx?+hx[1]:fx?+fx[1]:0,Dr=!ar&&/gecko\/(\d+)/i.test(na);Dr&&+(/Firefox\/(\d+)/.exec(na)||[0,0])[1];const px=!ar&&/Chrome\/(\d+)/.exec(na),On=!!px,YN=px?+px[1]:0,In=!ar&&!!fs&&/Apple Computer/.test(fs.vendor),ul=In&&(/Mobile\/\w+/.test(na)||!!fs&&fs.maxTouchPoints>2),_r=ul||(fs?/Mac/.test(fs.platform):!1),JN=fs?/Win/.test(fs.platform):!1,$s=/Android \d/.test(na),Cu=!!gk&&"webkitFontSmoothing"in gk.documentElement.style,WL=Cu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function GL(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ls(t,e){return typeof t=="number"?t:t[e]}function KL(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function xk(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let l=n||t.dom;l;){if(l.nodeType!=1){l=cl(l);continue}let c=l,d=c==a.body,p=d?GL(a):KL(c),m=0,g=0;if(e.top<p.top+Ls(r,"top")?g=-(p.top-e.top+Ls(s,"top")):e.bottom>p.bottom-Ls(r,"bottom")&&(g=e.bottom-e.top>p.bottom-p.top?e.top+Ls(s,"top")-p.top:e.bottom-p.bottom+Ls(s,"bottom")),e.left<p.left+Ls(r,"left")?m=-(p.left-e.left+Ls(s,"left")):e.right>p.right-Ls(r,"right")&&(m=e.right-p.right+Ls(s,"right")),m||g)if(d)a.defaultView.scrollBy(m,g);else{let v=c.scrollLeft,w=c.scrollTop;g&&(c.scrollTop+=g),m&&(c.scrollLeft+=m);let C=c.scrollLeft-v,k=c.scrollTop-w;e={left:e.left-C,top:e.top-k,right:e.right-C,bottom:e.bottom-k}}let b=d?"fixed":getComputedStyle(l).position;if(/^(fixed|sticky)$/.test(b))break;l=b=="absolute"?l.offsetParent:cl(l)}}function YL(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let a=(e.left+e.right)/2,l=n+1;l<Math.min(innerHeight,e.bottom);l+=5){let c=t.root.elementFromPoint(a,l);if(!c||c==t.dom||!t.dom.contains(c))continue;let d=c.getBoundingClientRect();if(d.top>=n-20){r=c,s=d.top;break}}return{refDOM:r,refTop:s,stack:XN(t.dom)}}function XN(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=cl(r));return e}function JL({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;QN(n,r==0?0:r-e)}function QN(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:a}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=a&&(r.scrollLeft=a)}}let Po=null;function XL(t){if(t.setActive)return t.setActive();if(Po)return t.focus(Po);let e=XN(t);t.focus(Po==null?{get preventScroll(){return Po={preventScroll:!0},!0}}:void 0),Po||(Po=!1,QN(e,0))}function ZN(t,e){let n,r=2e8,s,a=0,l=e.top,c=e.top,d,p;for(let m=t.firstChild,g=0;m;m=m.nextSibling,g++){let b;if(m.nodeType==1)b=m.getClientRects();else if(m.nodeType==3)b=Hs(m).getClientRects();else continue;for(let v=0;v<b.length;v++){let w=b[v];if(w.top<=l&&w.bottom>=c){l=Math.max(w.bottom,l),c=Math.min(w.top,c);let C=w.left>e.left?w.left-e.left:w.right<e.left?e.left-w.right:0;if(C<r){n=m,r=C,s=C&&n.nodeType==3?{left:w.right<e.left?w.right:w.left,top:e.top}:e,m.nodeType==1&&C&&(a=g+(e.left>=(w.left+w.right)/2?1:0));continue}}else w.top>e.top&&!d&&w.left<=e.left&&w.right>=e.left&&(d=m,p={left:Math.max(w.left,Math.min(w.right,e.left)),top:w.top});!n&&(e.left>=w.right&&e.top>=w.top||e.left>=w.left&&e.top>=w.bottom)&&(a=g+1)}}return!n&&d&&(n=d,s=p,r=0),n&&n.nodeType==3?QL(n,s):!n||r&&n.nodeType==1?{node:t,offset:a}:ZN(n,s)}function QL(t,e){let n=t.nodeValue.length,r=document.createRange(),s;for(let a=0;a<n;a++){r.setEnd(t,a+1),r.setStart(t,a);let l=Oi(r,1);if(l.top!=l.bottom&&Nb(e,l)){s={node:t,offset:a+(e.left>=(l.left+l.right)/2?1:0)};break}}return r.detach(),s||{node:t,offset:0}}function Nb(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function ZL(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function eI(t,e,n){let{node:r,offset:s}=ZN(e,n),a=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();a=l.left!=l.right&&n.left>(l.left+l.right)/2?1:-1}return t.docView.posFromDOM(r,s,a)}function tI(t,e,n,r){let s=-1;for(let a=e,l=!1;a!=t.dom;){let c=t.docView.nearestDesc(a,!0),d;if(!c)return null;if(c.dom.nodeType==1&&(c.node.isBlock&&c.parent||!c.contentDOM)&&((d=c.dom.getBoundingClientRect()).width||d.height)&&(c.node.isBlock&&c.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(c.dom.nodeName)&&(!l&&d.left>r.left||d.top>r.top?s=c.posBefore:(!l&&d.right<r.left||d.bottom<r.top)&&(s=c.posAfter),l=!0),!c.contentDOM&&s<0&&!c.node.isText))return(c.node.isBlock?r.top<(d.top+d.bottom)/2:r.left<(d.left+d.right)/2)?c.posBefore:c.posAfter;a=c.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function eT(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),a=s;;){let l=t.childNodes[a];if(l.nodeType==1){let c=l.getClientRects();for(let d=0;d<c.length;d++){let p=c[d];if(Nb(e,p))return eT(l,e,p)}}if((a=(a+1)%r)==s)break}return t}function nI(t,e){let n=t.dom.ownerDocument,r,s=0,a=qL(n,e.left,e.top);a&&({node:r,offset:s}=a);let l=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),c;if(!l||!t.dom.contains(l.nodeType!=1?l.parentNode:l)){let p=t.dom.getBoundingClientRect();if(!Nb(e,p)||(l=eT(t.dom,e,p),!l))return null}if(In)for(let p=l;r&&p;p=cl(p))p.draggable&&(r=void 0);if(l=ZL(l,e),r){if(Dr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let m=r.childNodes[s],g;m.nodeName=="IMG"&&(g=m.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&s++}let p;Cu&&s&&r.nodeType==1&&(p=r.childNodes[s-1]).nodeType==1&&p.contentEditable=="false"&&p.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?c=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(c=tI(t,r,s,e))}c==null&&(c=eI(t,l,e));let d=t.docView.nearestDesc(l,!0);return{pos:c,inside:d?d.posAtStart-d.border:-1}}function bk(t){return t.top<t.bottom||t.left<t.right}function Oi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(bk(r))return r}return Array.prototype.find.call(n,bk)||t.getBoundingClientRect()}const rI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function tT(t,e,n){let{node:r,offset:s,atom:a}=t.docView.domFromPos(e,n<0?-1:1),l=Cu||Dr;if(r.nodeType==3)if(l&&(rI.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let d=Oi(Hs(r,s,s),n);if(Dr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let p=Oi(Hs(r,s-1,s-1),-1);if(p.top==d.top){let m=Oi(Hs(r,s,s+1),-1);if(m.top!=d.top)return wc(m,m.left<p.left)}}return d}else{let d=s,p=s,m=n<0?1:-1;return n<0&&!s?(p++,m=-1):n>=0&&s==r.nodeValue.length?(d--,m=1):n<0?d--:p++,wc(Oi(Hs(r,d,p),m),m<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&s&&(n<0||s==Rr(r))){let d=r.childNodes[s-1];if(d.nodeType==1)return Xg(d.getBoundingClientRect(),!1)}if(a==null&&s<Rr(r)){let d=r.childNodes[s];if(d.nodeType==1)return Xg(d.getBoundingClientRect(),!0)}return Xg(r.getBoundingClientRect(),n>=0)}if(a==null&&s&&(n<0||s==Rr(r))){let d=r.childNodes[s-1],p=d.nodeType==3?Hs(d,Rr(d)-(l?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(p)return wc(Oi(p,1),!1)}if(a==null&&s<Rr(r)){let d=r.childNodes[s];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let p=d?d.nodeType==3?Hs(d,0,l?0:1):d.nodeType==1?d:null:null;if(p)return wc(Oi(p,-1),!0)}return wc(Oi(r.nodeType==3?Hs(r):r,-n),n>=0)}function wc(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Xg(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function nT(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function sI(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return nT(t,e,()=>{let{node:a}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let c=t.docView.nearestDesc(a,!0);if(!c)break;if(c.node.isBlock){a=c.contentDOM||c.dom;break}a=c.dom.parentNode}let l=tT(t,s.pos,1);for(let c=a.firstChild;c;c=c.nextSibling){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=Hs(c,0,c.nodeValue.length).getClientRects();else continue;for(let p=0;p<d.length;p++){let m=d[p];if(m.bottom>m.top+1&&(n=="up"?l.top-m.top>(m.bottom-l.top)*2:m.bottom-l.bottom>(l.bottom-m.top)*2))return!1}}return!0})}const iI=/[\u0590-\u08ac]/;function aI(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,a=!s,l=s==r.parent.content.size,c=t.domSelection();return c?!iI.test(r.parent.textContent)||!c.modify?n=="left"||n=="backward"?a:l:nT(t,e,()=>{let{focusNode:d,focusOffset:p,anchorNode:m,anchorOffset:g}=t.domSelectionRange(),b=c.caretBidiLevel;c.modify("move",n,"character");let v=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:w,focusOffset:C}=t.domSelectionRange(),k=w&&!v.contains(w.nodeType==1?w:w.parentNode)||d==w&&p==C;try{c.collapse(m,g),d&&(d!=m||p!=g)&&c.extend&&c.extend(d,p)}catch{}return b!=null&&(c.caretBidiLevel=b),k}):r.pos==r.start()||r.pos==r.end()}let yk=null,vk=null,wk=!1;function oI(t,e,n){return yk==e&&vk==n?wk:(yk=e,vk=n,wk=n=="up"||n=="down"?sI(t,e,n):aI(t,e,n))}const Lr=0,kk=1,Da=2,hs=3;class Su{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=Lr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let a,l;if(e==this.contentDOM)a=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(l)+l.size:this.posAtStart}else{let a,l;if(e==this.contentDOM)a=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(l):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>Mn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let a=this.getDesc(s),l;if(a&&(!n||a.node))if(r&&(l=a.nodeDOM)&&!(l.nodeType==1?l.contains(e.nodeType==1?e:e.parentNode):l==e))r=!1;else return a}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],a=r+s.size;if(r==e&&a!=r){for(;!s.border&&s.children.length;)for(let l=0;l<s.children.length;l++){let c=s.children[l];if(c.size){s=c;break}}return s}if(e<a)return s.descAt(e-r-s.border);r=a}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let a=0;r<this.children.length;r++){let l=this.children[r],c=a+l.size;if(c>e||l instanceof sT){s=e-a;break}a=c}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof rT&&a.side>=0;r--);if(n<=0){let a,l=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,l=!1);return a&&n&&l&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?Mn(a.dom)+1:0}}else{let a,l=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,l=!1);return a&&l&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?Mn(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let l=r,c=0;;c++){let d=this.children[c],p=l+d.size;if(s==-1&&e<=p){let m=l+d.border;if(e>=m&&n<=p-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,n,m);e=l;for(let g=c;g>0;g--){let b=this.children[g-1];if(b.size&&b.dom.parentNode==this.contentDOM&&!b.emptyChildAt(1)){s=Mn(b.dom)+1;break}e-=b.size}s==-1&&(s=0)}if(s>-1&&(p>n||c==this.children.length-1)){n=p;for(let m=c+1;m<this.children.length;m++){let g=this.children[m];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){a=Mn(g.dom);break}n+=g.size}a==-1&&(a=this.contentDOM.childNodes.length);break}l=p}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let a=Math.min(e,n),l=Math.max(e,n);for(let v=0,w=0;v<this.children.length;v++){let C=this.children[v],k=w+C.size;if(a>w&&l<k)return C.setSelection(e-w-C.border,n-w-C.border,r,s);w=k}let c=this.domFromPos(e,e?-1:1),d=n==e?c:this.domFromPos(n,n?-1:1),p=r.root.getSelection(),m=r.domSelectionRange(),g=!1;if((Dr||In)&&e==n){let{node:v,offset:w}=c;if(v.nodeType==3){if(g=!!(w&&v.nodeValue[w-1]==`
`),g&&w==v.nodeValue.length)for(let C=v,k;C;C=C.parentNode){if(k=C.nextSibling){k.nodeName=="BR"&&(c=d={node:k.parentNode,offset:Mn(k)+1});break}let N=C.pmViewDesc;if(N&&N.node&&N.node.isBlock)break}}else{let C=v.childNodes[w-1];g=C&&(C.nodeName=="BR"||C.contentEditable=="false")}}if(Dr&&m.focusNode&&m.focusNode!=d.node&&m.focusNode.nodeType==1){let v=m.focusNode.childNodes[m.focusOffset];v&&v.contentEditable=="false"&&(s=!0)}if(!(s||g&&In)&&Ya(c.node,c.offset,m.anchorNode,m.anchorOffset)&&Ya(d.node,d.offset,m.focusNode,m.focusOffset))return;let b=!1;if((p.extend||e==n)&&!(g&&Dr)){p.collapse(c.node,c.offset);try{e!=n&&p.extend(d.node,d.offset),b=!0}catch{}}if(!b){if(e>n){let w=c;c=d,d=w}let v=document.createRange();v.setEnd(d.node,d.offset),v.setStart(c.node,c.offset),p.removeAllRanges(),p.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let a=this.children[s],l=r+a.size;if(r==l?e<=l&&n>=r:e<l&&n>r){let c=r+a.border,d=l-a.border;if(e>=c&&n<=d){this.dirty=e==r||n==l?Da:kk,e==c&&n==d&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=hs:a.markDirty(e-c,n-c);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Da:hs}r=l}this.dirty=Da}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Da:kk;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class rT extends Su{constructor(e,n,r,s){let a,l=n.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!n.type.spec.raw){if(l.nodeType!=1){let c=document.createElement("span");c.appendChild(l),l=c}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(e,[],l,null),this.widget=n,this.widget=n,a=this}matchesWidget(e){return this.dirty==Lr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class lI extends Su{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ja extends Su{constructor(e,n,r,s,a){super(e,[],r,s),this.mark=n,this.spec=a}static create(e,n,r,s){let a=s.nodeViews[n.type.name],l=a&&a(n,s,r);return(!l||!l.dom)&&(l=to.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Ja(e,n,l.dom,l.contentDOM||l.dom,l)}parseRule(){return this.dirty&hs||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=hs&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Lr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Lr}}slice(e,n,r){let s=Ja.create(this.parent,this.mark,!0,r),a=this.children,l=this.size;n<l&&(a=gx(a,n,l,r)),e>0&&(a=gx(a,0,e,r));for(let c=0;c<a.length;c++)a[c].parent=s;return s.children=a,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ki extends Su{constructor(e,n,r,s,a,l,c,d,p){super(e,[],a,l),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=c}static create(e,n,r,s,a,l){let c=a.nodeViews[n.type.name],d,p=c&&c(n,a,()=>{if(!d)return l;if(d.parent)return d.parent.posBeforeChild(d)},r,s),m=p&&p.dom,g=p&&p.contentDOM;if(n.isText){if(!m)m=document.createTextNode(n.text);else if(m.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else m||({dom:m,contentDOM:g}=to.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!g&&!n.isText&&m.nodeName!="BR"&&(m.hasAttribute("contenteditable")||(m.contentEditable="false"),n.type.spec.draggable&&(m.draggable=!0));let b=m;return m=oT(m,r,n),p?d=new cI(e,n,r,s,m,g||null,b,p,a,l+1):n.isText?new rp(e,n,r,s,m,b,a):new Ki(e,n,r,s,m,g||null,b,a,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>fe.empty)}return e}matchesNode(e,n,r){return this.dirty==Lr&&e.eq(this.node)&&Wf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,a=e.composing?this.localCompositionInfo(e,n):null,l=a&&a.pos>-1?a:null,c=a&&a.pos<0,d=new dI(this,l&&l.node,e);pI(this.node,this.innerDeco,(p,m,g)=>{p.spec.marks?d.syncToMarks(p.spec.marks,r,e,m):p.type.side>=0&&!g&&d.syncToMarks(m==this.node.childCount?Et.none:this.node.child(m).marks,r,e,m),d.placeWidget(p,e,s)},(p,m,g,b)=>{d.syncToMarks(p.marks,r,e,b);let v;d.findNodeMatch(p,m,g,b)||c&&e.state.selection.from>s&&e.state.selection.to<s+p.nodeSize&&(v=d.findIndexWithChild(a.node))>-1&&d.updateNodeAt(p,m,g,v,e)||d.updateNextNode(p,m,g,e,b,s)||d.addNode(p,m,g,e,s),s+=p.nodeSize}),d.syncToMarks([],r,e,0),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Da)&&(l&&this.protectLocalComposition(e,l),iT(this.contentDOM,this.children,e),ul&&mI(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof Be)||r<n||s>n+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let l=a.nodeValue,c=gI(this.node.content,l,r-n,s-n);return c<0?null:{node:a,pos:c,text:l}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let l=new lI(this,a,n,s);e.input.compositionNodes.push(l),this.children=gx(this.children,r,r+s.length,e,l)}update(e,n,r,s){return this.dirty==hs||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Lr}updateOuterDeco(e){if(Wf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=aT(this.dom,this.nodeDOM,mx(this.outerDeco,this.node,n),mx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Ck(t,e,n,r,s){oT(r,e,t);let a=new Ki(void 0,t,e,n,r,r,r,s,0);return a.contentDOM&&a.updateChildren(s,0),a}class rp extends Ki{constructor(e,n,r,s,a,l,c){super(e,n,r,s,a,null,l,c,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==hs||this.dirty!=Lr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Lr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Lr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),a=document.createTextNode(s.text);return new rp(this.parent,s,this.outerDeco,this.innerDeco,a,a,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=hs)}get domAtom(){return!1}isText(e){return this.node.text==e}}class sT extends Su{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Lr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class cI extends Ki{constructor(e,n,r,s,a,l,c,d,p,m){super(e,n,r,s,a,l,c,p,m),this.spec=d}update(e,n,r,s){if(this.dirty==hs)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,n,r);return a&&this.updateInner(e,n,r,s),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function iT(t,e,n){let r=t.firstChild,s=!1;for(let a=0;a<e.length;a++){let l=e[a],c=l.dom;if(c.parentNode==t){for(;c!=r;)r=Sk(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(c,r);if(l instanceof Ja){let d=r?r.previousSibling:t.lastChild;iT(l.contentDOM,l.children,n),r=d?d.nextSibling:t.firstChild}}for(;r;)r=Sk(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const zc=function(t){t&&(this.nodeName=t)};zc.prototype=Object.create(null);const La=[new zc];function mx(t,e,n){if(t.length==0)return La;let r=n?La[0]:new zc,s=[r];for(let a=0;a<t.length;a++){let l=t[a].type.attrs;if(l){l.nodeName&&s.push(r=new zc(l.nodeName));for(let c in l){let d=l[c];d!=null&&(n&&s.length==1&&s.push(r=new zc(e.isInline?"span":"div")),c=="class"?r.class=(r.class?r.class+" ":"")+d:c=="style"?r.style=(r.style?r.style+";":"")+d:c!="nodeName"&&(r[c]=d))}}}return s}function aT(t,e,n,r){if(n==La&&r==La)return e;let s=e;for(let a=0;a<r.length;a++){let l=r[a],c=n[a];if(a){let d;c&&c.nodeName==l.nodeName&&s!=t&&(d=s.parentNode)&&d.nodeName.toLowerCase()==l.nodeName||(d=document.createElement(l.nodeName),d.pmIsDeco=!0,d.appendChild(s),c=La[0]),s=d}uI(s,c||La[0],l)}return s}function uI(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)s.indexOf(r[a])==-1&&t.classList.remove(r[a]);for(let a=0;a<s.length;a++)r.indexOf(s[a])==-1&&t.classList.add(s[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function oT(t,e,n){return aT(t,t,La,mx(e,n,t.nodeType!=1))}function Wf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Sk(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class dI{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=fI(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,s){let a=0,l=this.stack.length>>1,c=Math.min(l,e.length);for(;a<c&&(a==l-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<l;)this.destroyRest(),this.top.dirty=Lr,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<e.length;){this.stack.push(this.top,this.index+1);let d=-1,p=this.top.children.length;s<this.preMatch.index&&(p=Math.min(this.index+3,p));for(let m=this.index;m<p;m++){let g=this.top.children[m];if(g.matchesMark(e[l])&&!this.isLocked(g.dom)){d=m;break}}if(d>-1)d>this.index&&(this.changed=!0,this.destroyBetween(this.index,d)),this.top=this.top.children[this.index];else{let m=Ja.create(this.top,e[l],n,r);this.top.children.splice(this.index,0,m),this.top=m,this.changed=!0}this.index=0,l++}}findNodeMatch(e,n,r,s){let a=-1,l;if(s>=this.preMatch.index&&(l=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&l.matchesNode(e,n,r))a=this.top.children.indexOf(l,this.index);else for(let c=this.index,d=Math.min(this.top.children.length,c+5);c<d;c++){let p=this.top.children[c];if(p.matchesNode(e,n,r)&&!this.preMatch.matched.has(p)){a=c;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,n,r,s,a){let l=this.top.children[s];return l.dirty==hs&&l.dom==l.contentDOM&&(l.dirty=Da),l.update(e,n,r,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,a,l){for(let c=this.index;c<this.top.children.length;c++){let d=this.top.children[c];if(d instanceof Ki){let p=this.preMatch.matched.get(d);if(p!=null&&p!=a)return!1;let m=d.dom,g,b=this.isLocked(m)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=hs&&Wf(n,d.outerDeco));if(!b&&d.update(e,n,r,s))return this.destroyBetween(this.index,c),d.dom!=m&&(this.changed=!0),this.index++,!0;if(!b&&(g=this.recreateWrapper(d,e,n,r,s,l)))return this.destroyBetween(this.index,c),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Da,g.updateChildren(s,l+1),g.dirty=Lr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,a,l){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Wf(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let c=Ki.create(this.top,n,r,s,a,l);if(c.contentDOM){c.children=e.children,e.children=[];for(let d of c.children)d.parent=c}return e.destroy(),c}addNode(e,n,r,s,a){let l=Ki.create(this.top,e,n,r,s,a);l.contentDOM&&l.updateChildren(s,a+1),this.top.children.splice(this.index++,0,l),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new rT(this.top,e,n,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Ja;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof rp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((In||On)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new sT(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function fI(t,e){let n=e,r=n.children.length,s=t.childCount,a=new Map,l=[];e:for(;s>0;){let c;for(;;)if(r){let p=n.children[r-1];if(p instanceof Ja)n=p,r=p.children.length;else{c=p,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let d=c.node;if(d){if(d!=t.child(s-1))break;--s,a.set(c,s),l.push(c)}}return{index:s,matched:a,matches:l.reverse()}}function hI(t,e){return t.type.side-e.type.side}function pI(t,e,n,r){let s=e.locals(t),a=0;if(s.length==0){for(let p=0;p<t.childCount;p++){let m=t.child(p);r(m,s,e.forChild(a,m),p),a+=m.nodeSize}return}let l=0,c=[],d=null;for(let p=0;;){let m,g;for(;l<s.length&&s[l].to==a;){let k=s[l++];k.widget&&(m?(g||(g=[m])).push(k):m=k)}if(m)if(g){g.sort(hI);for(let k=0;k<g.length;k++)n(g[k],p,!!d)}else n(m,p,!!d);let b,v;if(d)v=-1,b=d,d=null;else if(p<t.childCount)v=p,b=t.child(p++);else break;for(let k=0;k<c.length;k++)c[k].to<=a&&c.splice(k--,1);for(;l<s.length&&s[l].from<=a&&s[l].to>a;)c.push(s[l++]);let w=a+b.nodeSize;if(b.isText){let k=w;l<s.length&&s[l].from<k&&(k=s[l].from);for(let N=0;N<c.length;N++)c[N].to<k&&(k=c[N].to);k<w&&(d=b.cut(k-a),b=b.cut(0,k-a),w=k,v=-1)}else for(;l<s.length&&s[l].to<w;)l++;let C=b.isInline&&!b.isLeaf?c.filter(k=>!k.inline):c.slice();r(b,C,e.forChild(a,b),v),a=w}}function mI(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function gI(t,e,n,r){for(let s=0,a=0;s<t.childCount&&a<=r;){let l=t.child(s++),c=a;if(a+=l.nodeSize,!l.isText)continue;let d=l.text;for(;s<t.childCount;){let p=t.child(s++);if(a+=p.nodeSize,!p.isText)break;d+=p.text}if(a>=n){if(a>=r&&d.slice(r-e.length-c,r-c)==e)return r-e.length;let p=c<r?d.lastIndexOf(e,r-c-1):-1;if(p>=0&&p+e.length+c>=n)return c+p;if(n==r&&d.length>=r+e.length-c&&d.slice(r-c,r-c+e.length)==e)return r}}return-1}function gx(t,e,n,r,s){let a=[];for(let l=0,c=0;l<t.length;l++){let d=t[l],p=c,m=c+=d.size;p>=n||m<=e?a.push(d):(p<e&&a.push(d.slice(0,e-p,r)),s&&(a.push(s),s=void 0),m>n&&a.push(d.slice(n-p,d.size,r)))}return a}function Tb(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),a=s&&s.size==0,l=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(l<0)return null;let c=r.resolve(l),d,p;if(np(n)){for(d=l;s&&!s.node;)s=s.parent;let g=s.node;if(s&&g.isAtom&&ze.isSelectable(g)&&s.parent&&!(g.isInline&&$L(n.focusNode,n.focusOffset,s.dom))){let b=s.posBefore;p=new ze(l==b?c:r.resolve(b))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let g=l,b=l;for(let v=0;v<n.rangeCount;v++){let w=n.getRangeAt(v);g=Math.min(g,t.docView.posFromDOM(w.startContainer,w.startOffset,1)),b=Math.max(b,t.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(g<0)return null;[d,l]=b==t.state.selection.anchor?[b,g]:[g,b],c=r.resolve(l)}else d=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(d<0)return null}let m=r.resolve(d);if(!p){let g=e=="pointer"||t.state.selection.head<c.pos&&!a?1:-1;p=Ab(t,m,c,g)}return p}function lT(t){return t.editable?t.hasFocus():uT(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ks(t,e=!1){let n=t.state.selection;if(cT(t,n),!!lT(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&On){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Ya(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)bI(t);else{let{anchor:r,head:s}=n,a,l;Ek&&!(n instanceof Be)&&(n.$from.parent.inlineContent||(a=Nk(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(l=Nk(t,n.to))),t.docView.setSelection(r,s,t,e),Ek&&(a&&Tk(a),l&&Tk(l)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&xI(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Ek=In||On&&YN<63;function Nk(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,a=r?n.childNodes[r-1]:null;if(In&&s&&s.contentEditable=="false")return Qg(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Qg(s);if(a)return Qg(a)}}function Qg(t){return t.contentEditable="true",In&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Tk(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function xI(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!lT(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function bI(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Mn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&ar&&Gi<=11&&(n.disabled=!0,n.disabled=!1)}function cT(t,e){if(e instanceof ze){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Ak(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Ak(t)}function Ak(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Ab(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||Be.between(e,n,r)}function Mk(t){return t.editable&&!t.hasFocus()?!1:uT(t)}function uT(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function yI(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Ya(e.node,e.offset,n.anchorNode,n.anchorOffset)}function xx(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),a=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return a&&Ve.findFrom(a,e)}function Ri(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function jk(t,e,n){let r=t.state.selection;if(r instanceof Be)if(n.indexOf("s")>-1){let{$head:s}=r,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let l=t.state.doc.resolve(s.pos+a.nodeSize*(e<0?-1:1));return Ri(t,new Be(r.$anchor,l))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=xx(t.state,e);return s&&s instanceof ze?Ri(t,s):!1}else if(!(_r&&n.indexOf("m")>-1)){let s=r.$head,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,l;if(!a||a.isText)return!1;let c=e<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(l=t.docView.descAt(c))&&!l.contentDOM?ze.isSelectable(a)?Ri(t,new ze(e<0?t.state.doc.resolve(s.pos-a.nodeSize):s)):Cu?Ri(t,new Be(t.state.doc.resolve(e<0?c:c+a.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ze&&r.node.isInline)return Ri(t,new Be(e>0?r.$to:r.$from));{let s=xx(t.state,e);return s?Ri(t,s):!1}}}function Gf(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Bc(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ho(t,e){return e<0?vI(t):wI(t)}function vI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,a,l=!1;for(Dr&&n.nodeType==1&&r<Gf(n)&&Bc(n.childNodes[r],-1)&&(l=!0);;)if(r>0){if(n.nodeType!=1)break;{let c=n.childNodes[r-1];if(Bc(c,-1))s=n,a=--r;else if(c.nodeType==3)n=c,r=n.nodeValue.length;else break}}else{if(dT(n))break;{let c=n.previousSibling;for(;c&&Bc(c,-1);)s=n.parentNode,a=Mn(c),c=c.previousSibling;if(c)n=c,r=Gf(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}l?bx(t,n,r):s&&bx(t,s,a)}function wI(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Gf(n),a,l;for(;;)if(r<s){if(n.nodeType!=1)break;let c=n.childNodes[r];if(Bc(c,1))a=n,l=++r;else break}else{if(dT(n))break;{let c=n.nextSibling;for(;c&&Bc(c,1);)a=c.parentNode,l=Mn(c)+1,c=c.nextSibling;if(c)n=c,r=0,s=Gf(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}a&&bx(t,a,l)}function dT(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function kI(t,e){for(;t&&e==t.childNodes.length&&!ku(t);)e=Mn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function CI(t,e){for(;t&&!e&&!ku(t);)e=Mn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function bx(t,e,n){if(e.nodeType!=3){let a,l;(l=kI(e,n))?(e=l,n=0):(a=CI(e,n))&&(e=a,n=a.nodeValue.length)}let r=t.domSelection();if(!r)return;if(np(r)){let a=document.createRange();a.setEnd(e,n),a.setStart(e,n),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&Ks(t)},50)}function Ok(t,e){let n=t.state.doc.resolve(e);if(!(On||JN)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let a=t.coordsAtPos(e-1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left<s.left?"ltr":"rtl"}if(e<n.end()){let a=t.coordsAtPos(e+1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function _k(t,e,n){let r=t.state.selection;if(r instanceof Be&&!r.empty||n.indexOf("s")>-1||_r&&n.indexOf("m")>-1)return!1;let{$from:s,$to:a}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let l=xx(t.state,e);if(l&&l instanceof ze)return Ri(t,l)}if(!s.parent.inlineContent){let l=e<0?s:a,c=r instanceof br?Ve.near(l,e):Ve.findFrom(l,e);return c?Ri(t,c):!1}return!1}function Rk(t,e){if(!(t.state.selection instanceof Be))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let l=t.state.tr;return e<0?l.delete(n.pos-a.nodeSize,n.pos):l.delete(n.pos,n.pos+a.nodeSize),t.dispatch(l),!0}return!1}function Dk(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function SI(t){if(!In||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Dk(t,r,"true"),setTimeout(()=>Dk(t,r,"false"),20)}return!1}function EI(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function NI(t,e){let n=e.keyCode,r=EI(e);if(n==8||_r&&n==72&&r=="c")return Rk(t,-1)||Ho(t,-1);if(n==46&&!e.shiftKey||_r&&n==68&&r=="c")return Rk(t,1)||Ho(t,1);if(n==13||n==27)return!0;if(n==37||_r&&n==66&&r=="c"){let s=n==37?Ok(t,t.state.selection.from)=="ltr"?-1:1:-1;return jk(t,s,r)||Ho(t,s)}else if(n==39||_r&&n==70&&r=="c"){let s=n==39?Ok(t,t.state.selection.from)=="ltr"?1:-1:1;return jk(t,s,r)||Ho(t,s)}else{if(n==38||_r&&n==80&&r=="c")return _k(t,-1,r)||Ho(t,-1);if(n==40||_r&&n==78&&r=="c")return SI(t)||_k(t,1,r)||Ho(t,1);if(r==(_r?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Mb(t,e){t.someProp("transformCopied",v=>{e=v(e,t)});let n=[],{content:r,openStart:s,openEnd:a}=e;for(;s>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,a--;let v=r.firstChild;n.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),r=v.content}let l=t.someProp("clipboardSerializer")||to.fromSchema(t.state.schema),c=xT(),d=c.createElement("div");d.appendChild(l.serializeFragment(r,{document:c}));let p=d.firstChild,m,g=0;for(;p&&p.nodeType==1&&(m=gT[p.nodeName.toLowerCase()]);){for(let v=m.length-1;v>=0;v--){let w=c.createElement(m[v]);for(;d.firstChild;)w.appendChild(d.firstChild);d.appendChild(w),g++}p=d.firstChild}p&&p.nodeType==1&&p.setAttribute("data-pm-slice",`${s} ${a}${g?` -${g}`:""} ${JSON.stringify(n)}`);let b=t.someProp("clipboardTextSerializer",v=>v(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:b,slice:e}}function fT(t,e,n,r,s){let a=s.parent.type.spec.code,l,c;if(!n&&!e)return null;let d=!!e&&(r||a||!n);if(d){if(t.someProp("transformPastedText",b=>{e=b(e,a||r,t)}),a)return c=new Ee(fe.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",b=>{c=b(c,t,!0)}),c;let g=t.someProp("clipboardTextParser",b=>b(e,s,r,t));if(g)c=g;else{let b=s.marks(),{schema:v}=t.state,w=to.fromSchema(v);l=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(C=>{let k=l.appendChild(document.createElement("p"));C&&k.appendChild(w.serializeNode(v.text(C,b)))})}}else t.someProp("transformPastedHTML",g=>{n=g(n,t)}),l=jI(n),Cu&&OI(l);let p=l&&l.querySelector("[data-pm-slice]"),m=p&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(p.getAttribute("data-pm-slice")||"");if(m&&m[3])for(let g=+m[3];g>0;g--){let b=l.firstChild;for(;b&&b.nodeType!=1;)b=b.nextSibling;if(!b)break;l=b}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||Lc.fromSchema(t.state.schema)).parseSlice(l,{preserveWhitespace:!!(d||m),context:s,ruleFromNode(b){return b.nodeName=="BR"&&!b.nextSibling&&b.parentNode&&!TI.test(b.parentNode.nodeName)?{ignore:!0}:null}})),m)c=_I(Lk(c,+m[1],+m[2]),m[4]);else if(c=Ee.maxOpen(AI(c.content,s),!0),c.openStart||c.openEnd){let g=0,b=0;for(let v=c.content.firstChild;g<c.openStart&&!v.type.spec.isolating;g++,v=v.firstChild);for(let v=c.content.lastChild;b<c.openEnd&&!v.type.spec.isolating;b++,v=v.lastChild);c=Lk(c,g,b)}return t.someProp("transformPasted",g=>{c=g(c,t,d)}),c}const TI=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function AI(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),a,l=[];if(t.forEach(c=>{if(!l)return;let d=s.findWrapping(c.type),p;if(!d)return l=null;if(p=l.length&&a.length&&pT(d,a,c,l[l.length-1],0))l[l.length-1]=p;else{l.length&&(l[l.length-1]=mT(l[l.length-1],a.length));let m=hT(c,d);l.push(m),s=s.matchType(m.type),a=d}}),l)return fe.from(l)}return t}function hT(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,fe.from(t));return t}function pT(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let a=pT(t,e,n,r.lastChild,s+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(fe.from(hT(n,t,s+1))))}}function mT(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,mT(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(fe.empty,!0);return t.copy(n.append(r))}function yx(t,e,n,r,s,a){let l=e<0?t.firstChild:t.lastChild,c=l.content;return t.childCount>1&&(a=0),s<r-1&&(c=yx(c,e,n,r,s+1,a)),s>=n&&(c=e<0?l.contentMatchAt(0).fillBefore(c,a<=s).append(c):c.append(l.contentMatchAt(l.childCount).fillBefore(fe.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,l.copy(c))}function Lk(t,e,n){return e<t.openStart&&(t=new Ee(yx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new Ee(yx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const gT={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ik=null;function xT(){return Ik||(Ik=document.implementation.createHTMLDocument("title"))}let Zg=null;function MI(t){let e=window.trustedTypes;return e?(Zg||(Zg=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Zg.createHTML(t)):t}function jI(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=xT().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&gT[r[1].toLowerCase()])&&(t=s.map(a=>"<"+a+">").join("")+t+s.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=MI(t),s)for(let a=0;a<s.length;a++)n=n.querySelector(s[a])||n;return n}function OI(t){let e=t.querySelectorAll(On?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function _I(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:a,openEnd:l}=t;for(let c=r.length-2;c>=0;c-=2){let d=n.nodes[r[c]];if(!d||d.hasRequiredAttrs())break;s=fe.from(d.create(r[c+1],s)),a++,l++}return new Ee(s,a,l)}const $n={},Vn={},RI={touchstart:!0,touchmove:!0};class DI{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function LI(t){for(let e in $n){let n=$n[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{zI(t,r)&&!jb(t,r)&&(t.editable||!(r.type in Vn))&&n(t,r)},RI[e]?{passive:!0}:void 0)}In&&t.dom.addEventListener("input",()=>null),vx(t)}function qi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function II(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function vx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>jb(t,r))})}function jb(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function zI(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function BI(t,e){!jb(t,e)&&$n[e.type]&&(t.editable||!(e.type in Vn))&&$n[e.type](t,e)}Vn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!yT(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!($s&&On&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),ul&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,Oa(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||NI(t,n)?n.preventDefault():qi(t,"key")};Vn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Vn.keypress=(t,e)=>{let n=e;if(yT(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||_r&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Be)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),a=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",l=>l(t,r.$from.pos,r.$to.pos,s,a))&&t.dispatch(a()),n.preventDefault()}};function sp(t){return{left:t.clientX,top:t.clientY}}function PI(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Ob(t,e,n,r,s){if(r==-1)return!1;let a=t.state.doc.resolve(r);for(let l=a.depth+1;l>0;l--)if(t.someProp(e,c=>l>a.depth?c(t,n,a.nodeAfter,a.before(l),s,!0):c(t,n,a.node(l),a.before(l),s,!1)))return!0;return!1}function Jo(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function HI(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ze.isSelectable(r)?(Jo(t,new ze(n)),!0):!1}function FI(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof ze&&(r=n.node);let a=t.state.doc.resolve(e);for(let l=a.depth+1;l>0;l--){let c=l>a.depth?a.nodeAfter:a.node(l);if(ze.isSelectable(c)){r&&n.$from.depth>0&&l>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?s=a.before(n.$from.depth):s=a.before(l);break}}return s!=null?(Jo(t,ze.create(t.state.doc,s)),!0):!1}function UI(t,e,n,r,s){return Ob(t,"handleClickOn",e,n,r)||t.someProp("handleClick",a=>a(t,e,r))||(s?FI(t,n):HI(t,n))}function $I(t,e,n,r){return Ob(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function VI(t,e,n,r){return Ob(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||qI(t,n,r)}function qI(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Jo(t,Be.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let a=s.depth+1;a>0;a--){let l=a>s.depth?s.nodeAfter:s.node(a),c=s.before(a);if(l.inlineContent)Jo(t,Be.create(r,c+1,c+1+l.content.size));else if(ze.isSelectable(l))Jo(t,ze.create(r,c));else continue;return!0}}function _b(t){return Kf(t)}const bT=_r?"metaKey":"ctrlKey";$n.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=_b(t),s=Date.now(),a="singleClick";s-t.input.lastClick.time<500&&PI(n,t.input.lastClick)&&!n[bT]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:a,button:n.button};let l=t.posAtCoords(sp(n));l&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new WI(t,l,n,!!r)):(a=="doubleClick"?$I:VI)(t,l.pos,l.inside,n)?n.preventDefault():qi(t,"pointer"))};class WI{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[bT],this.allowDefault=r.shiftKey;let a,l;if(n.inside>-1)a=e.state.doc.nodeAt(n.inside),l=n.inside;else{let m=e.state.doc.resolve(n.pos);a=m.parent,l=m.depth?m.before():0}const c=s?null:r.target,d=c?e.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:p}=e.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||p instanceof ze&&p.from<=l&&p.to>l)&&(this.mightDrag={node:a,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Dr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),qi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ks(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(sp(e))),this.updateAllowDefault(e),this.allowDefault||!n?qi(this.view,"pointer"):UI(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||In&&this.mightDrag&&!this.mightDrag.node.isAtom||On&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Jo(this.view,Ve.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):qi(this.view,"pointer")}move(e){this.updateAllowDefault(e),qi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}$n.touchstart=t=>{t.input.lastTouch=Date.now(),_b(t),qi(t,"pointer")};$n.touchmove=t=>{t.input.lastTouch=Date.now(),qi(t,"pointer")};$n.contextmenu=t=>_b(t);function yT(t,e){return t.composing?!0:In&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const GI=$s?5e3:-1;Vn.compositionstart=Vn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Be&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||On&&JN&&KI(t)))t.markCursor=t.state.storedMarks||n.marks(),Kf(t,!0),t.markCursor=null;else if(Kf(t,!e.selection.empty),Dr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,a=r.focusOffset;s&&s.nodeType==1&&a!=0;){let l=a<0?s.lastChild:s.childNodes[a-1];if(!l)break;if(l.nodeType==3){let c=t.domSelection();c&&c.collapse(l,l.nodeValue.length);break}else s=l,a=-1}}t.input.composing=!0}vT(t,GI)};function KI(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}Vn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,vT(t,20))};function vT(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Kf(t),e))}function wT(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=JI());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function YI(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=FL(e.focusNode,e.focusOffset),r=UL(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(n==a||r==a)return a;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let l=n.pmViewDesc;if(!(!l||!l.isText(n.nodeValue)))return r}}return n||r}function JI(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Kf(t,e=!1){if(!($s&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),wT(t),e||t.docView&&t.docView.dirty){let n=Tb(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function XI(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const ru=ar&&Gi<15||ul&&WL<604;$n.copy=Vn.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let a=ru?null:n.clipboardData,l=r.content(),{dom:c,text:d}=Mb(t,l);a?(n.preventDefault(),a.clearData(),a.setData("text/html",c.innerHTML),a.setData("text/plain",d)):XI(t,c),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function QI(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function ZI(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?su(t,r.value,null,s,e):su(t,r.textContent,r.innerHTML,s,e)},50)}function su(t,e,n,r,s){let a=fT(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,s,a||Ee.empty)))return!0;if(!a)return!1;let l=QI(a),c=l?t.state.tr.replaceSelectionWith(l,r):t.state.tr.replaceSelection(a);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function kT(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Vn.paste=(t,e)=>{let n=e;if(t.composing&&!$s)return;let r=ru?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&su(t,kT(r),r.getData("text/html"),s,n)?n.preventDefault():ZI(t,n)};class CT{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const ez=_r?"altKey":"ctrlKey";function ST(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[ez]}$n.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,a=s.empty?null:t.posAtCoords(sp(n)),l;if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof ze?s.to-1:s.to))){if(r&&r.mightDrag)l=ze.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&(l=ze.create(t.state.doc,g.posBefore))}}let c=(l||t.state.selection).content(),{dom:d,text:p,slice:m}=Mb(t,c);(!n.dataTransfer.files.length||!On||YN>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(ru?"Text":"text/html",d.innerHTML),n.dataTransfer.effectAllowed="copyMove",ru||n.dataTransfer.setData("text/plain",p),t.dragging=new CT(m,ST(t,n),l)};$n.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Vn.dragover=Vn.dragenter=(t,e)=>e.preventDefault();Vn.drop=(t,e)=>{try{tz(t,e,t.dragging)}finally{t.dragging=null}};function tz(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(sp(e));if(!r)return;let s=t.state.doc.resolve(r.pos),a=n&&n.slice;a?t.someProp("transformPasted",v=>{a=v(a,t,!1)}):a=fT(t,kT(e.dataTransfer),ru?null:e.dataTransfer.getData("text/html"),!1,s);let l=!!(n&&ST(t,e));if(t.someProp("handleDrop",v=>v(t,e,a||Ee.empty,l))){e.preventDefault();return}if(!a)return;e.preventDefault();let c=a?AN(t.state.doc,s.pos,a):s.pos;c==null&&(c=s.pos);let d=t.state.tr;if(l){let{node:v}=n;v?v.replace(d):d.deleteSelection()}let p=d.mapping.map(c),m=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,g=d.doc;if(m?d.replaceRangeWith(p,p,a.content.firstChild):d.replaceRange(p,p,a),d.doc.eq(g))return;let b=d.doc.resolve(p);if(m&&ze.isSelectable(a.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(a.content.firstChild))d.setSelection(new ze(b));else{let v=d.mapping.map(c);d.mapping.maps[d.mapping.maps.length-1].forEach((w,C,k,N)=>v=N),d.setSelection(Ab(t,b,d.doc.resolve(v)))}t.focus(),t.dispatch(d.setMeta("uiEvent","drop"))}$n.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ks(t)},20))};$n.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};$n.beforeinput=(t,e)=>{if(On&&$s&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,Oa(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in Vn)$n[t]=Vn[t];function iu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Yf{constructor(e,n){this.toDOM=e,this.spec=n||$a,this.side=this.spec.side||0}map(e,n,r,s){let{pos:a,deleted:l}=e.mapResult(n.from+s,this.side<0?-1:1);return l?null:new yn(a-r,a-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Yf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&iu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Yi{constructor(e,n){this.attrs=e,this.spec=n||$a}map(e,n,r,s){let a=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,l=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return a>=l?null:new yn(a,l,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Yi&&iu(this.attrs,e.attrs)&&iu(this.spec,e.spec)}static is(e){return e.type instanceof Yi}destroy(){}}class Rb{constructor(e,n){this.attrs=e,this.spec=n||$a}map(e,n,r,s){let a=e.mapResult(n.from+s,1);if(a.deleted)return null;let l=e.mapResult(n.to+s,-1);return l.deleted||l.pos<=a.pos?null:new yn(a.pos-r,l.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),a;return s==n.from&&!(a=e.child(r)).isText&&s+a.nodeSize==n.to}eq(e){return this==e||e instanceof Rb&&iu(this.attrs,e.attrs)&&iu(this.spec,e.spec)}destroy(){}}class yn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new yn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new yn(e,e,new Yf(n,r))}static inline(e,n,r,s){return new yn(e,n,new Yi(r,s))}static node(e,n,r,s){return new yn(e,n,new Rb(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Yi}get widget(){return this.type instanceof Yf}}const Uo=[],$a={};class Nt{constructor(e,n){this.local=e.length?e:Uo,this.children=n.length?n:Uo}static create(e,n){return n.length?Jf(n,e,0,$a):Ln}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,a){for(let l=0;l<this.local.length;l++){let c=this.local[l];c.from<=n&&c.to>=e&&(!a||a(c.spec))&&r.push(c.copy(c.from+s,c.to+s))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<n&&this.children[l+1]>e){let c=this.children[l]+1;this.children[l+2].findInner(e-c,n-c,r,s+c,a)}}map(e,n,r){return this==Ln||e.maps.length==0?this:this.mapInner(e,n,0,0,r||$a)}mapInner(e,n,r,s,a){let l;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(e,r,s);d&&d.type.valid(n,d)?(l||(l=[])).push(d):a.onRemove&&a.onRemove(this.local[c].spec)}return this.children.length?nz(this.children,l||[],e,n,r,s,a):l?new Nt(l.sort(Va),Uo):Ln}add(e,n){return n.length?this==Ln?Nt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,a=0;e.forEach((c,d)=>{let p=d+r,m;if(m=NT(n,c,p)){for(s||(s=this.children.slice());a<s.length&&s[a]<d;)a+=3;s[a]==d?s[a+2]=s[a+2].addInner(c,m,p+1):s.splice(a,0,d,d+c.nodeSize,Jf(m,c,p+1,$a)),a+=3}});let l=ET(a?TT(n):n,-r);for(let c=0;c<l.length;c++)l[c].type.valid(e,l[c])||l.splice(c--,1);return new Nt(l.length?this.local.concat(l).sort(Va):this.local,s||this.children)}remove(e){return e.length==0||this==Ln?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let a=0;a<r.length;a+=3){let l,c=r[a]+n,d=r[a+1]+n;for(let m=0,g;m<e.length;m++)(g=e[m])&&g.from>c&&g.to<d&&(e[m]=null,(l||(l=[])).push(g));if(!l)continue;r==this.children&&(r=this.children.slice());let p=r[a+2].removeInner(l,c+1);p!=Ln?r[a+2]=p:(r.splice(a,3),a-=3)}if(s.length){for(let a=0,l;a<e.length;a++)if(l=e[a])for(let c=0;c<s.length;c++)s[c].eq(l,n)&&(s==this.local&&(s=this.local.slice()),s.splice(c--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Nt(s,r):Ln}forChild(e,n){if(this==Ln)return this;if(n.isLeaf)return Nt.empty;let r,s;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=e){this.children[c]==e&&(r=this.children[c+2]);break}let a=e+1,l=a+n.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<l&&d.to>a&&d.type instanceof Yi){let p=Math.max(a,d.from)-a,m=Math.min(l,d.to)-a;p<m&&(s||(s=[])).push(d.copy(p,m))}}if(s){let c=new Nt(s.sort(Va),Uo);return r?new Ii([c,r]):c}return r||Ln}eq(e){if(this==e)return!0;if(!(e instanceof Nt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Db(this.localsInner(e))}localsInner(e){if(this==Ln)return Uo;if(e.inlineContent||!this.local.some(Yi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Yi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Nt.empty=new Nt([],[]);Nt.removeOverlap=Db;const Ln=Nt.empty;class Ii{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,$a));return Ii.from(r)}forChild(e,n){if(n.isLeaf)return Nt.empty;let r=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(e,n);a!=Ln&&(a instanceof Ii?r=r.concat(a.members):r.push(a))}return Ii.from(r)}eq(e){if(!(e instanceof Ii)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(e);if(a.length)if(!n)n=a;else{r&&(n=n.slice(),r=!1);for(let l=0;l<a.length;l++)n.push(a[l])}}return n?Db(r?n:n.sort(Va)):Uo}static from(e){switch(e.length){case 0:return Ln;case 1:return e[0];default:return new Ii(e.every(n=>n instanceof Nt)?e:e.reduce((n,r)=>n.concat(r instanceof Nt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function nz(t,e,n,r,s,a,l){let c=t.slice();for(let p=0,m=a;p<n.maps.length;p++){let g=0;n.maps[p].forEach((b,v,w,C)=>{let k=C-w-(v-b);for(let N=0;N<c.length;N+=3){let M=c[N+1];if(M<0||b>M+m-g)continue;let _=c[N]+m-g;v>=_?c[N+1]=b<=_?-2:-1:b>=m&&k&&(c[N]+=k,c[N+1]+=k)}g+=k}),m=n.maps[p].map(m,-1)}let d=!1;for(let p=0;p<c.length;p+=3)if(c[p+1]<0){if(c[p+1]==-2){d=!0,c[p+1]=-1;continue}let m=n.map(t[p]+a),g=m-s;if(g<0||g>=r.content.size){d=!0;continue}let b=n.map(t[p+1]+a,-1),v=b-s,{index:w,offset:C}=r.content.findIndex(g),k=r.maybeChild(w);if(k&&C==g&&C+k.nodeSize==v){let N=c[p+2].mapInner(n,k,m+1,t[p]+a+1,l);N!=Ln?(c[p]=g,c[p+1]=v,c[p+2]=N):(c[p+1]=-2,d=!0)}else d=!0}if(d){let p=rz(c,t,e,n,s,a,l),m=Jf(p,r,0,l);e=m.local;for(let g=0;g<c.length;g+=3)c[g+1]<0&&(c.splice(g,3),g-=3);for(let g=0,b=0;g<m.children.length;g+=3){let v=m.children[g];for(;b<c.length&&c[b]<v;)b+=3;c.splice(b,0,m.children[g],m.children[g+1],m.children[g+2])}}return new Nt(e.sort(Va),c)}function ET(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new yn(s.from+e,s.to+e,s.type))}return n}function rz(t,e,n,r,s,a,l){function c(d,p){for(let m=0;m<d.local.length;m++){let g=d.local[m].map(r,s,p);g?n.push(g):l.onRemove&&l.onRemove(d.local[m].spec)}for(let m=0;m<d.children.length;m+=3)c(d.children[m+2],d.children[m]+p+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],e[d]+a+1);return n}function NT(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let a=0,l;a<t.length;a++)(l=t[a])&&l.from>n&&l.to<r&&((s||(s=[])).push(l),t[a]=null);return s}function TT(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Jf(t,e,n,r){let s=[],a=!1;e.forEach((c,d)=>{let p=NT(t,c,d+n);if(p){a=!0;let m=Jf(p,c,n+d+1,r);m!=Ln&&s.push(d,d+c.nodeSize,m)}});let l=ET(a?TT(t):t,-n).sort(Va);for(let c=0;c<l.length;c++)l[c].type.valid(e,l[c])||(r.onRemove&&r.onRemove(l[c].spec),l.splice(c--,1));return l.length||s.length?new Nt(l,s):Ln}function Va(t,e){return t.from-e.from||t.to-e.to}function Db(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let a=e[s];if(a.from==r.from){a.to!=r.to&&(e==t&&(e=t.slice()),e[s]=a.copy(a.from,r.to),zk(e,s+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,a.from),zk(e,s,r.copy(a.from,r.to)));break}}}return e}function zk(t,e,n){for(;e<t.length&&Va(n,t[e])>0;)e++;t.splice(e,0,n)}function e0(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Ln&&e.push(r)}),t.cursorWrapper&&e.push(Nt.create(t.state.doc,[t.cursorWrapper.deco])),Ii.from(e)}const sz={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},iz=ar&&Gi<=11;class az{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class oz{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new az,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);ar&&Gi<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():In&&e.composing&&r.some(s=>s.type=="childList"&&s.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),iz&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,sz)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Mk(this.view)){if(this.suppressingSelectionUpdates)return Ks(this.view);if(ar&&Gi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ya(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let a=e.focusNode;a;a=cl(a))n.add(a);for(let a=e.anchorNode;a;a=cl(a))if(n.has(a)){r=a;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Mk(e)&&!this.ignoreSelectionChange(r),a=-1,l=-1,c=!1,d=[];if(e.editable)for(let m=0;m<n.length;m++){let g=this.registerMutation(n[m],d);g&&(a=a<0?g.from:Math.min(g.from,a),l=l<0?g.to:Math.max(g.to,l),g.typeOver&&(c=!0))}if(d.some(m=>m.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let m of d)if(m.nodeName=="BR"&&m.parentNode){let g=m.nextSibling;g&&g.nodeType==1&&g.contentEditable=="false"&&m.parentNode.removeChild(m)}}else if(Dr&&d.length){let m=d.filter(g=>g.nodeName=="BR");if(m.length==2){let[g,b]=m;g.parentNode&&g.parentNode.parentNode==b.parentNode?b.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let b of m){let v=b.parentNode;v&&v.nodeName=="LI"&&(!g||uz(e,g)!=v)&&b.remove()}}}let p=null;a<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&np(r)&&(p=Tb(e))&&p.eq(Ve.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ks(e),this.currentSelection.set(r),e.scrollToSelection()):(a>-1||s)&&(a>-1&&(e.docView.markDirty(a,l),lz(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,dz(e,d)),this.handleDOMChange(a,l,c,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ks(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let m=0;m<e.addedNodes.length;m++){let g=e.addedNodes[m];n.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,a=e.nextSibling;if(ar&&Gi<=11&&e.addedNodes.length)for(let m=0;m<e.addedNodes.length;m++){let{previousSibling:g,nextSibling:b}=e.addedNodes[m];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(s=g),(!b||Array.prototype.indexOf.call(e.addedNodes,b)<0)&&(a=b)}let l=s&&s.parentNode==e.target?Mn(s)+1:0,c=r.localPosFromDOM(e.target,l,-1),d=a&&a.parentNode==e.target?Mn(a):e.target.childNodes.length,p=r.localPosFromDOM(e.target,d,1);return{from:c,to:p}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Bk=new WeakMap,Pk=!1;function lz(t){if(!Bk.has(t)&&(Bk.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Dr,Pk)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Pk=!0}}function Hk(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,a=e.endOffset,l=t.domAtPos(t.state.selection.anchor);return Ya(l.node,l.offset,s,a)&&([n,r,s,a]=[s,a,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:a}}function cz(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return Hk(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?Hk(t,n):null}function uz(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function dz(t,e){var n;let{focusNode:r,focusOffset:s}=t.domSelectionRange();for(let a of e)if(((n=a.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let l=a.nextSibling;for(;l&&l.nodeName!="TD"&&l.nodeName!="TH";)l=l.nextSibling;if(l){let c=l;for(;;){let d=c.firstChild;if(!d||d.nodeType!=1||d.contentEditable=="false"||/^(BR|IMG)$/.test(d.nodeName))break;c=d}c.insertBefore(a,c.firstChild),r==a&&t.domSelection().collapse(a,s)}else a.parentNode.removeChild(a)}}function fz(t,e,n){let{node:r,fromOffset:s,toOffset:a,from:l,to:c}=t.docView.parseRange(e,n),d=t.domSelectionRange(),p,m=d.anchorNode;if(m&&t.dom.contains(m.nodeType==1?m:m.parentNode)&&(p=[{node:m,offset:d.anchorOffset}],np(d)||p.push({node:d.focusNode,offset:d.focusOffset})),On&&t.input.lastKeyCode===8)for(let k=a;k>s;k--){let N=r.childNodes[k-1],M=N.pmViewDesc;if(N.nodeName=="BR"&&!M){a=k;break}if(!M||M.size)break}let g=t.state.doc,b=t.someProp("domParser")||Lc.fromSchema(t.state.schema),v=g.resolve(l),w=null,C=b.parse(r,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:s,to:a,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:p,ruleFromNode:hz,context:v});if(p&&p[0].pos!=null){let k=p[0].pos,N=p[1]&&p[1].pos;N==null&&(N=k),w={anchor:k+l,head:N+l}}return{doc:C,sel:w,from:l,to:c}}function hz(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(In&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||In&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const pz=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function mz(t,e,n,r,s){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let j=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,F=Tb(t,j);if(F&&!t.state.selection.eq(F)){if(On&&$s&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",te=>te(t,Oa(13,"Enter"))))return;let G=t.state.tr.setSelection(F);j=="pointer"?G.setMeta("pointer",!0):j=="key"&&G.scrollIntoView(),a&&G.setMeta("composition",a),t.dispatch(G)}return}let l=t.state.doc.resolve(e),c=l.sharedDepth(n);e=l.before(c+1),n=t.state.doc.resolve(n).after(c+1);let d=t.state.selection,p=fz(t,e,n),m=t.state.doc,g=m.slice(p.from,p.to),b,v;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(b=t.state.selection.to,v="end"):(b=t.state.selection.from,v="start"),t.input.lastKeyCode=null;let w=bz(g.content,p.doc.content,p.from,b,v);if(w&&t.input.domChangeCount++,(ul&&t.input.lastIOSEnter>Date.now()-225||$s)&&s.some(j=>j.nodeType==1&&!pz.test(j.nodeName))&&(!w||w.endA>=w.endB)&&t.someProp("handleKeyDown",j=>j(t,Oa(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!w)if(r&&d instanceof Be&&!d.empty&&d.$head.sameParent(d.$anchor)&&!t.composing&&!(p.sel&&p.sel.anchor!=p.sel.head))w={start:d.from,endA:d.to,endB:d.to};else{if(p.sel){let j=Fk(t,t.state.doc,p.sel);if(j&&!j.eq(t.state.selection)){let F=t.state.tr.setSelection(j);a&&F.setMeta("composition",a),t.dispatch(F)}}return}t.state.selection.from<t.state.selection.to&&w.start==w.endB&&t.state.selection instanceof Be&&(w.start>t.state.selection.from&&w.start<=t.state.selection.from+2&&t.state.selection.from>=p.from?w.start=t.state.selection.from:w.endA<t.state.selection.to&&w.endA>=t.state.selection.to-2&&t.state.selection.to<=p.to&&(w.endB+=t.state.selection.to-w.endA,w.endA=t.state.selection.to)),ar&&Gi<=11&&w.endB==w.start+1&&w.endA==w.start&&w.start>p.from&&p.doc.textBetween(w.start-p.from-1,w.start-p.from+1)==" "&&(w.start--,w.endA--,w.endB--);let C=p.doc.resolveNoCache(w.start-p.from),k=p.doc.resolveNoCache(w.endB-p.from),N=m.resolve(w.start),M=C.sameParent(k)&&C.parent.inlineContent&&N.end()>=w.endA;if((ul&&t.input.lastIOSEnter>Date.now()-225&&(!M||s.some(j=>j.nodeName=="DIV"||j.nodeName=="P"))||!M&&C.pos<p.doc.content.size&&(!C.sameParent(k)||!C.parent.inlineContent)&&C.pos<k.pos&&!/\S/.test(p.doc.textBetween(C.pos,k.pos,"","")))&&t.someProp("handleKeyDown",j=>j(t,Oa(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>w.start&&xz(m,w.start,w.endA,C,k)&&t.someProp("handleKeyDown",j=>j(t,Oa(8,"Backspace")))){$s&&On&&t.domObserver.suppressSelectionUpdates();return}On&&w.endB==w.start&&(t.input.lastChromeDelete=Date.now()),$s&&!M&&C.start()!=k.start()&&k.parentOffset==0&&C.depth==k.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==w.endA&&(w.endB-=2,k=p.doc.resolveNoCache(w.endB-p.from),setTimeout(()=>{t.someProp("handleKeyDown",function(j){return j(t,Oa(13,"Enter"))})},20));let _=w.start,P=w.endA,I=j=>{let F=j||t.state.tr.replace(_,P,p.doc.slice(w.start-p.from,w.endB-p.from));if(p.sel){let G=Fk(t,F.doc,p.sel);G&&!(On&&t.composing&&G.empty&&(w.start!=w.endB||t.input.lastChromeDelete<Date.now()-100)&&(G.head==_||G.head==F.mapping.map(P)-1)||ar&&G.empty&&G.head==_)&&F.setSelection(G)}return a&&F.setMeta("composition",a),F.scrollIntoView()},q;if(M)if(C.pos==k.pos){ar&&Gi<=11&&C.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ks(t),20));let j=I(t.state.tr.delete(_,P)),F=m.resolve(w.start).marksAcross(m.resolve(w.endA));F&&j.ensureMarks(F),t.dispatch(j)}else if(w.endA==w.endB&&(q=gz(C.parent.content.cut(C.parentOffset,k.parentOffset),N.parent.content.cut(N.parentOffset,w.endA-N.start())))){let j=I(t.state.tr);q.type=="add"?j.addMark(_,P,q.mark):j.removeMark(_,P,q.mark),t.dispatch(j)}else if(C.parent.child(C.index()).isText&&C.index()==k.index()-(k.textOffset?0:1)){let j=C.parent.textBetween(C.parentOffset,k.parentOffset),F=()=>I(t.state.tr.insertText(j,_,P));t.someProp("handleTextInput",G=>G(t,_,P,j,F))||t.dispatch(F())}else t.dispatch(I());else t.dispatch(I())}function Fk(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Ab(t,e.resolve(n.anchor),e.resolve(n.head))}function gz(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,a=r,l,c,d;for(let m=0;m<r.length;m++)s=r[m].removeFromSet(s);for(let m=0;m<n.length;m++)a=n[m].removeFromSet(a);if(s.length==1&&a.length==0)c=s[0],l="add",d=m=>m.mark(c.addToSet(m.marks));else if(s.length==0&&a.length==1)c=a[0],l="remove",d=m=>m.mark(c.removeFromSet(m.marks));else return null;let p=[];for(let m=0;m<e.childCount;m++)p.push(d(e.child(m)));if(fe.from(p).eq(t))return{mark:c,type:l}}function xz(t,e,n,r,s){if(n-e<=s.pos-r.pos||t0(r,!0,!1)<s.pos)return!1;let a=t.resolve(e);if(!r.parent.isTextblock){let c=a.nodeAfter;return c!=null&&n==e+c.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let l=t.resolve(t0(a,!0,!0));return!l.parent.isTextblock||l.pos>n||t0(l,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function t0(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let a=t.node(r).maybeChild(t.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function bz(t,e,n,r,s){let a=t.findDiffStart(e,n);if(a==null)return null;let{a:l,b:c}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let d=Math.max(0,a-Math.min(l,c));r-=l+d-a}if(l<a&&t.size<e.size){let d=r<=a&&r>=l?a-r:0;a-=d,a&&a<e.size&&Uk(e.textBetween(a-1,a+1))&&(a+=d?1:-1),c=a+(c-l),l=a}else if(c<a){let d=r<=a&&r>=c?a-r:0;a-=d,a&&a<t.size&&Uk(t.textBetween(a-1,a+1))&&(a+=d?1:-1),l=a+(l-c),c=a}return{start:a,endA:l,endB:c}}function Uk(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class AT{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new DI,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Gk),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=qk(this),Vk(this),this.nodeViews=Wk(this),this.docView=Ck(this.state.doc,$k(this),e0(this),this.dom,this),this.domObserver=new oz(this,(r,s,a,l)=>mz(this,r,s,a,l)),this.domObserver.start(),LI(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&vx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Gk),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,a=!1,l=!1;e.storedMarks&&this.composing&&(wT(this),l=!0),this.state=e;let c=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(c||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let v=Wk(this);vz(v,this.nodeViews)&&(this.nodeViews=v,a=!0)}(c||n.handleDOMEvents!=this._props.handleDOMEvents)&&vx(this),this.editable=qk(this),Vk(this);let d=e0(this),p=$k(this),m=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",g=a||!this.docView.matchesNode(e.doc,p,d);(g||!e.selection.eq(s.selection))&&(l=!0);let b=m=="preserve"&&l&&this.dom.style.overflowAnchor==null&&YL(this);if(l){this.domObserver.stop();let v=g&&(ar||On)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&yz(s.selection,e.selection);if(g){let w=On?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=YI(this)),(a||!this.docView.update(e.doc,p,d,this))&&(this.docView.updateOuterDeco(p),this.docView.destroy(),this.docView=Ck(e.doc,p,d,this.dom,this)),w&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&yI(this))?Ks(this,v):(cT(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),m=="reset"?this.dom.scrollTop=0:m=="to selection"?this.scrollToSelection():b&&JL(b)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ze){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&xk(this,n.getBoundingClientRect(),e)}else xk(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let a=r.from+(this.state.doc.content.size-n.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==r.node&&(s=a)}this.dragging=new CT(e.slice,e.move,s<0?void 0:ze.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let l=0;l<this.directPlugins.length;l++){let c=this.directPlugins[l].props[e];if(c!=null&&(s=n?n(c):c))return s}let a=this.state.plugins;if(a)for(let l=0;l<a.length;l++){let c=a[l].props[e];if(c!=null&&(s=n?n(c):c))return s}}hasFocus(){if(ar){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&XL(this.dom),Ks(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return nI(this,e)}coordsAtPos(e,n=1){return tT(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return oI(this,n||this.state,e)}pasteHTML(e,n){return su(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return su(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Mb(this,e)}destroy(){this.docView&&(II(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],e0(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,PL())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return BI(this,e)}domSelectionRange(){let e=this.domSelection();return e?In&&this.root.nodeType===11&&VL(this.dom.ownerDocument)==this.dom&&cz(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}AT.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function $k(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[yn.node(0,t.state.doc.content.size,e)]}function Vk(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:yn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function qk(t){return!t.someProp("editable",e=>e(t.state)===!1)}function yz(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Wk(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function vz(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function Gk(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Qi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},wz=typeof navigator<"u"&&/Mac/.test(navigator.platform),kz=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var jn=0;jn<10;jn++)Qi[48+jn]=Qi[96+jn]=String(jn);for(var jn=1;jn<=24;jn++)Qi[jn+111]="F"+jn;for(var jn=65;jn<=90;jn++)Qi[jn]=String.fromCharCode(jn+32),Xf[jn]=String.fromCharCode(jn);for(var n0 in Qi)Xf.hasOwnProperty(n0)||(Xf[n0]=Qi[n0]);function Cz(t){var e=wz&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||kz&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Xf:Qi)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Sz=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Ez=typeof navigator<"u"&&/Win/.test(navigator.platform);function Nz(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,a,l;for(let c=0;c<e.length-1;c++){let d=e[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))Sz?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),l&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function Tz(t){let e=Object.create(null);for(let n in t)e[Nz(n)]=t[n];return e}function r0(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Az(t){return new _t({props:{handleKeyDown:Lb(t)}})}function Lb(t){let e=Tz(t);return function(n,r){let s=Cz(r),a,l=e[r0(s,r)];if(l&&l(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let c=e[r0(s,r,!1)];if(c&&c(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Ez&&r.ctrlKey&&r.altKey)&&(a=Qi[r.keyCode])&&a!=s){let c=e[r0(a,r)];if(c&&c(n.state,n.dispatch,n))return!0}}return!1}}var Mz=Object.defineProperty,Ib=(t,e)=>{for(var n in e)Mz(t,n,{get:e[n],enumerable:!0})};function ip(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:a}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,a=n.storedMarks,n}}}var ap=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,a=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...p)=>{const m=c(...p)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:a}=r,l=[],c=!!t,d=t||s.tr,p=()=>(!c&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(d),l.every(g=>g===!0)),m={...Object.fromEntries(Object.entries(n).map(([g,b])=>[g,(...w)=>{const C=this.buildProps(d,e),k=b(...w)(C);return l.push(k),m}])),run:p};return m}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,a=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([c,d])=>[c,(...p)=>d(...p)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:a}=r,l={tr:t,editor:r,view:a,state:ip({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...p)=>d(...p)(l)]))}};return l}},MT={};Ib(MT,{blur:()=>jz,clearContent:()=>Oz,clearNodes:()=>_z,command:()=>Rz,createParagraphNear:()=>Dz,cut:()=>Lz,deleteCurrentNode:()=>Iz,deleteNode:()=>zz,deleteRange:()=>Bz,deleteSelection:()=>Pz,enter:()=>Hz,exitCode:()=>Fz,extendMarkRange:()=>Uz,first:()=>$z,focus:()=>qz,forEach:()=>Wz,insertContent:()=>Gz,insertContentAt:()=>Jz,joinBackward:()=>Zz,joinDown:()=>Qz,joinForward:()=>e8,joinItemBackward:()=>t8,joinItemForward:()=>n8,joinTextblockBackward:()=>r8,joinTextblockForward:()=>s8,joinUp:()=>Xz,keyboardShortcut:()=>a8,lift:()=>o8,liftEmptyBlock:()=>l8,liftListItem:()=>c8,newlineInCode:()=>u8,resetAttributes:()=>d8,scrollIntoView:()=>f8,selectAll:()=>h8,selectNodeBackward:()=>p8,selectNodeForward:()=>m8,selectParentNode:()=>g8,selectTextblockEnd:()=>x8,selectTextblockStart:()=>b8,setContent:()=>y8,setMark:()=>B8,setMeta:()=>P8,setNode:()=>H8,setNodeSelection:()=>F8,setTextDirection:()=>U8,setTextSelection:()=>$8,sinkListItem:()=>V8,splitBlock:()=>q8,splitListItem:()=>W8,toggleList:()=>G8,toggleMark:()=>K8,toggleNode:()=>Y8,toggleWrap:()=>J8,undoInputRule:()=>X8,unsetAllMarks:()=>Q8,unsetMark:()=>Z8,unsetTextDirection:()=>eB,updateAttributes:()=>tB,wrapIn:()=>nB,wrapInList:()=>rB});var jz=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),Oz=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),_z=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:a,$to:l})=>{t.doc.nodesBetween(a.pos,l.pos,(c,d)=>{if(c.type.isText)return;const{doc:p,mapping:m}=e,g=p.resolve(m.map(d)),b=p.resolve(m.map(d+c.nodeSize)),v=g.blockRange(b);if(!v)return;const w=wl(v);if(c.type.isTextblock){const{defaultType:C}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(v.start,C)}(w||w===0)&&e.lift(v,w)})}),!0},Rz=t=>e=>t(e),Dz=()=>({state:t,dispatch:e})=>VN(t,e),Lz=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,a=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const l=r.mapping.map(e);return r.insert(l,a.content),r.setSelection(new Be(r.doc.resolve(Math.max(l-1,0)))),!0},Iz=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===r.type){if(e){const c=s.before(a),d=s.after(a);t.delete(c,d).scrollIntoView()}return!0}return!1};function sn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var zz=t=>({tr:e,state:n,dispatch:r})=>{const s=sn(t,n.schema),a=e.selection.$anchor;for(let l=a.depth;l>0;l-=1)if(a.node(l).type===s){if(r){const d=a.before(l),p=a.after(l);e.delete(d,p).scrollIntoView()}return!0}return!1},Bz=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},Pz=()=>({state:t,dispatch:e})=>wb(t,e),Hz=()=>({commands:t})=>t.keyboardShortcut("Enter"),Fz=()=>({state:t,dispatch:e})=>SL(t,e);function zb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Qf(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:zb(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function jT(t,e,n={}){return t.find(r=>r.type===e&&Qf(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function Kk(t,e,n={}){return!!jT(t,e,n)}function Bb(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(m=>m.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(m=>m.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!jT([...s.node.marks],e,n)))return;let l=s.index,c=t.start()+s.offset,d=l+1,p=c+s.node.nodeSize;for(;l>0&&Kk([...t.parent.child(l-1).marks],e,n);)l-=1,c-=t.parent.child(l).nodeSize;for(;d<t.parent.childCount&&Kk([...t.parent.child(d).marks],e,n);)p+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:p}}function ei(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var Uz=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const a=ei(t,r.schema),{doc:l,selection:c}=n,{$from:d,from:p,to:m}=c;if(s){const g=Bb(d,a,e);if(g&&g.from<=p&&g.to>=m){const b=Be.create(l,g.from,g.to);n.setSelection(b)}}return!0},$z=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function OT(t){return t instanceof Be}function Ia(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function _T(t,e=null){if(!e)return null;const n=Ve.atStart(t),r=Ve.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,a=r.to;return e==="all"?Be.create(t,Ia(0,s,a),Ia(t.content.size,s,a)):Be.create(t,Ia(e,s,a),Ia(e,s,a))}function Yk(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Zf(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function Vz(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var qz=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:a})=>{e={scrollIntoView:!0,...e};const l=()=>{(Zf()||Yk())&&r.dom.focus(),Vz()&&!Zf()&&!Yk()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};try{if(r.hasFocus()&&t===null||t===!1)return!0}catch{return!1}if(a&&t===null&&!OT(n.state.selection))return l(),!0;const c=_T(s.doc,t)||n.state.selection,d=n.state.selection.eq(c);return a&&(d||s.setSelection(c),d&&s.storedMarks&&s.setStoredMarks(s.storedMarks),l()),!0},Wz=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),Gz=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),RT=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&RT(r)}return t};function Kd(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return RT(n)}function au(t,e,n){if(t instanceof $r||t instanceof fe)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return fe.fromArray(t.map(c=>e.nodeFromJSON(c)));const l=e.nodeFromJSON(t);return n.errorOnInvalidContent&&l.check(),l}catch(a){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),au("",e,n)}if(s){if(n.errorOnInvalidContent){let l=!1,c="";const d=new xN({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:p=>(l=!0,c=typeof p=="string"?p:p.outerHTML,null)}]}})});if(n.slice?Lc.fromSchema(d).parseSlice(Kd(t),n.parseOptions):Lc.fromSchema(d).parse(Kd(t),n.parseOptions),n.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const a=Lc.fromSchema(e);return n.slice?a.parseSlice(Kd(t),n.parseOptions).content:a.parse(Kd(t),n.parseOptions)}return au("",e,n)}function Kz(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof bn||s instanceof vn))return;const a=t.mapping.maps[r];let l=0;a.forEach((c,d,p,m)=>{l===0&&(l=m)}),t.setSelection(Ve.near(t.doc.resolve(l),n))}var Yz=t=>!("type"in t),Jz=(t,e,n)=>({tr:r,dispatch:s,editor:a})=>{var l;if(s){n={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let c;const d=k=>{a.emit("contentError",{editor:a,error:k,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},p={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{au(e,a.schema,{parseOptions:p,errorOnInvalidContent:!0})}catch(k){d(k)}try{c=au(e,a.schema,{parseOptions:p,errorOnInvalidContent:(l=n.errorOnInvalidContent)!=null?l:a.options.enableContentCheck})}catch(k){return d(k),!1}let{from:m,to:g}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},b=!0,v=!0;if((Yz(c)?c:[c]).forEach(k=>{k.check(),b=b?k.isText&&k.marks.length===0:!1,v=v?k.isBlock:!1}),m===g&&v){const{parent:k}=r.doc.resolve(m);k.isTextblock&&!k.type.spec.code&&!k.childCount&&(m-=1,g+=1)}let C;if(b){if(Array.isArray(e))C=e.map(k=>k.text||"").join("");else if(e instanceof fe){let k="";e.forEach(N=>{N.text&&(k+=N.text)}),C=k}else typeof e=="object"&&e&&e.text?C=e.text:C=e;r.insertText(C,m,g)}else{C=c;const k=r.doc.resolve(m),N=k.node(),M=k.parentOffset===0,_=N.isText||N.isTextblock,P=N.content.size>0;M&&_&&P&&(m=Math.max(0,m-1)),r.replaceWith(m,g,C)}n.updateSelection&&Kz(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:m,text:C}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:m,text:C})}return!0},Xz=()=>({state:t,dispatch:e})=>wL(t,e),Qz=()=>({state:t,dispatch:e})=>kL(t,e),Zz=()=>({state:t,dispatch:e})=>zN(t,e),e8=()=>({state:t,dispatch:e})=>FN(t,e),t8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Zh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},n8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Zh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},r8=()=>({state:t,dispatch:e})=>yL(t,e),s8=()=>({state:t,dispatch:e})=>vL(t,e);function DT(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function i8(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,a,l;for(let c=0;c<e.length-1;c+=1){const d=e[c];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))Zf()||DT()?l=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),l&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}var a8=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const a=i8(t).split(/-(?!$)/),l=a.find(p=>!["Alt","Ctrl","Meta","Shift"].includes(p)),c=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{n.someProp("handleKeyDown",p=>p(n,c))});return d==null||d.steps.forEach(p=>{const m=p.map(r.mapping);m&&s&&r.maybeStep(m)}),!0};function Zi(t,e,n={}){const{from:r,to:s,empty:a}=t.selection,l=e?sn(e,t.schema):null,c=[];t.doc.nodesBetween(r,s,(g,b)=>{if(g.isText)return;const v=Math.max(r,b),w=Math.min(s,b+g.nodeSize);c.push({node:g,from:v,to:w})});const d=s-r,p=c.filter(g=>l?l.name===g.node.type.name:!0).filter(g=>Qf(g.node.attrs,n,{strict:!1}));return a?!!p.length:p.reduce((g,b)=>g+b.to-b.from,0)>=d}var o8=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return Zi(n,s,e)?CL(n,r):!1},l8=()=>({state:t,dispatch:e})=>qN(t,e),c8=t=>({state:e,dispatch:n})=>{const r=sn(t,e.schema);return LL(r)(e,n)},u8=()=>({state:t,dispatch:e})=>$N(t,e);function op(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Jk(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var d8=(t,e)=>({tr:n,state:r,dispatch:s})=>{let a=null,l=null;const c=op(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(a=sn(t,r.schema)),c==="mark"&&(l=ei(t,r.schema));let d=!1;return n.selection.ranges.forEach(p=>{r.doc.nodesBetween(p.$from.pos,p.$to.pos,(m,g)=>{a&&a===m.type&&(d=!0,s&&n.setNodeMarkup(g,void 0,Jk(m.attrs,e))),l&&m.marks.length&&m.marks.forEach(b=>{l===b.type&&(d=!0,s&&n.addMark(g,g+m.nodeSize,l.create(Jk(b.attrs,e))))})})}),d},f8=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),h8=()=>({tr:t,dispatch:e})=>{if(e){const n=new br(t.doc);t.setSelection(n)}return!0},p8=()=>({state:t,dispatch:e})=>PN(t,e),m8=()=>({state:t,dispatch:e})=>UN(t,e),g8=()=>({state:t,dispatch:e})=>TL(t,e),x8=()=>({state:t,dispatch:e})=>jL(t,e),b8=()=>({state:t,dispatch:e})=>ML(t,e);function wx(t,e,n={},r={}){return au(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var y8=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:a,dispatch:l,commands:c})=>{const{doc:d}=a;if(r.preserveWhitespace!=="full"){const p=wx(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return l&&a.replaceWith(0,d.content.size,p).setMeta("preventUpdate",!n),!0}return l&&a.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function LT(t,e){const n=ei(e,t.schema),{from:r,to:s,empty:a}=t.selection,l=[];a?(t.storedMarks&&l.push(...t.storedMarks),l.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,d=>{l.push(...d.marks)});const c=l.find(d=>d.type.name===n.name);return c?{...c.attrs}:{}}function IT(t,e){const n=new yb(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function v8(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function w8(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,a)=>{n(s)&&r.push({node:s,pos:a})}),r}function zT(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function lp(t){return e=>zT(e.$from,t)}function Le(t,e,n){return t.config[e]===void 0&&t.parent?Le(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Le(t.parent,e,n):null}):t.config[e]}function Pb(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Le(e,"addExtensions",n);return r?[e,...Pb(r())]:e}).flat(10)}function Hb(t,e){const n=to.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function BT(t){return typeof t=="function"}function ht(t,e=void 0,...n){return BT(t)?e?t.bind(e)(...n):t(...n):t}function k8(t={}){return Object.keys(t).length===0&&t.constructor===Object}function dl(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function PT(t){const e=[],{nodeExtensions:n,markExtensions:r}=dl(t),s=[...n,...r],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(l=>{const c={name:l.name,options:l.options,storage:l.storage,extensions:s},d=Le(l,"addGlobalAttributes",c);if(!d)return;d().forEach(m=>{m.types.forEach(g=>{Object.entries(m.attributes).forEach(([b,v])=>{e.push({type:g,name:b,attribute:{...a,...v}})})})})}),s.forEach(l=>{const c={name:l.name,options:l.options,storage:l.storage},d=Le(l,"addAttributes",c);if(!d)return;const p=d();Object.entries(p).forEach(([m,g])=>{const b={...a,...g};typeof(b==null?void 0:b.default)=="function"&&(b.default=b.default()),b!=null&&b.isRequired&&(b==null?void 0:b.default)===void 0&&delete b.default,e.push({type:l.name,name:m,attribute:b})})}),e}function Ot(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,a])=>{if(!r[s]){r[s]=a;return}if(s==="class"){const c=a?String(a).split(" "):[],d=r[s]?r[s].split(" "):[],p=c.filter(m=>!d.includes(m));r[s]=[...d,...p].join(" ")}else if(s==="style"){const c=a?a.split(";").map(m=>m.trim()).filter(Boolean):[],d=r[s]?r[s].split(";").map(m=>m.trim()).filter(Boolean):[],p=new Map;d.forEach(m=>{const[g,b]=m.split(":").map(v=>v.trim());p.set(g,b)}),c.forEach(m=>{const[g,b]=m.split(":").map(v=>v.trim());p.set(g,b)}),r[s]=Array.from(p.entries()).map(([m,g])=>`${m}: ${g}`).join("; ")}else r[s]=a}),r},{})}function ou(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Ot(n,r),{})}function C8(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Xk(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((a,l)=>{const c=l.attribute.parseHTML?l.attribute.parseHTML(n):C8(n.getAttribute(l.name));return c==null?a:{...a,[l.name]:c}},{});return{...r,...s}}}}function Qk(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&k8(n)?!1:n!=null))}function Zk(t){var e,n;const r={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(r.default=t.attribute.default),((n=t==null?void 0:t.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function S8(t,e){var n;const r=PT(t),{nodeExtensions:s,markExtensions:a}=dl(t),l=(n=s.find(p=>Le(p,"topNode")))==null?void 0:n.name,c=Object.fromEntries(s.map(p=>{const m=r.filter(N=>N.type===p.name),g={name:p.name,options:p.options,storage:p.storage,editor:e},b=t.reduce((N,M)=>{const _=Le(M,"extendNodeSchema",g);return{...N,..._?_(p):{}}},{}),v=Qk({...b,content:ht(Le(p,"content",g)),marks:ht(Le(p,"marks",g)),group:ht(Le(p,"group",g)),inline:ht(Le(p,"inline",g)),atom:ht(Le(p,"atom",g)),selectable:ht(Le(p,"selectable",g)),draggable:ht(Le(p,"draggable",g)),code:ht(Le(p,"code",g)),whitespace:ht(Le(p,"whitespace",g)),linebreakReplacement:ht(Le(p,"linebreakReplacement",g)),defining:ht(Le(p,"defining",g)),isolating:ht(Le(p,"isolating",g)),attrs:Object.fromEntries(m.map(Zk))}),w=ht(Le(p,"parseHTML",g));w&&(v.parseDOM=w.map(N=>Xk(N,m)));const C=Le(p,"renderHTML",g);C&&(v.toDOM=N=>C({node:N,HTMLAttributes:ou(N,m)}));const k=Le(p,"renderText",g);return k&&(v.toText=k),[p.name,v]})),d=Object.fromEntries(a.map(p=>{const m=r.filter(k=>k.type===p.name),g={name:p.name,options:p.options,storage:p.storage,editor:e},b=t.reduce((k,N)=>{const M=Le(N,"extendMarkSchema",g);return{...k,...M?M(p):{}}},{}),v=Qk({...b,inclusive:ht(Le(p,"inclusive",g)),excludes:ht(Le(p,"excludes",g)),group:ht(Le(p,"group",g)),spanning:ht(Le(p,"spanning",g)),code:ht(Le(p,"code",g)),attrs:Object.fromEntries(m.map(Zk))}),w=ht(Le(p,"parseHTML",g));w&&(v.parseDOM=w.map(k=>Xk(k,m)));const C=Le(p,"renderHTML",g);return C&&(v.toDOM=k=>C({mark:k,HTMLAttributes:ou(k,m)})),[p.name,v]}));return new xN({topNode:l,nodes:c,marks:d})}function E8(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function eh(t){return t.sort((n,r)=>{const s=Le(n,"priority")||100,a=Le(r,"priority")||100;return s>a?-1:s<a?1:0})}function HT(t){const e=eh(Pb(t)),n=E8(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function FT(t,e,n){const{from:r,to:s}=e,{blockSeparator:a=`

`,textSerializers:l={}}=n||{};let c="";return t.nodesBetween(r,s,(d,p,m,g)=>{var b;d.isBlock&&p>r&&(c+=a);const v=l==null?void 0:l[d.type.name];if(v)return m&&(c+=v({node:d,pos:p,parent:m,index:g,range:e})),!1;d.isText&&(c+=(b=d==null?void 0:d.text)==null?void 0:b.slice(Math.max(r,p)-p,s-p))}),c}function N8(t,e){const n={from:0,to:t.content.size};return FT(t,n,e)}function UT(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function T8(t,e){const n=sn(e,t.schema),{from:r,to:s}=t.selection,a=[];t.doc.nodesBetween(r,s,c=>{a.push(c)});const l=a.reverse().find(c=>c.type.name===n.name);return l?{...l.attrs}:{}}function $T(t,e){const n=op(typeof e=="string"?e:e.name,t.schema);return n==="node"?T8(t,e):n==="mark"?LT(t,e):{}}function A8(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function M8(t){const e=A8(t);return e.length===1?e:e.filter((n,r)=>!e.filter((a,l)=>l!==r).some(a=>n.oldRange.from>=a.oldRange.from&&n.oldRange.to<=a.oldRange.to&&n.newRange.from>=a.newRange.from&&n.newRange.to<=a.newRange.to))}function VT(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,a)=>{const l=[];if(s.ranges.length)s.forEach((c,d)=>{l.push({from:c,to:d})});else{const{from:c,to:d}=n[a];if(c===void 0||d===void 0)return;l.push({from:c,to:d})}l.forEach(({from:c,to:d})=>{const p=e.slice(a).map(c,-1),m=e.slice(a).map(d),g=e.invert().map(p,-1),b=e.invert().map(m);r.push({oldRange:{from:g,to:b},newRange:{from:p,to:m}})})}),M8(r)}function Fb(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const a=n.resolve(t),l=Bb(a,s.type);l&&r.push({mark:s,...l})}):n.nodesBetween(t,e,(s,a)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(l=>({from:a,to:a+s.nodeSize,mark:l})))}),r}var j8=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let a=r,l=null;for(;a>0&&l===null;){const c=s.node(a);(c==null?void 0:c.type.name)===e?l=c:a-=1}return[l,a]};function Yd(t,e){return e.nodes[t]||e.marks[t]||null}function bf(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(a=>a.type===e&&a.name===r);return s?s.attribute.keepOnSplit:!1}))}var O8=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,a,l,c)=>{var d,p;const m=((p=(d=s.type.spec).toText)==null?void 0:p.call(d,{node:s,pos:a,parent:l,index:c}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?m:m.slice(0,Math.max(0,r-a))}),n};function kx(t,e,n={}){const{empty:r,ranges:s}=t.selection,a=e?ei(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(g=>a?a.name===g.type.name:!0).find(g=>Qf(g.attrs,n,{strict:!1}));let l=0;const c=[];if(s.forEach(({$from:g,$to:b})=>{const v=g.pos,w=b.pos;t.doc.nodesBetween(v,w,(C,k)=>{if(!C.isText&&!C.marks.length)return;const N=Math.max(v,k),M=Math.min(w,k+C.nodeSize),_=M-N;l+=_,c.push(...C.marks.map(P=>({mark:P,from:N,to:M})))})}),l===0)return!1;const d=c.filter(g=>a?a.name===g.mark.type.name:!0).filter(g=>Qf(g.mark.attrs,n,{strict:!1})).reduce((g,b)=>g+b.to-b.from,0),p=c.filter(g=>a?g.mark.type!==a&&g.mark.type.excludes(a):!0).reduce((g,b)=>g+b.to-b.from,0);return(d>0?d+p:d)>=l}function _8(t,e,n={}){if(!e)return Zi(t,null,n)||kx(t,null,n);const r=op(e,t.schema);return r==="node"?Zi(t,e,n):r==="mark"?kx(t,e,n):!1}var R8=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const a=lp(c=>c.type.name===e)(t.selection);if(!a)return!1;const l=t.doc.resolve(a.pos+1);return s.pos+1===l.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},D8=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function eC(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function tC(t,e){const{nodeExtensions:n}=dl(e),r=n.find(l=>l.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},a=ht(Le(r,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function cp(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(a=>{s!==!1&&(cp(a,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function qT(t){return t instanceof ze}var WT=class GT{constructor(e){this.position=e}static fromJSON(e){return new GT(e.position)}toJSON(){return{position:this.position}}};function L8(t,e){const n=e.mapping.mapResult(t.position);return{position:new WT(n.pos),mapResult:n}}function I8(t){return new WT(t)}function z8(t,e,n){var r;const{selection:s}=e;let a=null;if(OT(s)&&(a=s.$cursor),a){const c=(r=t.storedMarks)!=null?r:a.marks();return a.parent.type.allowsMarkType(n)&&(!!n.isInSet(c)||!c.some(p=>p.type.excludes(n)))}const{ranges:l}=s;return l.some(({$from:c,$to:d})=>{let p=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(c.pos,d.pos,(m,g,b)=>{if(p)return!1;if(m.isInline){const v=!b||b.type.allowsMarkType(n),w=!!n.isInSet(m.marks)||!m.marks.some(C=>C.type.excludes(n));p=v&&w}return!p}),p})}var B8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:a}=n,{empty:l,ranges:c}=a,d=ei(t,r.schema);if(s)if(l){const p=LT(r,d);n.addStoredMark(d.create({...p,...e}))}else c.forEach(p=>{const m=p.$from.pos,g=p.$to.pos;r.doc.nodesBetween(m,g,(b,v)=>{const w=Math.max(v,m),C=Math.min(v+b.nodeSize,g);b.marks.find(N=>N.type===d)?b.marks.forEach(N=>{d===N.type&&n.addMark(w,C,d.create({...N.attrs,...e}))}):n.addMark(w,C,d.create(e))})});return z8(r,n,d)},P8=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),H8=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const a=sn(t,n.schema);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),a.isTextblock?s().command(({commands:c})=>pk(a,{...l,...e})(n)?!0:c.clearNodes()).command(({state:c})=>pk(a,{...l,...e})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},F8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=Ia(t,0,r.content.size),a=ze.create(r,s);e.setSelection(a)}return!0},U8=(t,e)=>({tr:n,state:r,dispatch:s})=>{const{selection:a}=r;let l,c;return typeof e=="number"?(l=e,c=e):e&&"from"in e&&"to"in e?(l=e.from,c=e.to):(l=a.from,c=a.to),s&&n.doc.nodesBetween(l,c,(d,p)=>{d.isText||n.setNodeMarkup(p,void 0,{...d.attrs,dir:t})}),!0},$8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:a}=typeof t=="number"?{from:t,to:t}:t,l=Be.atStart(r).from,c=Be.atEnd(r).to,d=Ia(s,l,c),p=Ia(a,l,c),m=Be.create(r,d,p);e.setSelection(m)}return!0},V8=t=>({state:e,dispatch:n})=>{const r=sn(t,e.schema);return BL(r)(e,n)};function nC(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}var q8=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:a,doc:l}=e,{$from:c,$to:d}=a,p=s.extensionManager.attributes,m=bf(p,c.node().type.name,c.node().attrs);if(a instanceof ze&&a.node.isBlock)return!c.parentOffset||!Gs(l,c.pos)?!1:(r&&(t&&nC(n,s.extensionManager.splittableMarks),e.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const g=d.parentOffset===d.parent.content.size,b=c.depth===0?void 0:v8(c.node(-1).contentMatchAt(c.indexAfter(-1)));let v=g&&b?[{type:b,attrs:m}]:void 0,w=Gs(e.doc,e.mapping.map(c.pos),1,v);if(!v&&!w&&Gs(e.doc,e.mapping.map(c.pos),1,b?[{type:b}]:void 0)&&(w=!0,v=b?[{type:b,attrs:m}]:void 0),r){if(w&&(a instanceof Be&&e.deleteSelection(),e.split(e.mapping.map(c.pos),1,v),b&&!g&&!c.parentOffset&&c.parent.type!==b)){const C=e.mapping.map(c.before()),k=e.doc.resolve(C);c.node(-1).canReplaceWith(k.index(),k.index()+1,b)&&e.setNodeMarkup(e.mapping.map(c.before()),b)}t&&nC(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return w},W8=(t,e={})=>({tr:n,state:r,dispatch:s,editor:a})=>{var l;const c=sn(t,r.schema),{$from:d,$to:p}=r.selection,m=r.selection.node;if(m&&m.isBlock||d.depth<2||!d.sameParent(p))return!1;const g=d.node(-1);if(g.type!==c)return!1;const b=a.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(s){let N=fe.empty;const M=d.index(-1)?1:d.index(-2)?2:3;for(let F=d.depth-M;F>=d.depth-3;F-=1)N=fe.from(d.node(F).copy(N));const _=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,P={...bf(b,d.node().type.name,d.node().attrs),...e},I=((l=c.contentMatch.defaultType)==null?void 0:l.createAndFill(P))||void 0;N=N.append(fe.from(c.createAndFill(null,I)||void 0));const q=d.before(d.depth-(M-1));n.replace(q,d.after(-_),new Ee(N,4-M,0));let j=-1;n.doc.nodesBetween(q,n.doc.content.size,(F,G)=>{if(j>-1)return!1;F.isTextblock&&F.content.size===0&&(j=G+1)}),j>-1&&n.setSelection(Be.near(n.doc.resolve(j))),n.scrollIntoView()}return!0}const v=p.pos===d.end()?g.contentMatchAt(0).defaultType:null,w={...bf(b,g.type.name,g.attrs),...e},C={...bf(b,d.node().type.name,d.node().attrs),...e};n.delete(d.pos,p.pos);const k=v?[{type:c,attrs:w},{type:v,attrs:C}]:[{type:c,attrs:w}];if(!Gs(n.doc,d.pos,2))return!1;if(s){const{selection:N,storedMarks:M}=r,{splittableMarks:_}=a.extensionManager,P=M||N.$to.parentOffset&&N.$from.marks();if(n.split(d.pos,2,k).scrollIntoView(),!P||!s)return!0;const I=P.filter(q=>_.includes(q.type.name));n.ensureMarks(I)}return!0},s0=(t,e)=>{const n=lp(l=>l.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ta(t.doc,n.pos)&&t.join(n.pos),!0},i0=(t,e)=>{const n=lp(l=>l.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ta(t.doc,r)&&t.join(r),!0},G8=(t,e,n,r={})=>({editor:s,tr:a,state:l,dispatch:c,chain:d,commands:p,can:m})=>{const{extensions:g,splittableMarks:b}=s.extensionManager,v=sn(t,l.schema),w=sn(e,l.schema),{selection:C,storedMarks:k}=l,{$from:N,$to:M}=C,_=N.blockRange(M),P=k||C.$to.parentOffset&&C.$from.marks();if(!_)return!1;const I=lp(q=>tC(q.type.name,g))(C);if(_.depth>=1&&I&&_.depth-I.depth<=1){if(I.node.type===v)return p.liftListItem(w);if(tC(I.node.type.name,g)&&v.validContent(I.node.content)&&c)return d().command(()=>(a.setNodeMarkup(I.pos,v),!0)).command(()=>s0(a,v)).command(()=>i0(a,v)).run()}return!n||!P||!c?d().command(()=>m().wrapInList(v,r)?!0:p.clearNodes()).wrapInList(v,r).command(()=>s0(a,v)).command(()=>i0(a,v)).run():d().command(()=>{const q=m().wrapInList(v,r),j=P.filter(F=>b.includes(F.type.name));return a.ensureMarks(j),q?!0:p.clearNodes()}).wrapInList(v,r).command(()=>s0(a,v)).command(()=>i0(a,v)).run()},K8=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:a=!1}=n,l=ei(t,r.schema);return kx(r,l,e)?s.unsetMark(l,{extendEmptyMarkRange:a}):s.setMark(l,e)},Y8=(t,e,n={})=>({state:r,commands:s})=>{const a=sn(t,r.schema),l=sn(e,r.schema),c=Zi(r,a,n);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),c?s.setNode(l,d):s.setNode(a,{...d,...n})},J8=(t,e={})=>({state:n,commands:r})=>{const s=sn(t,n.schema);return Zi(n,s,e)?r.lift(s):r.wrapIn(s,e)},X8=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let a;if(s.spec.isInputRules&&(a=s.getState(t))){if(e){const l=t.tr,c=a.transform;for(let d=c.steps.length-1;d>=0;d-=1)l.step(c.steps[d].invert(c.docs[d]));if(a.text){const d=l.doc.resolve(a.from).marks();l.replaceWith(a.from,a.to,t.schema.text(a.text,d))}else l.delete(a.from,a.to)}return!0}}return!1},Q8=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},Z8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var a;const{extendEmptyMarkRange:l=!1}=e,{selection:c}=n,d=ei(t,r.schema),{$from:p,empty:m,ranges:g}=c;if(!s)return!0;if(m&&l){let{from:b,to:v}=c;const w=(a=p.marks().find(k=>k.type===d))==null?void 0:a.attrs,C=Bb(p,d,w);C&&(b=C.from,v=C.to),n.removeMark(b,v,d)}else g.forEach(b=>{n.removeMark(b.$from.pos,b.$to.pos,d)});return n.removeStoredMark(d),!0},eB=t=>({tr:e,state:n,dispatch:r})=>{const{selection:s}=n;let a,l;return typeof t=="number"?(a=t,l=t):t&&"from"in t&&"to"in t?(a=t.from,l=t.to):(a=s.from,l=s.to),r&&e.doc.nodesBetween(a,l,(c,d)=>{if(c.isText)return;const p={...c.attrs};delete p.dir,e.setNodeMarkup(d,void 0,p)}),!0},tB=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let a=null,l=null;const c=op(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(a=sn(t,r.schema)),c==="mark"&&(l=ei(t,r.schema));let d=!1;return n.selection.ranges.forEach(p=>{const m=p.$from.pos,g=p.$to.pos;let b,v,w,C;n.selection.empty?r.doc.nodesBetween(m,g,(k,N)=>{a&&a===k.type&&(d=!0,w=Math.max(N,m),C=Math.min(N+k.nodeSize,g),b=N,v=k)}):r.doc.nodesBetween(m,g,(k,N)=>{N<m&&a&&a===k.type&&(d=!0,w=Math.max(N,m),C=Math.min(N+k.nodeSize,g),b=N,v=k),N>=m&&N<=g&&(a&&a===k.type&&(d=!0,s&&n.setNodeMarkup(N,void 0,{...k.attrs,...e})),l&&k.marks.length&&k.marks.forEach(M=>{if(l===M.type&&(d=!0,s)){const _=Math.max(N,m),P=Math.min(N+k.nodeSize,g);n.addMark(_,P,l.create({...M.attrs,...e}))}}))}),v&&(b!==void 0&&s&&n.setNodeMarkup(b,void 0,{...v.attrs,...e}),l&&v.marks.length&&v.marks.forEach(k=>{l===k.type&&s&&n.addMark(w,C,l.create({...k.attrs,...e}))}))}),d},nB=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return OL(s,e)(n,r)},rB=(t,e={})=>({state:n,dispatch:r})=>{const s=sn(t,n.schema);return _L(s,e)(n,r)},sB=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},up=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},iB=(t,e)=>{if(zb(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Jd(t){var e;const{editor:n,from:r,to:s,text:a,rules:l,plugin:c}=t,{view:d}=n;if(d.composing)return!1;const p=d.state.doc.resolve(r);if(p.parent.type.spec.code||(e=p.nodeBefore||p.nodeAfter)!=null&&e.marks.find(b=>b.type.spec.code))return!1;let m=!1;const g=O8(p)+a;return l.forEach(b=>{if(m)return;const v=iB(g,b.find);if(!v)return;const w=d.state.tr,C=ip({state:d.state,transaction:w}),k={from:r-(v[0].length-a.length),to:s},{commands:N,chain:M,can:_}=new ap({editor:n,state:C});b.handler({state:C,range:k,match:v,commands:N,chain:M,can:_})===null||!w.steps.length||(b.undoable&&w.setMeta(c,{transform:w,from:r,to:s,text:a}),d.dispatch(w),m=!0)}),m}function aB(t){const{editor:e,rules:n}=t,r=new _t({state:{init(){return null},apply(s,a,l){const c=s.getMeta(r);if(c)return c;const d=s.getMeta("applyInputRules");return!!d&&setTimeout(()=>{let{text:m}=d;typeof m=="string"?m=m:m=Hb(fe.from(m),l.schema);const{from:g}=d,b=g+m.length;Jd({editor:e,from:g,to:b,text:m,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:a}},props:{handleTextInput(s,a,l,c){return Jd({editor:e,from:a,to:l,text:c,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&Jd({editor:e,from:a.pos,to:a.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:l}=s.state.selection;return l?Jd({editor:e,from:l.pos,to:l.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function oB(t){return Object.prototype.toString.call(t).slice(8,-1)}function Xd(t){return oB(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function KT(t,e){const n={...t};return Xd(t)&&Xd(e)&&Object.keys(e).forEach(r=>{Xd(e[r])&&Xd(t[r])?n[r]=KT(t[r],e[r]):n[r]=e[r]}),n}var Ub=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...ht(Le(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...ht(Le(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>KT(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},ra=class YT extends Ub{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new YT(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const l=s.marks();if(!!!l.find(p=>(p==null?void 0:p.type.name)===n.name))return!1;const d=l.find(p=>(p==null?void 0:p.type.name)===n.name);return d&&r.removeStoredMark(d),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function lB(t){return typeof t=="number"}var cB=class{constructor(t){this.find=t.find,this.handler=t.handler}},uB=(t,e,n)=>{if(zb(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const a=[s.text];return a.index=s.index,a.input=t,a.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(s.replaceWith)),a}):[]};function dB(t){const{editor:e,state:n,from:r,to:s,rule:a,pasteEvent:l,dropEvent:c}=t,{commands:d,chain:p,can:m}=new ap({editor:e,state:n}),g=[];return n.doc.nodesBetween(r,s,(v,w)=>{var C,k,N,M,_;if((k=(C=v.type)==null?void 0:C.spec)!=null&&k.code||!(v.isText||v.isTextblock||v.isInline))return;const P=(_=(M=(N=v.content)==null?void 0:N.size)!=null?M:v.nodeSize)!=null?_:0,I=Math.max(r,w),q=Math.min(s,w+P);if(I>=q)return;const j=v.isText?v.text||"":v.textBetween(I-w,q-w,void 0,"");uB(j,a.find,l).forEach(G=>{if(G.index===void 0)return;const te=I+G.index+1,he=te+G[0].length,Ne={from:n.tr.mapping.map(te),to:n.tr.mapping.map(he)},Se=a.handler({state:n,range:Ne,match:G,commands:d,chain:p,can:m,pasteEvent:l,dropEvent:c});g.push(Se)})}),g.every(v=>v!==null)}var Qd=null,fB=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function hB(t){const{editor:e,rules:n}=t;let r=null,s=!1,a=!1,l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,c;try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}const d=({state:m,from:g,to:b,rule:v,pasteEvt:w})=>{const C=m.tr,k=ip({state:m,transaction:C});if(!(!dB({editor:e,state:k,from:Math.max(g-1,0),to:b.b-1,rule:v,pasteEvent:w,dropEvent:c})||!C.steps.length)){try{c=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{c=null}return l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,C}};return n.map(m=>new _t({view(g){const b=w=>{var C;r=(C=g.dom.parentElement)!=null&&C.contains(w.target)?g.dom.parentElement:null,r&&(Qd=e)},v=()=>{Qd&&(Qd=null)};return window.addEventListener("dragstart",b),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",b),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(g,b)=>{if(a=r===g.dom.parentElement,c=b,!a){const v=Qd;v!=null&&v.isEditable&&setTimeout(()=>{const w=v.state.selection;w&&v.commands.deleteRange({from:w.from,to:w.to})},10)}return!1},paste:(g,b)=>{var v;const w=(v=b.clipboardData)==null?void 0:v.getData("text/html");return l=b,s=!!(w!=null&&w.includes("data-pm-slice")),!1}}},appendTransaction:(g,b,v)=>{const w=g[0],C=w.getMeta("uiEvent")==="paste"&&!s,k=w.getMeta("uiEvent")==="drop"&&!a,N=w.getMeta("applyPasteRules"),M=!!N;if(!C&&!k&&!M)return;if(M){let{text:I}=N;typeof I=="string"?I=I:I=Hb(fe.from(I),v.schema);const{from:q}=N,j=q+I.length,F=fB(I);return d({rule:m,state:v,from:q,to:{b:j},pasteEvt:F})}const _=b.doc.content.findDiffStart(v.doc.content),P=b.doc.content.findDiffEnd(v.doc.content);if(!(!lB(_)||!P||_===P.b))return d({rule:m,state:v,from:_,to:P,pasteEvt:l})}}))}var dp=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=HT(t),this.schema=S8(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Yd(e.name,this.schema)},r=Le(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return eh([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Yd(r.name,this.schema)},a=[],l=Le(r,"addKeyboardShortcuts",s);let c={};if(r.type==="mark"&&Le(r,"exitable",s)&&(c.ArrowRight=()=>ra.handleExit({editor:t,mark:r})),l){const b=Object.fromEntries(Object.entries(l()).map(([v,w])=>[v,()=>w({editor:t})]));c={...c,...b}}const d=Az(c);a.push(d);const p=Le(r,"addInputRules",s);if(eC(r,t.options.enableInputRules)&&p){const b=p();if(b&&b.length){const v=aB({editor:t,rules:b}),w=Array.isArray(v)?v:[v];a.push(...w)}}const m=Le(r,"addPasteRules",s);if(eC(r,t.options.enablePasteRules)&&m){const b=m();if(b&&b.length){const v=hB({editor:t,rules:b});a.push(...v)}}const g=Le(r,"addProseMirrorPlugins",s);if(g){const b=g();a.push(...b)}return a})}get attributes(){return PT(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=dl(this.extensions);return Object.fromEntries(e.filter(n=>!!Le(n,"addNodeView")).map(n=>{const r=this.attributes.filter(d=>d.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:sn(n.name,this.schema)},a=Le(n,"addNodeView",s);if(!a)return[];const l=a();if(!l)return[];const c=(d,p,m,g,b)=>{const v=ou(d,r);return l({node:d,view:p,getPos:m,decorations:g,innerDecorations:b,editor:t,extension:n,HTMLAttributes:v})};return[n.name,c]}))}dispatchTransaction(t){const{editor:e}=this;return eh([...this.extensions].reverse()).reduceRight((r,s)=>{const a={name:s.name,options:s.options,storage:this.editor.extensionStorage[s.name],editor:e,type:Yd(s.name,this.schema)},l=Le(s,"dispatchTransaction",a);return l?c=>{l.call(a,{transaction:c,next:r})}:r},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=dl(this.extensions);return Object.fromEntries(e.filter(n=>!!Le(n,"addMarkView")).map(n=>{const r=this.attributes.filter(c=>c.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:ei(n.name,this.schema)},a=Le(n,"addMarkView",s);if(!a)return[];const l=(c,d,p)=>{const m=ou(c,r);return a()({mark:c,view:d,inline:p,editor:t,extension:n,HTMLAttributes:m,updateAttributes:g=>{TB(c,t,g)}})};return[n.name,l]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Yd(e.name,this.schema)};e.type==="mark"&&((n=ht(Le(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=Le(e,"onBeforeCreate",r),a=Le(e,"onCreate",r),l=Le(e,"onUpdate",r),c=Le(e,"onSelectionUpdate",r),d=Le(e,"onTransaction",r),p=Le(e,"onFocus",r),m=Le(e,"onBlur",r),g=Le(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),a&&this.editor.on("create",a),l&&this.editor.on("update",l),c&&this.editor.on("selectionUpdate",c),d&&this.editor.on("transaction",d),p&&this.editor.on("focus",p),m&&this.editor.on("blur",m),g&&this.editor.on("destroy",g)})}};dp.resolve=HT;dp.sort=eh;dp.flatten=Pb;var pB={};Ib(pB,{ClipboardTextSerializer:()=>XT,Commands:()=>QT,Delete:()=>ZT,Drop:()=>eA,Editable:()=>tA,FocusEvents:()=>rA,Keymap:()=>sA,Paste:()=>iA,Tabindex:()=>aA,TextDirection:()=>oA,focusEventsPluginKey:()=>nA});var vt=class JT extends Ub{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new JT(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},XT=vt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new _t({key:new Wt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:a}=s,l=Math.min(...a.map(m=>m.$from.pos)),c=Math.max(...a.map(m=>m.$to.pos)),d=UT(n);return FT(r,{from:l,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),QT=vt.create({name:"commands",addCommands(){return{...MT}}}),ZT=vt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const a=()=>{var l,c,d,p;if((p=(d=(c=(l=this.editor.options.coreExtensionOptions)==null?void 0:l.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?p:t.getMeta("y-sync$"))return;const m=IT(t.before,[t,...e]);VT(m).forEach(v=>{m.mapping.mapResult(v.oldRange.from).deletedAfter&&m.mapping.mapResult(v.oldRange.to).deletedBefore&&m.before.nodesBetween(v.oldRange.from,v.oldRange.to,(w,C)=>{const k=C+w.nodeSize-2,N=v.oldRange.from<=C&&k<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:C,to:k,newFrom:m.mapping.map(C),newTo:m.mapping.map(k),deletedRange:v.oldRange,newRange:v.newRange,partial:!N,editor:this.editor,transaction:t,combinedTransform:m})})});const b=m.mapping;m.steps.forEach((v,w)=>{var C,k;if(v instanceof Fr){const N=b.slice(w).map(v.from,-1),M=b.slice(w).map(v.to),_=b.invert().map(N,-1),P=b.invert().map(M),I=(C=m.doc.nodeAt(N-1))==null?void 0:C.marks.some(j=>j.eq(v.mark)),q=(k=m.doc.nodeAt(M))==null?void 0:k.marks.some(j=>j.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:_,to:P},newRange:{from:N,to:M},partial:!!(q||I),editor:this.editor,transaction:t,combinedTransform:m})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(a,0):a()}}),eA=vt.create({name:"drop",addProseMirrorPlugins(){return[new _t({key:new Wt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),tA=vt.create({name:"editable",addProseMirrorPlugins(){return[new _t({key:new Wt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),nA=new Wt("focusEvents"),rA=vt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new _t({key:nA,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),sA=vt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:c})=>{const{selection:d,doc:p}=c,{empty:m,$anchor:g}=d,{pos:b,parent:v}=g,w=g.parent.isTextblock&&b>0?c.doc.resolve(b-1):g,C=w.parent.type.spec.isolating,k=g.pos-g.parentOffset,N=C&&w.parent.childCount===1?k===g.pos:Ve.atStart(p).from===b;return!m||!v.type.isTextblock||v.textContent.length||!N||N&&g.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},a={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Zf()||DT()?a:s},addProseMirrorPlugins(){return[new _t({key:new Wt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(C=>C.getMeta("composition")))return;const r=t.some(C=>C.docChanged)&&!e.doc.eq(n.doc),s=t.some(C=>C.getMeta("preventClearDocument"));if(!r||s)return;const{empty:a,from:l,to:c}=e.selection,d=Ve.atStart(e.doc).from,p=Ve.atEnd(e.doc).to;if(a||!(l===d&&c===p)||!cp(n.doc))return;const b=n.tr,v=ip({state:n,transaction:b}),{commands:w}=new ap({editor:this.editor,state:v});if(w.clearNodes(),!!b.steps.length)return b}})]}}),iA=vt.create({name:"paste",addProseMirrorPlugins(){return[new _t({key:new Wt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),aA=vt.create({name:"tabindex",addProseMirrorPlugins(){return[new _t({key:new Wt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),oA=vt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=dl(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new _t({key:new Wt("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),mB=class Ac{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Ac(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Ac(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Ac(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,a=n.isAtom&&!n.isText,l=n.isInline,c=this.pos+r+(a?0:1);if(c<0||c>this.resolvedPos.doc.nodeSize-2)return;const d=this.resolvedPos.doc.resolve(c);if(!s&&!l&&d.depth<=this.depth)return;const p=new Ac(d,this.editor,s,s||l?n:null);s&&(p.actualDepth=this.depth+1),e.push(p)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const a=s.node.attrs,l=Object.keys(n);for(let c=0;c<l.length;c+=1){const d=l[c];if(a[d]!==n[d])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const a=Object.keys(n);return this.children.forEach(l=>{r&&s.length>0||(l.node.type.name===e&&a.every(d=>n[d]===l.node.attrs[d])&&s.push(l),!(r&&s.length>0)&&(s=s.concat(l.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},gB=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function xB(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var bB=class extends sB{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:L8,createMappablePosition:I8},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:a})=>this.options.onDrop(r,s,a)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=_T(e,this.options.autofocus);this.editorState=Wo.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=xB(gB,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=BT(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;n=n.filter(l=>!l.key.startsWith(a))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[tA,XT.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),QT,rA,sA,aA,eA,iA,ZT,oA.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new dp(r,this)}createCommandManager(){this.commandManager=new ap({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=wx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=wx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),s=n?this.extensionManager.dispatchTransaction(r):r;this.editorView=new AT(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:s,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const l=this.view.dom;l.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(p=>{var m;return(m=this.capturedTransaction)==null?void 0:m.step(p)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const l=n.findLast(p=>p.getMeta("focus")||p.getMeta("blur")),c=l==null?void 0:l.getMeta("focus"),d=l==null?void 0:l.getMeta("blur");c&&this.emit("focus",{editor:this,event:c.event,transaction:l}),d&&this.emit("blur",{editor:this,event:d.event,transaction:l}),!(t.getMeta("preventUpdate")||!n.some(p=>p.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return $T(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return _8(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Hb(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return N8(this.state.doc,{blockSeparator:e,textSerializers:{...UT(this.schema),...n}})}get isEmpty(){return cp(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new mB(e,this)}get $doc(){return this.$pos(0)}};function fl(t){return new up({find:t.find,handler:({state:e,range:n,match:r})=>{const s=ht(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:a}=e,l=r[r.length-1],c=r[0];if(l){const d=c.search(/\S/),p=n.from+c.indexOf(l),m=p+l.length;if(Fb(n.from,n.to,e.doc).filter(v=>v.mark.type.excluded.find(C=>C===t.type&&C!==v.mark.type)).filter(v=>v.to>p).length)return null;m<n.to&&a.delete(m,n.to),p>n.from&&a.delete(n.from+d,p);const b=n.from+d+l.length;a.addMark(n.from+d,b,t.type.create(s||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function yB(t){return new up({find:t.find,handler:({state:e,range:n,match:r})=>{const s=ht(t.getAttributes,void 0,r)||{},{tr:a}=e,l=n.from;let c=n.to;const d=t.type.create(s);if(r[1]){const p=r[0].lastIndexOf(r[1]);let m=l+p;m>c?m=c:c=m+r[1].length;const g=r[0][r[0].length-1];a.insertText(g,l+r[0].length-1),a.replaceWith(m,c,d)}else if(r[0]){const p=t.type.isInline?l:l-1;a.insert(p,t.type.create(s)).delete(a.mapping.map(l),a.mapping.map(c))}a.scrollIntoView()},undoable:t.undoable})}function Cx(t){return new up({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),a=ht(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,a)},undoable:t.undoable})}function hl(t){return new up({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const a=ht(t.getAttributes,void 0,r)||{},l=e.tr.delete(n.from,n.to),d=l.doc.resolve(n.from).blockRange(),p=d&&bb(d,t.type,a);if(!p)return null;if(l.wrap(d,p),t.keepMarks&&t.editor){const{selection:g,storedMarks:b}=e,{splittableMarks:v}=t.editor.extensionManager,w=b||g.$to.parentOffset&&g.$from.marks();if(w){const C=w.filter(k=>v.includes(k.type.name));l.ensureMarks(C)}}if(t.keepAttributes){const g=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(g,a).run()}const m=l.doc.resolve(n.from-1).nodeBefore;m&&m.type===t.type&&ta(l.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,m))&&l.join(n.from-1)},undoable:t.undoable})}function vB(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof ze){const a=r.index();return r.parent.canReplaceWith(a,a+1,e)}let s=r.depth;for(;s>=0;){const a=r.index(s);if(r.node(s).contentMatchAt(a).matchType(e))return!0;s-=1}return!1}var wB={};Ib(wB,{createAtomBlockMarkdownSpec:()=>kB,createBlockMarkdownSpec:()=>CB,createInlineMarkdownSpec:()=>NB,parseAttributes:()=>$b,parseIndentedBlocks:()=>Sx,renderNestedMarkdownContent:()=>qb,serializeAttributes:()=>Vb});function $b(t){if(!(t!=null&&t.trim()))return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,p=>(n.push(p),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const p=s.map(m=>m.trim().slice(1));e.class=p.join(" ")}const a=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const l=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(l)).forEach(([,p,m])=>{var g;const b=parseInt(((g=m.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),v=n[b];v&&(e[p]=v.slice(1,-1))});const d=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(m=>{m.match(/^[a-zA-Z][\w-]*$/)&&(e[m]=!0)}),e}function Vb(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function kB(t){const{nodeName:e,name:n,parseAttributes:r=$b,serializeAttributes:s=Vb,defaultAttributes:a={},requiredAttributes:l=[],allowedAttributes:c}=t,d=n||e,p=m=>{if(!c)return m;const g={};return c.forEach(b=>{b in m&&(g[b]=m[b])}),g};return{parseMarkdown:(m,g)=>{const b={...a,...m.attributes};return g.createNode(e,b,[])},markdownTokenizer:{name:e,level:"block",start(m){var g;const b=new RegExp(`^:::${d}(?:\\s|$)`,"m"),v=(g=m.match(b))==null?void 0:g.index;return v!==void 0?v:-1},tokenize(m,g,b){const v=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),w=m.match(v);if(!w)return;const C=w[1]||"",k=r(C);if(!l.find(M=>!(M in k)))return{type:e,raw:w[0],attributes:k}}},renderMarkdown:m=>{const g=p(m.attrs||{}),b=s(g),v=b?` {${b}}`:"";return`:::${d}${v} :::`}}}function CB(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=$b,serializeAttributes:a=Vb,defaultAttributes:l={},content:c="block",allowedAttributes:d}=t,p=n||e,m=g=>{if(!d)return g;const b={};return d.forEach(v=>{v in g&&(b[v]=g[v])}),b};return{parseMarkdown:(g,b)=>{let v;if(r){const C=r(g);v=typeof C=="string"?[{type:"text",text:C}]:C}else c==="block"?v=b.parseChildren(g.tokens||[]):v=b.parseInline(g.tokens||[]);const w={...l,...g.attributes};return b.createNode(e,w,v)},markdownTokenizer:{name:e,level:"block",start(g){var b;const v=new RegExp(`^:::${p}`,"m"),w=(b=g.match(v))==null?void 0:b.index;return w!==void 0?w:-1},tokenize(g,b,v){var w;const C=new RegExp(`^:::${p}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),k=g.match(C);if(!k)return;const[N,M=""]=k,_=s(M);let P=1;const I=N.length;let q="";const j=/^:::([\w-]*)(\s.*)?/gm,F=g.slice(I);for(j.lastIndex=0;;){const G=j.exec(F);if(G===null)break;const te=G.index,he=G[1];if(!((w=G[2])!=null&&w.endsWith(":::"))){if(he)P+=1;else if(P-=1,P===0){const Ne=F.slice(0,te);q=Ne.trim();const Se=g.slice(0,I+te+G[0].length);let Te=[];if(q)if(c==="block")for(Te=v.blockTokens(Ne),Te.forEach(pe=>{pe.text&&(!pe.tokens||pe.tokens.length===0)&&(pe.tokens=v.inlineTokens(pe.text))});Te.length>0;){const pe=Te[Te.length-1];if(pe.type==="paragraph"&&(!pe.text||pe.text.trim()===""))Te.pop();else break}else Te=v.inlineTokens(q);return{type:e,raw:Se,attributes:_,content:q,tokens:Te}}}}}},renderMarkdown:(g,b)=>{const v=m(g.attrs||{}),w=a(v),C=w?` {${w}}`:"",k=b.renderChildren(g.content||[],`

`);return`:::${p}${C}

${k}

:::`}}}function SB(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,a,l]=r;e[s]=a||l,r=n.exec(t)}return e}function EB(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function NB(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=SB,serializeAttributes:a=EB,defaultAttributes:l={},selfClosing:c=!1,allowedAttributes:d}=t,p=n||e,m=b=>{if(!d)return b;const v={};return d.forEach(w=>{const C=typeof w=="string"?w:w.name,k=typeof w=="string"?void 0:w.skipIfDefault;if(C in b){const N=b[C];if(k!==void 0&&N===k)return;v[C]=N}}),v},g=p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(b,v)=>{const w={...l,...b.attributes};if(c)return v.createNode(e,w);const C=r?r(b):b.content||"";return C?v.createNode(e,w,[v.createTextNode(C)]):v.createNode(e,w,[])},markdownTokenizer:{name:e,level:"inline",start(b){const v=c?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),w=b.match(v),C=w==null?void 0:w.index;return C!==void 0?C:-1},tokenize(b,v,w){const C=c?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),k=b.match(C);if(!k)return;let N="",M="";if(c){const[,P]=k;M=P}else{const[,P,I]=k;M=P,N=I||""}const _=s(M.trim());return{type:e,raw:k[0],content:N.trim(),attributes:_}}},renderMarkdown:b=>{let v="";r?v=r(b):b.content&&b.content.length>0&&(v=b.content.filter(N=>N.type==="text").map(N=>N.text).join(""));const w=m(b.attrs||{}),C=a(w),k=C?` ${C}`:"";return c?`[${p}${k}]`:`[${p}${k}]${v}[/${p}]`}}}function Sx(t,e,n){var r,s,a,l;const c=t.split(`
`),d=[];let p="",m=0;const g=e.baseIndentSize||2;for(;m<c.length;){const b=c[m],v=b.match(e.itemPattern);if(!v){if(d.length>0)break;if(b.trim()===""){m+=1,p=`${p}${b}
`;continue}else return}const w=e.extractItemData(v),{indentLevel:C,mainContent:k}=w;p=`${p}${b}
`;const N=[k];for(m+=1;m<c.length;){const I=c[m];if(I.trim()===""){const j=c.slice(m+1).findIndex(te=>te.trim()!=="");if(j===-1)break;if((((s=(r=c[m+1+j].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>C){N.push(I),p=`${p}${I}
`,m+=1;continue}else break}if((((l=(a=I.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:l.length)||0)>C)N.push(I),p=`${p}${I}
`,m+=1;else break}let M;const _=N.slice(1);if(_.length>0){const I=_.map(q=>q.slice(C+g)).join(`
`);I.trim()&&(e.customNestedParser?M=e.customNestedParser(I):M=n.blockTokens(I))}const P=e.createToken(w,M);d.push(P)}if(d.length!==0)return{items:d,raw:p}}function qb(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[a,...l]=t.content,c=e.renderChildren([a]),d=[`${s}${c}`];return l&&l.length>0&&l.forEach(p=>{const m=e.renderChildren([p]);if(m){const g=m.split(`
`).map(b=>b?e.indent(b):"").join(`
`);d.push(g)}}),d.join(`
`)}function TB(t,e,n={}){const{state:r}=e,{doc:s,tr:a}=r,l=t;s.descendants((c,d)=>{const p=a.mapping.map(d),m=a.mapping.map(d)+c.nodeSize;let g=null;if(c.marks.forEach(v=>{if(v!==l)return!1;g=v}),!g)return;let b=!1;if(Object.keys(n).forEach(v=>{n[v]!==g.attrs[v]&&(b=!0)}),b){const v=t.type.create({...t.attrs,...n});a.removeMark(p,m,t.type),a.addMark(p,m,v)}}),a.docChanged&&e.view.dispatch(a)}var _n=class lA extends Ub{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new lA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Xa(t){return new cB({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const a=ht(t.getAttributes,void 0,r,s);if(a===!1||a===null)return null;const{tr:l}=e,c=r[r.length-1],d=r[0];let p=n.to;if(c){const m=d.search(/\S/),g=n.from+d.indexOf(c),b=g+c.length;if(Fb(n.from,n.to,e.doc).filter(w=>w.mark.type.excluded.find(k=>k===t.type&&k!==w.mark.type)).filter(w=>w.to>g).length)return null;b<n.to&&l.delete(b,n.to),g>n.from&&l.delete(n.from+m,g),p=n.from+m+c.length,l.addMark(n.from+m,p,t.type.create(a||{})),l.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:AB,getOwnPropertySymbols:MB}=Object,{hasOwnProperty:jB}=Object.prototype;function a0(t,e){return function(r,s,a){return t(r,s,a)&&e(r,s,a)}}function Zd(t){return function(n,r,s){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,s);const{cache:a}=s,l=a.get(n),c=a.get(r);if(l&&c)return l===r&&c===n;a.set(n,r),a.set(r,n);const d=t(n,r,s);return a.delete(n),a.delete(r),d}}function OB(t){return t!=null?t[Symbol.toStringTag]:void 0}function rC(t){return AB(t).concat(MB(t))}const _B=Object.hasOwn||((t,e)=>jB.call(t,e));function no(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const RB="__v",DB="__o",LB="_owner",{getOwnPropertyDescriptor:sC,keys:iC}=Object;function IB(t,e){return t.byteLength===e.byteLength&&th(new Uint8Array(t),new Uint8Array(e))}function zB(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function BB(t,e){return t.byteLength===e.byteLength&&th(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function PB(t,e){return no(t.getTime(),e.getTime())}function HB(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function FB(t,e){return t===e}function aC(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),a=t.entries();let l,c,d=0;for(;(l=a.next())&&!l.done;){const p=e.entries();let m=!1,g=0;for(;(c=p.next())&&!c.done;){if(s[g]){g++;continue}const b=l.value,v=c.value;if(n.equals(b[0],v[0],d,g,t,e,n)&&n.equals(b[1],v[1],b[0],v[0],t,e,n)){m=s[g]=!0;break}g++}if(!m)return!1;d++}return!0}const UB=no;function $B(t,e,n){const r=iC(t);let s=r.length;if(iC(e).length!==s)return!1;for(;s-- >0;)if(!cA(t,e,n,r[s]))return!1;return!0}function kc(t,e,n){const r=rC(t);let s=r.length;if(rC(e).length!==s)return!1;let a,l,c;for(;s-- >0;)if(a=r[s],!cA(t,e,n,a)||(l=sC(t,a),c=sC(e,a),(l||c)&&(!l||!c||l.configurable!==c.configurable||l.enumerable!==c.enumerable||l.writable!==c.writable)))return!1;return!0}function VB(t,e){return no(t.valueOf(),e.valueOf())}function qB(t,e){return t.source===e.source&&t.flags===e.flags}function oC(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const s=new Array(r),a=t.values();let l,c;for(;(l=a.next())&&!l.done;){const d=e.values();let p=!1,m=0;for(;(c=d.next())&&!c.done;){if(!s[m]&&n.equals(l.value,c.value,l.value,c.value,t,e,n)){p=s[m]=!0;break}m++}if(!p)return!1}return!0}function th(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function WB(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function cA(t,e,n,r){return(r===LB||r===DB||r===RB)&&(t.$$typeof||e.$$typeof)?!0:_B(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const GB="[object ArrayBuffer]",KB="[object Arguments]",YB="[object Boolean]",JB="[object DataView]",XB="[object Date]",QB="[object Error]",ZB="[object Map]",eP="[object Number]",tP="[object Object]",nP="[object RegExp]",rP="[object Set]",sP="[object String]",iP={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},aP="[object URL]",oP=Object.prototype.toString;function lP({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:s,areFunctionsEqual:a,areMapsEqual:l,areNumbersEqual:c,areObjectsEqual:d,arePrimitiveWrappersEqual:p,areRegExpsEqual:m,areSetsEqual:g,areTypedArraysEqual:b,areUrlsEqual:v,unknownTagComparators:w}){return function(k,N,M){if(k===N)return!0;if(k==null||N==null)return!1;const _=typeof k;if(_!==typeof N)return!1;if(_!=="object")return _==="number"?c(k,N,M):_==="function"?a(k,N,M):!1;const P=k.constructor;if(P!==N.constructor)return!1;if(P===Object)return d(k,N,M);if(Array.isArray(k))return e(k,N,M);if(P===Date)return r(k,N,M);if(P===RegExp)return m(k,N,M);if(P===Map)return l(k,N,M);if(P===Set)return g(k,N,M);const I=oP.call(k);if(I===XB)return r(k,N,M);if(I===nP)return m(k,N,M);if(I===ZB)return l(k,N,M);if(I===rP)return g(k,N,M);if(I===tP)return typeof k.then!="function"&&typeof N.then!="function"&&d(k,N,M);if(I===aP)return v(k,N,M);if(I===QB)return s(k,N,M);if(I===KB)return d(k,N,M);if(iP[I])return b(k,N,M);if(I===GB)return t(k,N,M);if(I===JB)return n(k,N,M);if(I===YB||I===eP||I===sP)return p(k,N,M);if(w){let q=w[I];if(!q){const j=OB(k);j&&(q=w[j])}if(q)return q(k,N,M)}return!1}}function cP({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:IB,areArraysEqual:n?kc:zB,areDataViewsEqual:BB,areDatesEqual:PB,areErrorsEqual:HB,areFunctionsEqual:FB,areMapsEqual:n?a0(aC,kc):aC,areNumbersEqual:UB,areObjectsEqual:n?kc:$B,arePrimitiveWrappersEqual:VB,areRegExpsEqual:qB,areSetsEqual:n?a0(oC,kc):oC,areTypedArraysEqual:n?a0(th,kc):th,areUrlsEqual:WB,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const s=Zd(r.areArraysEqual),a=Zd(r.areMapsEqual),l=Zd(r.areObjectsEqual),c=Zd(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:l,areSetsEqual:c})}return r}function uP(t){return function(e,n,r,s,a,l,c){return t(e,n,c)}}function dP({circular:t,comparator:e,createState:n,equals:r,strict:s}){if(n)return function(c,d){const{cache:p=t?new WeakMap:void 0,meta:m}=n();return e(c,d,{cache:p,equals:r,meta:m,strict:s})};if(t)return function(c,d){return e(c,d,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};const a={cache:void 0,equals:r,meta:void 0,strict:s};return function(c,d){return e(c,d,a)}}const fP=sa();sa({strict:!0});sa({circular:!0});sa({circular:!0,strict:!0});sa({createInternalComparator:()=>no});sa({strict:!0,createInternalComparator:()=>no});sa({circular:!0,createInternalComparator:()=>no});sa({circular:!0,createInternalComparator:()=>no,strict:!0});function sa(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:s=!1}=t,a=cP(t),l=lP(a),c=n?n(l):uP(l);return dP({circular:e,comparator:l,createState:r,equals:c,strict:s})}var o0={exports:{}},l0={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lC;function hP(){if(lC)return l0;lC=1;var t=pu(),e=eN();function n(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,a=t.useRef,l=t.useEffect,c=t.useMemo,d=t.useDebugValue;return l0.useSyncExternalStoreWithSelector=function(p,m,g,b,v){var w=a(null);if(w.current===null){var C={hasValue:!1,value:null};w.current=C}else C=w.current;w=c(function(){function N(q){if(!M){if(M=!0,_=q,q=b(q),v!==void 0&&C.hasValue){var j=C.value;if(v(j,q))return P=j}return P=q}if(j=P,r(_,q))return j;var F=b(q);return v!==void 0&&v(j,F)?(_=q,j):(_=q,P=F)}var M=!1,_,P,I=g===void 0?null:g;return[function(){return N(m())},I===null?void 0:function(){return N(I())}]},[m,g,b,v]);var k=s(p,w[0],w[1]);return l(function(){C.hasValue=!0,C.value=k},[k]),d(k),k},l0}var cC;function pP(){return cC||(cC=1,o0.exports=hP()),o0.exports}var mP=pP(),gP=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},xP=({contentComponent:t})=>{const e=tN.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return h.jsx(h.Fragment,{children:Object.values(e)})};function bP(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:u4.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var yP=class extends We.Component{constructor(t){var e;super(t),this.editorContentRef=We.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=bP(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:gP(e,this.editorContentRef),...n}),(t==null?void 0:t.contentComponent)&&h.jsx(xP,{contentComponent:t.contentComponent})]})}},vP=E.forwardRef((t,e)=>{const n=We.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return We.createElement(yP,{key:n,innerRef:e,...t})}),uA=We.memo(vP),wP=typeof window<"u"?E.useLayoutEffect:E.useEffect,kP=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function CP(t){var e;const[n]=E.useState(()=>new kP(t.editor)),r=mP.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:fP);return wP(()=>n.watch(t.editor),[t.editor,n]),E.useDebugValue(r),r}var SP=!1,Ex=typeof window>"u",EP=Ex||!!(typeof window<"u"&&window.next),NP=class dA{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Ex||EP?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onBeforeCreate)==null?void 0:a.call(s,...r)},onBlur:(...r)=>{var s,a;return(a=(s=this.options.current).onBlur)==null?void 0:a.call(s,...r)},onCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onCreate)==null?void 0:a.call(s,...r)},onDestroy:(...r)=>{var s,a;return(a=(s=this.options.current).onDestroy)==null?void 0:a.call(s,...r)},onFocus:(...r)=>{var s,a;return(a=(s=this.options.current).onFocus)==null?void 0:a.call(s,...r)},onSelectionUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onSelectionUpdate)==null?void 0:a.call(s,...r)},onTransaction:(...r)=>{var s,a;return(a=(s=this.options.current).onTransaction)==null?void 0:a.call(s,...r)},onUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onUpdate)==null?void 0:a.call(s,...r)},onContentError:(...r)=>{var s,a;return(a=(s=this.options.current).onContentError)==null?void 0:a.call(s,...r)},onDrop:(...r)=>{var s,a;return(a=(s=this.options.current).onDrop)==null?void 0:a.call(s,...r)},onPaste:(...r)=>{var s,a;return(a=(s=this.options.current).onPaste)==null?void 0:a.call(s,...r)},onDelete:(...r)=>{var s,a;return(a=(s=this.options.current).onDelete)==null?void 0:a.call(s,...r)}};return new bB(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,a)=>{var l;return s===((l=n.extensions)==null?void 0:l[a])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?dA.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function TP(t={},e=[]){const n=E.useRef(t);n.current=t;const[r]=E.useState(()=>new NP(n)),s=tN.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return E.useDebugValue(s),E.useEffect(r.onRender(e)),CP({editor:s,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),s}var fA=E.createContext({editor:null});fA.Consumer;var AP=E.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),MP=()=>E.useContext(AP);We.forwardRef((t,e)=>{const{onDragStart:n}=MP(),r=t.as||"div";return h.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});We.createContext({markViewContentRef:()=>{}});var Wb=E.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});Wb.displayName="TiptapContext";var jP=()=>E.useContext(Wb);function hA({editor:t,instance:e,children:n}){const r=t??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const s=E.useMemo(()=>({editor:r}),[r]),a=E.useMemo(()=>({editor:r}),[r]);return h.jsx(fA.Provider,{value:a,children:h.jsx(Wb.Provider,{value:s,children:n})})}hA.displayName="Tiptap";function pA({...t}){const{editor:e}=jP();return h.jsx(uA,{editor:e,...t})}pA.displayName="Tiptap.Content";Object.assign(hA,{Content:pA});var nh=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},OP=/^\s*>\s$/,_P=_n.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return nh("blockquote",{...Ot(this.options.HTMLAttributes,t),children:nh("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(s=>{const c=e.renderChildren([s]).split(`
`).map(d=>d.trim()===""?n:`${n} ${d}`);r.push(c.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[hl({find:OP,type:this.type})]}}),RP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,DP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,LP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,IP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,zP=ra.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return nh("strong",{...Ot(this.options.HTMLAttributes,t),children:nh("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[fl({find:RP,type:this.type}),fl({find:LP,type:this.type})]},addPasteRules(){return[Xa({find:DP,type:this.type}),Xa({find:IP,type:this.type})]}}),BP=/(^|[^`])`([^`]+)`(?!`)$/,PP=/(^|[^`])`([^`]+)`(?!`)/g,HP=ra.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ot(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[fl({find:BP,type:this.type})]},addPasteRules(){return[Xa({find:PP,type:this.type})]}}),c0=4,FP=/^```([a-z]+)?[\s\n]$/,UP=/^~~~([a-z]+)?[\s\n]$/,$P=_n.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:c0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(l=>l.startsWith(n)).map(l=>l.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Ot(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:c0,{state:r}=t,{selection:s}=r,{$from:a,empty:l}=s;if(a.parent.type!==this.type)return!1;const c=" ".repeat(n);return l?t.commands.insertContent(c):t.commands.command(({tr:d})=>{const{from:p,to:m}=s,v=r.doc.textBetween(p,m,`
`,`
`).split(`
`).map(w=>c+w).join(`
`);return d.replaceWith(p,m,r.schema.text(v)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:c0,{state:r}=t,{selection:s}=r,{$from:a,empty:l}=s;return a.parent.type!==this.type?!1:l?t.commands.command(({tr:c})=>{var d;const{pos:p}=a,m=a.start(),g=a.end(),v=r.doc.textBetween(m,g,`
`,`
`).split(`
`);let w=0,C=0;const k=p-m;for(let q=0;q<v.length;q+=1){if(C+v[q].length>=k){w=q;break}C+=v[q].length+1}const M=((d=v[w].match(/^ */))==null?void 0:d[0])||"",_=Math.min(M.length,n);if(_===0)return!0;let P=m;for(let q=0;q<w;q+=1)P+=v[q].length+1;return c.delete(P,P+_),p-P<=_&&c.setSelection(Be.create(c.doc,P)),!0}):t.commands.command(({tr:c})=>{const{from:d,to:p}=s,b=r.doc.textBetween(d,p,`
`,`
`).split(`
`).map(v=>{var w;const C=((w=v.match(/^ */))==null?void 0:w[0])||"",k=Math.min(C.length,n);return v.slice(k)}).join(`
`);return c.replaceWith(d,p,r.schema.text(b)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,l=r.parent.textContent.endsWith(`

`);return!a||!l?!1:t.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:a}=n;if(!a||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const c=s.after();return c===void 0?!1:r.nodeAt(c)?t.commands.command(({tr:p})=>(p.setSelection(Ve.near(r.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[Cx({find:FP,type:this.type,getAttributes:t=>({language:t[1]})}),Cx({find:UP,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new _t({key:new Wt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,a=s==null?void 0:s.mode;if(!n||!a)return!1;const{tr:l,schema:c}=t.state,d=c.text(n.replace(/\r\n?/g,`
`));return l.replaceSelectionWith(this.type.create({language:a},d)),l.selection.$from.parent.type!==this.type&&l.setSelection(Be.near(l.doc.resolve(Math.max(0,l.selection.from-2)))),l.setMeta("paste",!0),t.dispatch(l),!0}}})]}}),VP=_n.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),qP=_n.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ot(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:a}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:l}=this.options,{splittableMarks:c}=r.extensionManager,d=a||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:p,dispatch:m})=>{if(m&&d&&l){const g=d.filter(b=>c.includes(b.type.name));p.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),WP=_n.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ot(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Cx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),GP=_n.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ot(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!vB(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return qT(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:a,tr:l,dispatch:c})=>{if(c){const{$to:d}=l.selection,p=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?l.setSelection(Be.create(l.doc,d.pos+1)):d.nodeAfter.isBlock?l.setSelection(ze.create(l.doc,d.pos)):l.setSelection(Be.create(l.doc,d.pos));else{const m=a.schema.nodes[this.options.nextNodeType]||d.parent.type.contentMatch.defaultType,g=m==null?void 0:m.create();g&&(l.insert(p,g),l.setSelection(Be.create(l.doc,p+1)))}l.scrollIntoView()}return!0}).run()}}},addInputRules(){return[yB({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),KP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,YP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,JP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,XP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,QP=ra.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ot(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[fl({find:KP,type:this.type}),fl({find:JP,type:this.type})]},addPasteRules(){return[Xa({find:YP,type:this.type}),Xa({find:XP,type:this.type})]}});const ZP="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",e7="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Nx="numeric",Tx="ascii",Ax="alpha",Pc="asciinumeric",Mc="alphanumeric",Mx="domain",mA="emoji",t7="scheme",n7="slashscheme",u0="whitespace";function r7(t,e){return t in e||(e[t]=[]),e[t]}function za(t,e,n){e[Nx]&&(e[Pc]=!0,e[Mc]=!0),e[Tx]&&(e[Pc]=!0,e[Ax]=!0),e[Pc]&&(e[Mc]=!0),e[Ax]&&(e[Mc]=!0),e[Mc]&&(e[Mx]=!0),e[mA]&&(e[Mx]=!0);for(const r in e){const s=r7(r,n);s.indexOf(t)<0&&s.push(t)}}function s7(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function ir(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}ir.groups={};ir.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],a=e.jr[r][1];if(a&&s.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||ir.groups;let s;return e&&e.j?s=e:(s=new ir(e),n&&r&&za(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const a=t.length;if(!a)return s;for(let l=0;l<a-1;l++)s=s.tt(t[l]);return s.tt(t[a-1],e,n,r)},tt(t,e,n,r){r=r||ir.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const a=e;let l,c=s.go(t);if(c?(l=new ir,Object.assign(l.j,c.j),l.jr.push.apply(l.jr,c.jr),l.jd=c.jd,l.t=c.t):l=new ir,a){if(r)if(l.t&&typeof l.t=="string"){const d=Object.assign(s7(l.t,r),n);za(a,d,r)}else n&&za(a,n,r);l.t=a}return s.j[t]=l,l}};const Xe=(t,e,n,r,s)=>t.ta(e,n,r,s),$t=(t,e,n,r,s)=>t.tr(e,n,r,s),uC=(t,e,n,r,s)=>t.ts(e,n,r,s),xe=(t,e,n,r,s)=>t.tt(e,n,r,s),Bs="WORD",jx="UWORD",gA="ASCIINUMERICAL",xA="ALPHANUMERICAL",lu="LOCALHOST",Ox="TLD",_x="UTLD",yf="SCHEME",$o="SLASH_SCHEME",Gb="NUM",Rx="WS",Kb="NL",Hc="OPENBRACE",Fc="CLOSEBRACE",rh="OPENBRACKET",sh="CLOSEBRACKET",ih="OPENPAREN",ah="CLOSEPAREN",oh="OPENANGLEBRACKET",lh="CLOSEANGLEBRACKET",ch="FULLWIDTHLEFTPAREN",uh="FULLWIDTHRIGHTPAREN",dh="LEFTCORNERBRACKET",fh="RIGHTCORNERBRACKET",hh="LEFTWHITECORNERBRACKET",ph="RIGHTWHITECORNERBRACKET",mh="FULLWIDTHLESSTHAN",gh="FULLWIDTHGREATERTHAN",xh="AMPERSAND",bh="APOSTROPHE",yh="ASTERISK",Di="AT",vh="BACKSLASH",wh="BACKTICK",kh="CARET",zi="COLON",Yb="COMMA",Ch="DOLLAR",ss="DOT",Sh="EQUALS",Jb="EXCLAMATION",jr="HYPHEN",Uc="PERCENT",Eh="PIPE",Nh="PLUS",Th="POUND",$c="QUERY",Xb="QUOTE",bA="FULLWIDTHMIDDLEDOT",Qb="SEMI",is="SLASH",Vc="TILDE",Ah="UNDERSCORE",yA="EMOJI",Mh="SYM";var vA=Object.freeze({__proto__:null,ALPHANUMERICAL:xA,AMPERSAND:xh,APOSTROPHE:bh,ASCIINUMERICAL:gA,ASTERISK:yh,AT:Di,BACKSLASH:vh,BACKTICK:wh,CARET:kh,CLOSEANGLEBRACKET:lh,CLOSEBRACE:Fc,CLOSEBRACKET:sh,CLOSEPAREN:ah,COLON:zi,COMMA:Yb,DOLLAR:Ch,DOT:ss,EMOJI:yA,EQUALS:Sh,EXCLAMATION:Jb,FULLWIDTHGREATERTHAN:gh,FULLWIDTHLEFTPAREN:ch,FULLWIDTHLESSTHAN:mh,FULLWIDTHMIDDLEDOT:bA,FULLWIDTHRIGHTPAREN:uh,HYPHEN:jr,LEFTCORNERBRACKET:dh,LEFTWHITECORNERBRACKET:hh,LOCALHOST:lu,NL:Kb,NUM:Gb,OPENANGLEBRACKET:oh,OPENBRACE:Hc,OPENBRACKET:rh,OPENPAREN:ih,PERCENT:Uc,PIPE:Eh,PLUS:Nh,POUND:Th,QUERY:$c,QUOTE:Xb,RIGHTCORNERBRACKET:fh,RIGHTWHITECORNERBRACKET:ph,SCHEME:yf,SEMI:Qb,SLASH:is,SLASH_SCHEME:$o,SYM:Mh,TILDE:Vc,TLD:Ox,UNDERSCORE:Ah,UTLD:_x,UWORD:jx,WORD:Bs,WS:Rx});const Is=/[a-z]/,Cc=new RegExp("\\p{L}","u"),d0=new RegExp("\\p{Emoji}","u"),zs=/\d/,f0=/\s/,dC="\r",h0=`
`,i7="",a7="",p0="";let ef=null,tf=null;function o7(t=[]){const e={};ir.groups=e;const n=new ir;ef==null&&(ef=fC(ZP)),tf==null&&(tf=fC(e7)),xe(n,"'",bh),xe(n,"{",Hc),xe(n,"}",Fc),xe(n,"[",rh),xe(n,"]",sh),xe(n,"(",ih),xe(n,")",ah),xe(n,"<",oh),xe(n,">",lh),xe(n,"",ch),xe(n,"",uh),xe(n,"",dh),xe(n,"",fh),xe(n,"",hh),xe(n,"",ph),xe(n,"",mh),xe(n,"",gh),xe(n,"&",xh),xe(n,"*",yh),xe(n,"@",Di),xe(n,"`",wh),xe(n,"^",kh),xe(n,":",zi),xe(n,",",Yb),xe(n,"$",Ch),xe(n,".",ss),xe(n,"=",Sh),xe(n,"!",Jb),xe(n,"-",jr),xe(n,"%",Uc),xe(n,"|",Eh),xe(n,"+",Nh),xe(n,"#",Th),xe(n,"?",$c),xe(n,'"',Xb),xe(n,"/",is),xe(n,";",Qb),xe(n,"~",Vc),xe(n,"_",Ah),xe(n,"\\",vh),xe(n,"",bA);const r=$t(n,zs,Gb,{[Nx]:!0});$t(r,zs,r);const s=$t(r,Is,gA,{[Pc]:!0}),a=$t(r,Cc,xA,{[Mc]:!0}),l=$t(n,Is,Bs,{[Tx]:!0});$t(l,zs,s),$t(l,Is,l),$t(s,zs,s),$t(s,Is,s);const c=$t(n,Cc,jx,{[Ax]:!0});$t(c,Is),$t(c,zs,a),$t(c,Cc,c),$t(a,zs,a),$t(a,Is),$t(a,Cc,a);const d=xe(n,h0,Kb,{[u0]:!0}),p=xe(n,dC,Rx,{[u0]:!0}),m=$t(n,f0,Rx,{[u0]:!0});xe(n,p0,m),xe(p,h0,d),xe(p,p0,m),$t(p,f0,m),xe(m,dC),xe(m,h0),$t(m,f0,m),xe(m,p0,m);const g=$t(n,d0,yA,{[mA]:!0});xe(g,"#"),$t(g,d0,g),xe(g,i7,g);const b=xe(g,a7);xe(b,"#"),$t(b,d0,g);const v=[[Is,l],[zs,s]],w=[[Is,null],[Cc,c],[zs,a]];for(let C=0;C<ef.length;C++)Mi(n,ef[C],Ox,Bs,v);for(let C=0;C<tf.length;C++)Mi(n,tf[C],_x,jx,w);za(Ox,{tld:!0,ascii:!0},e),za(_x,{utld:!0,alpha:!0},e),Mi(n,"file",yf,Bs,v),Mi(n,"mailto",yf,Bs,v),Mi(n,"http",$o,Bs,v),Mi(n,"https",$o,Bs,v),Mi(n,"ftp",$o,Bs,v),Mi(n,"ftps",$o,Bs,v),za(yf,{scheme:!0,ascii:!0},e),za($o,{slashscheme:!0,ascii:!0},e),t=t.sort((C,k)=>C[0]>k[0]?1:-1);for(let C=0;C<t.length;C++){const k=t[C][0],M=t[C][1]?{[t7]:!0}:{[n7]:!0};k.indexOf("-")>=0?M[Mx]=!0:Is.test(k)?zs.test(k)?M[Pc]=!0:M[Tx]=!0:M[Nx]=!0,uC(n,k,k,M)}return uC(n,"localhost",lu,{ascii:!0}),n.jd=new ir(Mh),{start:n,tokens:Object.assign({groups:e},vA)}}function wA(t,e){const n=l7(e.replace(/[A-Z]/g,c=>c.toLowerCase())),r=n.length,s=[];let a=0,l=0;for(;l<r;){let c=t,d=null,p=0,m=null,g=-1,b=-1;for(;l<r&&(d=c.go(n[l]));)c=d,c.accepts()?(g=0,b=0,m=c):g>=0&&(g+=n[l].length,b++),p+=n[l].length,a+=n[l].length,l++;a-=g,l-=b,p-=g,s.push({t:m.t,v:e.slice(a-p,a),s:a-p,e:a})}return s}function l7(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),a,l=s<55296||s>56319||r+1===n||(a=t.charCodeAt(r+1))<56320||a>57343?t[r]:t.slice(r,r+2);e.push(l),r+=l.length}return e}function Mi(t,e,n,r,s){let a;const l=e.length;for(let c=0;c<l-1;c++){const d=e[c];t.j[d]?a=t.j[d]:(a=new ir(r),a.jr=s.slice(),t.j[d]=a),t=a}return a=new ir(n),a.jr=s.slice(),t.j[e[l-1]]=a,a}function fC(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let a=0;for(;s.indexOf(t[r+a])>=0;)a++;if(a>0){e.push(n.join(""));for(let l=parseInt(t.substring(r,r+a),10);l>0;l--)n.pop();r+=a}else n.push(t[r]),r++}return e}const cu={defaultProtocol:"http",events:null,format:hC,formatHref:hC,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Zb(t,e=null){let n=Object.assign({},cu);t&&(n=Object.assign(n,t instanceof Zb?t.o:t));const r=n.ignoreTags,s=[];for(let a=0;a<r.length;a++)s.push(r[a].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}Zb.prototype={o:cu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:cu[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function hC(t){return t}function kA(t,e){this.t="token",this.v=t,this.tk=e}kA.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=cu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),a=this.toFormattedString(t),l={},c=t.get("className",n,e),d=t.get("target",n,e),p=t.get("rel",n,e),m=t.getObj("attributes",n,e),g=t.getObj("events",n,e);return l.href=r,c&&(l.class=c),d&&(l.target=d),p&&(l.rel=p),m&&Object.assign(l,m),{tagName:s,attributes:l,content:a,eventListeners:g}}};function fp(t,e){class n extends kA{constructor(s,a){super(s,a),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const pC=fp("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),mC=fp("text"),c7=fp("nl"),nf=fp("url",{isLink:!0,toHref(t=cu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==lu&&t[1].t===zi}}),Mr=t=>new ir(t);function u7({groups:t}){const e=t.domain.concat([xh,yh,Di,vh,wh,kh,Ch,Sh,jr,Gb,Uc,Eh,Nh,Th,is,Mh,Vc,Ah]),n=[bh,zi,Yb,ss,Jb,Uc,$c,Xb,Qb,oh,lh,Hc,Fc,sh,rh,ih,ah,ch,uh,dh,fh,hh,ph,mh,gh],r=[xh,bh,yh,vh,wh,kh,Ch,Sh,jr,Hc,Fc,Uc,Eh,Nh,Th,$c,is,Mh,Vc,Ah],s=Mr(),a=xe(s,Vc);Xe(a,r,a),Xe(a,t.domain,a);const l=Mr(),c=Mr(),d=Mr();Xe(s,t.domain,l),Xe(s,t.scheme,c),Xe(s,t.slashscheme,d),Xe(l,r,a),Xe(l,t.domain,l);const p=xe(l,Di);xe(a,Di,p),xe(c,Di,p),xe(d,Di,p);const m=xe(a,ss);Xe(m,r,a),Xe(m,t.domain,a);const g=Mr();Xe(p,t.domain,g),Xe(g,t.domain,g);const b=xe(g,ss);Xe(b,t.domain,g);const v=Mr(pC);Xe(b,t.tld,v),Xe(b,t.utld,v),xe(p,lu,v);const w=xe(g,jr);xe(w,jr,w),Xe(w,t.domain,g),Xe(v,t.domain,g),xe(v,ss,b),xe(v,jr,w);const C=xe(v,zi);Xe(C,t.numeric,pC);const k=xe(l,jr),N=xe(l,ss);xe(k,jr,k),Xe(k,t.domain,l),Xe(N,r,a),Xe(N,t.domain,l);const M=Mr(nf);Xe(N,t.tld,M),Xe(N,t.utld,M),Xe(M,t.domain,l),Xe(M,r,a),xe(M,ss,N),xe(M,jr,k),xe(M,Di,p);const _=xe(M,zi),P=Mr(nf);Xe(_,t.numeric,P);const I=Mr(nf),q=Mr();Xe(I,e,I),Xe(I,n,q),Xe(q,e,I),Xe(q,n,q),xe(M,is,I),xe(P,is,I);const j=xe(c,zi),F=xe(d,zi),G=xe(F,is),te=xe(G,is);Xe(c,t.domain,l),xe(c,ss,N),xe(c,jr,k),Xe(d,t.domain,l),xe(d,ss,N),xe(d,jr,k),Xe(j,t.domain,I),xe(j,is,I),xe(j,$c,I),Xe(te,t.domain,I),Xe(te,e,I),xe(te,is,I);const he=[[Hc,Fc],[rh,sh],[ih,ah],[oh,lh],[ch,uh],[dh,fh],[hh,ph],[mh,gh]];for(let Ne=0;Ne<he.length;Ne++){const[Se,Te]=he[Ne],pe=xe(I,Se);xe(q,Se,pe),xe(pe,Te,I);const U=Mr(nf);Xe(pe,e,U);const Z=Mr();Xe(pe,n),Xe(U,e,U),Xe(U,n,Z),Xe(Z,e,U),Xe(Z,n,Z),xe(U,Te,I),xe(Z,Te,I)}return xe(s,lu,M),xe(s,Kb,c7),{start:s,tokens:vA}}function d7(t,e,n){let r=n.length,s=0,a=[],l=[];for(;s<r;){let c=t,d=null,p=null,m=0,g=null,b=-1;for(;s<r&&!(d=c.go(n[s].t));)l.push(n[s++]);for(;s<r&&(p=d||c.go(n[s].t));)d=null,c=p,c.accepts()?(b=0,g=c):b>=0&&b++,s++,m++;if(b<0)s-=m,s<r&&(l.push(n[s]),s++);else{l.length>0&&(a.push(m0(mC,e,l)),l=[]),s-=b,m-=b;const v=g.t,w=n.slice(s-m,s);a.push(m0(v,e,w))}}return l.length>0&&a.push(m0(mC,e,l)),a}function m0(t,e,n){const r=n[0].s,s=n[n.length-1].e,a=e.slice(r,s);return new t(a,n)}const f7=typeof console<"u"&&console&&console.warn||(()=>{}),h7="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",jt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function p7(){return ir.groups={},jt.scanner=null,jt.parser=null,jt.tokenQueue=[],jt.pluginQueue=[],jt.customSchemes=[],jt.initialized=!1,jt}function gC(t,e=!1){if(jt.initialized&&f7(`linkifyjs: already initialized - will not register custom scheme "${t}" ${h7}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);jt.customSchemes.push([t,e])}function m7(){jt.scanner=o7(jt.customSchemes);for(let t=0;t<jt.tokenQueue.length;t++)jt.tokenQueue[t][1]({scanner:jt.scanner});jt.parser=u7(jt.scanner.tokens);for(let t=0;t<jt.pluginQueue.length;t++)jt.pluginQueue[t][1]({scanner:jt.scanner,parser:jt.parser});return jt.initialized=!0,jt}function ey(t){return jt.initialized||m7(),d7(jt.parser.start,t,wA(jt.scanner.start,t))}ey.scan=wA;function CA(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Zb(n),s=ey(t),a=[];for(let l=0;l<s.length;l++){const c=s[l];c.isLink&&(!e||c.t===e)&&r.check(c)&&a.push(c.toFormattedObject(r))}return a}var ty="[\0- -\u2029]",g7=new RegExp(ty),x7=new RegExp(`${ty}$`),b7=new RegExp(ty,"g");function y7(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function v7(t){return new _t({key:new Wt("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(p=>p.docChanged)&&!n.doc.eq(r.doc),a=e.some(p=>p.getMeta("preventAutolink"));if(!s||a)return;const{tr:l}=r,c=IT(n.doc,[...e]);if(VT(c).forEach(({newRange:p})=>{const m=w8(r.doc,p,v=>v.isTextblock);let g,b;if(m.length>1)g=m[0],b=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(m.length){const v=r.doc.textBetween(p.from,p.to," "," ");if(!x7.test(v))return;g=m[0],b=r.doc.textBetween(g.pos,p.to,void 0," ")}if(g&&b){const v=b.split(g7).filter(Boolean);if(v.length<=0)return!1;const w=v[v.length-1],C=g.pos+b.lastIndexOf(w);if(!w)return!1;const k=ey(w).map(N=>N.toObject(t.defaultProtocol));if(!y7(k))return!1;k.filter(N=>N.isLink).map(N=>({...N,from:C+N.start+1,to:C+N.end+1})).filter(N=>r.schema.marks.code?!r.doc.rangeHasMark(N.from,N.to,r.schema.marks.code):!0).filter(N=>t.validate(N.value)).filter(N=>t.shouldAutoLink(N.value)).forEach(N=>{Fb(N.from,N.to,r.doc).some(M=>M.mark.type===t.type)||l.addMark(N.from,N.to,t.type.create({href:N.href}))})}}),!!l.steps.length)return l}})}function w7(t){return new _t({key:new Wt("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,a;if(r.button!==0||!e.editable)return!1;let l=null;if(r.target instanceof HTMLAnchorElement)l=r.target;else{const d=r.target;if(!d)return!1;const p=t.editor.view.dom;l=d.closest("a"),l&&!p.contains(l)&&(l=null)}if(!l)return!1;let c=!1;if(t.enableClickSelection&&(c=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const d=$T(e.state,t.type.name),p=(s=l.href)!=null?s:d.href,m=(a=l.target)!=null?a:d.target;p&&(window.open(p,m),c=!0)}return c}}})}function k7(t){return new _t({key:new Wt("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:a}=e,{selection:l}=a,{empty:c}=l;if(c)return!1;let d="";r.content.forEach(m=>{d+=m.textContent});const p=CA(d,{defaultProtocol:t.defaultProtocol}).find(m=>m.isLink&&m.value===d);return!d||!p||s!==void 0&&!s(p.value)?!1:t.editor.commands.setMark(t.type,{href:p.href})}}})}function Aa(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(b7,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var C7=ra.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){gC(t);return}gC(t.scheme,t.optionalSlashes)})},onDestroy(){p7()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Aa(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),n=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||n&&!t.includes("@"))return!0;const s=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!Aa(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Aa(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Ot(this.options.HTMLAttributes,t),0]:["a",Ot(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n,r,s,a;const l=(r=(n=t.attrs)==null?void 0:n.href)!=null?r:"",c=(a=(s=t.attrs)==null?void 0:s.title)!=null?a:"",d=e.renderChildren(t);return c?`[${d}](${l} "${c}")`:`[${d}](${l})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Aa(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Aa(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Xa({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=CA(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:l=>!!Aa(l,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(v7({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Aa(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(w7({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(k7({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),S7=Object.defineProperty,E7=(t,e)=>{for(var n in e)S7(t,n,{get:e[n],enumerable:!0})},N7="listItem",xC="textStyle",bC=/^\s*([-+*])\s$/,SA=_n.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ot(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(N7,this.editor.getAttributes(xC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=hl({find:bC,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=hl({find:bC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(xC),editor:this.editor})),[t]}}),EA=_n.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ot(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const l=t.tokens.slice(1),c=e.parseChildren(l);n.push(...c)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>qb(t,e,r=>{var s,a;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((a=(s=r.meta)==null?void 0:s.parentAttrs)==null?void 0:a.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),T7={};E7(T7,{findListItemPos:()=>Eu,getNextListDepth:()=>ny,handleBackspace:()=>Dx,handleDelete:()=>Lx,hasListBefore:()=>NA,hasListItemAfter:()=>A7,hasListItemBefore:()=>TA,listItemHasSubList:()=>AA,nextListIsDeeper:()=>MA,nextListIsHigher:()=>jA});var Eu=(t,e)=>{const{$from:n}=e.selection,r=sn(t,e.schema);let s=null,a=n.depth,l=n.pos,c=null;for(;a>0&&c===null;)s=n.node(a),s.type===r?c=a:(a-=1,l-=1);return c===null?null:{$pos:e.doc.resolve(l),depth:c}},ny=(t,e)=>{const n=Eu(t,e);if(!n)return!1;const[,r]=j8(e,t,n.$pos.pos+4);return r},NA=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),a=t.doc.resolve(s).node();return!(!a||!n.includes(a.type.name))},TA=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},AA=(t,e,n)=>{if(!n)return!1;const r=sn(t,e.schema);let s=!1;return n.descendants(a=>{a.type===r&&(s=!0)}),s},Dx=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Zi(t.state,e)&&NA(t.state,e,n)){const{$anchor:c}=t.state.selection,d=t.state.doc.resolve(c.before()-1),p=[];d.node().descendants((b,v)=>{b.type.name===e&&p.push({node:b,pos:v})});const m=p.at(-1);if(!m)return!1;const g=t.state.doc.resolve(d.start()+m.pos+1);return t.chain().cut({from:c.start()-1,to:c.end()+1},g.end()).joinForward().run()}if(!Zi(t.state,e)||!D8(t.state))return!1;const r=Eu(e,t.state);if(!r)return!1;const a=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),l=AA(e,t.state,a);return TA(e,t.state)&&!l?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},MA=(t,e)=>{const n=ny(t,e),r=Eu(t,e);return!r||!n?!1:n>r.depth},jA=(t,e)=>{const n=ny(t,e),r=Eu(t,e);return!r||!n?!1:n<r.depth},Lx=(t,e)=>{if(!Zi(t.state,e)||!R8(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:MA(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():jA(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},A7=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},OA=vt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Lx(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Lx(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&Dx(t,n,r)&&(e=!0)}),e}}}}),yC=/^(\s*)(\d+)\.\s+(.*)$/,M7=/^\s/;function j7(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],a=s.match(yC);if(!a)break;const[,l,c,d]=a,p=l.length;let m=d,g=n+1;const b=[s];for(;g<t.length;){const v=t[g];if(v.match(yC))break;if(v.trim()==="")b.push(v),m+=`
`,g+=1;else if(v.match(M7))b.push(v),m+=`
${v.slice(p+2)}`,g+=1;else break}e.push({indent:p,number:parseInt(c,10),content:m.trim(),raw:b.join(`
`)}),r=g,n=g}return[e,r]}function _A(t,e,n){var r;const s=[];let a=0;for(;a<t.length;){const l=t[a];if(l.indent===e){const c=l.content.split(`
`),d=((r=c[0])==null?void 0:r.trim())||"",p=[];d&&p.push({type:"paragraph",raw:d,tokens:n.inlineTokens(d)});const m=c.slice(1).join(`
`).trim();if(m){const v=n.blockTokens(m);p.push(...v)}let g=a+1;const b=[];for(;g<t.length&&t[g].indent>e;)b.push(t[g]),g+=1;if(b.length>0){const v=Math.min(...b.map(C=>C.indent)),w=_A(b,v,n);p.push({type:"list",ordered:!0,start:b[0].number,items:w,raw:b.map(C=>C.raw).join(`
`)})}s.push({type:"list_item",raw:l.raw,tokens:p}),a=g}else a+=1}return s}function O7(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const a=e.parseChildren([s]);r.push({type:"paragraph",content:a})}else{const a=e.parseChildren([s]);a.length>0&&r.push(...a)}}),{type:"listItem",content:r}})}var _7="listItem",vC="textStyle",wC=/^(\d+)\.\s$/,RA=_n.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Ot(this.options.HTMLAttributes,n),0]:["ol",Ot(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?O7(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e==null?void 0:e.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[a,l]=j7(s);if(a.length===0)return;const c=_A(a,0,n);return c.length===0?void 0:{type:"list",ordered:!0,start:((r=a[0])==null?void 0:r.number)||1,items:c,raw:s.slice(0,l).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(_7,this.editor.getAttributes(vC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=hl({find:wC,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=hl({find:wC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(vC)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),R7=/^\s*(\[([( |x])?\])\s$/,DA=_n.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Ot(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return qb(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),a=document.createElement("label"),l=document.createElement("span"),c=document.createElement("input"),d=document.createElement("div"),p=g=>{var b,v;c.ariaLabel=((v=(b=this.options.a11y)==null?void 0:b.checkboxLabel)==null?void 0:v.call(b,g,c.checked))||`Task item checkbox for ${g.textContent||"empty task item"}`};p(t),a.contentEditable="false",c.type="checkbox",c.addEventListener("mousedown",g=>g.preventDefault()),c.addEventListener("change",g=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){c.checked=!c.checked;return}const{checked:b}=g.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const w=n();if(typeof w!="number")return!1;const C=v.doc.nodeAt(w);return v.setNodeMarkup(w,void 0,{...C==null?void 0:C.attrs,checked:b}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,b)||(c.checked=!c.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([g,b])=>{s.setAttribute(g,b)}),s.dataset.checked=t.attrs.checked,c.checked=t.attrs.checked,a.append(c,l),s.append(a,d),Object.entries(e).forEach(([g,b])=>{s.setAttribute(g,b)});let m=new Set(Object.keys(e));return{dom:s,contentDOM:d,update:g=>{if(g.type!==this.type)return!1;s.dataset.checked=g.attrs.checked,c.checked=g.attrs.checked,p(g);const b=r.extensionManager.attributes,v=ou(g,b),w=new Set(Object.keys(v)),C=this.options.HTMLAttributes;return m.forEach(k=>{w.has(k)||(k in C?s.setAttribute(k,C[k]):s.removeAttribute(k))}),Object.entries(v).forEach(([k,N])=>{N==null?k in C?s.setAttribute(k,C[k]):s.removeAttribute(k):s.setAttribute(k,N)}),m=w,!0}}}},addInputRules(){return[hl({find:R7,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),LA=_n.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Ot(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=a=>{const l=Sx(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:c=>({indentLevel:c[1].length,mainContent:c[4],checked:c[3].toLowerCase()==="x"}),createToken:(c,d)=>({type:"taskItem",raw:"",mainContent:c.mainContent,indentLevel:c.indentLevel,checked:c.checked,text:c.mainContent,tokens:n.inlineTokens(c.mainContent),nestedTokens:d}),customNestedParser:r},n);return l?[{type:"taskList",raw:l.raw,items:l.items}]:n.blockTokens(a)},s=Sx(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:n.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});vt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(SA.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(EA.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(OA.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(RA.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(DA.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(LA.configure(this.options.taskList)),t}});var kC="&nbsp;",D7="",L7=_n.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ot(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];if(n.length===1&&n[0].type==="image")return e.parseChildren([n[0]]);const r=e.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===kC||r[0].text===D7)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(t,e)=>{if(!t)return"";const n=Array.isArray(t.content)?t.content:[];return n.length===0?kC:e.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),I7=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,z7=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,B7=ra.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ot(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[fl({find:I7,type:this.type})]},addPasteRules(){return[Xa({find:z7,type:this.type})]}}),P7=_n.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),IA=ra.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Ot(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const a=s[2].trim();return{type:"underline",raw:s[0],text:a,tokens:n.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),H7=IA;function F7(t={}){return new _t({view(e){return new U7(e,t)}})}class U7{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let a=l=>{this[s](l)};return e.dom.addEventListener(s,a),{name:s,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,a=s.getBoundingClientRect(),l=a.width/s.offsetWidth,c=a.height/s.offsetHeight;if(n){let g=e.nodeBefore,b=e.nodeAfter;if(g||b){let v=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(v){let w=v.getBoundingClientRect(),C=g?w.bottom:w.top;g&&b&&(C=(C+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let k=this.width/2*c;r={left:w.left,right:w.right,top:C-k,bottom:C+k}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),b=this.width/2*l;r={left:g.left-b,right:g.left+b,top:g.top,bottom:g.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let p,m;if(!d||d==document.body&&getComputedStyle(d).position=="static")p=-pageXOffset,m=-pageYOffset;else{let g=d.getBoundingClientRect(),b=g.width/d.offsetWidth,v=g.height/d.offsetHeight;p=g.left-d.scrollLeft*b,m=g.top-d.scrollTop*v}this.element.style.left=(r.left-p)/l+"px",this.element.style.top=(r.top-m)/c+"px",this.element.style.width=(r.right-r.left)/l+"px",this.element.style.height=(r.bottom-r.top)/c+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!a){let l=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=AN(this.editorView.state.doc,l,this.editorView.dragging.slice);c!=null&&(l=c)}this.setCursor(l),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Vt extends Ve{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Vt.valid(r)?new Vt(r):Ve.near(r)}content(){return Ee.empty}eq(e){return e instanceof Vt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Vt(e.resolve(n.pos))}getBookmark(){return new ry(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!$7(e)||!V7(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Vt.valid(e))return e;let s=e.pos,a=null;for(let l=e.depth;;l--){let c=e.node(l);if(n>0?e.indexAfter(l)<c.childCount:e.index(l)>0){a=c.child(n>0?e.indexAfter(l):e.index(l)-1);break}else if(l==0)return null;s+=n;let d=e.doc.resolve(s);if(Vt.valid(d))return d}for(;;){let l=n>0?a.firstChild:a.lastChild;if(!l){if(a.isAtom&&!a.isText&&!ze.isSelectable(a)){e=e.doc.resolve(s+a.nodeSize*n),r=!1;continue e}break}a=l,s+=n;let c=e.doc.resolve(s);if(Vt.valid(c))return c}return null}}}Vt.prototype.visible=!1;Vt.findFrom=Vt.findGapCursorFrom;Ve.jsonID("gapcursor",Vt);class ry{constructor(e){this.pos=e}map(e){return new ry(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Vt.valid(n)?new Vt(n):Ve.near(n)}}function zA(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function $7(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||zA(s.type))return!0;if(s.inlineContent)return!1}}return!0}function V7(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||zA(s.type))return!0;if(s.inlineContent)return!1}}return!0}function q7(){return new _t({props:{decorations:Y7,createSelectionBetween(t,e,n){return e.pos==n.pos&&Vt.valid(n)?new Vt(n):null},handleClick:G7,handleKeyDown:W7,handleDOMEvents:{beforeinput:K7}}})}const W7=Lb({ArrowLeft:rf("horiz",-1),ArrowRight:rf("horiz",1),ArrowUp:rf("vert",-1),ArrowDown:rf("vert",1)});function rf(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,a){let l=r.selection,c=e>0?l.$to:l.$from,d=l.empty;if(l instanceof Be){if(!a.endOfTextblock(n)||c.depth==0)return!1;d=!1,c=r.doc.resolve(e>0?c.after():c.before())}let p=Vt.findGapCursorFrom(c,e,d);return p?(s&&s(r.tr.setSelection(new Vt(p))),!0):!1}}function G7(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Vt.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&ze.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Vt(r))),!0)}function K7(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Vt))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=fe.empty;for(let l=r.length-1;l>=0;l--)s=fe.from(r[l].createAndFill(null,s));let a=t.state.tr.replace(n.pos,n.pos,new Ee(s,0,0));return a.setSelection(Be.near(a.doc.resolve(n.pos+1))),t.dispatch(a),!1}function Y7(t){if(!(t.selection instanceof Vt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Nt.create(t.doc,[yn.widget(t.selection.head,e,{key:"gapcursor"})])}var jh=200,wn=function(){};wn.prototype.append=function(e){return e.length?(e=wn.from(e),!this.length&&e||e.length<jh&&this.leafAppend(e)||this.length<jh&&e.leafPrepend(this)||this.appendInner(e)):this};wn.prototype.prepend=function(e){return e.length?wn.from(e).append(this):this};wn.prototype.appendInner=function(e){return new J7(this,e)};wn.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?wn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};wn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};wn.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};wn.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(a,l){return s.push(e(a,l))},n,r),s};wn.from=function(e){return e instanceof wn?e:e&&e.length?new BA(e):wn.empty};var BA=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,a){return s==0&&a==this.length?this:new e(this.values.slice(s,a))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,a,l,c){for(var d=a;d<l;d++)if(s(this.values[d],c+d)===!1)return!1},e.prototype.forEachInvertedInner=function(s,a,l,c){for(var d=a-1;d>=l;d--)if(s(this.values[d],c+d)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=jh)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=jh)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(wn);wn.empty=new BA([]);var J7=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,a,l){var c=this.left.length;if(s<c&&this.left.forEachInner(r,s,Math.min(a,c),l)===!1||a>c&&this.right.forEachInner(r,Math.max(s-c,0),Math.min(this.length,a)-c,l+c)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,a,l){var c=this.left.length;if(s>c&&this.right.forEachInvertedInner(r,s-c,Math.max(a,c)-c,l+c)===!1||a<c&&this.left.forEachInvertedInner(r,Math.min(s,c),a,l)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var a=this.left.length;return s<=a?this.left.slice(r,s):r>=a?this.right.slice(r-a,s-a):this.left.slice(r,a).append(this.right.slice(0,s-a))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(wn);const X7=500;class Hr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,a;n&&(s=this.remapping(r,this.items.length),a=s.maps.length);let l=e.tr,c,d,p=[],m=[];return this.items.forEach((g,b)=>{if(!g.step){s||(s=this.remapping(r,b+1),a=s.maps.length),a--,m.push(g);return}if(s){m.push(new as(g.map));let v=g.step.map(s.slice(a)),w;v&&l.maybeStep(v).doc&&(w=l.mapping.maps[l.mapping.maps.length-1],p.push(new as(w,void 0,void 0,p.length+m.length))),a--,w&&s.appendMap(w,a)}else l.maybeStep(g.step);if(g.selection)return c=s?g.selection.map(s.slice(a)):g.selection,d=new Hr(this.items.slice(0,r).append(m.reverse().concat(p)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:l,selection:c}}addTransform(e,n,r,s){let a=[],l=this.eventCount,c=this.items,d=!s&&c.length?c.get(c.length-1):null;for(let m=0;m<e.steps.length;m++){let g=e.steps[m].invert(e.docs[m]),b=new as(e.mapping.maps[m],g,n),v;(v=d&&d.merge(b))&&(b=v,m?a.pop():c=c.slice(0,c.length-1)),a.push(b),n&&(l++,n=void 0),s||(d=b)}let p=l-r.depth;return p>Z7&&(c=Q7(c,p),l-=p),new Hr(c.append(a),l)}remapping(e,n){let r=new tu;return this.items.forEach((s,a)=>{let l=s.mirrorOffset!=null&&a-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,l)},e,n),r}addMaps(e){return this.eventCount==0?this:new Hr(this.items.append(e.map(n=>new as(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),a=e.mapping,l=e.steps.length,c=this.eventCount;this.items.forEach(b=>{b.selection&&c--},s);let d=n;this.items.forEach(b=>{let v=a.getMirror(--d);if(v==null)return;l=Math.min(l,v);let w=a.maps[v];if(b.step){let C=e.steps[v].invert(e.docs[v]),k=b.selection&&b.selection.map(a.slice(d+1,v));k&&c++,r.push(new as(w,C,k))}else r.push(new as(w))},s);let p=[];for(let b=n;b<l;b++)p.push(new as(a.maps[b]));let m=this.items.slice(0,s).append(p).append(r),g=new Hr(m,c);return g.emptyItemCount()>X7&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],a=0;return this.items.forEach((l,c)=>{if(c>=e)s.push(l),l.selection&&a++;else if(l.step){let d=l.step.map(n.slice(r)),p=d&&d.getMap();if(r--,p&&n.appendMap(p,r),d){let m=l.selection&&l.selection.map(n.slice(r));m&&a++;let g=new as(p.invert(),d,m),b,v=s.length-1;(b=s.length&&s[v].merge(g))?s[v]=b:s.push(g)}}else l.map&&r--},this.items.length,0),new Hr(wn.from(s.reverse()),a)}}Hr.empty=new Hr(wn.empty,0);function Q7(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class as{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new as(n.getMap().invert(),n,this.selection)}}}class Li{constructor(e,n,r,s,a){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=a}}const Z7=20;function e9(t,e,n,r){let s=n.getMeta(qa),a;if(s)return s.historyState;n.getMeta(r9)&&(t=new Li(t.done,t.undone,null,0,-1));let l=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(l&&l.getMeta(qa))return l.getMeta(qa).redo?new Li(t.done.addTransform(n,void 0,r,vf(e)),t.undone,CC(n.mapping.maps),t.prevTime,t.prevComposition):new Li(t.done,t.undone.addTransform(n,void 0,r,vf(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(l&&l.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),d=t.prevTime==0||!l&&t.prevComposition!=c&&(t.prevTime<(n.time||0)-r.newGroupDelay||!t9(n,t.prevRanges)),p=l?g0(t.prevRanges,n.mapping):CC(n.mapping.maps);return new Li(t.done.addTransform(n,d?e.selection.getBookmark():void 0,r,vf(e)),Hr.empty,p,n.time,c??t.prevComposition)}else return(a=n.getMeta("rebased"))?new Li(t.done.rebased(n,a),t.undone.rebased(n,a),g0(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Li(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),g0(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function t9(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let a=0;a<e.length;a+=2)r<=e[a+1]&&s>=e[a]&&(n=!0)}),n}function CC(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,a,l)=>e.push(a,l));return e}function g0(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),a=e.map(t[r+1],-1);s<=a&&n.push(s,a)}return n}function n9(t,e,n){let r=vf(e),s=qa.get(e).spec.config,a=(n?t.undone:t.done).popEvent(e,r);if(!a)return null;let l=a.selection.resolve(a.transform.doc),c=(n?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),s,r),d=new Li(n?c:a.remaining,n?a.remaining:c,null,0,-1);return a.transform.setSelection(l).setMeta(qa,{redo:n,historyState:d})}let x0=!1,SC=null;function vf(t){let e=t.plugins;if(SC!=e){x0=!1,SC=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){x0=!0;break}}return x0}const qa=new Wt("history"),r9=new Wt("closeHistory");function s9(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new _t({key:qa,state:{init(){return new Li(Hr.empty,Hr.empty,null,0,-1)},apply(e,n,r){return e9(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?HA:r=="historyRedo"?FA:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function PA(t,e){return(n,r)=>{let s=qa.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let a=n9(s,n,t);a&&r(e?a.scrollIntoView():a)}return!0}}const HA=PA(!1,!0),FA=PA(!0,!0);vt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new _t({key:new Wt("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const a=this.storage.characters({node:r.doc});if(a>s){const l=a-s,c=0,d=l;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const p=r.tr.deleteRange(c,d);return t=!0,p}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),a=this.storage.characters({node:e.doc});if(a<=r||s>r&&a>r&&a<=s)return!0;if(s>r&&a>r&&a>s||!e.getMeta("paste"))return!1;const c=e.selection.$head.pos,d=a-r,p=c-d,m=c;return e.deleteRange(p,m),!(this.storage.characters({node:e.doc})>r)}})]}});var i9=vt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[F7(this.options)]}});vt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new _t({key:new Wt("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,a=[];if(!n||!r)return Nt.create(t,[]);let l=0;this.options.mode==="deepest"&&t.descendants((d,p)=>{if(d.isText)return;if(!(s>=p&&s<=p+d.nodeSize-1))return!1;l+=1});let c=0;return t.descendants((d,p)=>{if(d.isText||!(s>=p&&s<=p+d.nodeSize-1))return!1;if(c+=1,this.options.mode==="deepest"&&l-c>0||this.options.mode==="shallowest"&&c>1)return this.options.mode==="deepest";a.push(yn.node(p,p+d.nodeSize,{class:this.options.className}))}),Nt.create(t,a)}}})]}});var a9=vt.create({name:"gapCursor",addProseMirrorPlugins(){return[q7()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ht(Le(t,"allowGapCursor",n)))!=null?e:null}}}),EC="placeholder";function o9(t){return t.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var l9=vt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:EC,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const t=this.options.dataAttribute?`data-${o9(this.options.dataAttribute)}`:`data-${EC}`;return[new _t({key:new Wt("placeholder"),props:{decorations:({doc:e,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=n,a=[];if(!r)return null;const l=this.editor.isEmpty;return e.descendants((c,d)=>{const p=s>=d&&s<=d+c.nodeSize,m=!c.isLeaf&&cp(c);if((p||!this.options.showOnlyCurrent)&&m){const g=[this.options.emptyNodeClass];l&&g.push(this.options.emptyEditorClass);const b=yn.node(d,d+c.nodeSize,{class:g.join(" "),[t]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:c,pos:d,hasAnchor:p}):this.options.placeholder});a.push(b)}return this.options.includeChildren}),Nt.create(e,a)}}})]}});vt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new _t({key:new Wt("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||qT(n.selection)||t.view.dragging?null:Nt.create(n.doc,[yn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function NC({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var c9=vt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Wt(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new _t({key:e,appendTransaction:(s,a,l)=>{const{doc:c,tr:d,schema:p}=l,m=e.getState(l),g=c.content.size,b=p.nodes[n];if(m)return d.insert(g,b.create())},state:{init:(s,a)=>{const l=a.tr.doc.lastChild;return!NC({node:l,types:r})},apply:(s,a)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return a;const l=s.doc.lastChild;return!NC({node:l,types:r})}}})]}}),u9=vt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>HA(t,e),redo:()=>({state:t,dispatch:e})=>FA(t,e)}},addProseMirrorPlugins(){return[s9(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),d9=vt.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(zP.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(_P.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(SA.configure(this.options.bulletList)),this.options.code!==!1&&s.push(HP.configure(this.options.code)),this.options.codeBlock!==!1&&s.push($P.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(VP.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(i9.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(a9.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(qP.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(WP.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(u9.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(GP.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(QP.configure(this.options.italic)),this.options.listItem!==!1&&s.push(EA.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(OA.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(C7.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(RA.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(L7.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(B7.configure(this.options.strike)),this.options.text!==!1&&s.push(P7.configure(this.options.text)),this.options.underline!==!1&&s.push(IA.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(c9.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),f9=d9,h9=LA,p9=DA,m9=l9,g9=20,UA=(t,e=0)=>{const n=[];return!t.children.length||e>g9||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...UA(r,e+1))}),n},x9=t=>{if(!t.children.length)return;const e=UA(t);e&&e.forEach(n=>{var r,s;const a=n.getAttribute("style"),l=(s=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");n.setAttribute("style",`${l};${a}`)})},$A=ra.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&x9(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",Ot(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(a=>!!a))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),b9=vt.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const a=r[s].split(":");if(a.length>=2){const l=a[0].trim().toLowerCase(),c=a.slice(1).join(":").trim();if(l==="background-color")return c.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),VA=vt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const a=r[s].split(":");if(a.length>=2){const l=a[0].trim().toLowerCase(),c=a.slice(1).join(":").trim();if(l==="color")return c.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),y9=vt.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),v9=vt.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),w9=vt.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});vt.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(b9.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(VA.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(y9.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(v9.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(w9.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push($A.configure(this.options.textStyle)),t}});var k9=VA;let Ix,zx;if(typeof WeakMap<"u"){let t=new WeakMap;Ix=e=>t.get(e),zx=(e,n)=>(t.set(e,n),n)}else{const t=[];let n=0;Ix=r=>{for(let s=0;s<t.length;s+=2)if(t[s]==r)return t[s+1]},zx=(r,s)=>(n==10&&(n=0),t[n++]=r,t[n++]=s)}var qt=class{constructor(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r}findCell(t){for(let e=0;e<this.map.length;e++){const n=this.map[e];if(n!=t)continue;const r=e%this.width,s=e/this.width|0;let a=r+1,l=s+1;for(let c=1;a<this.width&&this.map[e+c]==n;c++)a++;for(let c=1;l<this.height&&this.map[e+this.width*c]==n;c++)l++;return{left:r,top:s,right:a,bottom:l}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,e,n){const{left:r,right:s,top:a,bottom:l}=this.findCell(t);return e=="horiz"?(n<0?r==0:s==this.width)?null:this.map[a*this.width+(n<0?r-1:s)]:(n<0?a==0:l==this.height)?null:this.map[r+this.width*(n<0?a-1:l)]}rectBetween(t,e){const{left:n,right:r,top:s,bottom:a}=this.findCell(t),{left:l,right:c,top:d,bottom:p}=this.findCell(e);return{left:Math.min(n,l),top:Math.min(s,d),right:Math.max(r,c),bottom:Math.max(a,p)}}cellsInRect(t){const e=[],n={};for(let r=t.top;r<t.bottom;r++)for(let s=t.left;s<t.right;s++){const a=r*this.width+s,l=this.map[a];n[l]||(n[l]=!0,!(s==t.left&&s&&this.map[a-1]==l||r==t.top&&r&&this.map[a-this.width]==l)&&e.push(l))}return e}positionAt(t,e,n){for(let r=0,s=0;;r++){const a=s+n.child(r).nodeSize;if(r==t){let l=e+t*this.width;const c=(t+1)*this.width;for(;l<c&&this.map[l]<s;)l++;return l==c?a-1:this.map[l]}s=a}}static get(t){return Ix(t)||zx(t,C9(t))}};function C9(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=S9(t),n=t.childCount,r=[];let s=0,a=null;const l=[];for(let p=0,m=e*n;p<m;p++)r[p]=0;for(let p=0,m=0;p<n;p++){const g=t.child(p);m++;for(let w=0;;w++){for(;s<r.length&&r[s]!=0;)s++;if(w==g.childCount)break;const C=g.child(w),{colspan:k,rowspan:N,colwidth:M}=C.attrs;for(let _=0;_<N;_++){if(_+p>=n){(a||(a=[])).push({type:"overlong_rowspan",pos:m,n:N-_});break}const P=s+_*e;for(let I=0;I<k;I++){r[P+I]==0?r[P+I]=m:(a||(a=[])).push({type:"collision",row:p,pos:m,n:k-I});const q=M&&M[I];if(q){const j=(P+I)%e*2,F=l[j];F==null||F!=q&&l[j+1]==1?(l[j]=q,l[j+1]=1):F==q&&l[j+1]++}}}s+=k,m+=C.nodeSize}const b=(p+1)*e;let v=0;for(;s<b;)r[s++]==0&&v++;v&&(a||(a=[])).push({type:"missing",row:p,n:v}),m++}(e===0||n===0)&&(a||(a=[])).push({type:"zero_sized"});const c=new qt(e,n,r,a);let d=!1;for(let p=0;!d&&p<l.length;p+=2)l[p]!=null&&l[p+1]<n&&(d=!0);return d&&E9(c,l,t),c}function S9(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const s=t.child(r);let a=0;if(n)for(let l=0;l<r;l++){const c=t.child(l);for(let d=0;d<c.childCount;d++){const p=c.child(d);l+p.attrs.rowspan>r&&(a+=p.attrs.colspan)}}for(let l=0;l<s.childCount;l++){const c=s.child(l);a+=c.attrs.colspan,c.attrs.rowspan>1&&(n=!0)}e==-1?e=a:e!=a&&(e=Math.max(e,a))}return e}function E9(t,e,n){t.problems||(t.problems=[]);const r={};for(let s=0;s<t.map.length;s++){const a=t.map[s];if(r[a])continue;r[a]=!0;const l=n.nodeAt(a);if(!l)throw new RangeError(`No cell with offset ${a} found`);let c=null;const d=l.attrs;for(let p=0;p<d.colspan;p++){const m=e[(s+p)%t.width*2];m!=null&&(!d.colwidth||d.colwidth[p]!=m)&&((c||(c=N9(d)))[p]=m)}c&&t.problems.unshift({type:"colwidth mismatch",pos:a,colwidth:c})}}function N9(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function zn(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],s=r.spec.tableRole;s&&(e[s]=r)}}return e}const Bi=new Wt("selectingCells");function Qa(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function T9(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function Gr(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function hp(t){const e=t.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const n=Qa(e.$head)||A9(e.$head);if(n)return n;throw new RangeError(`No cell found around position ${e.head}`)}function A9(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function Bx(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function M9(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function sy(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function qA(t,e,n){const r=t.node(-1),s=qt.get(r),a=t.start(-1),l=s.nextCell(t.pos-a,e,n);return l==null?null:t.node(0).resolve(a+l)}function Za(t,e,n=1){const r={...t,colspan:t.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function WA(t,e,n=1){const r={...t,colspan:t.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<n;s++)r.colwidth.splice(e,0,0)}return r}function j9(t,e,n){const r=zn(e.type.schema).header_cell;for(let s=0;s<t.height;s++)if(e.nodeAt(t.map[n+s*t.width]).type!=r)return!1;return!0}var Tt=class Ps extends Ve{constructor(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.rectBetween(e.pos-a,n.pos-a),c=e.node(0),d=s.cellsInRect(l).filter(m=>m!=n.pos-a);d.unshift(n.pos-a);const p=d.map(m=>{const g=r.nodeAt(m);if(!g)throw new RangeError(`No cell with offset ${m} found`);const b=a+m+1;return new RN(c.resolve(b),c.resolve(b+g.content.size))});super(p[0].$from,p[0].$to,p),this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),s=e.resolve(n.map(this.$headCell.pos));if(Bx(r)&&Bx(s)&&sy(r,s)){const a=this.$anchorCell.node(-1)!=r.node(-1);return a&&this.isRowSelection()?Ps.rowSelection(r,s):a&&this.isColSelection()?Ps.colSelection(r,s):new Ps(r,s)}return Be.between(r,s)}content(){const e=this.$anchorCell.node(-1),n=qt.get(e),r=this.$anchorCell.start(-1),s=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),a={},l=[];for(let d=s.top;d<s.bottom;d++){const p=[];for(let m=d*n.width+s.left,g=s.left;g<s.right;g++,m++){const b=n.map[m];if(a[b])continue;a[b]=!0;const v=n.findCell(b);let w=e.nodeAt(b);if(!w)throw new RangeError(`No cell with offset ${b} found`);const C=s.left-v.left,k=v.right-s.right;if(C>0||k>0){let N=w.attrs;if(C>0&&(N=Za(N,0,C)),k>0&&(N=Za(N,N.colspan-k,k)),v.left<s.left){if(w=w.type.createAndFill(N),!w)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(N)}`)}else w=w.type.create(N,w.content)}if(v.top<s.top||v.bottom>s.bottom){const N={...w.attrs,rowspan:Math.min(v.bottom,s.bottom)-Math.max(v.top,s.top)};v.top<s.top?w=w.type.createAndFill(N):w=w.type.create(N,w.content)}p.push(w)}l.push(e.child(d).copy(fe.from(p)))}const c=this.isColSelection()&&this.isRowSelection()?e:l;return new Ee(fe.from(c),1,1)}replace(e,n=Ee.empty){const r=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){const{$from:c,$to:d}=s[l],p=e.mapping.slice(r);e.replace(p.map(c.pos),p.map(d.pos),l?Ee.empty:n)}const a=Ve.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);a&&e.setSelection(a)}replaceWith(e,n){this.replace(e,new Ee(fe.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=qt.get(n),s=this.$anchorCell.start(-1),a=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let l=0;l<a.length;l++)e(n.nodeAt(a[l]),s+a[l])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,s=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.findCell(e.pos-a),c=s.findCell(n.pos-a),d=e.node(0);return l.top<=c.top?(l.top>0&&(e=d.resolve(a+s.map[l.left])),c.bottom<s.height&&(n=d.resolve(a+s.map[s.width*(s.height-1)+c.right-1]))):(c.top>0&&(n=d.resolve(a+s.map[c.left])),l.bottom<s.height&&(e=d.resolve(a+s.map[s.width*(s.height-1)+l.right-1]))),new Ps(e,n)}isRowSelection(){const e=this.$anchorCell.node(-1),n=qt.get(e),r=this.$anchorCell.start(-1),s=n.colCount(this.$anchorCell.pos-r),a=n.colCount(this.$headCell.pos-r);if(Math.min(s,a)>0)return!1;const l=s+this.$anchorCell.nodeAfter.attrs.colspan,c=a+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,c)==n.width}eq(e){return e instanceof Ps&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=e.node(-1),s=qt.get(r),a=e.start(-1),l=s.findCell(e.pos-a),c=s.findCell(n.pos-a),d=e.node(0);return l.left<=c.left?(l.left>0&&(e=d.resolve(a+s.map[l.top*s.width])),c.right<s.width&&(n=d.resolve(a+s.map[s.width*(c.top+1)-1]))):(c.left>0&&(n=d.resolve(a+s.map[c.top*s.width])),l.right<s.width&&(e=d.resolve(a+s.map[s.width*(l.top+1)-1]))),new Ps(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Ps(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Ps(e.resolve(n),e.resolve(r))}getBookmark(){return new O9(this.$anchorCell.pos,this.$headCell.pos)}};Tt.prototype.visible=!1;Ve.jsonID("cell",Tt);var O9=class GA{constructor(e,n){this.anchor=e,this.head=n}map(e){return new GA(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&sy(n,r)?new Tt(n,r):Ve.near(r,1)}};function _9(t){if(!(t.selection instanceof Tt))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(yn.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Nt.create(t.doc,e)}function R9({$from:t,$to:e}){if(t.pos==e.pos||t.pos<e.pos-6)return!1;let n=t.pos,r=e.pos,s=t.depth;for(;s>=0&&!(t.after(s+1)<t.end(s));s--,n++);for(let a=e.depth;a>=0&&!(e.before(a+1)>e.start(a));a--,r--);return n==r&&/row|table/.test(t.node(s).type.spec.tableRole)}function D9({$from:t,$to:e}){let n,r;for(let s=t.depth;s>0;s--){const a=t.node(s);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){n=a;break}}for(let s=e.depth;s>0;s--){const a=e.node(s);if(a.type.spec.tableRole==="cell"||a.type.spec.tableRole==="header_cell"){r=a;break}}return n!==r&&e.parentOffset===0}function L9(t,e,n){const r=(e||t).selection,s=(e||t).doc;let a,l;if(r instanceof ze&&(l=r.node.type.spec.tableRole)){if(l=="cell"||l=="header_cell")a=Tt.create(s,r.from);else if(l=="row"){const c=s.resolve(r.from+1);a=Tt.rowSelection(c,c)}else if(!n){const c=qt.get(r.node),d=r.from+1,p=d+c.map[c.width*c.height-1];a=Tt.create(s,d+1,p)}}else r instanceof Be&&R9(r)?a=Be.create(s,r.from):r instanceof Be&&D9(r)&&(a=Be.create(s,r.$from.start(),r.$from.end()));return a&&(e||(e=t.tr)).setSelection(a),e}const I9=new Wt("fix-tables");function KA(t,e,n,r){const s=t.childCount,a=e.childCount;e:for(let l=0,c=0;l<a;l++){const d=e.child(l);for(let p=c,m=Math.min(s,l+3);p<m;p++)if(t.child(p)==d){c=p+1,n+=d.nodeSize;continue e}r(d,n),c<s&&t.child(c).sameMarkup(d)?KA(t.child(c),d,n+1,r):d.nodesBetween(0,d.content.size,r,n+1),n+=d.nodeSize}}function YA(t,e){let n;const r=(s,a)=>{s.type.spec.tableRole=="table"&&(n=z9(t,s,a,n))};return e?e.doc!=t.doc&&KA(e.doc,t.doc,0,r):t.doc.descendants(r),n}function z9(t,e,n,r){const s=qt.get(e);if(!s.problems)return r;r||(r=t.tr);const a=[];for(let d=0;d<s.height;d++)a.push(0);for(let d=0;d<s.problems.length;d++){const p=s.problems[d];if(p.type=="collision"){const m=e.nodeAt(p.pos);if(!m)continue;const g=m.attrs;for(let b=0;b<g.rowspan;b++)a[p.row+b]+=p.n;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,Za(g,g.colspan-p.n,p.n))}else if(p.type=="missing")a[p.row]+=p.n;else if(p.type=="overlong_rowspan"){const m=e.nodeAt(p.pos);if(!m)continue;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,{...m.attrs,rowspan:m.attrs.rowspan-p.n})}else if(p.type=="colwidth mismatch"){const m=e.nodeAt(p.pos);if(!m)continue;r.setNodeMarkup(r.mapping.map(n+1+p.pos),null,{...m.attrs,colwidth:p.colwidth})}else if(p.type=="zero_sized"){const m=r.mapping.map(n);r.delete(m,m+e.nodeSize)}}let l,c;for(let d=0;d<a.length;d++)a[d]&&(l==null&&(l=d),c=d);for(let d=0,p=n+1;d<s.height;d++){const m=e.child(d),g=p+m.nodeSize,b=a[d];if(b>0){let v="cell";m.firstChild&&(v=m.firstChild.type.spec.tableRole);const w=[];for(let k=0;k<b;k++){const N=zn(t.schema)[v].createAndFill();N&&w.push(N)}const C=(d==0||l==d-1)&&c==d?p+1:g-1;r.insert(r.mapping.map(C),w)}p=g}return r.setMeta(I9,{fixTables:!0})}function ms(t){const e=t.selection,n=hp(t),r=n.node(-1),s=n.start(-1),a=qt.get(r);return{...e instanceof Tt?a.rectBetween(e.$anchorCell.pos-s,e.$headCell.pos-s):a.findCell(n.pos-s),tableStart:s,map:a,table:r}}function JA(t,{map:e,tableStart:n,table:r},s){let a=s>0?-1:0;j9(e,r,s+a)&&(a=s==0||s==e.width?null:0);for(let l=0;l<e.height;l++){const c=l*e.width+s;if(s>0&&s<e.width&&e.map[c-1]==e.map[c]){const d=e.map[c],p=r.nodeAt(d);t.setNodeMarkup(t.mapping.map(n+d),null,WA(p.attrs,s-e.colCount(d))),l+=p.attrs.rowspan-1}else{const d=a==null?zn(r.type.schema).cell:r.nodeAt(e.map[c+a]).type,p=e.positionAt(l,s,r);t.insert(t.mapping.map(n+p),d.createAndFill())}}return t}function B9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t);e(JA(t.tr,n,n.left))}return!0}function P9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t);e(JA(t.tr,n,n.right))}return!0}function H9(t,{map:e,table:n,tableStart:r},s){const a=t.mapping.maps.length;for(let l=0;l<e.height;){const c=l*e.width+s,d=e.map[c],p=n.nodeAt(d),m=p.attrs;if(s>0&&e.map[c-1]==d||s<e.width-1&&e.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(a).map(r+d),null,Za(m,s-e.colCount(d)));else{const g=t.mapping.slice(a).map(r+d);t.delete(g,g+p.nodeSize)}l+=m.rowspan}}function F9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let s=n.right-1;H9(r,n,s),s!=n.left;s--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=qt.get(a)}e(r)}return!0}function U9(t,e,n){var r;const s=zn(e.type.schema).header_cell;for(let a=0;a<t.width;a++)if(((r=e.nodeAt(t.map[a+n*t.width]))===null||r===void 0?void 0:r.type)!=s)return!1;return!0}function XA(t,{map:e,tableStart:n,table:r},s){let a=n;for(let p=0;p<s;p++)a+=r.child(p).nodeSize;const l=[];let c=s>0?-1:0;U9(e,r,s+c)&&(c=s==0||s==e.height?null:0);for(let p=0,m=e.width*s;p<e.width;p++,m++)if(s>0&&s<e.height&&e.map[m]==e.map[m-e.width]){const g=e.map[m],b=r.nodeAt(g).attrs;t.setNodeMarkup(n+g,null,{...b,rowspan:b.rowspan+1}),p+=b.colspan-1}else{var d;const g=c==null?zn(r.type.schema).cell:(d=r.nodeAt(e.map[m+c*e.width]))===null||d===void 0?void 0:d.type,b=g==null?void 0:g.createAndFill();b&&l.push(b)}return t.insert(a,zn(r.type.schema).row.create(null,l)),t}function $9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t);e(XA(t.tr,n,n.top))}return!0}function V9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t);e(XA(t.tr,n,n.bottom))}return!0}function q9(t,{map:e,table:n,tableStart:r},s){let a=0;for(let p=0;p<s;p++)a+=n.child(p).nodeSize;const l=a+n.child(s).nodeSize,c=t.mapping.maps.length;t.delete(a+r,l+r);const d=new Set;for(let p=0,m=s*e.width;p<e.width;p++,m++){const g=e.map[m];if(!d.has(g)){if(d.add(g),s>0&&g==e.map[m-e.width]){const b=n.nodeAt(g).attrs;t.setNodeMarkup(t.mapping.slice(c).map(g+r),null,{...b,rowspan:b.rowspan-1}),p+=b.colspan-1}else if(s<e.height&&g==e.map[m+e.width]){const b=n.nodeAt(g),v=b.attrs,w=b.type.create({...v,rowspan:b.attrs.rowspan-1},b.content),C=e.positionAt(s+1,p,n);t.insert(t.mapping.slice(c).map(r+C),w),p+=v.colspan-1}}}}function W9(t,e){if(!Gr(t))return!1;if(e){const n=ms(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let s=n.bottom-1;q9(r,n,s),s!=n.top;s--){const a=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!a)throw new RangeError("No table found");n.table=a,n.map=qt.get(n.table)}e(r)}return!0}function TC(t){const e=t.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function G9({width:t,height:e,map:n},r){let s=r.top*t+r.left,a=s,l=(r.bottom-1)*t+r.left,c=s+(r.right-r.left-1);for(let d=r.top;d<r.bottom;d++){if(r.left>0&&n[a]==n[a-1]||r.right<t&&n[c]==n[c+1])return!0;a+=t,c+=t}for(let d=r.left;d<r.right;d++){if(r.top>0&&n[s]==n[s-t]||r.bottom<e&&n[l]==n[l+t])return!0;s++,l++}return!1}function AC(t,e){const n=t.selection;if(!(n instanceof Tt)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=ms(t),{map:s}=r;if(G9(s,r))return!1;if(e){const a=t.tr,l={};let c=fe.empty,d,p;for(let m=r.top;m<r.bottom;m++)for(let g=r.left;g<r.right;g++){const b=s.map[m*s.width+g],v=r.table.nodeAt(b);if(!(l[b]||!v))if(l[b]=!0,d==null)d=b,p=v;else{TC(v)||(c=c.append(v.content));const w=a.mapping.map(b+r.tableStart);a.delete(w,w+v.nodeSize)}}if(d==null||p==null)return!0;if(a.setNodeMarkup(d+r.tableStart,null,{...WA(p.attrs,p.attrs.colspan,r.right-r.left-p.attrs.colspan),rowspan:r.bottom-r.top}),c.size>0){const m=d+1+p.content.size,g=TC(p)?d+1:m;a.replaceWith(g+r.tableStart,m+r.tableStart,c)}a.setSelection(new Tt(a.doc.resolve(d+r.tableStart))),e(a)}return!0}function MC(t,e){const n=zn(t.schema);return K9(({node:r})=>n[r.type.spec.tableRole])(t,e)}function K9(t){return(e,n)=>{const r=e.selection;let s,a;if(r instanceof Tt){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;s=r.$anchorCell.nodeAfter,a=r.$anchorCell.pos}else{var l;if(s=T9(r.$from),!s)return!1;a=(l=Qa(r.$from))===null||l===void 0?void 0:l.pos}if(s==null||a==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(n){let c=s.attrs;const d=[],p=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const m=ms(e),g=e.tr;for(let v=0;v<m.right-m.left;v++)d.push(p?{...c,colwidth:p&&p[v]?[p[v]]:null}:c);let b;for(let v=m.top;v<m.bottom;v++){let w=m.map.positionAt(v,m.left,m.table);v==m.top&&(w+=s.nodeSize);for(let C=m.left,k=0;C<m.right;C++,k++)C==m.left&&v==m.top||g.insert(b=g.mapping.map(w+m.tableStart,1),t({node:s,row:v,col:C}).createAndFill(d[k]))}g.setNodeMarkup(a,t({node:s,row:m.top,col:m.left}),d[0]),r instanceof Tt&&g.setSelection(new Tt(g.doc.resolve(r.$anchorCell.pos),b?g.doc.resolve(b):void 0)),n(g)}return!0}}function Y9(t,e){return function(n,r){if(!Gr(n))return!1;const s=hp(n);if(s.nodeAfter.attrs[t]===e)return!1;if(r){const a=n.tr;n.selection instanceof Tt?n.selection.forEachCell((l,c)=>{l.attrs[t]!==e&&a.setNodeMarkup(c,null,{...l.attrs,[t]:e})}):a.setNodeMarkup(s.pos,null,{...s.nodeAfter.attrs,[t]:e}),r(a)}return!0}}function J9(t){return function(e,n){if(!Gr(e))return!1;if(n){const r=zn(e.schema),s=ms(e),a=e.tr,l=s.map.cellsInRect(t=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:t=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),c=l.map(d=>s.table.nodeAt(d));for(let d=0;d<l.length;d++)c[d].type==r.header_cell&&a.setNodeMarkup(s.tableStart+l[d],r.cell,c[d].attrs);if(a.steps.length===0)for(let d=0;d<l.length;d++)a.setNodeMarkup(s.tableStart+l[d],r.header_cell,c[d].attrs);n(a)}return!0}}function jC(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let s=0;s<r.length;s++){const a=e.table.nodeAt(r[s]);if(a&&a.type!==n.header_cell)return!1}return!0}function uu(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?J9(t):function(n,r){if(!Gr(n))return!1;if(r){const s=zn(n.schema),a=ms(n),l=n.tr,c=jC("row",a,s),d=jC("column",a,s),p=(t==="column"?c:t==="row"&&d)?1:0,m=t=="column"?{left:0,top:p,right:1,bottom:a.map.height}:t=="row"?{left:p,top:0,right:a.map.width,bottom:1}:a,g=t=="column"?d?s.cell:s.header_cell:t=="row"?c?s.cell:s.header_cell:s.cell;a.map.cellsInRect(m).forEach(b=>{const v=b+a.tableStart,w=l.doc.nodeAt(v);w&&l.setNodeMarkup(v,g,w.attrs)}),r(l)}return!0}}uu("row",{useDeprecatedLogic:!0});uu("column",{useDeprecatedLogic:!0});const X9=uu("cell",{useDeprecatedLogic:!0});function Q9(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,s=t.before();r>=0;r--){const a=t.node(-1).child(r),l=a.lastChild;if(l)return s-1-l.nodeSize;s-=a.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),s=t.after();r<n.childCount;r++){const a=n.child(r);if(a.childCount)return s+1;s+=a.nodeSize}}return null}function OC(t){return function(e,n){if(!Gr(e))return!1;const r=Q9(hp(e),t);if(r==null)return!1;if(n){const s=e.doc.resolve(r);n(e.tr.setSelection(Be.between(s,M9(s))).scrollIntoView())}return!0}}function Z9(t,e){const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function sf(t,e){const n=t.selection;if(!(n instanceof Tt))return!1;if(e){const r=t.tr,s=zn(t.schema).cell.createAndFill().content;n.forEachCell((a,l)=>{a.content.eq(s)||r.replace(r.mapping.map(l+1),r.mapping.map(l+a.nodeSize-1),new Ee(s,0,0))}),r.docChanged&&e(r)}return!0}function eH(t){if(t.size===0)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.child(0).type.spec.tableRole=="table");)n--,r--,e=e.child(0).content;const s=e.child(0),a=s.type.spec.tableRole,l=s.type.schema,c=[];if(a=="row")for(let d=0;d<e.childCount;d++){let p=e.child(d).content;const m=d?0:Math.max(0,n-1),g=d<e.childCount-1?0:Math.max(0,r-1);(m||g)&&(p=Px(zn(l).row,new Ee(p,m,g)).content),c.push(p)}else if(a=="cell"||a=="header_cell")c.push(n||r?Px(zn(l).row,new Ee(e,n,r)).content:e);else return null;return tH(l,c)}function tH(t,e){const n=[];for(let s=0;s<e.length;s++){const a=e[s];for(let l=a.childCount-1;l>=0;l--){const{rowspan:c,colspan:d}=a.child(l).attrs;for(let p=s;p<s+c;p++)n[p]=(n[p]||0)+d}}let r=0;for(let s=0;s<n.length;s++)r=Math.max(r,n[s]);for(let s=0;s<n.length;s++)if(s>=e.length&&e.push(fe.empty),n[s]<r){const a=zn(t).cell.createAndFill(),l=[];for(let c=n[s];c<r;c++)l.push(a);e[s]=e[s].append(fe.from(l))}return{height:e.length,width:r,rows:e}}function Px(t,e){const n=t.createAndFill();return new yb(n).replace(0,n.content.size,e).doc}function nH({width:t,height:e,rows:n},r,s){if(t!=r){const a=[],l=[];for(let c=0;c<n.length;c++){const d=n[c],p=[];for(let m=a[c]||0,g=0;m<r;g++){let b=d.child(g%d.childCount);m+b.attrs.colspan>r&&(b=b.type.createChecked(Za(b.attrs,b.attrs.colspan,m+b.attrs.colspan-r),b.content)),p.push(b),m+=b.attrs.colspan;for(let v=1;v<b.attrs.rowspan;v++)a[c+v]=(a[c+v]||0)+b.attrs.colspan}l.push(fe.from(p))}n=l,t=r}if(e!=s){const a=[];for(let l=0,c=0;l<s;l++,c++){const d=[],p=n[c%e];for(let m=0;m<p.childCount;m++){let g=p.child(m);l+g.attrs.rowspan>s&&(g=g.type.create({...g.attrs,rowspan:Math.max(1,s-g.attrs.rowspan)},g.content)),d.push(g)}a.push(fe.from(d))}n=a,e=s}return{width:t,height:e,rows:n}}function rH(t,e,n,r,s,a,l){const c=t.doc.type.schema,d=zn(c);let p,m;if(s>e.width)for(let g=0,b=0;g<e.height;g++){const v=n.child(g);b+=v.nodeSize;const w=[];let C;v.lastChild==null||v.lastChild.type==d.cell?C=p||(p=d.cell.createAndFill()):C=m||(m=d.header_cell.createAndFill());for(let k=e.width;k<s;k++)w.push(C);t.insert(t.mapping.slice(l).map(b-1+r),w)}if(a>e.height){const g=[];for(let w=0,C=(e.height-1)*e.width;w<Math.max(e.width,s);w++){const k=w>=e.width?!1:n.nodeAt(e.map[C+w]).type==d.header_cell;g.push(k?m||(m=d.header_cell.createAndFill()):p||(p=d.cell.createAndFill()))}const b=d.row.create(null,fe.from(g)),v=[];for(let w=e.height;w<a;w++)v.push(b);t.insert(t.mapping.slice(l).map(r+n.nodeSize-2),v)}return!!(p||m)}function _C(t,e,n,r,s,a,l,c){if(l==0||l==e.height)return!1;let d=!1;for(let p=s;p<a;p++){const m=l*e.width+p,g=e.map[m];if(e.map[m-e.width]==g){d=!0;const b=n.nodeAt(g),{top:v,left:w}=e.findCell(g);t.setNodeMarkup(t.mapping.slice(c).map(g+r),null,{...b.attrs,rowspan:l-v}),t.insert(t.mapping.slice(c).map(e.positionAt(l,w,n)),b.type.createAndFill({...b.attrs,rowspan:v+b.attrs.rowspan-l})),p+=b.attrs.colspan-1}}return d}function RC(t,e,n,r,s,a,l,c){if(l==0||l==e.width)return!1;let d=!1;for(let p=s;p<a;p++){const m=p*e.width+l,g=e.map[m];if(e.map[m-1]==g){d=!0;const b=n.nodeAt(g),v=e.colCount(g),w=t.mapping.slice(c).map(g+r);t.setNodeMarkup(w,null,Za(b.attrs,l-v,b.attrs.colspan-(l-v))),t.insert(w+b.nodeSize,b.type.createAndFill(Za(b.attrs,0,l-v))),p+=b.attrs.rowspan-1}}return d}function DC(t,e,n,r,s){let a=n?t.doc.nodeAt(n-1):t.doc;if(!a)throw new Error("No table found");let l=qt.get(a);const{top:c,left:d}=r,p=d+s.width,m=c+s.height,g=t.tr;let b=0;function v(){if(a=n?g.doc.nodeAt(n-1):g.doc,!a)throw new Error("No table found");l=qt.get(a),b=g.mapping.maps.length}rH(g,l,a,n,p,m,b)&&v(),_C(g,l,a,n,d,p,c,b)&&v(),_C(g,l,a,n,d,p,m,b)&&v(),RC(g,l,a,n,c,m,d,b)&&v(),RC(g,l,a,n,c,m,p,b)&&v();for(let w=c;w<m;w++){const C=l.positionAt(w,d,a),k=l.positionAt(w,p,a);g.replace(g.mapping.slice(b).map(C+n),g.mapping.slice(b).map(k+n),new Ee(s.rows[w-c],0,0))}v(),g.setSelection(new Tt(g.doc.resolve(n+l.positionAt(c,d,a)),g.doc.resolve(n+l.positionAt(m-1,p-1,a)))),e(g)}const sH=Lb({ArrowLeft:af("horiz",-1),ArrowRight:af("horiz",1),ArrowUp:af("vert",-1),ArrowDown:af("vert",1),"Shift-ArrowLeft":of("horiz",-1),"Shift-ArrowRight":of("horiz",1),"Shift-ArrowUp":of("vert",-1),"Shift-ArrowDown":of("vert",1),Backspace:sf,"Mod-Backspace":sf,Delete:sf,"Mod-Delete":sf});function wf(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function af(t,e){return(n,r,s)=>{if(!s)return!1;const a=n.selection;if(a instanceof Tt)return wf(n,r,Ve.near(a.$headCell,e));if(t!="horiz"&&!a.empty)return!1;const l=QA(s,t,e);if(l==null)return!1;if(t=="horiz")return wf(n,r,Ve.near(n.doc.resolve(a.head+e),e));{const c=n.doc.resolve(l),d=qA(c,t,e);let p;return d?p=Ve.near(d,1):e<0?p=Ve.near(n.doc.resolve(c.before(-1)),-1):p=Ve.near(n.doc.resolve(c.after(-1)),1),wf(n,r,p)}}}function of(t,e){return(n,r,s)=>{if(!s)return!1;const a=n.selection;let l;if(a instanceof Tt)l=a;else{const d=QA(s,t,e);if(d==null)return!1;l=new Tt(n.doc.resolve(d))}const c=qA(l.$headCell,t,e);return c?wf(n,r,new Tt(l.$anchorCell,c)):!1}}function iH(t,e){const n=t.state.doc,r=Qa(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new Tt(r))),!0):!1}function aH(t,e,n){if(!Gr(t.state))return!1;let r=eH(n);const s=t.state.selection;if(s instanceof Tt){r||(r={width:1,height:1,rows:[fe.from(Px(zn(t.state.schema).cell,n))]});const a=s.$anchorCell.node(-1),l=s.$anchorCell.start(-1),c=qt.get(a).rectBetween(s.$anchorCell.pos-l,s.$headCell.pos-l);return r=nH(r,c.right-c.left,c.bottom-c.top),DC(t.state,t.dispatch,l,c,r),!0}else if(r){const a=hp(t.state),l=a.start(-1);return DC(t.state,t.dispatch,l,qt.get(a.node(-1)).findCell(a.pos-l),r),!0}else return!1}function oH(t,e){var n;if(e.button!=0||e.ctrlKey||e.metaKey)return;const r=LC(t,e.target);let s;if(e.shiftKey&&t.state.selection instanceof Tt)a(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(s=Qa(t.state.selection.$anchor))!=null&&((n=b0(t,e))===null||n===void 0?void 0:n.pos)!=s.pos)a(s,e),e.preventDefault();else if(!r)return;function a(d,p){let m=b0(t,p);const g=Bi.getState(t.state)==null;if(!m||!sy(d,m))if(g)m=d;else return;const b=new Tt(d,m);if(g||!t.state.selection.eq(b)){const v=t.state.tr.setSelection(b);g&&v.setMeta(Bi,d.pos),t.dispatch(v)}}function l(){t.root.removeEventListener("mouseup",l),t.root.removeEventListener("dragstart",l),t.root.removeEventListener("mousemove",c),Bi.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Bi,-1))}function c(d){const p=d,m=Bi.getState(t.state);let g;if(m!=null)g=t.state.doc.resolve(m);else if(LC(t,p.target)!=r&&(g=b0(t,e),!g))return l();g&&a(g,p)}t.root.addEventListener("mouseup",l),t.root.addEventListener("dragstart",l),t.root.addEventListener("mousemove",c)}function QA(t,e,n){if(!(t.state.selection instanceof Be))return null;const{$head:r}=t.state.selection;for(let s=r.depth-1;s>=0;s--){const a=r.node(s);if((n<0?r.index(s):r.indexAfter(s))!=(n<0?0:a.childCount))return null;if(a.type.spec.tableRole=="cell"||a.type.spec.tableRole=="header_cell"){const l=r.before(s),c=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(c)?l:null}}return null}function LC(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function b0(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});if(!n)return null;let{inside:r,pos:s}=n;return r>=0&&Qa(t.state.doc.resolve(r))||Qa(t.state.doc.resolve(s))}var lH=class{constructor(e,n){this.node=e,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Hx(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Hx(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Hx(t,e,n,r,s,a){let l=0,c=!0,d=e.firstChild;const p=t.firstChild;if(p){for(let g=0,b=0;g<p.childCount;g++){const{colspan:v,colwidth:w}=p.child(g).attrs;for(let C=0;C<v;C++,b++){const k=s==b?a:w&&w[C],N=k?k+"px":"";if(l+=k||r,k||(c=!1),d)d.style.width!=N&&(d.style.width=N),d=d.nextSibling;else{const M=document.createElement("col");M.style.width=N,e.appendChild(M)}}}for(;d;){var m;const g=d.nextSibling;(m=d.parentNode)===null||m===void 0||m.removeChild(d),d=g}c?(n.style.width=l+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=l+"px")}}const xr=new Wt("tableColumnResizing");function cH({handleWidth:t=5,cellMinWidth:e=25,defaultCellMinWidth:n=100,View:r=lH,lastColumnResizable:s=!0}={}){const a=new _t({key:xr,state:{init(l,c){var d;const p=(d=a.spec)===null||d===void 0||(d=d.props)===null||d===void 0?void 0:d.nodeViews,m=zn(c.schema).table.name;return r&&p&&(p[m]=(g,b)=>new r(g,n,b)),new uH(-1,!1)},apply(l,c){return c.apply(l)}},props:{attributes:l=>{const c=xr.getState(l);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(l,c)=>{dH(l,c,t,s)},mouseleave:l=>{fH(l)},mousedown:(l,c)=>{hH(l,c,e,n)}},decorations:l=>{const c=xr.getState(l);if(c&&c.activeHandle>-1)return bH(l,c.activeHandle)},nodeViews:{}}});return a}var uH=class kf{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){const n=this,r=e.getMeta(xr);if(r&&r.setHandle!=null)return new kf(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new kf(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let s=e.mapping.map(n.activeHandle,-1);return Bx(e.doc.resolve(s))||(s=-1),new kf(s,n.dragging)}return n}};function dH(t,e,n,r){if(!t.editable)return;const s=xr.getState(t.state);if(s&&!s.dragging){const a=mH(e.target);let l=-1;if(a){const{left:c,right:d}=a.getBoundingClientRect();e.clientX-c<=n?l=IC(t,e,"left",n):d-e.clientX<=n&&(l=IC(t,e,"right",n))}if(l!=s.activeHandle){if(!r&&l!==-1){const c=t.state.doc.resolve(l),d=c.node(-1),p=qt.get(d),m=c.start(-1);if(p.colCount(c.pos-m)+c.nodeAfter.attrs.colspan-1==p.width-1)return}ZA(t,l)}}}function fH(t){if(!t.editable)return;const e=xr.getState(t.state);e&&e.activeHandle>-1&&!e.dragging&&ZA(t,-1)}function hH(t,e,n,r){var s;if(!t.editable)return!1;const a=(s=t.dom.ownerDocument.defaultView)!==null&&s!==void 0?s:window,l=xr.getState(t.state);if(!l||l.activeHandle==-1||l.dragging)return!1;const c=t.state.doc.nodeAt(l.activeHandle),d=pH(t,l.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(xr,{setDragging:{startX:e.clientX,startWidth:d}}));function p(g){a.removeEventListener("mouseup",p),a.removeEventListener("mousemove",m);const b=xr.getState(t.state);b!=null&&b.dragging&&(gH(t,b.activeHandle,zC(b.dragging,g,n)),t.dispatch(t.state.tr.setMeta(xr,{setDragging:null})))}function m(g){if(!g.which)return p(g);const b=xr.getState(t.state);if(b&&b.dragging){const v=zC(b.dragging,g,n);BC(t,b.activeHandle,v,r)}}return BC(t,l.activeHandle,d,r),a.addEventListener("mouseup",p),a.addEventListener("mousemove",m),e.preventDefault(),!0}function pH(t,e,{colspan:n,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const a=t.domAtPos(e);let l=a.node.childNodes[a.offset].offsetWidth,c=n;if(r)for(let d=0;d<n;d++)r[d]&&(l-=r[d],c--);return l/c}function mH(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function IC(t,e,n,r){const s=n=="right"?-r:r,a=t.posAtCoords({left:e.clientX+s,top:e.clientY});if(!a)return-1;const{pos:l}=a,c=Qa(t.state.doc.resolve(l));if(!c)return-1;if(n=="right")return c.pos;const d=qt.get(c.node(-1)),p=c.start(-1),m=d.map.indexOf(c.pos-p);return m%d.width==0?-1:p+d.map[m-1]}function zC(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function ZA(t,e){t.dispatch(t.state.tr.setMeta(xr,{setHandle:e}))}function gH(t,e,n){const r=t.state.doc.resolve(e),s=r.node(-1),a=qt.get(s),l=r.start(-1),c=a.colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let p=0;p<a.height;p++){const m=p*a.width+c;if(p&&a.map[m]==a.map[m-a.width])continue;const g=a.map[m],b=s.nodeAt(g).attrs,v=b.colspan==1?0:c-a.colCount(g);if(b.colwidth&&b.colwidth[v]==n)continue;const w=b.colwidth?b.colwidth.slice():xH(b.colspan);w[v]=n,d.setNodeMarkup(l+g,null,{...b,colwidth:w})}d.docChanged&&t.dispatch(d)}function BC(t,e,n,r){const s=t.state.doc.resolve(e),a=s.node(-1),l=s.start(-1),c=qt.get(a).colCount(s.pos-l)+s.nodeAfter.attrs.colspan-1;let d=t.domAtPos(s.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&Hx(a,d.firstChild,d,r,c,n)}function xH(t){return Array(t).fill(0)}function bH(t,e){const n=[],r=t.doc.resolve(e),s=r.node(-1);if(!s)return Nt.empty;const a=qt.get(s),l=r.start(-1),c=a.colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1;for(let p=0;p<a.height;p++){const m=c+p*a.width;if((c==a.width-1||a.map[m]!=a.map[m+1])&&(p==0||a.map[m]!=a.map[m-a.width])){var d;const g=a.map[m],b=l+g+s.nodeAt(g).nodeSize-1,v=document.createElement("div");v.className="column-resize-handle",!((d=xr.getState(t))===null||d===void 0)&&d.dragging&&n.push(yn.node(l+g,l+g+s.nodeAt(g).nodeSize,{class:"column-resize-dragging"})),n.push(yn.widget(b,v))}}return Nt.create(t.doc,n)}function yH({allowTableNodeSelection:t=!1}={}){return new _t({key:Bi,state:{init(){return null},apply(e,n){const r=e.getMeta(Bi);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:s,pos:a}=e.mapping.mapResult(n);return s?null:a}},props:{decorations:_9,handleDOMEvents:{mousedown:oH},createSelectionBetween(e){return Bi.getState(e.state)!=null?e.state.selection:null},handleTripleClick:iH,handleKeyDown:sH,handlePaste:aH},appendTransaction(e,n,r){return L9(r,YA(r,n),t)}})}var e5=_n.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var e,n;const r=t.getAttribute("colwidth"),s=r?r.split(",").map(a=>parseInt(a,10)):null;if(!s){const a=(e=t.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),l=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(l&&l>-1&&a&&a[l]){const c=a[l].getAttribute("width");return c?[parseInt(c,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",Ot(this.options.HTMLAttributes,t),0]}}),t5=_n.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",Ot(this.options.HTMLAttributes,t),0]}}),n5=_n.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",Ot(this.options.HTMLAttributes,t),0]}});function Fx(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function PC(t,e,n,r,s,a){var l;let c=0,d=!0,p=e.firstChild;const m=t.firstChild;if(m!==null)for(let b=0,v=0;b<m.childCount;b+=1){const{colspan:w,colwidth:C}=m.child(b).attrs;for(let k=0;k<w;k+=1,v+=1){const N=s===v?a:C&&C[k],M=N?`${N}px`:"";if(c+=N||r,N||(d=!1),p){if(p.style.width!==M){const[_,P]=Fx(r,N);p.style.setProperty(_,P)}p=p.nextSibling}else{const _=document.createElement("col"),[P,I]=Fx(r,N);_.style.setProperty(P,I),e.appendChild(_)}}}for(;p;){const b=p.nextSibling;(l=p.parentNode)==null||l.removeChild(p),p=b}const g=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!g?(n.style.width=`${c}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${c}px`)}var vH=class{constructor(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),PC(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,PC(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(n&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function wH(t,e,n,r){let s=0,a=!0;const l=[],c=t.firstChild;if(!c)return{};for(let g=0,b=0;g<c.childCount;g+=1){const{colspan:v,colwidth:w}=c.child(g).attrs;for(let C=0;C<v;C+=1,b+=1){const k=n===b?r:w&&w[C];s+=k||e,k||(a=!1);const[N,M]=Fx(e,k);l.push(["col",{style:`${N}: ${M}`}])}}const d=a?`${s}px`:"",p=a?"":`${s}px`;return{colgroup:["colgroup",{},...l],tableWidth:d,tableMinWidth:p}}function HC(t,e){return t.createAndFill()}function kH(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function CH(t,e,n,r,s){const a=kH(t),l=[],c=[];for(let p=0;p<n;p+=1){const m=HC(a.cell);if(m&&c.push(m),r){const g=HC(a.header_cell);g&&l.push(g)}}const d=[];for(let p=0;p<e;p+=1)d.push(a.row.createChecked(null,r&&p===0?l:c));return a.table.createChecked(null,d)}function SH(t){return t instanceof Tt}var lf=({editor:t})=>{const{selection:e}=t.state;if(!SH(e))return!1;let n=0;const r=zT(e.ranges[0].$from,a=>a.type.name==="table");return r==null||r.node.descendants(a=>{if(a.type.name==="table")return!1;["tableCell","tableHeader"].includes(a.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},EH="";function NH(t){return(t||"").replace(/\s+/g," ").trim()}function TH(t,e,n={}){var r;const s=(r=n.cellLineSeparator)!=null?r:EH;if(!t||!t.content||t.content.length===0)return"";const a=[];t.content.forEach(w=>{const C=[];w.content&&w.content.forEach(k=>{let N="";k.content&&Array.isArray(k.content)&&k.content.length>1?N=k.content.map(I=>e.renderChildren(I)).join(s):N=k.content?e.renderChildren(k.content):"";const M=NH(N),_=k.type==="tableHeader";C.push({text:M,isHeader:_})}),a.push(C)});const l=a.reduce((w,C)=>Math.max(w,C.length),0);if(l===0)return"";const c=new Array(l).fill(0);a.forEach(w=>{var C;for(let k=0;k<l;k+=1){const M=(((C=w[k])==null?void 0:C.text)||"").length;M>c[k]&&(c[k]=M),c[k]<3&&(c[k]=3)}});const d=(w,C)=>w+" ".repeat(Math.max(0,C-w.length)),p=a[0],m=p.some(w=>w.isHeader);let g=`
`;const b=new Array(l).fill(0).map((w,C)=>m&&p[C]&&p[C].text||"");return g+=`| ${b.map((w,C)=>d(w,c[C])).join(" | ")} |
`,g+=`| ${c.map(w=>"-".repeat(Math.max(3,w))).join(" | ")} |
`,(m?a.slice(1):a).forEach(w=>{g+=`| ${new Array(l).fill(0).map((C,k)=>d(w[k]&&w[k].text||"",c[k])).join(" | ")} |
`}),g}var AH=TH,r5=_n.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:vH,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=wH(t,this.options.cellMinWidth),a=e.style;function l(){return a||(r?`width: ${r}`:`min-width: ${s}`)}const c=["table",Ot(this.options.HTMLAttributes,e,{style:l()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(s=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(s.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const s=[];r.forEach(a=>{s.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(a.tokens)}]))}),n.push(e.createNode("tableRow",{},s))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>AH(t,e),addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:a})=>{const l=CH(a.schema,t,e,n);if(s){const c=r.selection.from+1;r.replaceSelectionWith(l).scrollIntoView().setSelection(Be.near(r.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>B9(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>P9(t,e),deleteColumn:()=>({state:t,dispatch:e})=>F9(t,e),addRowBefore:()=>({state:t,dispatch:e})=>$9(t,e),addRowAfter:()=>({state:t,dispatch:e})=>V9(t,e),deleteRow:()=>({state:t,dispatch:e})=>W9(t,e),deleteTable:()=>({state:t,dispatch:e})=>Z9(t,e),mergeCells:()=>({state:t,dispatch:e})=>AC(t,e),splitCell:()=>({state:t,dispatch:e})=>MC(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>uu("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>uu("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>X9(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>AC(t,e)?!0:MC(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>Y9(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>OC(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>OC(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&YA(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=Tt.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:lf,"Mod-Backspace":lf,Delete:lf,"Mod-Delete":lf}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[cH({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],yH({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:ht(Le(t,"tableRole",e))}}});vt.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(r5.configure(this.options.table)),this.options.tableCell!==!1&&t.push(e5.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(t5.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(n5.configure(this.options.tableRow)),t}});var MH=n5,jH=t5,OH=e5;const _H=/<\/?[a-z][\s\S]*>/i,RH=t=>_H.test(t),FC=t=>t.trim()?RH(t)?t:mb(t):"<p></p>",DH=[f9.configure({heading:{levels:[1,2]}}),H7,$A,k9,r5.configure({resizable:!0}),MH,jH,OH,h9,p9.configure({nested:!0})],rr=({active:t=!1,onClick:e,title:n,children:r})=>h.jsx("button",{type:"button",onMouseDown:s=>s.preventDefault(),onClick:e,className:`p-1 md:p-1.5 rounded transition-colors ${t?"bg-[#CC561E]/15 text-[#CC561E]":"text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-800"}`,title:n,children:r}),s5=({value:t,onChange:e,autoFocus:n=!1,placeholder:r="Start writing... Use toolbar for lists, checklist, headings, and emphasis.",minHeight:s=220})=>{const[a,l]=E.useState("write"),[c,d]=E.useState("#0f172a"),p=E.useRef(!1),m={"--note-editor-min-height":`${s}px`},g=TP({extensions:E.useMemo(()=>[...DH,m9.configure({placeholder:r})],[r]),content:FC(t),autofocus:n?"end":!1,editorProps:{attributes:{class:"personal-note-prosemirror"}},onUpdate:({editor:v})=>{p.current||e(v.getHTML())}});E.useEffect(()=>{if(!g)return;const v=FC(t);g.getHTML()!==v&&(p.current=!0,g.commands.setContent(v,{emitUpdate:!1}),p.current=!1)},[g,t]);const b=E.useMemo(()=>mb(t),[t]);return h.jsxs("div",{className:"rounded-xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-950 overflow-hidden",children:[h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:flex-wrap px-2 md:px-3 py-1.5 md:py-2 border-b border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900 gap-2 md:gap-3",children:[h.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap",children:[h.jsx(rr,{active:!!(g!=null&&g.isActive("heading",{level:1})),onClick:()=>g==null?void 0:g.chain().focus().toggleHeading({level:1}).run(),title:"Heading 1",children:h.jsx(m3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("heading",{level:2})),onClick:()=>g==null?void 0:g.chain().focus().toggleHeading({level:2}).run(),title:"Heading 2",children:h.jsx(x3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("bold")),onClick:()=>g==null?void 0:g.chain().focus().toggleBold().run(),title:"Bold",children:h.jsx(k4,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("italic")),onClick:()=>g==null?void 0:g.chain().focus().toggleItalic().run(),title:"Italic",children:h.jsx(k3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("underline")),onClick:()=>g==null?void 0:g.chain().focus().toggleUnderline().run(),title:"Underline",children:h.jsx(DR,{size:12,className:"md:w-3.5 md:h-3.5"})})]}),h.jsx("div",{className:"flex items-center justify-end md:justify-start gap-1",children:h.jsxs("div",{className:"flex items-center bg-white dark:bg-slate-800 rounded-md border border-[#E6EAF2] dark:border-slate-700",children:[h.jsxs("button",{type:"button",onClick:()=>l("write"),className:`p-1 md:px-2 md:py-1 text-xs rounded-l-md transition-colors ${a==="write"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Write",children:[h.jsx("span",{className:"md:hidden",children:h.jsx(j2,{size:12})}),h.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[h.jsx(j2,{size:12})," Write"]})]}),h.jsxs("button",{type:"button",onClick:()=>l("preview"),className:`p-1 md:px-2 md:py-1 text-xs rounded-r-md transition-colors ${a==="preview"?"bg-[#CC561E] text-white":"text-slate-500"}`,title:"Preview",children:[h.jsx("span",{className:"md:hidden",children:h.jsx(S2,{size:12})}),h.jsxs("span",{className:"hidden md:inline-flex items-center gap-1",children:[h.jsx(S2,{size:12})," Preview"]})]})]})}),h.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 flex-wrap md:flex-nowrap",children:[h.jsxs("div",{className:"inline-flex items-center gap-0.5 px-1 py-0.5 rounded border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-900",children:[h.jsx(V3,{size:11,className:"text-slate-500 md:w-3 md:h-3"}),h.jsx("input",{type:"color",value:c,onChange:v=>{const w=v.target.value;d(w),g==null||g.chain().focus().setColor(w).run()},className:"w-4 h-4 md:w-5 md:h-5 p-0 border-0 bg-transparent cursor-pointer",title:"Text Color"}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().unsetColor().run(),title:"Clear Text Color",children:h.jsx(X4,{size:10,className:"md:w-3 md:h-3"})})]}),h.jsx(rr,{active:!!(g!=null&&g.isActive("bulletList")),onClick:()=>g==null?void 0:g.chain().focus().toggleBulletList().run(),title:"Bullet List",children:h.jsx(_3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("orderedList")),onClick:()=>g==null?void 0:g.chain().focus().toggleOrderedList().run(),title:"Numbered List",children:h.jsx(j3,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("taskList")),onClick:()=>g==null?void 0:g.chain().focus().toggleTaskList().run(),title:"Checklist",children:h.jsx(gR,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("blockquote")),onClick:()=>g==null?void 0:g.chain().focus().toggleBlockquote().run(),title:"Quote",children:h.jsx(Jc,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!!(g!=null&&g.isActive("table")),onClick:()=>g==null?void 0:g.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),title:"Insert Table",children:h.jsx(SR,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().addRowAfter().run(),title:"Add Row",children:h.jsx(tR,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().addColumnAfter().run(),title:"Add Column",children:h.jsx(V4,{size:12,className:"md:w-3.5 md:h-3.5"})}),h.jsx(rr,{active:!1,onClick:()=>g==null?void 0:g.chain().focus().deleteTable().run(),title:"Delete Table",children:h.jsx(Ha,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]}),a==="write"?h.jsx("div",{className:"bg-white dark:bg-slate-950 text-slate-900 dark:text-white",style:m,children:h.jsx(uA,{editor:g})}):h.jsx("div",{className:"personal-note-render p-3 md:p-4 max-w-none text-slate-800 dark:text-slate-200",style:{minHeight:s},dangerouslySetInnerHTML:{__html:b}})]})},LH=We.lazy(()=>tl(()=>import("./KnowledgeDashboard-NpKniUP2.js"),[]).then(t=>({default:t.KnowledgeDashboard}))),UC=t=>t.trim().toLowerCase(),Ma=10,Vo=t=>t.toLocaleLowerCase("tr-TR").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"i").replace(/\s+/g," ").trim(),sr=(t,e)=>e?Vo(t).includes(e):!0,$C=({id:t,children:e})=>{const{attributes:n,listeners:r,setNodeRef:s,transform:a,isDragging:l}=tD({id:t}),c={transform:il.Transform.toString(a)};return h.jsx(h.Fragment,{children:e({setNodeRef:s,style:c,isDragging:l,attributes:n,listeners:r})})},y0=({id:t,children:e})=>{const{setNodeRef:n,isOver:r}=iD({id:t});return h.jsx("div",{ref:n,children:e(r)})},IH=We.memo(({books:t,personalNoteFolders:e=[],onAddBook:n,onAddPersonalNote:r,onQuickCreatePersonalNote:s,onCreatePersonalFolder:a,onRenamePersonalFolder:l,onDeletePersonalFolder:c,onMovePersonalNote:d,onMovePersonalFolder:p,onSelectBook:m,onSelectBookWithTab:g,activeTab:b,onMobileMenuClick:v,onDeleteBook:w,onDeleteMultiple:C,onToggleFavorite:k,onToggleHighlightFavorite:N,userId:M,categoryFilter:_,onCategoryFilterChange:P,onCategoryNavigate:I,onStatusNavigate:q,currentPage:j,onPageChange:F,searchQuery:G,onSearchChange:te,statusFilter:he,onStatusFilterChange:Ne,sortOption:Se,onSortOptionChange:Te,publisherFilter:pe,onPublisherFilterChange:U,onTabChange:Z})=>{const[K,z]=E.useState(!1),H={"To Read":"bg-[#94A3B8]/15 text-[#94A3B8] border border-[#94A3B8]/40",Reading:"bg-[#38BDF8]/15 text-[#38BDF8] border border-[#38BDF8]/40",Finished:"bg-[#22C55E]/15 text-[#22C55E] border border-[#22C55E]/40"},A=b==="DASHBOARD",R=b==="NOTES",W=b==="PERSONAL_NOTE",[oe,be]=E.useState("ALL"),[L,ae]=E.useState("ALL"),[$,ne]=E.useState("NONE"),[ie,Oe]=E.useState(null),[$e,lt]=E.useState(!1),[Ue,rt]=E.useState({PRIVATE:!0,DAILY:!0,IDEAS:!0}),[pt,Me]=E.useState({PRIVATE:Ma,DAILY:Ma,IDEAS:Ma}),[st,De]=E.useState(!1),[_e,an]=E.useState(!1),[on,Gn]=E.useState("DAILY"),[Dt,gs]=E.useState(""),[Yr,Kn]=E.useState(""),[hn,Yn]=E.useState(null),[Jr,Jt]=E.useState(null),[Pn,pn]=E.useState(null),[Ht,kn]=E.useState(null);E.useEffect(()=>{W||(be("ALL"),ae("ALL"),ne("NONE"),Oe(null),lt(!1),rt({PRIVATE:!0,DAILY:!0,IDEAS:!0}),Me({PRIVATE:Ma,DAILY:Ma,IDEAS:Ma}),Gn("DAILY"),De(!1))},[W]),E.useEffect(()=>{ie&&lt(!0)},[ie]);const Gt=ZR(_2(hb,{activationConstraint:{distance:8}}),_2(zE,{activationConstraint:{delay:120,tolerance:8}})),oa=Y=>{const O=Date.now();window.innerWidth<768&&(Ht==null?void 0:Ht.noteId)===Y.id&&O-Ht.time<300?(kn(null),g?g(Y,"info"):m(Y)):(kn({noteId:Y.id,time:O}),m(Y))},ln=E.useMemo(()=>{const Y=new Map;return e.forEach(O=>Y.set(O.id,O)),Y},[e]);E.useEffect(()=>{if(L==="ALL"||L==="__ROOT__")return;const Y=ln.get(L);Y&&(on!==Y.category&&Gn(Y.category),rt(O=>({...O,[Y.category]:!1})))},[L,ln,on]);const Xr=E.useMemo(()=>{const Y=new Map;return e.forEach(O=>{Y.set(`${O.category}::${O.name.toLowerCase()}`,O.id)}),Y},[e]),Jn=Y=>{if(!Pt(Y))return;if(Y.personalFolderId)return Y.personalFolderId;const O=(Y.folderPath||"").trim();if(O)return Xr.get(`${Dn(Y)}::${O.toLowerCase()}`)},yr=Y=>{var we;const O=Jn(Y);return O?(we=ln.get(O))==null?void 0:we.name:Y.folderPath||void 0},Q=E.useMemo(()=>{switch(b){case"BOOK":return 24;case"ARTICLE":return 24;case"WEBSITE":return 24;case"PERSONAL_NOTE":return 30;case"NOTES":return 50;default:return 24}},[b]),[re,ue]=E.useState(G);E.useEffect(()=>{if(re!==G){z(!0);const Y=setTimeout(()=>{te(re),F(1),z(!1)},300);return()=>clearTimeout(Y)}},[re,G,te,F]),E.useEffect(()=>{ue(G)},[G]);const me=E.useMemo(()=>{if(R||A)return[];const Y=Vo(G),O=W&&$==="RECENT"?new Set(t.filter(ge=>ge.type==="PERSONAL_NOTE"&&Dn(ge)!=="PRIVATE").sort((ge,Ze)=>Ze.addedAt-ge.addedAt).slice(0,20).map(ge=>ge.id)):null;return t.filter(ge=>{if(ge.type!==b)return!1;if(W){const lr=Dn(ge);if(oe==="ALL"&&lr==="PRIVATE"||oe!=="ALL"&&lr!==oe)return!1;if(L!=="ALL"){const Zr=Jn(ge);if(L==="__ROOT__"){if(Zr)return!1}else if(Zr!==L)return!1}if($==="FAVORITES"&&!ge.isFavorite||$==="RECENT"&&!(O!=null&&O.has(ge.id))||ie&&!new Set((ge.tags||[]).map(ca=>UC(ca))).has(ie))return!1}if(_){const lr=Vo(_);if(!(ge.tags||[]).some(ca=>Vo(ca)===lr))return!1}let Ze=!0;return he!=="ALL"&&(he==="HIGHLIGHTS"?Ze=ge.highlights&&ge.highlights.length>0:he==="FAVORITES"?Ze=ge.isFavorite===!0:["To Read","Reading","Finished"].includes(he)?Ze=ge.readingStatus===he:b==="BOOK"?Ze=ge.status===he:Ze=!1),!Ze||pe&&b!=="BOOK"&&!sr(ge.publisher||"",Vo(pe))?!1:!Y||sr(ge.title||"",Y)||sr(ge.author||"",Y)?!0:b==="BOOK"?!!(sr(ge.isbn||"",Y)||sr(ge.code||"",Y)):!!((ge.tags||[]).some(lr=>sr(lr,Y))||sr(al(ge.generalNotes||""),Y)||Pt(ge)&&(sr(Dn(ge),Y)||sr(yr(ge)||"",Y)))}).sort((ge,Ze)=>Se==="title_asc"?ge.title.localeCompare(Ze.title):Se==="date_asc"?ge.addedAt-Ze.addedAt:Ze.addedAt-ge.addedAt)},[t,G,he,pe,Se,b,R,A,_,W,oe,L,$,ie,ln,Xr]),ke=E.useMemo(()=>t.filter(Y=>Y.type==="PERSONAL_NOTE"),[t]),Ce=E.useMemo(()=>ke.filter(Y=>Dn(Y)!=="PRIVATE"),[ke]),ye=Ce.length,He=E.useMemo(()=>Ce.filter(Y=>Y.isFavorite).length,[Ce]),Qe=E.useMemo(()=>[...Ce].sort((Y,O)=>O.addedAt-Y.addedAt).slice(0,20).map(Y=>Y.id),[Ce]).length,Pe=E.useMemo(()=>{const Y=new Map;return Ce.forEach(O=>{const we=new Set;(O.tags||[]).forEach(ge=>{const Ze=ge.trim();if(!Ze)return;const wt=UC(Ze);if(we.has(wt))return;we.add(wt);const zt=Y.get(wt);if(!zt){Y.set(wt,{label:Ze,noteIds:new Set([O.id])});return}zt.noteIds.add(O.id)})}),[...Y.entries()].map(([O,we])=>({key:O,label:we.label||O,count:we.noteIds.size})).sort((O,we)=>we.count-O.count||O.label.localeCompare(we.label)).slice(0,10)},[Ce]),Ye=E.useMemo(()=>{const Y={PRIVATE:0,DAILY:0,IDEAS:0};return ke.forEach(O=>{Y[Dn(O)]+=1}),Y},[ke]),ft=E.useMemo(()=>{const Y={PRIVATE:[],DAILY:[],IDEAS:[]};return e.forEach(O=>{Y[O.category].push({id:O.id,name:O.name,order:O.order,count:ke.filter(we=>Jn(we)===O.id).length})}),["PRIVATE","DAILY","IDEAS"].forEach(O=>{Y[O].sort((we,ge)=>we.order-ge.order||we.name.localeCompare(ge.name))}),Y},[ke,e,Xr]),It=E.useMemo(()=>{const Y={PRIVATE:0,DAILY:0,IDEAS:0};return ke.forEach(O=>{const we=Dn(O);Jn(O)||(Y[we]+=1)}),Y},[ke,Xr]);E.useEffect(()=>{if(L==="ALL"||L==="__ROOT__")return;const Y=["PRIVATE","DAILY","IDEAS"].find(we=>ft[we].some(ge=>ge.id===L));if(!Y)return;const O=ft[Y].findIndex(we=>we.id===L);O<0||Me(we=>{const ge=O+1;return we[Y]>=ge?we:{...we,[Y]:ge}})},[L,ft]);const Cn=E.useMemo(()=>{if(!R)return[];const Y=Vo(G);return t.flatMap(O=>O.highlights.map(we=>({...we,source:O}))).filter(O=>he==="FAVORITES"&&!O.isFavorite?!1:Y?sr(O.text||"",Y)||sr(O.comment||"",Y)||sr(O.source.title||"",Y)||sr(O.source.author||"",Y)||!!(O.tags&&O.tags.some(we=>sr(we,Y))):!0).sort((O,we)=>we.createdAt-O.createdAt)},[t,R,G,he]),or=E.useMemo(()=>R?{total:Cn.length,reading:0,toRead:0}:{total:me.length,reading:me.filter(Y=>Y.readingStatus==="Reading").length,toRead:me.filter(Y=>Y.readingStatus==="To Read").length},[R,Cn.length,me]),Hn=Y=>{switch(Y){case"BOOK":return"Books";case"ARTICLE":return"Articles";case"WEBSITE":return"Websites";case"PERSONAL_NOTE":return"Personal Notes";case"NOTES":return"All Notes";case"DASHBOARD":return"Dashboard"}},cn=()=>R?"Search quotes...":b==="PERSONAL_NOTE"?"Search notes...":b==="ARTICLE"?"Search title, author...":b==="WEBSITE"?"Search site, URL...":"Search title, author, ISBN...",mn=Y=>{switch(Y){case"PRIVATE":return"Private";case"DAILY":return"Daily";case"IDEAS":return"Ideas";default:return Y}},ti=async Y=>{const O=window.prompt(`${mn(Y)} klasor adi:`),we=O==null?void 0:O.trim();if(!we)return;const ge=await(a==null?void 0:a(Y,we));ge&&(ne("NONE"),Oe(null),be(Y),ae(ge.id),F(1))},Sl=async(Y,O)=>{const we=window.prompt("Yeni klasor adi:",O),ge=we==null?void 0:we.trim();!ge||ge===O||await(l==null?void 0:l(Y,ge))},vp=async Y=>{!window.confirm("Bu klasor silinsin mi? Icindeki notlar kategori kokune tasinacak.")||!await(c==null?void 0:c(Y))||L===Y&&(ne("NONE"),Oe(null),ae("__ROOT__"))},wp=(Y,O,we)=>{Pn&&window.clearTimeout(Pn.timeoutId);const ge=window.setTimeout(()=>{pn(null)},5e3);pn({noteId:Y,category:O,folderId:we,timeoutId:ge})},El=async(Y,O,we,ge=!0)=>{const Ze=ke.find(Bt=>Bt.id===Y);if(!Ze)return;const wt=Dn(Ze),zt=Jn(Ze);await(d==null?void 0:d(Y,O,we))&&ge&&wp(Y,wt,zt)},ni=Y=>{var O;if(Y.startsWith("cat-root:"))return Y.replace("cat-root:","");if(Y.startsWith("cat-group:"))return Y.replace("cat-group:","");if(Y.startsWith("folder:")){const we=Y.replace("folder:","");return(O=ln.get(we))==null?void 0:O.category}},Nl=async(Y,O)=>{const we=ln.get(Y);if(!we||we.category===O)return;await(p==null?void 0:p(Y,O))&&L===Y&&(be(O),F(1))},ri=Y=>{const O=String(Y.active.id);if(O.startsWith("note:")){Yn(O.replace("note:","")),Jt(null);return}O.startsWith("folder-item:")&&(Jt(O.replace("folder-item:","")),Yn(null))},si=()=>{Yn(null),Jt(null)},la=async Y=>{var ge;Yn(null),Jt(null);const O=String(Y.active.id||""),we=String(((ge=Y.over)==null?void 0:ge.id)||"");if(we){if(O.startsWith("note:")){const Ze=O.replace("note:",""),wt=ni(we);if(!wt)return;const zt=we.startsWith("folder:")?we.replace("folder:",""):void 0;await El(Ze,wt,zt,!0);return}if(O.startsWith("folder-item:")){const Ze=O.replace("folder-item:",""),wt=ni(we);if(!wt)return;await Nl(Ze,wt)}}},ii=()=>{var wt,zt;const Y=Yr;if(!Hf(Y))return;const O=L==="ALL"||L==="__ROOT__"?void 0:L,ge=(O?(wt=ln.get(O))==null?void 0:wt.category:void 0)||on,Ze=O?(zt=ln.get(O))==null?void 0:zt.name:void 0;s==null||s({title:Dt.trim()||"Quick Note",content:Y,category:ge,folderId:O,folderPath:Ze}),gs(""),Kn("")},Xt=R?Cn.length:me.length,Fn=Math.ceil(Xt/Q),Du=b==="ARTICLE"||b==="WEBSITE"?"dark:bg-slate-800":"dark:bg-slate-900",vr=E.useMemo(()=>{const Y=(j-1)*Q;return me.slice(Y,Y+Q)},[me,j,Q]),xs=E.useMemo(()=>{const Y=(j-1)*Q;return Cn.slice(Y,Y+Q)},[Cn,j,Q]),Tl=E.useMemo(()=>hn&&ke.find(Y=>Y.id===hn)||null,[ke,hn]),Al=E.useMemo(()=>Jr&&ln.get(Jr)||null,[ln,Jr]),Ml=()=>{if(Fn<=1)return null;const Y=()=>{const O=[];if(Fn<=5)for(let ge=1;ge<=Fn;ge++)O.push(ge);else j<=3?O.push(1,2,3,4,"...",Fn):j>=Fn-2?O.push(1,"...",Fn-3,Fn-2,Fn-1,Fn):O.push(1,"...",j-1,j,j+1,"...",Fn);return O};return h.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4 md:mt-12 select-none",children:[h.jsx("button",{onClick:()=>F(Math.max(j-1,1)),disabled:j===1,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h.jsx(Wi,{size:20})}),h.jsx("div",{className:"flex items-center gap-1",children:Y().map((O,we)=>h.jsx(We.Fragment,{children:O==="..."?h.jsx("span",{className:"px-2 text-slate-400",children:"..."}):h.jsx("button",{onClick:()=>F(O),className:`w-8 h-8 md:w-10 md:h-10 rounded-lg text-sm font-medium transition-colors ${j===O?"bg-[#262D40]/40 text-white shadow-md shadow-[#262D40]/12 dark:shadow-none":"text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82"}`,children:O})},we))}),h.jsx("button",{onClick:()=>F(Math.min(j+1,Fn)),disabled:j===Fn,className:"p-2 rounded-lg border border-[#E6EAF2] dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 hover:text-[#262D40] dark:hover:text-[#262D40]/82 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h.jsx(mE,{size:20})})]})},kp=()=>{var Y;return A?h.jsx(We.Suspense,{fallback:h.jsx("div",{className:"flex justify-center items-center py-20",children:h.jsx(nn,{size:32,className:"animate-spin text-[#262D40]/90"})}),children:h.jsx(LH,{items:t,userId:M,onCategorySelect:O=>I==null?void 0:I(O),onStatusSelect:O=>q==null?void 0:q(O),onNavigateToTab:O=>Z==null?void 0:Z(O),onMobileMenuClick:v})}):K?h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400 animate-in fade-in duration-200",children:[h.jsx(nn,{size:32,className:"animate-spin text-[#262D40]/90 mb-4"}),h.jsx("p",{children:"Searching library..."})]}):R?xs.length===0?h.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:h.jsx(sl,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),h.jsx("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:"No highlights found"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:G?"Try a different search term.":"Highlights added to books appear here."})]}):h.jsxs("div",{className:"pb-10 md:pb-20",children:[h.jsx("div",{className:"columns-2 lg:columns-3 gap-2 md:gap-6 space-y-2 md:space-y-6",children:xs.map((O,we)=>{var Ze,wt;const ge=GE(O.type);return h.jsxs("div",{onClick:()=>{g?g(O.source,"highlights",O.id):m(O.source)},className:"break-inside-avoid p-2.5 md:p-6 rounded-xl border hover:shadow-md transition-all group cursor-pointer relative flex flex-col bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/12 dark:hover:border-[#262D40]/30",children:[h.jsx("button",{onClick:zt=>{zt.stopPropagation(),N&&N(O.source.id,O.id)},className:`absolute top-2 right-2 p-1.5 rounded-full transition-all shadow-sm z-10 ${O.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:O.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Bo,{size:14,fill:O.isFavorite?"currentColor":"none"})}),h.jsx("div",{className:"mb-2 md:mb-3",children:ge?h.jsx(sl,{className:"text-[#CC561E] fill-[#CC561E]/10 w-4 h-4 md:w-6 md:h-6"}):((Ze=O.source)==null?void 0:Ze.type)==="ARTICLE"?h.jsx(pf,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):((wt=O.source)==null?void 0:wt.type)==="WEBSITE"?h.jsx(mf,{size:18,className:"text-[#262D40]/85 md:w-6 md:h-6"}):h.jsx(Jc,{className:"text-[#262D40]/82 fill-[#262D40]/85 w-4 h-4 md:w-6 md:h-6"})}),h.jsx("p",{className:`text-xs md:text-base leading-relaxed mb-2 md:mb-4 whitespace-pre-wrap line-clamp-[8] md:line-clamp-none font-lora ${ge?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-slate-200"}`,children:O.text}),O.tags&&O.tags.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 mb-2 md:mb-3",children:O.tags.map((zt,Qr)=>h.jsxs("span",{className:"px-1.5 md:px-2 py-0.5 md:py-1 bg-[#F3F5FA] dark:bg-slate-700/50 border border-[#E6EAF2] dark:border-white/10 rounded text-[10px] md:text-xs text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[h.jsx(Af,{size:10,className:"md:w-3 md:h-3"})," ",zt]},Qr))}),h.jsx("div",{className:`pt-2 md:pt-4 mt-auto flex items-center justify-between border-t ${ge?"border-[#E6EAF2]":"border-[#262D40]/50"}`,children:h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"text-xs md:text-sm font-bold text-slate-900 dark:text-white truncate",children:O.source.title}),h.jsx("div",{className:"flex items-center gap-1 md:gap-2 text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:h.jsx("span",{className:"truncate max-w-[50%]",children:O.source.author})})]})})]},`${O.id}-${we}`)})}),Ml()]}):vr.length===0&&!W?h.jsxs("div",{className:"text-center py-12 md:py-20 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 w-12 h-12 md:w-16 md:h-16 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:b==="BOOK"?h.jsx(sb,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):b==="ARTICLE"?h.jsx(xu,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):b==="PERSONAL_NOTE"?h.jsx(Mf,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"}):h.jsx(Vh,{size:24,className:"text-slate-300 dark:text-slate-600 md:w-8 md:h-8"})}),h.jsxs("h3",{className:"text-base md:text-lg font-medium text-slate-900 dark:text-white",children:["No ",Hn(b).toLowerCase()," found"]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm max-w-xs mx-auto mt-2",children:G?"Try a different search term.":"Adjust filters or add a new item."})]}):h.jsxs("div",{className:"pb-10 md:pb-20",children:[W?h.jsxs(Q6,{sensors:Gt,collisionDetection:i6,modifiers:[q2],onDragStart:ri,onDragCancel:si,onDragEnd:la,children:[h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_minmax(0,1fr)] gap-4 md:gap-6",children:[h.jsxs("aside",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl p-3 md:p-4 h-fit ${st?"block":"hidden lg:block"}`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("h3",{className:"text-xs font-bold uppercase tracking-[0.16em] text-slate-500 flex items-center gap-2",children:[h.jsx(M2,{size:14}),"Note Space"]}),h.jsx("button",{onClick:()=>De(!1),className:"lg:hidden text-slate-400 hover:text-slate-700",children:h.jsx(ds,{size:16})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{onClick:()=>{ne("NONE"),Oe(null),be("ALL"),ae("ALL"),F(1)},className:`w-full text-left px-2.5 py-2 rounded-lg text-sm transition-colors ${oe==="ALL"&&L==="ALL"&&$==="NONE"&&!ie?"bg-[#262D40]/20 text-[#262D40] dark:text-white font-semibold":"hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300"}`,children:["All Notes (",ye,")"]}),h.jsxs("div",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-800 p-2",children:[h.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 mb-1",children:"Smart Folders"}),h.jsxs("button",{onClick:()=>{ne("FAVORITES"),Oe(null),be("ALL"),ae("ALL"),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${$==="FAVORITES"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[h.jsx(Bo,{size:12}),"Favorites"]}),h.jsx("span",{className:"text-[10px] opacity-70",children:He})]}),h.jsxs("button",{onClick:()=>{ne("RECENT"),Oe(null),be("ALL"),ae("ALL"),F(1)},className:`mt-1 w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${$==="RECENT"?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[h.jsx(H4,{size:12}),"Recent Notes"]}),h.jsx("span",{className:"text-[10px] opacity-70",children:Qe})]}),h.jsxs("div",{className:"mt-2 border-t border-[#E6EAF2] dark:border-slate-800 pt-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsxs("button",{onClick:()=>lt(O=>!O),className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500 inline-flex items-center gap-1 hover:text-slate-700 dark:hover:text-slate-300",children:[h.jsx(Ra,{size:11,className:`transition-transform ${$e?"rotate-180":""}`}),"Top Tags"]}),ie&&h.jsx("button",{onClick:()=>{Oe(null),F(1)},className:"text-[10px] text-[#CC561E] hover:underline",children:"Clear tag filter"})]}),$e&&(Pe.length===0?h.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No tags yet"}):h.jsx("div",{className:"space-y-1",children:Pe.map(O=>h.jsxs("button",{onClick:()=>{Oe(O.key),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors flex items-center justify-between ${ie===O.key?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:[h.jsxs("span",{className:"truncate",children:["#",O.label]}),h.jsx("span",{className:"text-[10px] opacity-70",children:O.count})]},O.key))}))]})]}),["PRIVATE","DAILY","IDEAS"].map(O=>h.jsx(y0,{id:`cat-group:${O}`,children:we=>h.jsxs("div",{className:`rounded-lg border p-2 ${we?"border-[#CC561E]/40 bg-[#CC561E]/5":"border-[#E6EAF2] dark:border-slate-800"}`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsxs("button",{onClick:()=>{ne("NONE"),Oe(null),be(O),ae("ALL"),F(1)},className:`text-xs font-semibold uppercase tracking-wide ${oe===O&&L==="ALL"&&$==="NONE"&&!ie?"text-[#CC561E]":"text-slate-600 dark:text-slate-300"}`,children:[mn(O)," (",Ye[O],")"]}),h.jsxs("button",{onClick:()=>ti(O),className:"text-[11px] text-[#CC561E] hover:underline inline-flex items-center gap-1",children:[h.jsx(i3,{size:11}),"Folder"]})]}),h.jsx(y0,{id:`cat-root:${O}`,children:ge=>h.jsxs("button",{onClick:()=>{ne("NONE"),Oe(null),be(O),ae("__ROOT__"),F(1)},className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm transition-colors ${ge?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${oe===O&&L==="__ROOT__"&&$==="NONE"&&!ie?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"}`,children:["Unfiled (",It[O],")"]})}),h.jsxs("div",{className:"mt-1",children:[h.jsxs("button",{onClick:()=>rt(ge=>({...ge,[O]:!ge[O]})),className:"w-full text-left px-2 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 inline-flex items-center gap-1",children:[h.jsx(Ra,{size:11,className:`transition-transform ${Ue[O]?"":"rotate-180"}`}),"Folders (",ft[O].length,")"]}),!Ue[O]&&h.jsxs("div",{className:"mt-1 space-y-1",children:[ft[O].length===0?h.jsx("p",{className:"text-[11px] text-slate-400 px-1 py-1",children:"No folders yet"}):ft[O].slice(0,pt[O]).map(ge=>h.jsx(y0,{id:`folder:${ge.id}`,children:Ze=>h.jsx($C,{id:`folder-item:${ge.id}`,children:({setNodeRef:wt,style:zt,isDragging:Qr,attributes:Bt,listeners:lr})=>h.jsxs("div",{ref:wt,style:Qr?void 0:zt,className:`w-full text-left px-2 py-1.5 rounded-md text-xs md:text-sm flex items-center gap-2 ${Ze?"bg-[#CC561E]/15 border border-[#CC561E]/30":"border border-transparent"} ${oe===O&&L===ge.id&&$==="NONE"&&!ie?"bg-[#CC561E]/10 text-[#CC561E] font-semibold":"text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-800"} ${Qr?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[h.jsx("button",{...Bt,...lr,onClick:Zr=>Zr.stopPropagation(),className:"p-1 rounded text-slate-400 hover:text-slate-700 cursor-grab active:cursor-grabbing",title:"Move folder",children:h.jsx(N2,{size:12})}),h.jsxs("button",{onClick:()=>{ne("NONE"),Oe(null),be(O),ae(ge.id),F(1)},className:"flex items-center gap-2 flex-1 min-w-0",children:[h.jsx(E2,{size:12}),h.jsx("span",{className:"truncate",children:ge.name})]}),h.jsx("span",{className:"text-[10px] opacity-70",children:ge.count}),h.jsx("button",{onClick:()=>Sl(ge.id,ge.name),className:"text-slate-400 hover:text-slate-700",title:"Rename folder",children:h.jsx(Y3,{size:12})}),h.jsx("button",{onClick:()=>vp(ge.id),className:"text-slate-400 hover:text-red-500",title:"Delete folder",children:h.jsx(Ha,{size:12})})]})})},ge.id)),ft[O].length>pt[O]&&h.jsxs("button",{onClick:()=>Me(ge=>({...ge,[O]:ge[O]+Ma})),className:"w-full text-left px-2 py-1.5 rounded-md text-[11px] font-semibold text-[#CC561E] hover:bg-[#CC561E]/10",children:["Load more (",ft[O].length-pt[O]," left)"]})]})]})]})},O))]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"lg:hidden flex gap-2",children:[h.jsxs("button",{onClick:()=>De(O=>!O),className:"flex-1 px-3 py-2.5 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider text-slate-600 dark:text-slate-400 shadow-sm active:scale-95 transition-all",children:[h.jsx(M2,{size:14}),"Navigator"]}),h.jsxs("button",{onClick:()=>an(!_e),className:`flex-1 px-3 py-2.5 border rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold uppercase tracking-wider transition-all shadow-sm active:scale-95 ${_e?"bg-[#CC561E]/10 border-[#CC561E]/30 text-[#CC561E]":"bg-white dark:bg-slate-900 border-[#E6EAF2] dark:border-slate-800 text-slate-600 dark:text-slate-400"}`,children:[h.jsx(Ra,{size:14,className:`transition-transform duration-200 ${_e?"rotate-180":""}`}),"Capture"]})]}),h.jsxs("div",{className:`bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-800 rounded-2xl overflow-hidden ${_e?"block":"hidden lg:block"}`,children:[h.jsxs("div",{className:`w-full flex items-center justify-between p-4 md:p-5 transition-colors ${_e?"":"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,onClick:()=>!_e&&an(!0),children:[h.jsxs("h4",{className:"hidden lg:flex text-sm md:text-base font-semibold uppercase tracking-[0.12em] text-slate-500 items-center gap-2 cursor-pointer",onClick:O=>{O.stopPropagation(),an(!_e)},children:[h.jsx(Ra,{size:16,className:`transition-transform duration-200 ${_e?"rotate-180":""}`}),"Quick Capture"]}),(_e||window.innerWidth>=1024)&&h.jsxs("div",{className:`flex items-center gap-2 flex-1 lg:flex-none justify-between lg:justify-end ${_e?"flex":"hidden lg:flex"}`,onClick:O=>O.stopPropagation(),children:[h.jsx("span",{className:"lg:hidden text-[11px] font-bold text-slate-500 uppercase tracking-wider",children:"Quick Capture"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("select",{value:on,onChange:O=>Gn(O.target.value),className:"text-[11px] border border-[#E6EAF2] dark:border-slate-700 rounded-md px-2 py-1 bg-white dark:bg-slate-950 text-slate-500 outline-none",children:[h.jsx("option",{value:"DAILY",children:"Daily"}),h.jsx("option",{value:"PRIVATE",children:"Private"}),h.jsx("option",{value:"IDEAS",children:"Ideas"})]}),$==="NONE"&&L!=="ALL"&&L!=="__ROOT__"&&h.jsxs("span",{className:"hidden sm:inline text-[11px] text-slate-400",children:["/ ",((Y=ln.get(L))==null?void 0:Y.name)||L]})]})]})]}),_e&&h.jsxs("div",{className:"px-4 pb-4 md:px-5 md:pb-5 pt-0 animate-in slide-in-from-top-2 duration-200",children:[h.jsx("input",{value:Dt,onChange:O=>gs(O.target.value),placeholder:"Note title (optional)",className:"w-full md:max-w-none max-w-[90%] mx-auto mb-3 border border-[#E6EAF2] dark:border-slate-700 rounded-xl px-4 py-3 text-sm md:text-base bg-white dark:bg-slate-950 block"}),h.jsx("div",{className:"max-w-[90%] md:max-w-none mx-auto",children:h.jsx(s5,{value:Yr,onChange:Kn,autoFocus:W,placeholder:"Start writing immediately...",minHeight:242},"quick-capture-editor")}),h.jsx("div",{className:"mt-3 flex justify-end max-w-[90%] md:max-w-none mx-auto",children:h.jsx("button",{onClick:ii,disabled:!Hf(Yr),className:"px-4 py-2 rounded-lg bg-[#262D40] text-white text-sm md:text-base disabled:opacity-40",children:"Save Quick Note"})})]})]}),vr.length===0?h.jsxs("div",{className:"text-center py-10 bg-white dark:bg-slate-900 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700",children:[h.jsx(Mf,{size:26,className:"mx-auto mb-2 text-slate-300"}),h.jsx("h3",{className:"text-base font-medium text-slate-900 dark:text-white",children:"No notes matched this filter"}),h.jsx("p",{className:"text-xs md:text-sm text-slate-500 mt-1",children:"Change category/folder filter or create a new note."})]}):h.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-2 md:gap-4",children:vr.map(O=>{const we=al(O.generalNotes||"");return h.jsx($C,{id:`note:${O.id}`,children:({setNodeRef:ge,style:Ze,isDragging:wt,attributes:zt,listeners:Qr})=>h.jsxs("div",{ref:ge,style:wt?void 0:Ze,onClick:()=>oa(O),className:`bg-white dark:bg-slate-800 p-2.5 md:p-5 rounded-xl border border-[#E6EAF2] dark:border-slate-800 hover:border-[#262D40]/20 dark:hover:border-[#262D40]/30 hover:shadow-md transition-all cursor-pointer flex flex-col group relative ${wt||hn===O.id?"opacity-60 ring-2 ring-[#CC561E]/40":""}`,children:[h.jsx("div",{className:"absolute top-2 left-2 z-10",children:h.jsx("button",{...zt,...Qr,onClick:Bt=>Bt.stopPropagation(),className:"p-1.5 rounded-full bg-white/85 dark:bg-slate-800/85 text-slate-400 hover:text-slate-700 shadow-sm",title:"Drag note",children:h.jsx(N2,{size:13})})}),h.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 z-10",children:[h.jsx("button",{onClick:Bt=>{Bt.stopPropagation(),k(O.id)},className:`p-1.5 rounded-full transition-all shadow-sm ${O.isFavorite?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 dark:text-orange-400 opacity-100":"bg-white/80 dark:bg-slate-800/80 text-slate-400 dark:text-slate-500 hover:text-orange-500 dark:hover:text-orange-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:O.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Bo,{size:14,fill:O.isFavorite?"currentColor":"none"})}),h.jsx("button",{onClick:Bt=>{Bt.stopPropagation(),w(O.id)},className:"p-1.5 bg-white/80 dark:bg-slate-800/80 hover:bg-[#F3F5FA] dark:hover:bg-slate-700 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 shadow-sm",title:"Delete Note",children:h.jsx(Ha,{size:14})})]}),h.jsx("h3",{className:"font-bold text-sm md:text-base text-slate-900 dark:text-white mb-2 leading-tight pl-8 pr-8",children:O.title}),h.jsxs("div",{className:"text-slate-600 dark:text-slate-300 text-xs md:text-sm whitespace-pre-wrap leading-relaxed max-h-[180px] overflow-hidden relative font-lora mb-3",children:[we||h.jsx("span",{className:"italic text-slate-400 dark:text-slate-500",children:"Empty"}),we.length>140&&h.jsx("div",{className:"absolute bottom-0 inset-x-0 h-8 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),h.jsxs("div",{className:"mt-auto pt-2 flex flex-wrap gap-1.5 border-t border-slate-100 dark:border-slate-800 items-center",children:[h.jsx("span",{className:"px-2 py-0.5 bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs rounded border border-[#CC561E]/20 font-semibold",children:Dn(O)}),yr(O)&&h.jsx("span",{className:"px-2 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700 truncate max-w-[150px]",children:yr(O)}),h.jsxs("span",{className:"ml-auto text-[10px] md:text-xs text-slate-400 flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),new Date(O.addedAt).toLocaleDateString()]})]})]})},O.id)})})]})]}),h.jsx(bD,{modifiers:[q2],children:Tl?h.jsxs("div",{className:"w-[320px] max-w-[80vw] bg-white dark:bg-slate-800 p-3 rounded-xl border border-[#CC561E]/35 shadow-xl cursor-grabbing",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:Tl.title}),h.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-300 truncate",children:mn(Dn(Tl))})]}):Al?h.jsxs("div",{className:"w-[220px] max-w-[70vw] bg-white dark:bg-slate-900 px-3 py-2 rounded-lg border border-[#CC561E]/35 shadow-xl cursor-grabbing flex items-center gap-2",children:[h.jsx(E2,{size:13,className:"text-slate-500"}),h.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 truncate",children:Al.name})]}):null})]}):h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 md:gap-6",children:vr.map(O=>h.jsxs("div",{onClick:()=>m(O),className:`bg-white ${Du} rounded-xl border border-[#E6EAF2] dark:border-slate-800 overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all cursor-pointer group flex flex-col h-full relative`,children:[h.jsxs("div",{className:"h-[122px] md:h-40 bg-[#F3F5FA] dark:bg-slate-800 relative flex items-end justify-between overflow-hidden group-hover:opacity-95 transition-opacity",children:[h.jsxs("div",{className:"absolute top-2 right-2 z-40 flex gap-1",children:[h.jsx("button",{onClick:we=>{we.stopPropagation(),k(O.id)},className:`p-1.5 rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all ${O.isFavorite?"bg-amber-100/90 dark:bg-amber-900/80 text-amber-500 dark:text-amber-400 opacity-100":"bg-white/90 dark:bg-slate-900/90 text-slate-400 dark:text-slate-500 hover:text-amber-500 dark:hover:text-amber-400 opacity-0 group-hover:opacity-100 focus:opacity-100"}`,title:O.isFavorite?"Remove from Favorites":"Add to Favorites",children:h.jsx(Bo,{size:14,className:"md:w-4 md:h-4",fill:O.isFavorite?"currentColor":"none"})}),h.jsx("button",{onClick:we=>{we.stopPropagation(),w(O.id)},className:"p-1.5 bg-white/90 dark:bg-slate-900/90 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 text-slate-400 dark:text-slate-500 hover:text-slate-900 dark:hover:text-white rounded-full shadow-sm backdrop-blur-sm border border-[#E6EAF2] dark:border-slate-800 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:"Delete Item",children:h.jsx(Ha,{size:14,className:"md:w-4 md:h-4"})}),O.isIngested&&h.jsx("div",{className:"p-1.5 bg-[#262D40]/90 dark:bg-[#262D40]/90 text-white rounded-full shadow-sm backdrop-blur-sm border border-[#262D40]/50 dark:border-[#262D40]/50 transition-all z-40",title:"Added to AI Library",children:h.jsx(Yc,{size:14,className:"md:w-4 md:h-4",fill:"currentColor"})})]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#F3F5FA] dark:bg-slate-800 transition-colors group-hover:bg-[#EDF1F8] dark:group-hover:bg-slate-700",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-[#262D40]/20 blur-2xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),h.jsx("div",{className:"relative p-4 rounded-full",children:O.type==="BOOK"?h.jsx(sx,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):O.type==="ARTICLE"?h.jsx(pf,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"}):h.jsx(mf,{size:48,className:"text-[#262D40] dark:text-white/80 drop-shadow-[0_0_8px_rgba(38,45,64,0.35)]"})})]})}),O.type==="BOOK"&&O.coverUrl&&h.jsxs(h.Fragment,{children:[h.jsx("img",{src:O.coverUrl,alt:O.title,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 z-10",onError:we=>{we.currentTarget.style.display="none";const ge=we.currentTarget.nextElementSibling;ge&&ge.classList.add("hidden")}}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/80 via-slate-900/20 to-transparent z-20 pointer-events-none"})]}),O.type!=="BOOK"&&h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-transparent z-20 pointer-events-none"}),h.jsxs("div",{className:"relative z-30 p-1.5 md:p-4 w-full flex justify-between items-end",children:[h.jsx("div",{className:`text-[8px] md:text-xs font-bold px-1 md:px-2 py-0.5 md:py-1 rounded shadow-sm backdrop-blur-md ${O.type==="BOOK"&&O.coverUrl||O.type!=="BOOK"?"bg-white/90 dark:bg-slate-900/90 text-slate-900 dark:text-white border border-white/50 dark:border-slate-700":H[O.readingStatus]}`,children:O.readingStatus}),h.jsxs("div",{className:"flex gap-0.5 md:gap-1",children:[O.type==="BOOK"&&O.status==="Lent Out"&&h.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F59E0B] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lent Out",children:h.jsx(Ui,{size:10,className:"md:w-3 md:h-3"})}),O.type==="BOOK"&&O.status==="Lost"&&h.jsx("div",{className:"w-4 h-4 md:w-6 md:h-6 rounded-full bg-[#F43F5E] text-white flex items-center justify-center shadow-sm border border-white/20",title:"Lost",children:h.jsx(Ui,{size:10,className:"md:w-3 md:h-3"})})]})]})]}),h.jsxs("div",{className:"p-2.5 md:p-5 flex-1 flex flex-col",children:[h.jsx("h3",{className:"font-bold text-sm md:text-lg text-slate-900 dark:text-white leading-tight mb-0.5 md:mb-1 line-clamp-2 group-hover:text-[#262D40] dark:group-hover:text-[#262D40] transition-colors",children:O.title}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mb-2 md:mb-4 line-clamp-1",children:O.author}),h.jsxs("div",{className:"mt-auto pt-2 md:pt-4 border-t border-slate-50 dark:border-slate-800 flex justify-between items-center text-[10px] md:text-xs text-slate-400 dark:text-slate-500",children:[h.jsx("span",{className:"truncate max-w-[70%]",children:O.type==="BOOK"?O.publisher||"":O.type==="ARTICLE"?O.publisher||"Journal":(()=>{try{return O.url?new URL(O.url).hostname:"Web"}catch{return"Web"}})()}),O.type==="ARTICLE"&&O.publicationYear&&h.jsx("span",{className:"bg-[#F3F5FA] dark:bg-slate-800 px-1.5 py-0.5 rounded text-slate-500 dark:text-slate-400 font-mono",children:O.publicationYear}),O.type==="WEBSITE"&&O.url&&h.jsx("a",{href:O.url,target:"_blank",rel:"noreferrer",className:"text-[#262D40]/70 hover:text-[#262D40]",onClick:we=>we.stopPropagation(),children:h.jsx($h,{size:12,className:"md:w-3.5 md:h-3.5"})})]})]})]},O.id))}),Ml()]})},ro=(Y=>{switch(Y){case"DASHBOARD":return $E;case"NOTES":return VE;case"BOOK":return sx;case"ARTICLE":return pf;case"WEBSITE":return mf;case"PERSONAL_NOTE":return qE;default:return vE}})(b);return h.jsxs("div",{className:"max-w-6xl w-full mx-auto p-3 md:p-8 lg:p-10 animate-in fade-in duration-500",children:[!A&&h.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-8 gap-2",children:[h.jsxs("div",{className:"flex items-center gap-2 md:gap-4 overflow-hidden flex-1",children:[h.jsx("button",{onClick:v,className:"lg:hidden p-1 -ml-1 text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-slate-800 rounded-lg transition-colors shrink-0",children:h.jsx(P3,{size:18,className:"md:w-6 md:h-6"})}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"hidden md:flex p-2 bg-[#262D40] rounded-xl border border-[#262D40]/80 shadow-sm",children:h.jsx(ro,{size:24,className:"text-white"})}),h.jsxs("div",{className:"min-w-0 flex flex-col justify-center",children:[h.jsx("h1",{className:"text-lg md:text-3xl font-bold text-slate-900 dark:text-white tracking-tight leading-none truncate",children:Hn(b)}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-[10px] md:text-sm md:mt-1 font-medium truncate",children:R?`${or.total} Highlights`:W?`${or.total} Notes`:`${or.total} Items  ${or.reading} Reading`})]})]})]}),h.jsx("div",{className:"flex gap-2",children:h.jsxs("button",{onClick:()=>{var Y;if(W&&r){const O=oe==="ALL"?"DAILY":oe,we=L==="ALL"||L==="__ROOT__"?void 0:L;r({category:O,folderId:we,folderPath:we?(Y=ln.get(we))==null?void 0:Y.name:void 0});return}n()},className:"bg-[#262D40] text-white px-2 py-1.5 md:px-5 md:py-2.5 rounded-lg hover:bg-[#1d2333] transition-all flex items-center gap-1 shadow-md shadow-[#262D40]/20 dark:shadow-none font-medium shrink-0 active:scale-95",children:[h.jsx(ex,{size:14,className:"md:w-5 md:h-5"}),h.jsxs("span",{className:"text-[10px] md:text-base",children:["Add ",b==="ARTICLE"?"Article":b==="WEBSITE"?"Web":b==="PERSONAL_NOTE"?"Note":"Book"]})]})})]}),!A&&h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-1.5 md:p-4 rounded-xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 mb-2 md:mb-8 flex flex-col md:flex-row gap-2 md:gap-4 max-w-[90%] md:max-w-none mx-auto w-full",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx(Us,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-5 md:h-5"}),h.jsx("input",{type:"text",placeholder:cn(),value:re,onChange:Y=>ue(Y.target.value),className:`w-full pl-7 md:pl-10 ${R||W?"pr-10":"pr-4"} md:pr-4 py-1 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] focus:border-transparent outline-none transition-all text-[11px] md:text-base bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500`}),K&&h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:h.jsx(nn,{size:16,className:"animate-spin text-[#CC561E]"})}),(R||W)&&h.jsx("button",{onClick:()=>Ne(he==="FAVORITES"?"ALL":"FAVORITES"),className:`md:hidden absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-lg border transition-all flex items-center justify-center shrink-0 ${he==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500"}`,title:he==="FAVORITES"?"Show All":"Show Favorites Only",children:h.jsx(Bo,{size:14,fill:he==="FAVORITES"?"currentColor":"none"})})]}),(R||W)&&h.jsx("button",{onClick:()=>Ne(he==="FAVORITES"?"ALL":"FAVORITES"),className:`hidden md:flex p-2 rounded-lg border transition-all items-center justify-center shrink-0 ${he==="FAVORITES"?"bg-orange-100 dark:bg-orange-900/30 border-orange-200 dark:border-orange-800 text-orange-600 dark:text-orange-400":"bg-white dark:bg-slate-800 border-[#E6EAF2] dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:bg-[#F3F5FA] dark:hover:bg-slate-700"}`,title:he==="FAVORITES"?"Show All":"Show Favorites Only",children:h.jsx(Bo,{size:20,className:"md:w-5 md:h-5",fill:he==="FAVORITES"?"currentColor":"none"})}),!R&&!W&&h.jsxs("div",{className:"grid grid-cols-2 md:flex gap-2 items-center",children:[h.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[h.jsx(l3,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:he,onChange:Y=>{Ne(Y.target.value),F(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"ALL",children:"All"}),h.jsx("option",{value:"FAVORITES",children:"Favorites"}),h.jsx("option",{value:"HIGHLIGHTS",children:"Highlight"}),h.jsxs("optgroup",{label:"Status",children:[h.jsx("option",{value:"To Read",children:"To Read"}),h.jsx("option",{value:"Reading",children:"Reading"}),h.jsx("option",{value:"Finished",children:"Finished"})]}),b==="BOOK"&&h.jsxs("optgroup",{label:"Inventory",children:[h.jsx("option",{value:"On Shelf",children:"On Shelf"}),h.jsx("option",{value:"Lent Out",children:"Lent Out"}),h.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),h.jsxs("div",{className:"relative min-w-[100px] md:min-w-[160px]",children:[h.jsx(v4,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:Se,onChange:Y=>{Te(Y.target.value),F(1)},className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"date_desc",children:"Newest"}),h.jsx("option",{value:"date_asc",children:"Oldest"}),h.jsx("option",{value:"title_asc",children:"A-Z"})]})]}),b==="BOOK"&&h.jsxs("div",{className:"relative min-w-[140px] md:min-w-[180px]",children:[h.jsx(Af,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 w-3.5 h-3.5 md:w-4 md:h-4"}),h.jsxs("select",{value:_||"",onChange:Y=>P==null?void 0:P(Y.target.value||null),className:"w-full pl-7 md:pl-9 pr-6 md:pr-8 py-1.5 md:py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg appearance-none bg-white dark:bg-slate-800 focus:ring-2 focus:ring-[#CC561E] text-xs md:text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:border-slate-300 dark:hover:border-slate-600",children:[h.jsx("option",{value:"",children:"All categories"}),Bf.map(Y=>h.jsx("option",{value:Y,children:Y},Y))]})]}),b==="ARTICLE"&&h.jsx("input",{type:"text",placeholder:"Journal...",value:pe,onChange:Y=>{U(Y.target.value),F(1)},className:"hidden md:block px-4 py-2 border border-[#E6EAF2] dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-[#CC561E] text-sm min-w-[140px] bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500"})]})]}),b==="BOOK"&&!A&&_&&h.jsxs("div",{className:"flex items-center gap-2 mb-4 md:mb-6",children:[h.jsx("span",{className:"text-xs md:text-sm text-slate-500",children:"Category:"}),h.jsxs("button",{className:"flex items-center gap-2 px-3 py-1 bg-[rgba(204,86,30,0.1)] text-[#CC561E] rounded-full text-xs md:text-sm border border-[#CC561E]/20 shadow-sm",onClick:()=>P==null?void 0:P(null),children:[h.jsx("span",{className:"font-semibold",children:_}),h.jsx(ds,{size:14})]})]}),kp(),W&&Pn&&h.jsxs("div",{className:"fixed bottom-5 right-5 z-50 bg-[#262D40] text-white px-4 py-3 rounded-xl shadow-xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm",children:"Note moved."}),h.jsx("button",{onClick:()=>{window.clearTimeout(Pn.timeoutId);const Y=Pn;pn(null),El(Y.noteId,Y.category,Y.folderId,!1)},className:"text-sm font-semibold text-[#FFB58D] hover:text-white",children:"Undo"})]})]})}),zH=()=>{};var VC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},BH=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[n++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[n++],l=t[n++],c=t[n++],d=((s&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const a=t[n++],l=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},a5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const a=t[s],l=s+1<t.length,c=l?t[s+1]:0,d=s+2<t.length,p=d?t[s+2]:0,m=a>>2,g=(a&3)<<4|c>>4;let b=(c&15)<<2|p>>6,v=p&63;d||(v=64,l||(b=64)),r.push(n[m],n[g],n[b],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i5(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):BH(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const a=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const p=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,a==null||c==null||p==null||g==null)throw new PH;const b=a<<2|c>>4;if(r.push(b),p!==64){const v=c<<4&240|p>>2;if(r.push(v),g!==64){const w=p<<6&192|g;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HH=function(t){const e=i5(t);return a5.encodeByteArray(e,!0)},o5=function(t){return HH(t).replace(/\./g,"")},l5=function(t){try{return a5.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UH=()=>FH().__FIREBASE_DEFAULTS__,$H=()=>{if(typeof process>"u"||typeof VC>"u")return;const t=VC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},VH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&l5(t[1]);return e&&JSON.parse(e)},iy=()=>{try{return zH()||UH()||$H()||VH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qH=t=>{var e,n;return(n=(e=iy())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},c5=()=>{var t;return(t=iy())==null?void 0:t.config},u5=t=>{var e;return(e=iy())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function GH(t){return(await fetch(t,{credentials:"include"})).ok}const qc={};function KH(){const t={prod:[],emulator:[]};for(const e of Object.keys(qc))qc[e]?t.emulator.push(e):t.prod.push(e);return t}function YH(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let qC=!1;function JH(t,e){if(typeof window>"u"||typeof document>"u"||!pp(window.location.host)||qc[t]===e||qc[t]||qC)return;qc[t]=e;function n(b){return`__firebase__banner__${b}`}const r="__firebase__banner",a=KH().prod.length>0;function l(){const b=document.getElementById(r);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function d(b,v){b.setAttribute("width","24"),b.setAttribute("id",v),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{qC=!0,l()},b}function m(b,v){b.setAttribute("id",v),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function g(){const b=YH(r),v=n("text"),w=document.getElementById(v)||document.createElement("span"),C=n("learnmore"),k=document.getElementById(C)||document.createElement("a"),N=n("preprendIcon"),M=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const _=b.element;c(_),m(k,C);const P=p();d(M,N),_.append(M,w,k,P),document.body.appendChild(_)}a?(w.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function XH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qn())}function QH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ZH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function eF(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tF(){const t=qn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function nF(){try{return typeof indexedDB=="object"}catch{return!1}}function rF(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF="FirebaseError";class ia extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=sF,Object.setPrototypeOf(this,ia.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nu.prototype.create)}}class Nu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?iF(a,r):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new ia(s,c,r)}}function iF(t,e){return t.replace(aF,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const aF=/\{\$([^}]+)}/g;function oF(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const a=t[s],l=e[s];if(WC(a)&&WC(l)){if(!pl(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function WC(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lF(t,e){const n=new cF(t,e);return n.subscribe.bind(n)}class cF{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");uF(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=v0),s.error===void 0&&(s.error=v0),s.complete===void 0&&(s.complete=v0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uF(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function v0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(t){return t&&t._delegate?t._delegate:t}class ml{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new WH;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hF(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&l.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fF(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fF(t){return t===ja?void 0:t}function hF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new dF(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(St||(St={}));const mF={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},gF=St.INFO,xF={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},bF=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=xF[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class d5{constructor(e){this.name=e,this._logLevel=gF,this._logHandler=bF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}}const yF=(t,e)=>e.some(n=>t instanceof n);let GC,KC;function vF(){return GC||(GC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wF(){return KC||(KC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const f5=new WeakMap,Ux=new WeakMap,h5=new WeakMap,w0=new WeakMap,ay=new WeakMap;function kF(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",l)},a=()=>{n(Ji(t.result)),s()},l=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&f5.set(n,t)}).catch(()=>{}),ay.set(e,t),e}function CF(t){if(Ux.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",l),t.removeEventListener("abort",l)},a=()=>{n(),s()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",l),t.addEventListener("abort",l)});Ux.set(t,e)}let $x={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ux.get(t);if(e==="objectStoreNames")return t.objectStoreNames||h5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SF(t){$x=t($x)}function EF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(k0(this),e,...n);return h5.set(r,e.sort?e.sort():[e]),Ji(r)}:wF().includes(t)?function(...e){return t.apply(k0(this),e),Ji(f5.get(this))}:function(...e){return Ji(t.apply(k0(this),e))}}function NF(t){return typeof t=="function"?EF(t):(t instanceof IDBTransaction&&CF(t),yF(t,vF())?new Proxy(t,$x):t)}function Ji(t){if(t instanceof IDBRequest)return kF(t);if(w0.has(t))return w0.get(t);const e=NF(t);return e!==t&&(w0.set(t,e),ay.set(e,t)),e}const k0=t=>ay.get(t);function TF(t,e,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(t,e),c=Ji(l);return r&&l.addEventListener("upgradeneeded",d=>{r(Ji(l.result),d.oldVersion,d.newVersion,Ji(l.transaction),d)}),n&&l.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),s&&d.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const AF=["get","getKey","getAll","getAllKeys","count"],MF=["put","add","delete","clear"],C0=new Map;function YC(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(C0.get(e))return C0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=MF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||AF.includes(n)))return;const a=async function(l,...c){const d=this.transaction(l,s?"readwrite":"readonly");let p=d.store;return r&&(p=p.index(c.shift())),(await Promise.all([p[n](...c),s&&d.done]))[0]};return C0.set(e,a),a}SF(t=>({...t,get:(e,n,r)=>YC(e,n)||t.get(e,n,r),has:(e,n)=>!!YC(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Vx="@firebase/app",JC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=new d5("@firebase/app"),_F="@firebase/app-compat",RF="@firebase/analytics-compat",DF="@firebase/analytics",LF="@firebase/app-check-compat",IF="@firebase/app-check",zF="@firebase/auth",BF="@firebase/auth-compat",PF="@firebase/database",HF="@firebase/data-connect",FF="@firebase/database-compat",UF="@firebase/functions",$F="@firebase/functions-compat",VF="@firebase/installations",qF="@firebase/installations-compat",WF="@firebase/messaging",GF="@firebase/messaging-compat",KF="@firebase/performance",YF="@firebase/performance-compat",JF="@firebase/remote-config",XF="@firebase/remote-config-compat",QF="@firebase/storage",ZF="@firebase/storage-compat",eU="@firebase/firestore",tU="@firebase/ai",nU="@firebase/firestore-compat",rU="firebase",sU="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="[DEFAULT]",iU={[Vx]:"fire-core",[_F]:"fire-core-compat",[DF]:"fire-analytics",[RF]:"fire-analytics-compat",[IF]:"fire-app-check",[LF]:"fire-app-check-compat",[zF]:"fire-auth",[BF]:"fire-auth-compat",[PF]:"fire-rtdb",[HF]:"fire-data-connect",[FF]:"fire-rtdb-compat",[UF]:"fire-fn",[$F]:"fire-fn-compat",[VF]:"fire-iid",[qF]:"fire-iid-compat",[WF]:"fire-fcm",[GF]:"fire-fcm-compat",[KF]:"fire-perf",[YF]:"fire-perf-compat",[JF]:"fire-rc",[XF]:"fire-rc-compat",[QF]:"fire-gcs",[ZF]:"fire-gcs-compat",[eU]:"fire-fst",[nU]:"fire-fst-compat",[tU]:"fire-vertex","fire-js":"fire-js",[rU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Map,aU=new Map,Wx=new Map;function XC(t,e){try{t.container.addComponent(e)}catch(n){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function du(t){const e=t.name;if(Wx.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;Wx.set(e,t);for(const n of Oh.values())XC(n,t);for(const n of aU.values())XC(n,t);return!0}function p5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ls(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new Nu("app","Firebase",oU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ml("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=sU;function m5(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:qx,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Xi.create("bad-app-name",{appName:String(s)});if(n||(n=c5()),!n)throw Xi.create("no-options");const a=Oh.get(s);if(a){if(pl(n,a.options)&&pl(r,a.config))return a;throw Xi.create("duplicate-app",{appName:s})}const l=new pF(s);for(const d of Wx.values())l.addComponent(d);const c=new lU(n,r,l);return Oh.set(s,c),c}function cU(t=qx){const e=Oh.get(t);if(!e&&t===qx&&c5())return m5();if(!e)throw Xi.create("no-app",{appName:t});return e}function Xo(t,e,n){let r=iU[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(l.join(" "));return}du(new ml(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU="firebase-heartbeat-database",dU=1,fu="firebase-heartbeat-store";let S0=null;function g5(){return S0||(S0=TF(uU,dU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Xi.create("idb-open",{originalErrorMessage:t.message})})),S0}async function fU(t){try{const n=(await g5()).transaction(fu),r=await n.objectStore(fu).get(x5(t));return await n.done,r}catch(e){if(e instanceof ia)Xs.warn(e.message);else{const n=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xs.warn(n.message)}}}async function QC(t,e){try{const r=(await g5()).transaction(fu,"readwrite");await r.objectStore(fu).put(e,x5(t)),await r.done}catch(n){if(n instanceof ia)Xs.warn(n.message);else{const r=Xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xs.warn(r.message)}}}function x5(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU=1024,pU=30;class mU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=ZC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>pU){const l=bU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ZC(),{heartbeatsToSend:r,unsentEntries:s}=gU(this._heartbeatsCache.heartbeats),a=o5(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return Xs.warn(n),""}}}function ZC(){return new Date().toISOString().substring(0,10)}function gU(t,e=hU){const n=[];let r=t.slice();for(const s of t){const a=n.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),eS(n)>e){a.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),eS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class xU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nF()?rF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await fU(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return QC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return QC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function eS(t){return o5(JSON.stringify({version:2,heartbeats:t})).length}function bU(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yU(t){du(new ml("platform-logger",e=>new jF(e),"PRIVATE")),du(new ml("heartbeat",e=>new mU(e),"PRIVATE")),Xo(Vx,JC,t),Xo(Vx,JC,"esm2020"),Xo("fire-js","")}yU("");function b5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const vU=b5,y5=new Nu("auth","Firebase",b5());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=new d5("@firebase/auth");function wU(t,...e){_h.logLevel<=St.WARN&&_h.warn(`Auth (${Au}): ${t}`,...e)}function Cf(t,...e){_h.logLevel<=St.ERROR&&_h.error(`Auth (${Au}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(t,...e){throw ly(t,...e)}function Vr(t,...e){return ly(t,...e)}function oy(t,e,n){const r={...vU(),[e]:n};return new Nu("auth","Firebase",r).create(e,{appName:t.name})}function Wa(t){return oy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kU(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ps(t,"argument-error"),oy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ly(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return y5.create(t,...e)}function qe(t,e,...n){if(!t)throw ly(e,...n)}function Vs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cf(e),new Error(e)}function Qs(t,e){t||Vs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function CU(){return tS()==="http:"||tS()==="https:"}function tS(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CU()||ZH()||"connection"in navigator)?navigator.onLine:!0}function EU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Qs(n>e,"Short delay should be less than long delay!"),this.isMobile=XH()||eF()}get(){return SU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t,e){Qs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AU=new Mu(3e4,6e4);function uy(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function kl(t,e,n,r,s={}){return w5(t,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const c=Tu({key:t.config.apiKey,...l}).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:d,...a};return QH()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&pp(t.emulatorConfig.host)&&(p.credentials="include"),v5.fetch()(await k5(t,t.config.apiHost,n,c),p)})}async function w5(t,e,n){t._canInitEmulator=!1;const r={...NU,...e};try{const s=new jU(t),a=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw cf(t,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[d,p]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw cf(t,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw cf(t,"email-already-in-use",l);if(d==="USER_DISABLED")throw cf(t,"user-disabled",l);const m=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw oy(t,m,p);ps(t,m)}}catch(s){if(s instanceof ia)throw s;ps(t,"network-request-failed",{message:String(s)})}}async function MU(t,e,n,r,s={}){const a=await kl(t,e,n,r,s);return"mfaPendingCredential"in a&&ps(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function k5(t,e,n,r){const s=`${e}${n}?${r}`,a=t,l=a.config.emulator?cy(t.config,s):`${t.config.apiScheme}://${s}`;return TU.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class jU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Vr(this.auth,"network-request-failed")),AU.get())})}}function cf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Vr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OU(t,e){return kl(t,"POST","/v1/accounts:delete",e)}async function Rh(t,e){return kl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _U(t,e=!1){const n=aa(t),r=await n.getIdToken(e),s=dy(r);qe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:Wc(E0(s.auth_time)),issuedAtTime:Wc(E0(s.iat)),expirationTime:Wc(E0(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function E0(t){return Number(t)*1e3}function dy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Cf("JWT malformed, contained fewer than 3 sections"),null;try{const s=l5(n);return s?JSON.parse(s):(Cf("Failed to decode base64 JWT payload"),null)}catch(s){return Cf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function nS(t){const e=dy(t);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ia&&RU(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function RU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wc(this.lastLoginAt),this.creationTime=Wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dh(t){var g;const e=t.auth,n=await t.getIdToken(),r=await hu(t,Rh(e,{idToken:n}));qe(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const a=(g=s.providerUserInfo)!=null&&g.length?C5(s.providerUserInfo):[],l=IU(t.providerData,a),c=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),p=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Kx(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(t,m)}async function LU(t){const e=aa(t);await Dh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IU(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function C5(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zU(t,e){const n=await w5(t,{},async()=>{const r=Tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,l=await k5(t,s,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:r};return t.emulatorConfig&&pp(t.emulatorConfig.host)&&(d.credentials="include"),v5.fetch()(l,d)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function BU(t,e){return kl(t,"POST","/v2/accounts:revokeToken",uy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const n=nS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:a}=await zU(e,n);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:a}=n,l=new Qo;return r&&(qe(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(qe(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(qe(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qo,this.toJSON())}_performRefresh(){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t,e){qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ur{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new DU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Kx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await hu(this,this.stsTokenManager.getToken(this.auth,e));return qe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return _U(this,e)}reload(){return LU(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ur({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Dh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ls(this.auth.app))return Promise.reject(Wa(this.auth));const e=await this.getIdToken();return await hu(this,OU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,a=n.phoneNumber??void 0,l=n.photoURL??void 0,c=n.tenantId??void 0,d=n._redirectEventId??void 0,p=n.createdAt??void 0,m=n.lastLoginAt??void 0,{uid:g,emailVerified:b,isAnonymous:v,providerData:w,stsTokenManager:C}=n;qe(g&&C,e,"internal-error");const k=Qo.fromJSON(this.name,C);qe(typeof g=="string",e,"internal-error"),ji(r,e.name),ji(s,e.name),qe(typeof b=="boolean",e,"internal-error"),qe(typeof v=="boolean",e,"internal-error"),ji(a,e.name),ji(l,e.name),ji(c,e.name),ji(d,e.name),ji(p,e.name),ji(m,e.name);const N=new Ur({uid:g,auth:e,email:s,emailVerified:b,displayName:r,isAnonymous:v,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:k,createdAt:p,lastLoginAt:m});return w&&Array.isArray(w)&&(N.providerData=w.map(M=>({...M}))),d&&(N._redirectEventId=d),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new Qo;s.updateFromServerResponse(n);const a=new Ur({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Dh(a),a}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];qe(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?C5(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),c=new Qo;c.updateFromIdToken(r);const d=new Ur({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Kx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new Map;function qs(t){Qs(t instanceof Function,"Expected a class definition");let e=rS.get(t);return e?(Qs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}S5.type="NONE";const sS=S5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t,e,n){return`firebase:${t}:${e}:${n}`}class Zo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Sf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Sf("persistence",s.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Rh(this.auth,{idToken:e}).catch(()=>{});return n?Ur._fromGetAccountInfoResponse(this.auth,n,e):null}return Ur._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Zo(qs(sS),e,r);const s=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||qs(sS);const l=Sf(r,e.config.apiKey,e.name);let c=null;for(const p of n)try{const m=await p._get(l);if(m){let g;if(typeof m=="string"){const b=await Rh(e,{idToken:m}).catch(()=>{});if(!b)break;g=await Ur._fromGetAccountInfoResponse(e,b,m)}else g=Ur._fromJSON(e,m);p!==a&&(c=g),a=p;break}}catch{}const d=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new Zo(a,e,r):(a=d[0],c&&await a._set(l,c.toJSON()),await Promise.all(n.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new Zo(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(j5(e))return"Blackberry";if(O5(e))return"Webos";if(N5(e))return"Safari";if((e.includes("chrome/")||T5(e))&&!e.includes("edge/"))return"Chrome";if(M5(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function E5(t=qn()){return/firefox\//i.test(t)}function N5(t=qn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T5(t=qn()){return/crios\//i.test(t)}function A5(t=qn()){return/iemobile/i.test(t)}function M5(t=qn()){return/android/i.test(t)}function j5(t=qn()){return/blackberry/i.test(t)}function O5(t=qn()){return/webos/i.test(t)}function fy(t=qn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function PU(t=qn()){var e;return fy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function HU(){return tF()&&document.documentMode===10}function _5(t=qn()){return fy(t)||M5(t)||O5(t)||j5(t)||/windows phone/i.test(t)||A5(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R5(t,e=[]){let n;switch(t){case"Browser":n=iS(qn());break;case"Worker":n=`${iS(qn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Au}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=a=>new Promise((l,c)=>{try{const d=e(a);l(d)}catch(d){c(d)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UU(t,e={}){return kl(t,"GET","/v2/passwordPolicy",uy(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U=6;class VU{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??$U,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aS(this),this.idTokenSubscription=new aS(this),this.beforeStateQueue=new FU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=y5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qs(n)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await Zo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Rh(this,{idToken:e}),r=await Ur._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(ls(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,c=r==null?void 0:r._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===c)&&(d!=null&&d.user)&&(r=d.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Dh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ls(this.app))return Promise.reject(Wa(this));const n=e?aa(e):null;return n&&qe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ls(this.app)?Promise.reject(Wa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ls(this.app)?Promise.reject(Wa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UU(this),n=new VU(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await BU(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qs(e)||this._popupRedirectResolver;qe(n,this,"argument-error"),this.redirectPersistenceManager=await Zo.create(this,[qs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof n=="function"){const d=e.addObserver(n,r,s);return()=>{l=!0,d()}}else{const d=e.addObserver(n);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=R5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(ls(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&wU(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ju(t){return aa(t)}class aS{constructor(e){this.auth=e,this.observer=null,this.addObserver=lF(n=>this.observer=n)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function WU(t){hy=t}function GU(t){return hy.loadJS(t)}function KU(){return hy.gapiScript}function YU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JU(t,e){const n=p5(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),a=n.getOptions();if(pl(a,e??{}))return s;ps(s,"already-initialized")}return n.initialize({options:e})}function XU(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function QU(t,e,n){const r=ju(t);qe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=D5(e),{host:l,port:c}=ZU(e),d=c===null?"":`:${c}`,p={url:`${a}//${l}${d}/`},m=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){qe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),qe(pl(p,r.config.emulator)&&pl(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,pp(l)?(GH(`${a}//${l}${d}`),JH("Auth",!0)):e$()}function D5(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ZU(t){const e=D5(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:oS(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:oS(l)}}}function oS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function e$(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,n){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(t,e){return MU(t,"POST","/v1/accounts:signInWithIdp",uy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t$="http://localhost";class eo extends L5{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ps("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...a}=n;if(!r||!s)return null;const l=new eo(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return el(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,el(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,el(e,n)}buildRequest(){const e={requestUri:t$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Tu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou extends py{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Ou{constructor(){super("facebook.com")}static credential(e){return eo._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends Ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return eo._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fs.credential(n,r)}catch{return null}}}Fs.GOOGLE_SIGN_IN_METHOD="google.com";Fs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Ou{constructor(){super("github.com")}static credential(e){return eo._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.GITHUB_SIGN_IN_METHOD="github.com";Hi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Ou{constructor(){super("twitter.com")}static credential(e,n){return eo._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Fi.credential(n,r)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const a=await Ur._fromIdTokenResponse(e,r,s),l=lS(r);return new gl({user:a,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=lS(r);return new gl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function lS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends ia{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Lh(e,n,r,s)}}function I5(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(t,a,e,r):a})}async function n$(t,e,n=!1){const r=await hu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return gl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r$(t,e,n=!1){const{auth:r}=t;if(ls(r.app))return Promise.reject(Wa(r));const s="reauthenticate";try{const a=await hu(t,I5(r,s,e,t),n);qe(a.idToken,r,"internal-error");const l=dy(a.idToken);qe(l,r,"internal-error");const{sub:c}=l;return qe(t.uid===c,r,"user-mismatch"),gl._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ps(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s$(t,e,n=!1){if(ls(t.app))return Promise.reject(Wa(t));const r="signIn",s=await I5(t,r,e),a=await gl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(a.user),a}function i$(t,e,n,r){return aa(t).onIdTokenChanged(e,n,r)}function a$(t,e,n){return aa(t).beforeAuthStateChanged(e,n)}function o$(t,e,n,r){return aa(t).onAuthStateChanged(e,n,r)}function l$(t){return aa(t).signOut()}const Ih="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ih,"1"),this.storage.removeItem(Ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$=1e3,u$=10;class B5 extends z5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_5(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,c,d)=>{this.notifyListeners(l,d)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);HU()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,u$):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},c$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}B5.type="LOCAL";const d$=B5;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5 extends z5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}P5.type="SESSION";const H5=P5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new mp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:a}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(l).map(async p=>p(n.origin,a)),d=await f$(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:d})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((c,d)=>{const p=my("",20);s.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(g){const b=g;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(m),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(b.data.response);break;default:clearTimeout(m),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(){return window}function p$(t){us().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(){return typeof us().WorkerGlobalScope<"u"&&typeof us().importScripts=="function"}async function m$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function g$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function x$(){return F5()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5="firebaseLocalStorageDb",b$=1,zh="firebaseLocalStorage",$5="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function gp(t,e){return t.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function y$(){const t=indexedDB.deleteDatabase(U5);return new _u(t).toPromise()}function Yx(){const t=indexedDB.open(U5,b$);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(zh,{keyPath:$5})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(zh)?e(r):(r.close(),await y$(),e(await Yx()))})})}async function cS(t,e,n){const r=gp(t,!0).put({[$5]:e,value:n});return new _u(r).toPromise()}async function v$(t,e){const n=gp(t,!1).get(e),r=await new _u(n).toPromise();return r===void 0?null:r.value}function uS(t,e){const n=gp(t,!0).delete(e);return new _u(n).toPromise()}const w$=800,k$=3;class V5{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>k$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F5()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mp._getInstance(x$()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await m$(),!this.activeServiceWorker)return;this.sender=new h$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||g$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yx();return await cS(e,Ih,"1"),await uS(e,Ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>cS(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>v$(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>uS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=gp(s,!1).getAll();return new _u(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),w$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}V5.type="LOCAL";const C$=V5;new Mu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(t,e){return e?qs(e):(qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy extends L5{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return el(e,this._buildIdpRequest())}_linkToIdToken(e,n){return el(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return el(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function S$(t){return s$(t.auth,new gy(t),t.bypassAuthState)}function E$(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),r$(n,new gy(t),t.bypassAuthState)}async function N$(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),n$(n,new gy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(e,n,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return S$;case"linkViaPopup":case"linkViaRedirect":return N$;case"reauthViaPopup":case"reauthViaRedirect":return E$;default:ps(this.auth,"internal-error")}}resolve(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T$=new Mu(2e3,1e4);async function A$(t,e,n){if(ls(t.app))return Promise.reject(Vr(t,"operation-not-supported-in-this-environment"));const r=ju(t);kU(t,e,py);const s=q5(r,n);return new Ba(r,"signInViaPopup",e,s).executeNotNull()}class Ba extends W5{constructor(e,n,r,s,a){super(e,n,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Ba.currentPopupAction&&Ba.currentPopupAction.cancel(),Ba.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){Qs(this.filter.length===1,"Popup operations only handle one event");const e=my();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ba.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,T$.get())};e()}}Ba.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M$="pendingRedirect",Ef=new Map;class j$ extends W5{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ef.get(this.auth._key());if(!e){try{const r=await O$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ef.set(this.auth._key(),e)}return this.bypassAuthState||Ef.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function O$(t,e){const n=D$(e),r=R$(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function _$(t,e){Ef.set(t._key(),e)}function R$(t){return qs(t._redirectPersistence)}function D$(t){return Sf(M$,t.config.apiKey,t.name)}async function L$(t,e){return await ju(t)._initializationPromise,G5(t,e,!1)}async function G5(t,e,n=!1){if(ls(t.app))return Promise.reject(Wa(t));const r=ju(t),s=q5(r,e),l=await new j$(r,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I$=600*1e3;class z${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!B$(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!K5(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Vr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=I$&&this.cachedEventUids.clear(),this.cachedEventUids.has(dS(e))}saveEventToCache(e){this.cachedEventUids.add(dS(e)),this.lastProcessedEventTime=Date.now()}}function dS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function K5({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function B$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return K5(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P$(t,e={}){return kl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F$=/^https?/;async function U$(t){if(t.config.emulator)return;const{authorizedDomains:e}=await P$(t);for(const n of e)try{if($$(n))return}catch{}ps(t,"unauthorized-domain")}function $$(t){const e=Gx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!F$.test(n))return!1;if(H$.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V$=new Mu(3e4,6e4);function fS(){const t=us().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function q$(t){return new Promise((e,n)=>{var s,a,l;function r(){fS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fS(),n(Vr(t,"network-request-failed"))},timeout:V$.get()})}if((a=(s=us().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=us().gapi)!=null&&l.load)r();else{const c=YU("iframefcb");return us()[c]=()=>{gapi.load?r():n(Vr(t,"network-request-failed"))},GU(`${KU()}?onload=${c}`).catch(d=>n(d))}}).catch(e=>{throw Nf=null,e})}let Nf=null;function W$(t){return Nf=Nf||q$(t),Nf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G$=new Mu(5e3,15e3),K$="__/auth/iframe",Y$="emulator/auth/iframe",J$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},X$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Q$(t){const e=t.config;qe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?cy(e,Y$):`https://${t.config.authDomain}/${K$}`,r={apiKey:e.apiKey,appName:t.name,v:Au},s=X$.get(t.config.apiHost);s&&(r.eid=s);const a=t._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${Tu(r).slice(1)}`}async function Z$(t){const e=await W$(t),n=us().gapi;return qe(n,t,"internal-error"),e.open({where:document.body,url:Q$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:J$,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=Vr(t,"network-request-failed"),c=us().setTimeout(()=>{a(l)},G$.get());function d(){us().clearTimeout(c),s(r)}r.ping(d).then(d,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tV=500,nV=600,rV="_blank",sV="http://localhost";class hS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function iV(t,e,n,r=tV,s=nV){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const d={...eV,width:r.toString(),height:s.toString(),top:a,left:l},p=qn().toLowerCase();n&&(c=T5(p)?rV:n),E5(p)&&(e=e||sV,d.scrollbars="yes");const m=Object.entries(d).reduce((b,[v,w])=>`${b}${v}=${w},`,"");if(PU(p)&&c!=="_self")return aV(e||"",c),new hS(null);const g=window.open(e||"",c,m);qe(g,t,"popup-blocked");try{g.focus()}catch{}return new hS(g)}function aV(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV="__/auth/handler",lV="emulator/auth/handler",cV=encodeURIComponent("fac");async function pS(t,e,n,r,s,a){qe(t.config.authDomain,t,"auth-domain-config-required"),qe(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Au,eventId:s};if(e instanceof py){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",oF(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))l[m]=g}if(e instanceof Ou){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(l.scopes=m.join(","))}t.tenantId&&(l.tid=t.tenantId);const c=l;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await t._getAppCheckToken(),p=d?`#${cV}=${encodeURIComponent(d)}`:"";return`${uV(t)}?${Tu(c).slice(1)}${p}`}function uV({config:t}){return t.emulator?cy(t,lV):`https://${t.authDomain}/${oV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="webStorageSupport";class dV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=H5,this._completeRedirectFn=G5,this._overrideRedirectResult=_$}async _openPopup(e,n,r,s){var l;Qs((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await pS(e,n,r,Gx(),s);return iV(e,a,my())}async _openRedirect(e,n,r,s){await this._originValidation(e);const a=await pS(e,n,r,Gx(),s);return p$(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:a}=this.eventManagers[n];return s?Promise.resolve(s):(Qs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Z$(e),r=new z$(e);return n.register("authEvent",s=>(qe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(N0,{type:N0},s=>{var l;const a=(l=s==null?void 0:s[0])==null?void 0:l[N0];a!==void 0&&n(!!a),ps(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=U$(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _5()||N5()||fy()}}const fV=dV;var mS="@firebase/auth",gS="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mV(t){du(new ml("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=r.options;qe(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:l,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:R5(t)},p=new qU(r,s,a,d);return XU(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),du(new ml("auth-internal",e=>{const n=ju(e.getProvider("auth").getImmediate());return(r=>new hV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xo(mS,gS,pV(t)),Xo(mS,gS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV=300,xV=u5("authIdTokenMaxAge")||gV;let xS=null;const bV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>xV)return;const s=n==null?void 0:n.token;xS!==s&&(xS=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function xy(t=cU()){const e=p5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=JU(t,{popupRedirectResolver:fV,persistence:[C$,d$,H5]}),r=u5("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=bV(a.toString());a$(n,l,()=>l(n.currentUser)),i$(n,c=>l(c))}}const s=qH("auth");return s&&QU(n,`http://${s}`),n}function yV(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}WU({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const a=Vr("internal-error");a.customData=s,n(a)},r.type="text/javascript",r.charset="UTF-8",yV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mV("Browser");const Y5=new Set(["localhost","127.0.0.1"]),vV="http://localhost:8000",wV="https://api.tomehub.nl",kV="https://api.tomehub.nl".trim(),CV=Y5.has(window.location.hostname)?vV:wV,nt=(kV||CV).replace(/\/+$/,""),SV="Backend baglantisi kurulamadi. `apps/backend` klasorunde `python app.py` calistirin (port 8000).";async function EV(){const{auth:t}=await tl(async()=>{const{auth:n}=await Promise.resolve().then(()=>tM);return{auth:n}},void 0),e=t.currentUser;if(!e)throw new Error("Oturum dogrulamasi bulunamadi. Lutfen tekrar giris yapin.");return e.getIdToken()}async function Rt(t,e={}){var a;const n=await EV(),{auth:r}=await tl(async()=>{const{auth:l}=await Promise.resolve().then(()=>tM);return{auth:l}},void 0),s=new Headers(e.headers||{});if(s.has("Authorization")||s.set("Authorization",`Bearer ${n}`),Y5.has(window.location.hostname)&&!s.has("X-Firebase-UID")){const l=(a=r.currentUser)==null?void 0:a.uid;l&&s.set("X-Firebase-UID",l)}return fetch(t,{...e,headers:s})}async function Kr(t,e){try{const n=await t.json(),r=(n==null?void 0:n.detail)||(n==null?void 0:n.details)||(n==null?void 0:n.error);if(typeof r=="string"&&r.trim())return r}catch{}return e}function Go(t){return t instanceof TypeError&&/fetch/i.test(t.message)?`${SV} (API: ${nt})`:t instanceof Error&&t.message?t.message:"Beklenmeyen API hatasi"}const Cl=async()=>{const e=xy().currentUser;return e?await e.getIdToken():""},Bh=t=>{const e=(t||"").toLowerCase().trim();if(e==="tr"||e==="turkish"||e==="turkce"||e==="trke")return"tr";if(e==="en"||e==="english"||e==="ingilizce")return"en"},xp=t=>({title:t.title,author:t.author,publisher:t.publisher,isbn:t.isbn,translator:t.translator,tags:t.tags,summary:t.summaryText||t.generalNotes||t.summary||"",publishedDate:t.publicationYear?String(t.publicationYear):t.publishedDate||"",url:t.url,coverUrl:t.coverUrl??null,pageCount:t.pageCount||void 0,contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved,sourceLanguageHint:Bh(t.sourceLanguageHint)}),bp=(t,e)=>{const n=(e.content_language_resolved||e.contentLanguageResolved||"").toString().toLowerCase(),r=n==="tr"||n==="en"?n:t.contentLanguageResolved,s=Number(e.language_decision_confidence??e.languageDecisionConfidence??t.languageDecisionConfidence??NaN),a=Number.isFinite(s)?s:t.languageDecisionConfidence;return{...t,summaryText:e.summary&&e.summary.trim().length>0?e.summary:t.summaryText,tags:e.tags&&e.tags.length>0?e.tags:t.tags,publisher:e.publisher||t.publisher,isbn:e.isbn||t.isbn,author:e.author||t.author,translator:e.translator||t.translator,publicationYear:e.publishedDate?String(Number(e.publishedDate)||t.publicationYear||""):t.publicationYear,coverUrl:e.coverUrl??t.coverUrl,pageCount:e.pageCount||t.pageCount||void 0,contentLanguageMode:e.contentLanguageMode||t.contentLanguageMode||"AUTO",contentLanguageResolved:r,sourceLanguageHint:Bh(e.sourceLanguageHint||t.sourceLanguageHint),languageDecisionReason:e.language_decision_reason||e.languageDecisionReason||t.languageDecisionReason,languageDecisionConfidence:a}},NV=async t=>{if(!t.trim())return[];const e=[];try{const n=`https://api.crossref.org/works?query=${encodeURIComponent(t)}&rows=5&select=title,author,publisher,published,DOI,abstract,URL`,s=await fetch(n).then(a=>a.ok?a.json():null).then(a=>{var l;return(l=a==null?void 0:a.message)!=null&&l.items?a.message.items.map(c=>{var d,p,m,g,b,v,w,C,k;return{title:Array.isArray(c.title)?c.title[0]:c.title||"",author:(p=(d=c.author)==null?void 0:d[0])!=null&&p.family?`${c.author[0].given||""} ${c.author[0].family}`.trim():((g=(m=c.author)==null?void 0:m[0])==null?void 0:g.name)||"Unknown",publisher:c.publisher||((b=c["container-title"])==null?void 0:b[0])||"",isbn:"",translator:"",tags:c.subject||[],summary:c.abstract||`DOI: ${c.DOI||""}`,publishedDate:((k=(C=(w=(v=c.published)==null?void 0:v["date-parts"])==null?void 0:w[0])==null?void 0:C[0])==null?void 0:k.toString())||"",url:c.URL||(c.DOI?`https://doi.org/${c.DOI}`:""),coverUrl:null}}):[]}).catch(()=>[]);return e.push(...s),e}catch(n){return console.error("Article search error:",n),[]}},J5=async(t,e)=>{const n=t.trim();if(!n)return[];if(e==="BOOK"){const{searchBooks:r}=await tl(async()=>{const{searchBooks:a}=await import("./bookSearchService-CDC4-bV9.js");return{searchBooks:a}},[]),s=await r(n);if(s.results.length>0)return console.log(` Results from bookSearchService (${s.source}, cached: ${s.cached})`),s.results}if(e==="ARTICLE"){const r=await NV(n);if(r.length>0)return console.log(" Results from CrossRef (fast)"),r}try{const r=await Cl(),s=await fetch(`${nt}/api/ai/search-resources`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({query:n,type:e})});if(!s.ok){const l=await s.json();throw new Error(l.detail||"Search failed")}return(await s.json()).results.map(l=>({...l,coverUrl:null,sourceLanguageHint:Bh(l.sourceLanguageHint||l.source_language_hint),contentLanguageResolved:Bh(l.contentLanguageResolved||l.content_language_resolved)}))}catch(r){return console.error("Error searching with Gemini (Backend):",r),[]}},X5=async t=>{if(t.length===0)return null;try{const e=await Cl(),n=await fetch(`${nt}/api/ai/analyze-highlights`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({highlights:t})});return n.ok&&(await n.json()).summary||null}catch(e){return console.error("Gemini error (Backend):",e),null}},by=async t=>{if(!t)return[];try{const e=await Cl(),n=await fetch(`${nt}/api/ai/generate-tags`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({note_content:t})});return n.ok?(await n.json()).tags||[]:[]}catch(e){return console.error("Gemini tag generation error (Backend):",e),[]}},T0=async(t,e)=>{var l,c;const n=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${t}&maxResults=1`,{signal:e});if(!n.ok)throw new Error(`Google Books Error: ${n.status}`);const s=(l=(await n.json()).items)==null?void 0:l[0],a=(c=s==null?void 0:s.volumeInfo)==null?void 0:c.imageLinks;if(a!=null&&a.thumbnail||a!=null&&a.smallThumbnail){let d=a.thumbnail||a.smallThumbnail;return d=d.replace(/^http:\/\//i,"https://").replace("&edge=curl",""),d}throw new Error("No cover in Google Books result")},TV=async(t,e,n,r)=>{var c;if(n){const p=`https://covers.openlibrary.org/b/isbn/${n.replace(/[^0-9X]/gi,"")}-L.jpg`;if((await fetch(p,{method:"HEAD",signal:r})).ok)return console.log(" Cover found via OpenLibrary ISBN"),p}const s=e?`${t} ${e}`:t,a=`https://openlibrary.org/search.json?q=${encodeURIComponent(s)}&limit=1`,l=await fetch(a,{signal:r});if(l.ok){const p=(c=(await l.json()).docs)==null?void 0:c[0];if(p!=null&&p.cover_i){const m=`https://covers.openlibrary.org/b/id/${p.cover_i}-L.jpg`;return console.log(" Cover found via OpenLibrary search"),m}}throw new Error("No cover found in OpenLibrary")},AV=async(t,e,n)=>{try{const r=await Cl(),s=new AbortController,a=setTimeout(()=>s.abort(),3e4),l=await fetch(`${nt}/api/ai/verify-cover`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({title:t,author:e,isbn:n}),signal:s.signal});return clearTimeout(a),l.ok&&(await l.json()).url||null}catch(r){return r.name==="AbortError"?console.warn("AI Cover Verification timed out"):console.error("AI cover verification error (Backend):",r),null}},MV=async(t,e,n)=>{const r=n?n.replace(/[^0-9X]/gi,""):"",s=new AbortController,a=s.signal,l=[];if(r&&l.push(T0(`isbn:${r}`,a)),t&&e){const c=`intitle:${encodeURIComponent(t)}+inauthor:${encodeURIComponent(e)}`;l.push(T0(c,a))}l.push(TV(t,e,r,a)),t&&!e&&l.push(T0(`intitle:${encodeURIComponent(t)}`,a));try{const c=await Promise.any(l);return s.abort(),c}catch{console.warn("Fast cover fetch failed (all sources). Falling back to AI...");const d=await AV(t,e,n);if(d)return console.log(" Cover found via AI verification"),d}return console.log(" No verified cover found"),null},yy=async(t,e)=>{if(!((e==null?void 0:e.forceRegenerate)||Q5(t)))return t;try{const r=await Cl(),s={...t,content_language_mode:t.contentLanguageMode||"AUTO",source_language_hint:t.sourceLanguageHint||void 0,force_regenerate:!!(e!=null&&e.forceRegenerate)},a=await fetch(`${nt}/api/ai/enrich-book`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(s)});if(!a.ok){const c=await a.text();return console.error(`Enrichment failed with status ${a.status}: ${c}`),t}return await a.json()}catch(r){return console.error("Enrich error (Backend):",r),t}},Q5=t=>{const e=!t.summary||t.summary.trim().length<40,n=!t.tags||t.tags.length<2,r=(t.contentLanguageMode||"AUTO").toUpperCase(),s=(t.contentLanguageResolved||"").toLowerCase(),a=r==="TR"&&s!=="tr"||r==="EN"&&s!=="en"||!!t.sourceLanguageHint&&!s;return e||n||a},Z5=async t=>{if(t.length===0)return[];try{const e=await Cl(),n=await fetch(`${nt}/api/ai/enrich-batch`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({books:t})});if(!n.ok||!n.body)return console.error("Batch response failed"),t;const r=n.body.getReader(),s=new TextDecoder,a=[];let l="";for(;;){const{value:c,done:d}=await r.read();if(d)break;const p=s.decode(c,{stream:!0});l+=p;const m=l.split(`
`);l=m.pop()||"";for(const g of m)if(g.trim())try{const b=JSON.parse(g);a.push(b)}catch(b){console.error("Error parsing NDJSON line:",b)}}if(l.trim())try{const c=JSON.parse(l);a.push(c)}catch(c){console.error("Error parsing final buffer:",c)}return a.length>0?a:t}catch(e){return console.error("Batch enrich error (Backend):",e),t}},bS=Object.freeze(Object.defineProperty({__proto__:null,analyzeHighlightsAI:X5,enrichBookWithAI:yy,enrichBooksBatch:Z5,fetchBookCover:MV,generateTagsForNote:by,libraryItemToDraft:xp,mergeEnrichedDraftIntoItem:bp,needsBookEnrichment:Q5,searchResourcesAI:J5},Symbol.toStringTag,{value:"Module"}));var jV="firebase",OV="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xo(jV,OV,"app");const _V={apiKey:"AIzaSyDwvjdmQGhwIgAKgaVmOkOnFdMgzaJ4heA",authDomain:"tomehub.firebaseapp.com",projectId:"tomehub",storageBucket:"tomehub.firebasestorage.app",messagingSenderId:"407093539608",appId:"1:407093539608:web:dfd1e04346b49060d2246d"},RV=m5(_V),jc=xy(RV),eM=new Fs,tM=Object.freeze(Object.defineProperty({__proto__:null,auth:jc,googleProvider:eM},Symbol.toStringTag,{value:"Module"})),nM=E.createContext(void 0),DV=({children:t})=>{const[e,n]=E.useState(null),[r,s]=E.useState(!0);E.useEffect(()=>{L$(jc).then(p=>{p&&console.log("Successfully signed in with redirect")}).catch(p=>{console.error("Redirect login error:",p)});const d=o$(jc,p=>{n(p),s(!1)});return()=>d()},[]);const c={user:e,loading:r,loginWithGoogle:async()=>{try{await A$(jc,eM)}catch(d){console.error("Login with Google failed:",d),d.code==="auth/popup-blocked"?alert("Giri penceresi engellendi. Ltfen Safari veya Chrome gibi bir taraycda an veya pop-uplara izin verin."):d.code==="auth/cancelled-popup-request"||alert("Giri hatas: "+(d.message||"Bilinmeyen bir hata olutu."))}},logout:async()=>{await l$(jc)}};return h.jsx(nM.Provider,{value:c,children:t})},yp=()=>{const t=E.useContext(nM);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},rM=t=>{const e=(t||"").trim().toUpperCase();return e==="NOTE"||e==="PERSONAL"?"PERSONAL_NOTE":e==="NOTES"?"HIGHLIGHT":e==="INSIGHTS"?"INSIGHT":e||"PERSONAL_NOTE"};async function LV(t,e,n="STANDARD",r,s="AUTO",a){if(!e)throw new Error("User must be authenticated to search");const l=await Rt(`${nt}/api/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,firebase_uid:e,mode:n,book_id:r,context_book_id:a,scope_mode:s})});if(!l.ok){const c=await l.json();throw new Error(c.details||c.error||"Search failed")}return l.json()}async function IV(t,e,n=null,r="EXPLORER",s=null,a=20,l="AUTO",c=null,d=null){if(!e)throw new Error("User must be authenticated to chat");const p=await Rt(`${nt}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,firebase_uid:e,session_id:n,mode:r,resource_type:s,scope_mode:l,book_id:c,context_book_id:d,limit:a})});if(!p.ok){const m=await p.json();throw new Error(m.details||m.error||"Chat failed")}return p.json()}async function sM(t,e,n,r,s,a){if(!r)throw new Error("User must be authenticated to ingest documents");const l=new FormData;l.append("file",t),l.append("title",e),l.append("author",n),l.append("firebase_uid",r),s&&l.append("book_id",s),a&&l.append("tags",a);const c=await Rt(`${nt}/api/ingest`,{method:"POST",body:l});if(!c.ok){const d=await c.json();throw new Error(d.details||d.error||"Ingestion failed")}return c.json()}async function zV(t){const e=await Rt(`${nt}/api/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.details||n.error||"Feedback failed")}return e.json()}async function BV(t,e,n){if(!e)throw new Error("User must be authenticated to fetch ingestion status");const r=new URLSearchParams;r.set("firebase_uid",e),n&&n.trim()&&r.set("title",n.trim());const s=await Rt(`${nt}/api/books/${encodeURIComponent(t)}/ingestion-status?${r.toString()}`,{method:"GET",headers:{"Content-Type":"application/json","X-Firebase-UID":e}});if(!s.ok){const a=await s.json();throw new Error(a.details||a.error||"Failed to fetch ingestion status")}return s.json()}async function PV(t){const e=new FormData;e.append("file",t);const n=await Rt(`${nt}/api/extract-metadata`,{method:"POST",body:e});if(!n.ok){const r=await n.json();throw new Error(r.error||"Metadata extraction failed")}return n.json()}async function iM(t,e,n,r,s,a){const l=rM(r),c=await Rt(`${nt}/api/add-item`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,title:e,author:n,type:l,firebase_uid:s,...a})});if(!c.ok)throw new Error("Failed to add item");return c.json()}async function HV(t,e){const n=t.map(s=>({...s,type:rM(s.type)})),r=await Rt(`${nt}/api/migrate_bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n,firebase_uid:e})});if(!r.ok)throw new Error("Failed to migrate batch");return r.json()}async function aM(t,e,n,r,s){const a=s.map(c=>({...c,type:Jh(c.type)})),l=await Rt(`${nt}/api/books/${encodeURIComponent(e)}/sync-highlights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,title:n,author:r,highlights:a})});if(!l.ok){const c=await l.text();throw new Error(c||"Failed to sync highlights")}return l.json()}async function FV(t,e,n){const r=await Rt(`${nt}/api/notes/${encodeURIComponent(e)}/sync-personal-note`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t,...n})});if(!r.ok){const s=await r.text();throw new Error(s||"Failed to sync personal note")}return r.json()}async function yS(t,e){const n=await Rt(`${nt}/api/resources/${encodeURIComponent(e)}/purge`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebase_uid:t})});if(!n.ok)throw new Error("Failed to purge resource content");return n.json()}async function UV(t,e,n,r=50,s=0){const a=new URL(`${nt}/api/analytics/concordance`);a.searchParams.append("book_id",e),a.searchParams.append("term",n),a.searchParams.append("limit",r.toString()),a.searchParams.append("offset",s.toString()),a.searchParams.append("firebase_uid",t);const l=await Rt(a.toString(),{headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error("Failed to fetch concordance");return l.json()}async function $V(t,e,n){const r=new URL(`${nt}/api/analytics/distribution`);r.searchParams.append("book_id",e),r.searchParams.append("term",n),r.searchParams.append("firebase_uid",t);const s=await Rt(r.toString(),{headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch distribution");return s.json()}async function VV(t,e=0,n=100){if(!t)throw new Error("User must be authenticated for realtime polling");const r=new URL(`${nt}/api/realtime/poll`);r.searchParams.append("firebase_uid",t),r.searchParams.append("since_ms",String(Math.max(0,Math.floor(e||0)))),r.searchParams.append("limit",String(Math.min(300,Math.max(1,Math.floor(n||100)))));const s=await Rt(r.toString(),{headers:{"Content-Type":"application/json"}});if(s.status===404)throw new Error("REALTIME_ENDPOINT_NOT_FOUND");if(!s.ok){let a="Realtime polling failed";try{const l=await s.json();a=l.details||l.error||a}catch{}throw new Error(a)}return s.json()}const qV=({initialData:t,initialType:e,noteDefaults:n,onSave:r,onCancel:s})=>{const[a,l]=E.useState(t||e==="WEBSITE"||e==="PERSONAL_NOTE"?"edit":"search"),[c,d]=E.useState(""),[p,m]=E.useState([]),[g,b]=E.useState(!1),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(!1),[_,P]=E.useState(!1),[I,q]=E.useState(!1),[j,F]=E.useState(null),{user:G}=yp(),[te,he]=E.useState({title:"",author:"",translator:"",publisher:"",publicationYear:"",isbn:"",url:"",code:"",status:"On Shelf",readingStatus:"To Read",tags:"",generalNotes:"",summaryText:"",coverUrl:"",lentToName:"",lentDate:"",addedAt:new Date().toISOString().split("T")[0],pageCount:"",contentLanguageMode:"AUTO",contentLanguageResolved:"",sourceLanguageHint:"",personalNoteCategory:"DAILY",personalFolderId:"",folderPath:""});E.useEffect(()=>{var L,ae,$;t?he({title:t.title,author:t.author,translator:t.translator||"",publisher:t.publisher||"",publicationYear:t.publicationYear||"",isbn:t.isbn||"",url:t.url||"",code:t.code||"",status:t.status,readingStatus:t.readingStatus,tags:t.tags.join(", "),generalNotes:t.generalNotes||"",summaryText:t.summaryText||"",coverUrl:t.coverUrl||"",lentToName:((L=t.lentInfo)==null?void 0:L.borrowerName)||"",lentDate:((ae=t.lentInfo)==null?void 0:ae.lentDate)||"",addedAt:new Date(t.addedAt).toISOString().split("T")[0],pageCount:(($=t.pageCount)==null?void 0:$.toString())||"",contentLanguageMode:t.contentLanguageMode||"AUTO",contentLanguageResolved:t.contentLanguageResolved||"",sourceLanguageHint:t.sourceLanguageHint||"",personalNoteCategory:t.personalNoteCategory||"DAILY",personalFolderId:t.personalFolderId||"",folderPath:t.folderPath||""}):e==="PERSONAL_NOTE"&&he(ne=>({...ne,author:"Self",status:"On Shelf",readingStatus:"Finished",personalNoteCategory:(n==null?void 0:n.personalNoteCategory)||"DAILY",personalFolderId:(n==null?void 0:n.personalFolderId)||"",folderPath:(n==null?void 0:n.folderPath)||""}))},[t,e,n]);const Ne=async L=>{if(L.preventDefault(),!!c.trim()){b(!0),m([]);try{const ae=await J5(c,e);m(ae),e==="BOOK"&&console.log(` Search completed for book: "${c}"`)}catch(ae){console.error("Search failed:",ae)}finally{b(!1)}}},Se=async()=>{const L=al(te.generalNotes);if(!L)return;M(!0);const ae=await by(L);ae.length>0&&he($=>({...$,tags:ae.join(", ")})),M(!1)},Te=async(L,ae,$)=>{w(!0);try{const{fetchBookCover:ne}=await tl(async()=>{const{fetchBookCover:Oe}=await Promise.resolve().then(()=>bS);return{fetchBookCover:Oe}},void 0),ie=await ne(L,ae,$);ie&&he(Oe=>({...Oe,coverUrl:ie}))}catch(ne){console.error("Cover fetch failed:",ne)}finally{w(!1)}},pe=async(L,ae=!1)=>{k(!0);try{const{enrichBookWithAI:$}=await tl(async()=>{const{enrichBookWithAI:ie}=await Promise.resolve().then(()=>bS);return{enrichBookWithAI:ie}},void 0),ne=await $({...L,contentLanguageMode:te.contentLanguageMode,sourceLanguageHint:te.sourceLanguageHint||L.sourceLanguageHint},{forceRegenerate:ae});he(ie=>({...ie,tags:ne.tags&&ne.tags.length>0?ne.tags.join(", "):ie.tags,summaryText:ne.summary&&ne.summary.length>0?ne.summary:ie.summaryText,publisher:ne.publisher||ie.publisher,publicationYear:ne.publishedDate?String(ne.publishedDate):ie.publicationYear,isbn:ne.isbn||ie.isbn,pageCount:ne.pageCount?String(ne.pageCount):ie.pageCount,translator:ne.translator||ie.translator,contentLanguageResolved:ne.content_language_resolved||ne.contentLanguageResolved||ie.contentLanguageResolved||""}))}catch($){console.error("Enrichment failed",$)}finally{k(!1)}},U=async L=>{he(ae=>{var $;return{...ae,title:L.title,author:L.author,publisher:L.publisher||"",isbn:L.isbn||"",publicationYear:L.publishedDate||"",translator:L.translator||"",tags:L.tags?L.tags.join(", "):"",summaryText:L.summary||"",coverUrl:L.coverUrl||"",url:(e==="WEBSITE"||e==="ARTICLE")&&L.url||"",pageCount:(($=L.pageCount)==null?void 0:$.toString())||"",contentLanguageMode:L.contentLanguageMode||te.contentLanguageMode||"AUTO",contentLanguageResolved:(L.contentLanguageResolved||"").toLowerCase()==="tr"?"tr":(L.contentLanguageResolved||"").toLowerCase()==="en"?"en":"",sourceLanguageHint:(L.sourceLanguageHint||"").toLowerCase()==="tr"?"tr":(L.sourceLanguageHint||"").toLowerCase()==="en"?"en":""}}),l("edit"),e==="BOOK"&&(Te(L.title,L.author,L.isbn||""),(!L.summary||!L.tags||L.tags.length===0||L.sourceLanguageHint)&&pe(L))},Z=L=>{const{name:ae,value:$}=L.target;he(ne=>ae==="contentLanguageMode"?{...ne,[ae]:$,contentLanguageResolved:""}:{...ne,[ae]:$})},K=async L=>{if(L.target.files&&L.target.files[0]){const ae=L.target.files[0];if(ae.type==="application/pdf"){F(ae),q(!0);try{const $=await PV(ae);he(ne=>{var ie;return{...ne,title:ne.title||$.title||"",author:ne.author||$.author||"",pageCount:ne.pageCount||((ie=$.page_count)==null?void 0:ie.toString())||""}}),!te.title&&$.title&&e==="BOOK"&&!te.coverUrl&&Te($.title,$.author||"","")}catch($){console.error("Failed to extract PDF metadata:",$)}finally{q(!1)}}else alert("Please select a PDF file"),L.target.value=""}},z=async L=>{L.preventDefault();const ae=t?t.id:Date.now().toString();if(j&&G){P(!0);try{await sM(j,te.title,te.author,G.uid,ae,te.tags)}catch(ie){console.error("PDF Ingestion failed:",ie)}finally{P(!1)}}const $=e==="BOOK"&&te.status==="Lent Out"&&te.lentToName?{borrowerName:te.lentToName,lentDate:te.lentDate||new Date().toISOString().split("T")[0]}:void 0,ne=te.addedAt?new Date(te.addedAt).getTime():Date.now();r({id:ae,type:e,title:te.title,author:te.author,translator:te.translator,publisher:te.publisher,publicationYear:te.publicationYear,isbn:te.isbn,url:e==="WEBSITE"||e==="ARTICLE"?te.url:"",code:te.code,status:te.status,readingStatus:te.readingStatus,tags:te.tags.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0),generalNotes:R?te.generalNotes:"",summaryText:R?"":te.summaryText,contentLanguageMode:te.contentLanguageMode,contentLanguageResolved:te.contentLanguageResolved||void 0,sourceLanguageHint:te.sourceLanguageHint||void 0,personalNoteCategory:R?te.personalNoteCategory:void 0,personalFolderId:R&&te.personalFolderId.trim()||void 0,folderPath:R&&te.folderPath.trim()||void 0,coverUrl:te.coverUrl,lentInfo:$,addedAt:ne,pageCount:te.pageCount?parseInt(te.pageCount):void 0})},H=()=>{switch(e){case"ARTICLE":return h.jsx(xu,{className:"text-[#CC561E]",size:24});case"WEBSITE":return h.jsx(Vh,{className:"text-[#CC561E]",size:24});case"PERSONAL_NOTE":return h.jsx(Mf,{className:"text-[#CC561E]",size:24});default:return h.jsx(sb,{className:"text-[#CC561E]",size:24})}},A=()=>{if(t)return"Edit Details";switch(e){case"ARTICLE":return"New Article";case"WEBSITE":return"New Website Resource";case"PERSONAL_NOTE":return"New Note";default:return"New Book"}},R=e==="PERSONAL_NOTE",W=R?"text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300",oe=R?"text-slate-800 dark:text-slate-200":"text-slate-700 dark:text-slate-300",be=R?"text-slate-700 dark:text-slate-400":"text-slate-500 dark:text-slate-400";return h.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-xl shadow-2xl w-full overflow-hidden flex flex-col ${R?"max-w-3xl max-h-[94vh]":"max-w-2xl max-h-[90vh]"}`,children:[h.jsxs("div",{className:`${R?"p-4":"p-5"} border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white dark:bg-slate-900 z-10`,children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:a==="search"?h.jsxs(h.Fragment,{children:[h.jsx(Us,{className:"text-[#CC561E]",size:24}),"Find ",e==="ARTICLE"?"Article":"Book"]}):h.jsxs(h.Fragment,{children:[H(),A()]})}),h.jsx("button",{onClick:s,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:h.jsx(ds,{size:24})})]}),a==="search"&&h.jsxs("div",{className:"p-6 flex flex-col h-full overflow-y-auto",children:[h.jsxs("form",{onSubmit:Ne,className:"relative mb-4",children:[h.jsx("input",{autoFocus:!0,type:"text",value:c,onChange:L=>d(L.target.value),placeholder:e==="ARTICLE"?"Enter Title, DOI, Author...":"Enter Title, ISBN, Author...",className:"w-full pl-5 pr-14 py-4 text-lg border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:border-[#CC561E] dark:focus:border-[#CC561E] focus:ring-4 focus:ring-[#CC561E]/10 outline-none transition-all placeholder:text-slate-400 dark:placeholder:text-slate-500 bg-white dark:bg-slate-950 text-slate-900 dark:text-white"}),h.jsx("button",{type:"submit",disabled:g||!c.trim(),className:"absolute right-3 top-1/2 -translate-y-1/2 bg-[#CC561E] text-white p-2 rounded-lg hover:bg-[#b34b1a] disabled:opacity-50 disabled:hover:bg-[#CC561E] transition-colors",children:g?h.jsx(nn,{className:"animate-spin",size:20}):h.jsx(Us,{size:20})})]}),h.jsx("div",{className:"space-y-3 flex-1 mt-6",children:p.length>0?h.jsxs(h.Fragment,{children:[h.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"Matches Found"}),p.map((L,ae)=>h.jsxs("button",{onClick:()=>U(L),className:"w-full text-left p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 dark:hover:border-[#CC561E]/50 hover:shadow-md hover:bg-[rgba(204,86,30,0.05)] dark:hover:bg-[rgba(204,86,30,0.1)] transition-all group flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:L.title}),h.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:L.author}),h.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-slate-400",children:[L.publisher&&h.jsx("span",{children:L.publisher}),L.publishedDate&&h.jsx("span",{children:L.publishedDate}),L.isbn&&h.jsxs("span",{className:"font-mono tracking-tight",children:["ISBN: ",L.isbn]})]})]}),h.jsx(mE,{className:"text-slate-300 dark:text-slate-600 group-hover:text-[#CC561E]",size:20})]},ae))]}):!g&&c&&h.jsxs("div",{className:"text-center py-10 text-slate-500",children:[h.jsxs("p",{children:['No AI results found matching "',c,'".']}),h.jsx("p",{className:"text-sm mt-2",children:"Try entering details manually."})]})}),h.jsx("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:h.jsxs("button",{onClick:()=>l("edit"),className:"text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] text-sm font-medium flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[h.jsx("span",{children:"Don't see it? Enter details manually"}),h.jsx(dR,{size:16})]})})]}),a==="edit"&&h.jsxs("form",{onSubmit:z,className:`${R?"p-4 md:p-5":"p-6"} overflow-y-auto flex-1`,children:[h.jsxs("div",{className:R?"space-y-3":"space-y-5",children:[h.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 ${R?"gap-3":"gap-4"}`,children:[h.jsxs("div",{className:"md:col-span-2",children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Title *"}),h.jsx("input",{required:!0,name:"title",value:te.title,onChange:Z,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${R?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:R?"Note Title":e==="WEBSITE"?"Page Title or Site Name":"e.g. The Stranger"})]}),!R&&h.jsxs("div",{className:e==="WEBSITE"?"md:col-span-2":"",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="WEBSITE"?"Author / Organization":"Author *"}),h.jsx("input",{required:e!=="WEBSITE",name:"author",value:te.author,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Albert Camus"})]}),R&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{children:[h.jsxs("label",{className:`block text-[13px] font-medium mb-1 flex items-center gap-1 ${oe}`,children:[h.jsx(nl,{size:14,className:"text-slate-400"}),"Date"]}),h.jsx("input",{type:"date",name:"addedAt",value:te.addedAt,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:`block text-[13px] font-medium mb-1 ${oe}`,children:"Category"}),h.jsxs("select",{name:"personalNoteCategory",value:te.personalNoteCategory,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"PRIVATE",children:"Private"}),h.jsx("option",{value:"DAILY",children:"Daily"}),h.jsx("option",{value:"IDEAS",children:"Ideas"})]}),h.jsx("p",{className:`mt-0.5 text-[10px] leading-tight ${be}`,children:"Private/Daily sadece local aramada kalir. Ideas AI aramalara da katilir."})]})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Translator"}),h.jsx("input",{name:"translator",value:te.translator,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Content Language"}),h.jsxs("select",{name:"contentLanguageMode",value:te.contentLanguageMode,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"AUTO",children:"AUTO (Recommended)"}),h.jsx("option",{value:"TR",children:"TR"}),h.jsx("option",{value:"EN",children:"EN"})]}),(te.contentLanguageResolved||te.sourceLanguageHint)&&h.jsxs("p",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:["Resolved: ",te.contentLanguageResolved||"-"," | Source Hint: ",te.sourceLanguageHint||"-"]})]})]}),!R&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e!=="WEBSITE"&&h.jsxs("div",{className:e==="ARTICLE"?"md:col-span-2":"",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:e==="ARTICLE"?"Journal / Publisher":"Publisher"}),h.jsx("input",{name:"publisher",value:te.publisher,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ISBN"}),h.jsx("input",{name:"isbn",value:te.isbn,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] font-mono bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="ARTICLE"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Year"}),h.jsx("input",{name:"publicationYear",value:te.publicationYear,onChange:Z,placeholder:"YYYY",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Page Count"}),h.jsx("input",{type:"number",name:"pageCount",value:te.pageCount,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. 250"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Shelf Code"}),h.jsx("input",{name:"code",value:te.code,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. A-12"})]})]}),(e==="WEBSITE"||e==="ARTICLE")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"URL"}),h.jsx("input",{name:"url",value:te.url,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-[#CC561E] dark:text-[#f3a47b] bg-white dark:bg-slate-950",placeholder:"https://..."})]}),R&&h.jsxs("div",{children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Sub-file (optional)"}),h.jsx("input",{name:"folderPath",value:te.folderPath,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:"e.g. Sermon Ideas or Journal-2026-Week1"})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1 flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(T2,{size:16}),"Cover Image URL"]})}),h.jsxs("div",{className:"flex gap-4 items-start",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx("input",{name:"coverUrl",value:te.coverUrl,onChange:Z,placeholder:"Paste image URL or Auto-Find ->",className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg pl-3 pr-24 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] text-sm text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-950"}),h.jsxs("button",{type:"button",onClick:()=>Te(te.title,te.author,te.isbn),disabled:v||!te.title&&!te.isbn,className:"absolute right-1 top-1 bottom-1 px-3 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] hover:bg-[rgba(204,86,30,0.15)] dark:hover:bg-[rgba(204,86,30,0.25)] text-[#CC561E] dark:text-[#f3a47b] rounded text-xs font-semibold flex items-center gap-1 transition-colors",title:"Auto-find cover based on Title/ISBN",children:[v?h.jsx(nn,{size:14,className:"animate-spin"}):h.jsx(BR,{size:14}),"Auto-Find"]})]}),h.jsxs("div",{className:"w-16 h-20 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center justify-center overflow-hidden flex-shrink-0 shadow-sm relative group",children:[te.coverUrl?h.jsx("img",{src:te.coverUrl,alt:"Preview",className:"w-full h-full object-cover",onError:L=>L.currentTarget.style.display="none"}):h.jsx(T2,{className:"text-slate-300",size:20}),v&&h.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center backdrop-blur-[1px]",children:h.jsx(nn,{size:16,className:"animate-spin text-[#CC561E]"})}),!v&&!te.coverUrl&&h.jsx("div",{className:"absolute inset-0 bg-black/5 hidden group-hover:flex items-center justify-center",children:h.jsx(Us,{size:12,className:"text-slate-500"})})]})]}),h.jsx("div",{className:"mt-1 flex justify-end",children:h.jsxs("a",{href:`https://www.google.com/search?tbm=isch&q=book+cover+${encodeURIComponent(te.title+" "+te.author)}`,target:"_blank",rel:"noreferrer",className:"text-xs text-slate-400 dark:text-slate-500 hover:text-[#CC561E] dark:hover:text-[#f3a47b] hover:underline flex items-center gap-1",children:["Manual Search on Google Images ",h.jsx(Us,{size:10})]})})]}),(e==="BOOK"||e==="ARTICLE")&&h.jsxs("div",{className:"bg-[rgba(204,86,30,0.05)] dark:bg-[rgba(204,86,30,0.1)] p-4 rounded-xl border border-[#CC561E]/10 dark:border-[#CC561E]/20",children:[h.jsxs("label",{className:"block text-sm font-semibold text-[#CC561E] dark:text-[#f3a47b] mb-2 flex items-center gap-2",children:[h.jsx(Of,{size:16}),"Upload PDF Document to Library"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:K,className:"flex-1 text-sm text-slate-600 dark:text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[#CC561E] file:text-white hover:file:bg-[#b34b1a] transition-all cursor-pointer"}),j&&h.jsx("button",{type:"button",onClick:()=>F(null),className:"text-red-500 hover:text-red-600 p-2",title:"Remove PDF",children:h.jsx(ds,{size:18})}),I&&h.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[#CC561E] font-medium animate-pulse",children:[h.jsx(nn,{size:14,className:"animate-spin"}),"Verifying metadata..."]})]}),h.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-2",children:"PDF content will be vectorized and added to your searchable AI library."})]})]}),h.jsx("hr",{className:`${R?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),R&&h.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[h.jsx("label",{className:`block text-sm font-medium mb-1 ${W}`,children:"Content"}),h.jsx(s5,{value:te.generalNotes,onChange:L=>he(ae=>({...ae,generalNotes:L})),minHeight:420}),h.jsx("p",{className:`mt-1 text-[10px] ${be}`,children:"Toolbar supports heading, bold, underline, bullet list, numbered list and checklist."})]}),h.jsxs("div",{className:R?"space-y-3":"space-y-5",children:[!R&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Reading Status *"}),h.jsxs("select",{name:"readingStatus",value:te.readingStatus,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"To Read",children:"To Read"}),h.jsx("option",{value:"Reading",children:"Reading"}),h.jsx("option",{value:"Finished",children:"Finished"})]})]}),e==="BOOK"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Inventory Status *"}),h.jsxs("select",{name:"status",value:te.status,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white",children:[h.jsx("option",{value:"On Shelf",children:"On Shelf"}),h.jsx("option",{value:"Lent Out",children:"Lent Out"}),h.jsx("option",{value:"Lost",children:"Lost"})]})]})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("label",{className:`block text-sm font-medium mb-1 flex justify-between ${W}`,children:[h.jsxs("div",{className:"flex items-center gap-2",children:["Tags (comma separated)",C&&h.jsxs("span",{className:"text-xs text-[#CC561E] animate-pulse flex items-center gap-1",children:[h.jsx(Ws,{size:10})," AI Enriching..."]})]}),R&&h.jsxs("button",{type:"button",onClick:Se,disabled:N||!Hf(te.generalNotes),className:"text-xs text-[#CC561E] dark:text-[#f3a47b] hover:text-[#b34b1a] dark:hover:text-white flex items-center gap-1 disabled:opacity-50",children:[N?h.jsx(nn,{size:12,className:"animate-spin"}):h.jsx(Ws,{size:12}),"AI Auto-Tag"]})]}),h.jsx("input",{name:"tags",value:te.tags,onChange:Z,className:`w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 ${R?"py-1.5 text-sm":"py-2"} focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] bg-white dark:bg-slate-950 text-slate-900 dark:text-white`,placeholder:R?"Use AI to generate tags...":"Ideas, Todo, Research"})]}),e==="BOOK"&&te.status==="Lent Out"&&h.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 grid grid-cols-1 md:grid-cols-2 gap-4 animate-in slide-in-from-top-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Lent To (Name) *"}),h.jsx("input",{required:!0,name:"lentToName",value:te.lentToName,onChange:Z,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Date"}),h.jsx("input",{type:"date",name:"lentDate",value:te.lentDate,onChange:Z,className:"w-full border border-amber-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500"})]})]})]}),h.jsx("hr",{className:`${R?"my-3":"my-6"} border-slate-100 dark:border-slate-800`}),!R&&h.jsxs("div",{className:"mb-4 flex-1 flex flex-col",children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Summary"}),h.jsx("textarea",{name:"summaryText",rows:4,value:te.summaryText,onChange:Z,className:"w-full border border-slate-300 dark:border-slate-700 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#CC561E] focus:border-[#CC561E] resize-none leading-relaxed flex-1 bg-white dark:bg-slate-950 text-slate-900 dark:text-white",placeholder:e==="WEBSITE"?"Why did you save this website?":"Your thoughts..."})]}),h.jsxs("div",{className:`flex justify-between items-center ${R?"pt-1":"pt-2"} mt-auto`,children:[!t&&e!=="WEBSITE"&&!R&&h.jsx("button",{type:"button",onClick:()=>l("search"),className:"text-sm text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] underline decoration-[#CC561E]/30 dark:decoration-[#CC561E]/50 hover:decoration-[#CC561E] dark:hover:decoration-[#CC561E]",children:"Back to Search"}),h.jsxs("div",{className:"flex gap-3 ml-auto",children:[h.jsx("button",{type:"button",onClick:s,className:"px-5 py-2 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium",children:"Cancel"}),h.jsx("button",{type:"submit",disabled:_,className:"px-5 py-2 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg shadow-lg shadow-[#CC561E]/20 transition-all font-medium flex items-center gap-2 active:scale-95",children:_?h.jsxs(h.Fragment,{children:[h.jsx(nn,{size:18,className:"animate-spin"}),"Ingesting PDF..."]}):h.jsxs(h.Fragment,{children:["Save ",e==="ARTICLE"?"Article":e==="WEBSITE"?"Website":e==="PERSONAL_NOTE"?"Note":"Book"]})})]})]})]})]})})};var A0={exports:{}},vS;function WV(){return vS||(vS=1,(function(t){var e=(function(n){var r=Object.prototype,s=r.hasOwnProperty,a=Object.defineProperty||function(z,H,A){z[H]=A.value},l,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",p=c.asyncIterator||"@@asyncIterator",m=c.toStringTag||"@@toStringTag";function g(z,H,A){return Object.defineProperty(z,H,{value:A,enumerable:!0,configurable:!0,writable:!0}),z[H]}try{g({},"")}catch{g=function(H,A,R){return H[A]=R}}function b(z,H,A,R){var W=H&&H.prototype instanceof _?H:_,oe=Object.create(W.prototype),be=new U(R||[]);return a(oe,"_invoke",{value:Ne(z,A,be)}),oe}n.wrap=b;function v(z,H,A){try{return{type:"normal",arg:z.call(H,A)}}catch(R){return{type:"throw",arg:R}}}var w="suspendedStart",C="suspendedYield",k="executing",N="completed",M={};function _(){}function P(){}function I(){}var q={};g(q,d,function(){return this});var j=Object.getPrototypeOf,F=j&&j(j(Z([])));F&&F!==r&&s.call(F,d)&&(q=F);var G=I.prototype=_.prototype=Object.create(q);P.prototype=I,a(G,"constructor",{value:I,configurable:!0}),a(I,"constructor",{value:P,configurable:!0}),P.displayName=g(I,m,"GeneratorFunction");function te(z){["next","throw","return"].forEach(function(H){g(z,H,function(A){return this._invoke(H,A)})})}n.isGeneratorFunction=function(z){var H=typeof z=="function"&&z.constructor;return H?H===P||(H.displayName||H.name)==="GeneratorFunction":!1},n.mark=function(z){return Object.setPrototypeOf?Object.setPrototypeOf(z,I):(z.__proto__=I,g(z,m,"GeneratorFunction")),z.prototype=Object.create(G),z},n.awrap=function(z){return{__await:z}};function he(z,H){function A(oe,be,L,ae){var $=v(z[oe],z,be);if($.type==="throw")ae($.arg);else{var ne=$.arg,ie=ne.value;return ie&&typeof ie=="object"&&s.call(ie,"__await")?H.resolve(ie.__await).then(function(Oe){A("next",Oe,L,ae)},function(Oe){A("throw",Oe,L,ae)}):H.resolve(ie).then(function(Oe){ne.value=Oe,L(ne)},function(Oe){return A("throw",Oe,L,ae)})}}var R;function W(oe,be){function L(){return new H(function(ae,$){A(oe,be,ae,$)})}return R=R?R.then(L,L):L()}a(this,"_invoke",{value:W})}te(he.prototype),g(he.prototype,p,function(){return this}),n.AsyncIterator=he,n.async=function(z,H,A,R,W){W===void 0&&(W=Promise);var oe=new he(b(z,H,A,R),W);return n.isGeneratorFunction(H)?oe:oe.next().then(function(be){return be.done?be.value:oe.next()})};function Ne(z,H,A){var R=w;return function(oe,be){if(R===k)throw new Error("Generator is already running");if(R===N){if(oe==="throw")throw be;return K()}for(A.method=oe,A.arg=be;;){var L=A.delegate;if(L){var ae=Se(L,A);if(ae){if(ae===M)continue;return ae}}if(A.method==="next")A.sent=A._sent=A.arg;else if(A.method==="throw"){if(R===w)throw R=N,A.arg;A.dispatchException(A.arg)}else A.method==="return"&&A.abrupt("return",A.arg);R=k;var $=v(z,H,A);if($.type==="normal"){if(R=A.done?N:C,$.arg===M)continue;return{value:$.arg,done:A.done}}else $.type==="throw"&&(R=N,A.method="throw",A.arg=$.arg)}}}function Se(z,H){var A=H.method,R=z.iterator[A];if(R===l)return H.delegate=null,A==="throw"&&z.iterator.return&&(H.method="return",H.arg=l,Se(z,H),H.method==="throw")||A!=="return"&&(H.method="throw",H.arg=new TypeError("The iterator does not provide a '"+A+"' method")),M;var W=v(R,z.iterator,H.arg);if(W.type==="throw")return H.method="throw",H.arg=W.arg,H.delegate=null,M;var oe=W.arg;if(!oe)return H.method="throw",H.arg=new TypeError("iterator result is not an object"),H.delegate=null,M;if(oe.done)H[z.resultName]=oe.value,H.next=z.nextLoc,H.method!=="return"&&(H.method="next",H.arg=l);else return oe;return H.delegate=null,M}te(G),g(G,m,"Generator"),g(G,d,function(){return this}),g(G,"toString",function(){return"[object Generator]"});function Te(z){var H={tryLoc:z[0]};1 in z&&(H.catchLoc=z[1]),2 in z&&(H.finallyLoc=z[2],H.afterLoc=z[3]),this.tryEntries.push(H)}function pe(z){var H=z.completion||{};H.type="normal",delete H.arg,z.completion=H}function U(z){this.tryEntries=[{tryLoc:"root"}],z.forEach(Te,this),this.reset(!0)}n.keys=function(z){var H=Object(z),A=[];for(var R in H)A.push(R);return A.reverse(),function W(){for(;A.length;){var oe=A.pop();if(oe in H)return W.value=oe,W.done=!1,W}return W.done=!0,W}};function Z(z){if(z){var H=z[d];if(H)return H.call(z);if(typeof z.next=="function")return z;if(!isNaN(z.length)){var A=-1,R=function W(){for(;++A<z.length;)if(s.call(z,A))return W.value=z[A],W.done=!1,W;return W.value=l,W.done=!0,W};return R.next=R}}return{next:K}}n.values=Z;function K(){return{value:l,done:!0}}return U.prototype={constructor:U,reset:function(z){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(pe),!z)for(var H in this)H.charAt(0)==="t"&&s.call(this,H)&&!isNaN(+H.slice(1))&&(this[H]=l)},stop:function(){this.done=!0;var z=this.tryEntries[0],H=z.completion;if(H.type==="throw")throw H.arg;return this.rval},dispatchException:function(z){if(this.done)throw z;var H=this;function A(ae,$){return oe.type="throw",oe.arg=z,H.next=ae,$&&(H.method="next",H.arg=l),!!$}for(var R=this.tryEntries.length-1;R>=0;--R){var W=this.tryEntries[R],oe=W.completion;if(W.tryLoc==="root")return A("end");if(W.tryLoc<=this.prev){var be=s.call(W,"catchLoc"),L=s.call(W,"finallyLoc");if(be&&L){if(this.prev<W.catchLoc)return A(W.catchLoc,!0);if(this.prev<W.finallyLoc)return A(W.finallyLoc)}else if(be){if(this.prev<W.catchLoc)return A(W.catchLoc,!0)}else if(L){if(this.prev<W.finallyLoc)return A(W.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(z,H){for(var A=this.tryEntries.length-1;A>=0;--A){var R=this.tryEntries[A];if(R.tryLoc<=this.prev&&s.call(R,"finallyLoc")&&this.prev<R.finallyLoc){var W=R;break}}W&&(z==="break"||z==="continue")&&W.tryLoc<=H&&H<=W.finallyLoc&&(W=null);var oe=W?W.completion:{};return oe.type=z,oe.arg=H,W?(this.method="next",this.next=W.finallyLoc,M):this.complete(oe)},complete:function(z,H){if(z.type==="throw")throw z.arg;return z.type==="break"||z.type==="continue"?this.next=z.arg:z.type==="return"?(this.rval=this.arg=z.arg,this.method="return",this.next="end"):z.type==="normal"&&H&&(this.next=H),M},finish:function(z){for(var H=this.tryEntries.length-1;H>=0;--H){var A=this.tryEntries[H];if(A.finallyLoc===z)return this.complete(A.completion,A.afterLoc),pe(A),M}},catch:function(z){for(var H=this.tryEntries.length-1;H>=0;--H){var A=this.tryEntries[H];if(A.tryLoc===z){var R=A.completion;if(R.type==="throw"){var W=R.arg;pe(A)}return W}}throw new Error("illegal catch attempt")},delegateYield:function(z,H,A){return this.delegate={iterator:Z(z),resultName:H,nextLoc:A},this.method==="next"&&(this.arg=l),M}},n})(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(A0)),A0.exports}var M0,wS;function vy(){return wS||(wS=1,M0=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),M0}var j0,kS;function oM(){if(kS)return j0;kS=1;const t=vy();let e=0;return j0=({id:n,action:r,payload:s={}})=>{let a=n;return typeof a>"u"&&(a=t("Job",e),e+=1),{id:a,action:r,payload:s}},j0}var Sc={},CS;function wy(){if(CS)return Sc;CS=1;let t=!1;return Sc.logging=t,Sc.setLogging=e=>{t=e},Sc.log=(...e)=>t?console.log.apply(this,e):null,Sc}var O0,SS;function GV(){if(SS)return O0;SS=1;const t=oM(),{log:e}=wy(),n=vy();let r=0;return O0=()=>{const s=n("Scheduler",r),a={},l={};let c=[];r+=1;const d=()=>c.length,p=()=>Object.keys(a).length,m=()=>{if(c.length!==0){const C=Object.keys(a);for(let k=0;k<C.length;k+=1)if(typeof l[C[k]]>"u"){c[0](a[C[k]]);break}}},g=(C,k)=>new Promise((N,M)=>{const _=t({action:C,payload:k});c.push(async P=>{c.shift(),l[P.id]=_;try{N(await P[C].apply(this,[...k,_.id]))}catch(I){M(I)}finally{delete l[P.id],m()}}),e(`[${s}]: Add ${_.id} to JobQueue`),e(`[${s}]: JobQueue length=${c.length}`),m()});return{addWorker:C=>(a[C.id]=C,e(`[${s}]: Add ${C.id}`),e(`[${s}]: Number of workers=${p()}`),m(),C.id),addJob:async(C,...k)=>{if(p()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return g(C,k)},terminate:async()=>{Object.keys(a).forEach(async C=>{await a[C].terminate()}),c=[]},getQueueLen:d,getNumWorkers:p}},O0}function KV(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _0,ES;function YV(){return ES||(ES=1,_0=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof KV=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),_0}var R0,NS;function JV(){if(NS)return R0;NS=1;const e=YV()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return R0=n=>{const r={...n};return["corePath","workerPath","langPath"].forEach(s=>{n[s]&&(r[s]=e(r[s]))}),r},R0}var D0,TS;function lM(){return TS||(TS=1,D0={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),D0}const XV="7.0.0",QV={version:XV};var L0,AS;function ZV(){return AS||(AS=1,L0={workerBlobURL:!0,logger:()=>{}}),L0}var I0,MS;function eq(){if(MS)return I0;MS=1;const t=QV.version;return I0={...ZV(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},I0}var z0,jS;function tq(){return jS||(jS=1,z0=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n}),z0}var B0,OS;function nq(){return OS||(OS=1,B0=t=>{t.terminate()}),B0}var P0,_S;function rq(){return _S||(_S=1,P0=(t,e)=>{t.onmessage=({data:n})=>{e(n)}}),P0}var H0,RS;function sq(){return RS||(RS=1,H0=async(t,e)=>{t.postMessage(e)}),H0}var F0,DS;function iq(){if(DS)return F0;DS=1;const t=n=>new Promise((r,s)=>{const a=new FileReader;a.onload=()=>{r(a.result)},a.onerror=({target:{error:{code:l}}})=>{s(Error(`File could not be read! Code=${l}`))},a.readAsArrayBuffer(n)}),e=async n=>{let r=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?r=atob(n.split(",")[1]).split("").map(s=>s.charCodeAt(0)):r=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(r=await e(n.src)),n.tagName==="VIDEO"&&(r=await e(n.poster)),n.tagName==="CANVAS"&&await new Promise(s=>{n.toBlob(async a=>{r=await t(a),s()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const s=await n.convertToBlob();r=await t(s)}else(n instanceof File||n instanceof Blob)&&(r=await t(n));return new Uint8Array(r)};return F0=e,F0}var U0,LS;function aq(){if(LS)return U0;LS=1;const t=eq(),e=tq(),n=nq(),r=rq(),s=sq(),a=iq();return U0={defaultOptions:t,spawnWorker:e,terminateWorker:n,onMessage:r,send:s,loadImage:a},U0}var $0,IS;function cM(){if(IS)return $0;IS=1;const t=JV(),e=oM(),{log:n}=wy(),r=vy(),s=lM(),{defaultOptions:a,spawnWorker:l,terminateWorker:c,onMessage:d,loadImage:p,send:m}=aq();let g=0;return $0=async(b="eng",v=s.LSTM_ONLY,w={},C={})=>{const k=r("Worker",g),{logger:N,errorHandler:M,..._}=t({...a,...w}),P={},I=typeof b=="string"?b.split("+"):b;let q=v,j=C;const F=[s.DEFAULT,s.LSTM_ONLY].includes(v)&&!_.legacyCore;let G,te;const he=new Promise((ne,ie)=>{te=ne,G=ie}),Ne=ne=>{G(ne.message)};let Se=l(_);Se.onerror=Ne,g+=1;const Te=({id:ne,action:ie,payload:Oe})=>new Promise(($e,lt)=>{n(`[${k}]: Start ${ne}, action=${ie}`);const Ue=`${ie}-${ne}`;P[Ue]={resolve:$e,reject:lt},m(Se,{workerId:k,jobId:ne,action:ie,payload:Oe})}),pe=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),U=ne=>Te(e({id:ne,action:"load",payload:{options:{lstmOnly:F,corePath:_.corePath,logging:_.logging}}})),Z=(ne,ie,Oe)=>Te(e({id:Oe,action:"FS",payload:{method:"writeFile",args:[ne,ie]}})),K=(ne,ie)=>Te(e({id:ie,action:"FS",payload:{method:"readFile",args:[ne,{encoding:"utf8"}]}})),z=(ne,ie)=>Te(e({id:ie,action:"FS",payload:{method:"unlink",args:[ne]}})),H=(ne,ie,Oe)=>Te(e({id:Oe,action:"FS",payload:{method:ne,args:ie}})),A=(ne,ie)=>Te(e({id:ie,action:"loadLanguage",payload:{langs:ne,options:{langPath:_.langPath,dataPath:_.dataPath,cachePath:_.cachePath,cacheMethod:_.cacheMethod,gzip:_.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(q)&&!_.legacyLang}}})),R=(ne,ie,Oe,$e)=>Te(e({id:$e,action:"initialize",payload:{langs:ne,oem:ie,config:Oe}})),W=(ne="eng",ie,Oe,$e)=>{if(F&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(ie))throw Error("Legacy model requested but code missing.");const lt=ie||q;q=lt;const Ue=Oe||j;j=Ue;const pt=(typeof ne=="string"?ne.split("+"):ne).filter(Me=>!I.includes(Me));return I.push(...pt),pt.length>0?A(pt,$e).then(()=>R(ne,lt,Ue,$e)):R(ne,lt,Ue,$e)},oe=(ne={},ie)=>Te(e({id:ie,action:"setParameters",payload:{params:ne}})),be=async(ne,ie={},Oe={text:!0},$e)=>Te(e({id:$e,action:"recognize",payload:{image:await p(ne),options:ie,output:Oe}})),L=async(ne,ie)=>{if(F)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return Te(e({id:ie,action:"detect",payload:{image:await p(ne)}}))},ae=async()=>(Se!==null&&(c(Se),Se=null),Promise.resolve());d(Se,({workerId:ne,jobId:ie,status:Oe,action:$e,data:lt})=>{const Ue=`${$e}-${ie}`;if(Oe==="resolve")n(`[${ne}]: Complete ${ie}`),P[Ue].resolve({jobId:ie,data:lt}),delete P[Ue];else if(Oe==="reject")if(P[Ue].reject(lt),delete P[Ue],$e==="load"&&G(lt),M)M(lt);else throw Error(lt);else Oe==="progress"&&N({...lt,userJobId:ie})});const $={id:k,worker:Se,load:pe,writeText:Z,readText:K,removeFile:z,FS:H,reinitialize:W,setParameters:oe,recognize:be,detect:L,terminate:ae};return U().then(()=>A(b)).then(()=>R(b,v,C)).then(()=>te($)).catch(()=>{}),he},$0}var V0,zS;function oq(){if(zS)return V0;zS=1;const t=cM();return V0={recognize:async(r,s,a)=>{const l=await t(s,1,a);return l.recognize(r).finally(async()=>{await l.terminate()})},detect:async(r,s)=>{const a=await t("osd",0,s);return a.detect(r).finally(async()=>{await a.terminate()})}},V0}var q0,BS;function lq(){return BS||(BS=1,q0={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),q0}var W0,PS;function cq(){return PS||(PS=1,W0={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),W0}var G0,HS;function uq(){if(HS)return G0;HS=1,WV();const t=GV(),e=cM(),n=oq(),r=lq(),s=lM(),a=cq(),{setLogging:l}=wy();return G0={languages:r,OEM:s,PSM:a,createScheduler:t,createWorker:e,setLogging:l,...n},G0}var dq=uq();const fq=async(t,e)=>{const n=await dq.createWorker("tur+eng",1,{logger:r=>{r.status==="recognizing text"&&e&&e(Math.round(r.progress*100))}});try{const{data:{text:r,confidence:s}}=await n.recognize(t);return{text:r,confidence:s}}finally{await n.terminate()}},hq=1600,pq=.85;function mq(t){const e=t.maxTouchPoints>0||t.hasCoarsePointer,n=t.viewportWidth<=1024;return e&&n}function gq(t,e){const n=(t||"").trim(),r=(e||"").trim();return r?n?`${n}

${r}`:r:n}async function xq(t,e={}){const n=e.maxWidth??hq,r=e.quality??pq,s=await createImageBitmap(t);try{const a=s.width,l=s.height;if(!a||!l)throw new Error("Invalid image dimensions");const c=a>n?n/a:1,d=Math.max(1,Math.round(a*c)),p=Math.max(1,Math.round(l*c)),m=document.createElement("canvas");m.width=d,m.height=p;const g=m.getContext("2d");if(!g)throw new Error("Canvas context is unavailable");return g.drawImage(s,0,0,d,p),await new Promise(v=>{m.toBlob(v,"image/jpeg",r)})||t}finally{s.close()}}const FS=.02,bq=({open:t,onClose:e,onApply:n,onProcessingChange:r,onErrorChange:s,onDraftChange:a})=>{const[l,c]=E.useState(null),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState(!1),[w,C]=E.useState(!1),[k,N]=E.useState(0),[M,_]=E.useState(""),P=E.useRef(null),I=E.useRef(null),q=E.useRef(null),j=E.useRef(null),F=(K,z,H)=>Math.min(H,Math.max(z,K));if(E.useEffect(()=>{t&&(c(null),p(null),g(null),_(""),N(0),v(!1),C(!1),r(!1),s(null),a(""),setTimeout(()=>{var K;(K=P.current)==null||K.click()},100))},[t,a,s,r]),E.useEffect(()=>{j.current=m},[m]),!t)return null;const G=K=>{var A;const z=(A=K.target.files)==null?void 0:A[0];if(!z)return;p(z),g(null),_(""),a(""),s(null);const H=new FileReader;H.onload=R=>{var W;c((W=R.target)==null?void 0:W.result)},H.readAsDataURL(z)},te=K=>{if(!I.current)return null;const z=I.current.getBoundingClientRect();return z.width<=0||z.height<=0?null:{x:F((K.clientX-z.left)/z.width,0,1),y:F((K.clientY-z.top)/z.height,0,1)}},he=K=>{if(b)return;const z=te(K);z&&(K.currentTarget.setPointerCapture(K.pointerId),q.current=z,g({x:z.x,y:z.y,width:0,height:0}),C(!0))},Ne=K=>{if(!w||!q.current)return;const z=te(K);if(!z)return;const H=q.current,A=Math.min(H.x,z.x),R=Math.min(H.y,z.y),W=Math.abs(z.x-H.x),oe=Math.abs(z.y-H.y);g({x:A,y:R,width:W,height:oe})},Se=K=>{if(!w)return;K.currentTarget.hasPointerCapture(K.pointerId)&&K.currentTarget.releasePointerCapture(K.pointerId),C(!1);const z=j.current;(!z||z.width<FS||z.height<FS)&&g(null)},Te=async(K,z)=>{const H=await createImageBitmap(K);try{const A=F(Math.round(z.x*H.width),0,H.width-1),R=F(Math.round(z.y*H.height),0,H.height-1),W=Math.max(1,Math.round(z.width*H.width)),oe=Math.max(1,Math.round(z.height*H.height)),be=Math.min(W,H.width-A),L=Math.min(oe,H.height-R),ae=document.createElement("canvas");ae.width=be,ae.height=L;const $=ae.getContext("2d");if(!$)throw new Error("Canvas context is unavailable");return $.drawImage(H,A,R,be,L,0,0,be,L),await new Promise(ie=>{ae.toBlob(ie,"image/jpeg",.92)})||K}finally{H.close()}},pe=async K=>{if(d){v(!0),r(!0),s(null),N(0);try{const z=K&&m?await Te(d,m):d,H=await xq(z),R=((await fq(H,W=>N(W))).text||"").trim();_(R),a(R),R||s("Secilen alanda okunabilir metin bulunamadi. Alani degistirip tekrar deneyin.")}catch(z){console.error("OCR Error:",z);const H="Metin okunamadi. Isigi ve aciyi duzeltip tekrar deneyin.";s(H),alert(H)}finally{v(!1),r(!1)}}},U=()=>{c(null),p(null),g(null),_(""),N(0),C(!1),a(""),s(null),P.current&&(P.current.value="",P.current.click())},Z=()=>{n(M),e()};return h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-white/10",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(Q0,{size:20,className:"text-primary dark:text-orange-500"}),"Metin Tara (OCR)"]}),h.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 dark:hover:bg-white/5 rounded-full transition-colors","aria-label":"Kapat",children:h.jsx(ds,{size:20,className:"text-slate-500"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!l&&h.jsxs("div",{onClick:()=>{var K;return(K=P.current)==null?void 0:K.click()},className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-12 flex flex-col items-center justify-center gap-4 cursor-pointer hover:border-primary/50 dark:hover:border-orange-500/50 transition-colors",children:[h.jsx("div",{className:"w-16 h-16 bg-primary/10 dark:bg-orange-500/10 rounded-full flex items-center justify-center text-primary dark:text-orange-500",children:h.jsx(Q0,{size:32})}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Kamerayi Ac"}),h.jsx("p",{className:"text-sm text-slate-500",children:"Sayfayi cekin, sonra metin alanini secin"})]})]}),l&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"relative bg-black rounded-lg border border-slate-200 dark:border-white/10 shadow-inner p-2",children:[h.jsxs("div",{className:"relative mx-auto w-fit max-w-full touch-none",children:[h.jsx("img",{src:l,alt:"Captured",className:"block max-h-[58vh] w-auto max-w-full rounded-md"}),!b&&h.jsx("div",{ref:I,className:"absolute inset-0 cursor-crosshair",onPointerDown:he,onPointerMove:Ne,onPointerUp:Se,onPointerCancel:Se,children:m&&h.jsx("div",{className:"absolute border-2 border-emerald-400 bg-emerald-400/12",style:{left:`${m.x*100}%`,top:`${m.y*100}%`,width:`${m.width*100}%`,height:`${m.height*100}%`}})})]}),b&&h.jsxs("div",{className:"absolute inset-0 bg-black/60 flex flex-col items-center justify-center text-white p-6 text-center backdrop-blur-[2px]",children:[h.jsx(nn,{size:48,className:"animate-spin mb-4 text-primary dark:text-orange-500"}),h.jsx("p",{className:"font-bold text-lg mb-2",children:"Metin Isleniyor..."}),h.jsx("div",{className:"w-full max-w-xs bg-white/20 h-2 rounded-full overflow-hidden",children:h.jsx("div",{className:"bg-primary dark:bg-orange-500 h-full transition-all duration-300",style:{width:`${k}%`}})}),h.jsxs("p",{className:"mt-2 text-sm font-medium",children:["%",k]}),h.jsx("p",{className:"mt-4 text-[10px] text-white/60",children:"Bu islem cihaz hizina gore 5-10 saniye surebilir."})]})]}),!b&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Metin bolgesini secmek icin gorsel uzerinde surukleyin."}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[h.jsxs("button",{type:"button",onClick:()=>pe(!0),disabled:!m,className:"py-2 px-3 rounded-lg bg-emerald-600 text-white text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center gap-2",children:[h.jsx(iR,{size:16}),"Secili Alani Tara"]}),h.jsx("button",{type:"button",onClick:()=>pe(!1),className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:"Tum Sayfayi Tara"}),h.jsxs("button",{type:"button",onClick:U,className:"py-2 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-sm font-semibold text-slate-700 dark:text-slate-200 inline-flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-white/5",children:[h.jsx(kE,{size:16}),"Tekrar Cek"]})]})]}),!b&&M&&h.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Okunan Metin"}),h.jsx("textarea",{value:M,onChange:K=>{_(K.target.value),a(K.target.value)},className:"w-full h-40 border border-slate-200 dark:border-white/10 rounded-xl p-3 text-sm bg-slate-50 dark:bg-white/5 text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/20 outline-none resize-none font-lora"}),h.jsx("p",{className:"text-[10px] text-slate-400 italic text-right",children:"* Hatalari buradan duzeltebilirsiniz."})]})]})]}),h.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-white/10 flex gap-3",children:[l&&!b&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 border border-slate-200 dark:border-white/10 rounded-xl text-slate-600 dark:text-slate-300 font-semibold hover:bg-slate-50 dark:hover:bg-white/5 transition-colors",children:"Kapat"}),h.jsxs("button",{onClick:Z,disabled:!M,className:"flex-[1.5] py-3 px-4 bg-primary dark:bg-orange-600 text-white rounded-xl font-bold hover:opacity-90 transition-all shadow-lg shadow-primary/20 dark:shadow-orange-600/20 disabled:opacity-50 flex items-center justify-center gap-2",children:[h.jsx(ib,{size:18}),"Highlight'a Ekle"]})]}),!l&&h.jsx("button",{onClick:e,className:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 dark:hover:text-slate-300 transition-colors",children:"Vazgec"})]})]}),h.jsx("input",{ref:P,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:G})]})},yq=({highlights:t,onUpdate:e,autoEditHighlightId:n})=>{const[r,s]=E.useState(!1),[a,l]=E.useState(null),[c,d]=E.useState({}),[p,m]=E.useState("highlight"),[g,b]=E.useState(!1),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(""),[_,P]=E.useState(null),[I,q]=E.useState(""),[j,F]=E.useState(""),[G,te]=E.useState(!1);We.useEffect(()=>{if(n){const K=t.find(z=>z.id===n);K&&Ne(K)}},[n]),We.useEffect(()=>{const K=()=>{if(typeof window>"u"){w(!1);return}const z=typeof window.matchMedia=="function"&&window.matchMedia("(pointer: coarse)").matches,H=typeof navigator<"u"?Number(navigator.maxTouchPoints||0):0;w(mq({viewportWidth:window.innerWidth||0,maxTouchPoints:H,hasCoarsePointer:z}))};return K(),window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const he=()=>{l(null),d({}),m("highlight"),q(new Date().toISOString().split("T")[0]),F(""),b(!1),P(null),M(""),s(!0)},Ne=K=>{l(K.id),d({...K}),m(Jh(K.type)),q(new Date(K.createdAt).toISOString().split("T")[0]),F(K.tags?K.tags.join(", "):""),b(!1),P(null),M(""),s(!0)},Se=()=>{s(!1),l(null),d({}),F(""),q(""),b(!1),P(null),M(""),k(!1)},Te=We.useCallback(K=>{d(z=>({...z,text:gq(String(z.text||""),K)})),M(K),P(null),b(!1)},[]),pe=async()=>{if(!c.text)return;te(!0);const K=`"${c.text}"
${c.comment?`Context: ${c.comment}`:""}`,z=await by(K);if(z.length>0){const H=j?j.split(",").map(R=>R.trim()).filter(Boolean):[],A=Array.from(new Set([...H,...z]));F(A.join(", "))}te(!1)},U=()=>{if(!c.text)return;const K=j.split(",").map(A=>A.trim()).filter(A=>A.length>0),z=I?new Date(I).getTime():Date.now(),H={id:a||Date.now().toString(),text:c.text,type:p,pageNumber:c.pageNumber,paragraphNumber:c.paragraphNumber,chapterTitle:c.chapterTitle,comment:c.comment,createdAt:z,tags:K};if(a){const A=t.map(R=>R.id===a?H:R);e(A)}else e([H,...t]);Se()},Z=K=>{window.confirm("Delete this item?")&&e(t.filter(z=>z.id!==K))};return h.jsxs("div",{className:"space-y-4 md:space-y-6",children:[!r&&h.jsxs("button",{onClick:he,className:"w-full py-3 md:py-4 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl text-slate-500 dark:text-slate-400 hover:border-[#262D40]/24 hover:text-[#262D40] hover:bg-[#262D40]/30 dark:hover:bg-white/5 transition-all flex flex-col items-center gap-1 md:gap-2",children:[h.jsx(ex,{size:20,className:"md:w-6 md:h-6"}),h.jsx("span",{className:"text-sm md:text-base font-medium",children:"Add Highlight or Insights"})]}),r&&h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl shadow-lg border border-[#262D40]/8 dark:border-white/10 animate-in fade-in zoom-in-95 duration-200 relative ring-1 ring-[#262D40]/5 dark:ring-white/5",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[h.jsxs("h4",{className:"font-semibold text-slate-800 dark:text-white flex items-center gap-2 text-sm md:text-base",children:[a?h.jsx(jf,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}):h.jsx(ex,{size:16,className:"md:w-[18px] md:h-[18px] text-[#262D40] dark:text-orange-500"}),a?p==="highlight"?"Edit Highlight":"Edit Note":"New Entry"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[p==="highlight"&&v&&h.jsxs("button",{type:"button",onClick:()=>{P(null),M(""),b(!0)},disabled:C,className:"inline-flex items-center gap-1 rounded-md border border-sky-200 bg-sky-50 px-2 py-1 text-[11px] font-semibold text-sky-700 transition-colors hover:bg-sky-100 disabled:cursor-not-allowed disabled:opacity-60 dark:border-sky-700 dark:bg-sky-950/35 dark:text-sky-200 dark:hover:bg-sky-950/55",title:"Kamera ile metin tara",children:[C?h.jsx(nn,{size:12,className:"animate-spin"}):h.jsx(Q0,{size:12}),"Tara"]}),h.jsx("button",{onClick:Se,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:h.jsx(ds,{size:18,className:"md:w-5 md:h-5"})})]})]}),h.jsxs("div",{className:"flex bg-[#F3F5FA] dark:bg-white/5 p-1 rounded-lg mb-4 md:mb-5",children:[h.jsxs("button",{type:"button",onClick:()=>{p!=="highlight"&&(m("highlight"),d({}),F(""),P(null),M(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${p==="highlight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[h.jsx(Jc,{size:14,className:"md:w-4 md:h-4"}),"Highlight"]}),h.jsxs("button",{type:"button",onClick:()=>{p!=="insight"&&(m("insight"),d({}),F(""),b(!1),P(null),M(""))},className:`flex-1 flex items-center justify-center gap-2 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-md transition-all ${p==="insight"?"bg-white dark:bg-white/10 text-[#262D40] dark:text-orange-500 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[h.jsx(sl,{size:14,className:"md:w-4 md:h-4"}),"Insights"]})]}),h.jsxs("div",{className:"space-y-2 md:space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:p==="highlight"?"Highlight Text *":"Insight Content *"}),h.jsx("textarea",{autoFocus:!0,rows:12,className:"w-full border rounded-lg p-2 md:p-3 text-sm md:text-base text-slate-800 dark:text-white focus:ring-2 focus:ring-[#262D40]/30 dark:focus:ring-orange-500/30 focus:border-[#262D40]/30 dark:focus:border-orange-500/30 font-lora bg-[#F3F5FA] border-[#E6EAF2] dark:bg-slate-800/50 dark:border-white/10",placeholder:p==="highlight"?"Type the text exactly as it appears...":"Write your thoughts, summary, or key takeaway...",value:c.text||"",onChange:K=>d(z=>({...z,text:K.target.value}))}),p==="highlight"&&N&&h.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-sky-700 dark:text-sky-300",children:"OCR metni eklendi. Kaydetmeden once metni kontrol edebilirsiniz."}),p==="highlight"&&_&&h.jsx("p",{className:"mt-1 text-[10px] md:text-xs text-red-600 dark:text-red-400",children:_})]}),p==="highlight"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Comment"}),h.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Why is this quote important?",value:c.comment||"",onChange:K=>d(z=>({...z,comment:K.target.value}))})]}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Page #"}),h.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:c.pageNumber||"",onChange:K=>d(z=>({...z,pageNumber:parseInt(K.target.value)||void 0}))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Paragraph #"}),h.jsx("input",{type:"number",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",value:c.paragraphNumber||"",onChange:K=>d(z=>({...z,paragraphNumber:parseInt(K.target.value)||void 0}))})]}),h.jsxs("div",{className:"col-span-2 md:col-span-1",children:[h.jsx("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-0.5 uppercase",children:"Chapter"}),h.jsx("input",{type:"text",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30",placeholder:"Title or No.",value:c.chapterTitle||"",onChange:K=>d(z=>({...z,chapterTitle:K.target.value}))})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4 pt-2 border-t border-slate-50 dark:border-white/5",children:[h.jsxs("div",{className:"md:col-span-1",children:[h.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"})," Date"]}),h.jsx("input",{type:"date",value:I,onChange:K=>q(K.target.value),className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]}),h.jsxs("div",{className:"md:col-span-2",children:[h.jsxs("label",{className:"block text-[10px] md:text-xs font-medium text-slate-500 dark:text-slate-400 mb-1 uppercase flex items-center justify-between",children:[h.jsx("span",{children:"Tags"}),h.jsxs("button",{type:"button",onClick:pe,disabled:G||!c.text,className:"text-[#262D40] dark:text-orange-500 hover:text-[#262D40] dark:hover:text-orange-400 flex items-center gap-1 disabled:opacity-50 text-[10px] font-bold tracking-wide",children:[G?h.jsx(nn,{size:10,className:"animate-spin"}):h.jsx(Ws,{size:10}),"AI AUTO-TAG"]})]}),h.jsx("input",{type:"text",value:j,onChange:K=>F(K.target.value),placeholder:"Separate with commas...",className:"w-full border border-[#E6EAF2] dark:border-white/10 rounded-lg py-1.5 px-2 text-xs md:text-sm bg-white dark:bg-slate-800/50 text-slate-800 dark:text-white focus:ring-2 focus:ring-orange-500/30"})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-2 mt-2",children:[h.jsx("button",{onClick:Se,className:"px-3 md:px-4 py-2 text-xs md:text-sm text-slate-600 dark:text-slate-400 hover:bg-[#F3F5FA] dark:hover:bg-white/5 rounded-lg flex items-center gap-2",children:"Cancel"}),h.jsxs("button",{onClick:U,disabled:!c.text,className:"px-3 md:px-4 py-2 text-xs md:text-sm bg-[#262D40]/40 dark:bg-orange-600/40 text-white rounded-lg hover:bg-[#262D40]/55 dark:hover:bg-orange-600/60 disabled:opacity-50 shadow-sm flex items-center gap-2",children:[h.jsx(rR,{size:14,className:"md:w-4 md:h-4"}),a?"Update Entry":"Save Entry"]})]})]})]}),h.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.map(K=>{const z=GE(K.type);return h.jsxs("div",{className:"p-3 md:p-6 rounded-xl border transition-all relative group bg-white dark:bg-slate-900/50 border-[#E6EAF2] dark:border-white/10 hover:border-[#262D40]/12 dark:hover:border-orange-500/30 hover:shadow-md",children:[h.jsxs("div",{className:"absolute top-1 right-1 md:top-4 md:right-4 flex gap-0.5 md:gap-2 md:bg-white/80 md:dark:bg-slate-800/90 md:backdrop-blur-sm p-0 md:p-1 rounded-lg md:shadow-sm md:border md:border-[#E6EAF2] md:dark:border-white/10 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity z-10",children:[h.jsx("button",{type:"button",onClick:H=>{H.stopPropagation(),Ne(K)},className:"p-1.5 text-slate-400/70 dark:text-slate-500/70 hover:text-[#262D40] dark:hover:text-orange-500 hover:bg-[#262D40]/5 dark:hover:bg-white/5 rounded-md transition-colors",title:"Edit",children:h.jsx(jf,{size:14,className:"md:w-4 md:h-4"})}),h.jsx("button",{type:"button",onClick:H=>{H.stopPropagation(),Z(K.id)},className:"p-1.5 text-slate-400/70 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:h.jsx(Ha,{size:14,className:"md:w-4 md:h-4"})})]}),h.jsxs("div",{className:"flex gap-3 md:gap-4",children:[h.jsx("div",{className:"flex-shrink-0 mt-0.5 md:mt-1",children:z?h.jsx(sl,{size:16,className:"text-[#262D40]/82 fill-[#262D40]/85 md:w-5 md:h-5"}):h.jsx(Jc,{size:16,className:"text-yellow-400 fill-yellow-200 md:w-5 md:h-5"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:`text-sm md:text-lg leading-relaxed mb-2 md:mb-3 pr-0 md:pr-16 whitespace-pre-wrap font-lora ${z?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-white"}`,children:K.text}),h.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mb-2",children:[(K.pageNumber||K.paragraphNumber)&&h.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 md:px-2 md:py-1 rounded border bg-[#F3F5FA] dark:bg-white/5 border-[#E6EAF2] dark:border-white/10 text-slate-600 dark:text-slate-400",children:[h.jsx(z3,{size:10,className:"md:w-3 md:h-3"}),K.pageNumber&&h.jsxs("span",{children:["Pg ",K.pageNumber]}),K.pageNumber&&K.paragraphNumber&&h.jsx("span",{children:""}),K.paragraphNumber&&h.jsxs("span",{children:["Para ",K.paragraphNumber]})]}),K.chapterTitle&&h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(xu,{size:10,className:"md:w-3 md:h-3"}),h.jsx("span",{children:K.chapterTitle})]}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),h.jsx("span",{children:new Date(K.createdAt).toLocaleDateString()})]})]}),K.tags&&K.tags.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-2",children:K.tags.map((H,A)=>h.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-white/5 border border-[#E6EAF2] dark:border-white/10 rounded text-[9px] md:text-[10px] text-slate-500 dark:text-slate-400 flex items-center gap-0.5",children:[h.jsx(Af,{size:8})," ",H]},A))}),K.comment&&h.jsx("div",{className:"mt-2 md:mt-3 pl-3 md:pl-4 border-l-2 border-[#E6EAF2] dark:border-white/10 py-0.5 md:py-1",children:h.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 italic",children:K.comment})})]})]})]},K.id)}),t.length===0&&!r&&h.jsx("div",{className:"text-center py-8 md:py-12 text-slate-400",children:h.jsx("p",{className:"text-xs md:text-base",children:"No highlights or insights added yet."})})]}),h.jsx(bq,{open:g,onClose:()=>b(!1),onApply:Te,onProcessingChange:k,onErrorChange:P,onDraftChange:M})]})},Ph=(t,e)=>{if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=Date.parse(t);if(Number.isFinite(n))return n}return e},vq=t=>{const e=String(t||"AUTO").trim().toUpperCase();return e==="TR"||e==="EN"?e:"AUTO"},US=t=>{const e=String(t||"").trim().toLowerCase();if(e==="tr"||e==="en")return e},wq=(t,e)=>{const n=Ph(t.createdAt,Date.now());return{id:typeof t.id=="string"&&t.id.trim()?t.id:`${n}-${e}`,text:t.text||"",type:Jh(t.type),pageNumber:t.pageNumber,paragraphNumber:t.paragraphNumber,chapterTitle:t.chapterTitle,comment:t.comment,createdAt:n,tags:Array.isArray(t.tags)?t.tags:[],isFavorite:!!t.isFavorite}},uM=t=>({...t,addedAt:Ph(t.addedAt,Date.now()),tags:Array.isArray(t.tags)?t.tags:[],contentLanguageMode:vq(t.contentLanguageMode),contentLanguageResolved:US(t.contentLanguageResolved),sourceLanguageHint:US(t.sourceLanguageHint),highlights:Array.isArray(t.highlights)?t.highlights.map((e,n)=>wq(e,n)):[],personalNoteCategory:t.type==="PERSONAL_NOTE"?Xh(t.personalNoteCategory):void 0,personalFolderId:t.type==="PERSONAL_NOTE"?QE(t.personalFolderId):void 0,folderPath:t.type==="PERSONAL_NOTE"?XE(t.folderPath):void 0,status:t.status||"On Shelf",readingStatus:t.readingStatus||"To Read",author:(t.author||"Unknown Author").trim()||"Unknown Author",title:(t.title||"Untitled").trim()||"Untitled",summaryText:typeof t.summaryText=="string"?t.summaryText:void 0}),dM=t=>({...t,category:Xh(t.category),name:(t.name||"").trim(),order:Number.isFinite(t.order)?t.order:0,createdAt:Ph(t.createdAt,Date.now()),updatedAt:Ph(t.updatedAt,Date.now())});function kq(t){return t?{__oracleCursor:t}:null}function Cq(t){return t?t.__oracleCursor:void 0}const K0=async(t,e=2e3,n)=>{const r=new URL(`${nt}/api/library/items`);r.searchParams.set("limit",String(e));const s=Cq(n);s&&r.searchParams.set("cursor",s);const a=await Rt(r.toString());if(!a.ok)throw new Error(await Kr(a,"Failed to fetch library items from Oracle"));const l=await a.json(),d=(Array.isArray(l==null?void 0:l.items)?l.items:[]).map(m=>uM(m)),p=kq(typeof(l==null?void 0:l.next_cursor)=="string"?l.next_cursor:null);return{items:d,lastDoc:p}},_a=async(t,e)=>{const n=uM(e),r=await Rt(`${nt}/api/library/items/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to save library item to Oracle"))},Jx=async(t,e,n)=>{const r=await Rt(`${nt}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:n})});if(!r.ok)throw new Error(await Kr(r,"Failed to patch library item in Oracle"))},Sq=async(t,e)=>{const n=await Rt(`${nt}/api/library/items/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Kr(n,"Failed to delete library item from Oracle"))},Eq=async(t,e)=>{if(e.length===0)return;const n=await Rt(`${nt}/api/library/items/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:e})});if(!n.ok)throw new Error(await Kr(n,"Failed to bulk delete library items from Oracle"))},$S=async t=>{const e=await Rt(`${nt}/api/library/personal-note-folders`);if(!e.ok)throw new Error(await Kr(e,"Failed to fetch personal note folders from Oracle"));const n=await e.json();return(Array.isArray(n==null?void 0:n.folders)?n.folders:[]).map(s=>dM(s)).sort((s,a)=>s.category!==a.category?s.category.localeCompare(a.category):s.order!==a.order?s.order-a.order:s.name.localeCompare(a.name))},VS=async(t,e)=>{const n=dM(e),r=await Rt(`${nt}/api/library/personal-note-folders/${encodeURIComponent(n.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to save personal note folder to Oracle"))},qS=async(t,e,n)=>{const r=await Rt(`${nt}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error(await Kr(r,"Failed to update personal note folder in Oracle"))},Nq=async(t,e)=>{const n=await Rt(`${nt}/api/library/personal-note-folders/${encodeURIComponent(e)}`,{method:"DELETE"});if(!n.ok)throw new Error(await Kr(n,"Failed to delete personal note folder from Oracle"))},uf=async(t,e,n,r,s)=>{const a=await Rt(`${nt}/api/library/items/${encodeURIComponent(e)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch:{personalNoteCategory:Xh(n),personalFolderId:QE(r)||null,folderPath:XE(s)||null}})});if(!a.ok)throw new Error(await Kr(a,"Failed to move personal note in Oracle"))},Tq=We.memo(({book:t,onBack:e,onEdit:n,onDelete:r,onUpdateHighlights:s,initialTab:a="info",autoEditHighlightId:l,onIngestSuccess:c,onBookUpdated:d})=>{const[p,m]=E.useState(a),[g,b]=E.useState(null),[v,w]=E.useState(!1),[C,k]=E.useState(!1),[N,M]=E.useState(!1),[_,P]=E.useState(null),[I,q]=E.useState(null),[j,F]=E.useState(null),[G,te]=E.useState(null),[he,Ne]=E.useState(null),[Se,Te]=E.useState(0),[pe,U]=E.useState(0),{user:Z}=yp(),K=We.useRef(null),z=We.useRef(null),H=t.type==="PERSONAL_NOTE",A=Me=>{if(!Me)return"";const st=Me.replace(/_/g," ").replace(/\s+/g," ").trim(),De=24;return st.length<=De?st:`${st.slice(0,De).trimEnd()}...`},R=async Me=>{var De;const st=(De=Me.target.files)==null?void 0:De[0];if(!(!st||!Z)){if(st.type!=="application/pdf"){F("Please select a PDF file");return}k(!0),F(null),q(null),te({status:"PROCESSING",file_name:st.name,chunk_count:null,embedding_count:null,updated_at:new Date().toISOString()}),Te(_e=>_e+1);try{const _e=await sM(st,t.title,t.author,Z.uid,t.id);q(_e),setTimeout(()=>q(null),5e3)}catch(_e){F(_e instanceof Error?_e.message:"Ingestion failed")}finally{k(!1),K.current&&(K.current.value="")}}},W=Me=>{switch(Me){case"Reading":return{icon:Pa,color:"text-[#38BDF8]",bg:"bg-[#38BDF8]/12",border:"border-[#38BDF8]/45"};case"Finished":return{icon:Yc,color:"text-[#22C55E]",bg:"bg-[#22C55E]/12",border:"border-[#22C55E]/45"};case"To Read":return{icon:U4,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"};default:return{icon:Pa,color:"text-[#94A3B8]",bg:"bg-[#94A3B8]/12",border:"border-[#94A3B8]/40"}}},oe=Me=>{switch(Me){case"Lent Out":return{icon:Ui,color:"text-[#F59E0B]",bg:"bg-[#F59E0B]/15",border:"border-[#F59E0B]/45"};case"Lost":return{icon:Ui,color:"text-[#F43F5E]",bg:"bg-[#F43F5E]/15",border:"border-[#F43F5E]/45"};case"On Shelf":default:return{icon:vE,color:"text-[#14B8A6]",bg:"bg-[#14B8A6]/15",border:"border-[#14B8A6]/45"}}},be=async()=>{if(t.highlights.length===0)return;w(!0);const Me=t.highlights.map(De=>De.text),st=await X5(Me);b(st),w(!1)},L=async()=>{if(!(!(Z!=null&&Z.uid)||N)){M(!0),P(null);try{const Me=xp(t),st=await yy(Me,{forceRegenerate:!0}),De=bp(t,st),_e={};De.summaryText!==t.summaryText&&(_e.summaryText=De.summaryText),JSON.stringify(De.tags||[])!==JSON.stringify(t.tags||[])&&(_e.tags=De.tags),De.publisher!==t.publisher&&(_e.publisher=De.publisher),De.translator!==t.translator&&(_e.translator=De.translator),De.publicationYear!==t.publicationYear&&(_e.publicationYear=De.publicationYear),De.isbn!==t.isbn&&(_e.isbn=De.isbn),De.coverUrl!==t.coverUrl&&(_e.coverUrl=De.coverUrl),De.pageCount!==t.pageCount&&(_e.pageCount=De.pageCount),De.contentLanguageMode!==t.contentLanguageMode&&(_e.contentLanguageMode=De.contentLanguageMode),De.contentLanguageResolved!==t.contentLanguageResolved&&(_e.contentLanguageResolved=De.contentLanguageResolved),De.sourceLanguageHint!==t.sourceLanguageHint&&(_e.sourceLanguageHint=De.sourceLanguageHint),De.languageDecisionReason!==t.languageDecisionReason&&(_e.languageDecisionReason=De.languageDecisionReason),De.languageDecisionConfidence!==t.languageDecisionConfidence&&(_e.languageDecisionConfidence=De.languageDecisionConfidence),Object.keys(_e).length>0&&await Jx(Z.uid,t.id,_e),d==null||d({...t,..._e}),(De.summaryText||De.generalNotes)&&b(De.summaryText||De.generalNotes||null)}catch(Me){console.error("Enrich failed",Me),P(Me instanceof Error?Me.message:"Failed to generate with AI")}finally{M(!1)}}},ae=H?null:W(t.readingStatus),$=H?null:oe(t.status),ne=!!((G==null?void 0:G.status)==="COMPLETED"&&(G!=null&&G.matched_by_title)&&(G!=null&&G.resolved_book_id)&&String(G.resolved_book_id)!==String(t.id)),ie=(G==null?void 0:G.status)==="COMPLETED"&&!ne,Oe=(G==null?void 0:G.status)==="PROCESSING",$e=(G==null?void 0:G.status)==="FAILED",lt=ie||Oe||C,Ue=Math.min(95,Math.max(12,12+pe*3)),rt=We.useCallback(()=>{Te(Me=>Me+1)},[]);We.useEffect(()=>{if(!(Z!=null&&Z.uid)||!(t!=null&&t.id)||H){te(null),Ne(null),U(0),z.current&&(clearTimeout(z.current),z.current=null);return}let Me=!1;const st=60,De=async()=>{try{const _e=await BV(t.id,Z.uid,t.title);if(Me)return;te(_e),Ne(null);const an=!!(_e.status==="COMPLETED"&&_e.matched_by_title&&_e.resolved_book_id&&String(_e.resolved_book_id)!==String(t.id)),on=_e.status==="COMPLETED"&&!an;if(t.isIngested!==on){const Gn={...t,isIngested:on};d==null||d(Gn)}_e.status==="COMPLETED"&&!an&&(c==null||c()),_e.status==="PROCESSING"&&U(Gn=>{const Dt=Gn+1;return Dt<st&&!Me&&(z.current=setTimeout(De,1e4)),Dt})}catch(_e){if(Me)return;Ne(_e instanceof Error?_e.message:"Failed to fetch ingestion status"),U(an=>{const on=an+1;return on<st&&!Me&&(z.current=setTimeout(De,1e4)),on})}};return U(0),De(),()=>{Me=!0,z.current&&(clearTimeout(z.current),z.current=null)}},[t.id,Z==null?void 0:Z.uid,H,Se]);const pt=(Me,st,De)=>h.jsxs("div",{className:`p-2 md:p-4 rounded-lg md:rounded-xl border-2 ${Me.bg} ${Me.border} flex items-center gap-2 md:gap-3 shadow-sm h-full`,children:[h.jsx("div",{className:`p-1.5 md:p-2 rounded-full bg-white/50 dark:bg-black/20 ${Me.color} flex-shrink-0`,children:h.jsx(Me.icon,{size:16,className:"md:w-5 md:h-5"})}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("span",{className:"block text-[9px] md:text-[10px] uppercase tracking-wider font-bold text-[#111827] dark:text-white/60 truncate",children:st}),h.jsx("span",{className:"font-bold text-xs md:text-base leading-tight text-[#111827] dark:text-white truncate block",children:De})]})]});return h.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-3 md:p-4 pb-20 animate-in fade-in duration-300",children:[h.jsxs("button",{onClick:e,className:"mb-2 md:mb-6 flex items-center text-slate-500 dark:text-slate-400 hover:text-[#262D40] dark:hover:text-white transition-colors group text-base md:text-base",children:[h.jsx(pE,{size:18,className:"mr-1.5 md:mr-1 md:w-5 md:h-5 group-hover:-translate-x-1 transition-transform"}),"Back to ",H?"Notes":"Library"]}),h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl md:rounded-2xl shadow-sm border border-[#E6EAF2] dark:border-slate-800 overflow-hidden",children:[h.jsx("div",{className:"p-4 md:p-8 border-b border-[#E6EAF2] dark:border-slate-800",children:H?h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2 md:mb-4 text-[#262D40]/90 dark:text-white/85",children:[h.jsx(Mf,{size:18,className:"md:w-6 md:h-6"}),h.jsx("span",{className:"text-xs md:text-sm font-bold tracking-wide uppercase text-[#262D40]/80 dark:text-white",children:"Personal Note"}),h.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#CC561E]/10 text-[#CC561E] text-[10px] md:text-xs font-bold tracking-wide",children:Dn(t)}),t.folderPath&&h.jsx("span",{className:"px-2 py-0.5 rounded-md bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs border border-[#E6EAF2] dark:border-slate-700",children:t.folderPath})]}),h.jsx("h1",{className:"text-xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 md:mb-4 leading-tight",children:t.title}),h.jsxs("div",{className:"flex flex-wrap gap-1.5 md:gap-2 mb-2",children:[t.tags.map((Me,st)=>h.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] md:text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},st)),h.jsxs("span",{className:"px-1.5 py-0.5 md:px-2 md:py-1 text-slate-400 dark:text-slate-500 text-[10px] md:text-xs flex items-center gap-1",children:[h.jsx(nl,{size:10,className:"md:w-3 md:h-3"}),new Date(t.addedAt).toLocaleDateString()]})]})]}),h.jsxs("div",{className:"flex gap-1 md:gap-2 ml-2 md:ml-4 flex-shrink-0",children:[h.jsx("input",{type:"file",ref:K,className:"hidden",accept:".pdf",onChange:R}),h.jsx("button",{type:"button",onClick:()=>{var Me;return(Me=K.current)==null?void 0:Me.click()},disabled:lt,className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors relative",title:ie?`PDF already indexed: ${(G==null?void 0:G.file_name)||""}`:"Upload PDF",children:C?h.jsx(nn,{size:18,className:"md:w-5 md:h-5 animate-spin text-[#262D40]/90"}):h.jsx(Of,{size:18,className:"md:w-5 md:h-5"})}),h.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 hover:bg-[#262D40]/5 dark:hover:bg-[#262D40]/30 rounded-full transition-colors",title:"Edit Note",children:h.jsx(jf,{size:18,className:"md:w-5 md:h-5"})}),h.jsx("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-full transition-colors",title:"Delete Note",children:h.jsx(Ha,{size:18,className:"md:w-5 md:h-5"})})]})]}):h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[h.jsxs("div",{className:"flex gap-4 md:block md:shrink-0",children:[h.jsx("div",{className:"w-20 h-32 md:w-34 md:h-52 bg-slate-200 dark:bg-slate-800 rounded-lg shadow-inner flex-shrink-0 flex items-center justify-center text-slate-400 dark:text-slate-600 self-center md:self-start overflow-hidden relative border border-[#E6EAF2] dark:border-slate-700",children:t.type==="BOOK"&&t.coverUrl?h.jsx("img",{src:t.coverUrl,alt:t.title,className:"w-full h-full object-cover"}):t.type==="BOOK"?h.jsx(Pa,{size:32,className:"md:w-12 md:h-12"}):t.type==="ARTICLE"?h.jsx(xu,{size:32,className:"md:w-12 md:h-12"}):h.jsx(Vh,{size:32,className:"md:w-12 md:h-12"})}),h.jsxs("div",{className:"md:hidden flex-1 flex justify-between items-start min-w-0 py-1 gap-2",children:[h.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[h.jsx("h1",{className:"text-[16px] font-bold text-slate-900 dark:text-white mb-1 leading-snug line-clamp-3",children:t.title}),h.jsx("p",{className:"text-[13px] text-slate-600 dark:text-slate-400 mb-2 line-clamp-2",children:t.author}),t.url&&t.type!=="BOOK"&&h.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 text-[#262D40] dark:text-slate-400 hover:underline max-w-full",children:[h.jsx(A2,{size:12}),h.jsx("span",{className:"text-xs truncate",children:new URL(t.url).hostname})]})]}),h.jsxs("div",{className:"flex flex-col gap-1.5 flex-shrink-0 pt-0.5",children:[ae&&h.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${ae.bg} ${ae.border} ${ae.color}`,children:[h.jsx(ae.icon,{size:10}),h.jsx("span",{children:t.readingStatus})]}),$&&t.type==="BOOK"&&h.jsxs("div",{className:`px-2 py-0.5 rounded-md border text-[10px] font-bold flex items-center gap-1.5 shadow-sm whitespace-nowrap ${$.bg} ${$.border} ${$.color}`,children:[h.jsx($.icon,{size:10}),h.jsx("span",{children:t.status})]})]})]})]}),h.jsxs("div",{className:"hidden md:block flex-1 min-w-0",children:[h.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 dark:text-white mb-2 leading-tight",children:t.title}),h.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400 mb-4",children:t.author}),h.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.tags.map((Me,st)=>h.jsxs("span",{className:"px-2 py-1 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},st))}),t.url&&t.type!=="BOOK"&&h.jsx("div",{className:"mb-6",children:h.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-[#262D40] dark:text-[#262D40]/82 hover:underline",children:[h.jsx(A2,{size:16}),h.jsx("span",{className:"text-sm",children:t.url})]})})]}),h.jsx("div",{className:"md:hidden flex flex-wrap gap-1.5 -mt-1 mb-1",children:t.tags.map((Me,st)=>h.jsxs("span",{className:"px-1.5 py-0.5 bg-[#F3F5FA] dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] rounded border border-[#E6EAF2] dark:border-slate-700",children:["#",Me]},st))}),h.jsxs("div",{className:"w-full md:w-64 flex-shrink-0 flex flex-col gap-2 md:gap-3",children:[h.jsxs("div",{className:"hidden md:flex md:flex-col gap-2 md:gap-3",children:[ae&&h.jsx("div",{className:!$||t.type!=="BOOK"?"col-span-2 md:col-span-1":"col-span-1",children:pt(ae,"Status",t.readingStatus)}),$&&t.type==="BOOK"&&h.jsx("div",{className:"col-span-1",children:pt($,"Inventory",t.status)})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1 md:mt-2",children:[h.jsx("input",{type:"file",ref:K,className:"hidden",accept:".pdf",onChange:R}),h.jsxs("button",{type:"button",onClick:()=>{var Me;return(Me=K.current)==null?void 0:Me.click()},disabled:lt,className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium disabled:opacity-50",title:ie?`PDF already indexed: ${(G==null?void 0:G.file_name)||""}`:"Upload PDF",children:[C?h.jsx(nn,{size:14,className:"animate-spin"}):h.jsx(Of,{size:14}),h.jsx("span",{className:"hidden lg:inline",children:"PDF"})]}),h.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),n()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-[#262D40]/18 dark:hover:border-[#262D40]/30 hover:text-[#262D40] dark:hover:text-[#262D40]/82 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[h.jsx(jf,{size:14})," ",h.jsx("span",{className:"hidden lg:inline",children:"Edit"})]}),h.jsxs("button",{type:"button",onClick:Me=>{Me.stopPropagation(),r()},className:"flex items-center justify-center gap-2 px-2 py-2 bg-white dark:bg-slate-900 border border-[#E6EAF2] dark:border-slate-700 hover:border-red-300 dark:hover:border-red-500 hover:text-red-600 dark:hover:text-red-400 rounded-lg text-slate-600 dark:text-slate-400 transition-colors text-xs font-medium",children:[h.jsx(Ha,{size:14})," ",h.jsx("span",{className:"hidden lg:inline",children:"Delete"})]})]}),(I||ie)&&h.jsxs("div",{className:"mt-2 text-[10px] text-emerald-600 dark:text-emerald-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(Yc,{size:10}),(G==null?void 0:G.chunk_count)!=null?`PDF indexlendi (${G.chunk_count} chunk)`:"PDF indexlendi"]}),ne&&h.jsxs("div",{className:"mt-2 text-[10px] text-amber-600 dark:text-amber-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(Ui,{size:10})," Ayni baslikta baska bir kaydin PDF'i bulundu; bu kayit icin indexli sayilmadi."]}),j&&h.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(rl,{size:10})," ",j]}),$e&&h.jsxs("div",{className:"mt-2 text-[10px] text-red-600 dark:text-red-400 font-medium flex items-center gap-1 animate-in fade-in slide-in-from-top-1",children:[h.jsx(Ui,{size:10})," PDF islenemedi. Lutfen farkli bir PDF ile tekrar deneyin."]})]})]})}),!H&&h.jsxs("div",{className:"flex border-b border-[#E6EAF2] dark:border-slate-800",children:[h.jsx("button",{onClick:()=>m("info"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${p==="info"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:"Details"}),h.jsxs("button",{onClick:()=>m("highlights"),className:`flex-1 py-3 md:py-4 text-xs md:text-sm font-medium text-center border-b-2 transition-colors ${p==="highlights"?"border-[#262D40] dark:border-white text-[#262D40] dark:text-white":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:["Highlights (",t.highlights.length,")"]})]}),h.jsxs("div",{className:"p-4 md:p-8 bg-[#F7F8FB] dark:bg-slate-900/50 min-h-[400px]",children:[(p==="info"||H)&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8",children:[h.jsx("div",{className:H?"md:col-span-3":"md:col-span-2 space-y-6",children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm ${H?"min-h-[300px]":""}`,children:[!H&&h.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 md:mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(sl,{size:18,className:"text-[#262D40]/90 dark:text-[#262D40]/82 md:w-5 md:h-5"}),h.jsx("h3",{className:"text-base md:text-lg font-semibold text-slate-800 dark:text-slate-200",children:"Summary"})]}),h.jsxs("button",{type:"button",onClick:L,disabled:N,className:"flex items-center gap-1.5 text-[11px] md:text-xs font-semibold text-white px-2 py-1 rounded-lg border border-[#262D40] bg-[#262D40] hover:bg-[#1d2333] disabled:opacity-60",children:[N?h.jsx(nn,{size:14,className:"animate-spin"}):h.jsx(Ws,{size:14}),N?"Generating...":"Generate with AI"]})]}),(H?t.generalNotes:t.summaryText||t.generalNotes)?H?h.jsx("div",{className:"personal-note-render text-slate-700 dark:text-slate-300 leading-relaxed text-sm md:text-base max-w-none",dangerouslySetInnerHTML:{__html:mb(t.generalNotes)}}):h.jsx("p",{className:"text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed text-sm md:text-lg",children:t.summaryText||t.generalNotes}):h.jsx("p",{className:"text-slate-400 dark:text-slate-500 italic text-sm",children:"No content added."}),_&&h.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2 flex items-center gap-1",children:[h.jsx(rl,{size:12})," ",_]})]})}),!H&&h.jsx("div",{className:"space-y-4 md:space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 md:p-6 rounded-xl border border-[#E6EAF2] dark:border-slate-800 shadow-sm space-y-4",children:[h.jsx("h3",{className:"text-xs md:text-sm font-semibold text-slate-900 dark:text-white uppercase tracking-wider mb-2 md:mb-4",children:"Information"}),t.publisher&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:t.type==="ARTICLE"?"Journal":"Publisher"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publisher})]}),t.publicationYear&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Year"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.publicationYear})]}),t.translator&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Translator"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.translator})]}),t.isbn&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"ISBN"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 font-mono",children:t.isbn})]}),t.pageCount&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Page Count"}),h.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[t.pageCount," pages"]})]}),G&&G.status!=="NOT_FOUND"&&!ne&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"PDF"}),h.jsxs("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:[Oe&&"Processing...",$e&&"Failed - please re-upload",ie&&h.jsxs(h.Fragment,{children:[G.file_name?h.jsx("span",{title:G.file_name,children:`Indexed: ${A(G.file_name)}`}):"Indexed",G.chunk_count!==null?` (${G.chunk_count} chunks)`:""]})]}),(Oe||C)&&h.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[h.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700 overflow-hidden",children:h.jsx("div",{className:"h-full rounded-full bg-sky-500 transition-all duration-500",style:{width:`${Ue}%`}})}),h.jsx("button",{type:"button",onClick:rt,className:"text-[10px] md:text-xs text-sky-600 dark:text-sky-400 underline underline-offset-2",children:"Yenile"})]}),he&&h.jsx("span",{className:"text-[10px] md:text-xs text-red-600 dark:text-red-400",children:he})]}),t.code&&h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Shelf Code"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Af,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:t.code})]})]}),h.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[h.jsx("span",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400",children:"Added"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(nl,{size:12,className:"text-slate-400 dark:text-slate-500 md:w-3.5 md:h-3.5"}),h.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:new Date(t.addedAt).toLocaleDateString()})]})]})]})})]}),!H&&p==="highlights"&&h.jsxs("div",{className:"space-y-6",children:[t.highlights.length>0&&h.jsx("div",{className:"flex justify-end",children:h.jsxs("button",{onClick:be,disabled:v,className:"text-xs md:text-sm text-[#262D40] dark:text-[#262D40]/82 hover:text-[#262D40] dark:hover:text-[#262D40]/78 flex items-center gap-2 disabled:opacity-50",children:[h.jsx(Ws,{size:14,className:"md:w-4 md:h-4"}),v?"Analyzing...":"Analyze Highlights with AI"]})}),g&&h.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 border border-[#262D40]/8 dark:border-[#262D40]/70 p-3 md:p-4 rounded-lg mb-4 animate-in fade-in slide-in-from-top-2",children:[h.jsxs("h4",{className:"text-[#262D40] dark:text-[#262D40]/78 font-semibold text-xs md:text-sm mb-2 flex items-center gap-2",children:[h.jsx(Ws,{size:14})," AI Analysis"]}),h.jsxs("p",{className:"text-[#262D40] dark:text-[#262D40]/75 text-xs md:text-sm leading-relaxed italic",children:['"',g,'"']})]}),h.jsx(yq,{highlights:t.highlights,onUpdate:s,autoEditHighlightId:l})]})]})]})]})}),fM="/assets/logo_v9-D75hAm-V.png",hM=E.createContext(void 0),Aq=({children:t})=>{const[e,n]=E.useState("light");E.useEffect(()=>{const s=localStorage.getItem("theme");s?n(s):window.matchMedia("(prefers-color-scheme: dark)").matches&&n("dark")},[]),E.useEffect(()=>{const s=window.document.documentElement;e==="dark"?s.classList.add("dark"):s.classList.remove("dark"),localStorage.setItem("theme",e)},[e]);const r=()=>{n(s=>s==="light"?"dark":"light")};return h.jsx(hM.Provider,{value:{theme:e,toggleTheme:r},children:t})},Mq=()=>{const t=E.useContext(hM);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},jq=({activeTab:t,onTabChange:e,isOpen:n,onClose:r})=>{const{theme:s,toggleTheme:a}=Mq(),l=[{id:"DASHBOARD",label:"Dashboard",icon:$E},{id:"SMART_SEARCH",label:"Search (Layer 2)",icon:Pf},{id:"RAG_SEARCH",label:"LogosChat (Layer 3)",icon:WE},{id:"FLOW",label:"Flux (Layer 4)",icon:wD},{id:"BOOK",label:"Books",icon:sx},{id:"ARTICLE",label:"Articles",icon:pf},{id:"WEBSITE",label:"Websites",icon:mf},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:qE},{id:"NOTES",label:"All Notes",icon:VE}];return h.jsxs(h.Fragment,{children:[n&&h.jsx("div",{className:"fixed inset-0 bg-slate-900/50 z-40 lg:hidden backdrop-blur-sm",onClick:r}),h.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50 w-[269px] bg-[#262D40] border-r border-white/10 transform transition-transform duration-300 ease-in-out flex flex-col shadow-xl lg:shadow-none h-full
        ${n?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:[h.jsxs("div",{className:"px-3 pt-0 pb-3 flex flex-col items-center border-b border-white/10 bg-[#262D40] gap-2 relative",children:[h.jsx("img",{src:fM,alt:"TomeHub Icon",className:"h-[68px] lg:h-[77px] w-auto object-contain brightness-110 drop-shadow-md"}),h.jsx("button",{onClick:r,className:"lg:hidden absolute top-2 right-3 p-1 hover:bg-white/10 rounded-full text-white/70 hover:text-white transition-colors",children:h.jsx(ds,{size:20})})]}),h.jsx("nav",{className:"flex-1 px-3 pt-2 pb-6 space-y-1 overflow-y-auto",children:l.map(c=>{const d=c.icon,p=t===c.id;return h.jsxs("button",{onClick:()=>{e(c.id),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${p?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[h.jsx(d,{className:`w-[18px] h-[18px] lg:w-5 lg:h-5 transition-colors ${p?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),c.label]},c.id)})}),h.jsxs("div",{className:"p-3 border-t border-white/10",children:[h.jsxs("button",{onClick:()=>{e("PROFILE"),r()},className:`w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium transition-all duration-200 group ${t==="PROFILE"?"bg-white/10 text-white shadow-sm border-r-2 border-[#CC561E]":"text-white/70 hover:bg-white/5 hover:text-white"}`,children:[h.jsx(ab,{className:`w-[17px] h-[17px] lg:w-5 lg:h-5 transition-colors ${t==="PROFILE"?"text-[#CC561E]":"text-white/60 group-hover:text-white"}`}),"Profile"]}),h.jsx("button",{onClick:a,className:"w-full flex items-center gap-3 px-3 py-2.5 lg:py-3 rounded-xl text-[13px] lg:text-sm font-medium text-white/70 hover:bg-white/5 hover:text-white transition-all duration-200 group mt-1",children:s==="light"?h.jsxs(h.Fragment,{children:[h.jsx(U3,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-white/60 group-hover:text-white"}),"Dark Mode"]}):h.jsxs(h.Fragment,{children:[h.jsx(kR,{className:"w-[17px] h-[17px] lg:w-5 lg:h-5 text-amber-400"}),"Light Mode"]})})]}),h.jsx("div",{className:"p-4 border-t border-white/10",children:h.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[h.jsx("p",{className:"text-[13px] text-white/70 font-medium mb-1",children:"My Personal Library"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CC561E] animate-pulse"}),h.jsx("p",{className:"text-[11px] text-white/50 uppercase tracking-wider font-semibold",children:"Online"})]})]})})]})]})},Oq=({books:t,userId:e})=>{const[n,r]=E.useState(!1),[s,a]=E.useState(0),[l,c]=E.useState({success:0,failed:0,total:0}),[d,p]=E.useState(""),[m,g]=E.useState(null),[b,v]=E.useState(!1),w=async()=>{if(!e)return;r(!0),g(null),v(!1);let C=0,k=0;c({success:0,failed:0,total:t.length});const N=t.map(j=>{if(Pt(j)&&!YE(j))return null;let F="";return j.type==="PERSONAL_NOTE"?(F=al(j.generalNotes||"")||j.title,j.highlights&&j.highlights.length>0&&(F+=`

`+j.highlights.map(G=>G.text).join(`

`))):(F=`Title: ${j.title}
Author: ${j.author}
`,j.generalNotes&&(F+=`
Summary/Notes: ${al(j.generalNotes)}`),j.tags&&j.tags.length>0&&(F+=`
Tags: ${j.tags.join(", ")}`)),{text:F,title:j.title,author:j.author,type:Pt(j)?JE(j):j.type,book_id:j.id,tags:j.tags}}).filter(j=>!!j&&j.text.length>20),M=N.length,_=20,P=[];for(let j=0;j<N.length;j+=_)P.push(N.slice(j,j+_));let I=0;for(let j=0;j<P.length;j++){const F=P[j];p(`Batch ${j+1}/${P.length} (${F.length} items)`);try{const G=await HV(F,e);G.success&&G.results&&(C+=G.results.success,k+=G.results.failed)}catch(G){console.error(`Batch ${j+1} failed:`,G),k+=F.length}I+=F.length,a(Math.round(I/M*100)),c(G=>({...G,success:C,failed:k+(t.length-M)}))}const q=t.filter(j=>j.highlights&&j.highlights.length>0);if(q.length>0){p("Syncing highlights...");for(const j of q)try{await aM(e,j.id,j.title,j.author,j.highlights||[])}catch(F){console.error(`Highlight sync failed for ${j.title}:`,F)}}r(!1),v(!0),p("")};return h.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-slate-50 dark:from-[#262D40]/20 dark:to-slate-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:h.jsxs("div",{className:"p-6 md:p-8",children:[h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(G4,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Migrate to AI Library"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Sync your existing books and notes to the new AI backend to make them searchable."})]})]}),h.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[h.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:n?"Migration in Progress...":"Ready to Sync"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:b?h.jsxs("span",{className:"text-[#262D40] font-medium",children:["Migration Complete! ",l.success," items synced."]}):n?h.jsxs("span",{children:["Syncing: ",h.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:d})]}):h.jsxs("span",{children:["Sync ",t.length," items to Oracle AI Vector Database."]})})]}),!n&&!b&&h.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-6 py-3 bg-[#CC561E] text-white hover:bg-[#b34b1a] rounded-lg font-medium transition-colors shadow-md shadow-[#CC561E]/20 dark:shadow-none",children:[h.jsx(wE,{size:18,fill:"currentColor"}),"Start Migration"]}),n&&h.jsxs("div",{className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-slate-500 rounded-lg border border-slate-200 dark:border-slate-700",children:[h.jsx(nn,{size:18,className:"animate-spin"}),"Processing..."]})]}),(n||b)&&h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[h.jsx("span",{children:"Progress"}),h.jsxs("span",{children:[s,"%"]})]}),h.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300 ease-out",style:{width:`${s}%`}})}),h.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[h.jsxs("span",{children:[l.success+l.failed,"/",l.total," items"]}),h.jsxs("span",{children:["Success: ",l.success,"  Failed: ",l.failed]})]})]})]})]})})},_q=()=>{const{user:t}=yp(),[e,n]=E.useState(!1),[r,s]=E.useState(0),[a,l]=E.useState(0),[c,d]=E.useState(!1),[p,m]=E.useState(null),g=E.useRef(null),b=async C=>{var M;const k=(M=C.target.files)==null?void 0:M[0];if(!k)return;if(!k.name.toLowerCase().endsWith(".json")){m("Please upload a valid JSON file.");return}const N=new FileReader;N.onload=async _=>{var P;try{const I=(P=_.target)==null?void 0:P.result,q=JSON.parse(I);if(!Array.isArray(q))throw new Error("JSON must be an array of books.");await v(q)}catch(I){console.error("File parsing error:",I),m("Failed to parse JSON file. Make sure it's a valid list of books.")}},N.onerror=()=>{m("Error reading file.")},N.readAsText(k)},v=async C=>{if(!t)return;n(!0),m(null),d(!1),l(C.length),s(0);let k=0;try{for(const N of C){const M={id:Date.now().toString()+Math.random().toString(36).substr(2,9),type:"BOOK",title:N.title||"Untitled",author:N.author||"Unknown Author",status:"On Shelf",readingStatus:"To Read",tags:[],highlights:[],addedAt:Date.now(),coverUrl:N.coverUrl||void 0};await _a(t.uid,M);try{const _=`Title: ${M.title}
Author: ${M.author}`;await iM(_,M.title,M.author,M.type,t.uid,{book_id:M.id,tags:M.tags||[]})}catch(_){console.error("Import sync to AI backend failed:",_)}k++,s(k),await new Promise(_=>setTimeout(_,50))}d(!0),g.current&&(g.current.value="")}catch(N){console.error("Import failed:",N),m("Failed to import books. Please try again.")}finally{n(!1)}},w=()=>{var C;(C=g.current)==null||C.click()};return h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 md:p-8 mt-6",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Import Books"}),h.jsx("p",{className:"text-slate-500 mt-1",children:"Upload a JSON file to add books to your library."})]}),h.jsx("div",{className:"p-3 bg-[#262D40]/5 text-[#262D40] rounded-lg",children:h.jsx(bE,{size:24})})]}),p&&h.jsxs("div",{className:"mb-4 p-4 bg-red-50 text-red-700 rounded-lg flex items-center gap-2",children:[h.jsx(rl,{size:20}),p]}),c?h.jsxs("div",{className:"mb-4 p-4 bg-green-50 text-green-700 rounded-lg flex items-center gap-2",children:[h.jsx(ib,{size:20}),"Successfully imported ",a," books!"]}):null,e?h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[h.jsx("span",{children:"Importing..."}),h.jsxs("span",{children:[Math.round(r/a*100),"%"]})]}),h.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2.5 overflow-hidden",children:h.jsx("div",{className:"bg-[#262D40]/40 h-2.5 rounded-full transition-all duration-300",style:{width:`${r/a*100}%`}})}),h.jsxs("p",{className:"text-xs text-slate-400 text-center mt-2",children:[r," / ",a," books processed"]})]}):h.jsxs(h.Fragment,{children:[h.jsx("input",{type:"file",ref:g,onChange:b,accept:".json",className:"hidden"}),h.jsxs("button",{onClick:w,disabled:e,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white shadow-md hover:shadow-lg",children:[h.jsx(Of,{size:20}),"Select JSON File"]})]})]})},Rq=({books:t})=>{const[e,n]=E.useState(!1),[r,s]=E.useState(!1),[a,l]=E.useState(null),c=()=>{try{n(!0),l(null),s(!1);const d=t.map(w=>({...w,id:w.id,type:w.type,title:w.title,author:w.author,status:w.status,readingStatus:w.readingStatus,tags:w.tags,highlights:w.highlights,addedAt:w.addedAt,generalNotes:w.generalNotes,coverUrl:w.coverUrl,isbn:w.isbn,publisher:w.publisher,publicationYear:w.publicationYear,translator:w.translator,code:w.code,url:w.url,lentTo:w.lentTo,lentDate:w.lentDate})),p=JSON.stringify(d,null,2),m=new Blob([p],{type:"application/json"}),g=URL.createObjectURL(m),b=document.createElement("a");b.href=g;const v=new Date().toISOString().split("T")[0];b.download=`tomehub-export-${v}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(g),s(!0),n(!1),setTimeout(()=>{s(!1)},3e3)}catch(d){console.error("Export failed:",d),l("Failed to export library. Please try again."),n(!1)}};return h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 md:p-8 mt-6",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Export Library"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Download your entire library as a JSON file."})]}),h.jsx("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg",children:h.jsx(bE,{size:24})})]}),a&&h.jsxs("div",{className:"mb-4 p-4 bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/82 rounded-lg flex items-center gap-2 border border-[#262D40]/8 dark:border-[#262D40]/30",children:[h.jsx(rl,{size:20}),a]}),r&&h.jsxs("div",{className:"mb-4 p-4 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-400 rounded-lg flex items-center gap-2 border border-orange-100 dark:border-orange-900/30",children:[h.jsx(ib,{size:20}),"Successfully exported ",t.length," items!"]}),h.jsxs("button",{onClick:c,disabled:e||t.length===0,className:"w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors bg-[#CC561E] dark:bg-[#CC561E] hover:bg-[#b34b1a] text-white shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(Y4,{size:20}),t.length===0?"No Items to Export":`Export ${t.length} Items`]}),h.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 text-center mt-3",children:"Exports all books, articles, websites, and notes with highlights"})]})},Dq=({userId:t,email:e,onLogout:n,onBack:r,books:s,onStartEnrichment:a,onStopEnrichment:l,isEnriching:c,enrichmentStats:d})=>{const p=s.filter(m=>m.type==="BOOK"&&(!m.generalNotes||m.generalNotes.length<10)&&(!m.tags||m.tags.length===0)).length;return h.jsxs("div",{className:"p-6 md:p-10 max-w-[1100px] w-full mx-auto animate-in fade-in slide-in-from-bottom-4",children:[h.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white mb-6 transition-colors group",children:[h.jsx(pE,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),h.jsx("span",{className:"font-medium",children:"Back"})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Profile"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Manage your account settings"})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden mb-8",children:[h.jsxs("div",{className:"p-6 md:p-8 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-start md:items-center gap-6",children:[h.jsx("div",{className:"w-20 h-20 bg-[#262D40]/8 dark:bg-[#262D40]/30 rounded-full flex items-center justify-center text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(ab,{size:40})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Account Information"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Signed in as"}),h.jsx("p",{className:"text-lg font-medium text-slate-900 dark:text-slate-200 mt-1",children:e||"No email available"})]})]}),h.jsx("div",{className:"p-6 md:p-8 bg-slate-50/50 dark:bg-slate-900/50",children:h.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30",children:[h.jsx(L3,{size:20}),"Log Out"]})})]}),h.jsx("div",{className:"bg-gradient-to-br from-[#262D40]/5 to-purple-50 dark:from-[#262D40]/20 dark:to-purple-900/20 rounded-xl border border-[#262D40]/8 dark:border-[#262D40]/70 shadow-sm overflow-hidden mb-8",children:h.jsxs("div",{className:"p-6 md:p-8",children:[h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:"p-3 bg-white dark:bg-slate-900 rounded-lg shadow-sm text-[#262D40] dark:text-[#262D40]/82",children:h.jsx(Ws,{size:24})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"AI Library Assistant"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mt-1",children:"Automatically fill in missing summaries and tags for your imported books."})]})]}),h.jsxs("div",{className:"bg-white/60 dark:bg-slate-900/60 rounded-xl p-6 border border-[#262D40]/50 dark:border-[#262D40]/50",children:[h.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:c?"Enrichment in Progress...":"Library Status"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:c?h.jsxs("span",{children:["Processing: ",h.jsx("span",{className:"font-medium text-[#262D40] dark:text-[#262D40]/82",children:d.currentBookTitle||"Initializing..."})]}):h.jsxs("span",{children:[h.jsx("span",{className:"font-bold text-[#262D40] dark:text-[#262D40]/82",children:p})," books are missing details."]})})]}),c?h.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-6 py-3 bg-white dark:bg-slate-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg font-medium transition-colors border border-red-100 dark:border-red-900/30 shadow-sm",children:[h.jsx(bR,{size:18,fill:"currentColor"}),"Stop"]}):h.jsxs("button",{onClick:()=>a(s),disabled:p===0,className:"flex items-center gap-2 px-6 py-3 bg-[#262D40]/40 dark:bg-[#262D40]/30 text-white hover:bg-[#262D40]/55 dark:hover:bg-[#262D40]/40 rounded-lg font-medium transition-colors shadow-md shadow-[#262D40]/12 dark:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(wE,{size:18,fill:"currentColor"}),"Auto-fill Missing Info"]})]}),c&&h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[h.jsx("span",{children:"Progress"}),h.jsxs("span",{children:[Math.round(d.processed/d.total*100),"%"]})]}),h.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-[#262D40]/30 dark:bg-[#262D40]/24 transition-all duration-500 ease-out",style:{width:`${d.processed/d.total*100}%`}})}),h.jsxs("div",{className:"flex justify-between text-xs text-slate-400 dark:text-slate-500 mt-2",children:[h.jsxs("span",{children:["Processed: ",d.processed,"/",d.total]}),h.jsxs("span",{children:["Success: ",d.success,"  Failed: ",d.failed]})]})]})]})]})}),h.jsx(Oq,{books:s,userId:t}),h.jsx(_q,{}),h.jsx(Rq,{books:s})]})},Lq=({data:t,onBarClick:e,currentStartPage:n,currentEndPage:r})=>{const{maxPage:s,maxCount:a,bars:l}=E.useMemo(()=>{if(!t||t.length===0)return{maxPage:0,maxCount:0,bars:[]};const c=Math.max(...t.map(p=>p.page_number)),d=Math.max(...t.map(p=>p.count));return{maxPage:c,maxCount:d,bars:t}},[t]);return l.length===0?null:h.jsxs("div",{className:"w-full space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 font-mono uppercase tracking-wider",children:[h.jsx("span",{children:"Page 1"}),h.jsx("span",{children:"Distribution Timeline"}),h.jsxs("span",{children:["Page ",s]})]}),h.jsxs("div",{className:"relative w-full h-[60px] bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden flex items-end",children:[h.jsxs("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none p-[1px]",children:[h.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"}),h.jsx("div",{className:"w-full h-px border-t border-dashed border-slate-200 dark:border-slate-700/50 opacity-50"})]}),l.map(c=>{const d=(c.page_number-1)/s*100,p=c.count/a*100,m=c.count>a*.7;return h.jsxs("div",{onClick:()=>e&&e(c.page_number),className:"absolute bottom-0 cursor-pointer transition-all hover:opacity-80 group",style:{left:`${d}%`,height:`${p}%`,width:`max(2px, ${100/s}%)`,minHeight:"4px"},children:[h.jsx("div",{className:`w-full h-full rounded-t-sm ${m?"bg-[#262D40]/30 dark:bg-[#262D40]/24":"bg-[#262D40]/18 dark:bg-[#262D40]/40"}`}),h.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block z-20 whitespace-nowrap",children:h.jsxs("div",{className:"bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg",children:["Page ",c.page_number,": ",c.count," hits"]})})]},c.page_number)})]})]})},pM=({bookId:t,term:e,initialContexts:n=[],firebaseUid:r,onClose:s})=>{const[a,l]=We.useState(n||[]),[c,d]=We.useState(!1),[p,m]=We.useState((a==null?void 0:a.length)||0),[g,b]=We.useState(((a==null?void 0:a.length)||0)>=10),[v,w]=We.useState([]);E.useEffect(()=>{(async()=>{try{const M=await $V(r,t,e);w(M.distribution||[])}catch(M){console.error("Dist fetch failed",M)}})()},[t,e,r]);const C=async()=>{if(!c){d(!0);try{const N=await UV(r,t,e,50,p);N.contexts.length>0?(l(M=>[...M,...N.contexts]),m(M=>M+N.contexts.length)):b(!1)}catch(N){console.error("Failed to load more contexts:",N)}finally{d(!1)}}},k=(N,M)=>{if(!M)return N;const _=N.split(new RegExp(`(${M})`,"gi"));return h.jsx(h.Fragment,{children:_.map((P,I)=>P.toLowerCase()===M.toLowerCase()?h.jsx("mark",{className:"bg-yellow-200 text-slate-900 font-semibold rounded-sm px-0.5",children:P},I):P)})};return h.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-950 border-l border-slate-200 dark:border-slate-800 shadow-xl animate-in slide-in-from-right duration-300",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-900 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:['"',e,'" Balamlar']}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total occurrences found"})]}),h.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-500",children:h.jsx(ds,{size:20})})]}),h.jsxs("div",{className:"p-3 bg-[#262D40]/5 dark:bg-[#262D40]/20 m-4 rounded-lg border border-[#262D40]/8 dark:border-[#262D40]/70 flex gap-3 text-xs text-[#262D40] dark:text-[#262D40]/78",children:[h.jsx(v3,{size:16,className:"shrink-0 mt-0.5"}),h.jsx("p",{children:"Bu liste, kelimenin kitaptaki farkl formlarn (ekim ekleri, kk formlar) ve getii orijinal pasajlar gsterir."})]}),h.jsx("div",{className:"px-4 pb-2",children:h.jsx(Lq,{data:v})}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[a.map((N,M)=>h.jsxs("div",{className:"group relative",children:[h.jsxs("div",{className:"flex justify-between items-start mb-1 text-[10px] items-center",children:[h.jsxs("span",{className:"font-semibold text-[#262D40] dark:text-[#262D40]/82 bg-[#262D40]/5 dark:bg-[#262D40]/40 px-1.5 py-0.5 rounded uppercase tracking-wider",children:["Sayfa ",N.page_number]}),h.jsxs("button",{className:"text-slate-300 group-hover:text-slate-500 dark:text-slate-700 dark:group-hover:text-slate-400 flex items-center gap-1 transition-colors",children:[h.jsx("span",{className:"text-[9px]",children:"GRNTLE"}),h.jsx($h,{size:10})]})]}),h.jsx("div",{className:"text-sm md:text-base text-slate-700 dark:text-slate-300 leading-relaxed font-lora border-l-2 border-slate-100 dark:border-slate-800 pl-4 py-1 italic hover:border-[#262D40]/18 dark:hover:border-[#262D40]/55 transition-colors",children:k(N.snippet,N.keyword_found)})]},M)),g&&h.jsx("button",{onClick:C,disabled:c,className:"w-full py-4 text-sm font-medium text-slate-500 hover:text-[#262D40] dark:hover:text-[#262D40]/82 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-xl hover:border-[#262D40]/12 dark:hover:border-[#262D40]/70 hover:bg-slate-50 dark:hover:bg-slate-900 transition-all flex items-center justify-center gap-2",children:c?h.jsxs(h.Fragment,{children:[h.jsx(nn,{size:16,className:"animate-spin"}),"Ykleniyor..."]}):"Daha Fazla Balam Ykle"})]})]})},Iq=new Set(["ve","veya","ile","ama","fakat","ancak","lakin","ki","de","da","gibi","icin","iin","gore","gre","kadar","hem","ya","yada","yahut","mi","mu","m","m"]);function zq({userId:t,onBack:e,books:n=[]}){const[r,s]=E.useState(""),[a,l]=E.useState([]),[c,d]=E.useState(!1),[p,m]=E.useState(null),[g,b]=E.useState(!1),[v,w]=E.useState(null),[C,k]=E.useState(!1),[N,M]=E.useState(0),[_,P]=E.useState(0),I=20,q=(F,G)=>{if(!G||!F)return F;const te={i:"[iI]",:"[iI]",s:"[sS]",:"[sS]",c:"[cC]",:"[cC]",g:"[gG]",:"[gG]",o:"[oO]",:"[oO]",u:"[uU]",:"[uU]"},he=G.toLowerCase().split(/\s+/).map(Ne=>Ne.trim()).filter(Ne=>Ne.length>=2&&!Iq.has(Ne));if(he.length===0)return F;try{const Ne=he.map(pe=>pe.split("").map(U=>te[U]||U).join("")),Se=new RegExp(`((?<![\\p{L}\\p{N}])(?:${Ne.join("|")})[\\p{L}\\p{N}]*(?![\\p{L}\\p{N}]))`,"giu");return F.split(Se).map((pe,U)=>U%2===1?h.jsx("mark",{className:"bg-[rgba(204,86,30,0.12)] dark:bg-[rgba(204,86,30,0.25)] text-[#111827] dark:text-white px-0.5 rounded font-medium shadow-sm transition-colors duration-200",children:pe},U):h.jsx("span",{children:pe},U))}catch{return F}},j=async(F,G=0)=>{var te,he,Ne;if(F&&F.preventDefault(),!!r.trim()){d(!0),m(null),G===0&&(l([]),b(!0)),M(G);try{const Se=`${nt}/api/smart-search`;console.log("[SmartSearch] Calling:",Se,"Offset:",G);const Te=await Rt(Se,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:r,firebase_uid:t,limit:I,offset:G})});if(!Te.ok)throw new Error(await Kr(Te,"Search failed"));const pe=await Te.json();((te=pe.metadata)==null?void 0:te.status)==="analytic"&&((he=pe.metadata)!=null&&he.analytics)?(w({...pe.metadata.analytics,answer:pe.answer}),l([]),P(0)):(l(pe.results||[]),P(pe.total||((Ne=pe.results)==null?void 0:Ne.length)||0),w(null))}catch(Se){console.error("[SmartSearch] Error:",Se),m(Go(Se))}finally{d(!1)}}};return h.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${g?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[h.jsxs("div",{className:"relative flex items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[h.jsx("div",{className:"flex-shrink-0 z-10",children:e&&h.jsxs("button",{onClick:e,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Wi,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),g&&h.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[h.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:h.jsx(Pf,{className:"w-5 h-5 md:w-8 md:h-8"})}),h.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"Search"})]}),h.jsx("div",{className:"w-20 hidden sm:block"})," "]}),h.jsx("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${g?"pt-4 md:pt-6":"justify-center items-center"}`,children:h.jsxs("form",{onSubmit:j,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${g?"max-w-none":"max-w-2xl text-center"}`,children:[!g&&h.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[h.jsxs("div",{className:"flex items-center justify-center gap-3",children:[h.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0",children:h.jsx(Pf,{className:"w-6 h-6 md:w-10 md:h-10"})}),h.jsx("h1",{className:"text-2xl md:text-5xl font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight",children:"Search"})]}),h.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 md:gap-4 mt-4 opacity-80",children:[h.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[h.jsx(Ws,{className:"w-3 h-3 text-[#CC561E]"})," AI Query Expansion"]}),h.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[h.jsx(_R,{className:"w-3 h-3"})," Typo Correction"]}),h.jsxs("span",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-[10px] md:text-xs font-bold text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:[h.jsx(Pa,{className:"w-3 h-3"})," Hybrid Retrieval"]})]})]}),h.jsxs("div",{className:"relative group",children:[h.jsx(Us,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),h.jsx("input",{type:"text",value:r,onChange:F=>s(F.target.value),placeholder:"Search your library intelligently...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400"})]}),h.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${g?"text-left":"text-center"}`,children:["Tip: ",h.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search."]})]})}),p&&h.jsxs("div",{className:"bg-[#262D40]/5 dark:bg-[#262D40]/20 text-[#262D40] dark:text-[#262D40]/78 p-5 rounded-2xl flex items-center gap-4 border border-[#262D40]/8 dark:border-[#262D40]/50 shadow-sm",children:[h.jsx(rl,{className:"w-6 h-6 shrink-0"}),h.jsx("p",{className:"font-medium",children:p})]}),h.jsx("div",{className:"space-y-6 pb-12 mt-6",children:a.length>0?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"flex items-center justify-between px-2",children:h.jsxs("span",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider",children:["Found ",_," relevant items"]})}),h.jsx("div",{className:"grid gap-5",children:a.map((F,G)=>h.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 border border-[#E6EAF2] dark:border-gray-700 transition-all duration-300",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("h3",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 flex items-center gap-3 group-hover:text-[#CC561E] transition-colors",children:[h.jsx(Pa,{className:"w-5 h-5 text-[#CC561E]"}),q(F.title,r)]}),h.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[F.match_type==="content_exact"&&h.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Match"}),F.match_type==="semantic"&&h.jsx("span",{className:"px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider bg-[#262D40] text-white ring-1 ring-white/10",children:"Semantic"}),h.jsxs("span",{className:"bg-[#262D40] text-white text-xs px-3 py-1 rounded-full font-mono font-medium ring-1 ring-white/10",children:["p.",F.page_number]})]})]}),h.jsx("div",{className:"pl-5 border-l-4 border-[#262D40]/10 group-hover:border-[#CC561E]/30 transition-colors",children:h.jsx("p",{className:"text-gray-700 dark:text-gray-200 leading-relaxed text-base whitespace-pre-wrap font-serif",children:q(F.content_chunk,r)})}),(F.comment||F.personal_comment)&&h.jsxs("div",{className:"mt-4 pt-4 border-t border-[#E6EAF2] dark:border-gray-700 bg-[rgba(204,86,30,0.08)] dark:bg-[rgba(204,86,30,0.1)] -mx-6 px-6 py-4 rounded-b-2xl",children:[h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#CC561E] block mb-1",children:"Comment:"}),h.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 italic border-l-2 border-[#CC561E]/30 pl-3",children:q(F.comment||F.personal_comment||"",r)})]})]},G))}),_>I&&h.jsxs("div",{className:"flex items-center justify-between mt-10 pt-6 border-t border-[#E6EAF2] dark:border-gray-700",children:[h.jsxs("button",{onClick:()=>j(void 0,Math.max(0,N-I)),disabled:c||N===0,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:[h.jsx(Wi,{size:20}),"Previous"]}),h.jsxs("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:["Page ",Math.floor(N/I)+1," of ",Math.ceil(_/I)]}),h.jsxs("button",{onClick:()=>j(void 0,N+I),disabled:c||N+I>=_,className:"px-6 py-3 bg-white dark:bg-gray-800 border border-[#E6EAF2] dark:border-gray-700 rounded-xl font-bold text-gray-700 dark:text-gray-200 hover:bg-[#F3F5FA] dark:hover:bg-gray-700 transition-all disabled:opacity-50 flex items-center gap-2 shadow-sm",children:["Next",h.jsx(Wi,{size:20,className:"rotate-180"})]})]})]}):g&&!c&&!p?h.jsxs("div",{className:"text-center py-24 opacity-60",children:[h.jsx("div",{className:"bg-[#F3F5FA] dark:bg-gray-800 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6",children:h.jsx(Us,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),h.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"No results found"})]}):null}),v&&h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-xl border-t-4 border-[#CC561E] animate-in zoom-in duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute right-[-20px] top-[-20px] opacity-[0.03] dark:opacity-[0.05] pointer-events-none",children:h.jsx(n3,{size:220})}),h.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] text-xs font-bold uppercase tracking-widest",children:[h.jsx(Ws,{size:12}),"Deterministic Analytics"]}),h.jsx("h3",{className:"text-3xl font-extrabold text-slate-900 dark:text-white leading-tight",children:v.answer})]}),v.contexts&&v.contexts.length>0&&h.jsxs("button",{onClick:()=>k(!0),className:"group flex items-center gap-3 bg-[#CC561E] hover:bg-[#b34b1a] text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-[#CC561E]/30 transition-all hover:scale-[1.02] active:scale-[0.98]",children:[h.jsx(yE,{size:20,className:"group-hover:rotate-12 transition-transform"}),"See Contexts"]})]})]}),C&&v&&h.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[h.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>k(!1)}),h.jsx("div",{className:"relative w-full max-w-lg h-full overflow-hidden",children:h.jsx(pM,{bookId:v.resolved_book_id||"",term:v.term,initialContexts:v.contexts,firebaseUid:t,onClose:()=>k(!1)})})]})]})}const Bq=(t,e)=>{const[n,r]=E.useState(!1),[s,a]=E.useState({total:0,processed:0,success:0,failed:0}),l=E.useRef(!1),c=E.useCallback(async p=>{const m=p.filter(b=>b.type==="BOOK"&&(!(b.summaryText||b.generalNotes)||(b.summaryText||b.generalNotes||"").length<10)&&(!b.tags||b.tags.length===0));if(m.length===0){alert("No books found that need enrichment!");return}r(!0),l.current=!1,a({total:m.length,processed:0,success:0,failed:0,currentBookTitle:""});const g=5;for(let b=0;b<m.length&&!l.current;b+=g){const v=m.slice(b,b+g),w=v.map(C=>C.title).join(", ");a(C=>({...C,currentBookTitle:`Batch: ${w.substring(0,30)}...`}));try{b>0&&await new Promise(N=>setTimeout(N,2e3));const C=v.map(N=>xp(N)),k=await Z5(C);for(let N=0;N<v.length;N++){const M=v[N],_=k.find(P=>P.title===M.title)||k[N];if(_){const P=bp(M,_);await _a(t,P),e(P),a(I=>({...I,processed:I.processed+1,success:I.success+1}))}else a(P=>({...P,processed:P.processed+1,failed:P.failed+1}))}}catch(C){console.error(`Failed to enrich batch starting at ${b}:`,C),a(k=>({...k,processed:k.processed+v.length,failed:k.failed+v.length}))}}r(!1),a(b=>({...b,currentBookTitle:void 0}))},[t,e]),d=E.useCallback(()=>{l.current=!0},[]);return{isEnriching:n,stats:s,startEnrichment:c,stopEnrichment:d}},Pq=({state:t})=>{const[e,n]=E.useState(!1);return!t.active_topic&&(!t.assumptions||t.assumptions.length===0)?null:h.jsx("div",{className:"sticky top-0 z-10 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border-b border-[#CC561E]/10 dark:border-slate-700 shadow-sm transition-all",children:h.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-2 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>n(!e),children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("div",{className:"p-1.5 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-md flex-shrink-0",children:h.jsx(xE,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("p",{className:"text-[10px] font-bold text-[#CC561E] dark:text-[#f3a47b] uppercase tracking-widest",children:"Current Topic"}),h.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:t.active_topic||"Initializing exploration..."})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[t.assumptions&&t.assumptions.length>0&&h.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 text-xs px-2 py-1 rounded-full bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 border border-amber-100 dark:border-amber-800/50",children:[h.jsx(Ui,{className:"w-3 h-3"}),t.assumptions.length," Assumptions"]}),e?h.jsx(gE,{className:"w-4 h-4 text-slate-400"}):h.jsx(Ra,{className:"w-4 h-4 text-slate-400"})]})]}),e&&h.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-700 space-y-4 pb-2 animate-fade-in-down",children:[t.assumptions&&t.assumptions.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx(Ui,{className:"w-3 h-3"})," Working Assumptions"]}),h.jsx("div",{className:"grid gap-2",children:t.assumptions.map((r,s)=>h.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 bg-amber-50/50 dark:bg-amber-900/10 p-2 rounded border-l-2 border-amber-400",children:[r.text,h.jsxs("span",{className:"ml-2 text-xs text-amber-600 dark:text-amber-500 font-medium opacity-75",children:["(",r.confidence,")"]})]},s))})]}),t.open_questions&&t.open_questions.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx(B4,{className:"w-3 h-3"})," Open Questions"]}),h.jsx("ul",{className:"space-y-1",children:t.open_questions.map((r,s)=>h.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[h.jsx("span",{className:"text-slate-400 mt-1.5",children:""}),r]},s))})]}),t.established_facts&&t.established_facts.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h4",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[h.jsx(Yc,{className:"w-3 h-3"})," Validated Facts"]}),h.jsx("ul",{className:"space-y-1",children:t.established_facts.map((r,s)=>h.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-300 flex items-start gap-2",children:[h.jsx(Yc,{className:"w-3 h-3 text-green-500 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[r.text,h.jsxs("span",{className:"ml-1 text-xs text-slate-400",children:["[",r.source,"]"]})]})]},s))})]})]})]})})},Hq=({userId:t,onBack:e})=>{var U,Z,K,z,H,A,R,W,oe,be,L,ae;const[n,r]=E.useState([]),[s,a]=E.useState(""),[l,c]=E.useState(!1),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState(new Set),[w,C]=E.useState(new Set),[k,N]=E.useState(null),[M,_]=E.useState("AUTO"),[P,I]=E.useState({}),q=E.useRef(null),j=E.useRef(null);E.useEffect(()=>{var $;($=q.current)==null||$.scrollIntoView({behavior:"smooth"})},[n]),E.useEffect(()=>{var $;($=j.current)==null||$.focus()},[]);const F=async()=>{var ne;if(!s.trim()||l)return;if(!t||t.includes("@")){g("Authentication error. Please refresh the page.");return}const $={id:Date.now(),role:"user",content:s.trim(),timestamp:new Date().toISOString()};r(ie=>[...ie,$]),a(""),c(!0),g(null);try{const ie=await IV($.content,t,d,"EXPLORER",null,20,M);ie.session_id&&p(ie.session_id),ie.conversation_state&&I(ie.conversation_state);const Oe={id:Date.now()+1,role:"assistant",content:ie.answer||"",sources:ie.sources||[],thinkingHistory:ie.thinking_history||[],timestamp:ie.timestamp||new Date().toISOString()};r($e=>[...$e,Oe])}catch(ie){g(ie instanceof Error?ie.message:"Failed to send message")}finally{c(!1),(ne=j.current)==null||ne.focus()}},G=$=>{$.key==="Enter"&&!$.shiftKey&&($.preventDefault(),F())},te=$=>{C(ne=>{const ie=new Set(ne);return ie.has($)?ie.delete($):ie.add($),ie})},he=$=>{v(ne=>{const ie=new Set(ne);return ie.has($)?ie.delete($):ie.add($),ie})},Ne=()=>{var $;r([]),p(null),g(null),I({}),($=j.current)==null||$.focus()},Se=$=>$.replace(/\[DNCE SREC\][\s\S]*?\[\/DNCE SREC\]/,"").replace(/## AAMA 0:[\s\S]*?(?=##)/,"").trim(),Te=($,ne,ie)=>ne?$.split(/(\[ID: \d+\])/g).map(($e,lt)=>{const Ue=$e.match(/\[ID: (\d+)\]/);if(Ue){const rt=parseInt(Ue[1]);if(ne.find(Me=>Me.id===rt))return h.jsx("button",{onMouseEnter:Me=>{const st=Me.currentTarget.getBoundingClientRect();N({id:rt,messageId:ie||0,x:st.left,y:st.top-10})},onMouseLeave:()=>N(null),className:"inline-flex items-center justify-center w-5 h-5 mx-0.5 text-[10px] font-bold bg-[#CC561E]/10 dark:bg-[#CC561E]/20 text-[#CC561E] dark:text-[#f3a47b] rounded-md border border-[#CC561E]/20 dark:border-[#CC561E]/30 hover:bg-[#CC561E] hover:text-white transition-all transform hover:-translate-y-0.5 cursor-help",children:rt},lt)}return $e}):$,pe=($,ne,ie)=>{const Oe=Se($);let $e=!1;return Oe.split(`
`).map((lt,Ue)=>{const rt=lt.trim();if(rt.toLowerCase().includes("keif nerileri")||rt.toLowerCase().includes("exploration paths"))return $e=!0,h.jsxs("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 mt-6 mb-3 flex items-center gap-2",children:[h.jsx(xE,{className:"w-4 h-4 text-[#CC561E]"}),rt]},Ue);if(rt.startsWith("## ")||rt.startsWith("### ")&&!$e)return h.jsx("h3",{className:"text-base font-bold text-[#CC561E] dark:text-[#f3a47b] mt-5 mb-2",children:rt.replace(/^#+\s+/,"")},Ue);if(rt==="")return h.jsx("div",{className:"h-2"},Ue);if($e&&(rt.startsWith("-")||rt.startsWith("")||/^\d+\./.test(rt))){const pt=rt.replace(/^[-\d.]+\s+/,"");return h.jsx("div",{onClick:()=>{l||a(pt)},className:"ml-2 mb-2 p-3 bg-white dark:bg-slate-800/50 border border-[#CC561E]/10 dark:border-[#CC561E]/20 rounded-xl shadow-sm hover:shadow-md hover:border-[#CC561E]/40 dark:hover:border-[#CC561E]/60 transition-all cursor-pointer group active:scale-[0.98]",children:h.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-200 flex items-center gap-3",children:[h.jsxs("span",{className:"w-6 h-6 flex-shrink-0 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full flex items-center justify-center text-[10px] font-bold text-[#CC561E] group-hover:bg-[#CC561E] group-hover:text-white transition-colors",children:[Ue-10," "]}),pt]})},Ue)}else return h.jsx("p",{className:`text-sm leading-relaxed mb-2 ${$e?"text-slate-500 dark:text-slate-400 italic":"text-slate-700 dark:text-slate-300"}`,children:Te(lt,ne,ie)},Ue)})};return h.jsx("div",{className:"flex h-[calc(100vh-120px)] w-full gap-4",children:h.jsxs("div",{className:"flex flex-col flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-t-xl",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-lg",children:h.jsx(Z0,{className:"w-5 h-5 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"font-semibold text-slate-900 dark:text-white",children:"Explorer Mode"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:d?`Session #${d}  ${n.length} messages`:"New conversation"})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-slate-200 dark:border-slate-700 text-xs text-slate-600 dark:text-slate-300 bg-slate-50 dark:bg-slate-800",children:[h.jsx("input",{type:"checkbox",checked:M==="BOOK_FIRST",onChange:$=>_($.target.checked?"BOOK_FIRST":"AUTO"),className:"w-3.5 h-3.5 rounded border-slate-300 text-[#CC561E] focus:ring-[#CC561E]/40","aria-label":"Bu kitapla snrla"}),"Bu kitapla snrla"]}),h.jsxs("button",{onClick:Ne,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Start new conversation",children:[h.jsx(kE,{className:"w-4 h-4"}),"New"]}),e&&h.jsx("button",{onClick:e,className:"px-3 py-1.5 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Back"})]})]}),h.jsx(Pq,{state:P}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 dark:bg-slate-900",children:[n.length===0&&!l&&h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[h.jsx("div",{className:"p-4 bg-[#CC561E]/10 dark:bg-[#CC561E]/20 rounded-full mb-4",children:h.jsx(Pa,{className:"w-8 h-8 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"Explorer Mode"}),h.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-md",children:"Ask deep, philosophical questions. I'll analyze your notes dialectically, identify gaps, and expand with general knowledge when needed."}),h.jsx("div",{className:"mt-6 space-y-2",children:["What is the relationship between consciousness and reality?","How do different philosophers define virtue?","Analyze the concept of free will in my notes"].map(($,ne)=>h.jsx("button",{onClick:()=>a($),className:"block w-full text-left px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300 hover:bg-[#CC561E]/5 dark:hover:bg-[#CC561E]/10 transition-colors",children:$},ne))})]}),n.map($=>h.jsxs("div",{className:`flex gap-3 ${$.role==="user"?"justify-end":"justify-start"}`,children:[$.role==="assistant"&&h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:h.jsx(C2,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsxs("div",{className:`max-w-[80%] ${$.role==="user"?"order-first":""}`,children:[$.role==="assistant"&&$.thinkingHistory&&$.thinkingHistory.length>0&&h.jsxs("div",{className:"mb-2",children:[h.jsxs("button",{onClick:()=>te($.id),className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-400 hover:text-[#CC561E] transition-colors",children:[h.jsx(T4,{className:"w-3 h-3"}),w.has($.id)?"Hide Reflection":"Show Reflection",h.jsxs("span",{className:"opacity-50",children:[" ",$.thinkingHistory.length," Iterations"]})]}),w.has($.id)&&h.jsx("div",{className:"mt-2 mb-3 space-y-3 bg-slate-100/50 dark:bg-slate-800/50 p-3 rounded-xl border border-dashed border-slate-200 dark:border-slate-700 animate-fade-in",children:$.thinkingHistory.map((ne,ie)=>h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ne.evaluation.verdict==="PASSED"?"bg-green-500":ne.evaluation.verdict==="DECLINE"?"bg-red-500":"bg-amber-500"}`}),h.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:["STEP ",ne.attempt,": ",ne.evaluation.verdict]})]}),h.jsxs("span",{className:"text-[10px] text-slate-400 flex items-center gap-1",children:[h.jsx(u3,{className:"w-2.5 h-2.5"}),(ne.latency/1e3).toFixed(1),"s"]})]}),h.jsx("div",{className:"h-1 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:h.jsx("div",{className:`h-full transition-all duration-1000 ${ne.evaluation.overall_score>.7?"bg-green-500":ne.evaluation.overall_score>.4?"bg-amber-500":"bg-red-500"}`,style:{width:`${ne.evaluation.overall_score*100}%`}})}),h.jsx("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-snug",children:ne.evaluation.explanation})]},ie))})]}),h.jsx("div",{className:`rounded-2xl px-4 py-3 ${$.role==="user"?"bg-[#CC561E] text-white rounded-br-md shadow-lg shadow-[#CC561E]/20":"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-bl-md"}`,children:$.role==="user"?h.jsx("p",{className:"text-sm",children:$.content}):h.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:pe($.content,$.sources,$.id)})}),$.role==="assistant"&&$.sources&&$.sources.length>0&&h.jsxs("div",{className:"mt-2",children:[h.jsxs("button",{onClick:()=>he($.id),className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400 hover:text-[#CC561E] dark:hover:text-[#f3a47b] transition-colors",children:[b.has($.id)?h.jsx(gE,{className:"w-3 h-3"}):h.jsx(Ra,{className:"w-3 h-3"}),$.sources.length," sources"]}),b.has($.id)&&h.jsx("div",{className:"mt-2 space-y-1 pl-2 border-l-2 border-[#CC561E]/30 dark:border-[#CC561E]/50",children:$.sources.map((ne,ie)=>h.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 py-1 transition-colors hover:bg-slate-100 dark:hover:bg-slate-800/50 rounded px-1",children:[h.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[9px] font-bold",children:ne.id||ie+1}),h.jsx("span",{className:"font-medium",children:ne.title}),h.jsxs("span",{className:"ml-2 text-slate-400 text-[10px]",children:["p.",ne.page_number]})]},ie))})]})]}),$.role==="user"&&h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E] flex items-center justify-center",children:h.jsx(ab,{className:"w-4 h-4 text-white"})})]},$.id)),k&&h.jsx("div",{className:"fixed z-50 pointer-events-none",style:{left:k.x,top:k.y-120},children:h.jsxs("div",{className:"w-64 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-2xl p-4 animate-in fade-in zoom-in duration-200 origin-bottom",children:[(Z=(U=n.find($=>$.id===k.messageId))==null?void 0:U.sources)!=null&&Z.find($=>$.id===k.id)?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2 text-[#CC561E]",children:[h.jsx(Jc,{className:"w-3 h-3"}),h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Source Snippet"})]}),h.jsxs("p",{className:"text-[11px] text-slate-600 dark:text-slate-300 leading-relaxed italic mb-3",children:['"...',(A=(H=(z=(K=n.find($=>$.id===k.messageId))==null?void 0:K.sources)==null?void 0:z.find($=>$.id===k.id))==null?void 0:H.content)==null?void 0:A.slice(0,200),'..."']}),h.jsxs("div",{className:"flex items-center justify-between border-t border-slate-100 dark:border-slate-700 pt-2 text-[10px] text-slate-400",children:[h.jsx("span",{className:"font-medium truncate max-w-[120px]",children:(oe=(W=(R=n.find($=>$.id===k.messageId))==null?void 0:R.sources)==null?void 0:W.find($=>$.id===k.id))==null?void 0:oe.title}),h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx($h,{className:"w-2.5 h-2.5"}),"p.",(ae=(L=(be=n.find($=>$.id===k.messageId))==null?void 0:be.sources)==null?void 0:L.find($=>$.id===k.id))==null?void 0:ae.page_number]})]})]}):h.jsx("p",{className:"text-xs text-slate-400",children:"Loading source info..."}),h.jsx("div",{className:"absolute -bottom-1 left-4 w-2 h-2 bg-white dark:bg-slate-800 border-r border-b border-slate-200 dark:border-slate-700 rotate-45"})]})}),l&&h.jsxs("div",{className:"flex gap-3",children:[h.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-[#CC561E]/10 dark:bg-[#CC561E]/20 flex items-center justify-center",children:h.jsx(C2,{className:"w-4 h-4 text-[#CC561E] dark:text-[#f3a47b]"})}),h.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:h.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[h.jsx(nn,{className:"w-4 h-4 animate-spin"}),"Analyzing deeply..."]})})]}),m&&h.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-300",children:m}),h.jsx("div",{ref:q})]}),h.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-b-xl",children:h.jsxs("div",{className:"flex gap-3",children:[h.jsx("input",{ref:j,type:"text",value:s,onChange:$=>a($.target.value),onKeyPress:G,placeholder:"Ask a deep question...",disabled:l,className:"flex-1 px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#CC561E] focus:border-transparent disabled:opacity-50"}),h.jsx("button",{onClick:F,disabled:!s.trim()||l,className:"px-4 py-3 bg-[#CC561E] hover:bg-[#b34b1a] disabled:bg-slate-300 dark:disabled:bg-slate-800 disabled:text-slate-500 dark:disabled:text-slate-500 disabled:opacity-50 text-white rounded-xl transition-all shadow-lg shadow-[#CC561E]/20 flex items-center gap-2",children:l?h.jsx(nn,{className:"w-5 h-5 animate-spin"}):h.jsx(lR,{className:"w-5 h-5"})})]})})]})})},Fq=({userId:t,userEmail:e,onBack:n,books:r=[]})=>{var he,Ne,Se,Te;const[s,a]=E.useState(""),[l,c]=E.useState(!1),[d,p]=E.useState(null),[m,g]=E.useState(null),[b,v]=E.useState("none"),[w,C]=E.useState(!1),[k,N]=E.useState("STANDARD"),[M,_]=E.useState(""),[P,I]=E.useState(!1);if(k==="EXPLORER")return h.jsxs("div",{className:"max-w-[1100px] w-full mx-auto p-6 animate-fade-in space-y-4",children:[h.jsx("div",{className:"flex justify-start",children:h.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Wi,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]})}),h.jsx("div",{className:"flex justify-center mb-2 md:mb-4",children:h.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center",children:[h.jsx("button",{type:"button",onClick:()=>N("STANDARD"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all text-slate-500 hover:text-slate-700 dark:text-slate-400",children:"Standard"}),h.jsxs("button",{type:"button",className:"px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:[h.jsx(Z0,{className:"w-4 h-4 text-[#CC561E]"})," Explorer"]})]})}),h.jsx(Hq,{userId:t,onBack:()=>N("STANDARD")})]});const q=async pe=>{if(pe.preventDefault(),!s.trim()){g("Please enter a question");return}if(!t||t.includes("@")){g("Authentication is still loading. Please wait a moment and try again.");return}c(!0),g(null),p(null),v("none");try{const U=await LV(s,t,"STANDARD");p(U),_(s)}catch(U){g(Go(U))}finally{c(!1)}},j=async pe=>{var U;if(!(!d||w)){C(!0);try{await zV({firebase_uid:t,query:M||s,answer:d.answer,rating:pe,search_log_id:(U=d.metadata)==null?void 0:U.search_log_id}),v(pe===1?"liked":"disliked")}catch(Z){console.error("Feedback failed:",Z)}finally{C(!1)}}},F=(d==null?void 0:d.answer)||"",G=Array.from(F.matchAll(/<think>([\s\S]*?)<\/think>/gi)).map(pe=>(pe[1]||"").trim()).filter(Boolean).join(`

`),te=F.replace(/<think>[\s\S]*?<\/think>/gi,"").replace(/## AAMA 0:[\s\S]*?(?=##|$)/i,"").trim();return h.jsxs("div",{className:`max-w-[1100px] w-full mx-auto p-3 md:p-6 flex flex-col transition-all duration-1000 ease-in-out ${d?"space-y-6 md:space-y-8":"min-h-[70vh]"}`,children:[h.jsxs("div",{className:"relative flex flex-row items-center justify-between w-full h-10 md:h-12 mb-2 md:mb-6",children:[h.jsx("div",{className:"flex items-center gap-3 md:gap-5 z-10",children:h.jsxs("button",{onClick:n,className:"group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-[#F3F5FA] dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Wi,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider hidden sm:inline",children:"Back"})]})}),d&&h.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center gap-2 md:gap-3 transition-all duration-500 origin-center animate-in fade-in zoom-in-95",children:[h.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-2xl shrink-0 scale-75",children:h.jsx(Pf,{className:"w-5 h-5 md:w-8 md:h-8"})}),h.jsx("h1",{className:"font-extrabold bg-gradient-to-r from-[#CC561E] to-[#e66a2e] bg-clip-text text-transparent tracking-tight text-xl md:text-2xl",children:"LogosChat"})]}),h.jsxs("div",{className:"bg-[#F3F5FA] dark:bg-slate-800 p-0.5 md:p-1 rounded-lg inline-flex items-center z-10",children:[h.jsx("button",{type:"button",className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all bg-white dark:bg-slate-700 text-[#CC561E] shadow-sm",children:"Standard"}),h.jsxs("button",{type:"button",onClick:()=>N("EXPLORER"),className:"px-3 md:px-4 py-1.5 md:py-2 rounded-md text-xs md:text-sm font-medium transition-all flex items-center gap-1.5 md:gap-2 text-slate-500 hover:text-slate-700 dark:text-slate-400",children:[h.jsx(Z0,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})," Explorer"]})]})]}),h.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-700 ${d?"pt-4 md:pt-6":"justify-center items-center"}`,children:[!d&&!l&&h.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-full pointer-events-none -z-10 animate-fade-in",children:[h.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-[#CC561E]/5 dark:bg-[#CC561E]/10 rounded-full blur-[80px] md:blur-[120px]"}),h.jsx("div",{className:"absolute top-1/3 left-1/4 w-[200px] h-[200px] bg-blue-500/5 dark:bg-blue-500/5 rounded-full blur-[100px]"})]}),h.jsxs("form",{onSubmit:q,className:`space-y-4 md:space-y-6 w-full transition-all duration-1000 ease-in-out ${d?"max-w-none":"max-w-2xl text-center"}`,children:[!d&&!l&&h.jsxs("div",{className:"mb-6 md:mb-10 space-y-4 animate-slide-up",children:[h.jsxs("div",{className:"flex items-center justify-center gap-3",children:[h.jsx("div",{className:"p-1.5 md:p-2 bg-[rgba(204,86,30,0.1)] dark:bg-[rgba(204,86,30,0.2)] rounded-xl shrink-0",children:h.jsx(WE,{className:"w-5 h-5 md:w-8 md:h-8"})}),h.jsxs("h1",{className:"text-2xl md:text-4xl font-black text-slate-900 dark:text-white tracking-tight",children:["Logos",h.jsx("span",{className:"text-[#CC561E]",children:"Chat"})]})]}),h.jsx("p",{className:"text-sm md:text-base text-slate-500 dark:text-slate-400 max-w-lg mx-auto leading-relaxed",children:"Analyze your library with intelligence. Ask anything."})]}),h.jsxs("div",{className:"relative group flex items-center",children:[h.jsxs("div",{className:"relative flex-1 group",children:[h.jsx(Us,{className:"absolute left-4 md:left-5 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-slate-400 group-focus-within:text-[#CC561E] transition-colors"}),h.jsx("input",{type:"text",value:s,onChange:pe=>a(pe.target.value),placeholder:"Type your question here...",className:"w-full pl-11 md:pl-14 pr-4 md:pr-6 py-3.5 md:py-5 rounded-2xl border border-[#E6EAF2] dark:border-slate-700 bg-white dark:bg-slate-800 text-base md:text-lg text-slate-900 dark:text-white shadow-sm focus:shadow-xl focus:shadow-[#CC561E]/5 focus:outline-none focus:ring-2 focus:ring-[#CC561E]/50 transition-all placeholder:text-slate-400",disabled:l})]}),h.jsx("button",{type:"submit",disabled:l||!s.trim(),className:"ml-2 md:ml-3 p-3.5 md:p-5 rounded-2xl bg-[#CC561E] text-white shadow-lg shadow-[#CC561E]/20 hover:bg-[#b04a1a] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed group/btn",children:l?h.jsx(nn,{className:"w-5 h-5 md:w-6 md:h-6 animate-spin"}):h.jsx(Us,{className:"w-5 h-5 md:w-6 md:h-6 group-hover/btn:scale-110 transition-transform"})})]}),h.jsxs("div",{className:`text-[11px] md:text-xs text-slate-500 dark:text-slate-400 ${d?"text-left":"text-center"}`,children:["Tip: ",h.jsx("span",{className:"font-bold text-[#CC561E]",children:"Enter"})," to search. Mention ",h.jsx("span",{className:"font-bold text-[#CC561E]",children:"@book"})," for focus."]})]})]}),m&&h.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 flex items-start gap-3",children:[h.jsx(rl,{className:"w-5 h-5 text-red-600 shrink-0 mt-0.5"}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-red-900 dark:text-red-100",children:"Search Failed"}),h.jsx("p",{className:"text-sm text-red-700 mt-1",children:m})]})]}),d&&h.jsxs("div",{className:"space-y-4 md:space-y-6",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[h.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[h.jsx(Pa,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Answer"]}),h.jsx("div",{className:"max-w-none",children:te.split(`
`).map((pe,U)=>{const Z=pe.trim();return Z.startsWith("## ")?h.jsx("h3",{className:"text-base md:text-lg font-bold underline decoration-[#CC561E]/50 underline-offset-4 mt-2.5 md:mt-6 mb-1 md:mb-2.5 text-slate-900 dark:text-white",children:Z.replace(/^##\s+/,"")},U):Z===""?h.jsx("div",{className:"h-1 md:h-2"},U):h.jsx("p",{className:"text-justify text-[14px] md:text-base leading-[1.55] md:leading-relaxed text-slate-700 dark:text-slate-300 mb-1.5 md:mb-2",children:pe},U)})}),G&&h.jsxs("details",{className:"rounded-lg border border-[#E6EAF2] dark:border-slate-700 bg-[#F8FAFC] dark:bg-slate-900/40",children:[h.jsx("summary",{className:"cursor-pointer select-none px-3 md:px-4 py-2.5 text-xs md:text-sm font-medium text-slate-600 dark:text-slate-300",children:"Internal Notes (Optional)"}),h.jsx("div",{className:"px-3 md:px-4 pb-3 md:pb-4 border-t border-[#E6EAF2] dark:border-slate-700",children:h.jsx("pre",{className:"mt-3 whitespace-pre-wrap break-words text-xs md:text-sm leading-relaxed text-slate-600 dark:text-slate-300 font-sans",children:G})})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2.5 md:gap-4 pt-2.5 md:pt-4 border-t border-[#E6EAF2] dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center gap-2.5 md:gap-4",children:[h.jsx("span",{className:"text-xs md:text-sm text-slate-500 dark:text-slate-400",children:"Was this answer helpful?"}),h.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[h.jsx("button",{onClick:()=>j(1),disabled:b!=="none"||w,className:`p-1.5 md:p-2 rounded-lg transition-colors ${b==="liked"?"bg-green-100 text-green-600":"text-slate-400 hover:text-green-600"}`,children:h.jsx(AR,{className:"w-4 h-4 md:w-5 md:h-5"})}),h.jsx("button",{onClick:()=>j(0),disabled:b!=="none"||w,className:`p-1.5 md:p-2 rounded-lg transition-colors ${b==="disliked"?"bg-red-100 text-red-600":"text-slate-400 hover:text-red-600"}`,children:h.jsx(NR,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]}),((he=d.metadata)==null?void 0:he.status)==="analytic"&&((Se=(Ne=d.metadata)==null?void 0:Ne.analytics)==null?void 0:Se.contexts)&&d.metadata.analytics.contexts.length>0&&h.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-1.5 md:gap-2 text-[#CC561E] hover:text-[#b34b1a] font-bold text-xs md:text-sm transition-colors py-1.5 md:py-2 px-2.5 md:px-3 hover:bg-orange-50 dark:hover:bg-orange-900/10 rounded-lg",children:[h.jsx(yE,{size:14,className:"md:w-4 md:h-4"}),"See Contexts"]})]})]}),d.sources&&d.sources.length>0&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-[#E6EAF2] dark:border-slate-700 p-3.5 md:p-6 space-y-3 md:space-y-4",children:[h.jsxs("h3",{className:"text-base md:text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-1.5 md:gap-2",children:[h.jsx($h,{className:"w-4 h-4 md:w-5 md:h-5 text-[#CC561E]"}),"Sources (",d.sources.length,")"]}),h.jsx("div",{className:"space-y-1.5 md:space-y-2",children:d.sources.map((pe,U)=>h.jsxs("div",{className:"flex items-start gap-2 md:gap-3 p-2 md:p-3 rounded-lg bg-[#F3F5FA] dark:bg-slate-700/50 hover:bg-[#F3F5FA] transition-colors",children:[h.jsx("div",{className:"flex-shrink-0 w-5 h-5 md:w-6 md:h-6 rounded-full bg-[rgba(204,86,30,0.1)] text-[#CC561E] flex items-center justify-center text-xs md:text-sm font-medium",children:U+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm md:text-base font-medium text-slate-900 dark:text-white truncate",children:pe.title}),h.jsxs("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:["Page ",pe.page_number]})]})]},U))})]})]}),P&&((Te=d==null?void 0:d.metadata)==null?void 0:Te.analytics)&&h.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[h.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:()=>I(!1)}),h.jsx("div",{className:"relative w-full max-w-2xl h-full bg-white dark:bg-gray-900 shadow-2xl flex flex-col",children:h.jsx(pM,{term:d.metadata.analytics.term,bookId:d.metadata.analytics.resolved_book_id,initialContexts:d.metadata.analytics.contexts,firebaseUid:t,onClose:()=>I(!1)})})]})]})},Ru=async()=>{const e=xy().currentUser;if(!e)throw new Error("User must be logged in to use Knowledge Stream");return await e.getIdToken()},Uq=12e4,Gc=new Map,Y0=new Map,mM=t=>{const e=t.anchor_type||"note",n=t.anchor_id||"",r=t.mode||"FOCUS",s=Number(t.horizon_value??.25).toFixed(2),a=(t.resource_type||"").toUpperCase(),l=(t.category||"").toUpperCase();return[t.firebase_uid,e,n,r,s,a,l].join("|")},gM=t=>t?Date.now()-t.createdAt<=Uq:!1;async function $q(t){const e=mM(t),n=Gc.get(e);if(gM(n))return;const r=Y0.get(e);if(r){await r;return}const s=(async()=>{const a=await xM(t);return Gc.set(e,{response:a,createdAt:Date.now()}),a})();Y0.set(e,s);try{await s}finally{Y0.delete(e)}}function Vq(t){const e=mM(t),n=Gc.get(e);return gM(n)?(Gc.delete(e),n.response):(Gc.delete(e),null)}async function xM(t){if(!t.firebase_uid)throw new Error("User must be authenticated");const e=await Ru(),n=await fetch(`${nt}/api/flow/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to start flow session")}return n.json()}async function J0(t){const e=await Ru(),n=await fetch(`${nt}/api/flow/next`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to get next batch")}return n.json()}async function qq(t){const e=await Ru(),n=await fetch(`${nt}/api/flow/feedback`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.detail||"Failed to send feedback")}return n.json()}async function Wq(t,e,n){const r=await Ru(),s=await fetch(`${nt}/api/flow/adjust`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({session_id:t,horizon_value:e,firebase_uid:n})});if(!s.ok){const a=await s.json();throw new Error(a.detail||"Failed to adjust horizon")}return s.json()}async function WS(t,e,n,r,s,a){const l=await Ru(),c=await fetch(`${nt}/api/flow/reset-anchor`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({session_id:t,anchor_type:e,anchor_id:n,firebase_uid:r,resource_type:s,category:a})});if(!c.ok){const d=await c.json();throw new Error(d.detail||"Failed to reset anchor")}return c.json()}const GS={1:{color:"#CC561E",label:"Tight Context",icon:""},2:{color:"#e66a2e",label:"Author's Mind",icon:""},3:{color:"#b34b1a",label:"Syntopic Debate",icon:""},4:{color:"#CC561E",label:"Keif Kprs",icon:""}},Gq=({card:t,sessionId:e,firebaseUid:n,onFeedback:r})=>{const[s,a]=E.useState(!1),[l,c]=E.useState(null),d=GS[t.zone]||GS[1],p=async m=>{try{await qq({firebase_uid:n,session_id:e,chunk_id:t.chunk_id,action:m}),c(m),r==null||r(m)}catch(g){console.error("Feedback failed:",g)}};return h.jsxs("div",{className:"flow-card",style:{"--zone-color":d.color},children:[h.jsxs("div",{className:"flow-card__top-bar",children:[h.jsxs("div",{className:"flow-card__zone-indicator",children:[h.jsx("span",{className:"zone-dot",style:{backgroundColor:d.color}}),h.jsx("span",{className:"zone-label",children:d.label})]}),t.page_number!==void 0&&t.page_number!==null&&t.page_number>0&&h.jsxs("div",{className:"flow-card__meta-item",children:[h.jsx("span",{className:"text-slate-500 mr-1.5 opacity-50",children:"#"}),h.jsxs("span",{children:["Page ",t.page_number]})]})]}),h.jsxs("div",{className:"flow-card__header",children:[h.jsx("h3",{className:"flow-card__title",children:t.title}),t.author&&h.jsxs("div",{className:"flow-card__author-pill",children:[h.jsx("span",{className:"opacity-60 italic",children:"by"})," ",t.author]})]}),h.jsx("div",{className:`flow-card__content ${s?"expanded":""}`,children:h.jsx("p",{children:t.content})}),h.jsxs("div",{className:"flow-card__footer",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flow-card__feedback",children:[h.jsx("button",{className:`feedback-btn ${l==="like"?"active like":""}`,onClick:()=>p("like"),disabled:!!l,title:"Relevant",children:h.jsx("span",{className:"btn-icon",children:""})}),h.jsx("button",{className:`feedback-btn ${l==="dislike"?"active dislike":""}`,onClick:()=>p("dislike"),disabled:!!l,title:"Not relevant",children:h.jsx("span",{className:"btn-icon",children:""})}),h.jsx("button",{className:`feedback-btn ${l==="save"?"active save":""}`,onClick:()=>p("save"),disabled:!!l,title:"Keep in Library",children:h.jsx("span",{className:"btn-icon",children:""})})]}),t.reason&&h.jsx("div",{className:"flow-card__footer-reason",children:t.reason})]}),h.jsx("button",{className:`expand-toggle ${s?"is-expanded":""}`,onClick:()=>a(!s),children:s?"Collapse":"Read More"})]}),h.jsx("style",{children:`
                .flow-card {
                    background: #ffffff;
                    border: 1px solid #E6EAF2;
                    border-left: 3px solid var(--zone-color);
                    border-radius: 20px;
                    padding: 20px;
                    margin-bottom: 12px;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                    overflow: hidden;
                }

                @media (max-width: 768px) {
                    .flow-card {
                        padding: 16px;
                        margin-bottom: 8px;
                        border-radius: 16px;
                    }
                }

                @media (min-width: 769px) {
                    .flow-card {
                            margin-bottom: 10px;
                    }
                }
                
                .dark .flow-card {
                    background: rgba(15, 23, 42, 0.5);
                    border-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    right: 0;
                    width: 150px;
                    height: 150px;
                    background: radial-gradient(circle at top right, var(--zone-color), transparent 70%);
                    opacity: 0.04;
                    pointer-events: none;
                }

                .flow-card:hover {
                    background: #ffffff;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    box-shadow: 0 12px 40px rgba(15, 23, 42, 0.08);
                }

                .dark .flow-card:hover {
                    background: rgba(15, 23, 42, 0.7);
                    border-color: rgba(204, 86, 30, 0.3);
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
                }

                .flow-card__top-bar {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 16px;
                }

                .flow-card__zone-indicator {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .zone-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 50%;
                    box-shadow: 0 0 10px var(--zone-color);
                }

                .zone-label {
                    font-size: 11px;
                    font-weight: 700;
                    letter-spacing: 0.05em;
                    text-transform: uppercase;
                    color: var(--zone-color);
                    opacity: 0.9;
                }

                @media (max-width: 768px) {
                    .zone-label {
                        font-size: 9px;
                    }
                }

                .flow-card__meta-item {
                    font-size: 12px;
                    font-weight: 600;
                    color: #64748b;
                }

                @media (max-width: 768px) {
                    .flow-card__meta-item {
                        font-size: 10px;
                    }
                }

                .flow-card__header {
                    margin-bottom: 12px;
                }

                .flow-card__title {
                    font-family: 'Outfit', 'Inter', sans-serif;
                    font-size: 17px;
                    font-weight: 700;
                    color: #1e293b;
                    line-height: 1.3;
                    margin: 0 0 8px 0;
                }

                @media (max-width: 768px) {
                    .flow-card__title {
                        font-size: 15px;
                    }
                }

                .dark .flow-card__title {
                    color: #f1f5f9;
                }

                .flow-card__author-pill {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 4px 12px;
                    background: #F3F5FA;
                    border: 1px solid #E6EAF2;
                    border-radius: 100px;
                    font-size: 12px;
                    color: #475569;
                    font-weight: 500;
                }

                .dark .flow-card__author-pill {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .flow-card__content {
                    color: #475569;
                    font-size: 15px;
                    line-height: 1.7;
                    max-height: 120px;
                    overflow: hidden;
                    position: relative;
                    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                }

                .dark .flow-card__content {
                    color: #94a3b8;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.95));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-card__content.expanded {
                    max-height: 2000px;
                    color: #111827;
                }

                .dark .flow-card__content.expanded {
                    color: #f1f5f9;
                }

                .flow-card__footer-reason {
                    font-size: 12px;
                    line-height: 1.5;
                    color: rgba(204, 86, 30, 0.7);
                    font-weight: 600;
                    font-style: italic;
                    letter-spacing: 0.02em;
                }

                @media (max-width: 768px) {
                    .flow-card__footer-reason {
                        font-size: 10px;
                    }
                }

                .flow-card__footer {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-top: 16px;
                    padding-top: 14px;
                    border-top: 1px solid #E6EAF2;
                }

                .dark .flow-card__footer {
                    border-top-color: rgba(255, 255, 255, 0.1);
                }

                .flow-card__feedback {
                    display: flex;
                    gap: 8px;
                }

                .feedback-btn {
                    width: 38px;
                    height: 38px;
                    border-radius: 10px;
                    border: 1px solid #E6EAF2;
                    background: #ffffff;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    color: #64748b;
                }

                .dark .feedback-btn {
                    background: rgba(255, 255, 255, 0.05);
                    border-color: rgba(255, 255, 255, 0.1);
                    color: #94a3b8;
                }

                .feedback-btn:hover:not(:disabled) {
                    background: #F3F5FA;
                    border-color: #DDE2ED;
                    transform: translateY(-2px);
                    color: #1e293b;
                }

                .dark .feedback-btn:hover:not(:disabled) {
                    background: rgba(255, 255, 255, 0.1);
                    border-color: rgba(204, 86, 30, 0.4);
                    color: #f1f5f9;
                }

                .feedback-btn.active.like { background: rgba(34, 197, 94, 0.1); color: #22c55e; border-color: rgba(34, 197, 94, 0.2); }
                .feedback-btn.active.dislike { background: rgba(239, 68, 68, 0.1); color: #ef4444; border-color: rgba(239, 68, 68, 0.2); }
                .feedback-btn.active.save { background: rgba(204, 86, 30, 0.1); color: #CC561E; border-color: rgba(204, 86, 30, 0.2); }

                .expand-toggle {
                    background: transparent;
                    border: none;
                    color: #CC561E;
                    font-size: 13px;
                    font-weight: 700;
                    cursor: pointer;
                    padding: 8px 16px;
                    border-radius: 8px;
                    transition: all 0.2s ease;
                }

                @media (max-width: 768px) {
                    .expand-toggle {
                        font-size: 11px;
                        padding: 6px 12px;
                    }
                }

                .expand-toggle:hover {
                    background: rgba(204, 86, 30, 0.1);
                    transform: translateX(4px);
                }
            `})]})},Kq=[{label:" Focus",description:"Deep context & related works"},{label:" Syntopic",description:"Similar ideas across different authors"},{label:" Discovery",description:"Unexpected connections & serendipity"}],Yq=({value:t,onChange:e,disabled:n=!1})=>{const s=(a=>a<.33?0:a<.66?1:2)(t);return h.jsxs("div",{className:"horizon-slider",children:[h.jsxs("div",{className:"horizon-slider__header",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"horizon-slider__title",children:"Epistemic Horizon"}),h.jsx("span",{className:"text-[10px] text-card-foreground/70 font-medium tracking-tight",children:"Search Breadth Control"})]}),h.jsxs("div",{className:"horizon-slider__value-badge",children:[Math.round(t*100),"%"]})]}),h.jsxs("div",{className:"horizon-slider__track-container",children:[h.jsx("input",{type:"range",min:"0",max:"100",value:t*100,onChange:a=>e(parseInt(a.target.value)/100),disabled:n,className:"horizon-slider__input"}),h.jsx("div",{className:"horizon-slider__progress",style:{width:`${t*100}%`}})]}),h.jsx("div",{className:"horizon-slider__zones",children:Kq.map((a,l)=>{const c=l===s,d=a.label.split(" ")[0],p=a.label.split(" ")[1];return h.jsxs("div",{className:`horizon-slider__zone ${c?"active":""}`,onClick:()=>e(l*.333+.165),children:[h.jsx("span",{className:"zone-emoji",children:d}),h.jsx("span",{className:"zone-text",children:p}),c&&h.jsx("div",{className:"active-indicator"})]},l)})}),h.jsx("style",{children:`
                .horizon-slider {
                    background: hsl(var(--card));
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    padding: 12px;
                }

                .horizon-slider__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    margin-bottom: 12px;
                }

                .horizon-slider__title {
                    font-size: 11px;
                    font-weight: 700;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    color: hsl(var(--card-foreground));
                    opacity: 0.8;
                    font-family: 'Outfit', sans-serif;
                }

                .horizon-slider__value-badge {
                    padding: 2px 8px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 11px;
                    font-weight: 800;
                    border-radius: 6px;
                    font-family: 'JetBrains Mono', monospace;
                }

                .horizon-slider__track-container {
                    position: relative;
                    height: 4px;
                    background: rgba(255, 255, 255, 0.08);
                    border-radius: 100px;
                    margin-bottom: 12px;
                    overflow: visible;
                }

                .horizon-slider__input {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    -webkit-appearance: none;
                    appearance: none;
                    background: transparent;
                    cursor: pointer;
                    z-index: 5;
                    margin: 0;
                    padding: 0;
                }

                .horizon-slider__input::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #fff;
                    box-shadow: 0 0 10px rgba(204, 86, 30, 0.5);
                    cursor: grab;
                    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                    border: 3px solid #CC561E;
                }

                .horizon-slider__input::-webkit-slider-thumb:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 20px rgba(204, 86, 30, 0.7);
                }

                .horizon-slider__progress {
                    position: absolute;
                    top: 0;
                    left: 0;
                    height: 100%;
                    background: linear-gradient(90deg, #CC561E 0%, #e66a2e 100%);
                    border-radius: 100px;
                    pointer-events: none;
                    z-index: 1;
                }

                .horizon-slider__zones {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 2px;
                }

                .horizon-slider__zone {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 2px;
                    padding: 8px 2px;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    position: relative;
                }

                .horizon-slider__zone:hover {
                    background: rgba(255, 255, 255, 0.06);
                }

                .horizon-slider__zone.active {
                    background: rgba(204, 86, 30, 0.08);
                }

                .zone-emoji {
                    font-size: 14px;
                    filter: grayscale(1) opacity(0.55);
                    transition: all 0.3s ease;
                }

                .horizon-slider__zone.active .zone-emoji {
                    filter: grayscale(0) opacity(1);
                    transform: scale(1.1);
                }

                .zone-text {
                    font-size: 9px;
                    font-weight: 700;
                    color: rgba(255, 255, 255, 0.7);
                    text-transform: uppercase;
                    letter-spacing: 0.02em;
                    transition: all 0.3s ease;
                    text-align: center;
                }

                .horizon-slider__zone.active .zone-text {
                    color: rgba(255, 255, 255, 0.95);
                }

                .active-indicator {
                    position: absolute;
                    bottom: 0;
                    width: 3px;
                    height: 3px;
                    background: #CC561E;
                    border-radius: 50%;
                    box-shadow: 0 0 8px #CC561E;
                }
            `})]})},Jq=({activeFilter:t,onFilterChange:e})=>{const n=[{id:"ALL",label:"All Notes",icon:S3,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"BOOK",label:"Books",icon:sb,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"ARTICLE",label:"Articles",icon:xu,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"WEBSITE",label:"Websites",icon:Vh,color:"text-slate-400",bg:"bg-slate-500/10"},{id:"PERSONAL_NOTE",label:"Personal Notes",icon:sl,color:"text-slate-400",bg:"bg-slate-500/10"}];return h.jsxs("div",{className:"w-full flex flex-col gap-2 p-3 bg-card border border-white/10 rounded-2xl",children:[h.jsxs("h3",{className:"text-[11px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1 px-1 flex items-center gap-2",children:[h.jsx("span",{className:"w-1 h-1 bg-[#CC561E] rounded-full"}),"Source Navigator"]}),h.jsx("div",{className:"space-y-1",children:n.map(r=>{const s=r.icon,a=t===r.id;return h.jsxs("button",{onClick:()=>e(r.id),className:`w-full flex items-center justify-between px-3 py-2 rounded-xl transition-all duration-300 group relative overflow-hidden border bg-card text-card-foreground ${a?"border-[#CC561E] shadow-[0_0_12px_rgba(204,86,30,0.35)]":"border-white/10 hover:border-white/20 hover:bg-card/90"}`,children:[h.jsxs("div",{className:"flex items-center gap-2.5 relative z-10",children:[h.jsx("div",{className:`p-1.5 rounded-lg transition-all duration-300 ${a?"text-[#CC561E]":"text-card-foreground/70 group-hover:text-card-foreground"}`,children:h.jsx(s,{size:18})}),h.jsx("span",{className:`text-xs font-medium tracking-tight ${a?"text-card-foreground":"text-card-foreground/80 group-hover:text-card-foreground"}`,children:r.label})]}),a&&h.jsx("div",{className:"w-1.5 h-1.5 bg-[#CC561E] rounded-full animate-pulse mr-1"})]},r.id)})})]})},Xq=({firebaseUid:t,anchorType:e,anchorId:n,anchorLabel:r,categoryOptions:s,onClose:a})=>{const[l,c]=E.useState(null),[d,p]=E.useState([]),[m,g]=E.useState(r||"Flux"),[b,v]=E.useState(null),[w,C]=E.useState(.25),[k,N]=E.useState(!1),[M,_]=E.useState(!0),[P,I]=E.useState(null),[q,j]=E.useState(!1),[F,G]=E.useState(!1),[te,he]=E.useState(!1),[Ne,Se]=E.useState(null),[Te,pe]=E.useState(!1),[U,Z]=E.useState("ALL"),K=E.useRef(null);E.useRef(null),E.useRef(null);const z=E.useCallback(L=>L==="ALL"?"ALL_NOTES":L,[]),H=E.useCallback(async(L,ae=null,$=.25)=>{if(t){N(!0),I(null),p([]),_(!0);try{const ne=z(L),ie={firebase_uid:t,anchor_type:e,anchor_id:n,mode:"FOCUS",horizon_value:$,resource_type:ne,category:ae||void 0},$e=Vq(ie)??await xM(ie);c($e.session_id),p($e.initial_cards),g($e.topic_label),Se(null)}catch(ne){I(Go(ne))}finally{N(!1)}}},[t,e,n,z]);E.useEffect(()=>{t&&(q||j(!0))},[t,q]),E.useEffect(()=>{q&&H(U,b,w)},[q,U,b,H]);const A=E.useCallback(async()=>{if(!(l===null||k||!M)){N(!0);try{const L=await J0({firebase_uid:t,session_id:l,batch_size:5});p(ae=>[...ae,...L.cards]),_(L.has_more),L.pivot_info&&Se(L.pivot_info)}catch(L){console.error("Failed to load more:",L)}finally{N(!1)}}},[l,t,k,M]),R=async L=>{if(C(L),!q){j(!0);return}if(l!==null)try{await Wq(l,L,t)}catch(ae){console.error("Failed to adjust horizon:",ae)}},W=async()=>{if(!q){j(!0);return}if(l!==null){N(!0),pe(!0),I(null),Se(null);try{const L=await WS(l,"topic","General Discovery",t,z(U),b||void 0);g(L.topic_label),L.pivot_info&&Se(L.pivot_info),p([]),_(!0);const ae=await J0({session_id:l,firebase_uid:t,batch_size:5});p(ae.cards),_(ae.has_more),ae.pivot_info&&Se(ae.pivot_info)}catch(L){I(Go(L))}finally{N(!1),pe(!1)}}},oe=L=>{if(L!==b){if(v(L),!q){j(!0);return}l!==null&&(N(!0),WS(l,"topic","General Discovery",t||"",z(U),L||void 0).then(ae=>{p([]),g(ae.topic_label),Se(ae.pivot_info||null),_(!0),J0({session_id:l,firebase_uid:t,batch_size:5}).then($=>{p($.cards),_($.has_more),$.pivot_info&&Se($.pivot_info)}).catch($=>{console.error("Failed to load initial batch after category pivot:",$),I(Go($))}).finally(()=>{N(!1)})}).catch(ae=>{console.error("Failed to pivot category:",ae),I(Go(ae)),N(!1)}))}},be=L=>{L!==U&&(Z(L),q||j(!0))};return h.jsxs("div",{className:"flow-container",ref:K,children:[h.jsxs("div",{className:"flow-layout",children:[h.jsxs("aside",{className:"flow-left",children:[a&&h.jsxs("button",{onClick:a,className:"flow-left__back group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Wi,{size:16})}),h.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Back"})]}),(U==="ALL"||U==="BOOK")&&h.jsx(W2,{activeCategory:b,onCategoryChange:oe,categories:s})]}),h.jsxs("div",{className:"flow-main",children:[h.jsx("div",{className:"flow-container__header lg:hidden",children:h.jsx("div",{className:"flow-container__title-section",children:h.jsxs("div",{className:"flow-container__mobile-actions relative flex items-center justify-between",children:[h.jsxs("div",{className:"lg:hidden flex items-center gap-2 z-10 w-1/3",children:[a&&h.jsx("button",{onClick:a,className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300","aria-label":"Back",children:h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Wi,{size:16})})}),h.jsxs("button",{onClick:()=>he(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(Ig,{size:16})}),h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Explore"})]})]}),h.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none",children:h.jsx("span",{className:"text-[10px] font-extrabold uppercase tracking-[0.2em] text-[#CC561E] bg-[#CC561E]/10 px-3 py-1 rounded-md",children:"FLUX"})}),h.jsx("div",{className:"lg:hidden flex items-center justify-end gap-2 z-10 w-1/3",children:h.jsxs("button",{onClick:()=>G(!0),className:"flow-mobile-action-btn group flex items-center gap-2 text-slate-500 dark:text-slate-400 hover:text-[#CC561E] transition-all duration-300",children:[h.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider hidden sm:inline",children:"Filters"}),h.jsx("div",{className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-800 group-hover:bg-[rgba(204,86,30,0.1)] transition-colors",children:h.jsx(hR,{size:16})})]})})]})})}),q&&P&&h.jsxs("div",{className:"flow-container__error",children:[h.jsxs("p",{children:[" ",P]}),h.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}),q&&Ne&&h.jsxs("div",{className:"flow-container__pivot",children:[h.jsx("span",{className:"pivot-icon",children:""}),h.jsx("p",{children:Ne.message})]}),h.jsxs("div",{className:"flow-container__cards",children:[q?h.jsxs(h.Fragment,{children:[d.map(L=>h.jsx(Gq,{card:L,sessionId:l??"",firebaseUid:t},L.flow_id)),!k&&!P&&d.length===0&&h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[h.jsx("div",{className:"text-6xl mb-6 opacity-80",children:""}),h.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-2",children:U==="PERSONAL_NOTE"?"No Personal Notes Found":"Library Empty"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-8",children:U==="PERSONAL_NOTE"?"We couldn't find any personal notes or highlights. Try adding some content or switching to 'All Notes'.":"Your knowledge stream is waiting for content. Upload books or add notes to get started."}),h.jsx("button",{onClick:a,className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Go to Dashboard"})]})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center px-4",children:[h.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white mb-3",children:"Flux session not started"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mx-auto mb-6",children:"Select a filter to begin or click the button below."}),h.jsx("button",{onClick:()=>j(!0),className:"px-6 py-2.5 bg-[#CC561E] hover:bg-[#b04a1a] text-white font-medium rounded-lg transition-colors",children:"Start Flux"})]}),q&&(d.length>0||k)&&h.jsxs("div",{className:"flow-container__load-more py-8 flex justify-center",children:[k?h.jsxs("div",{className:"flex items-center gap-3 text-slate-500 dark:text-slate-400",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-[#CC561E] border-t-transparent rounded-full animate-spin"}),h.jsx("span",{className:"text-sm font-medium",children:Te?"Topic is shifting...":"Loading more thoughts..."})]}):M&&h.jsxs("button",{onClick:A,className:"px-8 py-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-[#CC561E]/50 text-slate-700 dark:text-slate-300 hover:text-[#CC561E] dark:hover:text-[#CC561E] font-medium rounded-full shadow-sm hover:shadow-md transition-all duration-300 flex items-center gap-2 group",children:[h.jsx("span",{children:"Load More"}),h.jsx(Ra,{className:"w-4 h-4 group-hover:translate-y-0.5 transition-transform"})]}),!M&&d.length>0&&h.jsx("div",{className:"text-center text-slate-400 text-sm py-4",children:h.jsx("span",{children:" You've explored all related thoughts"})})]})]})]}),h.jsxs("div",{className:`flow-category-container ${te?"is-open":""}`,children:[h.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>he(!1)}),h.jsx("aside",{className:"flow-category-sidebar",children:h.jsxs("div",{className:"flow-sidebar__sticky",children:[h.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-6 pb-4 border-bottom border-slate-100 dark:border-slate-800",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:h.jsx(Ig,{size:20})}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Discovery Areas"})]}),h.jsx("button",{onClick:()=>he(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(ds,{size:20})})]}),(U==="ALL"||U==="BOOK")&&h.jsx(W2,{activeCategory:b,onCategoryChange:L=>{oe(L),he(!1)},categories:s})]})})]}),h.jsxs("div",{className:`flow-sidebar-container ${F?"is-open":""}`,children:[h.jsx("div",{className:"flow-sidebar-backdrop",onClick:()=>G(!1)}),h.jsx("aside",{className:"flow-sidebar",children:h.jsxs("div",{className:"flow-sidebar__sticky",children:[h.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-4 md:mb-0 pb-4 md:pb-0 border-bottom border-slate-100 dark:border-slate-800",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 rounded-xl bg-[rgba(204,86,30,0.1)] text-[#CC561E]",children:h.jsx(Ig,{size:20})}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:"Controls"})]}),h.jsx("button",{onClick:()=>G(!1),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(ds,{size:20})})]}),h.jsx(Jq,{activeFilter:U,onFilterChange:be}),h.jsx(Yq,{value:w,onChange:R,disabled:k}),h.jsxs("button",{className:"flow-sidebar__pivot-button",onClick:W,disabled:k,children:[h.jsx("span",{className:"icon",children:""}),"Change Topic"]})]})})]})]}),h.jsx("style",{children:`
                .flow-container {
                    max-width: 1280px;
                    margin: 0 auto;
                    width: 100%;
                    display: flex;
                    flex-direction: column;
                    height: 100%;
                    background: transparent;
                    position: relative;
                    padding: 24px;
                }

                @media (max-width: 768px) {
                    .flow-container {
                        padding: 12px;
                    }
                }

                .flow-container::before {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: 
                        radial-gradient(circle at 10% 20%, rgba(204, 86, 30, 0.03) 0%, transparent 40%),
                        radial-gradient(circle at 90% 80%, rgba(204, 86, 30, 0.03) 0%, transparent 40%);
                    pointer-events: none;
                    z-index: -1;
                }

                .flow-layout {
                    display: grid;
                    grid-template-columns: 210px 1fr 210px;
                    gap: 24px;
                    align-items: flex-start;
                    padding-top: 20px;
                    max-width: 1280px;
                    margin: 0 auto;
                }

                @media (max-width: 1024px) {
                    .flow-layout {
                        grid-template-columns: 1fr;
                        gap: 12px;
                        padding-top: 4px;
                    }

                    .flow-left {
                        display: none;
                    }

                    .flow-main {
                        padding-top: 48px;
                    }

                    .flow-sidebar-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-end;
                    }

                    .flow-category-container {
                        position: fixed;
                        top: 0;
                        right: 0;
                        bottom: 0;
                        left: 0;
                        z-index: 1000;
                        pointer-events: none;
                        display: flex;
                        justify-content: flex-start;
                    }

                    .flow-sidebar-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-category-container.is-open {
                        pointer-events: auto;
                    }

                    .flow-sidebar-backdrop {
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0, 0, 0, 0.5);
                        backdrop-filter: blur(4px);
                        opacity: 0;
                        transition: opacity 0.4s ease;
                        pointer-events: none;
                    }

                    .is-open .flow-sidebar-backdrop {
                        opacity: 1;
                        pointer-events: auto;
                    }

                    .flow-sidebar {
                        width: 55%;
                        min-width: 250px;
                        max-width: 400px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-sidebar {
                        background: #0f172a;
                    }

                    .flow-category-sidebar {
                        width: 25%;
                        min-width: 150px;
                        max-width: 340px;
                        height: 100%;
                        background: #fff;
                        transform: translateX(-100%);
                        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
                        box-shadow: 10px 0 30px rgba(0, 0, 0, 0.1);
                        z-index: 1001;
                    }

                    .dark .flow-category-sidebar {
                        background: #0f172a;
                    }

                    .is-open .flow-sidebar {
                        transform: translateX(0);
                    }

                    .is-open .flow-category-sidebar {
                        transform: translateX(0);
                    }

                    .flow-sidebar__sticky {
                        height: 100%;
                        max-height: 100vh;
                        padding: 12px;
                        overflow-y: auto;
                        position: relative;
                        top: 0 !important;
                    }

                    .flow-container__mobile-actions {
                        position: sticky;
                        top: 0;
                        z-index: 100;
                        background: rgba(255, 255, 255, 0.85);
                        backdrop-filter: blur(16px);
                        margin: -20px -20px 20px -20px;
                        padding: 12px 20px;
                        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
                        width: calc(100% + 40px);
                    }

                    .flow-mobile-actions-row {
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 8px;
                        width: 100%;
                    }

                    .flow-mobile-actions-right {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-left: auto;
                    }

                    .flow-mobile-action-btn {
                        padding: 6px 10px;
                        border-radius: 10px;
                        border: 1px solid rgba(148, 163, 184, 0.22);
                        background: rgba(255, 255, 255, 0.9);
                    }

                    .dark .flow-mobile-action-btn {
                        background: rgba(15, 23, 42, 0.9);
                        border-color: rgba(255, 255, 255, 0.12);
                    }

                    .flow-badge--title {
                        display: table;
                        margin: 4px auto 0 auto;
                        text-align: center;
                        font-size: 11px;
                        padding: 6px 14px;
                        letter-spacing: 0.14em;
                    }

                    .dark .flow-container__mobile-actions {
                        background: rgba(15, 23, 42, 0.85);
                        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
                    }
                }

                @media (min-width: 1025px) {
                    .flow-container__mobile-actions {
                        display: none;
                    }

                    .flow-category-container {
                        display: none;
                    }
                }

                .flow-sidebar__sticky {
                    position: sticky;
                    top: 24px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                }

                .flow-main {
                    padding-top: 0;
                }

                @media (min-width: 1025px) {
                    .flow-main {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                    .flow-sidebar__sticky {
                        padding-top: 40px; /* Aligns with category labels */
                    }
                }

                .flow-left {
                    position: sticky;
                    top: 24px;
                    align-self: flex-start;
                }

                .flow-sidebar-container {
                    align-self: flex-start;
                }

                .flow-sidebar {
                    align-self: flex-start;
                }

                .flow-left__back {
                    margin-bottom: 24px;
                }

                .flow-card__content:not(.expanded)::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 60px;
                    background: linear-gradient(to bottom, transparent, rgba(248, 250, 252, 0.9));
                    pointer-events: none;
                }

                .dark .flow-card__content:not(.expanded)::after {
                    background: linear-gradient(to bottom, transparent, rgba(15, 23, 42, 0.9));
                }

                .flow-sidebar__pivot-button {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                    width: 100%;
                    padding: 12px;
                    background: #262D40;
                    border: none;
                    border-radius: 12px;
                    color: white;
                    font-weight: 700;
                    font-size: 13px;
                    cursor: pointer;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    box-shadow: 0 4px 15px rgba(38, 45, 64, 0.25);
                }

                .flow-sidebar__pivot-button:hover:not(:disabled) {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(38, 45, 64, 0.35);
                    filter: brightness(1.08);
                }

                .flow-sidebar__pivot-button:disabled {
                    opacity: 0.4;
                    cursor: not-allowed;
                    filter: grayscale(0.5);
                }

                .flow-sidebar__stats {
                    padding: 16px;
                    background: hsl(var(--card));
                    border-radius: 16px;
                    border: 1px solid rgba(255, 255, 255, 0.08);
                }

                .stat-item {
                    display: flex;
                    justify-content: space-between;
                    font-size: 11px;
                    margin-bottom: 8px;
                }

                .stat-label { color: rgba(255, 255, 255, 0.65); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
                .stat-value { color: rgba(255, 255, 255, 0.95); font-family: 'JetBrains Mono', monospace; }

                .flow-container__header {
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-end;
                    margin-bottom: 24px;
                    padding-bottom: 12px;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }

                @media (min-width: 1025px) {
                    .flow-container__header {
                        display: none;
                    }
                }

                .flow-badge {
                    display: inline-block;
                    padding: 4px 10px;
                    background: rgba(204, 86, 30, 0.1);
                    color: #CC561E;
                    font-size: 10px;
                    font-weight: 800;
                    text-transform: uppercase;
                    letter-spacing: 0.1em;
                    border-radius: 6px;
                    margin-bottom: 12px;
                }

                .flow-container__title {
                    margin: 0 0 8px 0;
                    font-size: 28px;
                    font-weight: 800;
                    color: #0f172a;
                    letter-spacing: -0.02em;
                    font-family: 'Outfit', sans-serif;
                }

                .dark .flow-container__title {
                    color: #fff;
                }

                .flow-container__meta {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .meta-dot {
                    width: 4px;
                    height: 4px;
                    background: #CC561E;
                    border-radius: 50%;
                }

                .flow-container__subtitle {
                    font-size: 14px;
                    color: #64748b;
                    font-weight: 500;
                }

                .flow-container__close {
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-radius: 12px;
                    width: 40px;
                    height: 40px;
                    font-size: 14px;
                    color: #64748b;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .flow-container__close:hover {
                    background: rgba(239, 68, 68, 0.1);
                    color: #f87171;
                    border-color: rgba(239, 68, 68, 0.2);
                }

                .flow-container__pivot {
                    background: rgba(204, 86, 30, 0.05);
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(204, 86, 30, 0.1);
                    padding: 20px 24px;
                    border-radius: 16px;
                    margin-bottom: 32px;
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    animation: slideInDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
                }

                @keyframes slideInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                .pivot-icon {
                    font-size: 24px;
                }

                .flow-container__pivot p {
                    margin: 0;
                    color: rgba(204, 86, 30, 0.8);
                    font-size: 14px;
                    line-height: 1.6;
                    font-weight: 500;
                }

                .flow-container__cards {
                    display: flex;
                    flex-direction: column;
                    gap: 24px;
                }

                .flow-container__loader {
                    padding: 60px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 16px;
                    color: #64748b;
                    font-size: 14px;
                    font-weight: 500;
                }

                .spinner {
                    width: 24px;
                    height: 24px;
                    border: 2px solid rgba(204, 86, 30, 0.1);
                    border-top-color: #CC561E;
                    border-radius: 50%;
                    animation: spin 0.8s linear infinite;
                }

                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            `})]})},Qq=({userId:t,userEmail:e,onLogout:n})=>{const[r,s]=E.useState([]),a=E.useRef([]),[l,c]=E.useState("list"),[d,p]=E.useState(null),[m,g]=E.useState(!1),[b,v]=E.useState(null),[w,C]=E.useState(!1),[k,N]=E.useState(null),[M,_]=E.useState("DASHBOARD"),[P,I]=E.useState(!1),[q,j]=E.useState(!0),[F,G]=E.useState(null),[te,he]=E.useState(!0),[Ne,Se]=E.useState(null),[Te,pe]=E.useState(1),[U,Z]=E.useState(""),[K,z]=E.useState("ALL"),[H,A]=E.useState("date_desc"),[R,W]=E.useState(""),[oe,be]=E.useState({}),[L,ae]=E.useState([]),[$,ne]=E.useState(!1),ie=E.useRef(!1),Oe=E.useRef(0),$e=E.useRef(!1),lt=E.useMemo(()=>{const Q=me=>me.trim().toLocaleLowerCase("tr-TR"),re=new Map(Bf.map(me=>[Q(me),me])),ue=new Map;return r.filter(me=>me.type==="BOOK").forEach(me=>{(me.tags||[]).forEach(ke=>{const Ce=re.get(Q(ke));Ce&&ue.set(Ce,(ue.get(Ce)||0)+1)})}),Bf.filter(me=>(ue.get(me)||0)>=vD)},[r]);E.useEffect(()=>{a.current=r},[r]),E.useEffect(()=>{let Q=!0;async function re(){if(!t){j(!1);return}try{const[{items:ue,lastDoc:me},ke]=await Promise.all([K0(t),$S(t)]);Q&&(s(ue),ae(ke),G(me),he(!!me),ne(!1))}catch(ue){console.error("Failed to load items:",ue)}finally{Q&&j(!1)}}return re(),()=>{Q=!1}},[t]),E.useEffect(()=>{if(!t)return;let Q=!1,re=null,ue=!1;Oe.current=Date.now(),$e.current=!1;const me=()=>{if(Q)return;const He=typeof document<"u"&&document.visibilityState==="hidden"?5e3:2500;re=window.setTimeout(()=>{ke()},He)},ke=async()=>{if(Q||$e.current){me();return}$e.current=!0;try{const ye=await VV(t,Oe.current,100),He=ye.events||[],Ae=He.reduce((Qe,Pe)=>{const Ye=Number(Pe.updated_at_ms||0);return Ye>Qe?Ye:Qe},0);if(Oe.current=Math.max(Oe.current,Number(ye.server_time_ms||0),Ae),He.length>0){const[{items:Qe,lastDoc:Pe},Ye]=await Promise.all([K0(t),$S(t)]);Q||(s(Qe),ae(Ye),G(Pe),he(!!Pe))}}catch(ye){if(ye instanceof Error&&ye.message==="REALTIME_ENDPOINT_NOT_FOUND"){ue=!0,console.warn("Realtime polling disabled: endpoint is not available on current backend.");return}console.warn("Realtime polling failed (non-critical):",ye)}finally{if($e.current=!1,ue)return;me()}},Ce=()=>{re!==null&&window.clearTimeout(re),me()};return me(),document.addEventListener("visibilitychange",Ce),()=>{Q=!0,re!==null&&window.clearTimeout(re),document.removeEventListener("visibilitychange",Ce)}},[t]),E.useEffect(()=>{},[t]),E.useEffect(()=>{const Q=()=>{setTimeout(()=>{window.scrollTo(0,0),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},100)},re=document.querySelectorAll("input, textarea");return re.forEach(ue=>{ue.addEventListener("blur",Q)}),()=>{re.forEach(ue=>{ue.removeEventListener("blur",Q)})}},[]),E.useEffect(()=>{if(!t||ie.current)return;ie.current=!0;let Q=!1,re=null,ue=null;const me=()=>{Q||$q({firebase_uid:t,anchor_type:"topic",anchor_id:"General Discovery",mode:"FOCUS",horizon_value:.25,resource_type:"ALL_NOTES"}).catch(ke=>{console.warn("Flow prewarm failed (non-critical):",ke)})};return typeof window<"u"&&typeof window.requestIdleCallback=="function"?ue=window.requestIdleCallback(()=>me(),{timeout:2500}):re=window.setTimeout(me,1200),()=>{Q=!0,re!==null&&window.clearTimeout(re),ue!==null&&typeof window<"u"&&typeof window.cancelIdleCallback=="function"&&window.cancelIdleCallback(ue)}},[t]);const Ue=E.useCallback(async(Q,re=!1)=>{if(Pt(Q))try{await FV(t,Q.id,{title:Q.title,author:Q.author,content:Q.generalNotes||"",tags:Q.tags||[],category:Dn(Q),delete_only:re})}catch(ue){console.error("Failed to sync personal note to AI Backend:",ue)}},[t]),rt=E.useCallback(Q=>{if(!Q)return;const re=L.find(ue=>ue.id===Q);return re==null?void 0:re.name},[L]),pt=E.useCallback(async Q=>{const re={...Q,id:Q.id||Date.now().toString(),addedAt:Q.addedAt||Date.now(),highlights:[]};s(ue=>[re,...ue]),g(!1),be({});try{await _a(t,re)}catch(ue){console.error("Failed to save item to Firestore:",ue)}(async()=>{try{if(Pt(re)){await Ue(re,!1);return}const ue=[];ue.push(`Title: ${re.title}`),ue.push(`Author: ${re.author}`),Pt(re)&&re.personalNoteCategory&&ue.push(`Category: ${re.personalNoteCategory}`),Pt(re)&&re.folderPath&&ue.push(`SubFile: ${re.folderPath}`),re.publisher&&ue.push(`Publisher: ${re.publisher}`),re.tags&&re.tags.length>0&&ue.push(`Tags: ${re.tags.join(", ")}`);const me=Pt(re)?re.generalNotes:re.summaryText||re.generalNotes;me&&ue.push(`
Content/Notes:
${me}`);const ke=ue.join(`
`);ke.length>20&&(await iM(ke,re.title,re.author,Pt(re)?JE(re):re.type,t,{book_id:re.id,tags:re.tags||[]}),console.log("Synced new item to AI Backend:",re.title))}catch(ue){console.error("Failed to sync item to AI Backend:",ue)}})(),Q.type!=="PERSONAL_NOTE"&&(async()=>{try{const ue=xp(re),me=await yy(ue),ke=bp(re,me),Ce=a.current.find(Pe=>Pe.id===re.id);if(!Ce)return;const ye=(Pe,Ye)=>JSON.stringify(Array.isArray(Pe)?Pe:[])===JSON.stringify(Array.isArray(Ye)?Ye:[]),He={},Ae=Pe=>{const Ye=re[Pe],ft=Ce[Pe],It=ke[Pe];It!==void 0&&It!==Ye&&ft===Ye&&(He[Pe]=It)};if((()=>{const Pe=re.tags||[],Ye=Ce.tags||[],ft=ke.tags||[];ye(ft,Pe)||ye(Ye,Pe)&&(He.tags=ft)})(),Ae("summaryText"),Ae("publisher"),Ae("translator"),Ae("publicationYear"),Ae("isbn"),Ae("coverUrl"),Ae("pageCount"),Ae("contentLanguageMode"),Ae("contentLanguageResolved"),Ae("sourceLanguageHint"),Ae("languageDecisionReason"),Ae("languageDecisionConfidence"),Object.keys(He).length===0)return;s(Pe=>Pe.map(Ye=>Ye.id===re.id?{...Ye,...He}:Ye));try{await Jx(t,re.id,He)}catch(Pe){console.error("Failed to patch enriched item in Oracle:",Pe)}}catch(ue){console.error("Background enrichment failed:",ue)}})()},[Jx,Ue,t]),Me=E.useCallback(Q=>{be({personalNoteCategory:(Q==null?void 0:Q.category)||"DAILY",personalFolderId:Q==null?void 0:Q.folderId,folderPath:(Q==null?void 0:Q.folderPath)||rt(Q==null?void 0:Q.folderId)}),v(null),g(!0)},[rt]),st=E.useCallback(Q=>{pt({type:"PERSONAL_NOTE",title:Q.title,author:"Self",status:"On Shelf",readingStatus:"Finished",tags:[],generalNotes:Q.content,addedAt:Date.now(),personalNoteCategory:Q.category,personalFolderId:Q.folderId,folderPath:Q.folderPath||rt(Q.folderId)})},[rt,pt]),De=E.useCallback(async Q=>{if(!b)return;let re=null;if(s(ue=>ue.map(me=>me.id===b?(re={...me,...Q},re):me)),g(!1),v(null),re){try{await _a(t,re)}catch(ue){console.error("Failed to update item in Firestore:",ue)}Pt(re)&&Ue(re,!1)}},[b,Ue,t]),_e=E.useCallback(async Q=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const re=r.find(me=>me.id===Q);s(me=>me.filter(ke=>ke.id!==Q)),d===Q&&(p(null),c("list"));let ue=!1;try{await Sq(t,Q),ue=!0}catch(me){console.error("Failed to delete item from Firestore:",me)}if(!(!ue||!re))try{await yS(t,re.id)}catch(me){console.error("Failed to purge item from AI Backend:",me)}},[r,d,t]),an=E.useCallback(async Q=>{if(!window.confirm(`Are you sure you want to delete ${Q.length} items?`))return;const re=r.filter(ke=>Q.includes(ke.id));s(ke=>ke.filter(Ce=>!Q.includes(Ce.id))),d&&Q.includes(d)&&(p(null),c("list"));let ue=!1;try{await Eq(t,Q),ue=!0}catch(ke){console.error("Failed to delete items from Firestore:",ke)}if(!ue||re.length===0)return;(await Promise.allSettled(re.map(ke=>yS(t,ke.id)))).forEach((ke,Ce)=>{ke.status==="rejected"&&console.error(`Failed to purge item ${re[Ce].id} from AI Backend:`,ke.reason)})},[r,d,t]),on=E.useCallback(async Q=>{if(!d)return;let re=null;if(s(ue=>ue.map(me=>me.id===d?(re={...me,highlights:Q},re):me)),re){try{await _a(t,re)}catch(ue){console.error("Failed to update highlights in Firestore:",ue)}(async()=>{try{await aM(t,re.id,re.title,re.author,re.highlights||[])}catch(ue){console.error("Failed to sync highlights to AI Backend:",ue)}})()}},[d,t]),Gn=E.useCallback(async Q=>{const re=r.findIndex(ke=>ke.id===Q);if(re===-1)return;const ue=r[re],me={...ue,isFavorite:!ue.isFavorite};s(ke=>{const Ce=[...ke];return Ce[re]=me,Ce});try{await _a(t,me)}catch(ke){console.error("Failed to update favorite status in Firestore:",ke)}},[r,t]),Dt=E.useCallback(async(Q,re)=>{const ue=r.findIndex(ye=>ye.id===Q);if(ue===-1)return;const me=r[ue],ke=me.highlights.map(ye=>ye.id===re?{...ye,isFavorite:!ye.isFavorite}:ye),Ce={...me,highlights:ke};s(ye=>{const He=[...ye];return He[ue]=Ce,He});try{await _a(t,Ce)}catch(ye){console.error("Failed to update highlight favorite status in Firestore:",ye)}},[r,t]),gs=E.useCallback(Q=>{s(re=>re.map(ue=>ue.id===Q.id?Q:ue))},[]),{isEnriching:Yr,stats:Kn,startEnrichment:hn,stopEnrichment:Yn}=Bq(t,gs),Jt=r.find(Q=>Q.id===d)||void 0,Pn=r.find(Q=>Q.id===b),pn=E.useCallback(Q=>{_(Q),c("list"),p(null),pe(1),Z(""),z("ALL"),W(""),Q!=="BOOK"&&Se(null)},[]),Ht=E.useCallback(Q=>{Se(Q),z("ALL"),_("BOOK"),c("list"),p(null),pe(1),Z(""),W(""),C(!1),N(null)},[]),kn=E.useCallback(Q=>{z(Q),Se(null),_("BOOK"),c("list"),p(null),pe(1),Z(""),W(""),C(!1),N(null)},[]);E.useCallback(async()=>{if(F)try{const{items:Q,lastDoc:re}=await K0(t,1e3,F);s(ue=>[...ue,...Q]),G(re),he(!!re)}catch(Q){console.error("Error loading more items:",Q)}},[t,F]);const Gt=()=>`folder-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,oa=E.useCallback(async(Q,re)=>{const ue=re.trim();if(!ue)return null;const me=Date.now(),ke=L.filter(ye=>ye.category===Q).reduce((ye,He)=>Math.max(ye,He.order),0)+1,Ce={id:Gt(),category:Q,name:ue,order:ke,createdAt:me,updatedAt:me};ae(ye=>[...ye,Ce]);try{return await VS(t,Ce),Ce}catch(ye){return console.error("Failed to create personal note folder:",ye),ae(He=>He.filter(Ae=>Ae.id!==Ce.id)),null}},[L,t]),ln=E.useCallback(async(Q,re)=>{const ue=re.trim();if(!ue)return!1;const me=L,ke=Date.now();ae(Ce=>Ce.map(ye=>ye.id===Q?{...ye,name:ue,updatedAt:ke}:ye));try{return await qS(t,Q,{name:ue,updatedAt:ke}),s(Ce=>Ce.map(ye=>!Pt(ye)||ye.personalFolderId!==Q?ye:{...ye,folderPath:ue})),!0}catch(Ce){return console.error("Failed to rename personal note folder:",Ce),ae(me),!1}},[L,t]),Xr=E.useCallback(async Q=>{if(!L.find(Ce=>Ce.id===Q))return!1;const ue=L,me=r,ke=r.filter(Ce=>Pt(Ce)&&Ce.personalFolderId===Q);ae(Ce=>Ce.filter(ye=>ye.id!==Q)),s(Ce=>Ce.map(ye=>!Pt(ye)||ye.personalFolderId!==Q?ye:{...ye,personalFolderId:void 0,folderPath:void 0}));try{return await Promise.all([...ke.map(Ce=>uf(t,Ce.id,Dn(Ce),void 0,void 0)),Nq(t,Q)]),!0}catch(Ce){return console.error("Failed to delete personal note folder:",Ce),ae(ue),s(me),!1}},[r,L,t]),Jn=E.useCallback(async(Q,re)=>{const ue=L.find(Ae=>Ae.id===Q);if(!ue)return!1;if(ue.category===re)return!0;const me=L,ke=r,Ce=Date.now(),ye=L.filter(Ae=>Ae.category===re&&Ae.id!==Q).reduce((Ae,Qe)=>Math.max(Ae,Qe.order),0)+1,He=r.filter(Ae=>Pt(Ae)&&Ae.personalFolderId===Q);ae(Ae=>Ae.map(Qe=>Qe.id!==Q?Qe:{...Qe,category:re,order:ye,updatedAt:Ce})),s(Ae=>Ae.map(Qe=>!Pt(Qe)||Qe.personalFolderId!==Q?Qe:{...Qe,personalNoteCategory:re,personalFolderId:Q,folderPath:ue.name}));try{return await Promise.all([qS(t,Q,{category:re,order:ye,updatedAt:Ce}),...He.map(Ae=>uf(t,Ae.id,re,Q,ue.name))]),await Promise.all(He.map(Ae=>Ue({...Ae,personalNoteCategory:re,personalFolderId:Q,folderPath:ue.name},!1))),!0}catch(Ae){return console.error("Failed to move personal note folder:",Ae),ae(me),s(ke),!1}},[r,L,Ue,t]),yr=E.useCallback(async(Q,re,ue)=>{const me=r.find(Pe=>Pe.id===Q);if(!me||!Pt(me))return!1;const ke=ue?L.find(Pe=>Pe.id===ue):void 0,Ce=ke==null?void 0:ke.id,ye=ke==null?void 0:ke.name,He=Dn(me),Ae=me.personalFolderId,Qe=me.folderPath;if(He===re&&(Ae||void 0)===(Ce||void 0))return!0;s(Pe=>Pe.map(Ye=>Ye.id!==Q||!Pt(Ye)?Ye:{...Ye,personalNoteCategory:re,personalFolderId:Ce,folderPath:ye}));try{return await uf(t,Q,re,Ce,ye),await Ue({...me,personalNoteCategory:re,personalFolderId:Ce,folderPath:ye},!1),!0}catch(Pe){return console.error("Failed to move personal note:",Pe),s(Ye=>Ye.map(ft=>ft.id!==Q||!Pt(ft)?ft:{...ft,personalNoteCategory:He,personalFolderId:Ae,folderPath:Qe})),!1}},[r,L,Ue,t]);return E.useEffect(()=>{if(q||$)return;const Q=r.filter(me=>Pt(me)&&!!me.folderPath&&!me.personalFolderId);if(Q.length===0){ne(!0);return}let re=!1;return(async()=>{const me=new Map;L.forEach(ye=>{const He=`${ye.category}::${ye.name.toLowerCase()}`;me.set(He,ye)});const ke=[],Ce=[];if(Q.forEach(ye=>{const He=Dn(ye),Ae=(ye.folderPath||"").trim();if(!Ae)return;const Qe=`${He}::${Ae.toLowerCase()}`;let Pe=me.get(Qe);if(!Pe){const Ye=Date.now(),ft=Math.max(...L.filter(It=>It.category===He).map(It=>It.order),...ke.filter(It=>It.category===He).map(It=>It.order),0)+1;Pe={id:Gt(),category:He,name:Ae,order:ft,createdAt:Ye,updatedAt:Ye},ke.push(Pe),me.set(Qe,Pe)}Ce.push({noteId:ye.id,category:He,folderId:Pe.id,folderPath:Pe.name})}),!re){ke.length>0&&ae(ye=>[...ye,...ke]),Ce.length>0&&s(ye=>ye.map(He=>{const Ae=Ce.find(Qe=>Qe.noteId===He.id);return!Ae||!Pt(He)?He:{...He,personalNoteCategory:Ae.category,personalFolderId:Ae.folderId,folderPath:Ae.folderPath}}));try{await Promise.all([...ke.map(ye=>VS(t,ye)),...Ce.map(ye=>uf(t,ye.noteId,ye.category,ye.folderId,ye.folderPath))])}catch(ye){console.error("Legacy personal note folder migration failed:",ye)}finally{re||ne(!0)}}})(),()=>{re=!0}},[r,$,q,L,t]),q&&r.length===0?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 text-slate-500",children:"Loading your library from cloud..."}):h.jsxs("div",{className:"flex h-screen bg-[#F7F8FB] dark:bg-[#0b0e14] overflow-hidden",children:[h.jsx(jq,{activeTab:M,onTabChange:pn,isOpen:P,onClose:()=>I(!1)}),h.jsx("main",{className:`flex-1 flex flex-col h-full w-full relative overflow-y-auto transition-all duration-300 bg-[#F7F8FB] dark:bg-[#0b0e14] noise-bg\r
`,children:M==="PROFILE"?h.jsx(Dq,{email:e,userId:t,onLogout:n,onBack:()=>pn("DASHBOARD"),books:r,onStartEnrichment:hn,onStopEnrichment:Yn,isEnriching:Yr,enrichmentStats:Kn}):M==="SMART_SEARCH"?h.jsx(zq,{userId:t,onBack:()=>pn("DASHBOARD"),books:r}):M==="RAG_SEARCH"?h.jsx(Fq,{userId:t,userEmail:e,onBack:()=>pn("DASHBOARD"),books:r}):M==="FLOW"?h.jsx(Xq,{firebaseUid:t,anchorType:"topic",anchorId:"General Discovery",categoryOptions:lt,onClose:()=>pn("DASHBOARD")}):l==="list"?h.jsx(IH,{books:r,activeTab:M,userId:t,categoryFilter:Ne,onCategoryFilterChange:Se,onCategoryNavigate:Ht,onStatusNavigate:kn,onSelectBook:Q=>{p(Q.id),C(!1),c("detail")},onSelectBookWithTab:(Q,re,ue)=>{p(Q.id),C(re==="highlights"),N(ue||null),c("detail")},onAddBook:()=>{be({}),v(null),g(!0)},personalNoteFolders:L,onCreatePersonalFolder:oa,onRenamePersonalFolder:ln,onDeletePersonalFolder:Xr,onMovePersonalFolder:Jn,onMovePersonalNote:yr,onAddPersonalNote:({category:Q,folderId:re,folderPath:ue})=>{Me({category:Q,folderId:re,folderPath:ue})},onQuickCreatePersonalNote:st,onMobileMenuClick:()=>I(!0),onDeleteBook:_e,onDeleteMultiple:an,onToggleFavorite:Gn,onToggleHighlightFavorite:Dt,currentPage:Te,onPageChange:pe,searchQuery:U,onSearchChange:Z,statusFilter:K,onStatusFilterChange:z,sortOption:H,onSortOptionChange:A,publisherFilter:R,onPublisherFilterChange:W,onTabChange:pn}):Jt&&h.jsx(Tq,{book:Jt,initialTab:w?"highlights":"info",autoEditHighlightId:k||void 0,onBack:()=>{p(null),C(!1),N(null),c("list")},onEdit:()=>{v(Jt.id),g(!0)},onDelete:()=>_e(Jt.id),onUpdateHighlights:on,onBookUpdated:gs})}),m&&h.jsx(qV,{initialType:Pn?Pn.type:M==="NOTES"||M==="DASHBOARD"||M==="PROFILE"||M==="RAG_SEARCH"||M==="SMART_SEARCH"||M==="FLOW"?"BOOK":M,initialData:Pn,noteDefaults:!Pn&&M==="PERSONAL_NOTE"?oe:void 0,onSave:b?De:pt,onCancel:()=>{g(!1),v(null),be({})}})]})},Zq=()=>{const{user:t,loading:e,loginWithGoogle:n,logout:r}=yp();return e?h.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-500",children:"Loading..."}):t?h.jsx(e4,{children:h.jsx(Qq,{userId:t.uid,userEmail:t.email,onLogout:r})}):h.jsx("div",{className:`min-h-screen flex items-center justify-center bg-[#F7F8FB] dark:bg-[#0b0e14] transition-colors duration-300\r
`,children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 shadow-lg rounded-2xl px-8 py-10 flex flex-col items-center gap-4 border border-slate-100 dark:border-slate-800",children:[h.jsx("div",{className:"flex flex-col items-center gap-6 mb-12",children:h.jsx("img",{src:fM,alt:"TomeHub Icon",className:"h-[156px] w-auto object-contain brightness-110 drop-shadow-xl"})}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center max-w-xs",children:"Sign in with your Google account to access your library across all devices."}),h.jsx("button",{onClick:n,className:"mt-2 bg-[#262D40]/40 hover:bg-[#262D40]/55 text-white px-5 py-2 rounded-lg text-sm font-medium shadow-md transition-colors",children:"Continue with Google"})]})})},eW=()=>h.jsx(DV,{children:h.jsx(Aq,{children:h.jsx(Zq,{})})}),bM=document.getElementById("root");if(!bM)throw new Error("Could not find root element to mount to");const tW=RO.createRoot(bM);tW.render(h.jsx(We.StrictMode,{children:h.jsx(eW,{})}));export{pf as A,sx as B,Bf as C,sW as F,VE as H,iW as I,$E as K,P3 as M,qE as N,nW as P,rW as S,mf as W,vD as a,Yc as b,ve as c,U4 as d,Ws as e,gE as f,Ra as g,Us as h,h as j,E as r};
